"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[6329],{50908:(t,e,i)=>{i.r(e),i.d(e,{default:()=>E});var o=i(67294),n=i(480),a=i(86628),r=i(24405),s=i(21202),c=i(19719),d=i(77907),l=i(79797),u=i(37444),g=i(15145),f=i(17693),p=i(91),h=i(15047),b=i(29369),y=i(82990),v=i(9291),m=i(64921),x=i(31278),M=i(76798),k=i(52867),w=i(70753),R=i(61248),A=i(54642),C=i(17659),N=i(12534),S=i(41549),I=i(73063),j=i(26388),B=i(85893);function G(t){window.__c={n:"NotificationGroupActionsMenu"};const{notificationActivityPairs:e}=t,i=e.map((t=>{let{notification:e}=t;return e})),s=(0,n.O7)(),d=(0,n.Fy)(),l=(0,v.useIntl)(),u=i?i[0]:void 0,g=(0,a.VK)((()=>i.every((t=>t.read))),[i]),f=(0,a.VK)((()=>S.Fz()),[]),[p,h]=(0,o.useState)(!1),b=(0,o.useCallback)((t=>{i&&u&&(0,N.ZP)({event:t,context:N.Af.NotificationClick,callback:()=>{h(!0);const t=i.map((t=>{let{id:e}=t;return e}));(async()=>{try{await A.setNotificationsStatus(s,{spaceId:u.space_id,notificationIds:t,archived:!0})}finally{h(!1)}})();const o=i.filter((t=>!t.read));C.Jl("mentions",u.space_id,(t=>Math.max(t-o.length,0))),c.Ee(s,{target:"archive",affectedNotificationIds:t,notificationActivityPairs:e})}})}),[s,i,u,e]),m=(0,o.useCallback)((t=>{i&&u&&(0,N.ZP)({event:t,context:N.Af.NotificationClick,callback:()=>{let t;if(h(!0),g){const o=i.map((t=>{let{id:e}=t;return e}));t=async()=>{try{await A.setNotificationsStatus(s,{spaceId:u.space_id,notificationIds:o,read:!1})}finally{h(!1)}},C.Jl("mentions",u.space_id,(t=>t+o.length)),c.Ee(s,{target:"mark_as_unread",affectedNotificationIds:o,notificationActivityPairs:e})}else{const o=i.filter((t=>!t.read)).map((t=>{let{id:e}=t;return e}));t=async()=>{try{await A.setNotificationsStatus(s,{spaceId:u.space_id,notificationIds:o,read:!0})}finally{h(!1)}},C.Jl("mentions",u.space_id,(t=>Math.max(t-o.length,0))),c.Ee(s,{target:"mark_as_read",affectedNotificationIds:o,notificationActivityPairs:e})}t()}})}),[s,i,u,g,e]),x=(0,r.yK)((t=>({container:{display:"flex",height:"min-content",padding:d.isMobile?0:2,borderWidth:d.isMobile?0:1,borderStyle:"solid",borderColor:d.isMobile?"transparent":t.stroke.regular,background:d.isMobile?"transparent":t.surface.elevated,borderRadius:6},button:{height:d.isMobile?30:26,width:d.isMobile?30:26},inboxIconBase:{fill:t.icon.secondary,stroke:t.icon.secondary,strokeOpacity:1,strokeWidth:.25},iconStyle:{fill:t.mediumIconColor,padding:2},readIcon:{width:d.isMobile?21:19,height:d.isMobile?22:20},archiveIcon:{width:d.isMobile?24:23,height:d.isMobile?24:23},ellipsisIcon:{width:d.isMobile?24:23,height:d.isMobile?24:23},headerLabel:{paddingLeft:16,paddingRight:16,paddingTop:10,fontWeight:y.Z.fontWeight.semibold}})),[d]);return u?"archived_only"===f?null:(0,B.jsxs)("div",{style:x.container,children:[(0,B.jsx)(j.ZP,{renderTooltip:()=>(0,B.jsx)(v.FormattedMessage,{..._.archiveNotificationGroup}),render:t=>(0,B.jsx)(I.Z,{ariaLabel:l.formatMessage(_.archiveNotificationGroup),style:x.button,icon:k.H,iconStyle:{...x.iconStyle,...x.archiveIcon,height:18,width:18,...x.inboxIconBase},onClick:b,disabled:p,...t})}),(0,B.jsx)(j.ZP,{renderTooltip:()=>g?(0,B.jsx)(v.FormattedMessage,{..._.markNotificationGroupAsUnread}):(0,B.jsx)(v.FormattedMessage,{..._.markNotificationGroupAsRead}),render:t=>(0,B.jsx)(I.Z,{ariaLabel:g?l.formatMessage(_.markNotificationGroupAsUnread):l.formatMessage(_.markNotificationGroupAsRead),style:x.button,icon:g?R.F:w.F,iconStyle:{...x.iconStyle,...x.readIcon,...g?{height:17,width:17}:{height:16,width:16},...x.inboxIconBase},onClick:m,disabled:p,...t})})]}):null}const _=(0,v.defineMessages)({markNotificationGroupAsRead:{defaultMessage:"Mark notifications in this page as read",id:"NotificationGroupActionsMenu.markNotificationAsRead.tooltipMessage"},markNotificationGroupAsUnread:{defaultMessage:"Mark notifications in this page as unread",id:"NotificationGroupActionsMenu.markNotificationAsUnread.tooltipMessage"},archiveNotificationGroup:{defaultMessage:"Archive notifications in this page",id:"NotificationGroupActionsMenu.handleArchive.tooltipMessage"},changePageNotificationSettings:{defaultMessage:"Change page notification settings",id:"NotificationGroupActionsMenu.notificationSettings.tooltipMessage"}}),L=o.memo(G);var T=i(22649);const F=(0,v.defineMessages)({open:{defaultMessage:"Open",id:"toggleButton.open"},close:{defaultMessage:"Close",id:"toggleButton.close"}});function Z(t){window.__c={n:"ToggleButton"};const e=(0,n.Fy)(),i=(0,v.useIntl)(),a=e.isMobile?30:22,s=(0,r.yK)((()=>{const i=t.color||"inherit",o="chevron"===t.icon?`rotateZ(${t.open?-180:0}deg)`:`rotateZ(${t.open?180:90}deg)`,n="chevron"===t.icon,r=n&&e.isMobile;return{button:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:a,height:a,borderRadius:"100%",...t.style},arrow:{width:r?14:n?12:"0.6875em",height:r?14:n?12:"0.6875em",transition:"transform 200ms ease-out",transform:o,fill:i,opacity:t.fill?1:.5}}}),[e.isMobile,t.color,t.fill,t.icon,t.open,t.style,a]),c=(0,o.useMemo)((()=>"chevron"===t.icon?(0,f.A)(s.arrow):(0,p.L)(s.arrow)),[t.icon,s.arrow]);return(0,B.jsxs)(m.Z,{ariaLabel:t.open?i.formatMessage(F.close):i.formatMessage(F.open),"aria-describedby":t["aria-describedby"],"aria-expanded":t.open,"aria-controls":t.open?t["aria-controls"]:void 0,style:s.button,onClick:t.onClick,onMouseDown:t.onMouseDown,disabled:t.disabled,allowShiftClick:!0,children:[t.tapArea&&(0,B.jsx)("div",{style:{position:"absolute",opacity:0,width:t.tapArea.size,height:t.tapArea.size,top:-(t.tapArea.size-a)/2,left:-(t.tapArea.size-a)/2}}),c]})}const P=function(t){window.__c={n:"NotificationGroupTitle"};const{titledRecordStore:e,getRecordModel:i,notifications:s,isNotificationGroupExpanded:d,toggleNotificationGroup:f,isNotificationGroupTitleHovered:p,setIsNotificationGroupTitleHovered:v}=t,k=(0,n.Fy)(),[w,R]=(0,o.useState)(!1),A=(0,a.VK)((()=>e.getModel()),[e]),C=(0,a.VK)((()=>null==A?void 0:A.getRenderIcon({getRecordModel:i})),[A,i]),N=(0,a.VK)((()=>e instanceof l.G&&e.isEmptyPage()),[e]),S=(0,a.VK)((()=>{if(A&&A.table!==h.bx&&A.table!==b.e0)return A.getRenderUrl({getRecordModel:e.getRecordModel,pageVisitSource:g.tY.Notification})}),[A,e]),I=(0,a.VK)((()=>s.filter((t=>{let{notification:e}=t;return!e.read})).length),[s]),j=(0,n.O7)(),G=(0,o.useCallback)((t=>{t.stopPropagation(),c.Ee(j,{target:"title",notificationActivityPairs:s})}),[j,s]),_=s&&(p||k.isMobile),F=(0,o.useRef)(null),[P,z]=(0,o.useState)(!1);(0,o.useEffect)((()=>{if(!F)return;const{current:t}=F;if(!t)return;const e="IntersectionObserver"in window?new IntersectionObserver((t=>{let[e]=t;return z(e.intersectionRatio<1)}),{threshold:[1]}):void 0;return null==e||e.observe(t),()=>null==e?void 0:e.unobserve(t)}),[F]);const K=(0,r.yK)((t=>({container:{position:"sticky",top:-.01,zIndex:10,background:t.buttonBackground,boxShadow:P?"0px 1px 1px rgba(0, 0, 0, 0.03)":"0 0 0 transparent",transition:"box-shadow 300ms"},button:{display:"flex",gap:10,justifyContent:"space-between",alignItems:"center",height:40,paddingLeft:3,background:p?void 0:t.buttonBackground,paddingRight:u.zF,borderTopLeftRadius:4,borderTopRightRadius:4,...!d&&{borderBottomLeftRadius:4,borderBottomRightRadius:4}},hoveredButton:{background:t.whiteButtonHoveredBackground,borderTopLeftRadius:4,borderTopRightRadius:4,...!d&&{borderBottomLeftRadius:4,borderBottomRightRadius:4}},pressedButton:{background:t.whiteButtonPressedBackground,borderTopLeftRadius:4,borderTopRightRadius:4,...!d&&{borderBottomLeftRadius:4,borderBottomRightRadius:4}},icon:{...T.e9,verticalAlign:"unset",marginRight:4},pageIcon:{...T.e9,verticalAlign:"unset",marginLeft:-1,marginRight:3},nonActionsArea:{display:"flex",flexShrink:2,minWidth:0},pageTitleButton:{display:"flex",alignItems:"center",height:24,minWidth:0,borderRadius:4,paddingLeft:2,paddingRight:6},recordTitle:{fontSize:14,fontWeight:I>0?y.Z.fontWeight.medium:y.Z.fontWeight.regular,color:w?t.mediumTextColor:t.regularTextColor,display:"inline",width:"100%",...y.Z.textOverflowStyle},updateCount:{color:t.mediumTextColor,fontSize:12},toggleContainer:{display:"flex",justifyContent:"center",alignItems:"center",height:24,width:24,flexShrink:0},toggleChevron:{color:t.lightIconColor},notificationGroupActionsMenu:{display:"flex",justifyContent:"center",alignItems:"center",flexShrink:0},noBackground:{background:void 0}})),[d,p,w,I,P]);return A?(0,B.jsx)("div",{ref:F,style:K.container,children:(0,B.jsxs)(m.Z,{onClick:f,onMouseEnter:()=>v(!0),onMouseLeave:()=>v(!1),style:K.button,hoveredStyle:K.hoveredButton,pressedStyle:K.pressedButton,mobileFeedback:!1,children:[(0,B.jsxs)("div",{style:K.nonActionsArea,children:[(0,B.jsx)("div",{style:K.toggleContainer,children:(0,B.jsx)(Z,{fill:!0,isSidebar:!0,icon:"chevron",open:d,onClick:f,color:K.toggleChevron.color})}),(0,B.jsxs)(m.Z,{style:K.pageTitleButton,href:S,external:!1,disabled:!Boolean(S),onMouseEnter:()=>R(!0),onMouseLeave:()=>R(!1),hoveredStyle:K.noBackground,pressedStyle:K.noBackground,onClick:G,children:[(0,B.jsx)(x.Z,{disabled:!0,icon:C,isEmptyPage:N,size:Boolean(C)?12:14,style:C?K.icon:K.pageIcon}),(0,B.jsx)(M.Z,{store:e,style:K.recordTitle,shouldWrap:!0})]})]}),(0,B.jsx)("div",{style:K.notificationGroupActionsMenu,children:_&&(0,B.jsx)(L,{notificationActivityPairs:s})})]})}):null};function z(t){window.__c={n:"NotificationGroup"};const{notifications:e,rootStore:i,source:g,tab:f,isFirst:p}=t,[h,b]=(0,o.useState)(!1),[y,v]=(0,o.useState)(!0),m=(0,n.O7)(),x=(0,o.useCallback)((()=>{v(!y),c.Ee(m,{target:y?"collapse":"expand",notificationActivityPairs:e})}),[m,y,e]),M=(0,a.VK)((()=>{const t=e[0].notification.navigable_block_id;if(t)return l.G.createChildStore(i,{table:s.iU,id:t})}),[i,e]),k=(0,r.yK)((t=>({toggle:{color:t.lightIconColor},flatIndentFooter:{height:10,backgroundColor:t.sidebarBackground},groupContainer:{backgroundColor:h?t.buttonHoveredBackground:t.buttonBackground,borderRadius:4,marginTop:p?0:u.MY,marginBottom:u.MY,marginLeft:u.MY,marginRight:u.MY},divider:{height:8,backgroundColor:t.sidebarBackground}})),[h,p]);if(!M){const{notification:i,activity:o}=e[0],n={source:"notifications_tab",tab:t.tab,notification:i};return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsx)("div",{style:k.groupContainer,children:(0,B.jsx)(d.LazyActivityNotification,{activity:o,rootStore:t.rootStore,tabArgs:n,isFirst:!0,isLast:!0,useInboxRedesign:!0},o.id)}),(0,B.jsx)("div",{style:k.divider})]})}const w=e.map(((i,o)=>{let{notification:n,activity:a}=i;const r={source:"notifications_tab",tab:t.tab,notification:n};return(0,B.jsx)(d.LazyActivityNotification,{activity:a,rootStore:t.rootStore,isFirst:0===o,isLast:o===e.length-1,tabArgs:r,useInboxRedesign:!0},a.id)}));return(0,B.jsxs)(B.Fragment,{children:[(0,B.jsxs)("div",{style:k.groupContainer,children:[(0,B.jsx)(P,{titledRecordStore:M,getRecordModel:i.getRecordModel,activity:e[0].activity,tabArgs:{source:g,tab:f,notification:e[0].notification},notifications:e,isNotificationGroupTitleHovered:h,setIsNotificationGroupTitleHovered:b,isNotificationGroupExpanded:y,toggleNotificationGroup:x}),(0,B.jsx)("div",{children:y&&w})]}),(0,B.jsx)("div",{style:k.divider})]})}function K(t){window.__c={n:"NotificationGroups"};const{notifications:e,rootStore:i,source:o,tab:n}=t,a=(0,r.yK)((t=>({container:{display:"flex",flexDirection:"column",backgroundColor:t.contentBackground}})),[]);return(0,B.jsx)("div",{style:a.container,children:Array.from(e).map(((t,e,a)=>{let[r,s]=t;return(0,B.jsx)(z,{notifications:s,rootStore:i,source:o,tab:n,isFirst:0===e,isLast:e===a.length-1},`group-${r}`)}))})}K.displayName="NotificationGroups";const E=K},93963:(t,e,i)=>{i.d(e,{z:()=>s});i(67294);var o=i(24405),n=i(9291),a=i(85893);const r=8;function s(t){let{color:e,size:i,style:s}=t;window.__c={n:"StatusDot"};const c=(0,n.useIntl)(),d=(0,o.yK)((t=>({dot:{height:i||r,width:i||r,background:e||t.blueColor,flexShrink:0,borderRadius:"100%",pointerEvents:"none",...s}})),[i,e,s]);return(0,a.jsx)("div",{role:"img","aria-label":c.formatMessage({id:"statusDot.ariaLabel",defaultMessage:"New"}),style:d.dot})}}}]);