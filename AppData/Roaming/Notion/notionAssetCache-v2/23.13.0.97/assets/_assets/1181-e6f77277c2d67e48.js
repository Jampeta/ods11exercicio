"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1181],{37834:(e,t,i)=>{i.d(t,{FF:()=>u,U4:()=>f,gs:()=>b,jN:()=>h,xx:()=>y,zb:()=>v});i(67294);var o=i(23867),n=i(82990),a=i(9291),s=i(77080),r=i(46096),d=i(36610),l=i(54642),c=i(47307),g=i(92625),m=i(85893);const p=(0,a.defineMessages)({restoringPreviousVersion:{id:"historyModalActions.restoringPreviousVersion.loadingMessage",defaultMessage:"Restoringâ€¦"}});function h(e){const{environment:t,from:i,...o}=e;d.y(t,i),r.Z.setState({...o,open:!0,size:50})}const u=()=>{const e=r.Z.state;e.open&&r.Z.setState({...e,size:e.size+20})},f=function(){r.Z.setState({open:!1})};function b(e){const{environment:t,snapshot:i,nextFutureSnapshot:o}=e;d.qD(t,i);const n=r.Z.state;n.open&&r.Z.setState({...n,snapshot:i,nextFutureSnapshot:o,openSnapshotNearTimestamp:void 0})}function v(){const e=r.Z.state;e.open&&r.Z.setState({...e,snapshot:void 0,nextFutureSnapshot:void 0})}async function y(e){if(!r.Z.state.open)return;if(!r.Z.state.snapshot)return;const t="restore_collection",i=r.Z.state.pageHasCollection,h=s.default.checkGate("snapshot_optional_collection_rollback_enabled")&&i?[{key:t,text:(0,m.jsx)(a.FormattedMessage,{defaultMessage:"Also restore databases on this page",id:"historyModal.confirmDialog.selectOption.collection"}),description:(0,m.jsx)(a.FormattedMessage,{defaultMessage:"All database pages will be restored to the previous version, which may impact other users or database views.",id:"historyModal.confirmDialog.selectOption.collection.description"})}]:void 0,{accept:u,selectionResult:b}=await c.confirmUserActionV2({message:(0,m.jsx)("div",{style:{fontWeight:n.Z.fontWeight.semibold,fontSize:"medium"},children:(0,m.jsx)(a.FormattedMessage,{defaultMessage:"Restore to this version?",id:"historyModal.confirmDialog.description"})}),acceptLabel:(0,m.jsx)(a.FormattedMessage,{defaultMessage:"Restore",id:"historyModal.confirmDialog.restoreButton.label"}),selectionItems:h});if(!u)return;d.R9(e,r.Z.state.snapshot),g.j({message:p.restoringPreviousVersion});const v=await l.restoreSnapshot(e,{block:{id:r.Z.state.blockStore.id,spaceId:(0,o.C)(r.Z.state.blockStore.pointer.spaceId)},timestamp:r.Z.state.snapshot.timestamp,shouldRestoreCollection:(null==b?void 0:b[t])??!1}).next();v.value.error&&c.showErrorMessage(v.value.error.message),g.x(),f()}},67706:(e,t,i)=>{i.d(t,{Z:()=>d});i(67294);var o=i(24405),n=i(82990),a=i(53437),s=i(26388),r=i(85893);function d(e){let{text:t,tooltipText:i,icon:d}=e;window.__c={n:"InlineTextWithIconTooltip"};const l=(0,o.yK)((e=>({icon:{height:"1em",width:"1em",marginRight:"0.25em",fill:e.mediumIconColor,marginBottom:"0.1em"},tooltip:{background:e.contentBackground,boxShadow:e.lightBoxShadow},container:{display:"flex",alignItems:"center",fontWeight:n.Z.fontWeight.regular,color:e.mediumTextColor,fontSize:n.Z.fontSize.UISmall.desktop,textAlign:"center"},text:{display:"inline"}})),[]);return(0,r.jsx)(s.ZP,{style:l.tooltip,render:e=>(0,r.jsx)("div",{style:l.text,...e,children:t}),renderTooltip:()=>(0,r.jsxs)("div",{style:l.container,children:[d(l.icon),(0,r.jsx)("div",{children:i})]}),alignment:a.ZP.Alignment.Start,placement:a.ZP.Placement.Bottom})}},37444:(e,t,i)=>{i.d(t,{IX:()=>T,MY:()=>R,ZP:()=>V,hn:()=>K,zF:()=>F});var o=i(67294),n=i(480),a=i(86628),s=i(24405),r=i(69651),d=i(8504),l=i(21202),c=i(82990),g=i(54642),m=i(17659),p=i(37834),h=i(82530),u=i(43250),f=i(12534),b=i(33929),v=i(16402),y=i(50770),x=i(79797),k=i(4761),S=i(11066),M=i(73063),w=i(26388),C=i(67706),I=i(30573),j=i(32469),A=i(93963),Z=i(4688),B=i(85893);const R=4,T=22,N=28+T+12;function U(e){window.__c={n:"InboxNotificationSection"};const{notification:t,prominentTitleLink:i,children:r,rootStore:d,icon:l,isPrivate:c,onArchiveClicked:p,onUnarchiveClicked:b,onMarkAsReadClicked:v,onMarkAsUnreadClicked:x,onNotificationBodyClicked:M,navigableBlockId:w,url:C,showSnapshotButton:I,timestamp:T,header:U,isFirst:F,isLast:_}=e,z=(0,n.O7)(),L=(0,n.Fy)(),K=(0,a.VK)((()=>(0,y.r_)()),[]),V=(0,a.VK)((()=>(0,y.UE)()),[]),[O,G]=(0,o.useState)(!1),[H,E]=(0,o.useState)(!1),$=(0,a.VK)((()=>"mentions"===k.ZP.state.currentTab),[]),J=!t||t.read,Q=L.isMobile,q=(0,a.VK)((()=>{const e=z.WindowSizeStore.state;return{left:e.paddingLeftCSS,right:e.paddingRightCSS}}),[z.WindowSizeStore]),Y=(0,s.yK)((e=>({article:{display:"flex",flexDirection:"column"},mainClickTargetButton:{borderRadius:4,paddingTop:10-R,paddingBottom:10-R,paddingLeft:Q?q.left:0,paddingRight:Q?q.right:0,marginTop:F?0:R,marginBottom:_?0:R,opacity:J?.7:1},headerAndAvatar:{display:"flex",paddingLeft:15-R,paddingRight:10-R,gap:12,maxWidth:"100%"},avatarAndStatusDot:{display:"flex",gap:5,alignItems:"center",height:"fit-content"},statusDotSpacer:{width:8,flexShrink:0},privatePageBadge:{marginTop:1,marginBottom:4,marginLeft:8},children:{paddingLeft:N-R,paddingRight:10-R},divider:{width:`calc(100% - ${N-R}px)`,height:1,backgroundColor:e.stroke.deemphasized,alignSelf:"end"}})),[F,_,J,q,Q]),X=(0,o.useCallback)((e=>{t&&(H||(K&&m.qQ({environment:z,open:!1}),!C&&t.read||M(),t.read||(0,f.ZP)({event:e,context:f.Af.NotificationClick,callback:()=>{"commented"!==t.type||t.read||g.setNotificationsStatus(z,{spaceId:t.space_id,notificationIds:[t.id],read:!0}),h.createAndCommit({userAction:"ActivityNotificationSection.handleMarkAsRead",environment:z,perform:e=>{m.$h({notification:t,rootStore:d,transaction:e,read:!0})}})}})))}),[z,H,t,M,K,d,C]),ee=(0,o.useCallback)((()=>G(!0)),[]),te=(0,o.useCallback)((()=>G(!1)),[]),ie=(0,o.useId)();return V?(0,B.jsx)(Z.ZP,{...e}):(0,B.jsxs)("article",{style:Y.article,onMouseOver:ee,onMouseLeave:te,onClick:X,"aria-labelledby":ie,tabIndex:0,children:[(0,B.jsx)(D,{notification:t,rootStore:d,isMobile:Q,isHovered:O,isFirst:F,onMouseEnter:()=>E(!0),onMouseLeave:()=>E(!1),onArchiveClicked:p,onUnarchiveClicked:b,onMarkAsReadClicked:v,onMarkAsUnreadClicked:x}),(0,B.jsxs)(S.Z,{href:C,style:Y.mainClickTargetButton,disabled:!Boolean(C),children:[(0,B.jsxs)("div",{style:Y.headerAndAvatar,children:[(0,B.jsxs)("div",{className:u.FoE,style:Y.avatarAndStatusDot,children:[$&&!J?(0,B.jsx)(A.z,{size:8}):(0,B.jsx)("div",{style:Y.statusDotSpacer}),l]}),(0,B.jsx)(P,{timestamp:T,header:U,prominentTitleLink:i,hasChildren:Boolean(r),titleAriaId:ie,isNotificationRead:J}),I&&w&&(0,B.jsx)(W,{timestamp:T,navigableBlockId:w,rootStore:d}),c&&!t&&(0,B.jsx)(j.Z,{style:Y.privatePageBadge})]}),r&&(0,B.jsx)("div",{style:Y.children,className:u.nU_,children:r})]}),!_&&(0,B.jsx)("div",{style:Y.divider})]})}const F=10-R,_=8-R;function D(e){window.__c={n:"InboxActions"};const{notification:t,rootStore:i,isMobile:o,isHovered:n,isFirst:a,onArchiveClicked:r,onUnarchiveClicked:d,onMarkAsReadClicked:l,onMarkAsUnreadClicked:c,onMouseEnter:g,onMouseLeave:m}=e,p=(0,s.yK)((()=>({container:{display:"flex",alignItems:"flex-start",position:"relative"},body:{transition:"opacity 100ms ease-out",opacity:o||n?1:0,position:"absolute",right:F,top:_+(a?0:R),zIndex:1}})),[o,n,a]);return t?(0,B.jsx)("div",{style:p.container,onMouseEnter:g,onMouseLeave:m,children:(0,B.jsx)("div",{style:p.body,children:(0,B.jsx)(I.Z,{notification:t,rootStore:i,onArchiveClicked:r,onUnarchiveClicked:d,onMarkAsReadClicked:l,onMarkAsUnreadClicked:c,useInboxRedesign:!0})})}):null}const z=14,L=12;function P(e){window.__c={n:"Header"};const{timestamp:t,prominentTitleLink:i,header:o,hasChildren:a,titleAriaId:d,isNotificationRead:l}=e,g=(0,n.Fy)().isMobile,m=(0,v.IS)(t,{useUltraCompactFormat:!0}),p=(0,v.uy)(t),h=(0,s.yK)((e=>({container:{display:"flex",flexDirection:"column",width:"100%"},containerMobile:{display:"flex"},headerMobile:{fontSize:z,minWidth:0},header:{display:"inline-grid",gridAutoFlow:"column",justifyContent:"space-between",fontSize:z,minWidth:0},headlineMobile:{display:"inline",fontWeight:l?c.Z.fontWeight.regular:c.Z.fontWeight.medium,whiteSpace:"pre-wrap",wordBreak:"break-word"},headline:{flexShrink:2,fontWeight:l?c.Z.fontWeight.regular:c.Z.fontWeight.medium,whiteSpace:"pre-wrap",wordBreak:"break-word"},title:{fontSize:z,marginTop:4,marginBottom:a?8:4},time:{display:"flex",fontSize:L,color:e.lightTextColor,whiteSpace:"nowrap",...g&&{display:"inline"},paddingLeft:6,marginTop:z-L}})),[a,g,l]);return(0,B.jsxs)("div",{style:g?h.containerMobile:h.container,children:[(0,B.jsxs)("div",{style:g?h.headerMobile:h.header,children:[(0,B.jsx)("div",{style:g?h.headlineMobile:h.headline,className:u.NFf,id:d,children:o}),(0,B.jsx)("div",{style:h.time,className:u.CZG,children:(0,B.jsx)(C.Z,{text:m,tooltipText:p,icon:r.C})})]}),g&&(0,B.jsx)("div",{style:{width:96,flexShrink:0}}),i&&(0,B.jsx)("div",{style:h.title,children:i})]})}function W(e){window.__c={n:"SnapshotButton"};const{timestamp:t,navigableBlockId:i,rootStore:o}=e,a=(0,n.O7)();if(t<new Date("2018-10-26").getTime())return null;const s=b.default.getIntl().formatMessage({defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"}),r=()=>{const e=x.G.createChildStore(o,{table:l.iU,id:i});p.jN({environment:a,blockStore:e,openSnapshotNearTimestamp:t.toString(),from:"activity"})};return(0,B.jsx)(w.ZP,{renderTooltip:()=>s,render:e=>(0,B.jsx)(M.Z,{ariaLabel:s,onClick:r,icon:d.J,...e})})}function K(e){window.__c={n:"InboxIconCircleWrapper"};const{children:t}=e,i=(0,s.yK)((e=>({container:{borderRadius:"100%",display:"flex",flexShrink:0,justifyContent:"center",alignItems:"center",height:T,width:T,backgroundColor:e.surface.elevated,borderWidth:1,borderStyle:"solid",borderColor:e.stroke.deemphasized},icon:{height:16,width:16,fill:e.icon.secondary}})),[]);return(0,B.jsx)("div",{style:i.container,children:t})}const V=o.memo(U)},4688:(e,t,i)=>{i.d(t,{MY:()=>F,ZP:()=>Q,_z:()=>_});var o=i(67294),n=i(480),a=i(86628),s=i(24405),r=i(69651),d=i(8504),l=i(21202),c=i(82990),g=i(9291),m=i(54642),p=i(17659),h=i(37834),u=i(82530),f=i(43250),b=i(12534),v=i(33929),y=i(16402),x=i(50770),k=i(45325),S=i(79797),M=i(4761),w=i(11066),C=i(73063),I=i(31278),j=i(76798),A=i(26388),Z=i(67706),B=i(30573),R=i(32469),T=i(93963),N=i(22649),U=i(85893);const F=4,_=12,D=5,z=6,L=22,P=_+L+12;function W(e){window.__c={n:"InboxNotificationSection"};const{notification:t,prominentTitleLink:i,children:r,rootStore:d,icon:c,isPrivate:g,onArchiveClicked:h,onUnarchiveClicked:v,onMarkAsReadClicked:y,onMarkAsUnreadClicked:M,onNotificationBodyClicked:C,navigableBlockId:I,url:j,showSnapshotButton:A,timestamp:Z,header:B,isFirst:T,isLast:N,useDiscussionView:W}=e,K=(0,n.O7)(),V=(0,n.Fy)(),[G,H]=(0,o.useState)(!1),[E,Q]=(0,o.useState)(!1),q=!t||t.read,Y=V.isMobile,X=(0,a.VK)((()=>(0,x.r_)()&&"peek"===k.default.state.mode&&k.default.isOpen()),[]),ee=(0,a.VK)((()=>{if(I)return S.t1.createChildStore(d,{id:I,table:l.iU})}),[d,I]),te=(0,a.VK)((()=>{const e=K.WindowSizeStore.state;return{left:e.paddingLeftCSS,right:e.paddingRightCSS}}),[K.WindowSizeStore]),ie=(0,s.yK)((e=>({article:{display:"flex",flexDirection:"column"},mainClickTargetButton:{borderRadius:4,paddingTop:16-F,paddingBottom:16-F,paddingLeft:Y?te.left:0,paddingRight:Y?te.right:0,marginTop:T?0:F,marginBottom:N?0:F,marginLeft:F,marginRight:F,opacity:q?.7:1},headerAndAvatar:{display:"flex",paddingLeft:_-F,paddingRight:12-F,gap:12,maxWidth:"100%"},avatarAndStatusDot:{display:"flex",gap:D,alignItems:"center",height:L},statusDotSpacer:{width:z,flexShrink:0},privatePageBadge:{marginTop:1,marginBottom:4,marginLeft:8},children:{paddingLeft:W?0:P-F,paddingRight:12-F},divider:{width:"100%",height:1,backgroundColor:e.stroke.deemphasized,alignSelf:"end"},header:{fontSize:12,color:e.mediumTextColor}})),[T,N,q,te,Y,W]),oe=(0,o.useCallback)((e=>{t&&(E||(X&&p.qQ({environment:K,open:!1}),!j&&t.read||C(),t.read||(0,b.ZP)({event:e,context:b.Af.NotificationClick,callback:()=>{"commented"!==t.type||t.read||m.setNotificationsStatus(K,{spaceId:t.space_id,notificationIds:[t.id],read:!0}),u.createAndCommit({userAction:"ActivityNotificationSection.handleMarkAsRead",environment:K,perform:e=>{p.$h({notification:t,rootStore:d,transaction:e,read:!0})}})}})))}),[K,E,X,t,C,d,j]),ne=(0,o.useCallback)((()=>H(!0)),[]),ae=(0,o.useCallback)((()=>H(!1)),[]),se=(0,o.useId)();return(0,U.jsxs)("article",{style:ie.article,onMouseOver:ne,onMouseLeave:ae,onClick:oe,"aria-labelledby":se,tabIndex:0,children:[(0,U.jsx)(O,{notification:t,rootStore:d,isMobile:Y,isHovered:G,isFirst:T,onMouseEnter:()=>Q(!0),onMouseLeave:()=>Q(!1),onArchiveClicked:h,onUnarchiveClicked:v,onMarkAsReadClicked:y,onMarkAsUnreadClicked:M}),(0,U.jsxs)(w.Z,{href:j,style:ie.mainClickTargetButton,disabled:!Boolean(j),children:[(0,U.jsxs)("div",{style:ie.headerAndAvatar,children:[c&&(0,U.jsx)("div",{className:f.FoE,style:ie.avatarAndStatusDot,children:c}),(0,U.jsx)($,{timestamp:Z,header:B,prominentTitleLink:i,hasChildren:Boolean(r),titleAriaId:se,isNotificationRead:q,navigableBlockStore:ee,headerStyle:W?ie.header:{}}),A&&I&&(0,U.jsx)(J,{timestamp:Z,navigableBlockId:I,rootStore:d}),g&&!t&&(0,U.jsx)(R.Z,{style:ie.privatePageBadge})]}),r&&(0,U.jsx)("div",{style:ie.children,className:f.nU_,children:r})]}),!N&&(0,U.jsx)("div",{style:ie.divider})]})}const K=10-F,V=8-F;function O(e){window.__c={n:"InboxActions"};const{notification:t,rootStore:i,isMobile:o,isHovered:n,isFirst:a,onArchiveClicked:r,onUnarchiveClicked:d,onMarkAsReadClicked:l,onMarkAsUnreadClicked:c,onMouseEnter:g,onMouseLeave:m}=e,p=(0,s.yK)((()=>({container:{display:"flex",alignItems:"flex-start",position:"relative"},body:{transition:"opacity 100ms ease-out",opacity:o||n?1:0,position:"absolute",right:K,top:V+(a?0:F),zIndex:1}})),[o,n,a]);return t?(0,U.jsx)("div",{style:p.container,onMouseEnter:g,onMouseLeave:m,children:(0,U.jsx)("div",{style:p.body,children:(0,U.jsx)(B.Z,{notification:t,rootStore:i,onArchiveClicked:r,onUnarchiveClicked:d,onMarkAsReadClicked:l,onMarkAsUnreadClicked:c,useInboxRedesign:!0})})}):null}const G=14,H=12,E=4;function $(e){window.__c={n:"Header"};const{timestamp:t,prominentTitleLink:i,header:o,hasChildren:d,titleAriaId:l,isNotificationRead:m,navigableBlockStore:p,headerStyle:h}=e,u=(0,n.Fy)(),b=(0,a.VK)((()=>"mentions"===M.ZP.state.currentTab),[]),v=u.isMobile,x=(0,y.IS)(t,{useUltraCompactFormat:!0}),k=(0,y.uy)(t),w=(0,s.yK)((e=>({container:{display:"flex",flexDirection:"column",width:"100%"},containerMobile:{display:"flex"},headerMobile:{fontSize:G,minWidth:0},header:{display:"inline-grid",gridAutoFlow:"column",justifyContent:"space-between",fontSize:G,minWidth:0},headlineMobile:{display:"inline",whiteSpace:"pre-wrap",wordBreak:"break-word",...h},headline:{display:"inline",flexShrink:2,whiteSpace:"pre-wrap",wordBreak:"break-word",...h},title:{fontSize:G,marginTop:4,marginBottom:d?8:4},timeAndStatusDot:{display:"inline"},time:{display:"flex",fontSize:H,color:e.lightTextColor,whiteSpace:"nowrap",...v&&{display:"inline-flex"},gap:E,paddingLeft:6,marginTop:G-H},avatarAndStatusDot:{display:"flex",gap:D,alignItems:"center",height:L,paddingBottom:3,paddingLeft:3},statusDotSpacer:{width:z,flexShrink:0},icon:{...N.e9,verticalAlign:"unset",marginRight:4},pageIcon:{...N.e9,verticalAlign:"unset",marginLeft:-1,marginRight:3},recordTitle:{fontSize:14,fontWeight:c.Z.fontWeight.medium,display:"inline",width:"100%",...h}})),[d,v,h]),C=(0,a.VK)((()=>p instanceof S.G&&p.isEmptyPage()),[p]),A=(0,a.VK)((()=>{if(p)return p.getIcon()}),[p]),B=p&&(0,U.jsxs)(U.Fragment,{children:[(0,U.jsx)(I.Z,{disabled:!0,icon:A,isEmptyPage:C,size:Boolean(A)||12===(null==h?void 0:h.fontSize)?12:14,style:A?w.icon:w.pageIcon}),(0,U.jsx)(j.Z,{store:p,style:w.recordTitle,underline:!0,shouldWrap:!0})]});return(0,U.jsxs)("div",{style:v?w.containerMobile:w.container,children:[(0,U.jsxs)("div",{style:v?w.headerMobile:w.header,children:[(0,U.jsx)("div",{style:v?w.headlineMobile:w.headline,className:f.NFf,id:l,children:B?(0,U.jsx)(g.FormattedMessage,{id:"inboxNotificationSection.headerAndPageName.title",defaultMessage:"{header} in {recordTitleWithIcon}",values:{header:o,recordTitleWithIcon:B}}):o}),(0,U.jsx)("div",{style:w.timeAndStatusDot,children:(0,U.jsxs)("div",{style:w.time,className:f.CZG,children:[(0,U.jsx)(Z.Z,{text:x,tooltipText:k,icon:r.C}),(0,U.jsx)("div",{style:w.avatarAndStatusDot,children:b&&!m?(0,U.jsx)(T.z,{size:z}):(0,U.jsx)("div",{style:w.statusDotSpacer})})]})})]}),v&&(0,U.jsx)("div",{style:{width:96,flexShrink:0}}),i&&(0,U.jsx)("div",{style:w.title,children:i})]})}function J(e){window.__c={n:"SnapshotButton"};const{timestamp:t,navigableBlockId:i,rootStore:o}=e,a=(0,n.O7)();if(t<new Date("2018-10-26").getTime())return null;const s=v.default.getIntl().formatMessage({defaultMessage:"View version for this update",id:"activitySection.viewVersionForUpdate.tooltip"}),r=()=>{const e=S.G.createChildStore(o,{table:l.iU,id:i});h.jN({environment:a,blockStore:e,openSnapshotNearTimestamp:t.toString(),from:"activity"})};return(0,U.jsx)(A.ZP,{renderTooltip:()=>s,render:e=>(0,U.jsx)(C.Z,{ariaLabel:s,onClick:r,icon:d.J,...e})})}const Q=o.memo(W)},22649:(e,t,i)=>{i.d(t,{OD:()=>d,TL:()=>g,_W:()=>c,b9:()=>m,c3:()=>l,e9:()=>s,lS:()=>a,nP:()=>r});var o=i(82990);const n={userSelect:"text",WebkitUserSelect:"text"},a={padding:1,...n},s={display:"inline-flex",marginRight:2,verticalAlign:"text-top"},r={fontWeight:o.Z.fontWeight.semibold};function d(e){return{padding:0,paddingLeft:l(e),paddingRight:16,paddingBottom:3,...n}}function l(e){const{source:t,isMobile:i}=e;return"notifications_tab"===t?52+(i?3:2):52}function c(e){return{height:26,paddingLeft:8,paddingRight:8,color:e.mediumTextColor}}function g(e){return{display:"inline",whiteSpace:"normal",marginRight:e?3:0,wordBreak:"break-word",...r}}function m(e){return{boxShadow:e.plainButtonBoxShadow,height:26,paddingLeft:8,paddingRight:8,fontWeight:500,color:e.regularTextColor}}},30573:(e,t,i)=>{i.d(t,{Z:()=>z});var o=i(67294),n=i(480),a=i(86628),s=i(24405),r=i(52867),d=i(90334),l=i(70753),c=i(61248),g=i(98519),m=i(55863),p=i(55061),h=i(21202),u=i(82990),f=i(9291),b=i(19719),v=i(54642),y=i(17659),x=i(82530),k=i(12534),S=i(87279),M=i(98742),w=i(24764),C=i(57538),I=i(79797),j=i(52275),A=i(31945),Z=i(73063),B=i(78140),R=i(32163),T=i(72495),N=i(26388),U=i(64369),F=i(85893);const _=(0,f.defineMessages)({changePageNotificationSettings:{defaultMessage:"Change page notification settings",id:"inboxActionsMenu.notificationSettings.tooltipMessage"},markUnread:{defaultMessage:"Mark this notification as unread",id:"inboxActionsMenu.markNotificationAsUnread.tooltipMessage"},markRead:{defaultMessage:"Mark this notification as read",id:"inboxActionsMenu.markNotificationAsRead.tooltipMessage"},archive:{defaultMessage:"Archive this notification",id:"inboxActionsMenu.handleArchive.tooltipMessage"},unarchive:{defaultMessage:"Unarchive",id:"inboxActionsMenu.handleUnarchive.tooltipMessage"}});function D(e){window.__c={n:"InboxActionsMenu"};const{notification:t,rootStore:i,onArchiveClicked:D,onUnarchiveClicked:z,onMarkAsReadClicked:L,onMarkAsUnreadClicked:P,useInboxRedesign:W}=e,K=(0,n.O7)(),V=(0,n.Fy)(),O=(0,f.useIntl)(),G=(0,a.VK)((()=>!!t&&(0,p.$2)(t.type)),[t]),H=(0,a.VK)((()=>{const e=null==t?void 0:t.navigable_block_id;if(e)return I.G.createChildStore(i,{table:h.iU,id:e})}),[i,t]),E=(0,a.VK)((()=>null==H?void 0:H.getFollowSettingsKey()),[H]),$=(0,a.VK)((()=>{if(!E)return[];if(!H)return[];return w.Z({followSettingsKey:E,environment:K,blockStore:H,from:"inbox"})}),[E,K,H]),J=(0,a.VK)((()=>G&&$.length>0),[G,$]),[Q,q]=(0,o.useState)(!1),Y=(0,o.useCallback)((e=>{t&&(0,k.ZP)({event:e,context:k.Af.NotificationClick,callback:()=>{if(D(),W&&"commented"===t.type){q(!0);return(async()=>{try{await v.setNotificationsStatus(K,{spaceId:t.space_id,notificationIds:[t.id],archived:!0})}finally{q(!1)}})(),void(t.read||y.Jl("mentions",t.space_id,(e=>Math.max(e-1,0))))}x.createAndCommit({userAction:"InboxActionsMenu.handleArchive",environment:K,perform:e=>{y.aZ({notification:t,rootStore:i,transaction:e})}})}})}),[K,t,D,i,W]),X=(0,o.useCallback)((e=>{t&&(0,k.ZP)({event:e,context:k.Af.NotificationClick,callback:()=>{z(),W&&"commented"===t.type?v.setNotificationsStatus(K,{spaceId:t.space_id,notificationIds:[t.id],archived:!1}):x.createAndCommit({userAction:"Activity.handleUnarchive",environment:K,perform:e=>{y.E1({notificationId:t.id,visited:!1,rootStore:i,transaction:e})}})}})}),[K,t,z,i,W]),ee=(0,o.useCallback)((e=>{t&&(0,k.ZP)({event:e,context:k.Af.NotificationClick,callback:()=>{t.read?P():L(),W&&"commented"===t.type&&v.setNotificationsStatus(K,{spaceId:t.space_id,notificationIds:[t.id],read:!t.read}),x.createAndCommit({userAction:"InboxActionsMenu.toggleNotificationReadStatus",environment:K,perform:e=>{y.$h({notification:t,rootStore:i,transaction:e,read:!t.read})}})}})}),[K,t,L,P,i,W]),te=(0,o.useCallback)((()=>{E&&H&&t&&b.Z8({environment:K,notificationId:t.id,pageId:H.pointer.id,isCurrentlyFollowing:(0,C.Z)(E).following,from:"inbox"})}),[K,H,E,t]),ie=(0,s.yK)((e=>({container:{...W?{display:"flex",height:"min-content",padding:V.isMobile?0:2,borderWidth:V.isMobile?0:1,borderStyle:"solid",borderColor:V.isMobile?"transparent":e.stroke.regular,background:V.isMobile?"transparent":e.buttonGroupBackground,borderRadius:6}:{display:"flex",height:"min-content",background:e.buttonGroupBackground,boxShadow:e.lightBoxShadow,borderRadius:4,padding:2}},button:{...W&&{height:V.isMobile?30:26,width:V.isMobile?30:26}},inboxIconBase:{fill:e.icon.secondary,stroke:e.icon.secondary,strokeOpacity:1,strokeWidth:.25},iconStyle:{fill:e.mediumIconColor,padding:2},readIcon:{width:V.isMobile?21:19,height:V.isMobile?22:20},archiveIcon:{width:V.isMobile?24:23,height:V.isMobile?24:23},ellipsisIcon:{width:V.isMobile?24:23,height:V.isMobile?24:23},headerLabel:{paddingLeft:16,paddingRight:16,paddingTop:10,fontWeight:u.Z.fontWeight.semibold}})),[V,W]),oe=(0,s.yK)((e=>({popup:{...V.isMobile&&{borderTopLeftRadius:12,borderTopRightRadius:12,overflow:"hidden"}},menuScroller:V.isMobile?{background:e.sidebarBackground}:{},header:V.isMobile?{display:"flex",justifyContent:"center",alignItems:"center",fontSize:16,fontWeight:u.Z.fontWeight.semibold,background:e.sidebarBackground,height:40}:{paddingLeft:16,paddingRight:16,paddingTop:10,fontWeight:u.Z.fontWeight.semibold},sectionMenuItem:V.isMobile?{overflow:"hidden",background:e.buttonBackground,borderRadius:12,marginLeft:16,marginRight:16,marginBottom:16,borderWidth:1,borderStyle:"solid",borderColor:e.stroke.deemphasized,padding:void 0}:{},buttonMenuItem:V.isMobile?{backgroundColor:e.surface.elevated,paddingTop:12,paddingBottom:12}:{},buttonMenuItemPressed:{background:e.buttonPressedBackground},buttonMenuItemBorder:{borderBottomWidth:1,borderBottomStyle:"solid",borderBottomColor:e.stroke.deemphasized},title:V.isMobile?{fontSize:16}:{},icon:{...V.isMobile?{height:20,width:20}:{height:16,width:16}}})),[V]);if(!t)return null;if(W&&t.visited)return(0,F.jsx)("div",{style:ie.container,children:(0,F.jsx)(N.ZP,{renderTooltip:()=>O.formatMessage(_.unarchive),render:e=>(0,F.jsx)(Z.Z,{ariaLabel:O.formatMessage(_.unarchive),style:ie.button,icon:m.s,iconStyle:{...ie.iconStyle,...ie.inboxIconBase},onClick:X,...e})})});const ne=(0,F.jsx)(N.ZP,{renderTooltip:()=>O.formatMessage(t.read?_.markUnread:_.markRead),render:e=>(0,F.jsx)(Z.Z,{ariaLabel:O.formatMessage(t.read?_.markUnread:_.markRead),style:ie.button,icon:t.read?c.F:l.F,iconStyle:{...ie.iconStyle,...ie.readIcon,...W&&{...t.read?{height:17,width:17}:{height:16,width:16},...ie.inboxIconBase}},onClick:ee,...e})},"markUnread"),ae=(0,F.jsx)(N.ZP,{renderTooltip:()=>O.formatMessage(_.archive),render:e=>(0,F.jsx)(Z.Z,{ariaLabel:O.formatMessage(_.archive),style:ie.button,icon:r.H,iconStyle:{...ie.iconStyle,...ie.archiveIcon,...W&&{height:18,width:18,...ie.inboxIconBase}},disabled:Q,onClick:Y,...e})},"archive"),se=J?(0,F.jsx)(N.ZP,{renderTooltip:()=>(0,F.jsx)(f.FormattedMessage,{..._.changePageNotificationSettings}),render:e=>(0,F.jsx)(A.ZP,{style:oe.popup,popupType:V.isMobile?A.Z4.SlideUp:A.Z4.Popup,alignmentToOrigin:A.vR.Start,placementToOrigin:A.pO.Bottom,render:e=>(0,F.jsx)(B.Z,{menuType:S.og.Popup,height:V.isMobile?"50vh":void 0,minWidth:250,maxWidth:V.isMobile?"100vw":void 0,scrollerStyle:oe.menuScroller,header:(0,F.jsx)(U.Z,{style:oe.header,isSmall:!V.isMobile,isSecondaryColor:!V.isMobile,children:(0,F.jsx)(f.FormattedMessage,{id:"UpdateSidebarTabUpdatesHeader.pageNotificationSettings.label",defaultMessage:"Page notification settings"})}),children:(0,F.jsx)(R.Z,{type:R.i.Vertical,sections:[{key:"inbox filters",render:e=>(0,F.jsx)(T.Z,{...e,topBorder:0!==e.index,style:oe.sectionMenuItem}),items:$.map(((t,i)=>{const o=i===$.length-1,n=V.isMobile&&!o;return{key:t.action.analyticsName,render:e=>(0,F.jsx)(j.Z,{...e,style:{...oe.buttonMenuItem,...n&&oe.buttonMenuItemBorder},pressedStyle:oe.buttonMenuItemPressed,title:t.title,titleStyle:oe.title,right:t.isSelectedOption?(0,g.k)(oe.icon):void 0}),action:()=>{t.action.action({environment:K,blocks:[],lazyDependencies:{markdownLinkifyIt:void 0,tinyMceMicrosoftWordPasteFilter:void 0,ai:void 0,assistant:void 0},publicEditMode:void 0}),e.close()}}}))}],initialFocus:void 0,onAccept:()=>e.close()})}),renderOrigin:t=>(0,F.jsx)(Z.Z,{ariaLabel:O.formatMessage(_.changePageNotificationSettings),style:ie.button,icon:d.O,iconStyle:{...ie.iconStyle,...ie.archiveIcon,...W&&{height:18,width:18,...ie.inboxIconBase}},...e,...(0,M.Z)(t,{onClick:()=>te()})})})},"pageNotificationSettings"):void 0;return(0,F.jsx)("div",{style:ie.container,children:W?[se,ae,ne]:[ne,ae,se]})}const z=o.memo(D)},24764:(e,t,i)=>{i.d(t,{t:()=>k,Z:()=>y});i(67294);var o=i(92996),n=i(98519),a=i(97880),s=i(9291),r=i(62967),d=i(57883),l=i(19719),c=i(9953),g=i(82530);function m(e){const{environment:t,key:i,selectedKey:o,following:n,followSettings:a,navigableBlockId:s,userId:r,spaceId:m,from:p}=e;g.createAndCommit({userAction:"UpdateSidebarFollowControl.setFollowing",environment:e.environment,canUndo:!1,perform:t=>{c.Ue({environment:e.environment,table:d.t0,args:{following:n,followSettings:a,navigableBlockId:s,userId:r,spaceId:m},inMemoryRecordCache:e.environment.defaultRecordCache.inMemoryRecordCache,transaction:t})}}),n?l.RJ(t,{from:"page_updates"}):l.ub(t,{from:"page_updates"}),o!==i&&l.kL(t,{from:p,navigableBlockId:s,oldSetting:o,newSetting:i})}var p=i(64964),h=i(93405),u=i(64369),f=i(80444),b=i(57538),v=i(85893);function y(e){const{followSettingsKey:t,environment:i,blockStore:n,from:a}=e,r=x({key:"none",selectedKey:t,title:(0,v.jsx)(s.FormattedMessage,{id:"GetNotifiedDropdown.repliesAndMentions.label",defaultMessage:"Replies and @mentions"}),environment:i,blockStore:n,from:a}),d=x({key:"comments",selectedKey:t,title:(0,v.jsx)(s.FormattedMessage,{id:"GetNotifiedDropdown.allComments.label",defaultMessage:"All comments"}),environment:i,blockStore:n,from:a}),l=x({key:"all",selectedKey:t,title:(0,v.jsx)(s.FormattedMessage,{id:"GetNotifiedDropdown.allUpdates.label",defaultMessage:"All updates"}),caption:(0,v.jsx)(s.FormattedMessage,{id:"GetNotifiedDropdown.simpleAllUpdates.caption",defaultMessage:"All comments and property changes"}),environment:i,blockStore:n,from:a}),c=n.getAssociatedCollectionStore();if(!c)return[d,r];const g=c.getDatabaseType();if(g===o.iS){return[l,x({key:"important",selectedKey:t,title:(0,v.jsx)(s.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesTasks.label",defaultMessage:"Important updates"}),caption:(0,v.jsx)(s.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesTasks.caption",defaultMessage:"All comments and changes to Status, Assignee, or Due Date"}),environment:i,blockStore:n,from:a}),r]}if(g===o.wW){return[l,x({key:"important",selectedKey:t,title:(0,v.jsx)(s.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesProjects.label",defaultMessage:"Important updates"}),caption:(0,v.jsx)(s.FormattedMessage,{id:"GetNotifiedDropdown.importantUpdatesProjects.caption",defaultMessage:"All comments and changes to Status or Date"}),environment:i,blockStore:n,from:a}),r]}return[l,x({key:"comments",selectedKey:t,title:(0,v.jsx)(s.FormattedMessage,{id:"GetNotifiedDropdown.onlyCommentsAllComments.label",defaultMessage:"All comments"}),environment:i,blockStore:n,from:a}),r]}function x(e){const{key:t,title:i,caption:o,selectedKey:a,environment:s,blockStore:d,from:l}=e,c=k({key:t,userSelectedKey:a}),g={icon:{width:14,height:14},rightWrapper:o?{alignSelf:"flex-start",paddingTop:2}:{}};return{action:(0,r.cN)({key:t,displayName:void 0,analyticsName:t,validators:[],closeParentMenu:!0,action:()=>{const{currentUserRootStore:e}=f.default.state;if(e){const{following:i,followSettings:o}=(0,b.Z)(t),n=e.id,r=d.id,c=d.getSpaceId();m({environment:s,following:i,followSettings:o,navigableBlockId:r,spaceId:c,userId:n,from:l,key:t,selectedKey:a}),"inbox"!==l&&"more_menu"!==l||p.d4({item:{label:S(t)},undoFunc:()=>{const{following:e,followSettings:i}=(0,b.Z)(a);m({environment:s,following:e,followSettings:i,navigableBlockId:r,spaceId:c,userId:n,from:l,key:t,selectedKey:a})}})}},render:e=>(0,v.jsx)(h.Z,{...e,title:(0,v.jsx)(u.Z,{children:i}),caption:o,shouldWrapCaption:!0,right:c?(0,n.k)(g.icon):(0,v.jsx)("div",{style:g.icon}),rightStyle:g.right})}),title:i,isSelectedOption:c}}function k(e){const{key:t,userSelectedKey:i}=e;return"important"===i||"comments"===i?"important"===t||"comments"===t:t===i}function S(e){switch(e){case"none":return(0,v.jsx)(s.FormattedMessage,{id:"GetNotifiedDropdown.subscribedRepliesAndMentionsSuccess.snackbarMessage",defaultMessage:"Subscribed to replies and @mentions"});case"comments":return(0,v.jsx)(s.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllCommentsSuccess.snackbarMessage",defaultMessage:"Subscribed to all comments"});case"important":return(0,v.jsx)(s.FormattedMessage,{id:"GetNotifiedDropdown.subscribedImportantUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to important updates"});case"all":return(0,v.jsx)(s.FormattedMessage,{id:"GetNotifiedDropdown.subscribedAllUpdatesSuccess.snackbarMessage",defaultMessage:"Subscribed to all updates"});default:(0,a.t1)(e)}}},57538:(e,t,i)=>{i.d(t,{Z:()=>a});var o=i(57883),n=i(97880);function a(e){switch(e){case"all":return{following:!0,followSettings:(0,o.yI)({explicitly_set_by_user:!0})};case"important":return{following:!0,followSettings:(0,o.GC)({explicitly_set_by_user:!0})};case"comments":return{following:!0,followSettings:(0,o.r$)({explicitly_set_by_user:!0})};case"none":return{following:!1,followSettings:(0,o.vU)({explicitly_set_by_user:!0})};default:(0,n.t1)(e)}}},46096:(e,t,i)=>{i.d(t,{Z:()=>a});var o=i(49085);class n extends o.default{getInitialState(){return{open:!1}}}const a=new n},52867:(e,t,i)=>{i.d(t,{H:()=>a});i(67294);var o=i(45238),n=i(85893);const a=(0,o.I)("archive",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M4.083 14.585h7.499c1.347 0 2.064-.697 2.064-2.037V5.739c.664-.11 1.019-.608 1.019-1.34V3.36c0-.834-.458-1.36-1.299-1.36H2.3C1.499 2 1 2.526 1 3.36V4.4c0 .73.355 1.23 1.019 1.34v6.808c0 1.347.717 2.037 2.064 2.037zM2.579 4.728c-.342 0-.478-.144-.478-.486v-.724c0-.342.136-.486.478-.486h10.514c.342 0 .472.144.472.486v.724c0 .342-.13.486-.472.486H2.579zm1.49 8.825c-.615 0-.95-.335-.95-.95V5.76h9.427v6.842c0 .616-.342.95-.95.95H4.069zM5.58 8.515h4.512c.287 0 .492-.199.492-.5v-.218c0-.3-.205-.492-.492-.492H5.58c-.287 0-.485.191-.485.492v.219c0 .3.198.499.485.499z"})})},90334:(e,t,i)=>{i.d(t,{O:()=>a});i(67294);var o=i(45238),n=i(85893);const a=(0,o.I)("ellipsis",{viewBox:"0 0 16 16",svg:(0,n.jsx)("path",{d:"M2.887 9.014c.273 0 .52-.064.738-.192.219-.132.394-.307.526-.526.133-.219.199-.46.199-.725 0-.405-.142-.747-.424-1.025a1.41 1.41 0 00-1.04-.417c-.264 0-.505.066-.724.198a1.412 1.412 0 00-.718 1.244c0 .265.064.506.192.725.132.219.307.394.526.526.219.128.46.192.725.192zm5.113 0a1.412 1.412 0 001.244-.718c.132-.219.198-.46.198-.725 0-.405-.14-.747-.423-1.025A1.386 1.386 0 008 6.129c-.264 0-.506.066-.725.198a1.412 1.412 0 00-.718 1.244c0 .265.064.506.192.725.132.219.308.394.526.526.22.128.46.192.725.192zm5.106 0c.265 0 .506-.064.725-.192.219-.132.394-.307.526-.526.133-.219.199-.46.199-.725 0-.405-.142-.747-.424-1.025a1.394 1.394 0 00-1.026-.417 1.474 1.474 0 00-1.265.718c-.127.218-.19.46-.19.724 0 .265.063.506.19.725.133.219.308.394.527.526.223.128.47.192.738.192z"})})},70753:(e,t,i)=>{i.d(t,{F:()=>a});i(67294);var o=i(45238),n=i(85893);const a=(0,o.I)("notificationRead",{viewBox:"0 0 18 18",svg:(0,n.jsx)("path",{d:"M3.066 17.998h11.846c2.05 0 3.066-1.016 3.066-3.027V3.047c0-2.012-1.015-3.027-3.066-3.027H3.066C1.026.02 0 1.025 0 3.047V14.97c0 2.021 1.025 3.027 3.066 3.027Zm.02-1.572c-.977 0-1.514-.518-1.514-1.533V3.125c0-1.016.537-1.533 1.514-1.533h11.807c.966 0 1.513.517 1.513 1.533v11.768c0 1.015-.547 1.533-1.513 1.533Zm4.844-2.793c.322 0 .595-.156.79-.46l4.464-7.02c.117-.196.234-.41.234-.626 0-.44-.39-.722-.791-.722-.254 0-.498.156-.684.44l-4.052 6.503-1.924-2.49c-.235-.313-.45-.39-.713-.39a.759.759 0 0 0-.762.77c0 .216.088.42.225.606l2.383 2.93c.244.322.507.459.83.459Z"})})},61248:(e,t,i)=>{i.d(t,{F:()=>a});i(67294);var o=i(45238),n=i(85893);const a=(0,o.I)("notificationUnread",{viewBox:"0 0 20 21.5",svg:(0,n.jsx)("path",{d:"M0 14.521c0 1.67.146 3.057 1.143 4.053.996.996 2.402 1.153 4.062 1.153h7.588c1.67 0 3.076-.157 4.072-1.153s1.143-2.383 1.143-4.053v-6.65c-.43.147-.899.225-1.387.205-.068.02-.117.02-.185.03v6.68c0 1.015-.127 2.05-.723 2.646-.586.586-1.64.722-2.647.722H4.941c-1.005 0-2.06-.136-2.656-.722-.586-.596-.713-1.631-.713-2.647V6.768c0-1.026.127-2.08.713-2.666.596-.596 1.66-.723 2.686-.723h6.738c0-.068.01-.127.02-.186-.02-.488.058-.957.205-1.386H5.186c-1.641 0-3.047.156-4.043 1.152C.146 3.955 0 5.352 0 6.982Zm16.426-7.744c1.846 0 3.379-1.533 3.379-3.388C19.805 1.533 18.27 0 16.425 0a3.403 3.403 0 0 0-3.388 3.389 3.403 3.403 0 0 0 3.389 3.388Z"})})},8504:(e,t,i)=>{i.d(t,{J:()=>a});i(67294);var o=i(45238),n=i(85893);const a=(0,o.I)("versionHistoryThick",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{d:"M0 7C0 3.136 3.129 0 6.993 0C10.864 0 14 3.136 14 7C14 10.864 10.864 14 6.993 14C3.129 14 0 10.864 0 7ZM1.4 7C1.4 10.094 3.906 12.6 7 12.6C10.094 12.6 12.6 10.094 12.6 7C12.6 3.906 10.094 1.4 7 1.4C3.906 1.4 1.4 3.906 1.4 7ZM6.3 3.5H7.35V7.175L10.5 9.044L9.975 9.905L6.3 7.7V3.5Z"})})},70693:(e,t,i)=>{i.d(t,{mb:()=>r,nK:()=>d,pe:()=>l});var o=i(40506),n=i(7057),a=i(53877),s=i(42875);function r(e){const{dateTime:t,intl:i,shortenDateAndRange:o}=e,s=a.OQ.toPersistedDate(t.valueOf());return n.ZV({value:s,allowRelativeDates:!0,intl:i,shortenDateAndRange:o,displayInUserTimezone:!0})}function d(e){const{dateTime:t,intl:i,userTimeZone:o,displayInUserTimezone:s,alwaysIncludeTimezone:r}=e,d=a.OQ.toPersistedDateTime(t.valueOf(),t.zoneName);return n.ZV({value:d,allowRelativeDates:!0,intl:i,userTimeZone:o,displayInUserTimezone:s,alwaysIncludeTimezone:r})}function l(e){const{luxonRange:t,intl:i}=e,r=a.OQ.toPersistedDateRange(t),d=n.ZV({value:r,allowRelativeDates:!1,shortenDateAndRange:!0,intl:i,displayInUserTimezone:!0}),l=t.end.setZone((0,s.r)()),c=n.mr({start_time:l.toFormat(o.jK),humanReadable:!1,intl:i});return i.formatMessage({id:"verification.timeRange",defaultMessage:"{formattedDateRange} at {formattedEndTime}"},{formattedDateRange:d,formattedEndTime:c})}}}]);