"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[5008],{26797:(e,t,i)=>{i.d(t,{Fv:()=>w,JN:()=>M,QG:()=>B,cQ:()=>A,f$:()=>C,fX:()=>T,td:()=>k,xD:()=>I});i(57658);var o=i(30120),n=i(80951),s=i(40506),r=i(53877),a=i(42875),l=i(72126),c=i(6287),d=i(97880),u=i(10906),m=i(95802),p=i(15723),h=i(17746),b=i(79797),g=i(8406),f=i(54569),S=i(75134),y=i(42239),v=i(19785),x=i(9953);function M(e){const{environment:t,droppedStores:i,duplicate:l,calendarBy:d,transaction:m,collectionContextStore:p}=e,h=o.ou.fromMillis(e.startOfDay);let b=!0;for(const o of i){const t=e.collectionStore?e.collectionStore:(0,u.Bm)({store:o,collectionContextStore:p});if(o.getParentTable()===c.v||!t){b=!1;break}v.zw({childStore:o,parentStore:t,transaction:m})||(b=!1)}const S=y.LQ({environment:t,droppedStores:i,duplicate:l,duplicateUseCrdt:!1,transaction:m,resolveTemplateVariables:!1});for(const o of S){const i=e.collectionStore?e.collectionStore:(0,u.Bm)({store:o,collectionContextStore:p});if(!i)continue;const l=i.getMappedProperty(d),c=o.getPropertyStore(l),S=n.Gl(c.getValue())||r.Lg((0,a.r)()),y=r.c$(S,(0,a.r)()),v=h.toFormat(r.Iq);let x;if("date"===y.type||"datetime"===y.type)x={...y,start_date:v};else{const e=r.NK(y,(0,a.r)());if(!e.end)return;const t={...y,start_date:v},i=r.NK(t,(0,a.r)()).start.diff(e.start,"days"),o=e.end.plus(i).toFormat(r.Iq);x={...y,start_date:v,end_date:o}}const M=r.c$(x,s.yw(S)||(0,a.r)());f.mp({environment:t,store:o,collectionStore:i,collectionContextStore:p,shouldCoerce:!0,groupsPointer:[],transaction:m,alreadyMovedToCollection:b}),I({environment:t,type:"dateValue",propertyId:l,store:o,transaction:m,dateValue:M}),g.rv({environment:t,collectionContextStore:p,block_id:o.id,property:l,property_type:"date",from:"calendar"})}}function C(e){const{calendarStore:t,direction:i,target:o}=e;t.setState({...t.state,isDragging:!0,target:o,direction:i,temporaryValue:void 0})}function k(e){const{calendarStore:t,x:i,y:c,calendarBy:d}=e,u=t.state;if(u.isDragging){const e=n.Gl(u.target.getPropertyStore(d).getValue());if(!e)return;const b=r.c$(e,(0,a.r)()),g=u.temporaryValue||e,f=r.c$(g,(0,a.r)()),S=[];u.dayStoreMap.forEach(((e,t)=>{S.push({store:e,timestamp:t})}));const y=S.find((e=>{let{store:t}=e;const o=m.C.getRectFromStore(t);return Boolean(o&&p.uh(o,i,c))}));let v;if(y){const e=o.ou.fromMillis(y.timestamp),t=e.endOf("day"),i=e.toFormat(r.Iq);if(b){const n=r.NK(b,(0,a.r)());if(u.direction===h.t.Left)if(o.Xp.fromDateTimes(e,t).contains(n.start))v=b;else{let e;e="datetimerange"===b.type||"daterange"===b.type?{...b,start_date:i,end_date:b.end_date}:"datetime"===b.type?{type:"datetimerange",start_date:i,start_time:b.start_time,end_date:b.start_date,end_time:b.start_time,time_zone:b.time_zone,reminder:b.reminder}:{type:"daterange",start_date:i,end_date:b.start_date,reminder:b.reminder};const t=r.NK(e,(0,a.r)());v=!n.end&&t.start>n.start||n.end&&t.start>n.end?f:e}else if(n.end?o.Xp.fromDateTimes(e,t).contains(n.end):o.Xp.fromDateTimes(e,t).contains(n.start))v=b;else{let e;e="date"===b.type?{...b,type:"daterange",end_date:i}:"datetime"===b.type?{...b,type:"datetimerange",end_date:i,end_time:"00:00"}:{...b,end_date:i};const t=r.NK(e,(0,a.r)());v=t.end&&t.end<t.start?f:e}}}if(v&&!l.Xy(f,v)){const e=r.c$(v,s.yw(g)||(0,a.r)());t.setState({...u,temporaryValue:e})}}}function T(e){const{environment:t,calendarStore:i,calendarBy:o,transaction:n}=e,s=i.state;s.isDragging&&s.temporaryValue&&(I({type:"dateValue",environment:t,dateValue:s.temporaryValue,propertyId:o,store:s.target,transaction:n}),i.setState({...i.state,isDragging:!1}))}function A(e){const{calendarStore:t}=e,i=t.state;i.isDragging&&t.setState({...i,isDragging:!1})}function w(e){const{environment:t,store:i,collectionStore:s,collectionContextStore:l,startDayOfWeek:c,transaction:d}=e,u=l.dateRangeStart.state,m=(0,a.r)(),p=l.normalizedQueryStore.state;if(!p||!p.calendar_by)return;const h=(null==s?void 0:s.getMappedProperty(p.calendar_by))??p.calendar_by,b=r.gQ(u,c,m),g=b.startOf("month"),S=b.endOf("month"),y=o.ou.now().startOf("day");let v;return v=o.Xp.fromDateTimes(g,S).contains(y)?r.hT(y.valueOf(),m):r.hT(r.em(u,c,m).valueOf(),m),x.sW({store:i.getPropertiesStore(),data:{[h]:n.d7(v)},transaction:d}),f.mp({environment:t,store:i,collectionStore:s,collectionContextStore:l,shouldCoerce:!0,groupsPointer:[],transaction:d}),i}function I(e){const{environment:t,store:i,propertyId:o,transaction:s}=e;let l;"timestamp"===e.type?l=r.hT(e.timestampMs.valueOf(),(0,a.r)()):"dateValue"===e.type?l=e.dateValue:(0,d.t1)(e);const c=i.getPropertyValue(o),u=n.d7(l);x.sW({store:i.getPropertiesStore(),data:{[o]:u},transaction:s}),S.H({environment:t,store:i,dateProperty:{id:o,oldValue:c,newValue:u}})}function B(e){const{environment:t,collectionStore:i,calendarBy:o,store:n,insertStores:s,collectionContextStore:r,transaction:a}=e,l=n.getPropertyStore(o).getValue();for(const c of s)f.mp({environment:t,store:c,collectionStore:i,collectionContextStore:r,shouldCoerce:!0,groupsPointer:[],transaction:a}),x.sO({store:c.getPropertyStore(o),value:l,transaction:a});return s.map((e=>b.G.createChildStore(i,e.pointer)))}},59389:(e,t,i)=>{i.d(t,{T_:()=>g,Ud:()=>f,eV:()=>b});var o=i(1302),n=i(45953),s=i(42),r=i(58202),a=i(952),l=i(41433),c=i(96802),d=i(94419),u=i(9953),m=i(24677),p=i(98104),h=i(68422);function b(e){const{environment:t,store:i,transaction:n,preventTextSelection:s,onTextSelection:r}=e,l=i.useCrdt(),c=u.j4({environment:t,type:"text",inMemoryRecordCache:i.inMemoryRecordCache,transaction:n,spaceId:i.pointer.spaceId,useCrdt:l}),h=d.R3({parent:i.getContentStore(),append:c,transaction:n}).child;return s||o.default.afterNextFlush((()=>{m.eP({environment:t,store:h}),p.N_({store:h.getBlockTitleStore()}),null==r||r()})),a.W(t,{from:"template_picker",type:"text",creating_block_id:c.id}),h}function g(e){const{environment:t,store:i,transaction:o}=e;c.is({store:i,transaction:o}),b({environment:t,store:i,transaction:o})}function f(e){var t;const{environment:i,store:c,viewType:d,transaction:m}=e,p=null===(t=c.getBlockTitleStore())||void 0===t?void 0:t.getValue();l.ZI({environment:i,sourceBlockId:"root",targetBlockPointer:c.pointer,sourceBlockSubtree:(0,n.R3)((0,s.iC)({isInline:!1,viewType:d})),targetRecordCache:c.inMemoryRecordCache,transaction:m,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:c.useCrdt()}),h.vs({environment:i,block:c,blockType:"collection_view_page",transaction:m}),p&&u.sO({store:c.getBlockTitleStore(),value:p,transaction:m}),o.default.afterNextFlush((()=>{const e=r.R.findCollectionViewBlockFromStore(c);null==e||e.handleCreated()})),a.W(i,{from:"template_picker",type:"collection_view_page",creating_block_id:c.id})}},75498:(e,t,i)=>{i.d(t,{Z:()=>f});var o=i(67294),n=i(83355),s=i(1302),r=i(86628),a=i(49085),l=i(72126),c=i(71644),d=i(75330),u=i(77080),m=i(48190),p=i(85893);class h extends n.Z{constructor(){super(...arguments),this.reducerId=this.props.id,this.instanceId=(0,c.ZP)(),this.localResultStoreChangeIsQueued=!1,this.storeTypes={resultStore:a.default.createClass(void 0)},this.handleLocalResultStoreChange=()=>{this.localResultStoreChangeIsQueued||(this.localResultStoreChangeIsQueued=!0,s.default.afterNextFlush(this.dequeueLocalResultStoreChange))},this.dequeueLocalResultStoreChange=()=>{const{resultStore:e}=this.stores;if(this.localResultStoreChangeIsQueued=!1,!this.componentIsMounted)return;const t=this.getCurrentResult();l.Xy(t,e.state)||e.setState(t)}}UNSAFE_willMount(e){const{collectionContextStore:t}=e;t.remoteResult.addListener(this.handleLocalResultStoreChange),t.localResultStore.addListener(this.handleLocalResultStoreChange),this.updateReducer(e),this.handleLocalResultStoreChange()}UNSAFE_willUpdate(e){this.updateReducer(e)}willUnmount(){super.willUnmount();const{collectionContextStore:e,groupsPointer:t}=this.props;d.$D({reducerId:this.reducerId,instanceId:this.instanceId,reducer:void 0,collectionContextStore:e,groupsPointer:t}),e.remoteResult.removeListener(this.handleLocalResultStoreChange),e.localResultStore.removeListener(this.handleLocalResultStoreChange)}renderComponent(){const{render:e}=this.props;if(e)return e(this.stores.resultStore)}updateReducer(e){const{reducer:t,collectionContextStore:i,groupsPointer:o}=e;d.$D({reducerId:this.reducerId,instanceId:this.instanceId,reducer:t,collectionContextStore:i,groupsPointer:o})}getCurrentResult(){const{reducer:e,collectionContextStore:t}=this.props,i=t.localResultStore.state,o=t.remoteResult.state,n=i&&"reducer"===i.type?i.reducerResults[this.reducerId]:void 0,s=o&&"reducer"===o.type?o.reducerResults[this.reducerId]:void 0;return(0,m.P)({reducerId:this.reducerId,localReducerResult:n,remoteReducerResult:s,reducer:e,collectionContextStore:t})}}function b(e){window.__c={n:"MigratedCollectionReducerRequest"};const{resultStore:t,render:i,...n}=e,s=(0,m.Z)(n),l=(0,r.qz)(t,a.default.createClass(void 0));(0,o.useEffect)((()=>{l.setState(s)}),[s,l]);const c=(0,r.VK)((()=>i?i(l):null),[i,l]);return(0,p.jsx)(p.Fragment,{children:c})}h.displayName="CollectionReducerRequest";const g=o.memo(b);const f=function(e){window.__c={n:"CollectionReducerRequest"};const t=(0,r.VK)((()=>u.default.checkGate("use_collection_reducer_request_hook")),[]),[i]=(0,o.useState)(t);return i?(0,p.jsx)(g,{...e}):(0,p.jsx)(h,{...e})}},20423:(e,t,i)=>{i.d(t,{Z:()=>v});i(67294);var o=i(480),n=i(86628),s=i(24405),r=i(45238),a=i(85893);const l=(0,r.I)("teamSize",{viewBox:"0 0 20 20",svg:(0,a.jsx)("path",{d:"M7.333 14.667a4.667 4.667 0 1 0 0-9.334 4.667 4.667 0 0 0 0 9.334zm4.356-.548A5.977 5.977 0 0 1 7.333 16a5.977 5.977 0 0 1-4.355-1.881A7.295 7.295 0 0 0 0 20h14.667a7.296 7.296 0 0 0-2.978-5.881zm1.599-4.832a4.664 4.664 0 1 0-5.242-5.241 6.01 6.01 0 0 1 5.242 5.241zm.003 1.347a6.024 6.024 0 0 1-.794 2.414 8.571 8.571 0 0 1 1.656 1.619H20a7.296 7.296 0 0 0-2.978-5.882 5.983 5.983 0 0 1-3.731 1.849z"})});var c=i(9291),d=i(1357),u=i(87279),m=i(88632),p=i(53610),h=i(35057),b=i(64921),g=i(31945),f=i(78140),S=(i(64369),i(27386),i(14694)),y=i(44625);const v=function(e){let{store:t}=e;window.__c={n:"MemberSettingsButton"};const i=(0,o.O7)(),s=(0,n.VK)((()=>(0,h.Mk)()),[]),r=(0,n.VK)((()=>t.isDefined()),[t]),{mobileNative:l}=i,d=(0,n.VK)((()=>(null==l?void 0:l.supportsNativeHomeOnPhone())||!1),[l]),v=(0,n.VK)((()=>m.Z.state.online),[]);return s&&r?(0,a.jsx)(g.ZP,{buttonPopupStore:p.Z,popupType:g.Z4.SlideUp,hidesMobileNativeBottomBar:d,preventSlideUpTransition:d,renderOrigin:e=>(0,a.jsx)(b.Z,{mobileFeedback:!0,...e,children:(0,a.jsx)(S.Z,{left:(0,a.jsx)(x,{}),disableMobileBorder:!0,children:(0,a.jsx)(c.FormattedMessage,{defaultMessage:"Members",id:"memberSettingsButton.mobileSidebar.label"})})}),render:()=>{if(v){const e={menuType:u.og.Modal,title:(0,a.jsx)(c.FormattedMessage,{defaultMessage:"Members",id:"memberSettingsButton.mobileMemberSettings.title"}),right:(0,a.jsx)(c.FormattedMessage,{defaultMessage:"Done",id:"memberSettingsButton.rightActionButton.done"}),onClickRight:()=>M(i),onCancel:()=>M(i)};return(0,a.jsx)(f.Z,{...e,children:(0,a.jsx)(y.Z,{store:t,isMobile:!0})})}}}):null};function x(){window.__c={n:"IconComponent"};const e=(0,s.Fg)();return l({fill:e.mediumIconColor,width:16})}function M(e){const{mobileNative:t}=e,i=()=>{p.Z.setState({open:!1})};null!=t&&t.supportsNativeHomeOnPhone()?d.d(e,i):i()}},20066:(e,t,i)=>{i.r(t),i.d(t,{default:()=>X});i(67294);var o=i(83355),n=i(13991),s=i(480),r=i(86628),a=i(24405),l=i(41432),c=i(42853),d=i(69634),u=i(5377),m=i(45238),p=i(85893);const h=(0,m.I)("indentDown",{viewBox:"0 0 30 30",svg:(0,p.jsx)("path",{d:"M24,15l-1.406-1.406L16,20.188V2h-2v18.188l-6.594-6.594L6,15l9,9L24,15z M2,26v2h26v-2H2z"})}),b=(0,m.I)("keyboard",{viewBox:"0 0 30 30",svg:(0,p.jsxs)("g",{children:[" ",(0,p.jsx)("path",{d:"M15,30l8-10H7Zm0-3.2L11.16,22h7.68Z"})," ",(0,p.jsx)("path",{d:"M6,4H4V6H6V4Zm4,0H8V6h2V4Zm4,0H12V6h2V4Zm4,0H16V6h2V4Zm4,0H20V6h2V4Zm4,0H24V6h2V4ZM10,8H8v2h2V8Zm4,0H12v2h2V8Zm4,0H16v2h2V8Zm4,0H20v2h2V8Zm-2,4H10v2H20V12Zm5,0H22v2h3V12ZM5,14H8V12H5v2ZM0,0V18H30V0H0ZM28,16H2V2H28V16Z"})," "]})}),g=(0,m.I)("moveUp",{viewBox:"0 0 30 30",svg:(0,p.jsx)("path",{d:"M14,5.813V24h2V5.813l6.594,6.594L24,11l-9-9l-9,9l1.406,1.406L14,5.813z M2,26v2h26v-2H2z"})});var f=i(38491),S=i(45137),y=i(73426),v=i(33702),x=i(37612),M=i(55863),C=i(72126),k=i(82990),T=i(9291),A=i(83249),w=i(44886),I=i(52423),B=i(24677),P=i(98104),_=i(75179),j=i(51783),R=i(52533),Z=i(68056),V=i(89224),N=i(5162),O=i(17903),F=i(72653),D=i(69454),L=i(27724),E=i(24666),U=i(64921),H=i(53437),K=i(64131),q=i(82945),G=i(90108),W=i(40464),z=i(32404),$=i(73383);const Y={width:34,justifyContent:"center"},Q=42;class J extends o.Z{constructor(){super(...arguments),this.scrollerDiv=void 0,this.currentlyShownTimer=void 0,this.previouslyShownOnNative=!1,this.handleScrollerRef=e=>{e&&(this.scrollerDiv=e)},this.handleActionsScrollDebounced=C.Ds((()=>{return e=this.environment,void A.FG(e);var e}),500),this.listenForPositionChanges=this.createComputedStore((()=>{const e=E.default.state;if("editing"===e.mode){const t=e.multiSelection.end;return{scrollTop:O.Z.state.scrollTop,editing:!0,store:t.store.id,selection:t}}return{scrollTop:O.Z.state.scrollTop,editing:!1}})),this.renderStore=this.createComputedStore((()=>{var e;return j.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)})),this.shouldShowTextActions=this.createComputedStore((()=>j.oQ(this.props.stores.ignoreSelectionAreaStore,this.environment.TextSelectionCompositionStore))),this.canTriggerBlockActions=this.createComputedStore((()=>!this.shouldShowTextActions.state&&j.Bo(this.pageContext&&this.pageContext.publicEditModeStore.state))),this.canTriggerTextActions=this.createComputedStore((()=>j.eQ(this.pageContext&&this.pageContext.publicEditModeStore.state,this.props.currentBlockStore))),this.hasMultiBlockSelection=this.createComputedStore((()=>{const e=E.default.state;return"editing"===e.mode&&!(0,Z.qS)(e.multiSelection)}))}UNSAFE_willMountOrUpdate(){const{device:e}=this.environment,t=this.renderStore.state.shouldShow;if(e.isMobileBrowser){const e=this.props.stores.store.state.isOpen;t?e?void 0!==this.currentlyShownTimer&&(window.clearTimeout(this.currentlyShownTimer),this.currentlyShownTimer=void 0):(this.props.stores.store.setState({...this.props.stores.store.state,isOpen:!0}),this.scrollerDiv&&(this.scrollerDiv.scrollLeft=0)):e&&void 0===this.currentlyShownTimer&&(this.currentlyShownTimer=window.setTimeout((()=>{this.currentlyShownTimer=void 0,this.props.stores.store.setState({...this.props.stores.store.state,isOpen:!1})}),200))}else t!==this.previouslyShownOnNative&&(this.previouslyShownOnNative=t,this.scrollerDiv&&(this.scrollerDiv.scrollLeft=0))}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,i=function(e,t,i){const{device:o}=e;return o.isMobileBrowser?t.store.state.isOpen:i.state.shouldShow}(this.environment,this.props.stores,this.renderStore),o=e.isMobile&&F.Z.state;if(this.props.position===R.nd.Bottom){let e=0;return(0,N.Y)("supportsFixedSizeWebView")?e=D.Z.estimatedNativeWebBottomOverlap():o&&(e=t.getSafePaddingBottomCSS(G.MOBILE_BOTTOM_BAR_HEIGHT)),(0,p.jsx)("div",{style:{position:"absolute",bottom:e,left:0,height:Q,width:"100%",pointerEvents:i?"auto":"none",opacity:i?1:0,transform:i?"translateY(0)":`translateY(${Q}px)`,transition:"opacity 120ms ease-out, transform 120ms ease-out"},children:this.renderActionButtons()})}{this.listenForPositionChanges.state;const e=this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionRect||V.getSelectionRect();if(!e)return;const t=document.body.getBoundingClientRect(),o={...e,left:10,top:e.top+10-t.top},{device:n}=this.environment;return(0,p.jsx)(H.ZP,{popupType:n.isMobileNative?H.ZP.PopupType.SlideUp:H.ZP.PopupType.Popup,open:i,preventBlockRenderQueueOnEnter:!0,placementToOrigin:H.ZP.Placement.Bottom,alignmentToOrigin:H.ZP.Alignment.Start,originRect:o,disableMouseCapture:!0,keepFocus:!0,render:()=>(0,p.jsx)("div",{style:{height:Q,width:"calc(80wv)",borderRadius:4,overflow:"hidden"},children:this.renderActionButtons()})})}}renderActions(){return j.Tz({environment:this.environment,store:this.props.currentBlockStore})?(0,p.jsx)(ve,{stores:this.props.stores}):this.shouldShowTextActions.state?this.renderTextActions():this.renderBlockActions()}renderActionButtons(){return(0,p.jsxs)("div",{style:he(this.props.position,this.environment,this.theme),children:[this.renderActions(),(0,p.jsx)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...Se(this.environment.device.isSmallPhone,this.theme),borderLeft:pe(this.theme),borderRight:"none"},onClick:e=>{return t=this.props.stores,i=this.environment,B.ZH(i),t.store.setState({...t.store.state,isInsertOpen:!1}),me("hide_keyboard",i),void P.sD();var t,i},children:ce})]})}renderBlockActions(){const e=this.canTriggerBlockActions.state;let t=!1,i=!1;const o=this.props.currentBlockStore.getType();if(o){const e=this.props.currentBlockStore.getFormat();(0,l._T)(o,e)||(t=!0),(0,l.lQ)(o)||(i=!0)}const{device:n}=this.environment;return(0,p.jsxs)("div",{ref:this.handleScrollerRef,style:ue(),onScroll:this.handleActionsScrollDebounced,children:[(0,p.jsxs)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...Se(this.environment.device.isSmallPhone,this.theme),...!n.isSmallPhone&&{paddingLeft:12,paddingRight:12}},onClick:e=>{return t=this.props.stores,i=this.environment,t.store.setState({...t.store.state,isInsertOpen:!0}),void me("insert",i);var t,i},disabled:!e,children:[le,(0,p.jsx)(be,{})]}),(0,p.jsxs)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...Se(this.environment.device.isSmallPhone,this.theme),fontWeight:k.Z.fontWeight.medium},onClick:e=>{this.props.stores.store.setState({...this.props.stores.store.state,isTurnIntoOpen:!0}),me("turn_into",this.environment)},disabled:!e,children:[(0,p.jsx)(T.FormattedMessage,{defaultMessage:"Turn into",id:"mobileActionBar.turnInto.buttonTitle"}),(0,p.jsx)(be,{})]}),(0,p.jsx)(_.Z,{capture:!0,render:e=>(0,p.jsx)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,...e,style:Se(this.environment.device.isSmallPhone,this.theme),onClick:e=>{return t=this.environment,void j.Z3(t);var t},disabled:!i,children:(0,p.jsx)("span",{style:{fontSize:19,lineHeight:1,fontWeight:k.Z.fontWeight.medium,marginBottom:n.isAndroid?4:0},children:"@"})})}),(0,p.jsx)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:Se(this.environment.device.isSmallPhone,this.theme),onClick:e=>{return t=this.environment,void j.ol(t,!1,"mobile_action_bar");var t},disabled:!t,children:ae}),(0,p.jsx)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:Se(this.environment.device.isSmallPhone,this.theme),onClick:e=>{return t=this.environment,void j.vs(t);var t},disabled:!e,children:de}),(0,p.jsx)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:Se(this.environment.device.isSmallPhone,this.theme),onClick:e=>{return t=this.environment,void j.fn(t);var t},disabled:!e,children:re}),(0,p.jsx)(xe,{canTriggerBlockActionsStore:this.canTriggerBlockActions}),(0,p.jsx)(ye,{}),(0,p.jsxs)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...Se(this.environment.device.isSmallPhone,this.theme),fontWeight:k.Z.fontWeight.medium},onClick:e=>{this.props.stores.store.setState({...this.props.stores.store.state,isColorOpen:!0}),me("color",this.environment)},disabled:!e,children:[(0,p.jsx)(T.FormattedMessage,{defaultMessage:"Color",id:"mobileActionBar.color.buttonTitle"}),(0,p.jsx)(be,{})]}),(0,p.jsxs)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...Se(this.environment.device.isSmallPhone,this.theme),fontWeight:k.Z.fontWeight.medium},onClick:e=>function(e,t){j.w1(t,e.clientX,e.clientY)}(e,this.environment),disabled:!e,children:[(0,p.jsx)(T.FormattedMessage,{defaultMessage:"More",id:"mobileActionBar.more.buttonTitle"}),(0,p.jsx)(be,{})]})]})}renderTextActions(){const e=this.canTriggerTextActions.state,t=this.hasMultiBlockSelection.state,i=this.props.currentBlockStore.canComment(),o=L.default.state.stores[0],s={display:"flex",alignItems:"center",padding:"0 8px",whiteSpace:"nowrap"};return(0,p.jsxs)("div",{style:ue(),onScroll:this.handleActionsScrollDebounced,children:[(0,p.jsx)(q.Z,{style:Se(this.environment.device.isSmallPhone,this.theme),blockStore:L.default.state.stores[0],disabled:!i}),(0,p.jsx)(W.Z,{type:"b",style:Se(this.environment.device.isSmallPhone,this.theme),onClick:()=>me("bold",this.environment),disabled:!e,children:(0,p.jsx)("span",{style:{fontWeight:k.Z.fontWeight.semibold},children:(0,p.jsx)(T.FormattedMessage,{defaultMessage:"B",id:"mobileActionBar.bold.symbol"})})}),(0,p.jsx)(W.Z,{type:"i",style:Se(this.environment.device.isSmallPhone,this.theme),onClick:()=>me("italic",this.environment),disabled:!e,children:(0,p.jsx)("span",{style:{fontStyle:"italic",fontWeight:k.Z.fontWeight.semibold},children:(0,p.jsx)(T.FormattedMessage,{defaultMessage:"i",id:"mobileActionBar.italic.symbol"})})}),(0,p.jsx)(W.Z,{type:"_",style:Se(this.environment.device.isSmallPhone,this.theme),onClick:()=>me("underline",this.environment),disabled:!e,children:(0,p.jsx)("span",{style:{textDecoration:"underline"},children:(0,p.jsx)(T.FormattedMessage,{defaultMessage:"U",id:"mobileActionBar.underline.symbol"})})}),(0,p.jsx)(W.Z,{type:"s",style:Se(this.environment.device.isSmallPhone,this.theme),onClick:()=>me("strike_through",this.environment),disabled:!e,children:(0,p.jsx)("span",{style:{textDecoration:"line-through"},children:(0,p.jsx)(T.FormattedMessage,{defaultMessage:"S",id:"mobileActionBar.strikeThrough.symbol"})})}),(0,p.jsx)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:s,disabled:!w.gq(o),onClick:e=>ge(e,this.environment),children:ee}),(0,p.jsx)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...s,borderRight:pe(this.theme)},disabled:!w.nt(o),onClick:e=>fe(e,this.environment),children:te}),(0,p.jsx)(W.Z,{type:"c",style:Se(this.environment.device.isSmallPhone,this.theme),onClick:()=>me("code",this.environment),disabled:!e,children:(0,p.jsx)("span",{style:{fontFamily:k.Z.getCompositeFontFamily(n.SP).githubMono},children:(0,p.jsx)(T.FormattedMessage,{defaultMessage:"Code",id:"mobileActionBar.code.symbol"})})}),(0,p.jsx)($.Z,{style:Se(this.environment.device.isSmallPhone,this.theme),disabled:!e||t,children:(0,p.jsx)("span",{style:{borderBottom:`1px solid ${this.theme.linkDecorationColor}`},children:(0,p.jsx)(T.FormattedMessage,{defaultMessage:"Link",id:"mobileActionBar.link.symbol"})})}),(0,p.jsx)(z.Z,{onClick:()=>me("equation",this.environment),disabled:!e||t,style:Se(this.environment.device.isSmallPhone,this.theme),children:(0,d.G)({width:16,height:16})}),(0,p.jsx)(K.Z,{style:Se(this.environment.device.isSmallPhone,this.theme),ignoreSelectionAreaStore:this.props.stores.ignoreSelectionAreaStore,disabled:!e})]})}}J.displayName="MobileActionBar";const X=(0,T.injectIntl)(J),ee=h({width:18,height:18,transform:"rotate(90deg)",position:"relative",left:1}),te=h({width:18,height:18,transform:"rotate(-90deg)",position:"relative",left:-1}),ie=g({width:18,height:18,position:"relative",left:2}),oe=g({width:18,height:18,transform:"rotate(180deg)",position:"relative",left:2}),ne=(0,M.s)({width:19,height:19}),se=(0,f.N)({width:19,height:19}),re=(0,x.y)({width:18,height:18}),ae=(0,S.o)({width:18,height:18}),le=(0,v.C)({width:14,height:14}),ce=b({width:18,height:18}),de=(0,u.y)({width:18,height:18});function ue(){return{flexGrow:1,flexShrink:1,marginRight:-1,display:"flex",overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch"}}function me(e,t){A.YO(t,{itemName:e})}function pe(e){return`1px solid ${e.regularDividerColor}`}function he(e,t,i){const{device:o,WindowSizeStore:n}=t;return{height:"100%",width:"100%",fontSize:15,display:"flex",boxShadow:e===R.nd.Bottom?i.bottomActionBarShadow:i.mediumBoxShadow,backgroundColor:i.keyboardActionBarBackground,paddingLeft:o.isMobileNative?n.state.paddingLeftCSS:0,paddingRight:o.isMobileNative?n.state.paddingRightCSS:0}}function be(){window.__c={n:"ChevronDownComponent"};const e=(0,a.Fg)();return(0,c.i)({width:10,marginLeft:4,fill:e.lightIconColor})}function ge(e,t){j.$$(t)}function fe(e,t){j.O2(t)}function Se(e,t){return{display:"flex",alignItems:"center",justifyContent:"center",paddingLeft:e?8:10,paddingRight:e?8:10,borderRight:pe(t),whiteSpace:"nowrap",height:Q,flexShrink:0,flexGrow:0,flexBasis:"auto",color:t.regularTextColor,minWidth:e?42:44}}function ye(){window.__c={n:"BlockUndoActionsComponent"};const e=(0,a.Fg)(),t=(0,s.O7)(),i=(0,r.VK)((()=>t.device.isSmallPhone),[t]),o=(0,r.VK)((()=>I.L0()),[]),n=(0,r.VK)((()=>I.AZ()),[]);return(0,p.jsxs)("div",{style:{...Se(i,e),paddingLeft:6,paddingRight:6},children:[(0,p.jsx)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:Y,disabled:!o,onClick:()=>function(e){j.i2(e)}(t),children:ne}),(0,p.jsx)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:Y,disabled:!n,onClick:()=>function(e){j.GH(e)}(t),children:se})]})}function ve(e){let{stores:t}=e;window.__c={n:"TemplatesButtonComponent"};const i=(0,a.Fg)(),o=(0,s.O7)(),n=(0,r.VK)((()=>o.device.isSmallPhone),[o]);return(0,p.jsx)("div",{style:{flexGrow:1,flexShrink:1,marginRight:-1,display:"flex",overflowX:"auto",overflowY:"hidden",WebkitOverflowScrolling:"touch"},children:(0,p.jsxs)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:{...Se(n,i),borderRight:"none",fontWeight:k.Z.fontWeight.medium},onClick:e=>{t.store.setState({...t.store.state,isTemplatesOpen:!0}),me("templates",o)},children:[(0,y.i)({width:20,marginRight:8}),(0,p.jsx)(T.FormattedMessage,{defaultMessage:"Choose a template...",id:"mobileActionBar.templates.buttonTitle"}),(0,p.jsx)(be,{})]})})}function xe(e){let{canTriggerBlockActionsStore:t}=e;window.__c={n:"BlockMovementActionsComponent"};const i=(0,a.Fg)(),o=(0,s.O7)(),n=(0,r.VK)((()=>t.state),[t]),l=(0,r.VK)((()=>L.default.state.stores[0]),[]),c=(0,r.VK)((()=>w.gq(l)),[l]),d=(0,r.VK)((()=>w.nt(l)),[l]),u=(0,r.VK)((()=>o.device.isSmallPhone),[o]);return(0,p.jsxs)("div",{style:{...Se(u,i),paddingLeft:6,paddingRight:6},children:[(0,p.jsx)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:Y,disabled:!n||!c,onClick:e=>ge(0,o),children:ee}),(0,p.jsx)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:Y,disabled:!n||!d,onClick:e=>fe(0,o),children:te}),(0,p.jsx)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:Y,disabled:!n,onClick:e=>function(e,t){j.s0(t)}(0,o),children:ie}),(0,p.jsx)(U.Z,{mobileFeedback:!0,disabledFeedback:!0,style:Y,disabled:!n,onClick:e=>function(e,t){j.rZ(t)}(0,o),children:oe})]})}},87038:(e,t,i)=>{i.r(t),i.d(t,{default:()=>L});var o=i(67294),n=i(83355),s=i(480),r=i(86628),a=i(24405),l=i(84465),c=i(51454),d=i(9291),u=i(21797),m=i(46225),p=i(11732),h=i(81193),b=i(86282),g=i(75179),f=i(87279),S=i(51783),y=i(80444),v=i(63334),x=i(29798),M=i(49085);class C extends M.default{getInitialState(){return{isOpen:!1,isInsertOpen:!1,isTurnIntoOpen:!1,isColorOpen:!1,isTemplatesOpen:!1}}}const k=C;var T=i(27724),A=i(24666),w=i(34583),I=i(65435),B=i(48019),P=i(56940),_=i(78140),j=i(32163),R=i(40721),Z=i(53437),V=i(72495),N=i(40698),O=i(34574),F=i(85893);class D extends n.Z{constructor(){super(...arguments),this.storeTypes={store:k,ignoreSelectionAreaStore:v.Z,templatePickerMenuListStore:x.Z},this.templatePreviewSectionsStore=this.createComputedStore((()=>{var e,t;return Object.entries((0,I.it)({userPersona:null===(e=y.default.state.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.persona,subscriptionTier:null===(t=y.default.state.currentSpaceStore)||void 0===t?void 0:t.getSubscriptionTier()})).map((e=>{let[t,i]=e;return{key:t,render:e=>(0,F.jsx)(V.Z,{title:(0,F.jsx)(d.FormattedMessage,{...l._5[t]}),children:e.children},t),items:i.map((e=>function(e,t){const i={key:e.name,render:t=>(0,o.createElement)(O.Z,{...t,key:e.name,title:e.name,type:"page_template",format:"phone-modal",locked:!1}),action:()=>{b.$7({environment:t,item:e,createNewPage:!1,isPrivate:!1})}};return i}(e,this.environment)))}}))})),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleCloseColorPopup=()=>K(this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleCloseInsertPopup=()=>q(this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleCloseTurnIntoPopup=()=>G(this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleCloseTemplatesPopup=()=>W(this.stores.store),this.renderStore=this.createComputedStore((()=>{var e;return S.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)}))}renderComponent(){const{device:e,WindowSizeStore:t}=this.environment,i=function(e,t,i){const{device:o}=e;return o.isMobileBrowser?t.state.isOpen:i.state.shouldShow}(this.environment,this.stores.store,this.renderStore),{makeActionBarComponent:n}=this.props;return(0,F.jsxs)(o.Fragment,{children:[(0,F.jsx)(g.Z,{capture:!0,render:e=>(0,F.jsxs)("div",{...e,style:{position:"relative",width:"100%",height:0,zIndex:c.Eo},children:[n(this.stores),(0,F.jsx)(H,{ignoreSelectionAreaStore:this.stores.ignoreSelectionAreaStore}),(0,F.jsx)(z,{store:this.stores.store}),(0,F.jsx)($,{store:this.stores.store}),(0,F.jsx)(Y,{store:this.stores.store}),(0,F.jsx)(Q,{currentBlockStore:this.props.currentBlockStore,store:this.stores.store,templatePickerMenuListStore:this.stores.templatePickerMenuListStore,templatePreviewSectionsStore:this.templatePreviewSectionsStore})]})}),!i&&e.isIPhoneX&&e.isNative&&(0,F.jsx)("div",{style:{position:"absolute",bottom:0,background:"transparent",height:t.state.paddingBottomCSS,width:"100%",pointerEvents:"none",WebkitUserSelect:"none"}})]})}}D.displayName="MobileActionBarWrapper";const L=(0,d.injectIntl)(D);function E(e,t){return e.isLargeDatabaseIcon?{width:16,fill:t.regularIconColor,marginLeft:4,marginRight:4}:{width:20,fill:t.regularIconColor,marginLeft:2,marginRight:2}}function U(e,t,i,n){const s=t;return{key:e.name,render:t=>{var i;return(0,o.createElement)(O.Z,{...t,key:e.name,format:"phone-modal",title:e.name,type:e.type,icon:null===(i=e.iconFn)||void 0===i?void 0:i.call(e,E(e,n)),locked:!1})},action:t=>{s&&w.M_(i)&&(h.rN(i,{template_name:e.name,is_keyboard:"keydown"===t.event.type}),e.onClick(i,s))}}}function H(e){let{ignoreSelectionAreaStore:t}=e;window.__c={n:"NativeMenuIgnoreSelectionAreaComponent"};const i=(0,s.O7)(),o=i.NativeMobileActionBarStore,n=(0,r.VK)((()=>"editing"!==A.default.state.mode&&!(null==o||!o.state.shouldRestoreSelectionForMenu)),[o]),a=(0,r.VK)((()=>S.y6(i)),[i]);return o?(0,F.jsx)(P.Z,{store:t,capture:a,ignoreBlockSelection:!1,restoreSelection:n,render:e=>null}):null}function K(e){e.setState({...e.state,isColorOpen:!1})}function q(e){e.setState({...e.state,isInsertOpen:!1})}function G(e){e.setState({...e.state,isTurnIntoOpen:!1})}function W(e){e.setState({...e.state,isTemplatesOpen:!1})}function z(e){let{store:t}=e;window.__c={n:"InsertPopupComponent"};const i=(0,s.O7)(),n=(0,o.useCallback)((()=>q(t)),[t]),{device:a}=i,l=(0,r.VK)((()=>t.state.isInsertOpen),[t]);return(0,F.jsx)(P.Z,{capture:l,ignoreBlockSelection:!1,restoreSelection:!1,render:e=>(0,F.jsx)(Z.ZP,{popupType:a.isMobile?Z.ZP.PopupType.SlideUp:Z.ZP.PopupType.Popup,preventBlockRenderQueueOnEnter:!0,open:l,keepFocus:!0,onDismiss:()=>{e(),q(t)},render:()=>(0,F.jsx)(_.Z,{menuType:f.og.Modal,title:(0,F.jsx)(d.FormattedMessage,{defaultMessage:"Insert block",id:"mobileActionBar.insertBlock.modalTitle"}),right:(0,F.jsx)(R.CancelMenuText,{}),onClickRight:()=>{e(),q(t)},children:(0,F.jsx)(B.Z,{sections:m.w.state.insertActions,context:{environment:i,blocks:T.default.state.stores,publicEditMode:void 0},onAccept:n})})})})}function $(e){let{store:t}=e;window.__c={n:"TurnIntoPopupComponent"};const i=(0,s.O7)(),n=(0,o.useCallback)((()=>G(t)),[t]),a=(0,r.VK)((()=>t.state.isTurnIntoOpen),[t]),{device:l}=i;return(0,F.jsx)(P.Z,{capture:a,ignoreBlockSelection:!1,restoreSelection:!0,render:()=>(0,F.jsx)(Z.ZP,{popupType:l.isMobile?Z.ZP.PopupType.SlideUp:Z.ZP.PopupType.Popup,open:a,keepFocus:!0,onDismiss:n,preventBlockRenderQueueOnEnter:!0,render:()=>(0,F.jsx)(_.Z,{menuType:f.og.Modal,title:(0,F.jsx)(d.FormattedMessage,{defaultMessage:"Turn into",id:"mobileActionBar.turnInto.modalTitle"}),right:(0,F.jsx)(R.CancelMenuText,{}),onClickRight:n,children:(0,F.jsx)(B.Z,{sections:[{...p.g,title:""}],context:{environment:i,blocks:T.default.state.stores,publicEditMode:void 0},onAccept:n})})})})}function Y(e){let{store:t}=e;window.__c={n:"ColorPopupComponent"};const i=(0,s.O7)(),n=(0,o.useCallback)((()=>K(t)),[t]),{device:a}=i,l=(0,r.VK)((()=>t.state.isColorOpen),[t]);return(0,F.jsx)(P.Z,{capture:l,ignoreBlockSelection:!1,restoreSelection:!0,render:()=>(0,F.jsx)(Z.ZP,{popupType:a.isMobile?Z.ZP.PopupType.SlideUp:Z.ZP.PopupType.Popup,open:l,keepFocus:!0,onDismiss:n,preventBlockRenderQueueOnEnter:!0,render:()=>(0,F.jsx)(_.Z,{menuType:f.og.Modal,title:(0,F.jsx)(d.FormattedMessage,{defaultMessage:"Block color",id:"mobileActionBar.blockColor.modalTitle"}),right:(0,F.jsx)(R.CancelMenuText,{}),onClickRight:n,children:(0,F.jsx)(B.Z,{sections:[u.te,u.rz,u.Vm],context:{environment:i,blocks:T.default.state.stores,publicEditMode:void 0},onAccept:n})})})})}function Q(e){let{currentBlockStore:t,store:i,templatePickerMenuListStore:n,templatePreviewSectionsStore:l}=e;window.__c={n:"TemplatesPopupComponent"};const c=(0,a.Fg)(),u=(0,s.O7)(),m=(0,o.useCallback)((()=>W(i)),[i]),p=(0,r.VK)((()=>i.state.isTemplatesOpen),[i]),h=(0,r.VK)((()=>l.state),[l]),{device:b}=u;return(0,F.jsx)(P.Z,{capture:p,ignoreBlockSelection:!1,restoreSelection:!1,render:()=>(0,F.jsx)(Z.ZP,{popupType:b.isMobile?Z.ZP.PopupType.SlideUp:Z.ZP.PopupType.Popup,open:p,keepFocus:!0,render:()=>(0,F.jsx)(_.Z,{menuType:f.og.Modal,title:(0,F.jsx)(d.FormattedMessage,{defaultMessage:"Templates",id:"mobileActionBar.templates.modalTitle"}),right:(0,F.jsx)(R.CancelMenuText,{}),onClickRight:m,children:(0,F.jsx)(j.Z,{type:j.i.Vertical,store:n,initialFocus:void 0,disableInitialScroll:!0,disableCommandEnter:!0,onAccept:m,sections:[{key:"Basic",render:e=>(0,F.jsx)(V.Z,{children:e.children}),items:N.ss.map((e=>U(e,t,u,c)))},{key:"Database",render:e=>(0,F.jsx)(V.Z,{title:(0,F.jsx)(d.FormattedMessage,{defaultMessage:"Database",id:"mobileActionBar.databaseSection.title"}),children:e.children}),items:N.Im.filter((e=>e.shouldShow(u))).map((e=>U(e,t,u,c)))},...h]})})})})}},54230:(e,t,i)=>{i.r(t),i.d(t,{default:()=>oe});var o=i(30120),n=i(67294),s=i(83355),r=i(86628),a=i(49085),l=i(15145),c=i(40506),d=i(7057),u=i(53877),m=i(42875),p=i(2585),h=i(5257),b=i(72126),g=i(21202),f=i(9291),S=i(26797),y=i(54569),v=i(8055),x=i(82530),M=i(66213),C=i(40863),k=i(84210),T=i(87279);class A extends a.default{getInitialState(){return{}}}const w=A;var I=i(79797),B=i(13401),P=i(75498),_=i(73063),j=i(78140),R=i(43765),Z=i(40721),V=i(72495),N=i(78948),O=i(24405),F=i(6695),D=i(95855),L=i(54497),E=i(82990),U=i(33929),H=i(65598),K=i(80444),q=i(97039),G=i(78030),W=i(52275),z=i(16354),$=i(31278),Y=i(76798),Q=i(85893);const J=function(e){let{time:t,store:i,format:o,schema:s,blockPropertyValueOverlayStore:a,collectionStore:c}=e;window.__c={n:"MobileCalendarDayMenuItem"};const d=(0,O.Fg)(),u=(0,r.VK)((()=>i.getIcon()),[i]),m=(0,r.VK)((()=>i.hasIcon()||!i.isEmptyPage()),[i]),p=(0,r.VK)((()=>i.hasError()),[i]),h=(0,r.VK)((()=>i.isEmptyPage()),[i]),b=(0,r.VK)((()=>(0,k.ZP)({store:i,fullyQualified:!1,pageVisitSource:l.tY.LinkInPage})),[i]),g=(0,r.VK)((()=>H.Xp(i,{recursivelyLoadAllDiscussions:!1})),[i]);return(0,Q.jsx)(z.Z,{href:b,children:(0,Q.jsx)(W.Z,{focused:!1,title:(0,Q.jsxs)(n.Fragment,{children:[t&&(0,Q.jsx)("div",{style:{display:"flex",color:d.mediumTextColor,fontSize:14,marginTop:8,marginBottom:6},children:t}),(0,Q.jsxs)("div",{style:{display:"flex",alignItems:"center",...t&&{marginBottom:8}},children:[m&&!p&&(0,Q.jsx)($.Z,{disabled:!0,icon:u,isEmptyPage:h,size:24,style:{flexShrink:0,marginRight:8}}),p&&(0,L.t)({marginLeft:2,marginRight:10,width:20,fill:d.accentColors.orange[500]}),(0,Q.jsx)(Y.Z,{store:i,style:{fontWeight:E.Z.fontWeight.semibold}}),g>0&&(0,Q.jsxs)("div",{style:{display:"flex",alignItems:"center",color:d.regularDividerColor,fontSize:12,marginLeft:4,flexShrink:0},children:[(0,D.z)({width:12,height:12,marginRight:4,fill:d.mediumIconColor}),g]})]})]}),caption:(0,Q.jsx)(ee,{format:o,schema:s,store:i,blockPropertyValueOverlayStore:a,collectionStore:c})})})};function X(e){let{property:t,schema:i,store:o,blockPropertyValueOverlayStore:n,collectionStore:s}=e;return i[t]?(0,Q.jsx)(q.Z,{store:o,property:t,disabled:!0,locked:!1,format:G.C.Calendar,tableWrap:!1,blockPropertyValueOverlayStore:n,collectionStore:s},t):null}function ee(e){let{format:t,schema:i,store:o,blockPropertyValueOverlayStore:n,collectionStore:s}=e;const r=(t.calendar_properties?t.calendar_properties.filter((e=>e.visible)).map((e=>e.property)):[]).filter((e=>{var t;return F.XU({block:o.getModel(),property:e,schema:i,getRecordModel:o.getRecordModel,userId:null===(t=K.default.state.currentUserStore)||void 0===t?void 0:t.id,userTimeZone:(0,m.r)(),intl:U.default.getIntl()})}));return r.length>0?(0,Q.jsx)("div",{style:{marginTop:8},children:r.map((e=>(0,Q.jsx)(X,{property:e,schema:i,store:o,blockPropertyValueOverlayStore:n,collectionStore:s},e)))}):null}const te={display:"flex",alignItems:"center",height:"100%"};class ie extends s.Z{constructor(){super(...arguments),this.storeTypes={store:w,resultStore:a.default.createClass(void 0)},this.renderResults=()=>{const{disabled:e,collectionContextStore:t}=this.props,i=t.collectionStore();if(!i)return;const o=re(this.props.initialStartOfDay,this.stores.store),n=o.endOf("day"),s=function(e,t,i,o){const n=t.collectionStore();if(!n)return;const s=o.state,r=t.normalizedQueryStore.state,a=t.normalizedSchemaStore.state,l=r?r.calendar_by:void 0;if(!(s&&r&&l&&a))return;let c=b.oA(s.blockIds.map((t=>{const o=I.G.createChildStore(n,{id:t,table:g.iU});return(0,C.BO)({blockStore:o,calendarBy:l,schema:a,getRecordValue:n.getRecordValue,userId:e.currentUser.id,intl:i})})));r.sort||(c=b.MR(c,(e=>e.start)));return c}(this.environment,this.props.collectionContextStore,this.props.intl,this.stores.resultStore);return(0,Q.jsxs)(j.Z,{menuType:T.og.Modal,title:(0,Q.jsxs)("div",{style:te,children:[(0,Q.jsx)(_.Z,{onClick:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleLeftClick,icon:p.f,style:{marginRight:8,marginTop:2},mobileFeedback:!0}),(0,Q.jsx)("div",{children:(0,d.ZW)(o,"month_day_long")}),(0,Q.jsx)(_.Z,{onClick:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleRightClick,icon:h.o,style:{marginLeft:8,marginTop:2},mobileFeedback:!0})]}),right:(0,Q.jsx)(Z.DoneMenuText,{}),onClickRight:this.props.onDismiss,children:[!s&&(0,Q.jsx)(V.Z,{children:(0,Q.jsx)(N.Z,{})}),s&&0===s.length&&(0,Q.jsx)(V.Z,{children:(0,Q.jsx)(R.Z,{title:(0,Q.jsx)(f.FormattedMessage,{defaultMessage:"No items",id:"mobileCalendarDayMenu.noResults.message"})})}),s&&s.length>0&&(0,Q.jsx)(V.Z,{children:s.map((e=>{const t=I.G.createChildStore(i,{id:e.id,table:g.iU});return(0,Q.jsx)(se,{disabled:this.props.disabled,blockPropertyValueOverlayStore:this.props.blockPropertyValueOverlayStore,collectionContextStore:this.props.collectionContextStore,schema:this.props.schema,calendarBy:this.props.calendarBy,intl:this.props.intl,format:this.props.format,blockStore:t,item:e,currentStartOfDay:o,currentEndOfDay:n},e.id)}))}),!e&&(0,Q.jsx)(V.Z,{topBorder:!0,children:(0,Q.jsx)(B.Z,{focused:!1,onClick:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleAddItemClick,title:(0,Q.jsx)(f.FormattedMessage,{defaultMessage:"New item",id:"mobileCalendarDayMenu.newItemButton.label"})})})]})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleLeftClick=()=>function(e,t){const i=re(e,t);t.setState({...t.state,currentStartOfDay:i.minus({day:1}).valueOf()})}(this.props.initialStartOfDay,this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleRightClick=()=>function(e,t){const i=re(e,t);t.setState({...t.state,currentStartOfDay:i.plus({day:1}).valueOf()})}(this.props.initialStartOfDay,this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleAddItemClick=()=>function(e,t,i,o,n,s){const r=re(o,n),a=x.createAndCommit({userAction:"MobileCalendarDayMenu.newStore",environment:e,perform:o=>{const n=y.IW({environment:e,collectionContextStore:t,groupsPointer:[],insertAtIndex:0,shouldCoerce:!1,initializeDefaultTemplate:!0,transaction:o,from:"mobile_calendar_day_menu"});if(n)return S.xD({type:"timestamp",environment:e,store:n.newStore,propertyId:i,timestampMs:r.valueOf(),transaction:o}),n.newStore}});if(!a.performResult)return;!function(e,t,i){i?i(e):v.c4({environment:t,url:e})}((0,k.ZP)({store:a.performResult,pageVisitSource:l.tY.Create}),e,s)}(this.environment,this.props.collectionContextStore,this.props.calendarBy,this.props.initialStartOfDay,this.stores.store,this.context.overrideLinkClick),this.reducerStore=this.createComputedStore((()=>{const{collectionContextStore:e}=this.props;return(0,C.YG)({collectionContextStore:e,startOfDay:re(this.props.initialStartOfDay,this.stores.store).valueOf()})}),!0)}renderComponent(){const{collectionContextStore:e}=this.props,t=this.reducerStore.state;if(t)return(0,Q.jsx)(P.Z,{id:"calendar_day_results",reducer:t,collectionContextStore:e,render:this.renderResults,resultStore:this.stores.resultStore})}}ie.displayName="MobileCalendarDayMenu",ie.contextTypes={...M.wK,...s.w};const oe=(0,f.injectIntl)(ie);function ne(e){let{item:t,currentStartOfDay:i,currentEndOfDay:o,schema:n,calendarBy:s,intl:r}=e;const a=n[s];if(!a||"date"!==a.type)return;const l=a.date_format||c.sF,p=a.time_format||c.c_,h=t.start,b=t.end,g=Boolean(!(i<=h&&h<=o)||b&&!(i<=b&&b<=o));if(t.end){const e=u.iC(t.start.valueOf(),t.end?t.end.valueOf():t.start.valueOf(),t.timeZone??(0,m.r)());return g?(0,d.ZV)({value:e,date_format:l,time_format:p,userTimeZone:t.timeZone,allowRelativeDates:!0,intl:r}):(0,d.ns)({start_time:e.start_time,end_time:e.end_time,time_format:p,humanReadable:!0,intl:r})}return(0,d.mr)({start_time:u.CQ(t.start.valueOf(),t.timeZone??(0,m.r)()).start_time,time_format:p,humanReadable:!0,intl:r})}function se(e){let{blockStore:t,item:i,currentStartOfDay:o,currentEndOfDay:n,disabled:s,blockPropertyValueOverlayStore:a,collectionContextStore:l,schema:c,calendarBy:d,intl:u,format:m}=e;window.__c={n:"Item"};const p=(0,r.VK)((()=>l.collectionStore()),[l]);return p?(0,Q.jsx)(J,{store:t,time:i.includeTime?ne({schema:c,calendarBy:d,intl:u,item:i,currentStartOfDay:o,currentEndOfDay:n}):void 0,disabled:s,format:m,schema:c,blockPropertyValueOverlayStore:a,collectionStore:p},i.id):null}function re(e,t){const{currentStartOfDay:i}=t.state;return i?o.ou.fromMillis(i):o.ou.fromMillis(e)}},21326:(e,t,i)=>{i.r(t),i.d(t,{default:()=>w});var o=i(67294),n=i(71644),s=i(51811),r=i(480),a=i(86628),l=i(27328),c=i(59054),d=i(70203),u=i(35793),m=i(8055),p=i(87531),h=i(29974),b=i(81598),g=i(28344),f=i(96457),S=i(75179),y=i(48779),v=i(80444),x=i(98180),M=i(66881),C=i(69454),k=i(85893);const T=function(){window.__c={n:"MobileAssistantMenu"};const e=(0,r.O7)(),[t,i]=(0,o.useState)(!1),n=(0,a.VK)((()=>M.g.state),[]),s=(0,a.VK)((()=>(0,l.w_)(e.TabbedRouterStore.state)),[e]),T=(0,a.VK)((()=>{var e,t;return Boolean("web"===s.type&&("nativeTab"===s.route.name&&"assistant"===s.route.tab||"nativeTab"===(null===(e=s.redirectedTo)||void 0===e?void 0:e.route.name)&&"assistant"===(null===(t=s.redirectedTo)||void 0===t?void 0:t.route.tab)))}),[s]),A=(0,a.VK)((()=>e.WindowSizeStore.state.paddingTopCSS),[e.WindowSizeStore]),w=(0,a.VK)((()=>C.Z.mobileNativeBottomPadding(e)),[e]),I=(0,a.VK)((()=>({paddingLeft:e.WindowSizeStore.state.paddingLeftCSS,paddingRight:e.WindowSizeStore.state.paddingRightCSS})),[e]);return(0,c.r5)((async()=>{const t=u.Bs(),o=v.default.state.currentSpaceViewStore;if(t){const i=h.F1({environment:e,spaceId:t})??(o?await(0,y.rg)(e,o):void 0);i&&v.default.setState({...v.default.state,mainEditorCurrentBlockStore:i})}const{assistantActions:s}=await b.L6.loader();if(!x.Z.getActiveSessionId()||n.shouldReset){var r;M.g.update((e=>({...e,shouldReset:!1})));const t=Boolean(n.query&&n.query.length>p.LR),o=await s.resetAndInitializeAssistantSession({environment:e,primeTextInput:t?void 0:n.query});t&&await s.commitHumanStep({environment:e,text:(0,d.TPx)(n.query),sessionId:o.sessionId});const l=null===(r=x.Z.getSessionContext(o.sessionId))||void 0===r||null===(r=r.assistantConfigurationStore)||void 0===r?void 0:r.state;var a;if(l)g.trackQnAOpened(e,{configurationState:l,runtimeState:null===(a=x.Z.getSessionContext(o.sessionId))||void 0===a||null===(a=a.assistantRuntimeStore)||void 0===a?void 0:a.state,hasQuery:t,from:n.from??"mobile_app_start",searchSessionId:n.searchSessionId,isReminder:!1});i(!0)}else T&&i(!0)}),[e,n,i,T]),(0,o.useEffect)((()=>{var i;T&&t&&(null===(i=e.mobileNative)||void 0===i||i.markTransitionReady({type:"assistant"}))}),[e.mobileNative,T,t]),(0,k.jsx)(S.Z,{capture:!0,render:t=>(0,k.jsx)("div",{style:{paddingTop:A,paddingBottom:w,...I,flex:1,minWidth:0},...t,children:(0,k.jsx)(f.Q,{renderAsFullPage:!0,showBackButton:!0,onClose:()=>m.op(e)})})})};var A=i(80133);const w=function(e){const{route:t}=e;return"updates"===t.tab?(0,k.jsx)(A.Z,{format:s.EX.RenderAsPage,renderId:(0,n.ZP)()}):"assistant"===t.tab?(0,k.jsx)(T,{}):null}},61671:(e,t,i)=>{i.d(t,{Z:()=>f});i(67294);var o=i(480),n=i(86628),s=i(24405),r=i(16001),a=i(9291),l=i(1357),c=i(87279),d=i(97799),u=i(64921),m=i(31945),p=i(78140),h=i(15311),b=i(14694),g=i(85893);const f=function(e){let{passwordRequestStore:t}=e;window.__c={n:"NotificationSettingsButton"};const i=(0,s.Fg)(),l=(0,o.O7)(),{device:f,mobileNative:y}=l,v=(0,n.VK)((()=>d.Z.state.open),[]),x=(0,n.VK)((()=>d.Z.state.source!==d.Y.Updates&&((null==y?void 0:y.supportsNativeHomeOnPhone())||!1)),[y]);return(0,g.jsx)(m.ZP,{popupType:f.isMobile?m.Z4.SlideUp:m.Z4.Popup,hidesMobileNativeBottomBar:x,preventSlideUpTransition:x,buttonPopupStore:d.Z,renderOrigin:e=>(0,g.jsx)(u.Z,{mobileFeedback:f.isMobile,...e,children:(0,g.jsx)(b.Z,{left:(0,r.r)({fill:i.mediumIconColor,width:16}),style:{background:v?i.buttonHoveredBackground:"none"},disableMobileBorder:!0,children:(0,g.jsx)(a.FormattedMessage,{defaultMessage:"Notifications & settings",id:"notificationSettingsButton.mobileSidebar.label"})})}),render:()=>{let e;return e=f.isMobile?{menuType:c.og.Modal,title:(0,g.jsx)(a.FormattedMessage,{defaultMessage:"Notifications & settings",id:"notificationSettingsButton.mobileSidebar.title"}),right:(0,g.jsx)(a.FormattedMessage,{defaultMessage:"Done",id:"notificationSettingsButton.rightActionButton.done"}),onClickRight:()=>S(l),onCancel:()=>S(l),whiteBackground:!0}:{menuType:c.og.Popup},(0,g.jsx)(p.Z,{...e,children:(0,g.jsx)(h.Z,{isMobile:!0,passwordRequestStore:t})})}})};function S(e){const{mobileNative:t}=e,i=()=>{d.Z.setState({open:!1})};d.Z.state.source!==d.Y.Updates&&((null==t?void 0:t.supportsNativeHomeOnPhone())||!1)?l.d(e,i):i()}},40698:(e,t,i)=>{i.d(t,{Im:()=>Z,K0:()=>I,b6:()=>V,dQ:()=>A,pd:()=>B,re:()=>w,ss:()=>_});i(57658);var o=i(15145),n=i(35013),s=i(21321),r=i(69628),a=i(17948),l=i(42696),c=i(10405),d=i(82356),u=i(54855),m=i(46783),p=i(73426),h=i(4615),b=i(9291),g=i(57549),f=i(75754),S=i(59389),y=i(82530),v=i(33929),x=i(89014),M=i(67940),C=i(92083),k=i(29949);const T=(0,b.defineMessages)({emptyWithIcon:{defaultMessage:"Empty page with icon",id:"templatePickerHelpers.basicTemplateItems.emptyWithIcon"},empty:{defaultMessage:"Empty page",id:"templatePickerHelpers.basicTemplateItems.empty"},templates:{defaultMessage:"Templates",id:"templatePickerHelpers.basicTemplateItems.templates"},import:{defaultMessage:"Import",id:"templatePickerHelpers.basicTemplateItems.import"}}),A={name:v.default.formatMessage(T.empty),iconFn:u.a,type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{y.createAndCommit({userAction:"templatePickerHelpers.emptyTemplateItems",environment:e,perform:i=>{S.eV({environment:e,store:t,transaction:i})}})}},w={name:v.default.formatMessage(T.templates),type:"templates",iconFn:e=>(0,p.i)(e),shouldShow:()=>!0,onClick:()=>{k.Z.open({cloneTo:"current_page",analyticsFrom:"newPage"})}},I={name:v.default.formatMessage(T.templates),type:"templates",iconFn:e=>(0,m.w)(e),shouldShow:()=>!0,onClick:()=>{k.Z.open({cloneTo:"current_page",analyticsFrom:"newPage"})}},B={name:v.default.formatMessage(T.import),type:"import",iconFn:d.l,shouldShow:()=>!0,onClick:(e,t)=>{const i=(0,h.ZP)();M.Z.setState({flowId:i}),g.Sy(e,{from:"new_page",flowId:i}),C.Z.setState({...C.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:void 0})}},P=(0,b.defineMessages)({pageWithIcon:{defaultMessage:"Page with icon",id:"templatePickerHelpers.mobileBasicTemplateItems.pageWithIcon"},emptyPage:{defaultMessage:"Empty page",id:"templatePickerHelpers.mobileBasicTemplateItems.emptyPage"}}),_=[{name:v.default.formatMessage(P.pageWithIcon),type:"page_with_icon",shouldShow:()=>!0,onClick:(e,t)=>{y.createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,perform:i=>{S.T_({environment:e,store:t,transaction:i})}})}},{name:v.default.formatMessage(P.emptyPage),type:"empty_page",shouldShow:()=>!0,onClick:(e,t)=>{y.createAndCommit({userAction:"templatePickerHelpers.mobileBasicTemplateItems",environment:e,perform:i=>{S.eV({environment:e,store:t,transaction:i})}})}}],j=(0,b.defineMessages)({table:{defaultMessage:"Table",id:"templatePickerHelpers.databaseTemplateNames.table"},board:{defaultMessage:"Board",id:"templatePickerHelpers.databaseTemplateNames.board"},list:{defaultMessage:"List",id:"templatePickerHelpers.databaseTemplateNames.list"},calendar:{defaultMessage:"Calendar",id:"templatePickerHelpers.databaseTemplateNames.calendar"},gallery:{defaultMessage:"Gallery",id:"templatePickerHelpers.databaseTemplateNames.gallery"},timeline:{defaultMessage:"Timeline",id:"templatePickerHelpers.databaseTemplateNames.timeline"},tableView:{defaultMessage:"Table view",id:"templatePickerHelpers.databaseTemplateNames.tableView"},boardView:{defaultMessage:"Board view",id:"templatePickerHelpers.databaseTemplateNames.boardView"},listView:{defaultMessage:"List view",id:"templatePickerHelpers.databaseTemplateNames.listView"},calendarView:{defaultMessage:"Calendar view",id:"templatePickerHelpers.databaseTemplateNames.calendarView"},galleryView:{defaultMessage:"Gallery view",id:"templatePickerHelpers.databaseTemplateNames.galleryView"},timelineView:{defaultMessage:"Timeline view",id:"templatePickerHelpers.databaseTemplateNames.timelineView"}});function R(e){const{environment:t,store:i,viewType:n}=e;y.createAndCommit({userAction:"templatePickerHelpers.handleClickForViewType",environment:t,perform:e=>{S.Ud({environment:t,store:i,viewType:n,transaction:e}),f._({environment:t,store:i,pageVisitSource:o.tY.LinkInPage});const s=i.getCollectionViewStores()[0];s&&(0,x.u)(s.id,{viewType:n})}})}const Z=[{name:v.default.formatMessage(j.table),type:"table",iconFn:l.t,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>R({environment:e,store:t,viewType:"table"})},{name:v.default.formatMessage(j.board),type:"board",iconFn:n.i,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>R({environment:e,store:t,viewType:"board"})},{name:v.default.formatMessage(j.list),type:"list",iconFn:a.O,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>R({environment:e,store:t,viewType:"list"})},{name:v.default.formatMessage(j.timeline),type:"timeline",iconFn:c._,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>R({environment:e,store:t,viewType:"timeline"})},{name:v.default.formatMessage(j.calendar),type:"calendar",iconFn:s.N,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>R({environment:e,store:t,viewType:"calendar"})},{name:v.default.formatMessage(j.gallery),type:"gallery",iconFn:r.n,isLargeDatabaseIcon:!0,shouldShow:()=>!0,onClick:(e,t)=>R({environment:e,store:t,viewType:"gallery"})}];function V(e,t){const i=new Map(e.map((e=>[e.type,e])));return t.reduce(((e,t)=>(i.has(t)&&e.push(i.get(t)),e)),[])}},48190:(e,t,i)=>{i.d(t,{P:()=>u,Z:()=>d});var o=i(67294),n=i(1302),s=i(86628),r=i(28155),a=i(40107),l=i(72126),c=i(75330);function d(e){const{id:t,reducer:i,collectionContextStore:r,groupsPointer:d}=e,m=(0,s.VK)((()=>d),[d],{useDeepEqual:!0}),p=(0,s.VK)((()=>i),[i],{useDeepEqual:!0}),h=(0,s.VK)((()=>r.collectionViewStore()),[r]),b=(0,o.useRef)(!1),g=(0,a.S)(),[f,S]=(0,o.useReducer)(((e,t)=>l.Xy(e,t)?e:t),void 0),y=(0,o.useCallback)((()=>{const e=r.localResultStore.state,i=r.remoteResult.state,o=e&&"reducer"===e.type?e.reducerResults[t]:void 0,n=i&&"reducer"===i.type?i.reducerResults[t]:void 0;return u({reducerId:t,collectionContextStore:r,reducer:p,localReducerResult:o,remoteReducerResult:n})}),[r,p,t]),v=(0,o.useCallback)((()=>{b.current=!1,g()||S(y())}),[y,g]),x=(0,o.useCallback)((()=>{b.current||(b.current=!0,n.default.afterNextFlush(v))}),[v]);return(0,o.useEffect)((()=>(r.remoteResult.addListener(x),r.localResultStore.addListener(x),()=>{r.remoteResult.removeListener(x),r.localResultStore.removeListener(x)})),[r,x]),(0,o.useEffect)((()=>(c.$D({reducerId:t,instanceId:void 0,reducer:p,collectionContextStore:r,groupsPointer:m}),()=>{c.$D({reducerId:t,instanceId:void 0,reducer:void 0,collectionContextStore:r,groupsPointer:m})})),[r,h,m,p,t]),(0,o.useEffect)((()=>{x()}),[]),f}function u(e){const{reducerId:t,localReducerResult:i,remoteReducerResult:o,collectionContextStore:n,reducer:s}=e,a=n.reducers.state,c=n.remoteResult.state;if(n.isClientModeEnabled.state)return i;if("aggregation"===s.type||"groups"===s.type){if(null!=c&&c.reducerResults[t])return c.reducerResults[t];const e=Boolean(c&&"reducer"===c.type&&l.sE(c.reducerResults,((e,t)=>{const i=a[t];return Boolean(i&&"results"===i.reducer.type&&!i.reducer.searchQuery&&"results"===e.type&&e.hasMore&&l.Xy(s.filter,i.reducer.filter))})));return e?i:o}if("results"===s.type){var d;const e=n.wasCreatedThisSession.state,s=Boolean(c&&"reducer"===c.type&&c.reducerResults[t]),a=(0,r.nx)(null===(d=n.collectionViewStore())||void 0===d?void 0:d.getCollectionSource());if((s||e)&&!a&&i&&"results"===i.type){return{...i,hasMore:o&&"results"===o.type?o.hasMore:i.hasMore}}return o}}},30664:(e,t,i)=>{i.d(t,{Z:()=>_});var o=i(67294),n=i(480),s=i(6740),r=i(86628),a=i(24405),l=i(84169),c=i(9291),d=i(25888),u=i(13991),m=i(88642),p=i(39634),h=i(97978),b=i(79897),g=i(58455),f=i(77080);var S=i(43250),y=i(98742),v=i(77907),x=i(475),M=i(16194),C=i(55031),k=i(64921),T=i(31945),A=i(26388),w=i(14694),I=i(85893);const B="?";function P(e){window.__c={n:"HelpButtonOrigin"};const t=(0,n.O7)(),{isMobile:i}=t.device,d=(0,c.useIntl)(),u=(0,a.Fg)(),m=(0,r.VK)((()=>x.Z.state.open),[]),p=(0,a.yK)((e=>({helpIcon:{fill:e.mediumIconColor,width:16,height:16},hoveredStyle:{background:e.whiteButtonHoveredBackground},pressedStyle:{background:e.whiteButtonPressedBackground}})),[]),h=(0,o.useCallback)((e=>{const t=e.target;t instanceof HTMLElement&&(0,s.E)(t)&&M.Z.setState(!0)}),[]),b=(0,o.useCallback)((()=>{M.Z.setState(!1)}),[]);if(i)return(0,I.jsx)(k.Z,{hovered:m,testId:S.lmr,mobileFeedback:i,...e,children:(0,I.jsx)(w.Z,{left:(0,l.m)(p.helpIcon),disableMobileBorder:!0,children:(0,I.jsx)(c.FormattedMessage,{defaultMessage:"Help & feedback",id:"helpButton.mobileHelpFeedbackButton.label"})})});const g=d.formatMessage({defaultMessage:"Help, feedback, and keyboard shortcuts",id:"helpButton.desktopHelpButton.ariaLabel"}),f=(0,y.Z)(e,{onFocus:h,onBlur:b});return(0,I.jsx)(I.Fragment,{children:(0,I.jsx)(A.ZP,{renderTooltip:()=>(0,I.jsx)("span",{children:(0,I.jsx)(c.FormattedMessage,{defaultMessage:"Help, feedback, and {br}keyboard shortcuts",id:"helpButton.desktopHelpButton.tooltip",values:{br:(0,I.jsx)("br",{})}})}),render:e=>(0,I.jsx)(k.Z,{ariaLabel:g,className:S.lmr,testId:S.lmr,style:(0,C.y)(t,{theme:u,rightEdgeDistance:16,isInPeekRenderer:!1}),hoveredStyle:p.hoveredStyle,pressedStyle:p.pressedStyle,...(0,y.Z)(f,e),children:B})})})}const _=(0,c.injectIntl)((function(){window.__c={n:"HelpButton"};const e=(0,n.O7)(),{isMobile:t}=e.device,i=(0,r.VK)((()=>{var t;return(null===(t=e.mobileNative)||void 0===t?void 0:t.supportsNativeHomeOnPhone())||!1}),[e]),s=(0,o.useCallback)((()=>{d.Ar(e,{from:"corner"}),function(e){const t=g.default.state;if((0,h.Ug)()&&t.isZendeskEnabled){const{userHighestPlanType:i,isSalesAssistedPlan:o}=(0,b.rf)(e);m.j({locale:u.SP,analyticsSettings:t,isForethoughtEnabled:f.default.checkGate("forethought"),forethoughtInitializeArgs:p.z(e),userHighestPlanType:i,isSalesAssistedPlan:o,cookieService:e.cookieService})}}(e)}),[e]);return(0,I.jsx)(T.ZP,{popupType:t?T.Z4.SlideUp:T.Z4.Popup,hidesMobileNativeBottomBar:i,preventSlideUpTransition:i,renderOrigin:e=>(0,I.jsx)(P,{...e}),originGap:t?0:12,placementToOrigin:t?T.pO.Right:T.pO.Top,alignmentToOrigin:t?T.vR.Center:T.vR.End,buttonPopupStore:x.Z,onClick:s,render:()=>(0,I.jsx)(v.LazyHelpButtonContent,{shouldRenderAsStaticModal:i})})}))},61735:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Ie});var o=i(67294),n=i(83355),s=i(68719),r=i(480),a=i(41432),l=i(8848),c=i(72126),d=i(97880),u=i(36054),m=i(74487);function p(e,t,i){const{content:o,apiRequestValue:n}=i;return{id:e,content:o,action:{type:t,apiRequestValue:n}}}const h=["insertBlock","turnInto","textColor","textSelectionColor"],b=["suggested","textFormatting","slashMenu","turnInto","textColor","textSelectionColor","more"];function g(e,t){return{type:e,apiRequestValue:t}}function f(e,t,i){const o={type:e,from:i,data:t};return JSON.stringify(o)}const S={showActionBarMenu:m.object({required:{type:m.literal("showActionBarMenu"),data:m.object({required:{actionBarMenuId:m.literals("template")},optional:{}})},optional:{}}),blockAction:m.object({required:{type:m.literals("blockAction"),data:m.object({required:{action:m.literals("bold","italic","underline","strikethrough","link","code","equation","mention","trash","comment","filePicker","indent","unindent","moveUp","moveDown","undo","redo","dismissKeyboard","more","ai")},optional:{}})},optional:{from:m.literals("mobile_action_bar","mobile_text_formatting_menu")}})},y=Object.keys(S);let v=function(e){return e[e.InvalidActionType=0]="InvalidActionType",e[e.MissingPayload=1]="MissingPayload",e[e.InvalidRequestType=2]="InvalidRequestType",e[e.InvalidData=3]="InvalidData",e}({});class x{constructor(e,t){this.type=e,this.message=t}}function M(e){return 0===e.reduce(((e,t)=>e+t.items.length),0)}const C=p("mab.button.back","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"chevron.backward.2",localImageIdentifier:"back"},accessibilityText:""},apiRequestValue:{subMenuType:null}});function k(e,t){return p("mab.button.filePicker","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"photo.on.rectangle.angled",localImageIdentifier:"filePicker"},disabled:e,accessibilityText:t},apiRequestValue:{jsonPayload:f("blockAction",{action:"filePicker"})}})}function T(e,t){return p("mab.button.comment","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"bubble.left",localImageIdentifier:"comment"},disabled:e,accessibilityText:t},apiRequestValue:{jsonPayload:f("blockAction",{action:"comment"},"mobile_action_bar")}})}function A(e,t){return p("mab.button.undo","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.uturn.backward",localImageIdentifier:"undo"},disabled:e,accessibilityText:t},apiRequestValue:{jsonPayload:f("blockAction",{action:"undo"})}})}function w(e,t){return p("mab.button.delete","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"trash",localImageIdentifier:"trash"},disabled:e,accessibilityText:t},apiRequestValue:{jsonPayload:f("blockAction",{action:"trash"})}})}function I(e,t){return p("mab.button.mention","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"at",localImageIdentifier:"mention"},disabled:e,accessibilityText:t},apiRequestValue:{jsonPayload:f("blockAction",{action:"mention"})}})}function B(e,t,i){return p("mab.button.indent","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"increase.indent",localImageIdentifier:"indent"},disabled:e||t,accessibilityText:i},apiRequestValue:{jsonPayload:f("blockAction",{action:"indent"})}})}function P(e,t,i){return p("mab.button.unindent","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"decrease.indent",localImageIdentifier:"indent"},accessibilityText:i,disabled:e||t},apiRequestValue:{jsonPayload:f("blockAction",{action:"unindent"})}})}function _(e,t){return p("mab.button.moveUp","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.up.to.line.alt",localImageIdentifier:"moveUp"},accessibilityText:t,disabled:e},apiRequestValue:{jsonPayload:f("blockAction",{action:"moveUp"})}})}function j(e,t){return p("mab.button.moveDown","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.down.to.line.alt",localImageIdentifier:"moveDown"},accessibilityText:t,disabled:e},apiRequestValue:{jsonPayload:f("blockAction",{action:"moveDown"})}})}var R=i(70203),Z=i(9291),V=i(36610),N=i(44886),O=i(52423),F=i(24677),D=i(84084),L=i(993),E=i(98104),U=i(82530),H=i(72899),K=i(81598),q=i(28020),G=i(19124),W=i(33929),z=i(51783),$=i(68056),Y=i(45162),Q=i(65598),J=i(89086),X=i(35328);var ee=i(77907),te=i(53809);const ie=new class{constructor(){this.lruKeyStore=new te.D({key:"frequentlyUsedActions",namespace:"NativeMobileActionBar",important:!1,trackingType:"necessary"})}load(){const e=this.lruKeyStore.state;var t={};try{t=e&&JSON.parse(e)||{}}catch(i){}return t}get(){const e=this.load();return Object.keys(e).sort(((t,i)=>{const o=e[t]||0,n=e[i]||0;return o===n?0:n-o}))}track(e){var t=this.load();t[e]=(t[e]??0)+1,this.lruKeyStore.setState(JSON.stringify(t))}};var oe=i(50694),ne=i(64359),se=i(5162),re=i(80444),ae=i(27724),le=i(10743),ce=i(24666),de=(i(57658),i(21797)),ue=i(46225),me=i(11732),pe=i(83249),he=i(68204),be=i(31352);function ge(e){const{type:t,actionSections:i,closeParentMenu:o,context:n}=e,s={},r=[];for(const a of i){const e={id:`${a.key}`,title:a.title,items:a.actions.map((e=>{var i;const r=`${e.key}-${e.displayName||""}`;return s[r]={...e,closeParentMenu:o},{id:r,title:e.displayName||"",icon:(null===(i=e.nativeImageReference)||void 0===i?void 0:i.call(e,n))??{},action:g("webAction_genericAction",{menuType:t,actionId:r}),checked:!1}}))};r.push(e)}return{actions:s,sections:r}}function fe(e){const{key:t,displayName:i,analyticsName:o,closeParentMenu:n,action:s}=e,r=i;return{key:`action ${t}`,displayName:i?W.default.formatMessage(i):void 0,analyticsName:o||`textformatting_action_${t}`,searchName:r?`${W.default.formatMessage(r)} ${r.defaultMessage}`:void 0,validators:[],action:s,closeParentMenu:Boolean(n)}}const Se={bold:fe({key:"bold",closeParentMenu:!1,action:e=>{let{environment:t}=e;z.pk(t,["b"])}}),italic:fe({key:"italic",closeParentMenu:!1,action:e=>{let{environment:t}=e;z.pk(t,["i"])}}),underline:fe({key:"underline",closeParentMenu:!1,action:e=>{let{environment:t}=e;z.pk(t,["_"])}}),strikethrough:fe({key:"strikethrough",closeParentMenu:!1,action:e=>{let{environment:t}=e;z.pk(t,["s"])}}),code:fe({key:"code",closeParentMenu:!1,action:e=>{let{environment:t}=e;z.pk(t,["c"])}}),comment:fe({key:"comment",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),z.ol(i,!0,"mobile_action_bar"),pe.YO(i,{itemName:"comment",from:"mobile_action_bar"})}}),equation:fe({key:"equation",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),z._W(i)}}),filePicker:fe({key:"filePicker",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),z.vs(i)}}),indent:fe({key:"indent",closeParentMenu:!1,action:e=>{let{environment:t}=e;z.O2(t)}}),unindent:fe({key:"unindent",closeParentMenu:!1,action:e=>{let{environment:t}=e;z.$$(t)}}),moveDown:fe({key:"moveDown",closeParentMenu:!1,action:e=>{let{environment:t}=e;z.rZ(t)}}),moveUp:fe({key:"moveUp",closeParentMenu:!1,action:e=>{let{environment:t}=e;z.s0(t)}}),undo:fe({key:"undo",closeParentMenu:!1,action:e=>{let{environment:t}=e;z.i2(t)}}),redo:fe({key:"redo",closeParentMenu:!1,action:e=>{let{environment:t}=e;z.GH(t)}}),trash:fe({key:"trash",closeParentMenu:!1,action:e=>{let{environment:t}=e;z.fn(t)}}),mention:fe({key:"mention",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),z.Z3(i)}}),ai:fe({key:"ai",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),z.QG(i)}}),link:fe({key:"link",closeParentMenu:!0,action:async e=>{var t;let{environment:i}=e;await(null===(t=i.NativeMobileActionBarStore)||void 0===t?void 0:t.clearNativeActionMenuAndRestoreSelectionIfNecessary()),z.UF(i)}}),more:fe({key:"more",closeParentMenu:!1,action:e=>{let{environment:t}=e;z.w1(t,void 0,void 0)}}),dismissKeyboard:fe({key:"dismissKeyboard",closeParentMenu:!0,action:e=>{let{environment:t}=e;F.ZH(t),oe.HM.clearSelection(),z.hc(t,null,!1),z.hD(t,null,!1),z.Oh(t,"hide_keyboard"),E.sD()}})},ye=(e,t)=>{const i=be.zK(t.textStore,t.oldTextValue,!t.isAddMenu);return(0,he.sG)({sections:ue.v.state.insertActions,context:e,query:i||""}).flatMap((e=>e.actions)).map((t=>{var i;const o=`${t.key}-${t.displayName||""}`,n=(null===(i=t.nativeImageReference)||void 0===i?void 0:i.call(t,e))??{},s=g("webAction_genericAction",{menuType:"insertBlock",actionId:o});return p(o,"webAction_genericAction",{content:{type:"text_and_icon",imageReference:n,accessibilityText:t.displayName||"",text:t.displayName||""},apiRequestValue:s.apiRequestValue})})).filter(d.$K)},ve=e=>{const t=he.L1([me.g],e).flatMap((t=>t.actions.map((t=>{var i;const o=`${t.key}-${t.displayName||""}`,n=(null===(i=t.nativeImageReference)||void 0===i?void 0:i.call(t,e))??{},s=g("webAction_genericAction",{menuType:"turnInto",actionId:o});return p(o,"webAction_genericAction",{content:{type:"text_and_icon",imageReference:n,accessibilityText:t.displayName||"",text:t.displayName||""},apiRequestValue:s.apiRequestValue})})))).filter(d.$K);return[C,...t]},xe=(e,t)=>{const i=he.L1("textColor"===t?[de.rz,de.Vm]:[de.b4,de.Sw],e).flatMap((i=>i.actions.map((i=>{var o;const n=`${i.key}-${i.displayName||""}`,s=(null===(o=i.nativeImageReference)||void 0===o?void 0:o.call(i,e))??{},r=g("webAction_genericAction",{menuType:t,actionId:n});return p(n,"webAction_genericAction",{content:{type:"text_and_icon",imageReference:s,accessibilityText:i.displayName||"",text:i.displayName||""},apiRequestValue:r.apiRequestValue})})))).filter(d.$K);return[C,...i]},Me=(e,t,i,o)=>{var n=[];const s=e=>e.sort(((e,t)=>{const i=o.indexOf(e)||0,n=o.indexOf(t)||0;return i===n?0:n-i})).map((e=>t[e]));switch(i){case"indent":{const e=["ai","insert","turnInto","biu","mention","delete"];n=[t.unindent,t.indent,t.moveUp,t.moveDown,...s(e),t.more].filter(d.$K);break}case"empty":{const e=["turnInto","filePicker","biu","mention"];n=[t.ai,t.insert,...s(e),t.more].filter(d.$K);break}case"simple_table":case void 0:break;default:(0,d.t1)(i)}return[C,...n]};var Ce=i(85893);const ke=(0,Z.defineMessages)({subMenuLabelSuggested:{defaultMessage:"Suggested",id:"mobileActionBar.subMenuLabel.suggested"},subMenuLabelInsert:{defaultMessage:"Add",id:"mobileActionBar.subMenuLabel.insert"},subMenuLabelTurnInto:{defaultMessage:"Turn into",id:"mobileActionBar.subMenuLabel.turnInto"},subMenuLabelTextFormatting:{defaultMessage:"Format",id:"mobileActionBar.subMenuLabel.textFormatting"},subMenuLabelTextColor:{defaultMessage:"Text color",id:"mobileActionBar.subMenuLabel.textColor"},templatesButtonTitle:{defaultMessage:"Choose a template...",id:"mobileActionBar.templateButtonTitle"},actionMenuInsertBlockTitle:{defaultMessage:"Insert Block",id:"mobileActionBar.actionMenuTitle.insertBlock"},actionMenuTurnIntoTitle:{defaultMessage:"Turn Into",id:"mobileActionBar.actionMenuTitle.turnInto"},actionMenuColorTitle:{defaultMessage:"Color",id:"mobileActionBar.actionMenuTitle.blockColor"},accessibilityInsert:{defaultMessage:"Add block",id:"mobileActionBar.accessibility.insertBlock"},accessibilityTurnInto:{defaultMessage:"Turn into block",id:"mobileActionBar.accessibility.turnInto"},accessibilityFilePicker:{defaultMessage:"Add image",id:"mobileActionBar.accessibility.filePicker"},accessibilityMention:{defaultMessage:"Add mention",id:"mobileActionBar.accessibility.mention"},accessibilityBlockColor:{defaultMessage:"Change block color",id:"mobileActionBar.accessibility.blockColor"},accessibilityTextFormatting:{defaultMessage:"Open text formatting menu",id:"mobileActionBar.accessibility.textFormatting"},accessibilityComment:{defaultMessage:"Add comment",id:"mobileActionBar.accessibility.comment"},accessibilityTrash:{defaultMessage:"Delete block",id:"mobileActionBar.accessibility.trash"},accessibilityIndent:{defaultMessage:"Indent block",id:"mobileActionBar.accessibility.indent"},accessibilityDedent:{defaultMessage:"Unindent block",id:"mobileActionBar.accessibility.unindent"},accessibilityMoveUp:{defaultMessage:"Move a block up",id:"mobileActionBar.accessibility.moveUp"},accessibilityMoveDown:{defaultMessage:"Move a block down",id:"mobileActionBar.accessibility.moveDown"},accessibilityUndo:{defaultMessage:"Undo edit",id:"mobileActionBar.accessibility.udno"},accessibilityRedo:{defaultMessage:"Redo edit",id:"mobileActionBar.accessibility.redo"},accessibilityMore:{defaultMessage:"More block actions",id:"mobileActionBar.accessibility.more"},accessibilityBold:{defaultMessage:"Bold",id:"mobileActionBar.accessibility.bold"},accessibilityItalics:{defaultMessage:"Italicize",id:"mobileActionBar.accessibility.italics"},accessibilityUnderline:{defaultMessage:"Underline",id:"mobileActionBar.accessibility.underline"},accessibilityStrikethrough:{defaultMessage:"Strikethrough",id:"mobileActionBar.accessibility.strikethrough"},accessibilityTextColor:{defaultMessage:"Text color",id:"mobileActionBar.accessibility.textColor"},accessibilityCode:{defaultMessage:"Code",id:"mobileActionBar.accessibility.code"},accessibilityLink:{defaultMessage:"Add link",id:"mobileActionBar.accessibility.link"},accessibilityEquation:{defaultMessage:"Add equation",id:"mobileActionBar.accessibility.equation"},accessibilityCloseTextFormattingMenu:{defaultMessage:"Close text formatting menu",id:"mobileActionBar.accessibility.close"},accessibilityDismissKeyboard:{defaultMessage:"End editing",id:"mobileActionBar.accessibility.endEditing"},accessibilityCloseActionMenu:{defaultMessage:"Close menu",id:"mobileActionBar.accessibility.closeMenu"},accessibilityAi:{defaultMessage:"AI Assist",id:"mobileActionBar.accessibility.ai"}}),Te={text:!1,to_do:!0,bulleted_list:!0,numbered_list:!0,toggle:!0,column:!1,transclusion_container:!1,callout:!1,quote:!1};function Ae(e){var t;window.__c={n:"MobileActionBarBridgeComponent"};const{onAction:i,fallbackRenderer:n,...a}=e,l=null===(t=(0,r.O7)().mobileNative)||void 0===t?void 0:t.api.renderMobileActionBar,c=(0,s.e)(l,a);return function(e,t,i,n){var s;const a=null===(s=(0,r.O7)().mobileNative)||void 0===s?void 0:s.componentEvents;(0,o.useEffect)((()=>{if(a&&n&&t)return a.addListener(e,t,i,n)}),[e,t,i,n,a])}("MobileActionBar",c,"onAction",i),!c&&n?(0,Ce.jsx)(Ce.Fragment,{children:n()}):null}class we extends n.Z{constructor(){super(...arguments),this.handleMobileActionBarBridgeEvent=e=>{const{action:t}=e;switch(t.type){case"nativeAction_setMenuType":!function(e,t){const i=function(e){if("nativeAction_setMenuType"!==e.type)return new x(v.InvalidActionType,void 0);const t=e.apiRequestValue;if(!t||!("menuType"in t))return new x(v.MissingPayload,void 0);const i=m.object({required:{menuType:m.literals(...h,null)},optional:{}}),o=(0,u.Gu)(i,t);return o?new x(v.InvalidRequestType,JSON.stringify(o)):t.menuType}(e);if(i instanceof x)return void console.error(JSON.stringify(i));const o=t.NativeMobileActionBarStore?t.NativeMobileActionBarStore.state.menuType:null;if((0,se.Y)("supportsNativeMobileDynamicActionBar")&&"insertBlock"===i){z.hc(t,null,!0);const e=ce.default.state,i="editing"===e.mode&&(0,$.QY)(e.multiSelection);i&&U.createAndCommit({userAction:"NativeMobileActionBar.SlashMenu.insertSlash",environment:t,perform:e=>{L.hJ({environment:t,store:i.store,string:D.pZ(),selection:i.selection,disableMentions:!1,disableDateMentions:!1,disableDateReminderMentions:!1,disableSlashCommands:!1,disableEmojiCommands:!0,transaction:e})}})}else if(o===i)z.hc(t,null,!0);else switch(z.hc(t,i,!0),i){case"insertBlock":z.Oh(t,"insert");break;case"turnInto":z.Oh(t,"turn_into");break;case"textColor":z.Oh(t,"color","mobile_action_bar");break;case"textSelectionColor":z.Oh(t,"color","mobile_text_formatting_menu")}}(t,this.environment);break;case"nativeAction_setSubMenuType":!function(e,t){const i=function(e){if("nativeAction_setSubMenuType"!==e.type)return new x(v.InvalidActionType,void 0);const t=e.apiRequestValue;if(!t||!("subMenuType"in t))return new x(v.MissingPayload,void 0);const i=m.object({required:{subMenuType:m.literals(...b,null)},optional:{}}),o=(0,u.Gu)(i,t);return o?new x(v.InvalidRequestType,JSON.stringify(o)):t.subMenuType}(e);if(i instanceof x)return void console.error(JSON.stringify(i));z.hD(t,i,!0)}(t,this.environment);break;case"webAction_generic":!function(e,t,i,o,n,s,r,a){const l=function(e){if("webAction_generic"!==e.type)return new x(v.InvalidActionType,void 0);const t=e.apiRequestValue;if(!t||!("jsonPayload"in t))return new x(v.MissingPayload,void 0);const i=JSON.parse(t.jsonPayload),o=m.object({required:{type:m.literals(...y)},optional:{}}),n=(0,u.Gu)(o,i);if(n)return new x(v.InvalidRequestType,JSON.stringify(n));const s=i,r=S[s.type],a=(0,u.Gu)(r,s);return a?new x(v.InvalidData,JSON.stringify(a)):s}(e);if(l instanceof x)return void console.error(JSON.stringify(l));switch(l.type){case"blockAction":const e=Se[l.data.action];if(!e)break;const c=e.action;if(c){const{mainEditorCurrentBlockStore:s}=re.default.state;if(!s)break;const{device:d}=r;e.closeParentMenu&&!d.isTablet&&z.hc(r,null,!0),c({environment:r,blocks:[s],publicEditMode:void 0,lazyDependencies:{markdownLinkifyIt:t,tinyMceMicrosoftWordPasteFilter:i,ai:o,assistant:n}}),a(l.data.action)}break;case"showActionBarMenu":if("template"===l.data.actionBarMenuId)!function(e,t){F.ZH(t),E.sD(),e.store.update((e=>({...e,isTemplatesOpen:!0}))),z.Oh(t,"templates")}(s,r)}}(t,this.props.markdownLinkifyIt,this.props.tinyMceMicrosoftWordPasteFilter,this.props.ai,this.props.assistant,this.props.stores,this.environment,(e=>{const t=e;this.buttonMap.state[t]&&ie.track(t)}));break;case"webAction_genericAction":this.handleActionRegistryAction(t)}},this.handleTextSelectionCompositeStoreChanged=()=>{if(!this.textSelectionCompositeStore.state)return;const{source:e}=this.textSelectionCompositeStore.state,{NativeMobileActionBarStore:t,device:i}=this.environment;"TextSelectionStore"!==e||null===(null==t?void 0:t.state.menuType)||i.isTablet||z.hc(this.environment,null,!0)},this.handleTextSelectionStoreChanged=()=>{if(!this.textSelectionPositionsStore.state)return;const{NativeMobileActionBarStore:e}=this.environment;e&&e.state.isSubMenuOverridden&&z.hD(this.environment,null,!1)},this.handleCurrentBlockStoreChanged=()=>{if(!(0,se.Y)("supportsNativeMobileDynamicActionBar"))return;const e=this.suggestedMenuTypeStore.state;Boolean(e)&&z.hD(this.environment,"suggested",!0)},this.actionBarTextSelectionStore=this.createComputedStore((()=>{const e="editing"===ce.default.state.mode&&ce.default.state.multiSelection,t=this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,i=t&&"editing"===t.mode&&t.multiSelection;return e||i||void 0}),!0),this.textSelectedBlocksStore=this.createComputedStore((()=>{var e;const t=this.actionBarTextSelectionStore.state;return t&&(null===(e=(0,Y.tp)({multiSelection:t,focus:void 0,filterCommonAncestors:!1}))||void 0===e?void 0:e.stores)})),this.disableMentionCommentsStore=this.createComputedStore((()=>{const e=this.actionBarTextSelectionStore.state,t=Boolean(e&&(0,$.qS)(e)),i=this.props.currentBlockStore.getType(),o=function(e,t){if(e&&(0,a._T)(e,t))return!0;return!1}(i,this.props.currentBlockStore.getFormat())||Boolean(this.renderStore.state.disableComment),n=!t,s=!t||function(e){if(e&&(0,a.lQ)(e))return!0;return!1}(i);return{disableCommentAction:o,disableLinkAction:n,disableMentionAction:s,disableEquationAction:!t}})),this.disableIndentStore=this.createComputedStore((()=>{const e=ae.default.state.stores;return{disableIndent:!e.every(N.nt),disableUnindent:!e.every(N.gq)}})),this.disableUndoRedoStore=this.createComputedStore((()=>({disableUndo:!O.L0(),disableRedo:!O.AZ()}))),this.isEditingCurrentPageTitleStore=this.createComputedStore(q.JE),this.isEditingCollectionViewTitleStore=this.createComputedStore(q.VV),this.showTemplatesButtonStore=this.createComputedStore((()=>z.Tz({environment:this.environment,store:this.props.currentBlockStore}))),this.reactiveMemoizedNativeMenusStore=this.createComputedStore((()=>this.memoizedNativeMenus({blocks:ae.default.state.stores,environment:this.environment}))),this.getCurrentActionBarSchema=this.createComputedStore(this.recomputeCurrentActionBarSchema.bind(this),!0,"getCurrentActionBarSchema"),this.buttonSectionsConfigStore=this.createComputedStore((()=>{var e,t;const{NativeMobileActionBarStore:i}=this.environment,o=Boolean(this.renderStore.state.disableStyleAnnotations),n=i?i.state.menuType:null;var s=null;const r=this.showTemplatesButtonStore.state,a=Boolean(null==i||null===(e=i.state)||void 0===e?void 0:e.isSubMenuOverridden),l=le.Z.state.open,c=this.shouldShowTextActions.state,d=i?i.state.subMenuType:null;a?s=d:l?(s="slashMenu",null==i||i.update((e=>({...e,isSubMenuOverridden:!1,subMenuType:null})))):c&&!o&&(s="textFormatting",null==i||i.update((e=>({...e,isSubMenuOverridden:!1,subMenuType:null}))));const u=!this.canTriggerTextActions.state,m=!this.canTriggerBlockActions.state,{disableCommentAction:p,disableLinkAction:h,disableMentionAction:b,disableEquationAction:g}=this.disableMentionCommentsStore.state,{disableIndent:f,disableUnindent:S}=this.disableIndentStore.state,y=this.isEditingCurrentPageTitleStore.state||this.isEditingCollectionViewTitleStore.state,{disableUndo:v,disableRedo:x}=this.disableUndoRedoStore.state,C=(0,G.GD)(null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state),k=ne.Z.state.isActive,T=y||k,A=this.reactiveMemoizedNativeMenusStore.state;return{selectedSubMenu:s,createAIAction:C,disableAIAction:T,disableBlockActions:m,disableCommentAction:p,disableMentionAction:b,selectedMenuType:n,disableTextFormatting:o,disableTextColorAction:M(A.textColor.sections),disableDeleteBlock:y,disableInsertBlockAction:M(A.insertBlock.sections),disableTurnIntoAction:M(A.turnInto.sections),shouldShowTemplatesButton:r,disableIndent:f,disableUnindent:S,disableUndo:v,disableRedo:x,disableTextActions:u,isEditingTitle:y,disableLinkAction:h,disableEquationAction:g,shouldShowTextActions:!0===c}})),this.templateButtonSectionsStore=this.createComputedStore((()=>({id:"mab.buttonSection.template",buttons:[p("mab.button.choose_template","webAction_generic",{content:{type:"text_and_icon",imageReference:{localImageIdentifier:"template"},text:W.default.formatMessage(ke.templatesButtonTitle)},apiRequestValue:{jsonPayload:f("showActionBarMenu",{actionBarMenuId:"template"})}})]}))),this.buttonMap=this.createComputedStore((()=>{const{createAIAction:e,disableAIAction:t,disableBlockActions:i,disableCommentAction:o,disableMentionAction:n,selectedMenuType:s,disableInsertBlockAction:r,disableTurnIntoAction:a,disableTextFormatting:c,disableDeleteBlock:d,disableUndo:u,disableIndent:m,disableUnindent:h}=this.buttonSectionsConfigStore.state;return function(e){const{createAIAction:t,disableAIAction:i,disableBlockActions:o,disableCommentAction:n,disableMentionAction:s,selectedMenuType:r,disableInsertBlockAction:a,disableTurnIntoAction:c,disableTextFormatting:d,disableDeleteBlock:u,disableUndo:m,disableIndent:h,disableUnindent:b,supportsDynamicMobileActionBar:g,accessibilityTexts:S}=e;return{ai:t?p("mab.button.ai","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"sparkles",localImageIdentifier:"ai",imageTintColor:(0,l.J1)(l.FN.light.purple[500])},disabled:i,accessibilityText:S.ai},apiRequestValue:{jsonPayload:f("blockAction",{action:"ai"})}}):void 0,insert:p("mab.button.insert","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"plus",localImageIdentifier:"insertBlock"},accessibilityText:S.insert,disabled:o||a,selected:"insertBlock"===r},apiRequestValue:{menuType:"insertBlock"}}),turnInto:g?p("mab.button.turnInto","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.2.squarepath",localImageIdentifier:"turnInto"},disabled:o||c,selected:"turnInto"===r,accessibilityText:S.turnInto},apiRequestValue:{subMenuType:"turnInto"}}):p("mab.button.turnInto","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.2.squarepath",localImageIdentifier:"turnInto"},disabled:o||c,selected:"turnInto"===r,accessibilityText:S.turnInto},apiRequestValue:{menuType:"turnInto"}}),filePicker:k(o,S.filePicker),mention:I(s,S.mention),comment:T(n,S.comment),biu:p("bold.italic.underline","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"textformat",localImageIdentifier:"textFormat"},disabled:d,accessibilityText:S.textFormatting},apiRequestValue:{subMenuType:"textFormatting"}}),delete:w(u,S.trash),undo:A(m,S.undo),more:g?p("mab.button.more","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"ellipsis",localImageIdentifier:"more"},disabled:o,accessibilityText:S.more},apiRequestValue:{subMenuType:"more"}}):p("mab.button.more","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"ellipsis",localImageIdentifier:"more"},accessibilityText:S.more,disabled:o},apiRequestValue:{jsonPayload:f("blockAction",{action:"more"})}}),indent:B(o,h,S.indent),unindent:P(o,b,S.unindent),moveUp:_(o,S.moveUp),moveDown:j(o,S.moveDown)}}({createAIAction:e,disableAIAction:t,disableBlockActions:i,disableCommentAction:o,disableMentionAction:n,selectedMenuType:s,disableInsertBlockAction:r,disableTurnIntoAction:a,disableTextFormatting:c,disableDeleteBlock:d,disableUndo:u,disableIndent:m,disableUnindent:h,supportsDynamicMobileActionBar:(0,se.Y)("supportsNativeMobileDynamicActionBar"),accessibilityTexts:{insert:W.default.formatMessage(ke.accessibilityInsert),turnInto:W.default.formatMessage(ke.accessibilityTurnInto),filePicker:W.default.formatMessage(ke.accessibilityFilePicker),mention:W.default.formatMessage(ke.accessibilityMention),comment:W.default.formatMessage(ke.accessibilityComment),textFormatting:W.default.formatMessage(ke.accessibilityTextFormatting),trash:W.default.formatMessage(ke.accessibilityTrash),ai:W.default.formatMessage(ke.accessibilityAi),undo:W.default.formatMessage(ke.accessibilityUndo),more:W.default.formatMessage(ke.accessibilityMore),indent:W.default.formatMessage(ke.accessibilityIndent),unindent:W.default.formatMessage(ke.accessibilityDedent),moveUp:W.default.formatMessage(ke.accessibilityMoveUp),moveDown:W.default.formatMessage(ke.accessibilityMoveDown)}})})),this.primaryActionButtonSectionsStoreV2=this.createComputedStore((()=>{const{disableBlockActions:e,disableIndent:t,disableUnindent:i}=this.buttonSectionsConfigStore.state,o=this.textSelectedBlocksStore.state,n=!!o&&o.some((e=>{const t=e.getType();return t&&Te[t]}));return function(e){const{buttonMap:t,disableBlockActions:i,disableIndent:o,disableUnindent:n,someBlockPrioritizesIndentation:s,supportsSectionAnimation:r,supportsDynamicMobileActionBar:a}=e,l=!(i||o&&n);if(a)return[{id:"mab.buttonSection.main",buttons:[t.ai,t.insert,t.turnInto,t.biu,t.more].filter(d.$K)}];if(l&&s){const e=[t.unindent,t.indent,t.moveUp,t.moveDown].filter(d.$K),i=[t.ai,t.insert,t.turnInto,t.filePicker,t.biu,t.comment,t.undo,t.mention,t.delete,t.more].filter(d.$K);return r?[{id:"mab.buttonSection.listPrioritized",buttons:e,skipSectionDivider:!0},{id:"mab.buttonSection.main",buttons:i}]:[{id:"mab.buttonSection.listPrioritized",buttons:[...e,...i],skipSectionDivider:!0}]}return[{id:"mab.buttonSection.main",buttons:[t.ai,t.insert,t.turnInto,t.filePicker,t.biu,t.comment,t.undo,t.mention,t.delete,t.indent,t.unindent,t.moveUp,t.moveDown,t.more].filter(d.$K)}]}({buttonMap:this.buttonMap.state,disableBlockActions:e,disableIndent:t,disableUnindent:i,someBlockPrioritizesIndentation:n,supportsSectionAnimation:this.environment.device.isIOS,supportsDynamicMobileActionBar:(0,se.Y)("supportsNativeMobileDynamicActionBar")})})),this.textFormattingButtonSectionsStoreV2=this.createComputedStore((()=>{const{disableCommentAction:e,selectedMenuType:t,disableTextActions:i,disableTextColorAction:o,disableLinkAction:n,disableEquationAction:s,disableBlockActions:r,disableTurnIntoAction:a,disableAIAction:c,createAIAction:u,shouldShowTextActions:m}=this.buttonSectionsConfigStore.state;return function(e){const{disableTextActions:t,boldSelected:i,italicSelected:o,underlineSelected:n,strikeSelected:s,codeSelected:r,linkSelected:a,equationSelected:c,selectedMenuType:u,disableTextColorAction:m,disableCommentAction:h,disableLinkAction:b,disableEquationAction:g,textColorImageReference:S,supportsDynamicMobileActionBar:y,accessibilityTexts:v,disableBlockActions:x,disableTurnIntoAction:M,disableAIAction:C,createAIAction:k,shouldShowTextActions:T}=e,A=T?"textSelectionColor":"textColor",w={back:p("mab.button.back","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"chevron.backward.2",localImageIdentifier:"back"},accessibilityText:v.close},apiRequestValue:{subMenuType:null}}),bold:p("mab.button.bold","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"bold",localImageIdentifier:"bold"},accessibilityText:v.bold,disabled:t,selected:i},apiRequestValue:{jsonPayload:f("blockAction",{action:"bold"})}}),italic:p("mab.button.italic","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"italic",localImageIdentifier:"italic"},disabled:t,selected:o,accessibilityText:v.italics},apiRequestValue:{jsonPayload:f("blockAction",{action:"italic"})}}),underline:p("mab.button.underline","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"underline",localImageIdentifier:"underline"},disabled:t,selected:n,accessibilityText:v.underline},apiRequestValue:{jsonPayload:f("blockAction",{action:"underline"})}}),strikethrough:p("mab.button.strikethrough","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"strikethrough",localImageIdentifier:"strikethrough"},disabled:t,selected:s,accessibilityText:v.strikethrough},apiRequestValue:{jsonPayload:f("blockAction",{action:"strikethrough"})}}),color:y?p("mab.button.textFormatting.textSelectionColor.native","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:S,disabled:t||m,selected:u===A,accessibilityText:v.textColor},apiRequestValue:{subMenuType:A}}):p("mab.button.textFormatting.textSelectionColor.native","nativeAction_setMenuType",{content:{type:"icon",imageReference:S,disabled:t||m,selected:u===A,accessibilityText:v.textColor},apiRequestValue:{menuType:A}}),comment:p("mab.button.textFormatting.comment","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"bubble.left",localImageIdentifier:"comment"},disabled:t||h,accessibilityText:v.comment},apiRequestValue:{jsonPayload:f("blockAction",{action:"comment"},"mobile_text_formatting_menu")}}),link:p("mab.button.link","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"link",localImageIdentifier:"link"},accessibilityText:v.link,disabled:t||b,selected:a},apiRequestValue:{jsonPayload:f("blockAction",{action:"link"})}}),code:p("mab.button.code","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"chevron.left.slash.chevron.right",localImageIdentifier:"code"},accessibilityText:v.code,disabled:t,selected:r},apiRequestValue:{jsonPayload:f("blockAction",{action:"code"})}}),equation:p("mab.button.equation","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"x.squareroot",localImageIdentifier:"equation"},accessibilityText:v.equation,disabled:t||g,selected:c},apiRequestValue:{jsonPayload:f("blockAction",{action:"equation"})}}),cancel:p("mab.button.cancel","nativeAction_setSubMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"xmark.circle.fill",localImageIdentifier:"cancel",imageTintColor:"#72706B64"},accessibilityText:v.close},apiRequestValue:{subMenuType:null}}),turnInto:p("mab.button.turnInto","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"arrow.2.squarepath",localImageIdentifier:"turnInto"},disabled:x||M,selected:"turnInto"===u,accessibilityText:v.turnInto},apiRequestValue:{menuType:"turnInto"}}),ai:k?p("mab.button.ai","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"sparkles",localImageIdentifier:"ai",imageTintColor:(0,l.J1)(l.FN.light.purple[500])},disabled:C,accessibilityText:v.ai},apiRequestValue:{jsonPayload:f("blockAction",{action:"ai"})}}):void 0};let I;return I=T?[w.back,w.turnInto,w.ai,w.color,w.comment,w.bold,w.italic,w.underline,w.strikethrough,w.link,w.code,w.equation].filter(d.$K):[w.back,w.color,w.bold,w.italic,w.underline,w.strikethrough,w.link,w.code,w.equation],{id:"mab.buttonSection.textFormatting",shouldFadeIn:!0,buttons:I}}({disableTextActions:i,disableCommentAction:e,disableLinkAction:n,disableEquationAction:s,selectedMenuType:t,disableTextColorAction:o,disableBlockActions:r,disableTurnIntoAction:a,disableAIAction:c,createAIAction:u,shouldShowTextActions:m,textColorImageReference:Be(this.textSelectionColorStore.state,this.theme),supportsDynamicMobileActionBar:(0,se.Y)("supportsNativeMobileDynamicActionBar"),accessibilityTexts:{bold:W.default.formatMessage(ke.accessibilityBold),italics:W.default.formatMessage(ke.accessibilityItalics),underline:W.default.formatMessage(ke.accessibilityUnderline),strikethrough:W.default.formatMessage(ke.accessibilityStrikethrough),textColor:W.default.formatMessage(ke.accessibilityTextColor),comment:W.default.formatMessage(ke.accessibilityComment),code:W.default.formatMessage(ke.accessibilityCode),link:W.default.formatMessage(ke.accessibilityLink),equation:W.default.formatMessage(ke.accessibilityEquation),close:W.default.formatMessage(ke.accessibilityCloseTextFormattingMenu),turnInto:W.default.formatMessage(ke.accessibilityTurnInto),ai:W.default.formatMessage(ke.accessibilityAi)},...this.textFormattingSelectionStore.state})})),this.mainButtonSectionsStoreV2=this.createComputedStore((()=>{const{shouldShowTemplatesButton:e}=this.buttonSectionsConfigStore.state;return e?[this.templateButtonSectionsStore.state]:this.primaryActionButtonSectionsStoreV2.state})),this.textSelectionPositionsStore=this.createComputedStore((()=>{const e=this.textSelectionCompositeStore.state;if(!e)return;const{source:t,...i}=e;return i}),!0),this.currentBlockStore=this.createComputedStore((()=>{const e=this.textSelectedBlocksStore.state;return 1===(null==e?void 0:e.length)?e[0]:void 0}),!0),this.suggestedMenuTypeStore=this.createComputedStore((()=>{const e=this.currentBlockStore.state,t=null==e?void 0:e.getType(),i=t&&Te[t],o=e&&(0,Q.PF)(e);return i?"indent":o?"empty":void 0})),this.suggestedMenuStore=this.createComputedStore((()=>{if(!(0,se.Y)("supportsNativeMobileDynamicActionBar"))return{id:"mab.buttonSection.suggested",shouldFadeIn:!0,buttons:[]};this.environment,ae.default.state.stores;const e=this.buttonMap.state,t=this.suggestedMenuTypeStore.state;return{id:"mab.buttonSection.suggested",shouldFadeIn:!0,buttons:Me(0,e,t,ie.get())}})),this.slashSubMenuStore=this.createComputedStore((()=>{if(!(0,se.Y)("supportsNativeMobileDynamicActionBar"))return{id:"mab.buttonSection.slashMenu",shouldFadeIn:!0,buttons:[]};const e=le.Z.state;if(!e.open)return{id:"mab.buttonSection.slashMenu",shouldFadeIn:!0,buttons:[]};const t={environment:this.environment,blocks:ae.default.state.stores,publicEditMode:void 0};return{id:"mab.buttonSection.slashMenu",shouldFadeIn:!0,buttons:ye(t,e)}})),this.turnIntoSubmenuStore=this.createComputedStore((()=>{if(!(0,se.Y)("supportsNativeMobileDynamicActionBar"))return{id:"mab.buttonSection.turnInto",shouldFadeIn:!0,buttons:[]};const e={environment:this.environment,blocks:ae.default.state.stores,publicEditMode:void 0};return{id:"mab.buttonSection.turnInto",shouldFadeIn:!0,buttons:ve(e)}})),this.moreSubmenuStore=this.createComputedStore((()=>{if(!(0,se.Y)("supportsNativeMobileDynamicActionBar"))return{id:"mab.buttonSection.turnInto",shouldFadeIn:!0,buttons:[]};const{disableBlockActions:e,disableCommentAction:t,disableMentionAction:i,disableDeleteBlock:o,disableUndo:n,disableIndent:s,disableUnindent:r}=this.buttonSectionsConfigStore.state;return{id:"mab.buttonSection.more",shouldFadeIn:!0,buttons:(a={disableBlockActions:e,disableCommentAction:t,disableMentionAction:i,disableDeleteBlock:o,disableUndo:n,disableIndent:s,disableUnindent:r,accessibilityTexts:{filePicker:W.default.formatMessage(ke.accessibilityFilePicker),comment:W.default.formatMessage(ke.accessibilityComment),undo:W.default.formatMessage(ke.accessibilityUndo),mention:W.default.formatMessage(ke.accessibilityMention),trash:W.default.formatMessage(ke.accessibilityTrash),indent:W.default.formatMessage(ke.accessibilityIndent),unindent:W.default.formatMessage(ke.accessibilityDedent),moveUp:W.default.formatMessage(ke.accessibilityMoveUp),moveDown:W.default.formatMessage(ke.accessibilityMoveDown),more:W.default.formatMessage(ke.accessibilityMore)}},[C,k(a.disableBlockActions,a.accessibilityTexts.filePicker),T(a.disableCommentAction,a.accessibilityTexts.comment),A(a.disableUndo,a.accessibilityTexts.undo),I(a.disableMentionAction,a.accessibilityTexts.mention),w(a.disableDeleteBlock,a.accessibilityTexts.trash),B(a.disableBlockActions,a.disableUnindent,a.accessibilityTexts.indent),P(a.disableBlockActions,a.disableIndent,a.accessibilityTexts.unindent),_(a.disableBlockActions,a.accessibilityTexts.moveUp),j(a.disableBlockActions,a.accessibilityTexts.moveDown),p("mab.button.more","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"ellipsis",localImageIdentifier:"more"},accessibilityText:a.accessibilityTexts.more},apiRequestValue:{jsonPayload:f("blockAction",{action:"more"})}})])};var a})),this.textColorSubmenuStore=this.createComputedStore((()=>{if(!(0,se.Y)("supportsNativeMobileDynamicActionBar"))return{id:"mab.buttonSection.textColor",shouldFadeIn:!0,buttons:[]};const e={environment:this.environment,blocks:ae.default.state.stores,publicEditMode:void 0};return{id:"mab.buttonSection.textColor",shouldFadeIn:!0,buttons:xe(e,"textColor")}})),this.textSelectionColorSubmenuStore=this.createComputedStore((()=>{if(!(0,se.Y)("supportsNativeMobileDynamicActionBar"))return{id:"mab.buttonSection.textSelectionColor",shouldFadeIn:!0,buttons:[]};const e={environment:this.environment,blocks:ae.default.state.stores,publicEditMode:void 0};return{id:"mab.buttonSection.textSelectionColor",shouldFadeIn:!0,buttons:xe(e,"textSelectionColor")}})),this.textSelectionCompositeStore=this.createComputedStore((()=>{const e=(e,t)=>{if(!e||"editing"!==e.mode)return;const{multiSelection:i}=e;return{startRecord:i.start.store.pointer,startIndex:i.start.index,endRecord:i.end.store.pointer,endIndex:i.end.index,source:t}};return e(ce.default.state,"TextSelectionStore")||e(this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState,"IgnoreSelectionAreaStore")}),!0),this.renderStore=this.createComputedStore((()=>{var e;const t=z.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state);if(!t){const e=this.environment.NativeMobileActionBarStore;null!==(null==e?void 0:e.state.menuType)&&c.gw((()=>{var e;z.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)||z.hc(this.environment,null,!1)}),500),null!==(null==e?void 0:e.state.subMenuType)&&c.gw((()=>{var e;z.$3(this.environment,this.props.currentBlockStore,null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state)||z.hD(this.environment,null,!1)}),500)}return t})),this.shouldShowTextActions=this.createComputedStore((()=>z.oQ(this.props.stores.ignoreSelectionAreaStore,this.environment.TextSelectionCompositionStore))),this.canTriggerBlockActions=this.createComputedStore((()=>z.Bo(this.pageContext&&this.pageContext.publicEditModeStore.state))),this.canTriggerTextActions=this.createComputedStore((()=>z.eQ(this.pageContext&&this.pageContext.publicEditModeStore.state,this.props.currentBlockStore))),this.memoizedNativeMenus=c.HP((e=>{const{blocks:t,environment:i}=e;return o={environment:i,blocks:t,publicEditMode:void 0},{insertBlock:ge({type:"insertBlock",actionSections:he.L1(ue.v.state.insertActions,o),context:o,closeParentMenu:!0}),turnInto:ge({type:"turnInto",actionSections:he.L1([me.g],o),context:o,closeParentMenu:!0}),textColor:ge({type:"textColor",actionSections:he.L1([de.rz,de.Vm],o),context:o,closeParentMenu:!0}),textSelectionColor:ge({type:"textSelectionColor",actionSections:he.L1([de.b4,de.Sw],o),context:o,closeParentMenu:!0})};var o}),(e=>{let{blocks:t,environment:i}=e;const o=t.map((e=>e.key)).join(",");return`${i.key}-${o}`})),this.textFormattingSelectionStore=this.createComputedStore((()=>{let e;e="editing"===ce.default.state.mode?(0,J.k2)([R.GKr.Bold,R.GKr.Italic,R.GKr.Underline,R.GKr.Strike,R.GKr.Code,R.GKr.Link,R.GKr.Equation,R.GKr.Highlight],ce.default.state.multiSelection,ce.default.state.forceExtendAnnotations):{};const t=e[R.GKr.Highlight];return{boldSelected:Boolean(e[R.GKr.Bold]),italicSelected:Boolean(Boolean(e[R.GKr.Italic])),underlineSelected:Boolean(Boolean(e[R.GKr.Underline])),strikeSelected:Boolean(Boolean(e[R.GKr.Strike])),codeSelected:Boolean(e[R.GKr.Code]),linkSelected:Boolean(e[R.GKr.Link]),equationSelected:Boolean(e[R.GKr.Equation]),highlightColor:t?(0,R.zIN)(t):void 0}})),this.textSelectionColorStore=this.createComputedStore((()=>{const{NativeMobileActionBarStore:e}=this.environment,t=e&&null!==e.state.menuType?this.props.stores.ignoreSelectionAreaStore.state.savedTextSelectionStoreState:void 0;if(!t)return this.textFormattingSelectionStore.state.highlightColor;const i="editing"===t.mode&&(0,J.a6)("h",t.multiSelection,t.forceExtendAnnotations);return i?(0,R.zIN)(i):void 0}))}didMount(){this.textSelectionCompositeStore.addListener(this.handleTextSelectionCompositeStoreChanged),this.textSelectionPositionsStore.addListener(this.handleTextSelectionStoreChanged),this.currentBlockStore.addListener(this.handleCurrentBlockStoreChanged)}willUnmount(){this.textSelectionCompositeStore.removeListener(this.handleTextSelectionCompositeStoreChanged),this.textSelectionPositionsStore.removeListener(this.handleTextSelectionStoreChanged),this.currentBlockStore.removeListener(this.handleCurrentBlockStoreChanged),this.props.renderApi&&this.props.renderApi({type:"unmount",id:""})}renderComponent(){const{fallbackRenderer:e,stores:t}=this.props;return(0,Ce.jsx)(Ae,{isOpen:this.renderStore.state.shouldShow,canShow:this.renderStore.state.canShowNativeBar,isEmpty:this.renderStore.state.isEmpty,schema:this.getCurrentActionBarSchema.state,onAction:this.handleMobileActionBarBridgeEvent,fallbackRenderer:e&&(()=>e(t))})}recomputeCurrentActionBarSchema(){const{selectedMenuType:e,selectedSubMenu:t}=this.buttonSectionsConfigStore.state,i=(0,se.Y)("supportsNativeMobileDynamicActionBar"),o=this.reactiveMemoizedNativeMenusStore.state;return function(e){const{version:t,selectedMenu:i,selectedSubMenu:o,nativeMenus:n,buttonSections:s,nativeSubMenus:r,accessibilityTexts:a,localizedMessages:l}=e;return{nativeMenus:n,nativeSubMenus:r,localizedMessages:l,state:{buttonSections:s,selectedMenu:i,selectedSubMenu:o,dismissKeyboardButton:null!==i?p("mab.dismissKeyboard","nativeAction_setMenuType",{content:{type:"icon",imageReference:{sfProGlyphName:"xmark.circle.fill",localImageIdentifier:"cancel",imageTintColor:"#72706B64"},accessibilityText:a.closeActionMenu},apiRequestValue:{menuType:null}}):p("mab.dismissKeyboard","webAction_generic",{content:{type:"icon",imageReference:{sfProGlyphName:"keyboard.chevron.compact.down",localImageIdentifier:"keyboardDown"},accessibilityText:a.dismissKeyboard},apiRequestValue:{jsonPayload:f("blockAction",{action:"dismissKeyboard"})}})},version:t}}({version:(0,se.Y)("supportsNativeMobileDynamicActionBar")?2:1,selectedMenu:e,selectedSubMenu:t,nativeMenus:{textColor:{id:"textColor",title:W.default.formatMessage(ke.actionMenuColorTitle),sections:i?[]:o.textColor.sections},textSelectionColor:{id:"textSelectionColor",title:W.default.formatMessage(ke.actionMenuColorTitle),sections:i?[]:o.textSelectionColor.sections},insertBlock:{id:"insertBlock",title:W.default.formatMessage(ke.actionMenuInsertBlockTitle),sections:i?[]:o.insertBlock.sections},turnInto:{id:"turnInto",title:W.default.formatMessage(ke.actionMenuTurnIntoTitle),sections:i?[]:o.turnInto.sections}},nativeSubMenus:{suggested:[this.suggestedMenuStore.state],textFormatting:[this.textFormattingButtonSectionsStoreV2.state],slashMenu:[this.slashSubMenuStore.state],turnInto:[this.turnIntoSubmenuStore.state],textColor:[this.textColorSubmenuStore.state],textSelectionColor:[this.textSelectionColorSubmenuStore.state],more:[this.moreSubmenuStore.state]},buttonSections:this.mainButtonSectionsStoreV2.state,accessibilityTexts:{dismissKeyboard:W.default.formatMessage(ke.accessibilityDismissKeyboard),closeActionMenu:W.default.formatMessage(ke.accessibilityCloseActionMenu)},localizedMessages:{...this.getLabelForSelectedSubMenu(t)}})}getLabelForSelectedSubMenu(e){var t=void 0;switch(e){case null:break;case"suggested":t=W.default.formatMessage(ke.subMenuLabelSuggested);break;case"slashMenu":t=W.default.formatMessage(ke.subMenuLabelInsert);break;case"turnInto":t=W.default.formatMessage(ke.subMenuLabelTurnInto);break;case"textFormatting":t=W.default.formatMessage(ke.subMenuLabelTextFormatting);break;case"textColor":case"textSelectionColor":t=W.default.formatMessage(ke.subMenuLabelTextColor)}return t?{selectedSubMenuLabel:t}:void 0}handleActionRegistryAction(e){var t,i;const{markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:n,ai:s,assistant:r}=this.props,a=null===(t=e.apiRequestValue)||void 0===t?void 0:t.menuType,l=null===(i=e.apiRequestValue)||void 0===i?void 0:i.actionId;if(!a||!l)return;const c=this.memoizedNativeMenus({environment:this.environment,blocks:ae.default.state.stores})[a].actions[l];if(!c)return;const d=c.action;d&&(c.closeParentMenu&&z.hc(this.environment,null,!0),(0,se.Y)("supportsNativeMobileDynamicActionBar")&&le.Z.state.open&&U.createAndCommit({userAction:"NativeMobileActionBar.SlashMenu.handleAccept",environment:this.environment,perform:e=>{D.RL({environment:this.environment,transaction:e})}}),d({environment:this.environment,blocks:ae.default.state.stores,publicEditMode:void 0,lazyDependencies:{markdownLinkifyIt:o,tinyMceMicrosoftWordPasteFilter:n,ai:s,assistant:r}}));const u=ae.default.state.stores[0];if(u){const e=u.getType(),t=u.getFormat();V.dh(this.environment,{analyticsName:c.analyticsName,action_type:c.analyticsActionType,from:"slash_menu",block_id:u.id,block_type:e,is_toggleable:e?(0,X._A)(e,t):void 0,slash_menu_filter_length:0,slash_menu_section:`Mobile Action Bar ${a}`})}}}function Ie(e){window.__c={n:"NativeMobileActionBarWithDeps"};const t=(0,Z.useIntl)(),{value:i}=(0,ee.useDependency)(ee.deps.markdownLinkifyIt),{value:o}=(0,ee.useDependency)(ee.deps.tinyMceMicrosoftWordPasteFilter),{value:n}=(0,ee.useDependency)(H.E0),{value:s}=(0,ee.useDependency)(K.L6);return(0,Ce.jsx)(we,{...e,intl:t,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:o,ai:n,assistant:s})}function Be(e,t){let i="textColor";const o=l.E_.find((t=>t===e));let n;"default"===e||o&&(o.includes("background")?(n="background",i="textBackgroundColor"):n="color");const s=n&&o?(0,l.fi)(o,t)[n]:void 0;return{localImageIdentifier:i,imageTintColor:s?(0,l.J1)(s):void 0}}we.displayName="NativeMobileActionBar"},99930:(e,t,i)=>{i.r(t),i.d(t,{default:()=>Je});i(57658);var o=i(67294),n=i(83355),s=i(1302),r=i(480),a=i(86628),l=i(24405),c=i(27328),d=i(99747),u=i(15145),m=i(8848),p=i(42853),h=i(63261),b=i(44495),g=i(45238),f=i(85893);const S=(0,g.I)("mobileOffline",{viewBox:"0 0 26 26",svg:(0,f.jsx)("path",{d:"M26.0029 13.2441C25.9922 11.9873 24.2842 11.0742 22.2324 11.0742H17.9033C17.3018 11.0742 17.0762 10.9775 16.7217 10.5693L9.50293 2.69531C9.27734 2.4375 8.99805 2.30859 8.67578 2.30859H7.42969C7.15039 2.30859 6.98926 2.55566 7.12891 2.85645L10.8457 11.0742L5.38867 11.6973L3.44434 8.13086C3.30469 7.8623 3.06836 7.74414 2.71387 7.74414H2.25195C1.97266 7.74414 1.79004 7.92676 1.79004 8.20605V18.2822C1.79004 18.5615 1.97266 18.7334 2.25195 18.7334H2.71387C3.06836 18.7334 3.30469 18.6152 3.44434 18.3574L5.38867 14.791L10.8457 15.4141L7.12891 23.6318C6.98926 23.9219 7.15039 24.1797 7.42969 24.1797H8.67578C8.99805 24.1797 9.27734 24.04 9.50293 23.793L16.7217 15.9082C17.0762 15.5107 17.3018 15.4141 17.9033 15.4141H22.2324C24.2842 15.4141 25.9922 14.4902 26.0029 13.2441Z"})}),y=(0,g.I)("mobileTopbarComments",{viewBox:"0 0 27 27",svg:(0,f.jsx)("path",{d:"M8.74414 24.6816C9.22266 24.6816 9.55469 24.4277 10.1504 23.9004L13.5195 20.9023H19.7891C22.6992 20.9023 24.2617 19.291 24.2617 16.4297V8.94922C24.2617 6.08789 22.6992 4.47656 19.7891 4.47656H7.21094C4.30078 4.47656 2.73828 6.07812 2.73828 8.94922V16.4297C2.73828 19.3008 4.30078 20.9023 7.21094 20.9023H7.67969V23.4414C7.67969 24.1934 8.06055 24.6816 8.74414 24.6816ZM9.14453 22.8945V20.0625C9.14453 19.5352 8.93945 19.3301 8.41211 19.3301H7.21094C5.23828 19.3301 4.31055 18.3242 4.31055 16.4199V8.94922C4.31055 7.04492 5.23828 6.04883 7.21094 6.04883H19.7891C21.752 6.04883 22.6895 7.04492 22.6895 8.94922V16.4199C22.6895 18.3242 21.752 19.3301 19.7891 19.3301H13.4609C12.9141 19.3301 12.6406 19.4082 12.2695 19.7891L9.14453 22.8945ZM8.4707 9.99414H18.4121C18.7246 9.99414 18.9688 9.75 18.9688 9.42773C18.9688 9.125 18.7246 8.87109 18.4121 8.87109H8.4707C8.1582 8.87109 7.9043 9.125 7.9043 9.42773C7.9043 9.75 8.1582 9.99414 8.4707 9.99414ZM8.4707 13.1777H18.4121C18.7246 13.1777 18.9688 12.9238 18.9688 12.6016C18.9688 12.2988 18.7246 12.0449 18.4121 12.0449H8.4707C8.1582 12.0449 7.9043 12.2988 7.9043 12.6016C7.9043 12.9238 8.1582 13.1777 8.4707 13.1777ZM8.4707 16.3516H14.9355C15.248 16.3516 15.4922 16.1074 15.4922 15.7949C15.4922 15.4727 15.248 15.2188 14.9355 15.2188H8.4707C8.1582 15.2188 7.9043 15.4727 7.9043 15.7949C7.9043 16.1074 8.1582 16.3516 8.4707 16.3516Z"})});var v=i(35840),x=i(89101),M=i(21202),C=i(82990),k=i(51454),T=i(9291),A=i(36610),w=i(83249),I=i(19719),B=i(11302),P=i(75754),_=i(8055),j=i(1357),R=i(87531),Z=i(24677),V=i(29974),N=i(98104),O=i(82530),F=i(39865),D=i(3043),L=i(7476),E=i(34047),U=i(24098),H=i(28020),K=i(43250),q=i(87279),G=i(46654),W=i(58239),z=i(18514),$=i(48779),Y=i(77907),Q=i(64719),J=i(81170),X=i(94841),ee=i(57345),te=i(74948),ie=i(24646),oe=i(38676),ne=i(21853),se=i(4023),re=i(5162),ae=i(80444),le=i(77080),ce=i(92547),de=i(69454),ue=i(42330),me=i(30496),pe=i(79797),he=i(24666),be=i(52258),ge=i(66708),fe=i(91754),Se=i(15560),ye=i(64921),ve=i(31945),xe=i(61519),Me=i(73063),Ce=i(78140),ke=i(40721),Te=i(89728),Ae=i(53437),we=i(31278),Ie=i(76798),Be=i(45653),Pe=i(39849),_e=i(53228),je=i(81258),Re=i(84708),Ze=i(82598);function Ve(){window.__c={n:"MobileUpdatesModalPageTab"};const e=(0,o.useCallback)((()=>(0,f.jsx)(Ze.Z,{message:(0,f.jsx)(T.FormattedMessage,{defaultMessage:"Any changes to this page will show up here.",id:"updatesModal.currentPageTab.emptyPrompt"}),title:(0,f.jsx)(T.FormattedMessage,{defaultMessage:"No page updates",id:"updatesModal.currentPageTab.emptyPromptTitle"})})),[]),t=(0,a.VK)((()=>ae.default.state.currentSpaceStore),[]),i=(0,a.VK)((()=>ae.default.state.mainEditorCurrentBlockStore),[]),n=(0,a.VK)((()=>{var e;const t=null==i||null===(e=i.getCollectionPointer())||void 0===e?void 0:e.id,o=null==i?void 0:i.isCollectionView();return null!=i&&i.isDefined()?{id:i.id,isCollection:o,collectionId:t}:void 0}),[i]),s=(0,l.yK)((()=>({getNotifiedFor:{padding:18}})),[]);return t&&n&&i?(0,f.jsxs)("div",{children:[(0,f.jsx)("div",{style:s.getNotifiedFor,children:(0,f.jsx)(_e.GetNotifiedFor,{navigableBlock:i,from:"page_updates",buttonPopupStore:je.Z})}),(0,f.jsx)(Re.Z,{navigableBlock:i,collectionId:n.collectionId,spaceId:t.id,empty:e,source:"updates_sidebar"},"current-page")]}):null}var Ne=i(92955),Oe=i(58493),Fe=i(13612),De=i(69054),Le=i(99659),Ee=i(25906),Ue=i(5248),He=i(84920),Ke=i(26399),qe=i(42543),Ge=i(72485),We=i(86467),ze=i(7715),$e=i(82774),Ye=i(94107);class Qe extends n.Z{constructor(){super(...arguments),this.isMyTasks=this.createComputedStore((()=>(0,H.qG)(this.props.store.id))),this.hasUnreadCommentsStore=this.createComputedStore((()=>(0,E.DF)({blockStore:this.props.store,currentUserId:this.environment.currentUser.id}).some((e=>!e.getResolved()&&(0,E.NI)(e).some((t=>L.t({discussionStore:e,commentStore:t})))))),!1)}renderComponent(){const{store:e}=this.props,{WindowSizeStore:t,device:i}=this.environment,o=(0,G.IJ)(this.environment,this.props.store),n=new ce.Z,s=(e.isLocked()||n.state.justUnlocked)&&e.canEdit(),r=(!o||e.canEditCollection())&&i.isPhone&&(e.isRestricted()||s);return(0,f.jsx)(U.Z,{capture:!0,render:i=>(0,f.jsxs)("header",{...i,style:{width:"100%",maxWidth:"100vw",zIndex:k.lI},children:[o?(0,f.jsx)(mt,{store:this.props.store,shouldShowAddTo:this.props.shouldShowAddTo}):(0,f.jsx)(yt,{store:this.props.store,pageVisitStore:this.props.pageVisitStore,presenceStore:this.props.presenceStore,hideActionButtons:this.props.hideActionButtons,isInvalidPage:this.props.isInvalidPage,spaceStore:this.props.spaceStore,collectionViewStore:this.props.collectionViewStore,shouldShowAddTo:this.props.shouldShowAddTo,spaceViewStore:this.props.spaceViewStore,saveParent:this.props.saveParent,hasUnreadCommentsStore:this.hasUnreadCommentsStore,isMyTasksStore:this.isMyTasks}),r&&(0,f.jsxs)(fe.Z,{styleKey:fe.v.White,isMobile:!0,style:{justifyContent:"unset"},children:[(0,f.jsx)(Oe.Z,{store:this.props.store,isMobile:!0,lockStore:n},this.props.store.id),e.isRestricted()&&(0,f.jsxs)(f.Fragment,{children:[s&&(0,f.jsx)(xe.Z,{vertical:!0,size:10,style:{height:"50%"}}),(0,f.jsx)(ze.Z,{style:{marginRight:8},onClick:()=>ee.lG(this.environment)})]})]}),this.props.isOffline&&(0,f.jsx)(fe.Z,{styleKey:fe.v.White,isMobile:!0,children:(0,f.jsxs)("div",{style:{display:"flex",alignItems:"center",width:"100%",paddingLeft:t.getSafePaddingLeftCSS(10),paddingRight:t.getSafePaddingRightCSS(14)},children:[S({width:26,marginRight:12}),(0,f.jsx)("div",{children:(0,f.jsx)(T.FormattedMessage,{defaultMessage:"You're offline",id:"topbarMobile.offline.message"})})]})}),(0,f.jsx)(Y.LazyBannersRenderer,{banners:this.props.banners,isMobile:!0,isInPeekRenderer:!1})]})})}}Qe.displayName="TopbarMobile";const Je=(0,T.injectIntl)(Qe);function Xe(){window.__c={n:"PageUpdatesPopupOrigin"};const e={menuType:q.og.Modal,title:(0,f.jsx)(T.FormattedMessage,{defaultMessage:"Page Updates",id:"pageUpdatesModal.mobileMenu.title"}),right:(0,f.jsx)(ke.DoneMenuText,{}),onClickRight:()=>me.Z.setState({open:!1}),whiteBackground:!0},t=(0,a.VK)((()=>me.Z.state.open),[]);return(0,f.jsx)(Ae.ZP,{open:t,popupType:ve.Z4.SlideUp,alignmentToOrigin:se.v.Start,placementToOrigin:se.u.Right,onDismiss:()=>me.Z.setState({open:!1}),originGap:0,isWideTabletWidth:!0,render:()=>(0,f.jsx)(Ce.Z,{...e,children:(0,f.jsx)(Ve,{})}),isFullWidthOnMobile:!0,preventScaleTransition:!0})}function et(e){const t=e.getParentStore(),{currentSpaceStore:i}=ae.default.state;return t instanceof pe.H2&&i&&t.id===i.id}function tt(e){let{store:t,spaceViewStore:i,isInvalidPage:o}=e;return o||!i?null:(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(Ke.Z,{store:t,spaceViewStore:i}),(0,f.jsx)(J.Z,{})]})}function it(e){let{store:t,collectionViewStore:i}=e;return(0,f.jsx)(Ge.Z,{store:t,collectionViewStore:i,buttonPopupStore:be.Z})}function ot(e){let{store:t}=e;return(0,f.jsx)($e.Z,{store:t,buttonPopupStore:ge.Z})}function nt(e){return(0,re.Y)("supportsNativeHome")&&e.device.isTablet}function st(e){const{TabbedRouterStore:t}=e,i=(0,z.NW)(e)||"native"===(0,c.w_)(t.state).type;return!(0,z.__)(e)||i}function rt(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=arguments.length>2?arguments[2]:void 0;const{mobileNative:o}=e;return{flexGrow:0,marginLeft:null!=o&&o.supportsNativeHomeOnPhone()?t?0:20:2,overflow:"auto",WebkitOverflowScrolling:"touch",marginRight:i?16:8,height:"100%"}}function at(){window.__c={n:"HamburgerButton"};const e=(0,r.O7)(),t=(0,a.VK)((()=>(0,ie.Jr)(e)&&oe.sidebarExpandedStore.state),[e]);return(0,f.jsxs)(ye.Z,{mobileFeedback:!0,style:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,height:"100%",width:36,marginLeft:4},onClick:()=>{var t;if(nt(e))null===(t=e.mobileNative)||void 0===t||t.toggleNativeHome();else if((0,ie.Jr)(e))te.setExpand({environment:e,isExpanded:!oe.sidebarExpandedStore.state,from:"topbar_mobile"});else{const{NativeMobileActionBarStore:t}=e,i=t?t.state.menuType:null;"editing"===he.default.state.mode||null!==i?(N.ZH(e),null==t||t.clear(!1),de.Z.onHide((()=>{s.default.afterNextFlush((()=>te.open({fromElectron:!1})))}))):te.open({fromElectron:!1})}w.jD(e)},children:[(0,h._)({width:18,height:18}),t?(0,f.jsx)(Pe.Z,{color:Pe.N.Red,style:{position:"absolute",top:9,right:1},count:0}):(0,f.jsx)(Ne.Z,{type:e.device.isMobileBrowser?"allSpaces":"otherSpaces",color:Pe.N.Red,style:{position:"absolute",top:9,right:1}})]})}function lt(e,t,i){const{WindowSizeStore:o}=t;return{display:"flex",justifyContent:"space-between",alignItems:"center",width:"100%",maxWidth:"100vw",height:d.g,marginTop:o.state.paddingTopCSS,paddingLeft:o.getSafePaddingLeftCSS(0),paddingRight:e?o.getSafePaddingRightCSS(0):o.getSafePaddingRightCSS(7),boxShadow:`0 1px 0 ${i.regularDividerColor}`,background:i.contentBackground,transition:"box-shadow 300ms",WebkitUserSelect:"none",cursor:"pointer"}}function ct(){window.__c={n:"ChevronComponent"};const e=(0,l.Fg)();return(0,p.i)({marginLeft:4,width:10,fill:e.lightTextColor})}function dt(e){Z.ZH(e)}async function ut(e,t,i){await B.$X({environment:i,blocks:[e],moveToContext:"quick_add",onAccept:e=>function(e,t,i){const{currentSpaceStore:o}=ae.default.state;o&&t&&(0,W.rq)({currentUserId:i.currentUser.id,spaceId:o.id,value:e}),w.xx(i)}(e,t,i),isAddTo:!0,isDefaultPrivateLocation:et(e)})}function mt(e){let{store:t,shouldShowAddTo:i}=e;window.__c={n:"PublicPageTopbarComponent"};const n=(0,l.Fg)(),s=(0,r.O7)(),c=Boolean(s.currentUser.isLoggedIn()||s.publicDomainUserId),d=(0,a.VK)((()=>s.device.isTablet),[s]),m=(0,a.VK)((()=>lt(i,s,n)),[s,i,n]),p=(0,a.VK)((()=>rt(s,!0,d)),[s,d]);return(0,f.jsxs)("div",{onClick:()=>dt(s),style:m,className:K.ZHw,children:[s.currentUser.isLoggedIn()&&(0,f.jsxs)(o.Fragment,{children:[(0,f.jsx)(ye.Z,{style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:14,paddingRight:14,fontWeight:C.Z.fontWeight.medium,color:n.regularTextColor,whiteSpace:"nowrap"},mobileFeedback:!0,onClick:()=>function(e){const{currentUserRootStore:t,currentUserSettingsStore:i}=ae.default.state;t&&i&&V.L5({environment:e,userRootStore:t,userSettingsStore:i,pageVisitSource:u.tY.SwitchSpace})}(s),children:(0,f.jsx)(T.FormattedMessage,{defaultMessage:"Back",id:"topbarMobile.backButton.label"})}),(0,f.jsx)("div",{style:{height:18,width:1,flexShrink:0,marginRight:6,background:n.darkDividerColor}})]}),(0,f.jsx)(D.l2,{store:t,style:p,maxAncestorCount:1,showCurrentPageControls:!1,ancestorMaxWidth:100,currentPageMaxWidth:220,isMobile:!0}),(0,f.jsx)("div",{style:{flexGrow:1,flexShrink:1}}),(0,f.jsx)(Te.Z,{onClick:()=>function(e){R.UT({environment:e,analyticsFrom:"public-page-topbar"})}(s),children:(0,v.R)({width:20,height:20})}),(0,f.jsx)(Fe.Z,{store:t,buttonPopupStore:be.Z,useEllipsisIcon:!c}),!c&&(0,f.jsx)(Le.C,{onClick:()=>async function(e){await(0,qe.i3)({environment:e,route:x._j.signup})}(s)})]})}function pt(e){let{store:t,saveParent:i}=e;window.__c={n:"AddToComponent"};const o=(0,l.Fg)(),n=(0,r.O7)(),s=(0,a.VK)((()=>t.getParentStore()),[t]),c=(0,a.VK)((()=>et(t)),[t]),d=(0,a.VK)((()=>t instanceof pe.H2?(0,$.Wd)(n,t):t.getIcon()),[t,n]),u=(0,a.VK)((()=>(null==s?void 0:s.table)===M.iU&&s.isEmptyPage()),[s]),m=(0,a.VK)((()=>s instanceof pe.H2?(0,$.rn)(n,s):void 0),[n,s]),p=(0,a.VK)((()=>(0,H.B7)(n)),[n]),h=(0,a.VK)((()=>function(e){let t=0;return t=nt(e)?8:st(e)?6:16,{display:"flex",alignItems:"center",paddingLeft:t,paddingRight:12,fontSize:C.Z.fontSize.UIRegular.mobile,lineHeight:C.Z.lineHeight.UIRegular.mobile,whiteSpace:"nowrap",minWidth:0}}(n)),[n]);if(s instanceof pe.T5||s instanceof pe.zq||s instanceof pe.Vf)return null;if(s){if(c){const e=o.mediumTextColor;return(0,f.jsxs)(ye.Z,{mobileFeedback:!0,style:h,onClick:()=>ut(t,i,n),children:[(0,f.jsx)(T.FormattedMessage,{defaultMessage:"<mediumcolor>Add to</mediumcolor>{userAvatar}<mediumweight>Private pages</mediumweight>",id:"topbarMobile.addToPrivateSectionButton.label",values:{mediumcolor:t=>(0,f.jsx)("span",{style:{color:e,marginRight:8},children:t}),mediumweight:e=>(0,f.jsx)("span",{style:{fontWeight:C.Z.fontWeight.medium,marginLeft:4},children:e}),userAvatar:(0,f.jsx)(Be.Z,{size:22,avatarShouldShowShadow:!0,userStore:p})}}),(0,f.jsx)(ct,{})]})}return(0,f.jsxs)(ye.Z,{mobileFeedback:!0,style:h,onClick:()=>ut(t,i,n),children:[(0,f.jsxs)("span",{style:{color:o.mediumTextColor},children:[(0,f.jsx)(T.FormattedMessage,{defaultMessage:"Add to",id:"topbarMobile.addToPageOrWorkspaceSectionButton.label"})," "]}),(0,f.jsx)(we.Z,{disabled:!0,icon:d,isEmptyPage:u,title:m,size:24,style:{marginLeft:8,marginRight:4}}),(0,f.jsx)(Ie.Z,{style:{fontWeight:C.Z.fontWeight.semibold},store:s}),(0,f.jsx)(ct,{})]})}return null}function ht(){window.__c={n:"CancelQuickAddComponent"};const e=(0,r.O7)();return(0,f.jsx)(ye.Z,{mobileFeedback:!0,style:{display:"flex",alignItems:"center",height:"100%",paddingLeft:16,paddingRight:16,fontWeight:C.Z.fontWeight.medium,color:m.ZP.blue},onClick:t=>function(e,t){const i=ae.default.state.mainEditorCurrentBlockStore,o=ue.ZP.state.lastPageId;if(i){var n;const e=null===(n=t.mobileNative)||void 0===n?void 0:n.supportsNativeHomeOnPhone();e?j.d(t):o?P._({environment:t,store:pe.G.createChildStore(i,{table:M.iU,id:o}),showMoveTo:!1,saveParent:!1,redirect:e,pageVisitSource:u.tY.BackForward}):_.c4({environment:t,url:x._j.root,redirect:!0}),O.createAndCommit({userAction:"TopbarMobile.handleCancelQuickAdd",environment:t,perform:e=>{F.y8({environment:t,blocks:[i],transaction:e}),e.postSubmitCallbacks.push((e=>{e||A.dh(t,{analyticsName:"delete",from:"mobile_topbar",block_id:i.id,block_type:"page"})}))}})}}(0,e),children:(0,f.jsx)(T.FormattedMessage,{defaultMessage:"Cancel",id:"topbarMobile.cancelQuickAddButton.label"})})}function bt(e){let{intl:t}=e;return(0,f.jsx)(ve.ZP,{popupType:ve.Z4.SlideUp,originGap:0,stopClickPropagation:!0,isWideTabletWidth:!0,render:e=>(0,f.jsx)(Ce.Z,{menuType:q.og.Modal,scrollerStyle:{paddingBottom:0},title:(0,f.jsx)(T.FormattedMessage,{defaultMessage:"Details",id:"topbarMobile.header.info"}),right:(0,f.jsx)(ke.DoneMenuText,{}),onClickRight:e.close}),isFullWidthOnMobile:!0,preventScaleTransition:!0,renderOrigin:e=>(0,f.jsx)("div",{style:{position:"relative",height:"100%"},children:(0,f.jsx)(Me.Z,{ariaLabel:t.formatMessage({defaultMessage:"Info",id:"topbarMobile.infoButton.label"}),icon:b.D,iconStyle:{width:26,height:26,fill:"inherit"},isDarkIconColor:!0,style:{marginLeft:6,marginRight:6,height:"100%"},mobileFeedback:!0,...e})})})}function gt(e){let{showingHistoryButtons:t=!0,shouldShowAddTo:i,store:o,saveParent:n}=e;window.__c={n:"BreadcrumbsComponent"};const s=(0,r.O7)(),l=(0,a.VK)((()=>s.device.isTablet),[s]),c=(0,a.VK)((()=>rt(s,t,l)),[s,l,t]);return i?(0,f.jsx)(pt,{store:o,saveParent:n}):(0,f.jsx)(D.l2,{store:o,style:c,maxAncestorCount:l?2:1,showCurrentPageControls:!1,ancestorMaxWidth:l?160:100,currentPageMaxWidth:l?240:220,isMobile:!0})}function ft(e){let{hasUnreadCommentsStore:t}=e;return(0,f.jsx)(ve.ZP,{buttonPopupStore:ne.Z,popupType:ve.Z4.SlideUp,alignmentToOrigin:se.v.Start,placementToOrigin:se.u.Right,originGap:0,stopClickPropagation:!0,isWideTabletWidth:!0,render:e=>(0,f.jsx)(Ce.Z,{menuType:q.og.Modal,scrollerStyle:{paddingBottom:0},title:(0,f.jsx)(T.FormattedMessage,{defaultMessage:"Comments",id:"topbarMobile.commentsMenu.title"}),right:(0,f.jsx)(ke.DoneMenuText,{}),onClickRight:e.close,children:(0,f.jsx)(De.J,{timeMounted:Date.now(),location:"popup"})}),isFullWidthOnMobile:!0,preventScaleTransition:!0,renderOrigin:e=>(0,f.jsxs)("div",{style:{position:"relative",height:"100%"},children:[(0,f.jsx)(Me.Z,{icon:y,iconStyle:{width:26,height:26,fill:"inherit"},isDarkIconColor:!0,style:{marginLeft:6,marginRight:6,height:"100%"},mobileFeedback:!0,...e}),t.state&&(0,f.jsx)("div",{style:{position:"absolute",top:9,right:5,height:8,width:8,borderRadius:4,background:m.ZP.red}})]})})}function St(e){let{store:t,spaceStore:i,isInvalidPage:n,collectionViewStore:s,hasUnreadCommentsStore:l}=e;window.__c={n:"RightButtonsComponent"};const c=(0,r.O7)(),d=(0,T.useIntl)(),u=(0,a.VK)((()=>Boolean(i&&!i.canEdit())),[i]),m=(0,a.VK)((()=>t.canEdit()),[t]),p=(0,Ee.UP)({isSpaceGuest:u,canEditPage:m}),h=(0,a.VK)((()=>(0,Ee.W2)({canEditPage:m,device:c.device})),[c,m]),b=(0,a.VK)((()=>le.default.checkGate("show_topbar_layout_info_button")),[]);return n?null:(0,f.jsxs)(o.Fragment,{children:[(0,f.jsx)(Xe,{}),p&&(0,f.jsx)(ot,{store:t}),(0,f.jsx)(ft,{hasUnreadCommentsStore:l}),b&&(0,f.jsx)(bt,{intl:d}),h&&(0,f.jsx)(Ye.l,{onClick:()=>function(e){me.Z.setState({open:!0}),I.gM(e)}(c)}),(0,f.jsx)(it,{store:t,collectionViewStore:s})]})}function yt(e){let{store:t,pageVisitStore:i,presenceStore:o,hideActionButtons:n,isInvalidPage:s,spaceStore:c,collectionViewStore:d,shouldShowAddTo:u,spaceViewStore:m,saveParent:p,hasUnreadCommentsStore:h,isMyTasksStore:b}=e;window.__c={n:"NormalTopbarComponent"};const g=(0,l.Fg)(),S=(0,r.O7)(),{isTablet:y}=(0,r.Fy)(),v=(0,a.VK)((()=>st(S)),[S]),x=(0,a.VK)((()=>(0,X.WE)(t)),[t]),M=(0,a.VK)((()=>t.canEditCollection()),[t]),C=(0,a.VK)((()=>t.isRestricted()),[t]),k=(0,a.VK)((()=>t.canEdit()),[t]),T=(0,a.VK)((()=>b.state),[b]),A=(0,a.VK)((()=>function(e,t){return e&&function(e){return e.isEmptyTitle()&&e.isEmptyPage()}(t)}(u,t)),[u,t]);let w=(0,f.jsx)(St,{store:t,spaceStore:c,isInvalidPage:s,collectionViewStore:d,hasUnreadCommentsStore:h});A?w=(0,f.jsx)(ht,{}):T&&(w=(0,f.jsx)(tt,{store:t,spaceViewStore:m,isInvalidPage:s}));const I=x?(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(Se.Z,{style:{background:g.home.betaBadge.background,color:g.home.betaBadge.color}}),(0,f.jsx)(Q.E,{store:t,isInvalidPage:Boolean(s)})]}):(0,f.jsxs)(f.Fragment,{children:[C&&y&&(0,f.jsx)(ze.Z,{style:{marginRight:8},onClick:()=>ee.lG(S)}),y&&k&&i&&o&&(0,f.jsx)(We.Z,{rootStore:t,pageVisitStore:i,presenceStore:o}),w]}),B=(0,a.VK)((()=>lt(u,S,g)),[S,u,g]),P=(0,a.VK)((()=>function(e){return nt(e)||!(0,re.Y)("supportsNativeHome")}(S)),[S]);return(0,f.jsxs)("div",{onClick:()=>dt(S),style:B,className:K.ZHw,children:[P&&(0,f.jsx)(at,{}),v&&(0,f.jsx)(Ue.Z,{supportsNativeHomeTabPhone:!y&&(0,re.Y)("supportsNativeHome")}),!s&&(0,f.jsx)(gt,{shouldShowAddTo:u,store:t,saveParent:p,showingHistoryButtons:v}),M&&y&&(0,f.jsx)(Oe.Z,{store:t,isMobile:!1},t.id),(0,f.jsx)(He.Z,{}),!n&&I]})}},30439:(e,t,i)=>{i.r(t),i.d(t,{TopLevelMobileComponents:()=>f});i(67294);var o=i(480),n=i(86628),s=i(30664),r=i(20423),a=i(61671),l=i(95464),c=i(23586),d=i(43250),u=i(71119),m=i(75538),p=i(27177),h=i(80444),b=i(72087),g=i(85893);function f(){window.__c={n:"TopLevelMobileComponents"};const e=(0,o.O7)(),t=(0,n.qz)(void 0,b.Z),i=(0,n.VK)((()=>{const e=m.default.state;return e.isOnboarding&&"workspace_setup"===e.stage}),[]),f=(0,n.VK)((()=>h.default.state.currentSpaceStore),[]),S=(0,n.VK)((()=>h.default.state.mainEditorCurrentBlockStore),[]),y=(0,n.VK)((()=>f&&f.canEdit()),[f]);return i?(0,g.jsx)(g.Fragment,{}):(0,g.jsxs)("div",{className:d.alX,children:[(0,g.jsx)(p.Z,{createType:"add-account"}),f&&(0,g.jsx)(r.Z,{store:f}),(0,g.jsx)(c.Z,{request:{},render:()=>null,requestStore:t,performRequest:()=>(0,u.pu)(e)}),(0,g.jsx)(a.Z,{passwordRequestStore:t}),y&&S&&(0,g.jsx)(l.Z,{store:S,isMobile:!0}),(0,g.jsx)(s.Z,{})]})}},67940:(e,t,i)=>{i.d(t,{Z:()=>r});var o=i(49085),n=i(4615);class s extends o.default{getInitialState(){return{flowId:void 0}}getOrCreateFlowId(){const e=this.state.flowId||(0,n.ZP)();return this.state.flowId&&this.setState({flowId:e}),e}}const r=new s},53610:(e,t,i)=>{i.d(t,{Z:()=>o});const o=new(i(61766).Z)},66881:(e,t,i)=>{i.d(t,{g:()=>o});const o=i(49085).default.createValue({shouldReset:!1})},44295:(e,t,i)=>{i.d(t,{I:()=>s});i(67294);var o=i(45238),n=i(85893);const s=(0,o.I)("random",{viewBox:"0 0 14 14",svg:(0,n.jsx)("path",{d:"M9.45002,6.2999567 C8.87013,6.2999567 8.40002,5.8298565 8.40002,5.24995625 C8.40002,4.670056 8.87013,4.1999558 9.45002,4.1999558 C10.0299,4.1999558 10.5,4.670056 10.5,5.24995625 C10.5,5.8298565 10.0299,6.2999567 9.45002,6.2999567 Z M4.55,6.2999567 C3.9701,6.2999567 3.5,5.8298565 3.5,5.24995625 C3.5,4.670056 3.9701,4.1999558 4.55,4.1999558 C5.1299,4.1999558 5.6,4.670056 5.6,5.24995625 C5.6,5.8298565 5.1299,6.2999567 4.55,6.2999567 Z M6.993,0 C10.864,0 14,3.13600534 14,7.000007 C14,10.8639987 10.864,14 6.993,14 C3.129,14 0,10.8639987 0,7.000007 C0,3.13600534 3.129,0 6.993,0 Z M7,12.5999994 C10.094,12.5999994 12.6,10.0939983 12.6,7.000007 C12.6,3.90600567 10.094,1.4000046 7,1.4000046 C3.906,1.4000046 1.4,3.90600567 1.4,7.000007 C1.4,10.0939983 3.906,12.5999994 7,12.5999994 Z M7,10.8499986 C5.369,10.8499986 3.976,9.83499821 3.416,8.4000076 L4.585,8.4000076 C5.075,9.23299796 5.964,9.7999982 7,9.7999982 C8.036,9.7999982 8.932,9.23299796 9.415,8.4000076 L10.584,8.4000076 C10.024,9.83499821 8.631,10.8499986 7,10.8499986 Z"})})},73426:(e,t,i)=>{i.d(t,{i:()=>s});i(67294);var o=i(45238),n=i(85893);const s=(0,o.I)("templatesColor",{viewBox:"0 0 20 20",svg:(0,n.jsxs)("g",{children:[(0,n.jsx)("path",{d:"M6.39733 5.67853C5.89764 5.50234 5.36002 5.40649 4.8 5.40649C2.14904 5.40649 0 7.55432 0 10.2038C0 12.8533 2.14904 15.0011 4.8 15.0011C6.52165 15.0011 8.0316 14.0952 8.87867 12.7343L5.26487 12.0975L6.39733 5.67853Z",fill:"#3C9ED7"}),(0,n.jsx)("path",{d:"M17.3126 3.66609L7.85843 2L6.19141 11.4489L10.6545 12.2354L14.3998 5.81854L16.3449 9.15116L17.3126 3.66609Z",fill:"#E7595E"}),(0,n.jsx)("path",{d:"M8.80078 17L14.4008 7.4054L20.0008 17H8.80078Z",fill:"#F5BC4E"})]})})}}]);