"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[4493],{12347:(e,t,o)=>{o.d(t,{H5:()=>q,Ko:()=>J,ZP:()=>te,bc:()=>N,cE:()=>W,cR:()=>U});o(21703);var r=o(67294),i=o(83355),n=o(480),s=o(86628),a=o(49085),l=o(35011),p=o(14714),c=o(56666),u=o(39132),d=o(61061),g=o(37612),y=o(72126),m=o(97880),S=o(9291),h=o(36610),C=o(8406),x=o(54569),f=o(5149),v=o(96802),b=o(82530),w=o(26055),B=o(75498),M=o(52275),F=o(79131),G=o(5145),j=o(73063),_=o(68785),T=o(28992),K=o(89728),k=o(72495),V=o(86825),A=o(97820),Z=o(92918),H=o(18514),L=o(58421),R=o(73590),D=o(97372),O=o(94166),z=o(18533),P=o(85893);class I extends i.Z{constructor(){super(...arguments),this.storeTypes={reducerResultStore:a.default.createClass(void 0),groupsLimit:a.default.createClass(Z.XD)},this.handleHideEmptyGroupsClick=()=>{const{groupByKey:e,collectionContextStore:t,groupsFormatKey:o}=this.props,r=re(this.props.collectionContextStore,this.props.groupByKey),i=this.groupsDisplayStateStore.state;if(!i)return;const{currentGroups:n}=i,s=t.collectionViewStore();if(!r||!s)return;const a=!r.hideEmptyGroups;b.createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideEmptyGroupsClick",environment:this.environment,perform:i=>{if(a){const e=n.map((e=>!1===e.hidden?{...e,hidden:void 0}:e));x.A6({collectionContextStore:t,newGroups:e,groupsFormatKey:o,transaction:i})}v.FH({stores:[s],update:{[e]:{...r,hideEmptyGroups:a}},transaction:i})}}),C.wd({environment:this.environment,collectionContextStore:t,action:"toggle_hide_empty_groups"})},this.handleHideAllClick=()=>{const{collectionContextStore:e,groupsFormatKey:t}=this.props,o=this.groupsDisplayStateStore.state;if(!o)return;const{currentGroups:r}=o,i=r.map((e=>({...e,hidden:!0})));this.stores.groupsLimit.setState(Z.XD),b.createAndCommit({userAction:"CollectionSettingsViewGroup.handleHideAllClick",environment:this.environment,perform:o=>{x.A6({collectionContextStore:e,newGroups:i,groupsFormatKey:t,transaction:o})}}),C.wd({environment:this.environment,collectionContextStore:e,action:"click_groups_hide_all"})},this.handleShowAllClick=()=>{const{collectionContextStore:e,groupsFormatKey:t}=this.props,o=this.groupsDisplayStateStore.state;if(!o)return;const{currentGroups:r}=o,i=r.map((e=>({...e,hidden:!1})));this.stores.groupsLimit.setState(Z.XD),b.createAndCommit({userAction:"CollectionSettingsViewGroup.handleShowAllClick",environment:this.environment,perform:o=>{x.A6({collectionContextStore:e,newGroups:i,groupsFormatKey:t,transaction:o})}}),C.wd({environment:this.environment,collectionContextStore:e,action:"click_groups_show_all"})},this.handleGroupReorder=(e,t)=>{const{collectionContextStore:o,groupsFormatKey:r}=this.props,i=this.groupsDisplayStateStore.state;if(!i)return;const{currentGroups:n}=i,s=n.filter((t=>e.indexOf((0,p.mD)(t))<0)),a=n.filter((t=>e.indexOf((0,p.mD)(t))>=0)),l=y.MR(a,(t=>{const o=e.indexOf((0,p.mD)(t));return o>=0?o:1/0})),c=t?[...s,...l]:[...l,...s];b.createAndCommit({userAction:"CollectionSettingsViewGroup.handleGroupReorder",environment:this.environment,perform:e=>{x.A6({collectionContextStore:o,newGroups:c,groupsFormatKey:r,transaction:e})}}),h.wd(this.environment,{view_type:oe(this.props.collectionContextStore),action:t?"reorder_hidden_groups":"reorder_groups"})},this.handleToggleGroupVisibility=e=>{const{collectionContextStore:t,groupsFormatKey:o}=this.props,r=this.groupsDisplayStateStore.state;if(!r)return;const{currentGroups:i}=r,n=i.map((t=>(0,p.ZH)(t,e)?{...e,hidden:!(0,p.eF)(e)}:t));b.createAndCommit({userAction:"CollectionSettingsViewGroup.handleToggleGroupVisibility",environment:this.environment,perform:e=>{x.A6({collectionContextStore:t,newGroups:n,groupsFormatKey:o,transaction:e})}}),C.wd({environment:this.environment,collectionContextStore:t,action:"toggle_group_visibility"})},this.reducerStore=this.createComputedStore((()=>{const{collectionContextStore:e,groupsFormatKey:t}=this.props,o=e.normalizedFormatStore.state,r=e.normalizedSchemaStore.state,i=e.remoteRequestStore.state,n=re(this.props.collectionContextStore,this.props.groupByKey);if(n)return(0,Z.ej)({groupBy:n,schema:r,format:o,filter:null==i?void 0:i.loader.filter,groupsFormatKey:t,limit:this.stores.groupsLimit.state})})),this.schemaGroupsStore=this.createComputedStore((()=>{const{collectionContextStore:e}=this.props,t=e.normalizedSchemaStore.state,o=re(this.props.collectionContextStore,this.props.groupByKey);if(o)return(0,p.Qq)({schema:t,groupBy:o})}),!0),this.groupsDisplayStateStore=this.createComputedStore((()=>{var e;const{groupsFormatKey:t,collectionContextStore:o}=this.props,r=o.normalizedFormatStore.state,i=o.normalizedSchemaStore.state,n=o.collectionViewBlockStore(),s=re(this.props.collectionContextStore,this.props.groupByKey),a=this.stores.reducerResultStore.state;if(!s||!n||!a)return;const l=this.stores.groupsLimit.state,c=this.schemaGroupsStore.state,u=a.results,d=a?a.total:0,g=(0,Z.Cz)({groupBy:s,schema:i,formatGroups:r[t]||[],schemaGroups:c,reducerResults:u,getRecordModel:n.getRecordModel,relativeVariableResult:o.relativeVariableStore.state,viewAppConfigUri:null===(e=o.collectionViewStore())||void 0===e?void 0:e.getFormat().app_config_uri}),y=g.filter((e=>!(0,p.eF)(e))).slice(0,l),m=g.filter((e=>(0,p.eF)(e)));return{currentGroups:[...y,...m],visibleGroups:y,hiddenGroups:m,total:d}}),!0)}renderComponent(){const{collectionContextStore:e,groupByKey:t}=this.props,o=re(this.props.collectionContextStore,this.props.groupByKey),r=e.normalizedSchemaStore.state;return(0,P.jsxs)(D.ZP,{...this.props,title:(0,P.jsx)(se,{collectionSettingsStore:this.props.collectionSettingsStore,collectionContextStore:this.props.collectionContextStore}),children:[(0,P.jsxs)(k.Z,{children:[(0,P.jsx)(ae,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore,groupByKey:this.props.groupByKey,groupsFormatKey:this.props.groupsFormatKey,groupBy:o}),o&&Q({groupBy:o,schema:r})&&(0,P.jsx)(pe,{collectionContextStore:this.props.collectionContextStore,collectionSettingsStore:this.props.collectionSettingsStore,groupByKey:this.props.groupByKey,groupsFormatKey:this.props.groupsFormatKey,groupBy:o}),o&&(0,P.jsx)(ce,{collectionContextStore:this.props.collectionContextStore,groupByKey:this.props.groupByKey,groupBy:o}),o&&this.renderAutoHideButton(o),o&&"board_columns_by"===t&&(0,P.jsx)(le,{collectionContextStore:this.props.collectionContextStore})]}),o&&this.renderGroupSortListReducer(),(0,P.jsxs)(k.Z,{topBorder:!0,children:[o&&ne(this.props.collectionContextStore,this.props.groupByKey)&&(0,P.jsx)(O.Z,{isGray:!0,icon:g.y,title:(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Remove grouping",id:"database.viewSettings.groupTab.removeButton.title"}),onClick:()=>function(e,t,o,r){const i=t.collectionViewStore();if(!i)return;b.createAndCommit({userAction:"CollectionSettingsViewGroup.handleRemoveClick",environment:e,perform:e=>{v.FH({stores:[i],update:{[o]:void 0,[r]:void 0},transaction:e})}}),C.wd({environment:e,collectionContextStore:t,action:"click_remove_grouping"})}(this.environment,this.props.collectionContextStore,this.props.groupByKey,this.props.groupsFormatKey),isRed:!0}),(0,P.jsx)(R.Z,{href:(0,H.UY)("guides.databaseGroup"),title:(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Learn about grouping",id:"database.viewSettings.groupTab.learnMoreButton.title"}),analyticsFrom:"view_settings_group"})]})]})}renderAutoHideButton(e){return(0,P.jsx)(V.Z,{title:(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Hide empty groups",id:"database.viewSettings.groupTab.hideEmptyGroups"}),on:Boolean(e.hideEmptyGroups),focused:!1,onClick:this.handleHideEmptyGroupsClick,disabled:!ie(this.props.collectionContextStore),textWrapperStyle:{opacity:1}})}renderGroupSortListReducer(){const{groupsFormatKey:e}=this.props,t=this.reducerStore.state,o=this.groupsDisplayStateStore.state;return t?(0,P.jsx)(B.Z,{id:`group_menu_${e}`,reducer:t,collectionContextStore:this.props.collectionContextStore,resultStore:this.stores.reducerResultStore,render:()=>this.renderGroupSortListSections(o)}):this.renderGroupSortListSections(o)}renderGroupSortListSections(e){const t=re(this.props.collectionContextStore,this.props.groupByKey);if(!t)return;if(!e)return(0,P.jsx)(k.Z,{topBorder:!0,disableMobileBorders:!0,noTextOverflow:!0,children:(0,P.jsx)("div",{style:{marginTop:6,display:"flex",alignItems:"center",flexDirection:"column"},children:(0,P.jsx)(_.Z,{})})});const o="manual"===(0,p.mu)(t).type&&!this.environment.device.isMobile&&ie(this.props.collectionContextStore),r=this.stores.groupsLimit.state,{total:i,hiddenGroups:n,visibleGroups:s}=e,a=Math.min(Z.kW,i-n.length-s.length),l=a>0?(0,P.jsx)(M.Z,{disabled:!1,focused:!1,style:{color:this.theme.mediumTextColor},icon:(0,c.o)({width:14,height:14}),title:(0,P.jsx)(S.FormattedMessage,{id:"database.groupMenu.loadMoreButton.text",defaultMessage:"Show {loadMoreAmount, plural, one {{loadMoreAmount} more group} other {{loadMoreAmount} more groups}}",values:{loadMoreAmount:a}}),onClick:()=>{this.props.collectionContextStore.isLoading.state||this.props.collectionContextStore.loadingDetails.setState({type:"load_groups_menu"}),this.stores.groupsLimit.setState(r+Z.kW)}}):void 0;return(0,P.jsxs)(P.Fragment,{children:[e.visibleGroups.length>0&&(0,P.jsxs)(k.Z,{topBorder:!0,noTextOverflow:!0,isTitleUppercase:!1,title:(0,P.jsx)("span",{style:{alignSelf:"center"},children:(0,P.jsx)(S.FormattedMessage,{id:"database.groupMenu.visibleGroups",defaultMessage:"Visible groups"})}),right:(0,P.jsx)(K.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:this.handleHideAllClick,disabled:!ie(this.props.collectionContextStore),children:(0,P.jsx)(S.FormattedMessage,{id:"database.groupMenu.hideAllGroups",defaultMessage:"Hide all"})}),children:[this.renderGroupSortList({displayState:e,groups:e.visibleGroups,canReorder:o,isHidden:!1}),l]}),e.hiddenGroups.length>0&&(0,P.jsx)(k.Z,{topBorder:!1,noTextOverflow:!0,isTitleUppercase:!1,title:(0,P.jsx)(S.FormattedMessage,{id:"database.groupMenu.hiddenGroups",defaultMessage:"Hidden groups"}),right:(0,P.jsx)(K.Z,{isSmall:!0,shouldShrink:!0,isBlue:!0,style:{fontSize:12,height:void 0,paddingTop:2,paddingBottom:2},onClick:this.handleShowAllClick,disabled:!ie(this.props.collectionContextStore),children:(0,P.jsx)(S.FormattedMessage,{id:"database.groupMenu.showAllGroups",defaultMessage:"Show all"})}),children:this.renderGroupSortList({displayState:e,groups:e.hiddenGroups,canReorder:o,isHidden:!0})})]})}renderGroupSortList(e){const{displayState:t,groups:o,canReorder:i,isHidden:n}=e;return i?(0,P.jsx)(F.ZP,{direction:"vertical",keys:o.map((e=>(0,p.mD)(e))),renderKey:(e,r)=>{const n=o[r];return this.renderGroupSortListItem({displayState:t,groupFormat:n,canReorder:i})},onDrop:e=>{this.handleGroupReorder(e,n)},disabled:!ie(this.props.collectionContextStore)}):o.map((e=>(0,P.jsx)(r.Fragment,{children:this.renderGroupSortListItem({displayState:t,groupFormat:e,canReorder:i})},(0,p.mD)(e))))}renderGroupSortListItem(e){const{collectionContextStore:t}=this.props,{displayState:o,groupFormat:r,canReorder:i}=e,n=t.normalizedSchemaStore.state,s=(0,p.eF)(r),a=re(this.props.collectionContextStore,this.props.groupByKey);if(a)return(0,P.jsx)(T.Z,{disabled:!ie(this.props.collectionContextStore),title:(0,P.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[i&&(0,P.jsx)(G.ZP,{iconSize:12,style:{marginRight:3}}),(0,P.jsx)(w.Z,{groupBy:a,groupFormat:r,currentGroups:o.currentGroups,schema:n,disabled:!0,isHiddenGroup:!1,style:{padding:0},collectionContextStore:t})]}),right:(0,P.jsx)(j.Z,{icon:s?d.B:u.c,iconStyle:{width:16,height:16},isDarkIconColor:!s,onClick:()=>{this.handleToggleGroupVisibility(r)},disabled:!ie(this.props.collectionContextStore)}),textWrapperStyle:{opacity:1}})}}function N(e){return e?(0,P.jsx)(A.Z,{propertySchema:e,showIcon:!1}):(0,P.jsx)(S.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.groupTab.noGroupingSetMessage"})}function W(e,t){return"collection_group_by"===e&&"board"===t?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Sub-group by",id:"database.viewSettings.groupTab.subGroupProperty"}):(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Group by",id:"database.viewSettings.groupTab.groupProperty"})}function E(e,t){return"manual"===t?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Manual",id:"database.viewSettings.groupTab.sortType.manual"}):"ascending"===t?(0,p.ib)(e)||"formula"===e.type&&"date"===e.groupBy.type?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Oldest first",id:"database.viewSettings.groupTab.sortType.chronological"}):(0,p.aB)(e)||"relation"===e.type||"select"===e.type||"multi_select"===e.type||"formula"===e.type&&"text"===e.groupBy.type?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Alphabetical",id:"database.viewSettings.groupTab.sortType.alphabetical"}):(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Ascending",id:"database.viewSettings.groupTab.sortType.ascending"}):"descending"===t?(0,p.ib)(e)||"formula"===e.type&&"date"===e.groupBy.type?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Newest first",id:"database.viewSettings.groupTab.sortType.reverseChronological"}):(0,p.aB)(e)||"relation"===e.type||"select"===e.type||"multi_select"===e.type||"formula"===e.type&&"text"===e.groupBy.type?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Reverse alphabetical",id:"database.viewSettings.groupTab.sortType.reverseAlphabetical"}):(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Descending",id:"database.viewSettings.groupTab.sortType.descending"}):void(0,m.t1)(t)}function Q(e){const{groupBy:t,schema:o}=e,r=o[t.property];if(!r||!(0,p.LG)(r))return;let i;if("formula"===r.type){const e=(0,l.mm)(r);if("unknown"===e||"array"===e)return;i="block"===e?"relation":e}else i=r.type;return(0,p.A1)(i)||(0,p.HB)(i)||"number"===i||"status"===i?i:void 0}function U(e){const t=Q(e);if(t)return(0,p.A1)(t)?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Date by",id:"database.viewSettings.groupByTypeTab.dateBy"}):(0,p.HB)(t)?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Text by",id:"database.viewSettings.groupByTypeTab.textBy"}):"number"===t?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Number by",id:"database.viewSettings.groupByTypeTab.numberBy"}):"status"===t?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Status by",id:"database.viewSettings.groupByTypeTab.statusBy"}):void 0}function X(e){return(0,p.ib)(e)?e:"formula"===e.type&&"date"===e.groupBy.type?e.groupBy:void 0}function Y(e){return(0,p.aB)(e)?e:"formula"===e.type&&"text"===e.groupBy.type?e.groupBy:void 0}function q(e){return"number"===e.type?e:"formula"===e.type&&"number"===e.groupBy.type?{...e.groupBy,property:e.property}:void 0}function $(e){const{groupBy:t}=e,o=Q(e);if(o)if((0,p.A1)(o)){const e=X(t);if(e)return J(e.groupBy)}else if((0,p.HB)(o)){const e=Y(t);if(e)return ee(e.groupBy)}else if("number"===o){const e=q(t);if(e)return(0,P.jsx)(S.FormattedMessage,{defaultMessage:"{start} to {end}",id:"database.groupMenu.numberGroupBy.range",values:{start:e.start,end:e.end}})}}function J(e){return"relative"===e?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Relative",id:"database.groupMenu.dateGroupBy.relative"}):"day"===e?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Day",id:"database.groupMenu.dateGroupBy.day"}):"week"===e?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Week",id:"database.groupMenu.dateGroupBy.week"}):"month"===e?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Month",id:"database.groupMenu.dateGroupBy.month"}):"year"===e?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Year",id:"database.groupMenu.dateGroupBy.year"}):void(0,m.t1)(e)}function ee(e){return"exact"===e?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Exact",id:"database.groupMenu.textGroupBy.exact"}):"alphabet_prefix"===e?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Alphabetical",id:"database.groupMenu.textGroupBy.alphabetical"}):void(0,m.t1)(e)}I.displayName="CollectionSettingsViewGroup";const te=(0,S.injectIntl)(I);function oe(e){var t;const o=null===(t=e.collectionViewStore())||void 0===t?void 0:t.getType();if(!o)throw new Error("View type was not defined.");return o}function re(e,t){return e.normalizedFormatStore.state[t]}function ie(e){return e.permissionScopes.state.canConfigureBlock}function ne(e,t){return ie(e)&&(0,Z._1)({viewType:oe(e),groupByKey:t})}function se(e){let{collectionSettingsStore:t,collectionContextStore:o}=e;window.__c={n:"Title"};const r=(0,s.VK)((()=>(0,L.n)(t)),[t]),i=(0,s.VK)((()=>oe(o)),[o]);return r&&"group"===r.type?"collection_group_by"===r.groupByKey&&"board"===i?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Sub-group",id:"database.viewSettings.groupTab.subGroup.title"}):(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Group",id:"database.viewSettings.groupTab.group.title"}):null}function ae(e){let{groupBy:t,collectionContextStore:o,collectionSettingsStore:r,groupByKey:i,groupsFormatKey:a}=e;window.__c={n:"PropertyMenuButton"};const l=(0,n.O7)(),p=(0,s.VK)((()=>o.normalizedSchemaStore.state),[o]),c=t?p[t.property]:void 0,u=(0,s.VK)((()=>ie(o)),[o]),d=(0,s.VK)((()=>oe(o)),[o]);return(0,P.jsx)(O.Z,{title:W(i,d),showChevron:!0,right:N(c),onClick:()=>{C.wd({environment:l,collectionContextStore:o,action:"click_group_by_property",original_view_type:void 0,property_type:null==c?void 0:c.type}),f.H4({collectionSettingsStore:r,item:{type:"groupByProperty",groupByKey:i,groupsFormatKey:a}})},disabled:!u})}function le(e){let{collectionContextStore:t}=e;window.__c={n:"ColorColumnsOption"};const o=(0,n.O7)(),r=(0,s.VK)((()=>(0,Z.h6)(o,t)),[o,t]),i=(0,s.VK)((()=>ie(t)),[t]);return(0,P.jsx)(V.Z,{title:(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Color columns",id:"database.viewSettings.groupTab.colorColumns"}),on:!r,focused:!1,onClick:()=>{f.iN({environment:o,collectionContextStore:t})},disabled:!i,textWrapperStyle:{opacity:1}})}function pe(e){let{groupBy:t,collectionContextStore:o,collectionSettingsStore:r,groupByKey:i,groupsFormatKey:a}=e;window.__c={n:"TypeMenuButtonComponent"};const l=(0,n.O7)(),c=(0,s.VK)((()=>o.normalizedSchemaStore.state),[o]),u=(0,s.VK)((()=>ie(o)),[o]),d="formula"===t.type?{...t.groupBy,property:t.property}:t;return(0,p.ib)(d)?(0,P.jsx)(z.Z,{title:U({groupBy:d,schema:c}),popupStyle:{minWidth:190},selectedKey:d.groupBy,options:p.z8.map((e=>({key:e,title:J(e)}))),onChange:e=>function(e,t,o,r,i){const n=re(o,r),s=o.collectionViewStore();if(!n||!s)return;const a=X(n);if(a){if((0,p.ib)(n))b.createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,perform:t=>{v.FH({stores:[s],update:{[r]:{...n,groupBy:e},[i]:void 0},transaction:t})}});else if("formula"===n.type){const o={...y.CE(a,"property"),type:"date",groupBy:e},l={...n,groupBy:o};b.createAndCommit({userAction:"CollectionSettingsViewGroup.handleDateGroupByTypeChange",environment:t,perform:e=>{v.FH({stores:[s],update:{[r]:l,[i]:void 0},transaction:e})}})}C.wd({environment:t,collectionContextStore:o,action:"update_date_group_by"})}}(e,l,o,i,a),disabled:!u}):(0,p.aB)(d)?(0,P.jsx)(z.Z,{title:U({groupBy:d,schema:c}),popupStyle:{minWidth:190},selectedKey:d.groupBy,options:p.Kp.map((e=>({key:e,title:ee(e)}))),onChange:e=>function(e,t,o,r,i){const n=re(o,r),s=o.collectionViewStore();if(!n||!s)return;const a=Y(n);if(a){if((0,p.aB)(n))b.createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,perform:t=>{v.FH({stores:[s],update:{[r]:{...n,groupBy:e},[i]:void 0},transaction:t})}});else if("formula"===n.type){const o={...y.CE(a,"property"),groupBy:e},l={...n,groupBy:o};b.createAndCommit({userAction:"CollectionSettingsViewGroup.handleTextGroupByTypeChange",environment:t,perform:e=>{v.FH({stores:[s],update:{[r]:l,[i]:void 0},transaction:e})}})}C.wd({environment:t,collectionContextStore:o,action:"update_text_group_by"})}}(e,l,o,i,a),disabled:!u}):"number"===d.type?(0,P.jsx)(O.Z,{title:U({groupBy:d,schema:c}),showChevron:!0,right:$({groupBy:d,schema:c}),onClick:()=>{f.H4({collectionSettingsStore:r,item:{type:"groupByNumber",groupByKey:i,groupsFormatKey:a}})},disabled:!u}):"status"===d.type?(0,P.jsx)(z.Z,{title:U({groupBy:d,schema:c}),popupStyle:{minWidth:190},selectedKey:d.groupBy,options:p.vu.map((e=>{return{key:e,title:(t=e,"group"===t?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Group",id:"database.groupMenu.statusGroupBy.group"}):"option"===t?(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Option",id:"database.groupMenu.statusGroupBy.option"}):void(0,m.t1)(t))};var t})),onChange:e=>function(e,t,o,r,i){const n=re(o,r),s=o.collectionViewStore();n&&s&&"status"===(null==n?void 0:n.type)&&(b.createAndCommit({userAction:"CollectionSettingsViewGroup.handleStatusGroupByTypeChange",environment:t,perform:t=>{v.FH({stores:[s],update:{[r]:{...n,groupBy:e},[i]:void 0},transaction:t})}}),C.wd({environment:t,collectionContextStore:o,action:"update_status_group_by"}))}(e,l,o,i,a),disabled:!u}):null}function ce(e){let{groupBy:t,collectionContextStore:o,groupByKey:r}=e;window.__c={n:"SortMenuButtonComponent"};const i=(0,n.O7)(),a=(0,s.VK)((()=>(0,p.YG)(t)),[t]),l=(0,s.VK)((()=>ie(o)),[o]);if(a.length<=1)return null;const c=(0,p.mu)(t);return(0,P.jsx)(z.Z,{title:(0,P.jsx)(S.FormattedMessage,{defaultMessage:"Sort",id:"database.viewSettings.groupTab.sort"}),popupStyle:{minWidth:190},selectedKey:c.type,options:a.map((e=>({key:e,title:E(t,e)}))),onChange:e=>function(e,t,o,r){const i=re(o,r),n=o.collectionViewStore();if(i&&n){if("formula"===i.type){const o={...i,groupBy:{...i.groupBy,sort:{type:e}}};b.createAndCommit({userAction:"CollectionSettingsViewGroup.handleSortTypeChange",environment:t,perform:e=>{v.FH({stores:[n],update:{[r]:o},transaction:e})}})}else b.createAndCommit({userAction:"CollectionSettingsViewGroup.handleSortTypeChange",environment:t,perform:t=>{v.FH({stores:[n],update:{[r]:{...i,sort:{type:e}}},transaction:t})}});C.wd({environment:t,collectionContextStore:o,action:"update_group_sort"})}}(e,i,o,r),disabled:!l})}},26827:(e,t,o)=>{o.d(t,{Z:()=>c});o(67294);var r=o(480),i=o(27714),n=o(9291),s=o(8406),a=o(5149),l=o(94166),p=o(85893);const c=function(e){let{collectionContextStore:t}=e;window.__c={n:"CollectionSettingsViewMainCopyLink"};const o=(0,r.O7)();return(0,p.jsx)(l.Z,{icon:i.N,title:(0,p.jsx)(n.FormattedMessage,{defaultMessage:"Copy link to view",id:"database.viewSettings.mainTab.copyLinkButton.title"}),onClick:()=>function(e,t){const o=t.collectionViewStore();o&&(a.Ol({environment:e,collectionContextStore:t,collectionViewStore:o}),s.wd({environment:e,collectionContextStore:t,action:"click_copy_link",original_view_type:o.getType()}))}(o,t)})}},54405:(e,t,o)=>{o.d(t,{Z:()=>u});o(67294);var r=o(480),i=o(86628),n=o(37612),s=o(9291),a=o(8406),l=o(5149),p=o(94166),c=o(85893);const u=function(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"CollectionSettingsViewMainDelete"};const u=(0,r.O7)(),d=(0,i.VK)((()=>t.collectionViewBlockStore()),[t]),g=(0,i.VK)((()=>t.permissionScopes.state),[t]),y=(0,i.VK)((()=>!g.canConfigureBlock||"collectionTypedView"===t.contextType),[t,g]);return!d||y?null:(0,c.jsx)(p.Z,{icon:n.y,title:(0,c.jsx)(s.FormattedMessage,{defaultMessage:"Delete view",id:"database.viewSettings.mainTab.deleteButton.title"}),isRed:!0,onClick:()=>function(e,t,o){const r=t.collectionViewStore();r&&(l.TT({environment:e,collectionContextStore:t,collectionViewStore:r,collectionSettingsStore:o,from:"view_settings"}),a.wd({environment:e,collectionContextStore:t,action:"click_delete",original_view_type:r.getType()}))}(u,t,o)})}},52120:(e,t,o)=>{o.d(t,{Z:()=>u});o(67294);var r=o(480),i=o(86628),n=o(88437),s=o(9291),a=o(8406),l=o(5149),p=o(94166),c=o(85893);const u=function(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"CollectionSettingsViewMainDuplicate"};const u=(0,r.O7)(),d=(0,s.useIntl)(),g=(0,i.VK)((()=>t.permissionScopes.state),[t]);return(0,i.VK)((()=>!g.canConfigureBlock||"collectionTypedView"===t.contextType),[t,g])?null:(0,c.jsx)(p.Z,{icon:n.a,title:(0,c.jsx)(s.FormattedMessage,{defaultMessage:"Duplicate view",id:"database.viewSettings.mainTab.duplicateButton.title"}),onClick:()=>function(e,t,o,r){const i=t.collectionViewStore();i&&(l.zt({environment:e,collectionContextStore:t,collectionViewStore:i,collectionSettingsStore:o,intl:r}),a.wd({environment:e,collectionContextStore:t,action:"click_duplicate",original_view_type:i.getType()}))}(u,t,o,d)})}},47567:(e,t,o)=>{o.d(t,{Z:()=>u});o(67294);var r=o(480),i=o(86628),n=o(6637),s=o(9291),a=o(8406),l=o(5149),p=o(94166),c=o(85893);const u=function(e){let{collectionContextStore:t,collectionSettingsStore:o}=e;window.__c={n:"CollectionSettingsViewMainFilter"};const u=(0,r.O7)(),d=(0,i.VK)((()=>t.permissionScopes.state),[t]),g=(0,i.VK)((()=>t.currentPropertyFiltersStore.state.length+(t.currentCombinatorFilterStore.state&&d.canConfigureBlock?1:0)),[t,d]);return(0,c.jsx)(p.Z,{icon:n.I,title:(0,c.jsx)(s.FormattedMessage,{defaultMessage:"Filter",id:"database.viewSettings.mainTab.filterButton.title"}),showChevron:!0,right:g>0?(0,c.jsx)(s.FormattedMessage,{defaultMessage:"{numberOfFilters, plural, one {{numberOfFilters} filter} other {{numberOfFilters} filters}}",values:{numberOfFilters:g},id:"database.viewSettings.mainTab.filterButton.filters.title"}):(0,c.jsx)(s.FormattedMessage,{defaultMessage:"None",id:"database.viewSettings.mainTab.filterButton.noFilters.title"}),onClick:()=>{a.wd({environment:u,collectionContextStore:t,action:"click_filters"}),0===g?l.H4({collectionSettingsStore:o,item:{type:"createFilter"}}):l.H4({collectionSettingsStore:o,item:{type:"filters"}})}})}},51741:(e,t,o)=>{o.d(t,{NW:()=>s,Qi:()=>i,Rt:()=>r,wI:()=>n});let r=function(e){return e[e.SelectedPage=0]="SelectedPage",e[e.SearchPage=1]="SearchPage",e[e.NewPage=2]="NewPage",e}({});const i=4,n=32,s=400},1018:(e,t,o)=>{o.d(t,{NW:()=>r.NW,Qi:()=>r.Qi,ev:()=>i.LazyRelationPropertyMenu,pG:()=>i.LazyRelationPropertyMenuOld,wI:()=>r.wI});var r=o(51741),i=o(77907)},6637:(e,t,o)=>{o.d(t,{I:()=>n});o(67294);var r=o(45238),i=o(85893);const n=(0,r.I)("filterCircled",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.667 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM4.41797 6.75879H11.5889C11.9307 6.75879 12.1699 6.54688 12.1699 6.22559C12.1699 5.9043 11.9307 5.68555 11.5889 5.68555H4.41797C4.07617 5.68555 3.84375 5.9043 3.84375 6.22559C3.84375 6.54688 4.07617 6.75879 4.41797 6.75879ZM5.36816 9.02148H10.6455C10.9805 9.02148 11.2197 8.80273 11.2197 8.48145C11.2197 8.16016 10.9805 7.94141 10.6455 7.94141H5.36816C5.02637 7.94141 4.78711 8.16016 4.78711 8.48145C4.78711 8.80273 5.02637 9.02148 5.36816 9.02148ZM6.35254 11.2773H9.6543C9.99609 11.2773 10.2354 11.0654 10.2354 10.7441C10.2354 10.4229 9.99609 10.2041 9.6543 10.2041H6.35254C6.01074 10.2041 5.77148 10.4229 5.77148 10.7441C5.77148 11.0654 6.01074 11.2773 6.35254 11.2773Z"})})},27714:(e,t,o)=>{o.d(t,{N:()=>n});o(67294);var r=o(45238),i=o(85893);const n=(0,r.I)("link",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M7.69922 10.8945L8.73828 9.84863C7.91797 9.77344 7.34375 9.51367 6.91992 9.08984C5.76465 7.93457 5.76465 6.29395 6.91309 5.14551L9.18262 2.87598C10.3379 1.7207 11.9717 1.7207 13.127 2.87598C14.2891 4.04492 14.2822 5.67188 13.1338 6.82031L11.958 7.99609C12.1768 8.49512 12.2451 9.10352 12.1289 9.62988L14.0908 7.6748C15.7725 6 15.7793 3.62109 14.084 1.92578C12.3887 0.223633 10.0098 0.237305 8.33496 1.91211L5.95605 4.29785C4.28125 5.97266 4.26758 8.35156 5.96289 10.0469C6.36621 10.4434 6.90625 10.7441 7.69922 10.8945ZM8.30078 5.13184L7.26855 6.17773C8.08203 6.25293 8.66309 6.51953 9.08008 6.93652C10.2422 8.09863 10.2422 9.73242 9.08691 10.8809L6.81738 13.1504C5.66211 14.3057 4.03516 14.3057 2.87305 13.1504C1.71094 11.9883 1.71777 10.3545 2.87305 9.20605L4.04199 8.03027C3.83008 7.53125 3.75488 6.92969 3.87109 6.39648L1.91602 8.35156C0.234375 10.0264 0.227539 12.4121 1.92285 14.1074C3.61816 15.8027 5.99707 15.7891 7.67188 14.1143L10.0439 11.7354C11.7256 10.0537 11.7324 7.6748 10.0371 5.98633C9.64062 5.58301 9.10059 5.28223 8.30078 5.13184Z"})})}}]);