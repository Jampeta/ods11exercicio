"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[1336],{68500:(e,t,r)=>{r.d(t,{Z:()=>W});r(67294);var o=r(83355),s=r(480),n=r(86628),a=r(66897),i=r(14714),l=r(99036),u=r(75e3),d=r(72126),p=r(4615),c=r(96367),h=r(21202),g=r(6287),m=r(97880),y=r(82990),f=r(9291),S=r(47307),x=r(66890),v=r(23586),C=r(92658),b=r(87279),M=r(77907),_=r(75822),j=r(77556),R=r(29798),Z=r(79797),w=r(42922),N=r(52275),V=r(36488),I=r(74194),P=r(68894),O=r(78140),T=r(32163),G=r(43765),F=r(11470),E=r(72495),k=r(86765),L=r(97680),D=r(85893);class B extends o.Z{constructor(){super(...arguments),this.storeTypes={inputStore:C.Z,menuListStore:R.Z,collectionContextStore:j.Z},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleTextInputChange=e=>function(e,t,r){t.setState({...t.state,inputValue:e.target.value}),r.setState({...r.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}(e,this.stores.inputStore,this.stores.menuListStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleTextInputKeydown=e=>function(e,t,r,o,s,n,a){13===e.keyCode?q(t,r,o,s,n,a):27===e.keyCode&&(null==a||a())}(e,this.props.onChange,this.props.currentGroups,this.props.groupBy,this.props.groupFormat,this.stores.inputStore,this.props.onClose),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMenuClickRight=()=>{return e=this.props.onChange,t=this.props.currentGroups,r=this.props.groupBy,o=this.props.groupFormat,s=this.stores.inputStore,n=this.props.onClose,void q(e,t,r,o,s,n);var e,t,r,o,s,n},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleClickSubmitButton=()=>{return e=this.props.onChange,t=this.props.currentGroups,r=this.props.groupBy,o=this.props.groupFormat,s=this.stores.inputStore,n=this.props.onClose,void q(e,t,r,o,s,n);var e,t,r,o,s,n}}UNSAFE_willMount(e){var t;super.UNSAFE_willMount(e);const{inputStore:r}=this.stores,{groupFormat:o}=this.props;o&&("select"===o.value.type||"multi_select"===o.value.type)&&o.value.value?r.setState({...r.state,inputValue:o.value.value}):o&&(0,i.R7)(o.value)&&"exact"===(null===(t=o.value.value)||void 0===t?void 0:t.type)&&r.setState({...r.state,inputValue:o.value.value.value})}renderComponent(){const{groupFormat:e,onClose:t}=this.props;let r;var o;return r=this.environment.device.isPhone?{menuType:b.og.Modal,title:e?(0,D.jsx)(f.FormattedMessage,{defaultMessage:"Rename group",id:"codeBlock.databaseEditGroupMenu.renameGroupTitle"}):(0,D.jsx)(f.FormattedMessage,{defaultMessage:"Add a group",id:"codeBlock.databaseEditGroupMenu.addGroupTitle"}),left:(0,D.jsx)(f.FormattedMessage,{defaultMessage:"Cancel",id:"codeBlock.databaseEditGroupMenu.cancelButton.label"}),right:(0,D.jsx)(f.FormattedMessage,{defaultMessage:"Done",id:"codeBlock.databaseEditGroupMenu.doneButton.label"}),onClickRight:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMenuClickRight,onClickLeft:t}:{menuType:b.og.Popup,width:(o=this.props.groupBy,"select"===o.type||"multi_select"===o.type||(0,i.HB)(o.type)?300:240),maxHeight:"50vh"},(0,D.jsx)(V.Z,{capture:!0,render:e=>(0,D.jsx)(O.Z,{...r,...e,children:this.renderMenuInner()})})}renderMenuInner(){const{groupBy:e,schema:t}=this.props;if(t[e.property])return"select"===e.type||"multi_select"===e.type?this.renderTextInput():"person"===e.type?(0,D.jsx)(U,{currentGroups:this.props.currentGroups,onChange:this.props.onChange,groupFormat:this.props.groupFormat,onClose:this.props.onClose,inputStore:this.stores.inputStore,menuListStore:this.stores.menuListStore}):"relation"===e.type?this.renderRelationValue():(0,i.HB)(e.type)?this.renderTextInput():void("number"!==e.type&&"status"!==e.type&&"date"!==e.type&&"formula"!==e.type&&"checkbox"!==e.type&&"created_time"!==e.type&&"last_edited_time"!==e.type&&"created_by"!==e.type&&"last_edited_by"!==e.type&&"last_visited_time"!==e.type&&"location"!==e.type&&(0,m.t1)(e.type))}renderTextInput(){const{intl:e,groupFormat:t}=this.props,{inputValue:r}=this.stores.inputStore.state,o=t?e.formatMessage({id:"database.collectionEditGroupMenu.renameGroupLabel.placeholder",defaultMessage:"Rename group"}):e.formatMessage({id:"database.collectionEditGroupMenu.newGroupLabel.placeholder",defaultMessage:"New group"});return this.environment.device.isPhone?(0,D.jsx)(E.Z,{children:(0,D.jsx)(P.ZP,{value:r,focus:!0,selectAll:!0,showClearButton:!1,focusInitial:!0,placeholder:o,onChange:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleTextInputChange,onKeyDown:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleTextInputKeydown})}):(0,D.jsxs)("div",{style:{display:"flex",alignItems:"center",padding:6,width:"100%",background:this.theme.inputBackground},children:[(0,D.jsx)(I.Z,{value:r,focus:!0,selectAll:!0,focusInitial:!0,placeholder:o,onChange:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleTextInputChange,onKeyDown:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleTextInputKeydown,format:I.B.Transparent,style:{fontSize:y.Z.fontSize.UIRegular.desktop}}),(0,D.jsxs)(w.Z,{onClick:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleClickSubmitButton,children:[(0,D.jsx)(f.FormattedMessage,{defaultMessage:"Done",id:"database.collectionEditGroupMenu.submitButton.label"}),(0,u.U)({height:14,width:14,fill:"currentColor",marginLeft:6,marginTop:2})]})]})}renderRelationValue(){const{intl:e,parentStore:t,schema:r,groupBy:o}=this.props,{inputValue:s}=this.stores.inputStore.state,n=r[o.property];if(!n||"relation"!==n.type)return;const a=l.j0(n);if(!a)return;return Z.NW.createChildStore(t,a).isDefined()?(0,D.jsx)(v.Z,{request:s,performRequest:e=>async function(e,t,r,o,s){const n=r[t.property];if(!n||!(0,l.p_)(n))return;const a=n.collection_pointer;if(!a)return;const i=Z.NW.createChildStore(o,{table:g.v,id:a.id});if(await i.load(),!i.isDefined())return;const u=i.getSpaceId(),d=await M.deps.searchActions.loader(),p=await d.searchPagesInCollection({environment:s,query:e,collectionId:a.id,spaceId:u,excludeTemplates:!0,source:"collection_group_value",limit:20,includePublicPagesWithoutExplicitAccess:!0,boostRecentlyViewedPages:!1});return p.results.map((e=>({table:h.iU,id:e,spaceId:u})))}(e,this.props.groupBy,this.props.schema,this.props.parentStore,this.environment),debounce:_.vp,render:(t,r,o)=>{r||(r=[]);const n=d.oA([...z(r,a,this.props.currentGroups,this.props.parentStore,this.props.intl,this.props.onChange,this.props.groupFormat,this.props.onClose,this.context.collectionContextStore),H(this.props.parentStore,this.props.schema,this.props.groupBy,this.props.onChange,this.stores.inputStore)]);let i;return i=o&&r&&0===n.length?(0,D.jsx)(E.Z,{children:(0,D.jsx)(G.Z,{title:(0,D.jsx)(f.FormattedMessage,{defaultMessage:"No results",id:"database.noRelationSearchResults.message"})})}):(0,D.jsx)(T.Z,{type:T.i.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,D.jsx)(E.Z,{...e}),items:n}],store:this.stores.menuListStore}),(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(E.Z,{children:(0,D.jsx)(P.ZP,{value:s,focus:!0,placeholder:e.formatMessage({defaultMessage:"Type to search...",id:"database.searchRelation.placeholder"}),onChange:e=>{this.stores.inputStore.setState({...this.stores.inputStore.state,inputValue:e.target.value}),this.stores.menuListStore.setState({...this.stores.menuListStore.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}})}),i]})}}):void 0}}B.displayName="CollectionEditGroupMenu",B.contextTypes={...o.w,...x.xm};const W=(0,f.injectIntl)(B);function A(){return(0,D.jsx)(f.FormattedMessage,{defaultMessage:"Group already exists.",id:"database.groupExistsAlreadyError.message"})}function U(e){let{currentGroups:t,onChange:r,groupFormat:o,onClose:l,inputStore:u,menuListStore:p}=e;window.__c={n:"PersonValueComponent"};const c=(0,s.O7)(),h=(0,f.useIntl)(),g=(0,n.qz)(p,R.Z),m=(0,n.qz)(u,C.Z),{inputValue:y}=(0,n.VK)((()=>m.state),[m]);return(0,D.jsx)(v.Z,{request:y,performRequest:e=>async function(e,t){const r=await M.deps.searchActions.loader();return(await r.searchVisibleSpaceUsers({environment:t,query:e,membersOnly:!1})).slice(0,20)}(e,c),debounce:_.vp,render:(e,s,n)=>{s||(s=[]);const u=d.oA(s.map((e=>({key:e.id,render:t=>(0,D.jsx)(L.Z,{actor:(0,a.dp)(e),...t}),action:()=>{const s={type:"person",value:{table:"notion_user",id:e.id}};return o&&d.Xy(s,o.value)?(null==l||l(),null):t.some((e=>(0,i.we)(s,e.value)))?(S.showErrorMessage((0,D.jsx)(A,{})),null):void r({newGroupValue:s})}}))));let p;return p=n&&s&&0===u.length?(0,D.jsx)(E.Z,{children:(0,D.jsx)(G.Z,{title:(0,D.jsx)(f.FormattedMessage,{defaultMessage:"No results",id:"database.noPersonSearchResults.message"})})}):(0,D.jsx)(T.Z,{type:T.i.Vertical,initialFocus:0,sections:[{key:0,render:e=>(0,D.jsx)(E.Z,{...e}),items:u}],store:g}),(0,D.jsxs)(D.Fragment,{children:[(0,D.jsx)(E.Z,{children:(0,D.jsx)(P.ZP,{value:y,focus:!0,placeholder:h.formatMessage({defaultMessage:"Search for a person…",id:"database.searchPerson.placeholder"}),onChange:e=>{m.setState({...m.state,inputValue:e.target.value}),g.setState({...g.state,focus:{section:0,indexLocal:0,indexGlobal:0}})}})}),p]})}})}function H(e,t,r,o,s){const{inputValue:n}=s.state,a=t[r.property];if(!a||"relation"!==a.type)return null;const i=l.j0(a);if(!i)return null;const u=Z.NW.createChildStore(e,i);return u.isDefined()&&n.length>0?{key:"new-page",render:e=>(0,D.jsx)(N.Z,{title:(0,D.jsx)(k.Z,{targetCollectionStore:u,title:n}),...e}),action:()=>{const e={table:h.iU,id:(0,p.ZP)(),spaceId:u.getSpaceId()};o({newGroupValue:{type:"relation",value:e},newPage:{id:e.id,spaceId:e.spaceId,name:n}})}}:null}function q(e,t,r,o,s,n){const a=s.state.inputValue.trim().replace(/,/g,"");let l;"select"===r.type||"multi_select"===r.type?l={type:r.type,value:a}:(0,i.aB)(r)&&(l={type:r.type,value:{type:"exact",value:a}}),l&&a?o&&d.Xy(l,o.value)?null==n||n():t.some((e=>l&&(0,i.we)(l,e.value)))?S.showErrorMessage((0,D.jsx)(A,{})):e({newGroupValue:l}):null==n||n()}function z(e,t,r,o,s,n,a,l,u){const p=null==u?void 0:u.relativeVariableStore.state,h=p&&p[t.id],g=(e,r)=>{const s=Z.NW.createChildStore(o,t);if(!s.isDefined())return;const n=s.getFormat().app_config_uri;return n&&r?e.formatMessage(c.qB[n][r].messageDescriptor):void 0};return e.map((e=>{const t=Z.G.createChildStore(o,e);if(t.isTemplate())return;const u=h?(0,c.P8)(t.id,h):void 0;return{key:t.id,render:e=>(0,D.jsx)(F.Z,{store:t,titlePrefix:g(s,u),...e}),action:()=>{let t={type:"relation",value:e};u&&(t={type:"relation",value:{type:"relative",value:{type:"builtin",variable:u}}}),a&&d.Xy(t,a.value)?null==l||l():r.some((e=>(0,i.we)(t,e.value)))?S.showErrorMessage((0,D.jsx)(A,{})):n({newGroupValue:t})}}}))}},26055:(e,t,r)=>{r.d(t,{Z:()=>H});r(67294);var o=r(83355),s=r(24405),n=r(66897),a=r(15145),i=r(14714),l=r(99036),u=r(80951),d=r(84619),p=r(7057),c=r(53877),h=r(42875),g=r(89767),m=r(38737),y=r(96367),f=r(97880),S=r(82990),x=r(9291),v=r(5149),C=r(16732),b=r(10906),M=r(26991),_=r(92996),j=r(29376);var R=r(84210),Z=r(33929),w=r(80444),N=r(61766),V=r(79797),I=r(68500),P=r(50959),O=r(64921),T=r(31945),G=r(60458),F=r(84076),E=r(31278),k=r(76798),L=r(26388),D=r(92864),B=r(25845),W=r(22084),A=r(85893);class U extends o.Z{constructor(){super(...arguments),this.storeTypes={buttonPopupStore:N.Z},this.renderEditPopup=()=>{const{schema:e,currentGroups:t,groupBy:r,groupFormat:o}=this.props,s=this.groupParentStore.state;if(s)return(0,A.jsx)(I.Z,{groupFormat:o,groupBy:r,currentGroups:t,schema:e,onChange:e=>{var t,r;this.stores.buttonPopupStore.reset(),null===(t=(r=this.props).onChange)||void 0===t||t.call(r,e)},onClose:()=>{var e,t;this.stores.buttonPopupStore.reset(),null===(e=(t=this.props).onClose)||void 0===e||e.call(t)},parentStore:s})},this.groupParentStore=this.createComputedStore((()=>{const{collectionContextStore:e,groupFormat:t}=this.props,r=e.groupsStore.getGroupState(t);return null==r?void 0:r.groupUiParentStore})),this.getRelatedCollectionAppConfigUri=this.createComputedStore((()=>{const{schema:e,groupFormat:t}=this.props,r=this.groupParentStore.state,o=e[t.property];if(o&&(0,l.p_)(o)&&r)return(0,j.ke)(o,r)}))}renderGroupType(e,t){return"select"===e.type||"multi_select"===e.type?this.renderSelectValue():"status"===e.type?(0,A.jsx)($,{groupFormat:this.props.groupFormat,schema:this.props.schema}):(0,i.pd)(e.type)?this.renderPersonValue(e):"relation"===e.type?this.renderRelationValue(e):"location"===e.type?this.renderLocationValue(e):(0,i.A1)(e.type)?(0,A.jsx)(ee,{style:this.props.style,groupValue:e}):(0,i.HB)(e.type)?this.renderTextValue(e):"number"===e.type?(0,A.jsx)(te,{style:this.props.style,groupValue:e,propertySchema:"number"===t.type?t:void 0}):"checkbox"===e.type?(0,A.jsx)(J,{style:this.props.style,propertySchema:t,groupValue:e}):void(0,f.t1)(e.type)}renderComponent(){const{groupFormat:e,schema:t}=this.props,r=e.value,o=void 0===r.value,s=t[e.property];if(s){if(o)return this.renderEmptyGroupLabel();if("formula"===r.type){if("formula"!==r.type)return;const e=r.value;if(!e)return;return this.renderGroupType(e,s)}return this.renderGroupType(r,s)}}renderEmptyGroupLabel(){const{groupFormat:e,schema:t,isHiddenGroup:r,collectionContextStore:o}=this.props,s=t[e.property],n=o.collectionStore(),a=this.groupParentStore.state;if(!s)return;const{name:i}=s;let u=!1;return null!=n&&n.isDefined()&&(0,l.p_)(s)&&a&&(u=function(e){const{collectionStore:t,property:r,propertySchema:o,parentStore:s}=e;let n=!1;if(null!=t&&t.isDefined()){const e=t.getPropertyMapping();n=(null==e?void 0:e[_.Es.TaskToSprintRelation])===r}return(0,j.ke)(o,s)===_.p$||n}({collectionStore:n,property:e.property,propertySchema:s,parentStore:a})),u?(0,A.jsx)(z,{style:this.props.style,uncategorizedIconStyle:this.props.uncategorizedIconStyle,isHiddenGroup:r,formattedLabelMessage:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Backlog (No {name})",values:{name:i},id:"database.sprintDatabaseView.uncategorizedGroupLabel"})}):(0,A.jsx)(z,{style:this.props.style,uncategorizedIconStyle:this.props.uncategorizedIconStyle,isHiddenGroup:r,formattedLabelMessage:(0,A.jsx)(x.FormattedMessage,{defaultMessage:"No {name}",values:{name:i},id:"database.boardView.uncategorizedColumnTitle"})})}renderSelectValue(){var e;const{groupFormat:t,schema:r}=this.props,o=r[t.property];if(!o||!l.cu(o))return;const s=t.value;if(null===(e=o.options)||void 0===e||!e.length||void 0===s.value||s.type!==o.type)return;const n=(0,u.i7)(o.options,s.value);return n?(0,A.jsx)(T.ZP,{render:this.renderEditPopup,disabled:this.props.disabled,buttonPopupStore:this.stores.buttonPopupStore,popupType:this.environment.device.isMobile?T.Z4.SlideUp:T.Z4.Popup,originGap:4,renderOrigin:e=>(0,A.jsx)(O.Z,{style:{...re,...this.props.style},disabled:this.props.disabled,...e,children:(0,A.jsx)(W.a,{format:d.lo.Medium,isSingle:!0,value:n.value,color:n.color,showRemoveButton:!1})})}):void 0}renderPersonValue(e){if(!(0,i.q6)(e))return;const{value:t}=e;if(!t)return;const r=this.groupParentStore.state;if(!r)return;const o=(0,n.Hl)({pointer:t,getRecordValue:r.getRecordValue});return o.asActor?(0,A.jsx)(T.ZP,{render:this.renderEditPopup,disabled:this.props.disabled,buttonPopupStore:this.stores.buttonPopupStore,popupType:this.environment.device.isMobile?T.Z4.SlideUp:T.Z4.Popup,originGap:4,renderOrigin:e=>(0,A.jsx)(O.Z,{style:{...re,...this.props.style},disabled:this.props.disabled,...e,children:(0,A.jsx)(D.ZP,{format:D.ZP.Format.Medium,actor:o,showRemoveButton:!1,isSingle:!0,disableAvatarTooltip:this.props.isHiddenGroup,shouldShrink:!0})})}):void 0}renderLocationValue(e){const t=this.groupParentStore.state;if("location"!==e.type)return;if(!e.value)return;if(!t)return;const r=V.NW.createChildStore(t,e.value);return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsx)(E.Z,{disabled:!0,icon:r.getIcon(),size:20,isEmptyPage:!1,style:{marginTop:2,marginRight:6}}),(0,A.jsx)(k.Z,{store:r,underline:!0,style:{fontWeight:S.Z.fontWeight.medium}})]})}renderRelationValue(e){const{schema:t,groupFormat:r,collectionContextStore:o}=this.props,s=this.groupParentStore.state;if(!s)return;if("relation"!==e.type)return;const n=t[r.property];if(!n||"relation"!==n.type)return;const u=l.j0(n);if(!u)return;const d=V.NW.createChildStore(s,u);if(d.isDefined()&&e.value){if((0,i.t2)(e.value)){var p;const t=this.getRelatedCollectionAppConfigUri.state;if(!t)return;let r;const n=e.value.value.variable;"current"===n?r=Z.default.formatMessage(C.sY.tasksCurrentSprintV2ViewNamePrefix):"next"===n?r=Z.default.formatMessage(C.sY.tasksNextSprintV2ViewNamePrefix):"last"===n?r=Z.default.formatMessage(C.sY.tasksLastSprintV2ViewNamePrefix):(0,f.t1)(n);const i=null===(p=y.qB[t])||void 0===p?void 0:p[n];if(null!=d&&d.isDefined()){const e=(0,M.As)(o,n,u,d);if(!e)return(0,A.jsx)("div",{style:{fontWeight:S.Z.fontWeight.medium},children:(0,A.jsx)(x.FormattedMessage,{...null==i?void 0:i.messageDescriptor})});const{mainEditorCurrentBlockStore:t}=w.default.state,l=b.mb({store:e,mainEditorCurrentBlockStore:t,collectionContextStore:o})??(0,R.ZP)({store:e,pageVisitSource:a.tY.LinkInPage});if(e)return(0,A.jsxs)(A.Fragment,{children:[(0,A.jsxs)("div",{style:{fontWeight:S.Z.fontWeight.medium,marginBottom:.25},children:[r,":"]}),(0,A.jsx)(F.Z,{style:{...this.props.style,marginLeft:1},innerStyle:{...re},href:l,onClick:()=>{v.E3({collectionSettingsStore:o.settingsStore})},children:(0,A.jsx)(B.Z,{format:D.ZP.Format.Medium,blockId:e.id,isSingle:!0,shouldShrink:!0,parentStore:s})})]})}return(0,A.jsx)("div",{style:{fontWeight:S.Z.fontWeight.medium,marginBottom:.25},children:(0,A.jsx)(x.FormattedMessage,{...null==i?void 0:i.messageDescriptor})})}if((0,i.RA)(e.value)){const t=V.G.createChildStore(s,e.value),{mainEditorCurrentBlockStore:r}=w.default.state,n=b.mb({store:t,mainEditorCurrentBlockStore:r,collectionContextStore:o})??(0,R.ZP)({store:t,pageVisitSource:a.tY.LinkInPage});return(0,A.jsx)(F.Z,{style:this.props.style,innerStyle:{...re},href:n,onClick:()=>{v.E3({collectionSettingsStore:o.settingsStore})},children:(0,A.jsx)(B.Z,{format:D.ZP.Format.Medium,blockId:e.value.id,isSingle:!0,shouldShrink:!0,parentStore:s})})}}}renderTextValue(e){if((0,i.R7)(e)&&void 0!==e.value){const t=(0,A.jsx)(Y,{value:e.value});return"exact"===e.value.type?(0,A.jsx)(T.ZP,{render:this.renderEditPopup,disabled:this.props.disabled,buttonPopupStore:this.stores.buttonPopupStore,popupType:this.environment.device.isMobile?T.Z4.SlideUp:T.Z4.Popup,originGap:4,renderOrigin:e=>(0,A.jsx)(O.Z,{style:{...q,...S.Z.textOverflowStyle,...this.props.style},disabled:this.props.disabled,...e,children:t})}):(0,A.jsx)("div",{style:q,children:t})}}}U.displayName="CollectionGroupValue";const H=(0,x.injectIntl)(U),q={overflow:"hidden",padding:3,borderRadius:4,fontWeight:S.Z.fontWeight.medium};function z(e){const{isHiddenGroup:t}=e;return t?(0,A.jsx)(K,{...e,tooltipEvents:void 0}):(0,A.jsx)(L.ZP,{renderTooltip:()=>(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Any items with an empty <b>{name}</b> property will go here. This group cannot be removed.",values:{name:null,b:e=>(0,A.jsx)("span",{style:{fontWeight:S.Z.fontWeight.semibold},children:e})},id:"database.boardView.uncategorizedColumnTooltip"}),style:{width:240},textWrap:!0,render:t=>(0,A.jsx)(K,{...e,tooltipEvents:t})})}function K(e){const t={display:"flex",alignItems:"center",fontSize:14,lineHeight:1.2,paddingLeft:2,paddingRight:4,whiteSpace:"nowrap",overflow:"hidden",fontWeight:S.Z.fontWeight.medium},{style:r,uncategorizedIconStyle:o,tooltipEvents:s,formattedLabelMessage:n}=e;return(0,A.jsxs)("div",{style:{...t,paddingLeft:0,...r},...s,children:[(0,g.R)({width:14,marginLeft:6,marginRight:6,...o}),(0,A.jsx)("span",{style:{...S.Z.textOverflowStyle},children:n})]})}function Y(e){let{value:t}=e;return"other"===t.type?(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Other",id:"database.collectionGroupValue.textGroup.other"}):"alphabet_prefix"===t.type||"exact"===t.type?(0,A.jsx)(A.Fragment,{children:t.value}):void(0,f.t1)(t)}function $(e){let{groupFormat:t,schema:r}=e;const o=r[t.property];if(!o||"status"!==o.type)return null;const s=t.value;if(s.type!==o.type)return null;const{value:n}=s;if(!n)return null;const a=o.options??[],i=o.groups??[];if("by_group"===n.type){const e=i.find((e=>e.name===n.group));return e?(0,A.jsx)(P.r_,{group:e,style:{fontWeight:500},showIcon:!0,showColor:!0}):null}if("by_option"===n.type){const e=(0,u.i7)(a,n.option),t=e&&i.find((t=>{var r;return null===(r=t.optionIds)||void 0===r?void 0:r.includes(e.id)}));return e?(0,A.jsx)("span",{style:{fontWeight:500,lineHeight:"normal",overflow:"hidden"},children:(0,A.jsx)(W.F,{format:d.lo.Medium,isSingle:!0,value:e.value,color:e.color,showRemoveButton:!1,groupColor:null==t?void 0:t.color})}):null}(0,f.t1)(n)}function Q(e){let{value:t}=e;window.__c={n:"DateGroupValue"};const r=(0,x.useIntl)();if("today"===t.type)return(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Today",id:"database.collectionGroupValue.dateGroup.today"});if("yesterday"===t.type)return(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Yesterday",id:"database.collectionGroupValue.dateGroup.yesterday"});if("last_7_days"===t.type)return(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Last 7 days",id:"database.collectionGroupValue.dateGroup.last7Days"});if("last_30_days"===t.type)return(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Last 30 days",id:"database.collectionGroupValue.dateGroup.last_30Days"});if("tomorrow"===t.type)return(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Tomorrow",id:"database.collectionGroupValue.dateGroup.tomorrow"});if("next_7_days"===t.type)return(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Next 7 days",id:"database.collectionGroupValue.dateGroup.next7Days"});if("next_30_days"===t.type)return(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Next 30 days",id:"database.collectionGroupValue.dateGroup.next30Days"});if("day"===t.type){const e=(0,c.NK)(t.range,(0,h.r)(),r.locale);return(0,A.jsx)(A.Fragment,{children:(0,p.ZW)(e.start,"medium")})}if("week"===t.type){const e=(0,c.NK)(t.range,(0,h.r)(),r.locale),o=(0,p.ZW)(e.start,"month_short"),s=(0,p.ZW)(e.start,"day"),n=e.start.year,a=(0,p.ZW)(e.end,"month_short"),i=(0,p.ZW)(e.end,"day"),l=e.end.year;return n!==l?(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Week of {startMonth} {startDay} {startYear} - {endMonth} {endDay} {endYear}",id:"database.collectionGroupValue.dateGroup.week.differingStartAndEndYear",values:{startMonth:o,startDay:s,endMonth:a,endDay:i,startYear:n,endYear:l}}):o!==a?(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Week of {startMonth} {startDay} - {endMonth} {endDay} {startYear}",id:"database.collectionGroupValue.dateGroup.week.differingStartAndEndMonth",values:{startMonth:o,startDay:s,endMonth:a,endDay:i,startYear:n}}):(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Week of {startMonth} {startDay}-{endDay} {startYear}",id:"database.collectionGroupValue.dateGroup.week.sameStartAndEndMonth",values:{startMonth:o,startDay:s,endDay:i,startYear:n}})}if("month"===t.type){const e=(0,c.NK)(t.range,(0,h.r)(),r.locale);return(0,A.jsx)(A.Fragment,{children:(0,p.ZW)(e.start,"month_year_short")})}if("year"===t.type){const e=(0,c.NK)(t.range,(0,h.r)(),r.locale);return(0,A.jsx)(A.Fragment,{children:e.start.year.toString()})}(0,f.t1)(t)}function X(e){let{value:t,format:r}=e;window.__c={n:"NumberGroupValue"};const o=(0,x.useIntl)();if("out_of_range"===t.type)return(0,A.jsx)(x.FormattedMessage,{defaultMessage:"Out of range",id:"database.collectionGroupValue.numberGroup.outOfRange"});if("range"===t.type){const e=m.uf(t.start,r,o),s=m.uf(t.end,r,o);return(0,A.jsx)(x.FormattedMessage,{defaultMessage:"{start} to {end}",id:"database.collectionGroupValue.numberGroup.range",values:{start:e,end:s}})}(0,f.t1)(t)}function J(e){let{groupValue:t,propertySchema:r,style:o}=e;window.__c={n:"CheckboxValue"};const n=(0,s.yK)((()=>({checkboxStyle:{display:"inline-flex",marginRight:6},wrapperStyle:{fontWeight:S.Z.fontWeight.medium,marginRight:3,display:"flex",alignItems:"center"}})),[]);return"checkbox"!==t.type?null:(0,A.jsxs)("div",{style:{...S.Z.textOverflowStyle,...n.wrapperStyle,...o},children:[(0,A.jsx)(G.Z,{checked:t.value,checkSize:10,size:14,disabled:!0,style:n.checkboxStyle}),(0,A.jsx)("span",{children:null==r?void 0:r.name})]})}function ee(e){let{groupValue:t,style:r}=e;return(0,i.Mc)(t)&&t.value?(0,A.jsx)("div",{style:{...re,...S.Z.textOverflowStyle,...r},children:(0,A.jsx)(Q,{value:t.value})}):null}function te(e){let{groupValue:t,propertySchema:r,style:o}=e;if("number"!==t.type||!t.value)return null;const s=(null==r?void 0:r.number_format)||m.dk;return(0,A.jsx)("div",{style:{...re,...o},children:(0,A.jsx)(X,{value:t.value,format:s})})}const re={overflow:"hidden",padding:3,paddingRight:6,borderRadius:4,fontWeight:S.Z.fontWeight.medium}},75498:(e,t,r)=>{r.d(t,{Z:()=>f});var o=r(67294),s=r(83355),n=r(1302),a=r(86628),i=r(49085),l=r(72126),u=r(71644),d=r(75330),p=r(77080),c=r(48190),h=r(85893);class g extends s.Z{constructor(){super(...arguments),this.reducerId=this.props.id,this.instanceId=(0,u.ZP)(),this.localResultStoreChangeIsQueued=!1,this.storeTypes={resultStore:i.default.createClass(void 0)},this.handleLocalResultStoreChange=()=>{this.localResultStoreChangeIsQueued||(this.localResultStoreChangeIsQueued=!0,n.default.afterNextFlush(this.dequeueLocalResultStoreChange))},this.dequeueLocalResultStoreChange=()=>{const{resultStore:e}=this.stores;if(this.localResultStoreChangeIsQueued=!1,!this.componentIsMounted)return;const t=this.getCurrentResult();l.Xy(t,e.state)||e.setState(t)}}UNSAFE_willMount(e){const{collectionContextStore:t}=e;t.remoteResult.addListener(this.handleLocalResultStoreChange),t.localResultStore.addListener(this.handleLocalResultStoreChange),this.updateReducer(e),this.handleLocalResultStoreChange()}UNSAFE_willUpdate(e){this.updateReducer(e)}willUnmount(){super.willUnmount();const{collectionContextStore:e,groupsPointer:t}=this.props;d.$D({reducerId:this.reducerId,instanceId:this.instanceId,reducer:void 0,collectionContextStore:e,groupsPointer:t}),e.remoteResult.removeListener(this.handleLocalResultStoreChange),e.localResultStore.removeListener(this.handleLocalResultStoreChange)}renderComponent(){const{render:e}=this.props;if(e)return e(this.stores.resultStore)}updateReducer(e){const{reducer:t,collectionContextStore:r,groupsPointer:o}=e;d.$D({reducerId:this.reducerId,instanceId:this.instanceId,reducer:t,collectionContextStore:r,groupsPointer:o})}getCurrentResult(){const{reducer:e,collectionContextStore:t}=this.props,r=t.localResultStore.state,o=t.remoteResult.state,s=r&&"reducer"===r.type?r.reducerResults[this.reducerId]:void 0,n=o&&"reducer"===o.type?o.reducerResults[this.reducerId]:void 0;return(0,c.P)({reducerId:this.reducerId,localReducerResult:s,remoteReducerResult:n,reducer:e,collectionContextStore:t})}}function m(e){window.__c={n:"MigratedCollectionReducerRequest"};const{resultStore:t,render:r,...s}=e,n=(0,c.Z)(s),l=(0,a.qz)(t,i.default.createClass(void 0));(0,o.useEffect)((()=>{l.setState(n)}),[n,l]);const u=(0,a.VK)((()=>r?r(l):null),[r,l]);return(0,h.jsx)(h.Fragment,{children:u})}g.displayName="CollectionReducerRequest";const y=o.memo(m);const f=function(e){window.__c={n:"CollectionReducerRequest"};const t=(0,a.VK)((()=>p.default.checkGate("use_collection_reducer_request_hook")),[]),[r]=(0,o.useState)(t);return r?(0,h.jsx)(y,{...e}):(0,h.jsx)(g,{...e})}},86765:(e,t,r)=>{r.d(t,{Z:()=>p});r(67294);var o=r(480),s=r(86628),n=r(24405),a=r(9291),i=r(1018),l=r(31278),u=r(76798),d=r(85893);const p=(0,a.injectIntl)((function(e){window.__c={n:"RelationCreateItemText"};const{title:t,targetCollectionStore:r}=e,p=(0,o.Fy)(),c=(0,s.VK)((()=>r.getIcon()),[r]),h=(0,n.yK)((e=>({medium:{color:e.mediumTextColor},dbName:{display:"flex",alignItems:"center",marginLeft:4},title:{marginLeft:i.Qi*(p.isRetina?.5:1)}})),[p.isRetina]),g=t?(0,d.jsxs)("span",{children:[" ",t," "]}):(0,d.jsx)("span",{children:" "}),m=(0,d.jsxs)("div",{style:h.dbName,children:[(0,d.jsx)(l.Z,{disabled:!0,icon:c,isEmptyPage:!1,size:p.isMobile?24:20}),(0,d.jsx)(u.Z,{store:r,style:h.title})]});return(0,d.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,d.jsx)(a.FormattedMessage,{id:"database.searchRelation.createNewPageFooter",defaultMessage:"<medium>New</medium> {pageName} <medium> in</medium> {databaseNameWithIcon}",values:{medium:e=>(0,d.jsx)("span",{style:h.medium,children:e}),pageName:g,databaseNameWithIcon:m}})})}))},97680:(e,t,r)=>{r.d(t,{Z:()=>m});var o=r(67294),s=r(480),n=r(66897),a=r(97880),i=r(9291),l=r(98742),u=r(4023),d=r(52275),p=r(26388),c=r(70301),h=r(45653),g=r(85893);const m=o.forwardRef(((e,t)=>{window.__c={n:"UserMenuItem"};const{actor:r,userTitle:o,useEmailAsTooltip:m,tooltip:y,tooltipPlacement:f}=e,S=(0,s.O7)(),x=(0,i.useIntl)(),v=r.asActor&&r.isUser()?r.email:void 0,C=m&&v?v:y,b=S.device.isMobile?24:20;let M;return(0,n.YU)(r)?M=(0,g.jsx)(c.Z,{botValue:null==r?void 0:r.asActor,size:b}):(0,n.$S)(r)?M=(0,g.jsx)(h.Z,{userValue:null==r?void 0:r.asActor,size:b}):(0,n.Iq)(r)?M=(0,g.jsx)(h.Z,{userValue:void 0,size:b}):(0,a.t1)(r),(0,g.jsx)(p.ZP,{ref:t,placement:f??u.u.Bottom,alignment:u.v.Start,textWrap:!0,render:t=>(0,g.jsx)(d.Z,{...(0,l.Z)(t,e),icon:M,title:o??(0,n.$4)(x,r),className:"notranslate"}),disableTooltip:!C,renderTooltip:()=>C})}))},48190:(e,t,r)=>{r.d(t,{P:()=>p,Z:()=>d});var o=r(67294),s=r(1302),n=r(86628),a=r(28155),i=r(40107),l=r(72126),u=r(75330);function d(e){const{id:t,reducer:r,collectionContextStore:a,groupsPointer:d}=e,c=(0,n.VK)((()=>d),[d],{useDeepEqual:!0}),h=(0,n.VK)((()=>r),[r],{useDeepEqual:!0}),g=(0,n.VK)((()=>a.collectionViewStore()),[a]),m=(0,o.useRef)(!1),y=(0,i.S)(),[f,S]=(0,o.useReducer)(((e,t)=>l.Xy(e,t)?e:t),void 0),x=(0,o.useCallback)((()=>{const e=a.localResultStore.state,r=a.remoteResult.state,o=e&&"reducer"===e.type?e.reducerResults[t]:void 0,s=r&&"reducer"===r.type?r.reducerResults[t]:void 0;return p({reducerId:t,collectionContextStore:a,reducer:h,localReducerResult:o,remoteReducerResult:s})}),[a,h,t]),v=(0,o.useCallback)((()=>{m.current=!1,y()||S(x())}),[x,y]),C=(0,o.useCallback)((()=>{m.current||(m.current=!0,s.default.afterNextFlush(v))}),[v]);return(0,o.useEffect)((()=>(a.remoteResult.addListener(C),a.localResultStore.addListener(C),()=>{a.remoteResult.removeListener(C),a.localResultStore.removeListener(C)})),[a,C]),(0,o.useEffect)((()=>(u.$D({reducerId:t,instanceId:void 0,reducer:h,collectionContextStore:a,groupsPointer:c}),()=>{u.$D({reducerId:t,instanceId:void 0,reducer:void 0,collectionContextStore:a,groupsPointer:c})})),[a,g,c,h,t]),(0,o.useEffect)((()=>{C()}),[]),f}function p(e){const{reducerId:t,localReducerResult:r,remoteReducerResult:o,collectionContextStore:s,reducer:n}=e,i=s.reducers.state,u=s.remoteResult.state;if(s.isClientModeEnabled.state)return r;if("aggregation"===n.type||"groups"===n.type){if(null!=u&&u.reducerResults[t])return u.reducerResults[t];const e=Boolean(u&&"reducer"===u.type&&l.sE(u.reducerResults,((e,t)=>{const r=i[t];return Boolean(r&&"results"===r.reducer.type&&!r.reducer.searchQuery&&"results"===e.type&&e.hasMore&&l.Xy(n.filter,r.reducer.filter))})));return e?r:o}if("results"===n.type){var d;const e=s.wasCreatedThisSession.state,n=Boolean(u&&"reducer"===u.type&&u.reducerResults[t]),i=(0,a.nx)(null===(d=s.collectionViewStore())||void 0===d?void 0:d.getCollectionSource());if((n||e)&&!i&&r&&"results"===r.type){return{...r,hasMore:o&&"results"===o.type?o.hasMore:r.hasMore}}return o}}}}]);