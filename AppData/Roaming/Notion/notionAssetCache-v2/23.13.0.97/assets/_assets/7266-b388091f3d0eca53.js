"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[7266],{94166:(e,t,o)=>{o.d(t,{Z:()=>c});o(67294);var r=o(480),i=o(24405),n=o(5257),s=o(56666),l=o(52275),a=o(25130),p=o(85893);const c=function(e){window.__c={n:"CollectionSettingsMenuItem"};const{icon:t,iconStyle:o,title:c,caption:d,right:u,rightStyle:h,isRed:g,isGray:m,isOrange:x,isPadded:f,onClick:C,onMouseDown:y,onMouseEnter:v,onMouseLeave:S,disabled:b,showChevron:j,chevronStyle:F,rotateChevron:M,showDragHandle:w,focused:Z,textWrapperStyle:T,shouldWrapCaption:k,desktopIconStyle:V}=e,A=(0,r.O7)(),{isMobile:_}=A.device,P=(0,i.yK)((e=>({style:{color:m?e.mediumTextColor:x?"dark"===e.mode?e.accentColors.orange[500]:e.accentColors.orange[400]:e.regularTextColor,fill:m?e.mediumIconColor:x?"dark"===e.mode?e.accentColors.orange[500]:e.accentColors.orange[400]:e.regularIconColor,opacity:b?.4:void 0},leftIconStyle:{width:24,height:f?24:_?18:16,marginRight:-2,...t===s.o&&{height:3},...o},rightStyle:{display:"flex",alignItems:"center",color:b?e.regularTextColor:e.lightTextColor,fill:b?e.regularIconColor:e.lightIconColor,flexShrink:0,...h},rightIconStyle:{width:12,fill:e.lightIconColor,marginLeft:6,transition:"transform 200ms ease-in-out",...F},rightIconRotatedStyle:{transform:"rotate(90deg)"}})),[m,x,b,o,f,_,t,F,h]),[R,I]=(0,a.o$)(),O=(0,a.nq)(I);return(0,p.jsx)(l.Z,{ref:R,icon:null==t?void 0:t(P.leftIconStyle),focused:Z||!1,disabled:b,title:c,caption:d,shouldWrapCaption:k,desktopTitleStyle:{flexGrow:1,flexShrink:1},showDragHandle:w,buttonStyle:P.style,rightStyle:P.rightStyle,isRedOnHover:g,ignoreLocalHoverState:!!b||void 0,right:(0,p.jsxs)(p.Fragment,{children:[u,!b&&j&&(0,n.o)({...P.rightIconStyle,...M&&P.rightIconRotatedStyle})]}),onClick:C,onMouseDown:y,onMouseEnter:v,onMouseLeave:S,textWrapperStyle:T,desktopIconStyle:V,disallowTabbing:!O})}},86650:(e,t,o)=>{o.d(t,{R1:()=>H,ep:()=>W,ZP:()=>N});o(67294);var r=o(83355),i=o(480),n=o(86628),s=o(49085),l=o(76205),a=o(45238),p=o(85893);const c=(0,a.I)("copyPadded",{viewBox:"0 0 24 24",svg:(0,p.jsx)("path",{d:"M4.89062 18.5107C4.89062 19.9873 5.64941 20.7529 7.1123 20.7529H13.5107C14.9736 20.7529 15.7256 19.9805 15.7256 18.5107V17.2461H16.8877C18.3506 17.2461 19.1094 16.4805 19.1094 15.0039V9.58984C19.1094 8.69434 18.9248 8.12012 18.3848 7.56641L14.9736 4.09375C14.4609 3.56738 13.8525 3.36914 13.0664 3.36914H10.4893C9.0332 3.36914 8.26758 4.13477 8.26758 5.61133V6.86914H7.1123C5.64941 6.86914 4.89062 7.6416 4.89062 9.11133V18.5107ZM15.042 11.3262L11.3369 7.55957C10.8105 7.02637 10.3662 6.88281 9.60742 6.87598V5.68652C9.60742 5.05762 9.94238 4.70898 10.6055 4.70898H13.4629V7.97656C13.4629 8.82422 13.9141 9.26172 14.7549 9.26172H17.7695V14.9219C17.7695 15.5576 17.4414 15.9062 16.7715 15.9062H15.7256V13.2539C15.7256 12.3311 15.6162 11.9072 15.042 11.3262ZM14.584 7.80566V5.2627L17.4209 8.14062H14.9189C14.6865 8.14062 14.584 8.04492 14.584 7.80566ZM6.23047 18.4287V9.19336C6.23047 8.56445 6.55859 8.20898 7.22168 8.20898H9.32031V11.9551C9.32031 12.9326 9.80566 13.4111 10.7764 13.4111H14.3857V18.4287C14.3857 19.0645 14.0576 19.4131 13.3945 19.4131H7.22168C6.55859 19.4131 6.23047 19.0645 6.23047 18.4287ZM10.9062 12.2285C10.626 12.2285 10.5029 12.1055 10.5029 11.8252V8.46875L14.2012 12.2285H10.9062Z"})});var d=o(56666),u=o(21197),h=o(38715),g=o(55863),m=o(72126),x=o(97880),f=o(82990),C=o(9291),y=o(8406),v=o(34993),S=o(5149),b=o(82530),j=o(23063),F=o(52275),M=o(31945),w=o(73063),Z=o(78140),T=o(28992),k=o(32163),V=o(89728),A=o(53437),_=o(72495),P=o(26388),R=o(95691),I=o(97004),O=o(87279),B=o(98742),D=o(61766),L=o(94166);let H=function(e){return e[e.FilterBar=0]="FilterBar",e[e.SettingsFilters=1]="SettingsFilters",e[e.SettingsSort=2]="SettingsSort",e}({});class G extends r.Z{constructor(){super(...arguments),this.storeTypes={showMoreStore:s.default.createClass(!1),moreActionsButtonPopupStore:D.Z},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMoreOptionsClick=()=>{return e=this.environment,t=this.props.collectionContextStore,o=this.stores.showMoreStore,y.wd({environment:e,collectionContextStore:t,action:"click_save_control_more_options_button"}),void o.setState(!0);var e,t,o},this.changeCount=this.createComputedStore((()=>{const{collectionContextStore:e,context:t}=this.props,o=e.localStateDiffStore.state;return t===H.SettingsFilters?(o.filters.moved.length>0?1:0)+o.filters.added.length+o.filters.removed.length+o.filters.updated.length:0}))}renderComponent(){const{context:e,collectionContextStore:t,showHoverActionsStore:o}=this.props,{showMoreStore:r}=this.stores,{device:i}=this.environment,n=t.permissionScopes.state;if(e===H.FilterBar)return i.isPhone?n.canConfigureBlock?(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(V.Z,{isOrange:!0,hovered:!0,style:{flexGrow:1,justifyContent:"center",height:32,marginRight:8,fontWeight:f.Z.fontWeight.semibold},onClick:()=>Q(this.environment,this.props.collectionContextStore,this.props.context),children:(0,p.jsx)(z,{})}),(0,p.jsx)(M.ZP,{popupType:this.environment.device.isMobile?A.kQ.SlideUp:A.kQ.Popup,render:e=>(0,p.jsx)(ee,{parent:e,collectionContextStore:this.props.collectionContextStore,context:this.props.context,intl:this.props.intl}),originGap:4,onClick:()=>Y(this.environment,this.props.collectionContextStore),buttonPopupStore:this.stores.moreActionsButtonPopupStore,renderOrigin:e=>(0,p.jsx)(w.Z,{style:{width:32,height:32},iconStyle:{width:16},hovered:!0,icon:d.o,...e})})]}):(0,p.jsx)(p.Fragment,{children:(0,p.jsx)(V.Z,{style:{flexGrow:1,justifyContent:"center",height:32,marginRight:8,fontWeight:f.Z.fontWeight.semibold},hovered:!0,isGray:!0,onClick:()=>X(this.environment,this.props.collectionContextStore,this.props.context),children:(0,p.jsx)(q,{})})}):(0,p.jsx)(j.Z,{isVisible:t.isFullScreen.state||!o||o.state,animationStyle:{opacity:1},enterAnimationStyle:{opacity:0},exitAnimationStyle:{opacity:0},render:()=>(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,p.jsx)(V.Z,{isGray:!0,onClick:()=>X(this.environment,this.props.collectionContextStore,this.props.context),style:{lineHeight:1.1,fontSize:i.isMobile?16:14},children:(0,p.jsx)(q,{})}),n.canConfigureBlock&&(0,p.jsx)(M.ZP,{popupType:this.environment.device.isMobile?A.kQ.SlideUp:A.kQ.Popup,render:e=>(0,p.jsx)(ee,{parent:e,collectionContextStore:this.props.collectionContextStore,context:this.props.context,intl:this.props.intl}),originGap:4,onClick:()=>Y(this.environment,this.props.collectionContextStore),buttonPopupStore:this.stores.moreActionsButtonPopupStore,renderOrigin:e=>(0,p.jsx)(R.Z,{title:(0,p.jsx)(z,{}),color:"orange",onClick:()=>Q(this.environment,this.props.collectionContextStore,this.props.context),dropdownEvents:e,style:{marginLeft:6,marginRight:i.isMobile?8:void 0,fontSize:i.isMobile?16:14,...i.isMobile?{height:30}:null}})})]})});if(e===H.SettingsFilters||e===H.SettingsSort){const t=e===H.SettingsFilters;return(0,p.jsxs)(p.Fragment,{children:[r.state&&n.canConfigureBlock&&(i.isMobile?(0,p.jsx)(T.Z,{style:{fontSize:12,color:this.theme.mediumTextColor},title:this.renderSaveExplanationMessage()}):(0,p.jsx)("div",{style:{fontSize:12,color:this.theme.mediumTextColor,paddingLeft:14,paddingRight:14,paddingTop:8,paddingBottom:8,maxWidth:220},children:this.renderSaveExplanationMessage()})),n.canConfigureBlock&&(0,p.jsx)(L.Z,{icon:h.N,isOrange:!0,title:(0,p.jsx)(z,{}),onClick:()=>Q(this.environment,this.props.collectionContextStore,this.props.context)}),(0,p.jsx)(L.Z,{icon:g.s,isGray:!0,title:t?(0,p.jsx)(C.FormattedMessage,{defaultMessage:"Reset filters",id:"database.viewSettings.filterAndSortSaveControl.resetFilters"}):(0,p.jsx)(C.FormattedMessage,{defaultMessage:"Reset sorts",id:"database.viewSettings.filterAndSortSaveControl.resetSorts"}),onClick:()=>X(this.environment,this.props.collectionContextStore,this.props.context)}),n.canConfigureBlock&&!r.state&&(0,p.jsx)(L.Z,{icon:d.o,isGray:!0,title:(0,p.jsx)(C.FormattedMessage,{defaultMessage:"More options",id:"database.viewSettings.filterAndSortSaveControl.more"}),onClick:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMoreOptionsClick}),n.canConfigureBlock&&r.state&&(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)(L.Z,{icon:c,isPadded:!0,isGray:!0,title:(0,p.jsx)(K,{}),onClick:()=>{$(this.environment,this.props.collectionContextStore,this.props.intl)}}),E(this.props.collectionContextStore,this.props.context)&&(0,p.jsx)(P.ZP,{placement:P.ug.Left,style:{maxWidth:240,whiteSpace:void 0},renderTooltip:()=>(0,p.jsx)("div",{children:(0,p.jsx)(W,{})}),render:e=>(0,p.jsx)(L.Z,{icon:u.Q,isGray:!0,title:(0,p.jsx)(U,{}),onClick:()=>{J(this.environment,this.props.collectionContextStore,this.props.context)},...e})})]})]})}(0,x.t1)(e)}renderSaveExplanationMessage(){const{context:e}=this.props;return e===H.SettingsFilters?(0,p.jsx)(C.FormattedMessage,{defaultMessage:"{count, plural, one {{count} filter changed from what other people see} other {{count} filters changed from what other people see}}",id:"database.viewSettings.filterAndSortSaveControl.filter.caption",values:{count:this.changeCount.state}}):(0,p.jsx)(C.FormattedMessage,{defaultMessage:"Sort has been changed from what other people see",id:"database.viewSettings.filterAndSortSaveControl.sort.caption"})}}function W(){return(0,p.jsx)(C.FormattedMessage,{id:"database.filterValue.mergeIntoAdvancedFilter.tooltip",defaultMessage:"Use an advanced filter to group filter rules and use AND/OR conditions."})}G.displayName="CollectionSettingsSaveControl";const N=(0,C.injectIntl)(G);function K(){return(0,p.jsx)(C.FormattedMessage,{defaultMessage:"Save as new view",id:"database.filterBar.changesControl.saveAsNewView.title"})}function U(){return(0,p.jsx)(C.FormattedMessage,{defaultMessage:"Merge into advanced filter",id:"database.filterBar.changesControl.mergeIntoAdvancedFilter.title"})}function q(){return(0,p.jsx)(C.FormattedMessage,{defaultMessage:"Reset",id:"database.filterBar.changesControl.reset.title"})}function z(){return(0,p.jsx)(C.FormattedMessage,{defaultMessage:"Save for everyone",id:"database.filterBar.changesControl.saveForEveryone.title"})}function E(e,t){const o=e.currentPropertyFiltersStore.state;return(t===H.FilterBar||t===H.SettingsFilters)&&Boolean(o.find((e=>(0,l.aN)(e.filter))))}function Q(e,t,o){const r=t.collectionViewStore();r&&(y.wd({environment:e,collectionContextStore:t,action:"click_save_control_save_in_current_view"}),b.createAndCommit({userAction:"CollectionSettingsSaveControl.handleSaveInCurrentViewClick",environment:e,perform:i=>{v.Ys({environment:e,type:o===H.FilterBar?v.mO.All:o===H.SettingsFilters?v.mO.Filters:v.mO.Sorts,collectionContextStore:t,targetCollectionView:r,transaction:i})}}),v.RD({environment:e,seen:!0}))}function $(e,t,o,r){y.wd({environment:e,collectionContextStore:t,action:"click_save_control_save_as_new_view"}),b.createAndCommit({userAction:"CollectionSettingsSaveControl.handleSaveAsNewViewClick",environment:e,perform:r=>{v.k7({environment:e,collectionContextStore:t,transaction:r,intl:o})}}),null==r||r.close()}function J(e,t,o,r){const i=(0,I.Pi)(t),n=t.currentPropertyFiltersStore.state.filter((e=>(0,I.mu)(e.id)));v.iU({environment:e,collectionContextStore:t,temporaryState:{...t.temporaryState.state,propertyFilters:{value:n},combinatorFilter:{value:i}}});const s=o===H.FilterBar?t.filterBarCombinatorFilterSettingsStore:t.filterOptionsCombinatorFilterSettingsStore;S.wl({collectionSettingsStore:s,item:{type:"filter"}}),y.wd({environment:e,collectionContextStore:t,action:"merge_filter_into_combinator"}),null==r||r.close()}function X(e,t,o,r){y.wd({environment:e,collectionContextStore:t,action:"click_save_control_reset"});const i=t.temporaryState.state,n=o===H.SettingsFilters?{...i,propertyFilters:void 0,combinatorFilter:void 0}:o===H.SettingsSort?{...i,sorts:void 0}:void 0;v._x({environment:e,collectionContextStore:t,temporaryState:n}),v.RD({environment:e,seen:!0}),null==r||r.close()}function Y(e,t){y.wd({environment:e,collectionContextStore:t,action:"click_save_control_more_options_popup"}),v.RD({environment:e,seen:!0})}function ee(e){let{parent:t,collectionContextStore:o,context:r,intl:s}=e;window.__c={n:"SaveActionsPopupComponent"};const l=(0,i.O7)(),{device:a}=l;let c;c=a.isMobile?{menuType:O.og.ActionSheet}:{menuType:O.og.Popup,width:250};const d=(0,n.VK)((()=>E(o,r)),[o,r]),u=m.oA([a.isPhone&&{key:"reset",render:e=>(0,p.jsx)(F.Z,{...e,disabled:!1,title:(0,p.jsx)(q,{})}),action:()=>{X(l,o,r,t)}},{key:"newView",render:e=>(0,p.jsx)(F.Z,{...e,disabled:!1,title:(0,p.jsx)(K,{})}),action:()=>{$(l,o,s,t)}},d&&{key:"merge",render:e=>(0,p.jsx)(P.ZP,{placement:P.ug.Left,style:{maxWidth:240,whiteSpace:void 0},renderTooltip:()=>(0,p.jsx)("div",{children:(0,p.jsx)(W,{})}),render:t=>(0,p.jsx)(F.Z,{...(0,B.Z)(e,t),disabled:!1,title:(0,p.jsx)(U,{})})}),action:()=>{J(l,o,r,t)}}]);return(0,p.jsx)(Z.Z,{...c,children:(0,p.jsx)(k.Z,{type:k.i.Vertical,sections:[{key:0,render:e=>(0,p.jsx)(_.Z,{enableActionSheetTitle:!0,...e}),items:u}],initialFocus:0})})}},2005:(e,t,o)=>{o.d(t,{Tp:()=>g,cn:()=>c,fg:()=>u,l0:()=>d,oq:()=>h});o(67294);var r=o(480),i=o(36488),n=o(78140),s=o(28992),l=o(40721),a=o(87279),p=o(85893);const c=8,d=8,u=32,h={height:u+c-2,paddingTop:c-2};function g(e){let{title:t,helpButton:o,onCancel:s,desktopMinWidth:c,desktopMaxWidth:d,desktopWidth:u,children:h}=e;window.__c={n:"CollectionViewMenu"};const{device:g}=(0,r.O7)();return(0,p.jsx)(i.Z,{capture:!0,allowEsc:!0,allowUndo:!0,render:e=>{let r;return r=g.isMobile?{menuType:a.og.Modal,title:t,right:(0,p.jsx)(l.DoneMenuText,{}),onClickRight:s,...e}:{menuType:a.og.Popup,...c&&{minWidth:c},...d&&{maxWidth:d},...u&&{width:u},...e},(0,p.jsx)(n.Z,{...r,header:t&&(0,p.jsx)(m,{title:t,helpButton:o}),children:h})}})}function m(e){let{title:t,helpButton:o}=e;window.__c={n:"Heading"};return(0,r.O7)().device.isMobile?null:(0,p.jsx)(s.Z,{style:h,title:t,right:o})}g.displayName="CollectionViewMenu"},13401:(e,t,o)=>{o.d(t,{Z:()=>c});var r=o(67294),i=o(24405),n=o(8848),s=o(47453),l=o(31339),a=o(52275),p=o(85893);const c=r.forwardRef(((e,t)=>{window.__c={n:"AddMenuItem"};const o=(0,i.yK)((t=>({base:{color:e.isBlue?n.ZP.blue:t.mediumTextColor}})),[e.isBlue]),{color:r}=o.base;return(0,p.jsx)(a.Z,{ref:t,...e,title:(0,p.jsx)("div",{style:{color:r,fill:r},children:e.title}),icon:(0,p.jsx)(l.Z,{icon:s.R,styles:{fill:r}})})}))},6758:(e,t,o)=>{o.d(t,{Pq:()=>se,oe:()=>ne,bU:()=>ie});o(57658);var r=o(67294),i=o(83355),n=o(480),s=o(76205),l=o(68965),a=o(42853),p=o(56666),c=o(88437),d=o(62208),u=o(47453),h=o(37612),g=o(72126),m=o(97880),x=o(9291),f=o(36610),C=o(2005),y=o(97004),v=o(17335),S=o(87279),b=o(61766),j=o(13401),F=o(86628),M=o(80951),w=o(43690),Z=o(33929),T=o(98742),k=o(52275),V=o(14871),A=o(26388),_=o(64369),P=o(62045),R=o(85893);function I(e){window.__c={n:"CollectionFilterMenuDateFilterMode"};const{filter:t}=e,{isMobile:o}=(0,n.Fy)(),r=Z.default.getIntl(),i={width:190,menuTitle:r.formatMessage({defaultMessage:"Date Options",id:"database.filterMenu.mobileDateFilterModeMenu.title"}),items:s.T,selectedItem:(0,s.TX)(t),getKey:e=>e,onSelect:o=>{const r={...t,use_end:(0,s.UG)(o)};e.onChange(r)},renderItem:e=>(0,R.jsx)(A.ZP,{renderTooltip:()=>(0,v._T)(e.value),render:t=>(0,R.jsx)(k.Z,{title:(0,v.IF)(e.value),...(0,T.Z)(e,t)}),placement:A.ug.Right,textWrap:!0,style:{width:"260px"}}),renderOrigin:e=>(0,R.jsx)(P.Z,{...e,placeholder:r.formatMessage({defaultMessage:"Date Options",id:"database.filterMenu.dateFilterModeMenu.label"}),title:(0,R.jsx)(_.Z,{isMobile:o,children:(0,v.IF)((0,s.TX)(t))}),disableMargins:!0,desktopStyle:{width:"100px"}})};return(0,R.jsx)(V.Z,{...i,mobileActionSheet:!0},"date-filter-mode")}var O=o(34299);const B=(0,x.injectIntl)((function(e){window.__c={n:"CollectionFilterMenuFilterOperator"};const t=(0,n.O7)(),{filterValueType:o,filter:r,intl:i}=e,l=(0,s.xm)(o),a={width:190,menuTitle:i.formatMessage({defaultMessage:"Comparator",id:"database.filterMenu.mobileComparatorValueMenu.title"}),items:l,selectedItem:r.operator,getKey:e=>e,onSelect:i=>{const n=(0,v.li)(o,r,i,"combinator");e.onChange(n),f.wd(t,{view_type:e.collectionViewType,action:"set_filter_comparator"})},renderItem:e=>(0,R.jsx)(k.Z,{title:(0,v.WC)(e.value),...e}),renderOrigin:e=>(0,R.jsx)(P.Z,{...e,placeholder:i.formatMessage({defaultMessage:"Comparator",id:"database.filterMenu.comparatorMenuDropdownButton.label"}),title:(0,R.jsx)(_.Z,{isMobile:t.device.isMobile,children:(0,v.WC)(r.operator)}),disableMargins:!0})};return(0,R.jsx)(V.Z,{...a,mobileActionSheet:!0},"comparator")}));var D=o(49068);const L=(0,x.defineMessages)({setFilter:{defaultMessage:"Set filter",id:"database.filterMenu.rollupPropertyValue.mobileMenu.title"}});const H=(0,x.injectIntl)((function(e){window.__c={n:"LocalizableCollectionFilterMenuFilter"};const t=(0,n.O7)();if((0,s.a_)(e.filter))return(0,R.jsx)(W,{intl:e.intl,onChange:e.onChange,collectionViewType:e.collectionViewType,property:e.property,schema:e.schema,parentStore:e.parentStore,collectionViewId:e.collectionViewId,filter:e.filter});const o=(0,s.fI)({schema:e.schema,property:e.property,getRecordModel:e.parentStore.getRecordModel});if(!(0,s.ZB)(o,e.filter)){const t=(0,v.rn)(o);return(0,R.jsxs)(r.Fragment,{children:[(0,R.jsx)(B,{filterValueType:o,filter:t,collectionViewType:e.collectionViewType,onChange:e.onChange}),(0,R.jsx)(D.Z,{filterValueType:o,filter:t,schema:e.schema,property:e.property,parentStore:e.parentStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId,onChange:e.onChange})]})}const i=(0,R.jsx)(x.FormattedMessage,{...v.xe[o],values:{property:(0,R.jsx)(x.FormattedMessage,{id:"collectionFilterMenuFilter.property.name",defaultMessage:"Property"}),operator:(0,R.jsx)(B,{filterValueType:o,filter:e.filter,collectionViewType:e.collectionViewType,onChange:e.onChange}),operatorValue:(0,R.jsx)(D.Z,{filterValueType:o,filter:e.filter,schema:e.schema,property:e.property,parentStore:e.parentStore,collectionViewType:e.collectionViewType,collectionViewId:e.collectionViewId,onChange:e.onChange})}});return t.device.isMobile?i:(0,R.jsx)("div",{style:{alignItems:"center",display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",gridColumnEnd:e.isArrayFilter?void 0:"span 2",gridColumnGap:`${C.l0}px`,gridTemplateRows:`${C.fg}px`,gridTemplateColumns:"[value-start] max-content auto [value-end operator-start] auto"},children:i})})),G=H;function W(e){let{filter:t,intl:o,onChange:i,collectionViewType:l,property:a,schema:p,parentStore:c,collectionViewId:d}=e;window.__c={n:"ArrayFilterComponent"};const u=(0,n.O7)(),h={menuTitle:o.formatMessage(L.setFilter),items:s.Rf,getKey:e=>e,selectedItem:t.operator,onSelect:e=>{const o={...t,operator:e};i(o),f.wd(u,{view_type:l,action:"set_rollup_set_filter"})},renderItem:e=>(0,R.jsx)(k.Z,{title:(0,v.SW)(e.value,o),...e}),renderOrigin:e=>(0,R.jsx)(P.Z,{...e,placeholder:o.formatMessage(L.setFilter),title:(0,v.SW)(t.operator,o),disableMargins:!0,desktopStyle:{minWidth:70}})},{targetProperty:g,targetCollectionSchema:m}=(0,F.VK)((()=>{var e;if("rollup"===(null==p||null===(e=p[a])||void 0===e?void 0:e.type)){const e=(0,O.gT)({schema:p,property:a,getRecordModel:c.getRecordModel});return{targetProperty:null==e?void 0:e.targetProperty,targetCollectionSchema:null==e?void 0:e.targetCollectionSchema}}return{targetProperty:a,targetCollectionSchema:p}}),[a,p,c]);if(!g||!m)return(0,R.jsx)("div",{style:{gridColumnEnd:"span 2"}});const x=(0,R.jsxs)(r.Fragment,{children:[(0,R.jsx)(V.Z,{...h,mobileActionSheet:!0},"set_filter"),(0,R.jsx)(H,{collectionViewId:d,filter:t.subfilter,schema:m,property:g,parentStore:c,collectionViewType:l,onChange:e=>{const o={...t,subfilter:e};i(o)},isArrayFilter:!0})]});return u.device.isMobile?x:(0,R.jsx)("div",{style:{display:"grid",gridAutoFlow:"column",gridAutoColumns:"1fr",gridColumnEnd:"span 2",gridColumnGap:`${C.l0}px`,gridTemplateColumns:"max-content",gridTemplateRows:`${C.fg}px`},children:x})}var N=o(31945),K=o(77498),U=o(50542);const q=function(e){let{schema:t,propertyFilter:o,parentStore:i,index:l,collectionViewType:a,onChange:p,filterOperator:c,collectionViewId:d}=e;window.__c={n:"CollectionFilterMenuRow"};const u=(0,n.O7)(),{device:h}=u,g=(0,M.Qm)({schema:t,property:o.property}),m=(0,F.VK)((()=>(0,s.J5)(t,o.property,o.filter,i.getRecordModel)),[i,o,t]);if(!g)return null;if(!m)return null;const C=(0,s.gE)(o.filter)&&(0,s.vR)(o.filter)&&(0,s.c3)(g),y=C?{width:"120px",marginRight:"4px"}:{},S=(0,R.jsxs)(r.Fragment,{children:[(0,R.jsx)(N.ZP,{popupType:h.isMobile?N.Z4.SlideUp:N.Z4.Popup,renderOrigin:e=>(0,R.jsx)(U.Z,{...e,propertySchema:g,disableMargins:!0,textWrapperStyle:{width:"100%",...y}}),render:e=>(0,R.jsx)(K.Z,{isRelationProperty:!1,schema:t,onAccept:e=>function(e,t,o,r,i,n,l,a){const{property:p,filter:c}=r,d=o[p],u=o[e],h={property:e,filter:c},g=u&&(0,s.J5)(o,e,c,i.getRecordModel),m=u&&"relation"===u.type&&p!==e,x=d&&("created_by"===d.type||"last_edited_by"===d.type)&&u&&"person"===u.type,C=(0,s.Gb)(c)&&!(0,s.mv)(c)&&(0,s.R8)(c).some((e=>"exact"===e.type&&e.value&&"bot"===e.value.table));(!g||m||x&&C||!(0,w.dN)(h,o))&&(h.filter=(0,v.zZ)({schema:o,property:e,getRecordModel:i.getRecordModel}));null==a||a(n,h),f.wd(t,{view_type:l,action:"set_filter_property"})}(e,u,t,o,i,l,a,p),onClose:e.close,allowProperty:M.Kf})}),C&&(0,R.jsx)(I,{filter:o.filter,onChange:e=>{const t={...o,filter:e};null==p||p(l,t)}})]});return(0,R.jsxs)(r.Fragment,{children:[c,h.isMobile?S:(0,R.jsx)("div",{style:{display:"flex"},children:S}),(0,R.jsx)(x.FormattedMessage,{id:"collectionFilterMenuRow.propertyConjunction.label",defaultMessage:" "}),(0,R.jsx)(G,{filter:o.filter,schema:t,property:o.property,parentStore:i,collectionViewId:d,collectionViewType:a,onChange:e=>{const t={...o,filter:e};null==p||p(l,t)},isArrayFilter:!1})]})};function z(){return(0,R.jsx)(x.FormattedMessage,{defaultMessage:"Add filter rule",id:"database.filterMenu.addFilterRuleButtonTitle"})}const E=(0,x.defineMessages)({operatorPlaceholder:{defaultMessage:"Operator",id:"database.filterMenu.operatorPlaceholder"}});const Q=(0,x.injectIntl)((function(e){const{intl:t,filterOperator:o,onChange:r,disableMargins:i}=e,n={width:"auto",menuTitle:t.formatMessage({defaultMessage:"Operator",id:"database.filterMenu.filterOperatorMenu.title"}),items:s.Uz,getKey:e=>e,selectedItem:o,onSelect:r,renderItem:e=>(0,R.jsx)(k.Z,{title:(0,v.KV)(e.value,t),caption:(0,v.Qz)(e.value,t),...e}),renderOrigin:e=>(0,R.jsx)(P.Z,{...e,title:o&&(0,v.KV)(o,t),placeholder:t.formatMessage(E.operatorPlaceholder),disableMargins:i})};return(0,R.jsx)(V.Z,{...n,mobileActionSheet:!0},"operator")}));var $=o(31339),J=o(8982),X=o(73063),Y=o(78140),ee=o(32163),te=o(40721),oe=o(53437),re=o(72495);const ie=170,ne=400;class se extends i.Z{constructor(){super(...arguments),this.buttonPopupStores=[],this.renderChildFilter=(e,t)=>{const o=this.environment.device.isMobile;return(0,s.vA)(e)?o?this.renderMobileCombinatorFilter(e,t):this.renderDesktopCombinatorFilter(e,t):(0,s.aN)(e)?o?this.renderMobilePropertyFilter(e,t):this.renderDesktopPropertyFilter(e,t):void 0},this.renderCombinatorActions=()=>{const{device:e}=this.environment;if(e.isMobile)return(0,R.jsxs)(re.Z,{topBorder:ge(this.props.combinatorFilter,this.props.level),children:[(0,R.jsx)(me,{props:{onClick:()=>Ce(this.environment,this.props.schema,this.props.combinatorFilter,this.props.onChange,this.props.index,this.props.collectionViewType)}}),de(this.props.level)&&(0,R.jsx)(xe,{props:{onClick:this.handleAddFilterGroupClick}})]});const t={height:32},o={padding:`${C.cn}px 0`};return de(this.props.level)?(0,R.jsx)(re.Z,{topBorder:ge(this.props.combinatorFilter,this.props.level),desktopStyle:o,children:(0,R.jsx)(N.ZP,{alignmentToOrigin:oe.ZP.Alignment.Start,popupType:oe.ZP.PopupType.Popup,renderOrigin:e=>(0,R.jsx)(J.i,{action:()=>e.onClick(),render:o=>{const{focused:r,...i}=o;return(0,R.jsx)(j.Z,{...e,...i,focused:r,isBlue:!1,style:t,title:(0,R.jsxs)("div",{children:[(0,R.jsx)(z,{}),(0,a.i)({width:10,marginLeft:6,display:"inline"})]})})}}),render:e=>(0,R.jsx)(ee.Z,{type:ee.i.Vertical,initialFocus:0,sections:[{key:"actions",render:e=>(0,R.jsx)(re.Z,{...e}),items:[{key:"add_filter",render:e=>(0,R.jsx)(me,{props:e}),action:t=>{e.close(),Ce(this.environment,this.props.schema,this.props.combinatorFilter,this.props.onChange,this.props.index,this.props.collectionViewType)}},{key:"add_filter_group",render:e=>(0,R.jsx)(xe,{props:e}),action:t=>{e.close(),this.handleAddFilterGroupClick()}}]}]})})}):(0,R.jsx)(re.Z,{topBorder:ge(this.props.combinatorFilter,this.props.level),desktopStyle:o,children:(0,R.jsx)(J.i,{action:()=>Ce(this.environment,this.props.schema,this.props.combinatorFilter,this.props.onChange,this.props.index,this.props.collectionViewType),render:e=>{const{focused:o,...r}=e;return(0,R.jsx)(j.Z,{...r,focused:e.focused,isBlue:!1,style:t,onClick:()=>Ce(this.environment,this.props.schema,this.props.combinatorFilter,this.props.onChange,this.props.index,this.props.collectionViewType),title:(0,R.jsx)(z,{})})}})})},this.handleAddFilterGroupClick=()=>{const e=ue(this.props.schema,this.props.combinatorFilter),t={operator:ce(this.props.combinatorFilter),filters:[e]},o=he((e=>e.push(t)),this.props.combinatorFilter,this.props.onChange,this.props.index);this.openIndex(o-1),f.wd(this.environment,{view_type:this.props.collectionViewType,action:"add_filter_group"})}}willUnmount(){this.buttonPopupStores=[]}renderComponent(){const{combinatorFilter:e}=this.props,{device:t}=this.environment,o=(e.filters??[]).flatMap((e=>(0,s.Mm)(e)?[]:[e]));return(0,R.jsxs)(r.Fragment,{children:[ge(this.props.combinatorFilter,this.props.level)?void 0:(0,R.jsx)("div",{style:t.isMobile?void 0:{display:"grid",gridTemplateColumns:`\n             [boolean-start] 60px\n             [boolean-end property-start] minmax(min-content, 120px)\n             [property-end operator-start] 110px\n             [operator-end value-start] auto\n             [value-end menu-start] ${C.fg}px\n             [menu-end]\n        `,gridAutoRows:`minmax(${C.fg}px, auto)`,gridColumnGap:C.l0,gridRowGap:C.cn,padding:`${C.cn}px ${C.l0}px 0 ${C.l0}px`,justifyItems:"stretch",alignItems:"start"},children:o.map(this.renderChildFilter)}),this.renderCombinatorActions()]})}renderDesktopPropertyFilter(e,t){return(0,R.jsxs)(r.Fragment,{children:[(0,R.jsx)(q,{index:t,propertyFilter:e,schema:this.props.schema,filterOperator:(0,R.jsx)(ye,{combinatorFilter:this.props.combinatorFilter,onChange:this.props.onChange,index:this.props.index,collectionViewType:this.props.collectionViewType,newIndex:t}),parentStore:this.props.parentStore,onChange:(e,t)=>fe(e,t,this.props.combinatorFilter,this.props.onChange,this.props.index),collectionViewType:this.props.collectionViewType,collectionViewId:this.props.collectionViewId},t),this.renderRowActions(e,t)]},t)}renderMobilePropertyFilter(e,t){return(0,R.jsxs)(r.Fragment,{children:[(0,R.jsx)(ye,{combinatorFilter:this.props.combinatorFilter,onChange:this.props.onChange,index:this.props.index,collectionViewType:this.props.collectionViewType,newIndex:t}),(0,R.jsxs)(re.Z,{title:(0,R.jsx)(x.FormattedMessage,{defaultMessage:"Filter {index}",id:"database.filterMenu.filterIndex",values:{index:t+1}}),children:[(0,R.jsx)(q,{index:t,propertyFilter:e,schema:this.props.schema,filterOperator:null,parentStore:this.props.parentStore,onChange:(e,t)=>fe(e,t,this.props.combinatorFilter,this.props.onChange,this.props.index),collectionViewType:this.props.collectionViewType,collectionViewId:this.props.collectionViewId},t),this.renderRowActions(e,t)]})]},t)}renderDesktopCombinatorFilter(e,t){const o={gridColumn:"property-start / value-end",...(i=this.theme,{background:i.filterGroupBackground,borderRadius:4,boxShadow:`0 0 0 1px ${i.filterGroupBorder}`,margin:1,alignSelf:"stretch"})};var i;return(0,R.jsxs)(r.Fragment,{children:[(0,R.jsx)(ye,{combinatorFilter:this.props.combinatorFilter,onChange:this.props.onChange,index:this.props.index,collectionViewType:this.props.collectionViewType,newIndex:t}),(0,R.jsx)("div",{style:o,children:(0,R.jsx)(se,{index:t,level:this.props.level+1,combinatorFilter:e,onChange:(e,t)=>fe(e,t,this.props.combinatorFilter,this.props.onChange,this.props.index),parentStore:this.props.parentStore,schema:this.props.schema,collectionViewType:this.props.collectionViewType,collectionViewId:this.props.collectionViewId})}),this.renderRowActions(e,t)]},t)}renderMobileCombinatorFilter(e,t){const o=(e.filters||[]).length,i=(0,R.jsx)(x.FormattedMessage,{defaultMessage:"Filter Group {index}",id:"database.filterMenu.filterGroupIndex",values:{index:t+1}});return(0,R.jsxs)(r.Fragment,{children:[(0,R.jsx)(ye,{combinatorFilter:this.props.combinatorFilter,onChange:this.props.onChange,index:this.props.index,collectionViewType:this.props.collectionViewType,newIndex:t}),(0,R.jsxs)(re.Z,{title:i,children:[(0,R.jsx)(N.ZP,{buttonPopupStore:this.getButtonPopupStore(t),popupType:N.Z4.SlideUp,renderOrigin:t=>(0,R.jsx)(k.Z,{focused:!1,...t,showExtensionArrow:!0,right:o.toString(),title:(0,v.qh)({filter:e,schema:this.props.schema})}),render:o=>(0,R.jsx)(Y.Z,{menuType:S.og.Modal,title:i,left:(0,R.jsx)(te.BackMenuText,{}),onClickLeft:o.close,children:(0,R.jsx)(se,{index:t,level:this.props.level+1,combinatorFilter:e,onChange:(e,t)=>fe(e,t,this.props.combinatorFilter,this.props.onChange,this.props.index),parentStore:this.props.parentStore,schema:this.props.schema,collectionViewType:this.props.collectionViewType,collectionViewId:this.props.collectionViewId})})}),this.renderRowActions(e,t)]})]},t)}renderRowActions(e,t){return this.environment.device.isMobile?this.renderRowActionMenuItems(e,t,void 0):(0,R.jsx)(N.ZP,{popupType:oe.ZP.PopupType.Popup,renderOrigin:e=>(0,R.jsx)(J.i,{action:()=>e.onClick(),render:e=>(0,R.jsx)(X.Z,{...e,hovered:e.focused,style:{width:"100%",height:32},icon:p.o})}),render:o=>this.renderRowActionMenuItems(e,t,o)})}renderRowActionMenuItems(e,t,o){const r=(0,s.vA)(e),i=r?(0,R.jsx)(x.FormattedMessage,{defaultMessage:"Remove",id:"database.filterMenu.removeFilterGroupMenuTitle"}):(0,R.jsx)(x.FormattedMessage,{defaultMessage:"Remove",id:"database.filterMenu.removeFilterMenuTitle"}),n=r?(0,R.jsx)(x.FormattedMessage,{defaultMessage:"Duplicate",id:"database.filterMenu.duplicateFilterGroupMenuTitle"}):(0,R.jsx)(x.FormattedMessage,{defaultMessage:"Duplicate",id:"database.filterMenu.duplicateFilterMenuTitle"}),l=[{key:"delete",action:()=>{o&&o.close(),this.handleDeleteFilter(t)},render:e=>(0,R.jsx)(k.Z,{...e,icon:(0,R.jsx)(pe,{icon:h.y}),isRedOnHover:!0,title:i})},{key:"duplicate",action:()=>{o&&o.close(),function(e,t,o,r,i,n){he((t=>{const o=t[e];if(o){const r={...o};t.splice(e,0,r)}}),t,o,r),f.wd(n,{view_type:i,action:"duplicate_filter"})}(t,this.props.combinatorFilter,this.props.onChange,this.props.index,this.props.collectionViewType,this.environment)},render:e=>(0,R.jsx)(k.Z,{...e,icon:(0,R.jsx)(pe,{icon:c.a}),title:n})}];if((0,s.aN)(e)&&de(this.props.level)&&l.push({key:"turn_into_group",action:()=>{o&&o.close(),this.handleTurnIntoGroup(t,e)},render:e=>(0,R.jsx)(k.Z,{...e,icon:(0,R.jsx)(pe,{icon:d.z}),title:(0,R.jsx)(x.FormattedMessage,{defaultMessage:"Turn into group",id:"database.filterMenu.turnIntoGroupMenuTitle"})})}),(0,s.vA)(e)&&e.filters&&1===e.filters.length){const r=(0,s.vA)(e.filters[0])?(0,R.jsx)(x.FormattedMessage,{defaultMessage:"Unwrap group",id:"database.filterMenu.unwrapGroupMenuTitle"}):(0,R.jsx)(x.FormattedMessage,{defaultMessage:"Turn into filter",id:"database.filterMenu.turnIntoFilterMenuTitle"});l.push({key:"turn_into_filter",action:()=>{o&&o.close(),function(e,t,o,r,i,n,l){const a=g.Ps(t.filters||[]);a&&!(0,s.Mm)(a)&&fe(e,a,r,i,n);f.wd(o,{view_type:l,action:"turn_into_filter"})}(t,e,this.environment,this.props.combinatorFilter,this.props.onChange,this.props.index,this.props.collectionViewType)},render:e=>(0,R.jsx)(k.Z,{...e,icon:(0,R.jsx)(pe,{icon:d.z}),title:r})})}const a=le(e);return(0,s.vA)(e)&&this.props.level+a+1<3&&l.push({key:"wrap_in_group",action:()=>{o&&o.close(),this.handleTurnIntoGroup(t,e)},render:e=>(0,R.jsx)(k.Z,{...e,icon:(0,R.jsx)(pe,{icon:d.z}),title:(0,R.jsx)(x.FormattedMessage,{defaultMessage:"Wrap in group",id:"database.filterMenu.wrapInGroupMenuTitle"}),caption:(0,R.jsx)(x.FormattedMessage,{defaultMessage:"Create a filter group around this",id:"database.filterMenu.wrapInGroupMenuCaption"})})}),(0,R.jsx)(ee.Z,{initialFocus:this.environment.device.isMobile?void 0:0,type:ee.i.Vertical,sections:[{key:"actions",render:this.environment.device.isMobile?e=>(0,R.jsx)("div",{...e}):e=>(0,R.jsx)(re.Z,{...e}),items:l}]})}handleTurnIntoGroup(e,t){fe(e,{operator:ce(this.props.combinatorFilter),filters:[t]},this.props.combinatorFilter,this.props.onChange,this.props.index),this.openIndex(e),f.wd(this.environment,{view_type:this.props.collectionViewType,action:"turn_into_filter_group"})}handleDeleteFilter(e){he((t=>t.splice(e,1)),this.props.combinatorFilter,this.props.onChange,this.props.index),this.getButtonPopupStore(e).reset(),this.buttonPopupStores.splice(e,1)}openIndex(e){this.getButtonPopupStore(e).setState({open:!0})}getButtonPopupStore(e){for(;this.buttonPopupStores.length<e+1;){const e=new b.Z;this.buttonPopupStores.push(e)}return this.buttonPopupStores[e]}}function le(e){if((0,s.vA)(e)){const t=(e.filters||[]).filter(s.vA);return 1+(g.Fp(t.map(le))||0)}return 0}function ae(e){const{operator:t,lowercase:o}=e;return"or"===t?o?(0,R.jsx)(x.FormattedMessage,{id:"collectionFilterCombinatorGrid.filterOperator.or.lowercase",defaultMessage:"or"}):(0,R.jsx)(x.FormattedMessage,{id:"collectionFilterCombinatorGrid.filterOperator.or",defaultMessage:"Or"}):"and"===t?o?(0,R.jsx)(x.FormattedMessage,{id:"collectionFilterCombinatorGrid.filterOperator.and.lowercase",defaultMessage:"and"}):(0,R.jsx)(x.FormattedMessage,{id:"collectionFilterCombinatorGrid.filterOperator.and",defaultMessage:"And"}):(0,m.t1)(t)}function pe(e){let{icon:t,styles:o}=e;return(0,R.jsx)($.Z,{icon:t,styles:o})}function ce(e){return"or"===e.operator?"and":"or"}function de(e){return e<2}function ue(e,t){const o=(t.filters||[]).filter(s.aN),r=o[o.length-1];return r?g.Xh(r):(0,y.Me)(e)}function he(e,t,o,r){const i=[...t.filters||[]],n=e(i);return o(r,{...t,filters:i}),n}function ge(e,t){return(0,s.$1)(e)&&0===t}function me(e){let{props:t}=e;const o=(0,R.jsx)(pe,{icon:u.R});return(0,R.jsx)(k.Z,{focused:!1,...t,icon:o,title:(0,R.jsx)(z,{})})}function xe(e){let{props:t}=e;const o=(0,R.jsx)(pe,{icon:l.t});return(0,R.jsx)(k.Z,{focused:!1,...t,icon:o,title:(0,R.jsx)(x.FormattedMessage,{defaultMessage:"Add filter group",id:"database.filterMenu.addFilterGroup2ButtonTitle"}),caption:(0,R.jsx)(x.FormattedMessage,{defaultMessage:"A group to nest more filters",id:"database.filterMenu.addFilterGroupButtonCaption"})})}function fe(e,t,o,r,i){he((o=>o.splice(e,1,t)),o,r,i)}function Ce(e,t,o,r,i,n){const s=ue(t,o);he((e=>e.push(s)),o,r,i),f.wd(e,{view_type:n,action:"add_filter"})}function ye(e){let{newIndex:t,combinatorFilter:o,onChange:r,index:i,collectionViewType:s}=e;window.__c={n:"CombinatorOperatorComponent"};const l=(0,n.O7)(),a=o.operator,{device:p}=l,c={justifySelf:"end"},d={...c,lineHeight:"32px",paddingRight:4};if(0===t)return p.isMobile?null:(0,R.jsx)(_.Z,{style:d,children:(0,R.jsx)(x.FormattedMessage,{defaultMessage:"Where",id:"database.filterMenu.where"})});if(1===t){const e=(0,R.jsx)(Q,{disableMargins:!0,filterOperator:a,onChange:e=>function(e,t,o,r,i,n){r(i,{...o,operator:e}),f.wd(t,{view_type:n,action:"set_filter_operator"})}(e,l,o,r,i,s)});return l.device.isMobile?(0,R.jsx)(re.Z,{children:e}):(0,R.jsx)("div",{style:c,children:e})}return p.isMobile?null:(0,R.jsx)(_.Z,{style:d,children:(0,R.jsx)(ae,{operator:a})})}se.displayName="CollectionFilterCombinatorGrid"},49068:(e,t,o)=>{o.d(t,{Z:()=>Q,$:()=>E});var r=o(67294),i=o(83355),n=o(480),s=o(86628),l=o(66897),a=o(76205),p=o(99036),c=o(80951),d=o(84619),u=o(40506),h=o(76725),g=o(96367),m=o(97880),x=o(82990),f=o(9291),C=o(36610),y=o(2005),v=o(17335),S=o(5691),b=o(29376),j=o(79797),F=o(6758),M=o(56416),w=o(68834),Z=o(24405),T=o(33929),k=o(8982),V=o(36488),A=o(74194),_=o(68894),P=o(85893);const R=(0,f.defineMessages)({value:{defaultMessage:"Value",id:"database.filterAndSort.propertyValueInput.placeholder"}});function I(e){let{value:t,onChange:o}=e;window.__c={n:"CollectionOperatorValueInput"};const{device:i}=(0,n.O7)(),s=(0,r.useRef)(null),[l,a]=(0,r.useState)(!1),p=(0,r.useCallback)((()=>a(!0)),[a]),c=(0,r.useCallback)((()=>a(!1)),[a]),d=(0,r.useCallback)((e=>{o(e.target.value)}),[o]),u=(0,r.useCallback)((()=>{s.current&&(s.current.handleBlur(),c())}),[c]),h=(0,Z.yK)((e=>({focused:{background:e.buttonHoveredBackground},unfocused:{background:"transparent"}})),[]),g=t||"";return(0,P.jsx)("div",{style:{display:"flex",margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},onClick:p,children:i.isMobile?(0,P.jsx)(_.ZP,{value:g,onChange:d,placeholder:T.default.formatMessage(R.value),onBlur:c,rightMobileEditLabel:(0,P.jsx)(f.FormattedMessage,{defaultMessage:"Edit",id:"database.filterAndSort.mobileEditButton.label"})}):(0,P.jsx)(k.i,{action:p,render:e=>(0,P.jsx)("div",{ref:e.ref,onMouseEnter:e.onMouseEnter,style:{...e.focused&&!l?h.focused:h.unfocused,margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},children:(0,P.jsx)(V.Z,{capture:l,render:e=>(0,P.jsx)("div",{...e,style:{margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},children:(0,P.jsx)(A.Z,{focus:l,ref:s,value:g,onChange:d,placeholder:T.default.formatMessage(R.value),onBlur:c,onCancel:u,style:{marginRight:8,paddingLeft:6,paddingRight:0,width:80,height:30,...{margin:0,width:"100%",height:"100%",transition:"background 120ms ease-in"},minWidth:F.bU}})})})})})})}I.displayName="CollectionOperatorValueInput";var O=o(52275),B=o(31945),D=o(60458),L=o(14871),H=o(92864),G=o(89845),W=o(62045),N=o(25845),K=o(14390),U=o(22084);const q=(0,f.defineMessages)({dateTitle:{defaultMessage:"Date",id:"database.filterMenu.mobileDateSelectMenu.title"},emptyPlaceholder:{defaultMessage:"Empty",id:"database.filterMenu.dateSelectMenu.emptyPlaceholder"}});class z extends i.Z{constructor(){super(...arguments),this.getRelatedCollectionAppConfigUri=this.createComputedStore((()=>{const{schema:e,property:t,parentStore:o}=this.props,r=e[t];if(r&&(0,p.p_)(r))return(0,b.ke)(r,o)}))}renderComponent(){const{filter:e,property:t,collectionViewId:o,schema:r,parentStore:i}=this.props,n=this.props.filterValueType,s=(0,P.jsx)("span",{});if("date"===n)return(0,a.gE)(e)?(0,a.mv)(e)?s:(0,a.TQ)(e)?(0,P.jsx)(ie,{intl:this.props.intl,parentStore:this.props.parentStore,schema:this.props.schema,collectionViewId:this.props.collectionViewId,property:this.props.property,onChange:this.props.onChange,collectionViewType:this.props.collectionViewType,filter:e}):(0,P.jsx)(re,{intl:this.props.intl,collectionViewId:this.props.collectionViewId,property:this.props.property,schema:this.props.schema,parentStore:this.props.parentStore,onChange:this.props.onChange,collectionViewType:this.props.collectionViewType,filter:e}):s;if("text"===n){if(!(0,a.Ly)(e))return s;const t=e;if((0,a.mv)(t))return s;if("string_has_no_alphabet_prefix"===t.operator)return;const o=t.value;return(0,P.jsx)(I,{value:o.value,onChange:e=>{const o={type:"exact",value:e},r={...t,value:o};this.props.onChange(r)}})}if("number"===n){if(!(0,a.h6)(e))return s;const t=e;if((0,a.mv)(t))return s;const o=t.value;return(0,P.jsx)(I,{value:void 0===o.value?"":o.value.toString(),onChange:e=>{const o={type:"exact",value:(0,S.m)(e,this.props.intl)},r={...t,value:o};this.props.onChange(r)}})}if("checkbox"===n){if(!(0,a.XA)(e)||!o)return s;const n=e,l=n.value;return(0,P.jsx)(B.ZP,{popupType:this.environment.device.isMobile?B.Z4.SlideUp:B.Z4.Popup,renderOrigin:e=>(0,P.jsx)(X,{operatorValue:l,events:e}),render:e=>(0,P.jsx)(M.ZP,{collectionViewId:o,propertyFilter:{property:t,filter:n},schema:r,onChange:e=>{this.props.onChange(e)},onClose:e.close,parentStore:i,context:M.Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}if("select"===n||"multi_select"===n||"status"===n){if(!((0,a.dx)(e)||(0,a.NU)(e)||(0,a.r2)(e))||!o)return s;const n=e;if((0,a.mv)(n))return s;const l=this.props.schema[this.props.property];if(!l)return s;const p=(0,a.dx)(n)?(0,a.mg)(n):(0,a.NU)(n)?(0,a.qC)(n):(0,a.Js)(l,(0,a.wB)(n));return(0,P.jsx)(B.ZP,{popupType:this.environment.device.isMobile?B.Z4.SlideUp:B.Z4.Popup,renderOrigin:e=>(0,P.jsx)(oe,{schema:this.props.schema,property:this.props.property,operatorValues:p,events:e}),render:e=>(0,P.jsx)(M.ZP,{collectionViewId:o,propertyFilter:{property:t,filter:n},schema:r,onChange:e=>{this.props.onChange(e)},onClose:e.close,parentStore:i,context:M.Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}if("location"===n){if(!(0,a.Mp)(e))return s;const n=e,l=(0,a.u0)(n);return(0,P.jsx)(B.ZP,{popupType:this.environment.device.isMobile?B.Z4.SlideUp:B.Z4.Popup,renderOrigin:e=>(0,P.jsx)(ee,{parentStore:this.props.parentStore,operatorValues:l,events:e}),render:e=>(0,P.jsx)(M.ZP,{collectionViewId:o,propertyFilter:{property:t,filter:n},schema:r,onChange:e=>{this.props.onChange(e)},onClose:e.close,parentStore:i,context:M.Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}if("relation"===n){if(!(0,a.e)(e)||!o)return s;const n=e;if((0,a.mv)(n))return s;const l=(0,a.YO)(n);return(0,P.jsx)(B.ZP,{popupType:this.environment.device.isMobile?B.Z4.SlideUp:B.Z4.Popup,renderOrigin:e=>this.renderRelationOrigin(l,e),render:e=>(0,P.jsx)(M.ZP,{collectionViewId:o,propertyFilter:{property:t,filter:n},schema:r,onChange:e=>{this.props.onChange(e)},onClose:e.close,parentStore:i,context:M.Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}if("person"===n){if(!(0,a.Gb)(e)||!o)return s;const n=e;if((0,a.mv)(n))return s;const l=(0,a.R8)(n);return(0,P.jsx)(B.ZP,{popupType:this.environment.device.isMobile?B.Z4.SlideUp:B.Z4.Popup,renderOrigin:e=>(0,P.jsx)(se,{parentStore:this.props.parentStore,operatorValues:l,events:e}),render:e=>(0,P.jsx)(M.ZP,{collectionViewId:o,propertyFilter:{property:t,filter:n},schema:r,onChange:e=>{this.props.onChange(e)},onClose:e.close,parentStore:i,context:M.Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}if("file"===n){if(!(0,a.W6)(e))return s;const t=e;if((0,a.mv)(t))return s;(0,m.t1)(t)}if("verification"===n)return(0,a.Jw)(e)?(0,P.jsx)(B.ZP,{popupType:this.environment.device.isMobile?B.Z4.SlideUp:B.Z4.Popup,renderOrigin:t=>(0,P.jsx)(Y,{operatorValues:(0,a.fl)(e),events:t}),render:n=>(0,P.jsx)(M.ZP,{collectionViewId:o,propertyFilter:{property:t,filter:e},schema:r,onChange:e=>{this.props.onChange(e)},onClose:n.close,parentStore:i,context:M.Qv.AdvancedFilter,allowRelativePersonFilter:!1})}):s;(0,m.t1)(n)}renderRelationOrigin(e,t){const{device:o}=this.environment;return(0,P.jsx)(W.Z,{...t,disableMargins:!0,desktopStyle:$(),innerStyle:J(e.length>0),placeholder:(0,P.jsx)(f.FormattedMessage,{defaultMessage:"Select a page",id:"databaseRelationOperators.selectPlaceholder"}),title:e.length>0&&e.map(((e,t)=>{if(!e.value)return;const r=e.type,i={isSingle:!1,shouldShrink:!1,format:o.isMobile?d.lo.Large:d.lo.Medium};if("exact"===r)return(0,P.jsx)(N.Z,{blockId:e.value,parentStore:this.props.parentStore,...i},e.value);if("relative"===r){const o=this.getRelatedCollectionAppConfigUri.state;if(!o)return;return(0,P.jsx)(d.ZP,{value:(0,P.jsx)(f.FormattedMessage,{...g.qB[o][e.value.variable].messageDescriptor}),backgroundColor:"transparent",theme:this.theme,...i},t)}(0,m.t1)(r)}))})}}function E(e){return e?(0,P.jsx)(f.FormattedMessage,{defaultMessage:"Select one person",id:"database.personPropertyValue.selectPerson.searchPlaceholderWithLimit"}):(0,P.jsx)(f.FormattedMessage,{defaultMessage:"Select one or more people",id:"database.personPropertyValue.selectPerson.searchPlaceholder"})}z.displayName="CollectionFilterMenuFilterOperatorValue";const Q=(0,f.injectIntl)(z);function $(){return{maxWidth:F.oe}}function J(e){return{paddingTop:e?6:void 0,overflow:"hidden"}}function X(e){let{operatorValue:t,events:o}=e;const r=null==t?void 0:t.value;return(0,P.jsx)(W.Z,{...o,disableMargins:!0,placeholder:(0,P.jsx)(f.FormattedMessage,{defaultMessage:"Select a value",id:"database.filterOperatorValue.checkboxPlaceholder.title"}),title:"boolean"==typeof r&&(0,P.jsx)(D.Z,{checked:r,size:16,disabled:!0})})}function Y(e){let{operatorValues:t,events:o}=e;const r=t.filter((e=>{let{value:t}=e;return Boolean(t)})).map(v.cq);return(0,P.jsx)(W.Z,{...o,disableMargins:!0,placeholder:(0,P.jsx)(f.FormattedMessage,{defaultMessage:"Select an option",id:"CollectionFilterMenuFilterOperatorValue.verificationFilterSelect.placeholder"}),title:r.length&&(0,P.jsx)("span",{children:(0,h.Z)(r,(e=>(0,P.jsx)("span",{style:{whiteSpace:"pre"},children:(0,P.jsx)(f.FormattedMessage,{defaultMessage:", ",id:"CollectionFilterMenuFilterOperatorValue.verificationFilterSelect.commaSeparator"})},e)))})})}function ee(e){let{operatorValues:t,events:o,parentStore:r}=e;return(0,P.jsx)(W.Z,{...o,disableMargins:!0,desktopStyle:$(),innerStyle:J(t.length>0),placeholder:(0,P.jsx)(f.FormattedMessage,{defaultMessage:"Select a location",id:"databaseLocationOperators.selectPlaceholder"}),title:t.length>0&&t.map((e=>e.value&&(0,P.jsx)("div",{style:{margin:"0 10px 6px 0"},children:(0,P.jsx)(w.Z,{collectionStore:j.NW.createChildStore(r,{table:"collection",id:e.value})})},e.value)))})}function te(e){let{operatorValue:t,events:o,isRange:r,schema:i,property:n}=e;const s=i[n],l=s&&"date"===s.type?s.date_format:void 0;let a;if("exact"===t.type&&t.value)if((0,u.J_)(t.value))a=t.value;else if((0,u.gR)(t.value)){const e=(0,u.Gc)(t.value);e&&(a=e.value)}return(0,P.jsx)(W.Z,{...o,placeholder:r?(0,P.jsx)(f.FormattedMessage,{defaultMessage:"Select a range",id:"database.filterAndSort.dateRangePropertyValue.placeholder"}):(0,P.jsx)(f.FormattedMessage,{defaultMessage:"Select a date",id:"database.filterAndSort.datePropertyValue.placeholder"}),desktopStyle:{minWidth:165},title:a&&(0,P.jsx)("span",{style:{...x.Z.textOverflowStyle},children:(0,P.jsx)(G.Z,{value:a,dateFormat:l||u.sF})}),disableMargins:!0})}function oe(e){let{operatorValues:t,events:o,schema:r,property:i}=e;window.__c={n:"SelectOrigin"};const s=(0,n.O7)(),{device:l}=s,a=r[i],u=a&&((0,p.cu)(a)||"status"===a.type)&&a.options||[];return(0,P.jsx)(W.Z,{...o,disableMargins:!0,desktopStyle:$(),innerStyle:J(t.length>0),placeholder:(0,P.jsx)(f.FormattedMessage,{defaultMessage:"Select an option",id:"collections.operatorValueSelect.placeholder"}),title:t.length>0&&(0,P.jsx)(P.Fragment,{children:t.map((e=>{if(void 0===e.value)return null;const t=(0,c.i7)(u,e.value);return t?(0,P.jsx)(U.a,{format:l.isMobile?d.lo.Large:d.lo.Medium,isSingle:!1,value:t.value,color:t.color,showRemoveButton:!1},e.value):null}))})})}function re(e){let{filter:t,intl:o,collectionViewId:i,property:s,schema:l,parentStore:p,onChange:c,collectionViewType:d}=e;window.__c={n:"DateFilterOperatorValueComponent"};const u=(0,n.O7)();if(!i)return null;const h={menuTitle:o.formatMessage(q.dateTitle),items:a.tO,getKey:e=>"relative"===e.type?e.value:e.type,selectedItem:t.value,onSelect:e=>{const o={...t,value:e};c(o),C.wd(u,{view_type:d,action:"set_filter_value_type"})},renderItem:e=>(0,P.jsx)(O.Z,{title:(0,v.x)(e.value),...e}),renderOrigin:e=>(0,P.jsx)(W.Z,{...e,disableMargins:!0,placeholder:o.formatMessage(q.emptyPlaceholder),title:(0,v.x)(t.value)})},g=t.value;if("exact"===g.type){const e=(0,P.jsx)(r.Fragment,{children:(0,P.jsx)(f.FormattedMessage,{id:"collectionFilterMenuFilterOperatorValue.date.exact.order",defaultMessage:"{exact}{dateValue}",values:{exact:(0,P.jsx)(L.Z,{...h,mobileActionSheet:!0},"date-filter-value-type"),dateValue:(0,P.jsx)(B.ZP,{popupType:u.device.isMobile?B.Z4.SlideUp:B.Z4.Popup,renderOrigin:e=>(0,P.jsx)(te,{schema:l,property:s,operatorValue:g,events:e,isRange:!1}),render:e=>(0,P.jsx)(M.ZP,{collectionViewId:i,propertyFilter:{property:s,filter:t},schema:l,onChange:e=>{c(e)},onClose:e.close,parentStore:p,context:M.Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}})}),o=u.device.isDesktop?{display:"grid",justifyContent:"stretch",gridTemplateColumns:"1fr 1fr",gridColumnGap:y.l0,width:"100%"}:void 0;return(0,P.jsx)("div",{style:o,children:e})}return(0,P.jsx)(L.Z,{...h,mobileActionSheet:!0},"date-filter-value-type")}function ie(e){let{filter:t,intl:o,parentStore:i,schema:s,collectionViewId:l,property:p,onChange:c,collectionViewType:d}=e;window.__c={n:"DateRangeFilterOperatorValueComponent"};const u=(0,n.O7)();if(!l)return null;const h={menuTitle:o.formatMessage(q.dateTitle),items:(0,a.bS)(),getKey:e=>(0,a.eX)(e),selectedItem:t.value,onSelect:e=>{const o={...t,value:e};c(o),C.wd(u,{view_type:d,action:"set_filter_value_type"})},renderItem:e=>(0,P.jsx)(O.Z,{title:(0,v.ip)(e.value),...e}),renderOrigin:e=>(0,P.jsx)(W.Z,{...e,disableMargins:!0,placeholder:o.formatMessage(q.emptyPlaceholder),title:(0,v.ip)(t.value)})},g=t.value;if("exact"===g.type){const e=(0,P.jsx)(r.Fragment,{children:(0,P.jsx)(f.FormattedMessage,{id:"collectionFilterMenuFilterOperatorValue.dateRange.exact.order",defaultMessage:"{dateValue}",values:{exact:(0,P.jsx)(L.Z,{...h,mobileActionSheet:!0},"date-filter-value-type"),dateValue:(0,P.jsx)(B.ZP,{popupType:u.device.isMobile?B.Z4.SlideUp:B.Z4.Popup,renderOrigin:e=>(0,P.jsx)(te,{schema:s,property:p,operatorValue:g,events:e,isRange:!0}),render:e=>(0,P.jsx)(M.ZP,{collectionViewId:l,propertyFilter:{property:p,filter:t},schema:s,onChange:e=>{c(e)},onClose:e.close,parentStore:i,context:M.Qv.AdvancedFilter,allowRelativePersonFilter:!0})})}})}),o=u.device.isDesktop?{display:"grid",justifyContent:"stretch",gridTemplateColumns:"1fr 1fr",gridColumnGap:y.l0,width:"100%"}:void 0;return(0,P.jsx)("div",{style:o,children:e})}return"relative"!==g.type||"custom"!==g.value&&"surrounding"!==g.value?(0,P.jsx)(L.Z,{...h,mobileActionSheet:!0},"date-filter-value-type"):(0,P.jsx)(K.b,{renderAsQueryDropdown:u.device.isMobile,filter:g,onUpdate:e=>{const o={...t,value:e};c(o),C.wd(u,{view_type:d,action:"set_filter_value_type"})}})}function ne(e){var t;let{operatorValue:o,parentStore:r}=e;window.__c={n:"PersonInnerComponent"};const i=(0,n.O7)(),{device:a}=i,p=(0,s.VK)((()=>!o.value||"relative"===o.type&&"me"===o.value?void 0:(0,l.Hl)({pointer:o.value,getRecordValue:r.getRecordValue})),[o,r]);return o.value?"relative"===o.type&&"me"===o.value?(0,P.jsx)("span",{style:{marginTop:1,marginRight:10,marginBottom:6},children:(0,P.jsx)(f.FormattedMessage,{defaultMessage:"Me",id:"database.filterAndSort.firstPersonPropertyValue.title"},"relative")}):p?(0,P.jsx)(H.ZP,{actor:p,isSingle:!1,shouldShrink:!1,format:a.isMobile?H.vw.Format.Large:H.vw.Format.Medium,showRemoveButton:!1},null===(t=p.asActor)||void 0===t?void 0:t.id):null:null}function se(e){let{operatorValues:t,events:o,parentStore:r}=e;return(0,P.jsx)(W.Z,{...o,placeholder:E(void 0),disableMargins:!0,desktopStyle:$(),innerStyle:J(t.length>0),title:t.length>0&&t.map((e=>(0,P.jsx)(ne,{operatorValue:e,parentStore:r},`${e.type}__${e.value}`)))})}},56416:(e,t,o)=>{o.d(t,{Qv:()=>Pe,ZP:()=>Be,I4:()=>De});o(30541),o(57658);var r=o(67294),i=o(83355),n=o(480),s=o(24405),l=o(49085),a=o(66897),p=o(76205),c=o(99036),d=o(80951),u=o(84619),h=o(40506),g=o(53877),m=o(58573),x=o(42875),f=o(42853),C=o(56666),y=o(21197),v=o(37612),S=o(72126),b=o(96367),j=o(21202),F=o(77420),M=o(13493),w=o(19889),Z=o(97880),T=o(82990),k=o(4308),V=o(9291),A=o(86650),_=o(23586),P=o(28020),R=o(97004),I=o(17335),O=o(65183),B=o(26991),D=o(33929),L=o(87279),H=o(98742),G=o(5691),W=o(29376),N=o(77907),K=o(51),U=o(80444),q=o(61766),z=o(29798),E=o(79797),Q=o(86628),$=o(42696),J=o(29369),X=o(70203),Y=o(8406),ee=o(98165),te=o(68834),oe=o(52275),re=o(60458),ie=o(68785),ne=o(78140),se=o(32163),le=o(43765),ae=o(40721),pe=o(72495),ce=o(85567),de=o(47082),ue=o(85893);function he(e){window.__c={n:"LocationFilterValueMenu"};const{filter:t,parentStore:o,updateValue:i,onClose:l,desktopTopActions:a,mobileMenuTitle:c,mobileMoreActions:d,collectionContextStore:h}=e,g=(0,n.O7)(),[x,f]=(0,r.useState)([]),[C,y]=(0,r.useState)(!1),v=(0,r.useMemo)((()=>(0,p.vR)(t)?(0,p.u0)(t):[]),[t]),b=(0,n.Fy)(),j=(0,Q.VK)((()=>S.oA(v.map((e=>{if(e.value)return E.NW.createChildStore(o,{table:"collection",id:e.value})})))),[v,o]),F=(0,Q.VK)((()=>j.map((e=>(0,ue.jsx)(ce.Z,{format:b.isMobile?u.lo.Large:u.lo.Small,value:(0,ue.jsx)(te.Z,{collectionStore:e}),onClickRemove:()=>{const t=v.find((t=>t.value===e.id));if(t){const e=S.zu(v,t);i(e)}},showRemoveButton:!0,isSingle:!1,shouldShrink:!0,backgroundColor:"transparent",showFullValueTooltip:!0},e.id)))),[j,v,b.isMobile,i]),[M,w]=(0,r.useState)(""),Z=(0,V.useIntl)(),T=(0,Q.VK)((()=>{var e;return null===(e=U.default.state.currentUserStore)||void 0===e?void 0:e.userId}),[]),k=(0,Q.VK)((()=>(null==h?void 0:h.collectionStoresStore.state)??[]),[h]),A=(0,Q.VK)((()=>!C&&h?h.collectionStoreResultsInViewOrder():k),[C,h,k]),_=(0,Q.VK)((()=>(0,m.ZP)(M,k,(e=>X.QaF(e.getName()??[])))),[M,k]),P=(0,Q.VK)((()=>k.filter((e=>!x.some((t=>t.id===e.id))))),[k,x]),R=(0,Q.qz)(void 0,z.Z);(0,r.useEffect)((()=>{f((()=>""===M?S.mN([...A,...j,...x],"id"):_))}),[M,C,A,_,j]);const I=(0,s.yK)((e=>({checkboxIcon:{fill:e.regularIconColor}})),[]),O=(0,r.useCallback)(((e,t)=>{const o=Boolean(t.find((t=>"exact"===t.type&&t.value===e.id))),r=()=>{const o=S.ln(t,[{type:"exact",value:e.id}],(e=>e.value));i(o)};return{key:e.id,render:t=>(0,ue.jsx)(oe.Z,{...t,icon:(0,ue.jsx)(re.Z,{checked:o,size:14,onClick:r,style:I.checkboxIcon}),title:(0,ue.jsx)(te.Z,{collectionStore:e}),isTokenTitle:!0}),action:r}}),[I.checkboxIcon,i]),B=(0,r.useCallback)((()=>({key:"hidden-items-button",render:e=>(0,ue.jsx)(oe.Z,{...e,icon:(0,$.t)({width:13,height:13}),title:(0,ue.jsx)(V.FormattedMessage,{id:"collectionFilterValueMenu.locationFilterValueMenu.hiddenLocationsDescription",defaultMessage:"{numHiddenOptions, plural, one {{numHiddenOptions} other source} other {{numHiddenOptions} other sources}}",values:{numHiddenOptions:P.length}})}),action:()=>{y(!0),h&&Y.wd({environment:g,collectionContextStore:h,action:"expand_property_filter",original_view_type:void 0,property_type:"location"})}})),[P.length,h,g]),D=(0,Q.VK)((()=>{const e=[],t={},r=[];for(const o of x){const e=ee.VP(o);e?T&&e.getMembers().some((e=>"user"===e.entity_type&&e.user_id===T))&&(t[e.id]=[...t[e.id]??[],o]):r.push(o)}for(const[i,n]of Object.entries(t)){const t=E.zX.createChildStore(o,{table:J.e0,id:i});e.push({key:i,items:n.map((e=>O(e,v))),render:e=>(0,ue.jsx)(pe.Z,{topBorder:!0,...e,title:(0,ue.jsx)(ue.Fragment,{children:t.getName()??""})})})}return r.length>0&&e.push({key:"private",items:r.map((e=>O(e,v))),render:e=>(0,ue.jsx)(pe.Z,{topBorder:!0,...e,title:(0,ue.jsx)(V.FormattedMessage,{id:"collectionFilterValueMenu.privateLocationSection",defaultMessage:"Private"})})}),P.length>0&&!C&&e.push({key:"hidden",items:[B()],render:e=>(0,ue.jsx)(pe.Z,{topBorder:!0,...e})}),e}),[P.length,C,x,T,o,O,v,B]),H=(0,ue.jsx)(de.Z,{focus:!b.isMobile||void 0,focusAfterAnimation:!0,format:de.U.FilterValue,tokens:F,placeholder:Z.formatMessage({defaultMessage:"Search for one or more sources",id:"database.filterValue.locationType.searchPlaceholder"}),onRemoveLastToken:()=>{const e=v.slice(0,v.length-1);i(e)},onClearButtonClick:()=>{i([]),null==l||l()},value:M,onChange:e=>{w(e.target.value)},dontShowBorderBottom:b.isAndroid,showClearButton:!0,style:{maxHeight:"20vh",overflowY:"auto"}}),G=(0,ue.jsxs)(pe.Z,{desktopStyle:{paddingBottom:0},children:[!b.isMobile&&a,H]});let W;return W=b.isMobile?{menuType:L.og.Modal,title:c,left:d,right:(0,ue.jsx)(ae.DoneMenuText,{}),onClickRight:l,header:G}:{menuType:L.og.Popup,maxHeight:p.ot,width:260,header:G,disableHeaderBorder:!0},(0,ue.jsx)(ne.Z,{...W,children:(0,p.vR)(t)&&(0,ue.jsxs)(ue.Fragment,{children:[!h&&(0,ue.jsx)(pe.Z,{style:{display:"flex",alignItems:"center",justifyContent:"center",padding:"8px 0px"},children:(0,ue.jsx)(ie.Z,{})}),h&&(0,ue.jsxs)(ue.Fragment,{children:[0===k.length||""!==M&&0===x.length?(0,ue.jsx)(pe.Z,{children:(0,ue.jsx)(le.Z,{title:(0,ue.jsx)(V.FormattedMessage,{defaultMessage:"No results",id:"database.filterValue.selectType.noResults.message"})})}):null,k.length>0&&(0,ue.jsx)(se.Z,{type:se.i.Vertical,initialFocus:0,sections:D,store:R,onAccept:()=>{w("")}})]})]})})}var ge=o(11299),me=o(64921),xe=o(31945),fe=o(73063),Ce=o(68894),ye=o(3386),ve=o(53437),Se=o(11470),be=o(14871),je=o(26388),Fe=o(92864),Me=o(64369),we=o(66653),Ze=o(41209),Te=o(93289),ke=o(83264),Ve=o(78948),Ae=o(25845),_e=o(22084);let Pe=function(e){return e[e.AdvancedFilter=0]="AdvancedFilter",e[e.PropertyFilter=1]="PropertyFilter",e}({});const Re=(0,V.defineMessages)({startingMessage:{defaultMessage:"Select or type a date...",id:"search.dateMenu.dateMessage"}});class Ie extends i.Z{constructor(){super(...arguments),this.storeTypes={queryStore:l.default.createClass(""),menuListStore:z.Z,dateFilterPopupStore:q.Z,dateRangeFilterPopupStore:q.Z},this.getRelatedCollectionPartial=this.createComputedStore((()=>{const e=(0,R.tJ)(this.props.schema,this.props.propertyFilter,this.props.parentStore);return e&&(0,c.p_)(e)?{appConfigUri:(0,W.ke)(e,this.props.parentStore),schema:(0,W.uJ)(e,this.props.parentStore)}:{}}))}renderComponent(){return(0,ue.jsx)(ye.Z,{debugName:"CollectionFilterValueMenu2",capture:!0,onEsc:e=>{var t;null==(t=this.props.onClose)||t()},children:this.renderMenu()})}renderMenu(){const{propertyFilter:e,schema:t,parentStore:o}=this.props,{property:r,filter:i}=e,n=(0,p.fI)({schema:t,property:r,getRecordModel:o.getRecordModel}),s=(0,p.a_)(i)?i.subfilter:i;if("text"===n)return(0,p.Ly)(s)&&(0,ue.jsx)(ot,{intl:this.props.intl,onChange:this.props.onChange,propertyFilter:this.props.propertyFilter,schema:this.props.schema,parentStore:this.props.parentStore,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter,context:this.props.context,onClose:this.props.onClose,filter:s});if("relation"===n)return(0,p.e)(s)&&this.renderRelationRequest(s);if("checkbox"===n)return(0,p.XA)(s)&&this.renderCheckboxMenu(s);if("select"===n||"multi_select"===n)return((0,p.dx)(s)||(0,p.NU)(s))&&this.renderSelectMenu(s);if("status"===n)return(0,p.r2)(s)?(0,ue.jsx)(ge.Z,{propertyFilter:this.props.propertyFilter,schema:this.props.schema,filter:s,parentStore:o,updateValue:e=>We(e,this.props.onChange,this.props.propertyFilter),onClose:this.props.onClose,desktopTopActions:(0,ue.jsx)(Ye,{propertyFilter:this.props.propertyFilter,onChange:this.props.onChange,schema:this.props.schema,parentStore:this.props.parentStore,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter,context:this.props.context}),mobileMenuTitle:(0,ue.jsx)(et,{propertyFilter:this.props.propertyFilter,schema:this.props.schema,context:this.props.context,onChange:this.props.onChange,parentStore:this.props.parentStore}),mobileMoreActions:(0,ue.jsx)(tt,{context:this.props.context,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter}),collectionContextStore:this.props.collectionContextStore}):null;if("person"===n)return(0,p.Gb)(s)&&this.renderPersonRequest(s);if("number"===n)return(0,p.h6)(s)&&(0,ue.jsx)(rt,{intl:this.props.intl,onChange:this.props.onChange,propertyFilter:this.props.propertyFilter,schema:this.props.schema,parentStore:this.props.parentStore,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter,context:this.props.context,onClose:this.props.onClose,filter:s});if("date"===n)return(0,p.gE)(s)&&this.renderDateMenu(s);if("file"===n);else{if("location"===n)return(0,p.Mp)(s)?(0,ue.jsx)(he,{filter:s,parentStore:o,updateValue:e=>We(e,this.props.onChange,this.props.propertyFilter),onClose:this.props.onClose,desktopTopActions:(0,ue.jsx)(Ye,{propertyFilter:this.props.propertyFilter,onChange:this.props.onChange,schema:this.props.schema,parentStore:this.props.parentStore,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter,context:this.props.context}),mobileMenuTitle:(0,ue.jsx)(et,{propertyFilter:this.props.propertyFilter,schema:this.props.schema,context:this.props.context,onChange:this.props.onChange,parentStore:this.props.parentStore}),mobileMoreActions:(0,ue.jsx)(tt,{context:this.props.context,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter}),collectionContextStore:this.props.collectionContextStore}):null;if("verification"===n)return(0,p.Jw)(s)&&this.renderVerificationMenu(s);(0,Z.t1)(n)}}renderSelectMenu(e){const{intl:t}=this.props,{device:o}=this.environment,r=this.stores.queryStore.state,i=(0,R.tJ)(this.props.schema,this.props.propertyFilter,this.props.parentStore);if(!i||!(0,c.cu)(i))return;const n=i.options||[],s=(0,p.vR)(e)?(0,p.dx)(e)?(0,p.mg)(e):(0,p.qC)(e):[],l=De({query:r,propertySchema:i,selectedValues:s,updateValue:e=>{We(e,this.props.onChange,this.props.propertyFilter)},isMobile:o.isMobile,styles:{checkboxIcon:{fill:this.theme.regularIconColor,pointerEvents:"none"}}}),a=s.map((e=>{if(void 0===e.value)return;const t=(0,d.i7)(n,e.value);return t?(0,ue.jsx)(_e.a,{format:o.isMobile?u.lo.Large:u.lo.Small,isSingle:!1,value:t.value,color:t.color,showRemoveButton:!0,onClickRemove:()=>{We(S.zu(s,e),this.props.onChange,this.props.propertyFilter)}},t.id):void 0})),h=(0,ue.jsx)(de.Z,{focus:!o.isMobile||void 0,focusAfterAnimation:!0,format:de.U.FilterValue,tokens:a,placeholder:t.formatMessage({defaultMessage:"Select one or more options…",id:"database.filterValue.selectType.searchPlaceholder"}),onRemoveLastToken:()=>{We(s.slice(0,s.length-1),this.props.onChange,this.props.propertyFilter)},onClearButtonClick:()=>{var e,t;We([],this.props.onChange,this.props.propertyFilter),null===(e=(t=this.props).onClose)||void 0===e||e.call(t)},value:this.stores.queryStore.state,onChange:e=>{it(e.target.value,this.stores.queryStore,this.stores.menuListStore)},dontShowBorderBottom:o.isAndroid,showClearButton:!0}),g=(0,ue.jsxs)(pe.Z,{desktopStyle:{paddingBottom:0},children:[!o.isMobile&&(0,ue.jsx)(Ye,{propertyFilter:this.props.propertyFilter,onChange:this.props.onChange,schema:this.props.schema,parentStore:this.props.parentStore,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter,context:this.props.context}),(0,p.vR)(e)&&h]});let m;return m=o.isMobile?{menuType:L.og.Modal,title:(0,ue.jsx)(et,{propertyFilter:this.props.propertyFilter,schema:this.props.schema,context:this.props.context,onChange:this.props.onChange,parentStore:this.props.parentStore}),left:(0,ue.jsx)(tt,{context:this.props.context,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter}),right:(0,ue.jsx)(ae.DoneMenuText,{}),onClickRight:this.props.onClose,header:g}:{menuType:L.og.Popup,maxHeight:p.ot,width:260,header:g,disableHeaderBorder:!0,tokenInputHeader:!0},(0,ue.jsx)(ne.Z,{...m,children:(0,p.vR)(e)&&(0,ue.jsxs)(ue.Fragment,{children:[0===l.length&&(0,ue.jsx)(pe.Z,{children:(0,ue.jsx)(le.Z,{title:(0,ue.jsx)(V.FormattedMessage,{defaultMessage:"No results",id:"database.filterValue.selectType.noResults.message"})})}),l.length>0&&(0,ue.jsx)(se.Z,{type:se.i.Vertical,initialFocus:0,sections:[{key:"select",render:e=>(0,ue.jsx)(pe.Z,{...e}),items:l}],store:this.stores.menuListStore,onAccept:()=>{it("",this.stores.queryStore,this.stores.menuListStore)}})]})})}renderPersonRequest(e){const t=this.stores.queryStore.state;return(0,ue.jsx)(_.Z,{request:t,performRequest:e=>async function(e,t,o){const r=await N.deps.searchActions.loader();let{users:i,bots:n}=await r.searchSpaceActors({environment:o,query:e,membersOnly:!1});return i=i.slice(0,20),n=n.slice(0,20),await Promise.all([...i.map((async e=>{let{id:o}=e;const r=(0,E.Kv)(t,{table:w.KJ,id:o});await r.load()})),...n.map((async e=>{const o=(0,E.Kv)(t,{table:F.cZ,id:e.id,spaceId:e.space_id});await o.load()}))]),{users:i,bots:n}}(e,this.props.parentStore,this.environment),render:(t,o)=>this.renderPersonMenu(e,t,o)})}renderPersonMenu(e,t,o){const{intl:r}=this.props,{device:i}=this.environment,n=this.stores.queryStore.state,s=(0,R.tJ)(this.props.schema,this.props.propertyFilter,this.props.parentStore);if(!s)return;const l=(0,p.vR)(e)?(0,p.R8)(e):[],c=S.oA(l.map(((e,t)=>{if("exact"===e.type&&e.value){const t=(0,a.Hl)({pointer:e.value,getRecordValue:this.props.parentStore.getRecordValue});return(0,ue.jsx)(Fe.ZP,{actor:t,format:i.isMobile?Fe.ZP.Format.Large:Fe.ZP.Format.Small,showRemoveButton:!0,onClickRemove:()=>{We(S.zu(l,e),this.props.onChange,this.props.propertyFilter)},shouldShrink:!0,isSingle:!1},e.value.id)}if("relative"===e.type&&"me"===e.value&&this.props.allowRelativePersonFilter)return(0,ue.jsx)(ce.Z,{format:i.isMobile?u.lo.Large:u.lo.Small,value:(0,ue.jsx)(Ge,{}),onClickRemove:()=>{We(S.zu(l,e),this.props.onChange,this.props.propertyFilter)},showRemoveButton:!0,isSingle:!1,shouldShrink:!0,backgroundColor:"transparent",showFullValueTooltip:!0},t)}))),d=(0,ue.jsx)(de.Z,{focus:!i.isMobile||void 0,focusAfterAnimation:!0,format:de.U.FilterValue,tokens:c,placeholder:r.formatMessage({defaultMessage:"Search for one or more people…",id:"database.filterValue.personType.searchPlaceholder"}),onRemoveLastToken:()=>{We(l.slice(0,l.length-1),this.props.onChange,this.props.propertyFilter)},onClearButtonClick:()=>{var e,t;We([],this.props.onChange,this.props.propertyFilter),null===(e=(t=this.props).onClose)||void 0===e||e.call(t)},value:this.stores.queryStore.state,onChange:e=>{it(e.target.value,this.stores.queryStore,this.stores.menuListStore)},dontShowBorderBottom:i.isAndroid,showClearButton:!0,style:{maxHeight:"20vh",overflowY:"auto"}}),h=(0,ue.jsxs)(pe.Z,{desktopStyle:{paddingBottom:0},children:[!i.isMobile&&(0,ue.jsx)(Ye,{propertyFilter:this.props.propertyFilter,onChange:this.props.onChange,schema:this.props.schema,parentStore:this.props.parentStore,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter,context:this.props.context}),(0,p.vR)(e)&&d]});let g;g=i.isMobile?{menuType:L.og.Modal,title:(0,ue.jsx)(et,{propertyFilter:this.props.propertyFilter,schema:this.props.schema,context:this.props.context,onChange:this.props.onChange,parentStore:this.props.parentStore}),left:(0,ue.jsx)(tt,{context:this.props.context,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter}),right:(0,ue.jsx)(ae.DoneMenuText,{}),onClickRight:this.props.onClose,header:h}:{menuType:L.og.Popup,maxHeight:p.ot,width:260,header:h,disableHeaderBorder:!0};const m=S.oA((o&&o.users||[]).map((e=>function(e,t,o,r,i){const{device:n}=r,s=Boolean(t.find((t=>{var o;return"exact"===t.type&&(null===(o=t.value)||void 0===o?void 0:o.id)===e.id}))),l={key:e.id,render:t=>(0,ue.jsx)(oe.Z,{...t,title:(0,ue.jsx)(Fe.vw,{isSingle:!0,shouldShrink:!0,format:n.isMobile?Fe.vw.Format.Large:Fe.vw.Format.Medium,userValue:e,showRemoveButton:!1}),isTokenTitle:!0,checkState:s}),action:()=>{We(s?t.filter((t=>{var o;return!("exact"===t.type&&(null===(o=t.value)||void 0===o?void 0:o.id)===e.id)})):[...t,{type:"exact",value:{table:w.KJ,id:e.id}}],i,o)}};return l}(e,l,this.props.propertyFilter,this.environment,this.props.onChange)))),x=["created_by","last_edited_by"].includes(s.type)?S.oA((o&&o.bots||[]).map((e=>function(e,t,o,r,i){const{device:n}=r,s=Boolean(t.find((t=>{var o;return"exact"===t.type&&(null===(o=t.value)||void 0===o?void 0:o.id)===e.id}))),l={key:e.id,render:t=>(0,ue.jsx)(oe.Z,{...t,title:(0,ue.jsx)(Fe.Jn,{isSingle:!0,shouldShrink:!0,format:n.isMobile?Fe.Jn.Format.Large:Fe.Jn.Format.Medium,botValue:e,showRemoveButton:!1}),isTokenTitle:!0,checkState:s}),action:()=>{We(s?t.filter((t=>{var o;return!("exact"===t.type&&(null===(o=t.value)||void 0===o?void 0:o.id)===e.id)})):[...t,{type:"exact",value:{table:F.cZ,id:e.id}}],i,o)}};return l}(e,l,this.props.propertyFilter,this.environment,this.props.onChange)))):[];if(this.props.allowRelativePersonFilter&&o&&(!n||"me".includes(n))){const e=Boolean(l.find((e=>"relative"===e.type&&"me"===e.value)));m.unshift({key:"me",render:t=>(0,ue.jsx)(oe.Z,{...t,title:(0,ue.jsx)(Ge,{}),checkState:e,style:i.isMobile?void 0:{fontSize:14}}),action:()=>{We(e?l.filter((e=>{let{value:t}=e;return"me"!==t})):[...l,{type:"relative",value:"me"}],this.props.onChange,this.props.propertyFilter)}})}const f=[];return m.length>0&&f.push({key:"user property",render:e=>(0,ue.jsx)(pe.Z,{...e}),items:m}),x.length>0&&f.push({key:"bot property",render:e=>(0,ue.jsx)(pe.Z,{...e,title:"Pick a bot"}),items:x}),(0,ue.jsx)(ne.Z,{...g,children:(0,p.vR)(e)&&(0,ue.jsxs)(ue.Fragment,{children:[t&&(0,ue.jsx)(pe.Z,{children:(0,ue.jsx)(le.Z,{title:(0,ue.jsx)(V.FormattedMessage,{defaultMessage:"Something went wrong.",id:"database.filterValue.personType.searchPersonPropertyMenuItem.errorMessage"})})}),0===f.length&&o&&!t&&(0,ue.jsx)(pe.Z,{children:(0,ue.jsx)(le.Z,{title:(0,ue.jsx)(V.FormattedMessage,{defaultMessage:"No results",id:"database.filterValue.personType.noResults.message"})})}),!o&&!t&&(0,ue.jsx)(pe.Z,{children:(0,ue.jsx)(Ve.Z,{})}),f.length>0&&(0,ue.jsx)(se.Z,{type:se.i.Vertical,initialFocus:0,sections:f,store:this.stores.menuListStore,onAccept:()=>{it("",this.stores.queryStore,this.stores.menuListStore)}})]})})}renderCheckboxMenu(e){var t;const{device:o}=this.environment,{context:r}=this.props;let i;i=o.isMobile?{menuType:L.og.Modal,title:(0,ue.jsx)(et,{propertyFilter:this.props.propertyFilter,schema:this.props.schema,context:this.props.context,onChange:this.props.onChange,parentStore:this.props.parentStore}),left:(0,ue.jsx)(tt,{context:this.props.context,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter}),right:(0,ue.jsx)(ae.DoneMenuText,{}),onClickRight:this.props.onClose}:{menuType:L.og.Popup,maxHeight:p.ot,width:220,footer:(0,ue.jsx)(Ue,{onChange:this.props.onChange,propertyFilter:this.props.propertyFilter,onClose:this.props.onClose,filter:e})};const n=null===(t=e.value)||void 0===t?void 0:t.value;return(0,ue.jsxs)(ne.Z,{...i,children:[r===Pe.PropertyFilter&&(0,ue.jsx)(pe.Z,{children:!o.isMobile&&(0,ue.jsx)(Ye,{propertyFilter:this.props.propertyFilter,onChange:this.props.onChange,schema:this.props.schema,parentStore:this.props.parentStore,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter,context:this.props.context})}),(0,ue.jsx)(se.Z,{type:se.i.Vertical,initialFocus:0,sections:[{key:"select",render:e=>(0,ue.jsx)(pe.Z,{style:r===Pe.PropertyFilter?{paddingTop:0}:void 0,...e}),items:[{key:"unchecked",render:e=>(0,ue.jsx)(oe.Z,{...e,title:(0,ue.jsx)(V.FormattedMessage,{defaultMessage:"Unchecked",id:"database.filterValue.checkboxType.unchecked.title"}),isTokenTitle:!0,checkState:!1===n}),action:()=>{We({type:"exact",value:!1},this.props.onChange,this.props.propertyFilter)}},{key:"checked",render:e=>(0,ue.jsx)(oe.Z,{...e,title:(0,ue.jsx)(V.FormattedMessage,{defaultMessage:"Checked",id:"database.filterValue.checkboxType.checked.title"}),isTokenTitle:!0,checkState:!0===n}),action:()=>{We({type:"exact",value:!0},this.props.onChange,this.props.propertyFilter)}}]}],store:this.stores.menuListStore,onAccept:this.props.onClose}),o.isMobile&&(0,ue.jsx)(Ue,{onChange:this.props.onChange,propertyFilter:this.props.propertyFilter,onClose:this.props.onClose,filter:e})]})}renderRelationRequest(e){const t=this.stores.queryStore.state,{currentSpaceStore:o}=U.default.state,{publicPageData:r}=K.Z.state,i=(0,R.tJ)(this.props.schema,this.props.propertyFilter,this.props.parentStore),n=(null==o?void 0:o.id)||(null==r?void 0:r.spaceId);if(!i||!(0,c.p_)(i)||!n)return;const s=(0,c.F0)(i);return s?(0,ue.jsx)(_.Z,{request:{query:t,spaceId:n,collectionId:s},performRequest:e=>async function(e,t,o){const{query:r,spaceId:i,collectionId:n}=e;if(!i||!n)return[];const s=await N.deps.searchActions.loader(),{results:l}=await s.searchPagesInCollection({environment:o,query:r,collectionId:n,limit:20,spaceId:i,excludeTemplates:!0,source:"relation_menu",includePublicPagesWithoutExplicitAccess:!0,boostRecentlyViewedPages:!1});if(0===l.length)return[];return await Promise.all(l.map((async e=>{const o=(0,E.Kv)(t,{table:j.iU,id:e});await o.load()}))),l}(e,this.props.parentStore,this.environment),render:(t,o)=>this.renderRelationMenu(e,t,o)}):void 0}renderRelationMenu(e,t,o){const{intl:r}=this.props,{device:i}=this.environment,n=this.stores.queryStore.state,s=(0,R.tJ)(this.props.schema,this.props.propertyFilter,this.props.parentStore);if(!s||!(0,c.p_)(s))return;const l=(0,c.F0)(s);if(!l)return;const a=(0,p.vR)(e)?(0,p.YO)(e):[],d=S.oA(a.map(((e,t)=>{if(!e.value)return;const o={format:i.isMobile?u.lo.Large:u.lo.Small,shouldWrap:!1,showRemoveButton:!0,isSingle:!1,shouldShrink:!0,onClickRemove:()=>{We(S.zu(a,e),this.props.onChange,this.props.propertyFilter)}},r=e.type;if("exact"===r)return(0,ue.jsx)(Ae.Z,{blockId:e.value,parentStore:this.props.parentStore,...o},e.value);if("relative"===r){var n;const{appConfigUri:r}=this.getRelatedCollectionPartial.state;if(!r)return;return(0,ue.jsx)(ce.Z,{value:(0,ue.jsx)(V.FormattedMessage,{...null===(n=b.qB[r])||void 0===n||null===(n=n[e.value.variable])||void 0===n?void 0:n.messageDescriptor}),backgroundColor:"transparent",showFullValueTooltip:!0,...o},t)}(0,Z.t1)(r)}))),h=(0,ue.jsx)(de.Z,{focus:!i.isMobile||void 0,focusAfterAnimation:!0,format:de.U.FilterValue,tokens:d,placeholder:r.formatMessage({defaultMessage:"Search for one or more pages…",id:"database.filterValue.relationType.searchPlaceholder"}),onRemoveLastToken:()=>{We(a.slice(0,a.length-1),this.props.onChange,this.props.propertyFilter)},onClearButtonClick:()=>{var e,t;We([],this.props.onChange,this.props.propertyFilter),null===(e=(t=this.props).onClose)||void 0===e||e.call(t)},value:this.stores.queryStore.state,onChange:e=>{it(e.target.value,this.stores.queryStore,this.stores.menuListStore)},dontShowBorderBottom:i.isAndroid,style:{maxHeight:"20vh",overflowY:"auto"},showClearButton:!0}),g=(0,ue.jsxs)(pe.Z,{desktopStyle:{paddingBottom:0},children:[!i.isMobile&&(0,ue.jsx)(Ye,{propertyFilter:this.props.propertyFilter,onChange:this.props.onChange,schema:this.props.schema,parentStore:this.props.parentStore,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter,context:this.props.context}),(0,p.vR)(e)&&h]});let m;m=i.isMobile?{menuType:L.og.Modal,title:(0,ue.jsx)(et,{propertyFilter:this.props.propertyFilter,schema:this.props.schema,context:this.props.context,onChange:this.props.onChange,parentStore:this.props.parentStore}),left:(0,ue.jsx)(tt,{context:this.props.context,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter}),right:(0,ue.jsx)(ae.DoneMenuText,{}),onClickRight:this.props.onClose,header:g}:{menuType:L.og.Popup,maxHeight:p.ot,width:260,header:g,disableHeaderBorder:!0};const x=function(e,t){if(!e)return;const o=E.Xr.createChildStore(t,{table:M.n,id:e}).getParentBlockStore();if(!o)return;return o.getNearestAncestorTemplateStore()}(this.props.collectionViewId,this.props.parentStore);o&&!n&&x&&l&&x.getAssociatedCollectionId()===l&&(o=S.jj([x.id,...o]));let f=[];if(o){const e=function(e,t,o,r,i){return e.map((e=>{const n={type:"exact",value:e},s=He(t,n),l=E.G.createChildStore(o,{table:j.iU,id:e});return{key:e,action:Ke(s,t,n,r,i),render:e=>(0,ue.jsx)(Se.Z,{store:l,checkState:s,hidePath:!0,...e})}}))}(o,a,this.props.parentStore,this.props.propertyFilter,this.props.onChange);f=((0,p.a_)(this.props.propertyFilter.filter)?[]:this.getRelativeRelationMenuItems(n,a)).concat(e)}return(0,ue.jsx)(ne.Z,{...m,children:(0,p.vR)(e)&&(0,ue.jsxs)(ue.Fragment,{children:[t&&(0,ue.jsx)(pe.Z,{children:(0,ue.jsx)(le.Z,{title:(0,ue.jsx)(V.FormattedMessage,{defaultMessage:"Something went wrong.",id:"database.filterValue.relationType.searchRelationPropertyMenuItem.errorMessage"})})}),0===f.length&&o&&!t&&(0,ue.jsx)(pe.Z,{children:(0,ue.jsx)(le.Z,{title:(0,ue.jsx)(V.FormattedMessage,{defaultMessage:"No results",id:"database.filterValue.relationType.noResults.message"})})}),!o&&!t&&(0,ue.jsx)(pe.Z,{children:(0,ue.jsx)(Ve.Z,{})}),f.length>0&&(0,ue.jsx)(se.Z,{type:se.i.Vertical,initialFocus:0,sections:[{key:"results",render:e=>(0,ue.jsx)(pe.Z,{...e}),items:f}],store:this.stores.menuListStore,onAccept:()=>{it("",this.stores.queryStore,this.stores.menuListStore)}})]})})}renderDateMenu(e){const{context:t}=this.props,{device:o}=this.environment;let r;return r=o.isMobile?{menuType:L.og.Modal,title:(0,ue.jsx)(et,{propertyFilter:this.props.propertyFilter,schema:this.props.schema,context:this.props.context,onChange:this.props.onChange,parentStore:this.props.parentStore}),left:(0,ue.jsx)(tt,{context:this.props.context,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter}),right:(0,ue.jsx)(ae.DoneMenuText,{}),onClickRight:this.props.onClose}:{menuType:L.og.Popup,maxHeight:p.ot},(0,ue.jsxs)(ne.Z,{...r,children:[t===Pe.PropertyFilter&&!o.isMobile&&(0,ue.jsx)(pe.Z,{desktopStyle:{paddingBottom:0},children:(0,ue.jsx)(Ye,{propertyFilter:this.props.propertyFilter,onChange:this.props.onChange,schema:this.props.schema,parentStore:this.props.parentStore,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter,context:this.props.context})}),(0,p.vR)(e)?(0,p.TQ)(e)?this.renderDateRangePicker(e):this.renderDatePicker(e):void 0]})}renderDateRangePicker(e){const t=(0,R.tJ)(this.props.schema,this.props.propertyFilter,this.props.parentStore);if(!t)return;let o;if((0,p.TQ)(e)&&"exact"===e.value.type&&e.value.value){const t=e.value.value;o={starting:t.start_date?{type:"date",start_date:t.start_date}:void 0,ending:t.end_date?{type:"date",start_date:t.end_date}:void 0}}else o=(0,p.TQ)(e)&&"relative"===e.value.type?e.value:{starting:void 0,ending:void 0};const r={disableMenuWrap:!0,title:t.name,value:o,onUpdate:e=>{var t,r;if(e.error)return;const i={...o,...e.value},n=null===(t=i.starting)||void 0===t?void 0:t.start_date,s=null===(r=i.ending)||void 0===r?void 0:r.start_date;Ne({operator:"date_is_within",value:{type:"exact",value:n||s?{type:"daterange",start_date:n,end_date:s}:void 0}},this.props.onChange,this.props.propertyFilter)},allowRelativeRangeFilter:this.props.allowRelativeDateFilter,relativeRangePopupStore:this.stores.dateRangeFilterPopupStore,onUpdateRelativeFilter:t=>{Ne({...e,value:t},this.props.onChange,this.props.propertyFilter)}};return(0,ue.jsx)(ue.Fragment,{children:(0,ue.jsx)(pe.Z,{children:(0,ue.jsx)(ke.Z,{...r})})})}renderDateInput(e,t){return(0,ue.jsx)(we.Z,{...t,placeholder:D.default.formatMessage(Re.startingMessage),focused:"exact"===e.value.type,value:e.value,onUpdate:t=>{var o;if(t.error)return;const r=null===(o=t.value)||void 0===o?void 0:o.start_date;Ne({...e,value:{type:"exact",value:r?{type:"date",start_date:r}:void 0}},this.props.onChange,this.props.propertyFilter)},inputRight:this.props.allowRelativeDateFilter&&(0,ue.jsx)(fe.Z,{icon:f.i,iconStyle:{width:12},style:{...!this.environment.device.isMobile&&{height:20,width:20},color:this.theme.mediumIconColor},onClick:()=>{this.stores.dateFilterPopupStore.setState({open:!0})}}),hideClearButton:"relative"===e.value.type||void 0,isRightLastElementOfInput:!0})}renderDatePicker(e){if(!(0,p.vR)(e))return;const t="exact"===e.value.type?e.value.value:(0,g.Id)(e.value);return!t||(0,h.J_)(t)?(0,ue.jsxs)(ue.Fragment,{children:[(0,ue.jsx)(pe.Z,{children:(0,ue.jsx)(Ze.Z,{type:"date",filterValue:e.value,onUpdate:t=>{Ne({...e,value:t},this.props.onChange,this.props.propertyFilter)},renderOrigin:t=>this.renderDateInput(e,t),disabled:"exact"===e.value.type&&this.props.allowRelativeDateFilter,buttonPopupStore:this.stores.dateFilterPopupStore})}),(0,ue.jsxs)(pe.Z,{style:{padding:"0px 14px 14px 14px"},children:[(0,ue.jsx)(Te.Z,{firstDayOfWeek:P.AK.state,value:t?g.OQ.notionDateToLuxon(t).toMillis():Date.now(),onChange:e=>{We({type:"exact",value:(0,g.hT)(e,(0,x.r)())},this.props.onChange,this.props.propertyFilter)}}),"relative"===e.value.type&&(0,ue.jsx)(Me.Z,{isSmall:!0,style:{marginLeft:4,marginTop:4},children:(0,ue.jsx)(V.FormattedMessage,{id:"collectionFilterMenu.dateFilter.relativeDateFilter.description",defaultMessage:"Filter will update with the current date"})})]})]}):void 0}renderVerificationMenu(e){const{device:t}=this.environment,{context:o}=this.props,r=(0,p.vR)(e)?(0,p.fl)(e):[],i=r.map((e=>{let{value:t}=e;return t})),n=k.zz.map((e=>{const t=i.includes(e);return{key:e,render:o=>(0,ue.jsx)(oe.Z,{icon:(0,ue.jsx)(re.Z,{checked:t,size:14,style:{fill:this.theme.regularIconColor,pointerEvents:"none"}}),title:(0,I.cq)({type:"exact",value:e}),...o}),action:()=>{if(t)We(r.filter((t=>{let{value:o}=t;return o!==e})),this.props.onChange,this.props.propertyFilter);else{const t={type:"exact",value:e};We([...r,t],this.props.onChange,this.props.propertyFilter)}}}}));let s;return s=t.isMobile?{menuType:L.og.Modal,title:(0,ue.jsx)(et,{propertyFilter:this.props.propertyFilter,schema:this.props.schema,context:this.props.context,onChange:this.props.onChange,parentStore:this.props.parentStore}),left:(0,ue.jsx)(tt,{context:this.props.context,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter}),right:(0,ue.jsx)(ae.DoneMenuText,{}),onClickRight:this.props.onClose}:{menuType:L.og.Popup,maxHeight:p.ot,width:220,footer:(0,ue.jsx)(Ue,{onChange:this.props.onChange,propertyFilter:this.props.propertyFilter,onClose:this.props.onClose,filter:e})},(0,ue.jsxs)(ne.Z,{...s,children:[o===Pe.PropertyFilter&&(0,ue.jsx)(pe.Z,{children:!t.isMobile&&(0,ue.jsx)(Ye,{propertyFilter:this.props.propertyFilter,onChange:this.props.onChange,schema:this.props.schema,parentStore:this.props.parentStore,allowAddingToCombinatorFilter:this.props.allowAddingToCombinatorFilter,onDelete:this.props.onDelete,onAddToCombinatorFilter:this.props.onAddToCombinatorFilter,context:this.props.context})}),(0,ue.jsx)(se.Z,{type:se.i.Vertical,initialFocus:0,sections:[{key:"select",render:e=>(0,ue.jsx)(pe.Z,{...e}),items:n}],store:this.stores.menuListStore})]})}getRelativeRelationMenuItems(e,t){const{appConfigUri:o,schema:r}=this.getRelatedCollectionPartial.state;if(!r)return[];if(!o||!(0,B.Sh)(r,o))return[];const i=(0,b.Zv)(r,o),n=b.qB[o];return S.oA(i.map((o=>{if(!e||o.includes(e)){const e={type:"relative",value:{type:"builtin",variable:o}},r=He(t,e);return{key:o,render:e=>(0,ue.jsx)(oe.Z,{...e,title:(0,ue.jsx)(V.FormattedMessage,{...n[o].messageDescriptor}),checkState:r}),action:Ke(r,t,e,this.props.propertyFilter,this.props.onChange)}}})))}}function Oe(){window.__c={n:"OperatorChevron"};const{device:e}=(0,n.O7)();return(0,f.i)({width:10,height:10,...e.isMobile&&{marginTop:2}})}Ie.displayName="CollectionFilterValueMenu";const Be=(0,V.injectIntl)(Ie);function De(e){const{query:t,propertySchema:o,selectedValues:r,updateValue:i,isMobile:n,styles:s}=e,l=o.options||[];return(t?(0,m.ZP)(t,l,(e=>e.value)):l).map((e=>{const t=Boolean(r.find((t=>t.value===e.value))),o={key:e.value,render:o=>(0,ue.jsx)(oe.Z,{icon:(0,ue.jsx)(re.Z,{onClick:o.onClick,checked:t,size:14,style:s.checkboxIcon}),title:(0,ue.jsx)(_e.a,{format:n?u.lo.Large:u.lo.Medium,isSingle:!0,value:e.value,color:e.color,showRemoveButton:!1}),isTokenTitle:!0,...o}),action:()=>{const o=t?r.filter((t=>{let{value:o}=t;return o!==e.value})):[...r,{type:"exact",value:e.value}];i(o)}};return o}))}function Le(e){return Array.isArray(e)?0===e.length?{type:"exact",value:void 0}:1===e.length?e[0]:e:e}function He(e,t){return Boolean(e.find((e=>S.Xy(e,t))))}function Ge(){return(0,ue.jsx)(V.FormattedMessage,{defaultMessage:"Me",id:"database.filterValue.personType.firstPersonPropertyValue.title"})}function We(e,t,o){const{filter:r}=o;(0,p.a_)(r)?null==t||t({...r,subfilter:{...r.subfilter,value:Le(e)}}):null==t||t({...r,value:Le(e)})}function Ne(e,t,o){const{filter:r}=o;(0,p.a_)(r)?null==t||t({...r,subfilter:e}):null==t||t(e)}function Ke(e,t,o,r,i){return()=>{We(e?t.filter((e=>!S.Xy(e,o))):[...t,o],i,r)}}function Ue(e){let{filter:t,onChange:o,propertyFilter:r,onClose:i}=e;return(0,p.yI)(t.value)?null:(0,ue.jsx)(pe.Z,{topBorder:!0,children:(0,ue.jsx)(oe.Z,{focused:!1,title:(0,ue.jsx)(V.FormattedMessage,{defaultMessage:"Clear",id:"database.filterValue.clear.message"}),onClick:()=>{We({type:"exact",value:void 0},o,r),null==i||i()}})})}function qe(e){let{filter:t}=e;window.__c={n:"NumberOperatorComponent"};const o=(0,s.Fg)();return(0,ue.jsx)("span",{style:{color:o.lightTextColor},children:(0,I.WC)(t.operator).toLocaleLowerCase()})}function ze(e){let{propertySchema:t,propertyFilter:o,onChange:r}=e;window.__c={n:"DateFilterModeSelectComponent"};const i=(0,s.Fg)(),l=(0,n.O7)(),{device:a}=l,c=o.filter;if(!(0,p.vR)(c)||!(0,p.gE)(c))return(0,ue.jsx)(ue.Fragment,{children:t.name});const d={width:190,items:p.T,selectedItem:(0,p.TX)(c),getKey:e=>e,onSelect:e=>{Ne({...c,use_end:(0,p.UG)(e)},r,o)},renderItem:e=>(0,ue.jsx)(je.ZP,{renderTooltip:()=>(0,I._T)(e.value),render:t=>(0,ue.jsx)(oe.Z,{title:(0,I.IF)(e.value),...(0,H.Z)(e,t)}),placement:je.ug.Right,textWrap:!0,style:{width:"260px"}}),renderOrigin:e=>(0,ue.jsx)(me.Z,{...e,style:{marginRight:4,marginLeft:2,paddingLeft:2,paddingRight:2,borderRadius:4,flexShrink:0},children:(0,ue.jsxs)("div",{style:{display:"flex",alignItems:"center",...!a.isMobile&&{color:i.mediumTextColor,fill:i.lightIconColor,fontWeight:500,fontSize:12}},children:[(0,ue.jsx)("span",{style:{marginRight:4},children:(0,I.IF)((0,p.TX)(c))}),(0,ue.jsx)(Oe,{})]})})};return(0,ue.jsx)(be.Z,{...d,mobileActionSheet:!0})}function Ee(e){let{propertyFilter:t,onChange:o}=e;window.__c={n:"RollupOperatorSelectComponent"};const r=(0,V.useIntl)(),i=(0,s.Fg)(),l=(0,n.O7)(),{filter:a}=t,{device:c}=l;if(!(0,p.a_)(a))return null;const d={width:190,items:p.Rf,getKey:e=>e,selectedItem:a.operator,onSelect:e=>{null==o||o({...a,operator:e})},renderItem:e=>(0,ue.jsx)(oe.Z,{title:(0,I.SW)(e.value,r),...e}),renderOrigin:e=>(0,ue.jsx)(me.Z,{...e,style:{marginRight:4,marginLeft:2,paddingLeft:2,paddingRight:2,borderRadius:4,flexShrink:0},children:(0,ue.jsxs)("div",{style:{display:"flex",alignItems:"center",...!c.isMobile&&{color:i.lightTextColor,fontSize:12}},children:[(0,ue.jsx)("span",{style:{marginRight:4},children:(0,I.SW)(a.operator,r).toLocaleLowerCase()}),(0,ue.jsx)(Oe,{})]})})};return(0,ue.jsx)(be.Z,{...d,mobileActionSheet:!0})}function Qe(e){let{propertyFilter:t,schema:o,parentStore:r,onChange:i}=e;window.__c={n:"OperatorSelectComponent"};const l=(0,s.Fg)(),a=(0,n.O7)(),{property:c}=t,{device:d}=a,u=o[c],h=(0,p.a_)(t.filter)?t.filter.subfilter:t.filter;if((0,p.a_)(h))return null;const g=(0,p.fI)({schema:o,property:c,getRecordModel:r.getRecordModel});let m=(0,p.xm)(g);u&&(0,O.Dt)(u)&&(m=m.filter((e=>!(0,p._N)(e))));const x={width:190,items:m,selectedItem:h.operator,getKey:e=>e,onSelect:e=>{Ne((0,I.li)(g,h,e,"propertyFilter"),i,t)},renderItem:e=>(0,ue.jsx)(oe.Z,{title:(0,I.WC)(e.value),...e}),renderOrigin:e=>(0,ue.jsx)(me.Z,{...e,style:{marginRight:4,marginLeft:2,paddingLeft:2,paddingRight:2,borderRadius:4,flexShrink:0},children:(0,ue.jsxs)("div",{style:{display:"flex",alignItems:"center",...!d.isMobile&&{color:l.mediumTextColor,fill:l.lightIconColor,fontWeight:500,fontSize:12}},children:[(0,ue.jsx)("span",{style:{marginRight:4},children:(0,I.WC)(h.operator).toLocaleLowerCase()}),(0,ue.jsx)(Oe,{})]})})};return(0,ue.jsx)(be.Z,{...x,mobileActionSheet:!0})}function $e(e){let{parent:t,allowAddingToCombinatorFilter:o,onDelete:r,onAddToCombinatorFilter:i}=e;window.__c={n:"MoreActionsPopupComponent"};const s=(0,n.O7)(),{device:l}=s;let a;a=l.isMobile?{menuType:L.og.ActionSheet}:{menuType:L.og.Popup,maxHeight:p.ot};const c=S.oA([{key:"delete",render:e=>(0,ue.jsx)(oe.Z,{...e,title:(0,ue.jsx)(V.FormattedMessage,{id:"database.filterValue.deleteFilter.title",defaultMessage:"Delete filter"}),icon:(0,v.y)({width:14}),isRedOnHover:!0}),action:()=>{t.close(),null==r||r()}},o&&{key:"merge",render:e=>(0,ue.jsx)(je.ZP,{placement:je.ug.Right,style:{maxWidth:240,whiteSpace:void 0},renderTooltip:()=>(0,ue.jsx)("div",{children:(0,ue.jsx)(A.ep,{})}),render:t=>(0,ue.jsx)(oe.Z,{...(0,H.Z)(e,t),title:(0,ue.jsx)(V.FormattedMessage,{id:"database.filterValue.mergeIntoAdvancedFilter.title",defaultMessage:"Add to advanced filter"}),icon:(0,y.Q)({width:14})})}),action:()=>{t.close(),null==i||i()}}]);return(0,ue.jsx)(ne.Z,{...a,children:(0,ue.jsx)(se.Z,{type:se.i.Vertical,sections:[{key:"actions",render:e=>(0,ue.jsx)(pe.Z,{disableMobilePadding:!0,...e}),items:c}],initialFocus:void 0})})}function Je(e){let{propertySchema:t,propertyFilter:o,onChange:r}=e;return(0,p.c3)(t)?(0,ue.jsx)(ze,{propertyFilter:o,onChange:r,propertySchema:t}):(0,ue.jsx)(ue.Fragment,{children:t.name})}function Xe(e){let{allowAddingToCombinatorFilter:t,onDelete:o,onAddToCombinatorFilter:r}=e;window.__c={n:"MoreActionsComponent"};const i=(0,n.O7)(),{device:s}=i;return(0,ue.jsx)(xe.ZP,{popupType:i.device.isMobile?ve.kQ.SlideUp:ve.kQ.Popup,render:e=>(0,ue.jsx)($e,{parent:e,allowAddingToCombinatorFilter:t,onDelete:o,onAddToCombinatorFilter:r}),renderOrigin:e=>(0,ue.jsx)(fe.Z,{icon:C.o,style:{...!s.isMobile&&{height:20,width:20,marginRight:8,marginTop:-2}},...e}),style:{width:240},originGap:2,placementToOrigin:xe.pO.Right,alignmentToOrigin:xe.vR.Start})}function Ye(e){let{propertyFilter:t,onChange:o,schema:r,parentStore:i,allowAddingToCombinatorFilter:n,onDelete:l,onAddToCombinatorFilter:a,context:c}=e;window.__c={n:"DesktopTopActionsComponent"};const d=(0,s.Fg)();if(c!==Pe.PropertyFilter)return null;const{property:u}=t,h=r[u];return h?(0,ue.jsxs)("div",{style:{display:"flex",color:d.lightTextColor,fontSize:12,marginBottom:6},children:[(0,ue.jsx)("span",{style:{flexShrink:1,marginLeft:8,...T.Z.textOverflowStyle},children:(0,ue.jsx)(Je,{propertyFilter:t,onChange:o,propertySchema:h})}),(0,p.a_)(t.filter)&&(0,ue.jsx)(Ee,{propertyFilter:t,onChange:o}),(0,ue.jsx)(Qe,{propertyFilter:t,schema:r,parentStore:i,onChange:o}),(0,ue.jsx)("div",{style:{flexGrow:1}}),(0,ue.jsx)(Xe,{allowAddingToCombinatorFilter:n,onDelete:l,onAddToCombinatorFilter:a})]}):null}function et(e){let{propertyFilter:t,schema:o,context:r,onChange:i,parentStore:n}=e;const{property:s}=t,l=o[s];return l?r===Pe.PropertyFilter?(0,ue.jsxs)("div",{style:{display:"flex"},children:[(0,ue.jsx)("span",{style:{fontWeight:T.Z.fontWeight.medium,flexShrink:1,marginLeft:8,maxWidth:150,...T.Z.textOverflowStyle},children:(0,ue.jsx)(Je,{propertyFilter:t,onChange:i,propertySchema:l})}),(0,p.a_)(t.filter)&&(0,ue.jsx)(Ee,{propertyFilter:t,onChange:i}),(0,ue.jsx)(Qe,{propertyFilter:t,schema:o,parentStore:n,onChange:i})]}):(0,ue.jsx)(ue.Fragment,{children:l.name}):null}function tt(e){let{context:t,allowAddingToCombinatorFilter:o,onDelete:r,onAddToCombinatorFilter:i}=e;return t!==Pe.PropertyFilter?null:(0,ue.jsx)(Xe,{allowAddingToCombinatorFilter:o,onDelete:r,onAddToCombinatorFilter:i})}function ot(e){let{filter:t,intl:o,onChange:r,propertyFilter:i,schema:s,parentStore:l,allowAddingToCombinatorFilter:a,onDelete:c,onAddToCombinatorFilter:d,context:u,onClose:h}=e;window.__c={n:"TextMenuComponent"};const g=(0,n.O7)(),{device:m}=g,x=(0,ue.jsx)(pe.Z,{isInput:!0,disableDesktopPadding:!0,children:(0,ue.jsx)(Ce.ZP,{focus:!0,focusInitial:!0,focusAfterAnimation:!0,value:(0,p.vR)(t)&&t.value.value?t.value.value:"",onChange:e=>{We({type:"exact",value:e.target.value},r,i)},onClearButtonClick:()=>{We({type:"exact",value:void 0},r,i)},placeholder:o.formatMessage({defaultMessage:"Type a value…",id:"database.filterValue.textType.searchPlaceholder"}),showClearButton:!0,textWrapperStyle:{marginLeft:8,marginRight:8}})}),f=(0,ue.jsxs)(pe.Z,{disableMobileBorders:!0,disableMobilePadding:!0,children:[!m.isMobile&&(0,ue.jsx)(Ye,{propertyFilter:i,onChange:r,schema:s,parentStore:l,allowAddingToCombinatorFilter:a,onDelete:c,onAddToCombinatorFilter:d,context:u}),(0,p.vR)(t)&&x]});let C;return C=m.isMobile?{menuType:L.og.Modal,title:(0,ue.jsx)(et,{propertyFilter:i,schema:s,context:u,onChange:r,parentStore:l}),left:(0,ue.jsx)(tt,{context:u,allowAddingToCombinatorFilter:a,onDelete:c,onAddToCombinatorFilter:d}),right:(0,ue.jsx)(ae.DoneMenuText,{}),onClickRight:h,header:f}:{menuType:L.og.Popup,maxHeight:p.ot,width:220,header:f},(0,ue.jsx)(ne.Z,{...C})}function rt(e){let{filter:t,intl:o,onChange:r,propertyFilter:i,schema:s,parentStore:l,allowAddingToCombinatorFilter:a,onDelete:c,onAddToCombinatorFilter:d,context:u,onClose:h}=e;window.__c={n:"NumberMenuComponent"};const g=(0,n.O7)(),{device:m}=g,x=(0,ue.jsx)(pe.Z,{isInput:!0,disableDesktopPadding:!0,children:(0,ue.jsx)(Ce.ZP,{focus:!0,focusInitial:!0,focusAfterAnimation:!0,value:(0,p.vR)(t)&&"number"==typeof t.value.value?t.value.value.toString():"",inputLeft:(0,ue.jsx)(qe,{filter:t}),onChange:e=>{We({type:"exact",value:(0,G.m)(e.target.value,o)},r,i)},onClearButtonClick:()=>{We({type:"exact",value:void 0},r,i)},placeholder:o.formatMessage({defaultMessage:"Type a value…",id:"database.filterValue.numberType.searchPlaceholder"}),showClearButton:!0,textWrapperStyle:{marginLeft:8,marginRight:8}})}),f=(0,ue.jsxs)(pe.Z,{disableMobileBorders:!0,disableMobilePadding:!0,children:[!m.isMobile&&(0,ue.jsx)(Ye,{propertyFilter:i,onChange:r,schema:s,parentStore:l,allowAddingToCombinatorFilter:a,onDelete:c,onAddToCombinatorFilter:d,context:u}),(0,p.vR)(t)&&x]});let C;return C=m.isMobile?{menuType:L.og.Modal,title:(0,ue.jsx)(et,{propertyFilter:i,schema:s,context:u,onChange:r,parentStore:l}),left:(0,ue.jsx)(tt,{context:u,allowAddingToCombinatorFilter:a,onDelete:c,onAddToCombinatorFilter:d}),right:(0,ue.jsx)(ae.DoneMenuText,{}),onClickRight:h,header:f}:{menuType:L.og.Popup,maxHeight:p.ot,width:220,header:f},(0,ue.jsx)(ne.Z,{...C})}function it(e,t,o){t.setState(e),o.setState({focus:{section:0,indexLocal:0,indexGlobal:0}})}},68834:(e,t,o)=>{o.d(t,{Z:()=>l});o(67294);var r=o(86628),i=o(31278),n=o(76798),s=o(85893);const l=function(e){window.__c={n:"CollectionLocationToken"};const{collectionStore:t}=e,o=(0,r.VK)((()=>t.getIcon()),[t]);return(0,s.jsxs)("div",{style:{display:"flex",columnGap:4,alignItems:"center"},children:[(0,s.jsx)(i.Z,{disabled:!0,icon:o,isEmptyPage:!1,size:20}),(0,s.jsx)(n.Z,{store:t,style:{maxWidth:180}})]})}},31339:(e,t,o)=>{o.d(t,{Z:()=>n});o(67294);var r=o(480),i=o(85893);const n=function(e){window.__c={n:"CollectionMenuIcon"};const t=((0,r.O7)().device.isMobile,{width:16});return(0,i.jsx)("div",{style:t,children:e.icon(e.styles)})}},50959:(e,t,o)=>{o.d(t,{r_:()=>f,ZA:()=>m});o(67294);var r=o(24405),i=o(42613),n=o(16184),s=o(78807),l=o(45238),a=o(85893);const p=(0,l.I)("statusInProgressGroup",{viewBox:"0 0 17 17",svg:(0,a.jsx)("path",{d:"M8.54688 16.5078C13.0156 16.5078 16.6953 12.8281 16.6953 8.35938C16.6953 3.89844 13.0078 0.210938 8.53906 0.210938C4.07812 0.210938 0.398438 3.89844 0.398438 8.35938C0.398438 12.8281 4.07812 16.5078 8.54688 16.5078ZM8.54688 14.7188C5.02344 14.7188 2.19531 11.8828 2.19531 8.35938C2.19531 4.83594 5.01562 2 8.53906 2C12.0703 2 14.8984 4.83594 14.9062 8.35938C14.9141 11.8828 12.0703 14.7188 8.54688 14.7188ZM7.07031 11.4531L11.5938 8.80469C11.9297 8.60938 11.9219 8.125 11.5938 7.92969L7.07031 5.27344C6.71875 5.07031 6.26562 5.24219 6.26562 5.63281V11.0938C6.26562 11.4766 6.69531 11.6719 7.07031 11.4531Z"})}),c=(0,l.I)("statusTodoGroup",{viewBox:"0 0 17 17",svg:(0,a.jsx)("path",{d:"M8.52344 1.85156C8.97656 1.85156 9.34375 1.49219 9.34375 1.05469C9.34375 0.609375 8.97656 0.234375 8.52344 0.234375C8.08594 0.234375 7.72656 0.609375 7.72656 1.05469C7.72656 1.48438 8.09375 1.85156 8.52344 1.85156ZM10.7969 2.21875C11.2422 2.21875 11.6094 1.85156 11.6094 1.41406C11.6094 0.960938 11.2422 0.601562 10.7969 0.601562C10.3516 0.601562 9.99219 0.960938 9.99219 1.41406C9.99219 1.85156 10.3516 2.21875 10.7969 2.21875ZM6.27344 2.21875C6.71094 2.21875 7.07812 1.85156 7.07812 1.41406C7.07812 0.960938 6.71094 0.601562 6.27344 0.601562C5.82812 0.601562 5.46094 0.960938 5.46094 1.41406C5.46094 1.85156 5.82812 2.21875 6.27344 2.21875ZM12.8359 3.25781C13.2812 3.25781 13.6484 2.89844 13.6484 2.45312C13.6484 2.00781 13.2812 1.64062 12.8359 1.64062C12.3984 1.64062 12.0312 2.00781 12.0312 2.45312C12.0312 2.89062 12.3984 3.25781 12.8359 3.25781ZM4.23438 3.25781C4.67188 3.25781 5.03906 2.89062 5.03906 2.45312C5.03906 2.00781 4.67969 1.64062 4.23438 1.64062C3.78906 1.64062 3.42188 2.00781 3.42188 2.45312C3.42188 2.89844 3.78906 3.25781 4.23438 3.25781ZM14.4609 4.88281C14.9062 4.88281 15.2734 4.51562 15.2734 4.07812C15.2734 3.63281 14.9062 3.26562 14.4609 3.26562C14.0234 3.26562 13.6562 3.63281 13.6562 4.07812C13.6562 4.51562 14.0234 4.88281 14.4609 4.88281ZM2.625 4.88281C3.0625 4.88281 3.42969 4.51562 3.42969 4.07812C3.42969 3.63281 3.0625 3.26562 2.625 3.26562C2.17969 3.26562 1.8125 3.63281 1.8125 4.07812C1.8125 4.51562 2.17969 4.88281 2.625 4.88281ZM15.4922 6.90625C15.9375 6.90625 16.3047 6.54688 16.3047 6.10156C16.3047 5.65625 15.9375 5.28906 15.4922 5.28906C15.0547 5.28906 14.6875 5.65625 14.6875 6.10156C14.6875 6.53906 15.0547 6.90625 15.4922 6.90625ZM1.59375 6.90625C2.02344 6.90625 2.39062 6.53906 2.39062 6.10156C2.39062 5.65625 2.03125 5.28906 1.59375 5.28906C1.14062 5.28906 0.78125 5.65625 0.78125 6.10156C0.78125 6.54688 1.14062 6.90625 1.59375 6.90625ZM15.8828 9.17188C16.3281 9.17188 16.6953 8.80469 16.6953 8.35938C16.6953 7.92188 16.3281 7.55469 15.8828 7.55469C15.4453 7.55469 15.0781 7.92188 15.0781 8.35938C15.0781 8.80469 15.4453 9.17188 15.8828 9.17188ZM1.21094 9.17188C1.64844 9.17188 2.01562 8.80469 2.01562 8.35938C2.01562 7.92188 1.64844 7.55469 1.21094 7.55469C0.765625 7.55469 0.398438 7.92188 0.398438 8.35938C0.398438 8.80469 0.765625 9.17188 1.21094 9.17188ZM15.4922 11.4375C15.9375 11.4375 16.3047 11.0703 16.3047 10.625C16.3047 10.1797 15.9375 9.82031 15.4922 9.82031C15.0547 9.82031 14.6875 10.1875 14.6875 10.625C14.6875 11.0703 15.0547 11.4375 15.4922 11.4375ZM1.59375 11.4375C2.03125 11.4375 2.39062 11.0703 2.39062 10.625C2.39062 10.1875 2.02344 9.82031 1.59375 9.82031C1.14062 9.82031 0.78125 10.1797 0.78125 10.625C0.78125 11.0703 1.14062 11.4375 1.59375 11.4375ZM14.4609 13.4609C14.9062 13.4609 15.2734 13.0938 15.2734 12.6484C15.2734 12.2109 14.9062 11.8438 14.4609 11.8438C14.0234 11.8438 13.6562 12.2109 13.6562 12.6484C13.6562 13.0938 14.0234 13.4609 14.4609 13.4609ZM2.625 13.4609C3.0625 13.4609 3.42969 13.0938 3.42969 12.6484C3.42969 12.2109 3.0625 11.8438 2.625 11.8438C2.17969 11.8438 1.8125 12.2109 1.8125 12.6484C1.8125 13.0938 2.17969 13.4609 2.625 13.4609ZM12.8359 15.0859C13.2812 15.0859 13.6484 14.7188 13.6484 14.2734C13.6484 13.8281 13.2812 13.4688 12.8359 13.4688C12.3984 13.4688 12.0312 13.8359 12.0312 14.2734C12.0312 14.7188 12.3984 15.0859 12.8359 15.0859ZM4.23438 15.0859C4.67969 15.0859 5.03906 14.7188 5.03906 14.2734C5.03906 13.8359 4.67188 13.4688 4.23438 13.4688C3.78906 13.4688 3.42188 13.8281 3.42188 14.2734C3.42188 14.7188 3.78906 15.0859 4.23438 15.0859ZM10.7969 16.125C11.2422 16.125 11.6094 15.7656 11.6094 15.3125C11.6094 14.875 11.2422 14.5078 10.7969 14.5078C10.3516 14.5078 9.99219 14.875 9.99219 15.3125C9.99219 15.7656 10.3516 16.125 10.7969 16.125ZM6.27344 16.125C6.71094 16.125 7.07812 15.7656 7.07812 15.3125C7.07812 14.875 6.71094 14.5078 6.27344 14.5078C5.82812 14.5078 5.46094 14.875 5.46094 15.3125C5.46094 15.7656 5.82812 16.125 6.27344 16.125ZM8.52344 16.4922C8.97656 16.4922 9.34375 16.1172 9.34375 15.6719C9.34375 15.2344 8.97656 14.875 8.52344 14.875C8.09375 14.875 7.72656 15.2422 7.72656 15.6719C7.72656 16.1172 8.08594 16.4922 8.52344 16.4922Z"})});var d=o(9291),u=o(88268),h=o(32662),g=o(26388);const m={[i.G1]:(0,a.jsx)(d.FormattedMessage,{...i.ct.statusGroupNameTodo}),[i.Ho]:(0,a.jsx)(d.FormattedMessage,{...i.ct.statusGroupNameInProgress}),[i.RW]:(0,a.jsx)(d.FormattedMessage,{...i.ct.statusGroupNameComplete}),[i.Ap]:(0,a.jsx)(d.FormattedMessage,{...u.sY.current}),[i.JV]:(0,a.jsx)(d.FormattedMessage,{...u.sY.future})},x={[i.G1]:c,[i.Ho]:p,[i.RW]:s.l};function f(e){window.__c={n:"CollectionStatusGroupName"};const{group:t,disableGroup:o,style:i,showIcon:s,showColor:l}=e,p=(0,r.Fg)(),d=x[t.name]??c,u=t.color??"gray";return(0,a.jsxs)("div",{style:{...i,display:"inline-flex",alignItems:"center"},children:[s&&d({display:"inline-block",width:16,height:16,fill:l?p.accentColors[u][400]:p.mediumIconColor}),(0,a.jsx)("span",{style:{paddingLeft:s?6:void 0,color:l?p.accentColors[u][500]:void 0},children:m[t.name]??t.name}),o?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(h.Z,{size:4}),(0,a.jsx)(g.ZP,{placement:g.ug.Bottom,render:e=>(0,a.jsx)("div",{...e,children:(0,n.Q)({width:12})}),renderTooltip:e=>(0,a.jsx)("div",{...e,children:o.tooltipCaption}),disableTooltip:void 0===o.tooltipCaption})]}):null]})}},93289:(e,t,o)=>{o.d(t,{Z:()=>l});var r=o(67294),i=o(13991),n=o(77907),s=o(85893);const l=function(e){let{firstDayOfWeek:t,value:o,selectValue:l=!0,onChange:a,disabledDays:p}=e;window.__c={n:"DatePicker"};const c=(0,r.useMemo)((()=>new Date(o)),[o]),[d,u]=(0,r.useState)(c),h=(0,r.useRef)(o);(0,r.useLayoutEffect)((()=>{h.current!==o&&(u(new Date(o)),h.current=o)}),[o]);const g=(0,r.useCallback)(((e,t,o)=>{a(e.getTime())}),[a]);return(0,s.jsx)(n.LazyDayPicker,{locale:i.SP,className:"notion-calendar-picker",numberOfMonths:1,weekStartsOn:t,modifiers:l?{value:c}:{},showOutsideDays:!0,fixedWeeks:!0,onDayClick:g,onMonthSelected:u,disabled:p,month:d})}},78948:(e,t,o)=>{o.d(t,{Z:()=>s});o(67294);var r=o(68785),i=o(28992),n=o(85893);const s=function(){return(0,n.jsx)(i.Z,{title:(0,n.jsx)(r.Z,{})})}},77498:(e,t,o)=>{o.d(t,{Z:()=>S});o(30541);var r=o(43261),i=o.n(r),n=(o(67294),o(480)),s=o(86628),l=o(99036),a=o(80951),p=o(72126),c=o(9291),d=o(92658),u=o(87279),h=o(68894),g=o(78140),m=o(32163),x=o(43765),f=o(40721),C=o(72495),y=o(69872),v=o(85893);const S=function(e){let{onAccept:t,schema:o,onClose:r,allowProperty:S,isRelationProperty:b}=e;window.__c={n:"PropertySelectMenu"};const j=(0,n.O7)(),F=(0,c.useIntl)(),M=(0,s.qz)(void 0,d.Z);let w=Object.keys(o);const Z=w.some(a.wl);w=p.MR(w,(e=>{const t=(0,a.Qm)({schema:o,property:e});return t?t.name:""}));const T=Z?`${a.UU}${l.iw}`:l.iw;w=p.zu(w,T),w.unshift(T);const k=(0,s.VK)((()=>M.state.inputValue),[M]);if(S&&(w=w.filter((e=>{const t=(0,a.Qm)({schema:o,property:e});return t&&S(t)}))),k){let e=w.map((e=>{const t=(0,a.Qm)({schema:o,property:e});return t&&t.name}));e=i().filter(k,e).map((e=>{let{original:t}=e;return t})),w=w.filter((t=>{const r=(0,a.Qm)({schema:o,property:t});return r&&r.name&&e.includes(r.name)}))}const V=p.oA(w.map((e=>{const r=(0,a.Qm)({schema:o,property:e});if(!r)return null;return{key:e,render:e=>(0,v.jsx)(y.Z,{...e,propertySchema:r,format:y.L.Name}),action:()=>t(e)}}))),A=[{key:0,render:e=>(0,v.jsx)(C.Z,{...e}),items:V}],{device:_}=j,P=(0,v.jsx)(C.Z,{isInput:!0,children:(0,v.jsx)(h.ZP,{focus:!_.isMobile||void 0,focusAfterAnimation:!0,value:k,onChange:e=>M.setState({focus:!0,inputValue:e.target.value}),placeholder:b?F.formatMessage({defaultMessage:"Search for a relation property…",id:"propertySelectMenu.searchForProperty.relation.placeholder"}):F.formatMessage({defaultMessage:"Search for a property…",id:"propertySelectMenu.searchForProperty.default.placeholder"})})});let R;return R=_.isMobile?{menuType:u.og.Modal,title:b?F.formatMessage({defaultMessage:"Relation property",id:"propertySelectMenu.mobileMenu.relationProperty.header"}):F.formatMessage({defaultMessage:"Property",id:"propertySelectMenu.mobileMenu.property.header"}),right:(0,v.jsx)(f.CancelMenuText,{}),onClickRight:r,header:P}:{menuType:u.og.Popup,width:300,header:P},(0,v.jsx)(g.Z,{...R,children:0===V.length?(0,v.jsx)(C.Z,{children:(0,v.jsx)(x.Z,{title:(0,v.jsx)(c.FormattedMessage,{defaultMessage:"No results",id:"propertySelectMenu.search.noResults.title"})})}):(0,v.jsx)(m.Z,{type:m.i.Vertical,sections:A,onAccept:r,initialFocus:k.length>0?0:void 0})})}},50542:(e,t,o)=>{o.d(t,{Z:()=>c});o(67294);var r=o(480),i=o(9291),n=o(52275),s=o(97820),l=o(69872),a=o(62045),p=o(85893);const c=function(e){window.__c={n:"QueryMenuPropertyItem"};const t=(0,r.O7)(),{device:o}=t;if(o.isMobile)return e.propertySchema?(0,p.jsx)(l.Z,{propertySchema:e.propertySchema,onClick:e.onClick,focused:!1,format:l.L.Name,showExtensionArrow:!e.disabled}):(0,p.jsx)(n.Z,{focused:!1,title:(0,p.jsx)(i.FormattedMessage,{defaultMessage:"Property",id:"database.mobileFilterAndSortMenu.property.buttonMenuItem.label"})});{const t=e.propertySchema&&(0,p.jsx)(s.Z,{propertySchema:e.propertySchema,showIcon:!0,style:{lineHeight:1.4}}),o=(0,p.jsx)(i.FormattedMessage,{defaultMessage:"Property",id:"database.filterAndSortMenu.propertyButton.label"});return(0,p.jsx)(a.Z,{title:t,placeholder:o,onClick:e.onClick,disabled:e.disabled,disableMargins:e.disableMargins,desktopStyle:e.textWrapperStyle})}}},95691:(e,t,o)=>{o.d(t,{Z:()=>p});o(67294);var r=o(24405),i=o(8848),n=o(42853),s=o(82990),l=o(64921),a=o(85893);const p=function(e){window.__c={n:"SegmentedDropdownButton"};const{style:t,color:o,title:p,onClick:c,icon:d,iconStyle:u,dropdownEvents:h,className:g,disabled:m,disableDropdown:x}=e,f=(0,r.yK)((e=>({wrap:{position:"relative",display:"inline-flex",flexShrink:0,borderRadius:4,overflow:"hidden",height:28},mainButton:{display:"flex",alignItems:"center",justifyContent:"center",whiteSpace:"nowrap",borderTopLeftRadius:4,borderBottomLeftRadius:4,paddingLeft:8,paddingRight:8,fontWeight:s.Z.fontWeight.medium,..."blue"===o&&{background:i.ZP.blue,color:i.ZP.white},..."orange"===o&&{background:"dark"===e.mode?e.accentColors.orange[100]:e.accentColors.orange[50],color:"dark"===e.mode?e.accentColors.orange[600]:e.accentColors.orange[400]}},dropdownButton:{display:"flex",alignItems:"center",justifyContent:"center",width:24,alignSelf:"stretch",borderTopRightRadius:4,borderBottomRightRadius:4,..."blue"===o&&{background:i.ZP.blue,color:i.ZP.white,boxShadow:`inset 1px 0 0 ${e.darkDividerColor}`},..."orange"===o&&{background:"dark"===e.mode?e.accentColors.orange[100]:e.accentColors.orange[50],color:e.accentColors.orange[400],boxShadow:"dark"===e.mode?`${e.accentColors.orange[300]} 1px 0 0 inset`:`${e.accentColors.orange[200]} 1px 0 0 inset`}},dropdownButtonIcon:{width:10,marginTop:2,..."blue"===o&&{fill:i.ZP.white},..."orange"===o&&{fill:"dark"===e.mode?e.accentColors.orange[500]:e.accentColors.orange[400]}},buttonHoveredStyle:{..."blue"===o&&{background:e.blueButtonHoveredBackground},..."orange"===o&&{background:"dark"===e.mode?e.accentColors.orange[200]:e.accentColors.orange[100]}},buttonPressedStyle:{..."blue"===o&&{background:e.blueButtonPressedBackground},..."orange"===o&&{background:"dark"===e.mode?e.accentColors.orange[300]:e.accentColors.orange[200]}},icon:{width:12,marginRight:6,..."blue"===o&&{fill:i.ZP.white},..."orange"===o&&{fill:e.accentColors.orange[400]},...u},border:{position:"absolute",pointerEvents:"none",borderRadius:4,top:0,left:0,right:0,bottom:0,..."blue"===o&&!m&&{boxShadow:"rgba(15, 15, 15, 0.1) 0px 0px 0px 1px inset, rgba(15, 15, 15, 0.1) 0px 1px 2px"},..."orange"===o&&!m&&{boxShadow:"dark"===e.mode?`${e.accentColors.orange[300]} 0px 0px 0px 1px inset`:`${e.accentColors.orange[200]} 0px 0px 0px 1px inset`}}})),[o,u,m]);return(0,a.jsxs)("div",{style:{...f.wrap,...t},className:g,children:[(0,a.jsxs)(l.Z,{style:f.mainButton,onClick:c,disabled:m,disabledFeedback:!0,hoveredStyle:f.buttonHoveredStyle,pressedStyle:f.buttonPressedStyle,children:[d&&d(f.icon),p]}),x||m?null:(0,a.jsx)(l.Z,{disabledFeedback:!0,style:f.dropdownButton,hoveredStyle:f.buttonHoveredStyle,pressedStyle:f.buttonPressedStyle,...h,children:(0,n.i)(f.dropdownButtonIcon)}),(0,a.jsx)("div",{style:f.border})]})}},22084:(e,t,o)=>{o.d(t,{F:()=>c,a:()=>p});o(67294);var r=o(24405),i=o(8848),n=o(82990),s=o(62896),l=o(85567),a=o(85893);function p(e){window.__c={n:"SelectToken"};const{value:t,color:o,format:p,showEllipsis:c,onClickRemove:d,showRemoveButton:u,isSingle:h,shouldShrink:g,hideTooltip:m,descriptionTooltip:x,tooltipPlacement:f,...C}=e,y=(0,r.Fg)(),v=(0,r.yK)((e=>({token:{...c&&n.Z.textOverflowStyle}})),[c]),{textColor:S,backgroundColor:b}=(0,i.KR)(y,o);return t?(0,a.jsx)(l.Z,{format:p,value:(0,a.jsx)(s.Z,{children:t}),onClickRemove:d,showRemoveButton:u,isSingle:h,color:S,backgroundColor:b,shouldShrink:g,tooltipPlacement:f,showFullValueTooltip:!m,tooltip:m?void 0:x,style:v.token,...C}):null}function c(e){window.__c={n:"StatusSelectToken"};const{value:t,color:o,format:p,showEllipsis:c,onClickRemove:d,showRemoveButton:u,isSingle:h,shouldShrink:g,groupColor:m,tooltipPlacement:x,descriptionTooltip:f,hideTooltip:C,...y}=e,v=(0,r.Fg)(),S=(0,r.yK)((()=>({token:{...c&&n.Z.textOverflowStyle}})),[c]);if(!t)return null;const{textColor:b,backgroundColor:j}=(0,i.KR)(v,o??m??"gray"),F=o&&"default"!==o?o:m??"gray";return(0,a.jsx)(l.Z,{format:p,value:(0,a.jsx)(s.Z,{children:t}),onClickRemove:d,showRemoveButton:u,isSingle:h,color:b,backgroundColor:j,shouldShrink:g,showFullValueTooltip:!C,tooltip:C?void 0:f,style:S.token,isRound:!0,showColoredDot:F,tooltipPlacement:x,...y})}},11299:(e,t,o)=>{o.d(t,{S:()=>M,Z:()=>F});o(57658);var r=o(67294),i=o(480),n=o(86628),s=o(24405),l=o(76205),a=o(84619),p=o(3729),c=o(72126),d=o(9291),u=o(8406),h=o(97004),g=o(87279),m=o(50959),x=o(52275),f=o(60458),C=o(78140),y=o(32163),v=o(40721),S=o(72495),b=o(22084),j=o(85893);function F(e){window.__c={n:"StatusFilterValueMenu"};const{propertyFilter:t,schema:o,filter:a,parentStore:m,updateValue:f,onClose:b,desktopTopActions:F,mobileMenuTitle:w,mobileMoreActions:Z,collectionContextStore:T}=e,k=(0,i.O7)(),V=(0,i.Fy)(),[A,_]=(0,r.useState)([]),[P,R]=(0,r.useState)(!1),I=(0,n.VK)((()=>(0,h.tJ)(o,t,m)),[o,t,m]),O=(0,s.yK)((e=>({checkboxIcon:{fill:e.regularIconColor}})),[]),B=(0,n.VK)((()=>(0,l.vR)(a)?(0,l.wB)(a):[]),[a]),D=(0,n.VK)((()=>{if(!I||"status"!==I.type)return[];const e=I.options??[],t=null==T?void 0:T.collectionStoreResultsInViewOrder();return!P&&t?e.filter((e=>t.some((t=>{var o;return null===(o=e.collectionIds)||void 0===o?void 0:o.includes(t.id)})))):e}),[I,P,T]),L=(0,n.VK)((()=>{if(!I||"status"!==I.type)return[];const e=[],t=I.groups??[],o=I.options??[];for(const r of t){const t=(0,h.IX)({group:r,options:o,filterValues:B});if("partial"!==t.groupCheckState)continue;const i=o.filter((e=>{var t;return null===(t=r.optionIds)||void 0===t?void 0:t.includes(e.id)})).filter((e=>t.optionCheckedInfo.get(e.id)));e.push(...i)}return e}),[I,B]),H=(0,n.VK)((()=>{if(!I||"status"!==I.type)return[];const e=I.options??[];return A?e.filter((e=>!A.some((t=>t.id===e.id)))):[]}),[I,A]);(0,r.useEffect)((()=>{_((()=>c.mN([...D,...A,...L],"id")))}),[D]);const G=(0,n.VK)((()=>I&&"status"===I.type?M({propertySchema:I,statusFilterValues:B,updateValue:f,isMobile:V.isMobile,styles:{checkboxIcon:O.checkboxIcon},visibleOptions:A,shouldShowHiddenSources:P,setShouldShowHiddenSources:R}):[]),[V.isMobile,I,O.checkboxIcon,f,A,P,R,B]);if(!I||"status"!==I.type)return null;const W=(0,j.jsx)(S.Z,{desktopStyle:{paddingBottom:0},children:!V.isMobile&&F});let N;N=V.isMobile?{menuType:g.og.Modal,title:w,left:Z,right:(0,j.jsx)(v.DoneMenuText,{}),onClickRight:b,header:W}:{menuType:g.og.Popup,maxHeight:l.ot,width:260,header:W,disableHeaderBorder:!0,tokenInputHeader:!0};const K=(0,j.jsx)(y.Z,{type:y.i.Vertical,initialFocus:0,sections:[{key:"groups",items:G,render:e=>(0,j.jsx)(S.Z,{...e,title:"",style:{paddingTop:0}})}]}),U=H&&H.length>0&&!P?(0,j.jsx)(S.Z,{topBorder:!0,children:(0,j.jsx)(x.Z,{icon:(0,p.T)({width:13,height:13}),title:(0,j.jsx)(d.FormattedMessage,{id:"collectionFilterValueMenu.statusFilterValueMenu.hiddenStatusOptionsDescription",defaultMessage:"{numHiddenOptions, plural, one {{numHiddenOptions} other status option} other {{numHiddenOptions} other status options}}",values:{numHiddenOptions:H.length}}),focused:!1,onClick:()=>{R(!0),T&&u.wd({environment:k,collectionContextStore:T,action:"expand_property_filter",original_view_type:void 0,property_type:"status"})}})}):null,q=(0,j.jsx)(S.Z,{topBorder:!0,children:(0,j.jsx)(x.Z,{title:(0,j.jsx)(d.FormattedMessage,{defaultMessage:"Clear selection",id:"database.filterValue.selectType.clearSelection.message"}),focused:!1,onClick:()=>{f([])}})});return(0,j.jsx)(C.Z,{...N,children:(0,l.vR)(a)&&(0,j.jsxs)(j.Fragment,{children:[K,U,q]})})}function M(e){const{propertySchema:t,statusFilterValues:o,updateValue:r,isMobile:i,styles:n,visibleOptions:s,shouldShowHiddenSources:l}=e,p=t.groups??[],c=t.options??[],d=[];for(const u of p){const e=()=>{const e=(0,h.CN)(p,c,o,{type:"is_group",value:u.name});e&&r(e)},t=(0,h.IX)({group:u,options:c,filterValues:o}),g=c.filter((e=>{var t;return(null===(t=u.optionIds)||void 0===t?void 0:t.includes(e.id))&&(l||(null==s?void 0:s.some((t=>t.id===e.id))))})),C=[];for(const s of g){const e=()=>{const e=(0,h.CN)(p,c,o,{type:"is_option",value:s.value});e&&r(e)};C.push({key:`option-${s.id}`,action:e,render:o=>(0,j.jsx)(x.Z,{...o,icon:(0,j.jsx)(f.Z,{checked:t.optionCheckedInfo.get(s.id)??!1,size:14,onClick:e,style:n.checkboxIcon}),title:(0,j.jsx)(b.F,{format:i?a.lo.Large:a.lo.Medium,isSingle:!0,value:s.value,color:s.color,showRemoveButton:!1,groupColor:u.color}),style:{paddingLeft:16}})})}d.push({key:`group-${u.id}`,action:e,render:o=>(0,j.jsx)(x.Z,{...o,icon:(0,j.jsx)(f.Z,{checked:t.groupCheckState,size:14,onClick:e,style:n.checkboxIcon}),title:(0,j.jsx)(m.r_,{style:{fontWeight:500,marginTop:2},group:u,showIcon:!0,showColor:!0}),textWrapperStyle:{marginLeft:3}})},...C)}return d}},92658:(e,t,o)=>{o.d(t,{Z:()=>n});var r=o(49085);class i extends r.default{getInitialState(){return{inputValue:"",focus:!1}}}const n=i},5691:(e,t,o)=>{o.d(t,{m:()=>n});var r=o(38737),i=o(77080);function n(e,t){return(0,r.p3)(e,i.default.checkGate("localized_parse_number")?t:void 0)}},68965:(e,t,o)=>{o.d(t,{t:()=>n});o(67294);var r=o(45238),i=o(85893);const n=(0,r.I)("addFilterGroup",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M2.374 12.42h1.293v1.157c0 1.557.787 2.344 2.375 2.344h7.591c1.573 0 2.367-.787 2.367-2.344V5.924c0-1.557-.794-2.344-2.367-2.344h-1.3V2.423C12.333.866 11.539.08 9.966.08H2.374C.786.08 0 .866 0 2.423v7.653c0 1.557.786 2.344 2.374 2.344zm.015-1.218c-.756 0-1.172-.408-1.172-1.194V2.49c0-.786.416-1.194 1.172-1.194h7.554c.749 0 1.172.408 1.172 1.194v1.09H6.042c-1.588 0-2.375.778-2.375 2.343v5.278H2.39zm3.668 3.501c-.749 0-1.172-.408-1.172-1.194V5.991c0-.786.423-1.194 1.172-1.194h7.554c.748 0 1.172.408 1.172 1.194v7.516c0 .787-.424 1.195-1.172 1.195H6.057zm3.773-1.565c.4 0 .643-.272.643-.71v-2.042h2.17c.423 0 .718-.227.718-.628 0-.408-.272-.643-.718-.643h-2.17V6.938c0-.447-.242-.719-.643-.719-.4 0-.628.288-.628.719v2.177h-2.17c-.438 0-.718.235-.718.643 0 .4.295.628.718.628h2.17v2.041c0 .424.227.711.628.711z"})})},21197:(e,t,o)=>{o.d(t,{Q:()=>n});o(67294);var r=o(45238),i=o(85893);const n=(0,r.I)("filter",{viewBox:"0 0 16 16",svg:(0,i.jsx)("path",{d:"M1.63574 5.17969H14.3643C14.7197 5.17969 15.0068 4.88574 15.0068 4.53027C15.0068 4.1748 14.7197 3.8877 14.3643 3.8877H1.63574C1.27344 3.8877 0.993164 4.1748 0.993164 4.53027C0.993164 4.88574 1.28027 5.17969 1.63574 5.17969ZM3.05078 8.71387H12.9766C13.332 8.71387 13.6191 8.41992 13.6191 8.06445C13.6191 7.70215 13.3389 7.41504 12.9766 7.41504H3.05078C2.68848 7.41504 2.4082 7.70898 2.4082 8.06445C2.4082 8.41309 2.69531 8.71387 3.05078 8.71387ZM4.43848 12.2412H11.5889C11.9512 12.2412 12.2314 11.9473 12.2314 11.5918C12.2314 11.2363 11.9512 10.9492 11.5889 10.9492H4.43848C4.07617 10.9492 3.7959 11.2363 3.7959 11.5918C3.7959 11.9473 4.07617 12.2412 4.43848 12.2412Z"})})},38715:(e,t,o)=>{o.d(t,{N:()=>n});o(67294);var r=o(45238),i=o(85893);const n=(0,r.I)("save",{viewBox:"0 0 16 16",svg:(0,i.jsx)(i.Fragment,{children:(0,i.jsx)("path",{d:"M7.99316 10.8877C8.16406 10.8877 8.31445 10.833 8.47168 10.6758L10.7686 8.46094C10.8848 8.34473 10.9463 8.22168 10.9463 8.05762C10.9463 7.74316 10.6934 7.51074 10.3857 7.51074C10.2285 7.51074 10.0713 7.5791 9.96191 7.70215L8.99805 8.7207L8.56055 9.21973L8.62891 8.20801V1.11914C8.62891 0.78418 8.3418 0.49707 7.99316 0.49707C7.65137 0.49707 7.36426 0.78418 7.36426 1.11914V8.20801L7.43262 9.22656L6.98828 8.7207L6.03125 7.70215C5.92188 7.5791 5.75781 7.51074 5.60059 7.51074C5.29297 7.51074 5.04004 7.74316 5.04004 8.05762C5.04004 8.22168 5.1084 8.34473 5.22461 8.46094L7.52148 10.6758C7.67871 10.833 7.8291 10.8877 7.99316 10.8877ZM4.0625 15.3174H11.9307C13.4072 15.3174 14.1729 14.5586 14.1729 13.1025V6.36914C14.1729 4.91309 13.4072 4.1543 11.9307 4.1543H10.0781V5.49414H11.8486C12.4775 5.49414 12.833 5.82227 12.833 6.48535V12.9863C12.833 13.6494 12.4775 13.9775 11.8486 13.9775H4.14453C3.50879 13.9775 3.16016 13.6494 3.16016 12.9863V6.48535C3.16016 5.82227 3.50879 5.49414 4.14453 5.49414H5.92871V4.1543H4.0625C2.58594 4.1543 1.82031 4.91309 1.82031 6.36914V13.1025C1.82031 14.5586 2.58594 15.3174 4.0625 15.3174Z"})})})},78807:(e,t,o)=>{o.d(t,{l:()=>n});o(67294);var r=o(45238),i=o(85893);const n=(0,r.I)("statusCompleteGroup",{viewBox:"0 0 17 17",svg:(0,i.jsx)("path",{d:"M8.54688 16.5078C13.0156 16.5078 16.6953 12.8281 16.6953 8.35938C16.6953 3.89844 13.0078 0.210938 8.53906 0.210938C4.07812 0.210938 0.398438 3.89844 0.398438 8.35938C0.398438 12.8281 4.07812 16.5078 8.54688 16.5078ZM8.54688 14.7188C5.02344 14.7188 2.19531 11.8828 2.19531 8.35938C2.19531 4.83594 5.01562 2 8.53906 2C12.0703 2 14.8984 4.83594 14.9062 8.35938C14.9141 11.8828 12.0703 14.7188 8.54688 14.7188ZM7.71094 12.0781C8.00781 12.0781 8.27344 11.9219 8.44531 11.6562L11.8828 6.32031C11.9922 6.14844 12.0781 5.95312 12.0781 5.77344C12.0781 5.35156 11.7109 5.07031 11.3125 5.07031C11.0547 5.07031 10.8281 5.21094 10.6562 5.49219L7.6875 10.2578L6.29688 8.51562C6.10938 8.27344 5.91406 8.17969 5.67188 8.17969C5.25781 8.17969 4.92188 8.50781 4.92188 8.92969C4.92188 9.125 5 9.30469 5.14062 9.48438L6.94531 11.6641C7.16406 11.9375 7.40625 12.0781 7.71094 12.0781Z"})})}}]);