"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[6882],{5581:(e,i,t)=>{t.d(i,{Y:()=>o,h:()=>n});var s=t(97978);function n(e){s.j(e,"view_public_site_click")}function o(e,i){s.j(e,"share_menu_tab_click",i)}},18878:(e,i,t)=>{t.d(i,{mX:()=>h,mo:()=>g,nH:()=>f});t(67294);var s=t(86628),n=t(24405),o=t(72141),r=t(97880),a=t(82990),l=t(9291),d=t(34859),m=t(80444),c=t(53336),u=t(63381),p=t(85893);function g(e){window.__c={n:"RestorePermissionEdits"};const{openState:i}=e,{mainEditorCurrentBlockStore:t,currentSpaceStore:o}=(0,s.VK)((()=>m.default.state),[]),r=(0,n.yK)((e=>({scroller:{display:"flex",flexDirection:"column",maxHeight:290},editContainer:{marginTop:2,marginBottom:2,color:e.regularTextColor}})),[]);if(!t||!o)return null;const a=Date.now();return(0,p.jsx)(c.Z,{type:d.Z.Y,style:r.scroller,children:i.permissionChanges.map(((e,i)=>{let[s,n]=e;const l={timestamp:a,space_id:o.id,type:"permission-changed",permission_data:{before:s,after:n}};return(0,p.jsx)("div",{style:r.editContainer,children:(0,p.jsx)(u.Z,{rootStore:t,edit:l})},`${s.type}-${i}`)}))})}function f(e){return["remove","restrict"].includes(e.type)?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restrictAccess",defaultMessage:"Restrict access"}):"restoreTeamPermissions"===e.type?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restoreTeamPermissions",defaultMessage:"Reset Permissions"}):(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.restoreAccess",defaultMessage:"Restore access"})}function h(e){switch(e.type){case"remove":return(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restrict.description",defaultMessage:"Are you sure you want to remove this {permissionGroup} and restrict access? This page will no longer inherit share settings from the parent page.",values:{permissionGroup:x(e)}});case"restrict":return(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.remove.description",defaultMessage:"Are you sure you want to change this role and restrict access? This page will no longer inherit share settings from the parent page."});case"restore":return e.permissionChanges.length>0?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restore.description",defaultMessage:"Are you sure you want to restore access? This will inherit the following permissions from the parent page:"}):(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreNoChanges.description",defaultMessage:"Are you sure you want to restore access?"});case"restoreTeamPermissions":return(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{style:{fontWeight:a.Z.fontWeight.semibold,marginBottom:4},children:(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreTeamPermissions.mainDescription",defaultMessage:"Are you sure you want to reset permissions to match the teamspace defaults?"})}),(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.restoreTeamPermissions.warningMessage",defaultMessage:"Everyone else who is not part of the teamspace will lose access, including guests."})]});default:throw r.t1(e)}}function x(e){return(0,o.jg)(e.permissionItem)?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.user",defaultMessage:"user"}):(0,o.hV)(e.permissionItem)?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.group",defaultMessage:"group"}):(0,o.ix)(e.permissionItem)?(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.space",defaultMessage:"workspace"}):(0,p.jsx)(l.FormattedMessage,{id:"restrictedPermissionConfirmationModal.permissionGroup.generic",defaultMessage:"permission"})}},31075:(e,i,t)=>{t.d(i,{i:()=>h});t(21703),t(57658),t(67294);var s=t(87479),n=t(23867),o=t(9291),r=t(91536),a=t(54642),l=t(47307),d=t(76464),m=t(82530),c=t(64369),u=t(18878),p=t(18245),g=t(77080),f=t(85893);async function h(e){const{oldPermissionItem:i,newPermissionItem:t,wasInherited:h,environment:x,store:b,sudoModeStore:P,restrictingVisibility:y,fromPermissionWrapper:w}=e;if(!(0,s.Kf)(i,t))throw new Error("Permission type mismatch.");const v=!!P&&P.shouldSaveTransactionWithSudoMode(b),I=(0,s.nl)(i.role,t.role);if(h&&I!==t.role||y)return void(await async function(e){const{environment:i,useSudoMode:t,store:s,permissionItem:n,fromPermissionWrapper:r}=e,a="none"===n.role?{type:"remove",permissionItem:n}:{type:"restrict"},p="user_permission"===n.type&&n.user_id===i.currentUser.id;(p||await l.confirmUserAction({message:(0,u.mX)(a),acceptLabel:(0,u.nH)(a),cancelLabel:(0,f.jsx)(o.FormattedMessage,{id:"restrictedPermissionConfirmationModal.actionButton.cancel",defaultMessage:"Close"}),description:(0,f.jsx)(c.Z,{isSmall:!0,isMultiline:!0,children:(0,f.jsx)(o.FormattedMessage,{id:"restrictedPermissionConfirmationModal.footer.whisperText",defaultMessage:"Admins will still be able to restore permissions from restricted pages."})})}))&&m.createAndCommit({userAction:"PermissionItem.onAccept",environment:i,useSudoMode:t,perform:e=>{d.Pk({environment:i,store:s,permissionItem:n,shouldInherit:!0,transaction:e,fromPermissionWrapper:r})}})}({environment:x,useSudoMode:v,store:b,permissionItem:t,fromPermissionWrapper:w}));!b.isTopLevel()&&i.role!==t.role&&I!==i.role&&r.SM(x);const M="public_permission"===i.type&&"public_permission"===t.type&&"none"===i.role&&"none"!==t.role,j=("public_permission"===i.type&&"public_permission"===t.type&&!i.allow_search_engine_indexing&&t.allow_search_engine_indexing||M&&Boolean(g.default.checkGate("include_nonindexed_public_content_for_scanning")))&&Boolean(g.default.checkGate("enable_public_content_scanning"));m.createAndCommit({userAction:"PermissionItem.handlePermissionItemChange",environment:x,useSudoMode:v,perform:i=>{const s=p.default.mark("share_menu.update_page_permission_lag");d.ep({environment:x,store:b,permissionItems:[t],transaction:i,pagePermissionChangeLocation:e.location,metric:s,fromPermissionWrapper:w}),j&&i.postSubmitCallbacks.push((async e=>{e||await a.enqueueScanContentTask(x,{pagePointer:{id:b.id,table:"block",spaceId:(0,n.C)(b.pointer.spaceId)}})}))}})}},32326:(e,i,t)=>{t.d(i,{x:()=>a});var s=t(67294),n=t(24405),o=t(91376),r=t(85893);function a(e){window.__c={n:"DomainWorkspaceSettingsLink"};const{children:i}=e,t=(0,s.useCallback)((()=>{o.r$({currentTab:"settings"})}),[]),a=(0,n.yK)((e=>({settingsLink:{cursor:"pointer",userSelect:"none",WebkitUserSelect:"none",color:e.mediumTextColor,textDecoration:"underline"}})),[]);return(0,r.jsx)("span",{style:a.settingsLink,onClick:t,children:i})}},259:(e,i,t)=>{t.d(i,{V:()=>u});t(67294);var s=t(480),n=t(86628),o=t(24405),r=t(9291),a=t(64369),l=t(80444),d=t(81236),m=t(32326),c=t(85893);function u(e){window.__c={n:"LearnAboutAutogeneratedDomainsCTA"};const i=(0,s.O7)(),{WindowSizeStore:t}=i,{safePaddingLeftCSS:u,safePaddingRightCSS:p}=(0,n.VK)((()=>({safePaddingLeftCSS:t.getSafePaddingLeftCSS(8),safePaddingRightCSS:t.getSafePaddingRightCSS(8)})),[t]),{isMobile:g}=(0,s.Fy)(),{spaceStore:f,canChangeSettings:h,publicSpaceData:x}=(0,n.VK)((()=>{const e=l.default.state.currentSpaceStore;return e?{spaceStore:e,canChangeSettings:e.canAdmin(),publicSpaceData:d.Z.getPublicSpaceData(i,e.id)}:{}}),[i]),b=(0,o.yK)((i=>({container:{boxShadow:`0 -1px 0 ${i.regularDividerColor}`,width:"100%",display:"flex",alignItems:"center",justifyContent:"center",flexDirection:"column",textAlign:"center",padding:"8px 8px",paddingLeft:u,paddingRight:p,color:i.mediumTextColor,backgroundColor:i.inputBackground,...e.style}})),[e.style,u,p]);return f?g?null:x&&h?(0,c.jsx)("span",{style:b.container,children:(0,c.jsx)("div",{style:{display:"flex"},children:(0,c.jsx)(a.Z,{isSmall:!0,isMobile:!1,isSecondaryColor:!0,style:{paddingRight:"4px"},children:e.title?e.title:(0,c.jsx)(r.FormattedMessage,{defaultMessage:"Set up a public domain in <settings>settings</settings>.",id:"blockPermissionsSettings.learnAboutAutogeneratedDomains.setDomainForPublicLinks",values:{settings:e=>(0,c.jsx)(m.x,{children:e})}})})})}):null:null}},79395:(e,i,t)=>{t.d(i,{Z:()=>he});var s=t(67294),n=t(480),o=t(86628),r=t(24405),a=t(15145),l=t(41892),d=t(9999),m=t(45238),c=t(85893);const u=(0,m.I)("blueCircleDot",{viewBox:"0 0 16 16",svg:(0,c.jsxs)(c.Fragment,{children:[(0,c.jsxs)("circle",{cx:"8",cy:"8",r:"8",fill:"none",stroke:"#2383E2",children:[(0,c.jsx)("animate",{attributeName:"r",from:"3",to:"8",dur:"1s",begin:"0s",repeatCount:"indefinite"}),(0,c.jsx)("animate",{attributeName:"opacity",from:"1",to:"0",dur:"1s",begin:"0s",repeatCount:"indefinite"})]}),(0,c.jsx)("circle",{cx:"8",cy:"8",r:"3",fill:"#2383E2"})]})});var p=t(40462),g=t(84169),f=t(27714),h=t(72141),x=t(21202),b=t(70203),P=t(82990),y=t(9291),w=t(36610),v=t(5581),I=t(893),M=t(91376),j=t(12714),S=t(42922),C=t(64921),_=t(73063),k=t(74194),T=t(63296),Z=t(24006),L=t(26388),F=t(64369),D=t(60442),A=t(97978),R=t(84210),B=t(33929),W=t(18514),U=t(48779),V=t(31075),E=t(68973),K=t(80444),O=t(77080),G=t(81236),N=t(54669),z=t(88893),H=t(259),Y=t(13991),$=t(7057),J=t(42853),q=t(72126),Q=t(63143),X=t(52275),ee=t(31945),ie=t(78140),te=t(32163),se=t(89728),ne=t(72495),oe=t(93289),re=t(42782),ae=t(28020),le=t(43250),de=t(87279),me=t(61766),ce=t(60709);function ue(e){window.__c={n:"PublicPermissionItemLinkExpirationMenu"};const i=(0,n.Fy)(),[,,t]=(0,o.AF)(void 0,me.Z),s=(0,r.Fg)(),a=(0,n.O7)(),l=(0,o.VK)((()=>(0,z.y$)(a)),[a]),{buttonMenuItemStyle:d}=(0,r.yK)((()=>({buttonMenuItemStyle:{opacity:e.disabled?.6:1,cursor:e.disabled?"not-allowed":""}})),[e.disabled]);return(0,c.jsx)(ee.ZP,{...e.upsellEvents,disablePopup:!l,disabled:e.disabled,popupType:i.isMobile?ee.Z4.SlideUp:ee.Z4.Popup,buttonPopupStore:t,renderOrigin:i=>(0,c.jsx)(X.Z,{...i,focused:!1,disabled:e.disabled,style:d,title:(0,c.jsxs)(F.Z,{children:[(0,c.jsx)(y.FormattedMessage,{id:"publicPermissionItem.expirationTime.label",defaultMessage:"Link expiration"})," ",e.upgradeLabel]}),right:(0,c.jsxs)(se.Z,{...i,disabled:e.disabled,ignoreLocalHoverState:!0,style:{paddingLeft:0,paddingRight:0},children:[(0,c.jsx)(pe,{permissionItem:e.permissionItem}),(0,J.i)({width:10,marginLeft:4,fill:s.lightIconColor})]})}),alignmentToOrigin:ce.lU.End,placementToOrigin:ce.Iw.Bottom,render:t=>{const s=[{key:"options",render:e=>(0,c.jsx)(ne.Z,{...e}),items:fe().map((i=>({key:i.type,action:()=>{ge(e,a,i.time),t.close()},render:e=>(0,c.jsx)(X.Z,{...e,focused:e.focused,disabled:!1,title:i.title,caption:i.caption})})))},{key:"custom",render:e=>(0,c.jsx)(ne.Z,{...e,topBorder:!0}),items:[{key:"custom",action:()=>{t.close()},render:(i,s)=>(0,c.jsx)(re.Z,{...i,renderOrigin:e=>(0,c.jsx)(X.Z,{...e,disabled:!1,title:(0,c.jsx)(y.FormattedMessage,{id:"publicPermissionItem.expiration.chooseDate",defaultMessage:"Choose date"})}),onFocus:s.onFocus,disableDefaultClick:!0,renderExtension:(i,s)=>(0,c.jsx)("div",{style:{padding:"18px 14px 14px"},children:(0,c.jsx)(oe.Z,{...i,firstDayOfWeek:ae.AK.state,value:e.permissionItem.expiration_timestamp||(new Date).getTime(),onChange:i=>{ge(e,a,i),s.close(),t.close()},disabledDays:{before:new Date}})})})}]}];let n;return n=i.isMobile?{menuType:de.og.Modal,title:(0,c.jsx)(y.FormattedMessage,{id:"publicPermissionsMenu.expiration.mobile.title",defaultMessage:"Expiration time"}),right:(0,c.jsx)(y.FormattedMessage,{id:"publicPermissionsMenu.expiration.mobile.label",defaultMessage:"Done"}),onClickRight:t.close}:{menuType:de.og.Popup,width:264},(0,c.jsx)(ie.Z,{className:le.IpQ,...n,children:(0,c.jsx)(te.Z,{type:te.i.Vertical,initialFocus:void 0,sections:s})})}})}function pe(e){const{permissionItem:i}=e;return!i.expiration_timestamp||(0,h.o7)(i)?(0,c.jsx)(y.FormattedMessage,{id:"publicPermissionItem.expiration.never",defaultMessage:"Never"}):(0,c.jsx)(F.Z,{children:e.permissionItem.expiration_timestamp&&(0,$.tv)(e.permissionItem.expiration_timestamp,Y.SP)})}function ge(e,i,t){const{permissionItem:s,onChange:n}=e;if("public_permission"!==s.type)return;if(void 0!==t&&t<=(new Date).getTime())return;const o=s,r=q.d9(o),a=t;r.expiration_timestamp=a,n(r),w.n4(i,{expiration_time:a})}function fe(){const e=(new Date).getTime()+Q.U6,i=(new Date).getTime()+Q.A0,t=(new Date).getTime()+7*Q.A0;return[{type:"never",time:void 0,title:(0,c.jsx)(y.FormattedMessage,{id:"publicPermissionItem.expiration.never",defaultMessage:"Never"})},{type:"hour",time:e,title:(0,c.jsx)(y.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.hour",defaultMessage:"In an hour"}),caption:new Intl.DateTimeFormat(Y.SP,{hour:"numeric",minute:"numeric"}).format(e)},{type:"day",time:i,title:(0,c.jsx)(y.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.day",defaultMessage:"In a day"}),caption:new Intl.DateTimeFormat(Y.SP,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(i)},{type:"week",time:t,title:(0,c.jsx)(y.FormattedMessage,{id:"permissionItem.publicPermissionItem.expiration.week",defaultMessage:"In a week"}),caption:new Intl.DateTimeFormat(Y.SP,{day:"numeric",month:"long",hour:"numeric",minute:"numeric"}).format(t)}]}function he(e){window.__c={n:"PublishToWebSettings"};const{store:i,mostPermissivePublicItem:t,permissionItemArgs:l,shouldAskForConfirmationOnPublish:m,onUnpublish:f,showAllPublishedSites:h}=e,{permissionItem:w,from:I}=t,{sudoModeStore:k,location:Z,onUpgradeButtonClick:D}=l,A=(0,n.O7)(),{isMobile:B}=A.device,O=(0,o.VK)((()=>{const e=K.default.state.currentSpaceStore;return!B&&!(0,U.Cx)(e)&&h}),[B,h]),N=(0,o.VK)((()=>{const e=A.WindowSizeStore;return{marginLeft:e.getSafePaddingLeftCSS(14),marginRight:e.getSafePaddingRightCSS(14)}}),[A]),z=(0,r.yK)((e=>({titleContainer:{color:e.blueColor,fontWeight:P.Z.fontWeight.medium,fontSize:14,display:"flex",alignItems:"center",margin:"0px 16px 10px",paddingTop:B?4:0},title:{display:"flex",alignItems:"center",color:e.blueColor,fontWeight:P.Z.fontWeight.medium},helpIcon:{width:16,height:16,fill:e.blueColor},icon:{height:16,width:16,marginRight:6},linkSharingOptions:{marginTop:10,marginBottom:15,marginLeft:2,marginRight:2},learnAboutDomainsCTA:{fontSize:14,marginTop:3,marginLeft:6,marginRight:6,padding:0,backgroundColor:void 0,boxShadow:void 0,textAlign:"left",alignItems:"flex-start"},buttonGroup:{marginLeft:14,marginRight:14,marginTop:16,marginBottom:12,display:"flex",gap:10},button:{flexGrow:1,height:34},disabledButton:{opacity:.7,cursor:"not-allowed"},allSitesButton:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:12,padding:4,borderRadius:4,...N},aliasIcon:{marginRight:4,height:16,width:16,fill:e.mediumTextColor},divider:{color:e.regularDividerColor}})),[B,N]),Y=(0,o.VK)((()=>!i.canAdmin()),[i]),$=I.table===x.iU?I.blockId:I.teamId,J=(0,s.useCallback)((e=>{(0,V.i)({oldPermissionItem:w,newPermissionItem:{...w,...e},wasInherited:$!==i.id,environment:A,store:i,sudoModeStore:k,location:Z})}),[w,$,i,A,k,Z]),q=(0,s.useCallback)((async()=>{let e=!0;m&&(e=await E.eT(b.QaF(i.getTitleValue()))),e&&(J({role:"none"}),f&&f())}),[J,f,m,i]),Q=(0,o.VK)((()=>(0,R.ZP)({store:i,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=G.Z.getPublicSpaceData(A,i.getSpaceId()))||void 0===e?void 0:e.domain},pageVisitSource:a.tY.LinkInPage})),[i,A]),X=(0,s.useCallback)((()=>{v.h(A),j.D({url:Q,environment:A})}),[A,Q]),ee=(0,s.useCallback)((()=>{M.r$({currentTab:"sites"})}),[]);return(0,c.jsxs)("div",{children:[(0,c.jsxs)("div",{style:z.titleContainer,children:[u(z.icon),(0,c.jsx)("div",{style:z.title,children:(0,c.jsx)(y.FormattedMessage,{defaultMessage:"Live on the web.",id:"publishTab.settings.liveOnWeb.title"})}),(0,c.jsx)(_.Z,{iconStyle:z.helpIcon,onClick:()=>{j.D({environment:A,url:(0,W.UY)("guides.autogeneratedDomains")})},icon:g.m,ariaLabel:"Learn more about sites"})]}),(0,c.jsx)(xe,{currentBlockStore:i}),(0,c.jsx)(H.V,{style:z.learnAboutDomainsCTA}),(0,c.jsx)("div",{style:z.linkSharingOptions,children:(0,c.jsx)(Pe,{currentBlockStore:i,permissionItem:w,onChange:J,onUpgradeButtonClick:D})}),(0,c.jsxs)("div",{style:z.buttonGroup,children:[(0,c.jsx)(L.ZP,{disableTooltip:!Y,renderTooltip:()=>(0,c.jsx)(y.FormattedMessage,{defaultMessage:"You must have full access to this page to unpublish it",id:"publishTab.settings.liveOnWeb.unpublishTooltip"}),render:e=>(0,c.jsx)(T.Z,{onClick:q,disabled:Y,style:Y?{...z.button,...z.disabledButton}:z.button,...e,children:(0,c.jsx)(y.FormattedMessage,{defaultMessage:"Unpublish",id:"publishTab.settings.liveOnWeb.unpublish"})})}),(0,c.jsxs)(S.Z,{onClick:X,style:z.button,children:[(0,p.o)({height:16,width:16,marginRight:4}),(0,c.jsx)(y.FormattedMessage,{defaultMessage:"View site",id:"publishTab.settings.liveOnWeb.viewSite"})]})]}),O?(0,c.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:(0,c.jsxs)(C.Z,{onClick:ee,style:z.allSitesButton,children:[(0,d.J)(z.aliasIcon),(0,c.jsx)(F.Z,{isSecondaryColor:!0,children:(0,c.jsx)(y.FormattedMessage,{defaultMessage:"All published sites",id:"publishTab.settings.liveOnWeb.allSites"})})]})}):null]})}function xe(e){window.__c={n:"PageLinkButton"};const{currentBlockStore:i}=e,t=(0,n.O7)(),l=(0,o.VK)((()=>be(t)),[t]),d=(0,r.yK)((e=>({container:{...l,height:"auto"},flex:{flex:1},wrapper:{display:"flex",padding:"1px 0"},input:{flex:1,borderTopRightRadius:0,borderBottomRightRadius:0,paddingRight:0},button:{height:28,borderTopLeftRadius:0,borderBottomLeftRadius:0,borderLeft:"none"}})),[l]),m=(0,o.VK)((()=>(0,R.ZP)({store:i,preferPublicLink:!0,getSpaceDomain:()=>{var e;return null===(e=G.Z.getPublicSpaceData(t,i.getSpaceId()))||void 0===e?void 0:e.domain},pageVisitSource:a.tY.CopyLink})),[i,t]),u=(0,s.useCallback)((()=>{t.mobileNative?t.mobileNative.copyText(m,B.default.formatMessage(I.tq.copiedLinkToClipboard)):I.RD({environment:t,stringValue:m,copiedMessage:I.tq.copiedLinkToClipboard}),A.j(t,"copy_web_link")}),[t,m]);return(0,c.jsx)("div",{style:d.container,children:(0,c.jsx)("div",{style:d.flex,children:(0,c.jsxs)("div",{style:d.wrapper,children:[(0,c.jsx)(k.Z,{value:m,disabled:!0,style:d.input}),(0,c.jsx)(T.Z,{onClick:u,style:d.button,icon:f.N})]})})})}function be(e){const i=e.WindowSizeStore;return{display:"flex",alignItems:"center",width:"100%",height:e.device.isMobile?36:30,paddingTop:5,paddingBottom:5,paddingLeft:i.getSafePaddingLeftCSS(14),paddingRight:i.getSafePaddingRightCSS(14)}}function Pe(e){window.__c={n:"PageLinkOptions"};const{permissionItem:i,onUpgradeButtonClick:t,onChange:a,currentBlockStore:l}=e,d=(0,n.O7)(),m=(0,o.VK)((()=>!l.canAdmin()),[l]),u=(0,o.VK)((()=>{var e;return Boolean(null===(e=K.default.state.currentSpaceStore)||void 0===e?void 0:e.getDisableMoveToSpace())}),[]),p=h.RF(i.role),g=!1!==i.allow_duplicate,f=h.J5(i.role),x=Boolean(i.allow_search_engine_indexing),b=(0,s.useCallback)((()=>{a({role:f?"comment_only":"read_and_write"})}),[f,a]),P=(0,s.useCallback)((()=>{a({role:p?"reader":"comment_only"})}),[p,a]),v=(0,s.useCallback)((()=>{const e=!x;a({allow_search_engine_indexing:e}),w.g0(d,{allow_search_engine_indexing:e})}),[d,a,x]),I=(0,s.useCallback)((()=>{const e=!g;a({allow_duplicate:e}),w.l7(d,{allow_duplicate:e})}),[g,d,a]),M=(0,o.VK)((()=>O.default.checkGate("expiring_public_links")),[]),j=(0,o.VK)((()=>!(0,z.y$)(d)&&(0,z.M9)(d)),[d]),S=(0,o.VK)((()=>be(d)),[d]),_=(0,o.VK)((()=>m||u&&!g),[m,g,u]),k=(0,r.yK)((()=>({container:{display:"flex",flexDirection:"column",marginTop:8},optionLabel:{marginRight:"auto",opacity:m?.6:1},optionButton:m?{...S,cursor:"not-allowed"}:S})),[m,S]);return(0,c.jsxs)("div",{style:k.container,children:[(0,c.jsxs)(c.Fragment,{children:[M&&(0,c.jsx)(N.Z,{alwaysAllowClick:Boolean(i.expiration_timestamp),onClick:()=>{},analyticsName:"public_permission_item_expiration",requireUpgradeToTier:j,tooltipPlacement:L.ug.Left,renderTooltip:ve,renderUpgradeTooltip:Ie,onUpgradeClick:t,render:(e,t)=>(0,c.jsx)(ue,{upsellEvents:e,upgradeLabel:t,permissionItem:i,onChange:a,disabled:m})}),(0,c.jsx)(L.ZP,{placement:L.ug.Left,renderTooltip:ye,render:e=>(0,c.jsxs)(C.Z,{onClick:b,style:k.optionButton,disabled:m,...e,children:[(0,c.jsx)(F.Z,{style:k.optionLabel,children:(0,c.jsx)(y.FormattedMessage,{defaultMessage:"Allow editing",id:"pagePermissionItem.allowEdits.setting"})}),(0,c.jsx)(Z.Z,{on:f,onClick:b,disabled:m})]})}),(0,c.jsx)(L.ZP,{placement:L.ug.Left,renderTooltip:we,render:e=>(0,c.jsxs)(C.Z,{onClick:P,style:k.optionButton,disabled:m,...e,children:[(0,c.jsx)(F.Z,{style:k.optionLabel,children:(0,c.jsx)(y.FormattedMessage,{defaultMessage:"Allow commenting",id:"pagePermissionItem.allowComments.setting"})}),(0,c.jsx)(Z.Z,{on:p,onClick:P,disabled:m})]})})]}),(0,c.jsx)(L.ZP,{placement:L.ug.Left,renderTooltip:u&&!g?je:Me,render:e=>(0,c.jsxs)(C.Z,{onClick:I,disabled:_,style:k.optionButton,...e,children:[(0,c.jsx)(F.Z,{style:k.optionLabel,children:(0,c.jsx)(y.FormattedMessage,{defaultMessage:"Allow duplicate as template",id:"pagePermissionItem.allowDuplicateTemplate.setting"})}),(0,c.jsx)(Z.Z,{on:g,onClick:I,disabled:_})]})}),(0,c.jsx)(L.ZP,{placement:L.ug.Left,renderTooltip:ve,render:e=>(0,c.jsxs)(C.Z,{style:k.optionButton,disabled:m,...e,children:[(0,c.jsx)(F.Z,{style:k.optionLabel,children:(0,c.jsx)(y.FormattedMessage,{defaultMessage:"Search engine indexing",id:"pagePermissionItem.allowSearchEngines.setting"})}),(0,c.jsx)(Z.Z,{on:x,onClick:v,disabled:m})]})})]})}function ye(){return(0,c.jsx)(D.Z,{caption:(0,c.jsx)(y.FormattedMessage,{defaultMessage:"Any logged in Notion user can edit this page. Share the site link with people you trust.",id:"pagePermissionItem.allowEdits.tooltip"}),imageHeight:120,imageWidth:240,imageURL:l.Z.images.tooltips.share.allowEditingPng})}function we(){return(0,c.jsx)(D.Z,{caption:(0,c.jsx)(y.FormattedMessage,{defaultMessage:"Any logged in Notion user can comment on this page.",id:"pagePermissionItem.allowComments.tooltip"}),imageHeight:120,imageWidth:240,imageURL:l.Z.images.tooltips.share.allowCommentsPng})}function ve(){return(0,c.jsx)(D.Z,{caption:(0,c.jsx)(y.FormattedMessage,{defaultMessage:"If allowed, your public page may appear in search engines such as Google.",id:"pagePermissionItem.allowSearchEngine.tooltip"}),imageHeight:120,imageWidth:240,imageURL:l.Z.images.tooltips.share.allowSearchEnginesPng})}function Ie(){return(0,c.jsx)(D.Z,{imageURL:l.Z.images.tooltips.upsells.searchEngineIndexingPng,imageWidth:240,imageHeight:100,title:(0,c.jsx)(y.FormattedMessage,{defaultMessage:"Upgrade for search engine indexing",id:"pagePermissionItem.searchEngineUpgradeTooltip.title"}),caption:(0,c.jsx)(y.FormattedMessage,{defaultMessage:"Have your page appear in search engine results.",id:"pagePermissionItem.searchEngineUpgradeTooltip.caption"})})}function Me(){return(0,c.jsx)(D.Z,{caption:(0,c.jsx)(y.FormattedMessage,{defaultMessage:"If allowed, this will allow other people to duplicate your public page to their workspace.",id:"pagePermissionItem.allowDuplicateTemplate.tooltip"}),imageHeight:120,imageWidth:240,imageURL:l.Z.images.tooltips.share.allowDuplicatePng})}function je(){return(0,c.jsx)(D.Z,{caption:(0,c.jsx)(y.FormattedMessage,{defaultMessage:"This workspace does not allow page duplication to other workspaces.",id:"pagePermissionItem.duplicateTemplateDisabled.tooltip"}),imageWidth:240})}},90335:(e,i,t)=>{t.d(i,{HB:()=>h,Np:()=>f,bQ:()=>g,gi:()=>x,mk:()=>y,pR:()=>b,up:()=>p});var s=t(72126),n=t(87479),o=t(72141),r=t(21202),a=t(15047),l=t(29369),d=t(98165),m=t(46654),c=t(80444),u=t(79797);function p(e){const{store:i,showRestrictedPermissionBanner:t}=e,{canAccessParent:s}=h({store:i});return s&&(t||f({store:i}))}function g(e){const{store:i}=e;if(i.getParentTable()===a.bx)return;const t=(0,d.Om)(i);if(!t)return;const s=(0,n.Wo)((0,d.fJ)(t));for(const n of s)if((0,o.ix)(n))return n}function f(e){const{store:i}=e;if(i.getParentTable()===a.bx)return!1;const t=(0,d.Om)(i),s=t?(0,n.Wo)((0,d.fJ)(t)):[],r=i.getPermissionItems(),l={};for(const o of s)l[(0,n.OC)(o)]=o;for(const a of r){const e=a.role,i=l[(0,n.OC)(a)];if(i){if((0,o.iC)(e)&&(0,o.iC)(i.role)&&(0,n.xO)(e,i.role))return!0;if(o.KF(i)&&!o.KF(a))return!0}else if((0,o.ix)(a)||(0,o.ZQ)(a)||(0,o.RI)(a))return!0}return!1}function h(e){const{store:i}=e,t=(0,d.uJ)(i)[1];return{parentStore:t,canAccessParent:t&&t.canRead()}}function x(e){const{store:i}=e,t=(0,d.uJ)(i),s=t.find((e=>e instanceof u.G&&e.isRestricted())),n=t[t.length-1];return s||n.getParentTable()===a.bx&&n.canRead()}function b(e){const{store:i}=e,t=(0,d.VP)(i),s=c.default.state.currentSpaceStore;return Boolean((null==s?void 0:s.getDisableGuests())||(null==t?void 0:t.getDisableGuests()))}function P(e){const{mostPermissivePermissions:i,store:t,ancestorTeamId:s,type:n}=e;if(!s)return;const a=i.find((e=>{let{permissionItem:i}=e;return i.type===n&&i.team_id===s}));if(a)return a;const l=i.find((e=>{let{permissionItem:i}=e;return o.Le(i)}));return"explicit_team_guest_permission"!==n||l?{permissionItem:{type:n,role:"none",team_id:s},from:(null==l?void 0:l.from)??{table:r.iU,blockId:t.id}}:void 0}function y(e){const{spaceStore:i,store:t}=e,n=(0,m.YO)(t);let a=[];i&&(a=i.getPermissionGroups());const c=d.VP(t),u=function(e){let{mostPermissivePermissions:i,store:t}=e;const s=i.find((e=>{let{permissionItem:i}=e;return o.$D(i)}));return s||{permissionItem:{type:"public_permission",role:"none"},from:{table:r.iU,blockId:t.id}}}({mostPermissivePermissions:n,store:t}),p=function(e){let{mostPermissivePermissions:i,store:t,teamStore:s}=e;const n=i.find((e=>{let{permissionItem:i}=e;return o.ix(i)}));if(n)return n;const a=i.find((e=>o.Le(e.permissionItem)));return{permissionItem:{type:"space_permission",role:"none"},from:null!=a&&a.from||!s||"none"!==s.getSpacePermissionRole()?(null==a?void 0:a.from)??{table:r.iU,blockId:t.id}:{table:l.e0,teamId:s.id}}}({mostPermissivePermissions:n,store:t,teamStore:c}),g=P({mostPermissivePermissions:n,store:t,ancestorTeamId:null==c?void 0:c.id,type:"explicit_team_guest_permission"}),f=P({mostPermissivePermissions:n,store:t,ancestorTeamId:null==c?void 0:c.id,type:"explicit_team_permission"}),h=P({mostPermissivePermissions:n,store:t,ancestorTeamId:null==c?void 0:c.id,type:"explicit_team_owner_permission"});let x=n.filter((e=>{let{permissionItem:i}=e;return o.hV(i)}));x=s.MR(x,(e=>{if(i){return i.getPermissionGroups().findIndex((i=>i.id===e.permissionItem.group_id))}return e.permissionItem.group_id}));let b=n.filter((e=>{let{permissionItem:i}=e;return(o.zU(i)||o.LW(i))&&i.team_id!==(null==c?void 0:c.id)}));const y=new Map;b.forEach(((e,i)=>{let{permissionItem:t}=e;y.has(t.team_id)||y.set(t.team_id,i)})),b=s.MR(b,[e=>{let{permissionItem:i}=e;return y.get(i.team_id)||0},e=>{let{permissionItem:i}=e;return"explicit_team_owner_permission"===i.type?0:1}]);const w=n.filter((e=>{let{permissionItem:i}=e;return o.jg(i)})),v=Boolean(null==c?void 0:c.isDefined()),I="none"!==p.permissionItem.role,M=I||v||w.length>1||w.length&&!o.zz(w[0].permissionItem.role)||x.length||o.YX(p.permissionItem.role);return{showRestrictedPermissionBanner:n.some((e=>o.Le(e.permissionItem)&&e.from.table===r.iU&&e.from.blockId===t.id)),showTeamPermission:v,showSpacePermission:I,mostPermissivePublicItem:u,mostPermissiveAncestorTeamOwnerItem:h,mostPermissiveAncestorTeamMemberItem:f,mostPermissiveAncestorTeamGuestItem:g,mostPermissiveSpaceItem:p,pagePermissionUIModel:{showUserPermissions:M,mostPermissiveGroupPermissions:x,mostPermissiveTeamPermissions:b,mostPermissiveUserPermissions:w,spacePermissionGroups:a},permissionItemsCount:(M?w.length:0)+b.length+x.length+(I?1:0)+(v?1:0)}}},20218:(e,i,t)=>{t.d(i,{J_:()=>d,a2:()=>l,oM:()=>a});var s=t(29974),n=t(77907),o=t(88632),r=t(29026);async function a(e){const{environment:i,spaceStore:t,domainName:n}=e;return await s._u({environment:i,spaceStore:t,domain:n}).then((e=>"success"!==e.type?"loading":e.data.domainState))}const l=async(e,i)=>{if(!o.Z.state.online)return[];const t=await n.deps.searchActions.loader(),s=await t.searchPublicPages({environment:i,query:e,source:"public_home_page_menu",limit:r.Xv});return""===e?s.splice(0,5):s};async function d(e){const{environment:i,spaceStore:t,domain:n,onComplete:o}=e;await s.Y5({environment:i,spaceId:t.getSpaceId(),domain:n})&&(await s.u3({environment:i,spaceStore:t,domain:n}),o())}},32856:(e,i,t)=>{t.d(i,{D:()=>o});var s=t(86628),n=t(77080);function o(e){window.__c={n:"ExperimentSwitch"};const{experimentId:i,groups:t,disableExposureLogging:o}=e,r=function(e){const{experimentId:i,disableExposureLogging:t,defaultGroup:o}=e;return(0,s.VK)((()=>n.default.getEligibleGroup({experimentId:i,defaultGroup:o??"control",disableExposureLogging:t})),[i,t,o])}({experimentId:i,disableExposureLogging:o});return t[r]}},85354:(e,i,t)=>{t.d(i,{u:()=>o});t(67294);var s=t(45238),n=t(85893);const o=(0,s.I)("sites",{viewBox:"0 0 22 17",svg:(0,n.jsx)("path",{d:"M3.305 15.164c-.844 0-1.482-.216-1.914-.648-.433-.428-.649-1.058-.649-1.891V3.117c0-.838.216-1.471.649-1.898.437-.427 1.075-.64 1.914-.64h13.382c.844 0 1.482.213 1.915.64.432.427.648 1.06.648 1.898v5.524l-1.234-1.25a.985.985 0 00-.149-.11.613.613 0 00-.148-.086v-2.57H2.28v7.867c0 .38.097.664.29.852.197.187.476.281.835.281h11.469l-.023 1.54H3.305zm.148-11.836a.68.68 0 00.508-.219.697.697 0 000-1.015.68.68 0 00-.508-.219.714.714 0 00-.523.219.71.71 0 00-.211.508c0 .192.07.362.21.507.147.146.321.22.524.22zm2.305 0c.198 0 .367-.07.508-.21a.705.705 0 000-1.024.68.68 0 00-.508-.219.714.714 0 00-.524.219.71.71 0 00-.21.508.718.718 0 00.734.726zm2.297 0c.198 0 .37-.07.515-.21a.705.705 0 000-1.024.705.705 0 00-.515-.219.705.705 0 00-.516.219.71.71 0 00-.21.508.718.718 0 00.726.726zm7.922 10.695l.078-6.156c.005-.161.073-.265.203-.312.13-.052.25-.024.36.086l4.234 4.336c.125.12.153.247.085.382-.062.13-.174.198-.335.204L19 12.608l1.344 3.11a.374.374 0 01.023.25c-.02.088-.08.153-.18.195l-.773.305a.313.313 0 01-.266-.008.41.41 0 01-.18-.195l-1.265-3.149-1.117 1.133a.372.372 0 01-.398.102c-.146-.047-.217-.157-.211-.329z"})})}}]);