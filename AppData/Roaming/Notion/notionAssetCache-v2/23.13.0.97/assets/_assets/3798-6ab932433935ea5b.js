"use strict";(self.webpackChunknotion_next=self.webpackChunknotion_next||[]).push([[3798],{62967:(e,t,n)=>{n.d(t,{$J:()=>E,CJ:()=>Z,MV:()=>B,RE:()=>x,aS:()=>V,cN:()=>A,cs:()=>P,kv:()=>F,q7:()=>U,wL:()=>O,zz:()=>T});n(67294);var o=n(41432),r=n(8848),i=n(97880),a=n(9291),s=n(96802),l=n(82530),c=n(40663),d=n(93405),u=n(48019),p=n(52275),m=n(78140),f=n(40721),g=n(86825),h=n(26388),v=n(42782),b=n(95477),y=n(19037),_=n(47853),S=n(33929),w=n(87279),k=n(98742),I=n(5162),C=n(85893);const x=(0,a.defineMessages)({deleteName:{id:"action.delete.name",defaultMessage:"Delete"},undoName:{id:"action.undo.name",defaultMessage:"Undo"},redoName:{id:"action.redo.name",defaultMessage:"Redo"},duplicateName:{id:"action.duplicate.name",defaultMessage:"Duplicate"},duplicateToPrivateName:{id:"action.duplicateToPrivate.name",defaultMessage:"Duplicate to Private"},turnIntoName:{id:"action.turnInto.name",defaultMessage:"Turn into"},copyLinkName:{id:"action.copyLink.name",defaultMessage:"Copy link to block"},copyLinkNavigableTypeName:{id:"action.copyLinkNavigableType.name",defaultMessage:"Copy link"},showCodePreviewFormat:{id:"action.showCodePreviewFormat.name",defaultMessage:"Preview"},showOnlyCodeFormat:{id:"action.showOnlyCodeFormat.name",defaultMessage:"Code"},showSplitViewFormat:{id:"action.showSplitViewFormat.name",defaultMessage:"Split"},searchPlaceholder:{defaultMessage:"Search for a language…",id:"codeBlock.searchPrompt"},backgroundColorDefaultKeywords:{id:"action.backgroundColor.default.fuzzySearchKeyword",defaultMessage:"Default Black White"},foregroundColorGrayKeywords:{id:"action.foregroundColor.gray.fuzzySearchKeyword",defaultMessage:"Grey Gray"},backgroundColorGrayKeywords:{id:"action.backgroundColor.gray.fuzzySearchKeyword",defaultMessage:"Grey Gray background Greybackground Graybackground"},foregroundColorBrownKeywords:{id:"action.foregroundColor.brown.fuzzySearchKeyword",defaultMessage:"Brown"},backgroundColorBrownKeywords:{id:"action.backgroundColor.brown.fuzzySearchKeyword",defaultMessage:"Brown background Brownbackground"},foregroundColorOrangeKeywords:{id:"action.foregroundColor.orange.fuzzySearchKeyword",defaultMessage:"Orange"},backgroundColorOrangeKeywords:{id:"action.backgroundColor.orange.fuzzySearchKeyword",defaultMessage:"Orange background Orangebackground"},foregroundColorYellowKeywords:{id:"action.foregroundColor.yellow.fuzzySearchKeyword",defaultMessage:"Yellow"},backgroundColorYellowKeywords:{id:"action.backgroundColor.yellow.fuzzySearchKeyword",defaultMessage:"Yellow background Yellowbackground"},foregroundColorTealKeywords:{id:"action.foregroundColor.teal.fuzzySearchKeyword",defaultMessage:"Teal green"},backgroundColorTealKeywords:{id:"action.backgroundColor.teal.fuzzySearchKeyword",defaultMessage:"Teal green background Tealbackground Greenbackground"},foregroundColorBlueKeywords:{id:"action.foregroundColor.blue.fuzzySearchKeyword",defaultMessage:"Blue"},backgroundColorBlueKeywords:{id:"action.backgroundColor.blue.fuzzySearchKeyword",defaultMessage:"Blue background Bluebackground"},foregroundColorPurpleKeywords:{id:"action.foregroundColor.purple.fuzzySearchKeyword",defaultMessage:"Purple"},backgroundColorPurpleKeywords:{id:"action.backgroundColor.purple.fuzzySearchKeyword",defaultMessage:"Purple background Purplebackground"},foregroundColorPinkKeywords:{id:"action.foregroundColor.pink.fuzzySearchKeyword",defaultMessage:"Pink"},backgroundColorPinkKeywords:{id:"action.backgroundColor.pink.fuzzySearchKeyword",defaultMessage:"Pink background Pinkbackground"},foregroundColorRedKeywords:{id:"action.foregroundColor.red.fuzzySearchKeyword",defaultMessage:"Red"},backgroundColorRedKeywords:{id:"action.backgroundColor.red.fuzzySearchKeyword",defaultMessage:"Red background Redbackground"},backgroundSectionKeywords:{id:"action.section.background.fuzzySearchKeywords",defaultMessage:"Color Background"},backgroundSection:{id:"action.section.background",defaultMessage:"Background"},colorSection:{id:"action.section.color",defaultMessage:"Color"},colorName:{id:"action.color.name",defaultMessage:"Color"},duplicateCollectionSchemaOnlyName:{id:"action.duplicateSchemaOnly.name",defaultMessage:"Duplicate without content"},duplicateCollectionWithDataName:{id:"action.duplicateWithData.name",defaultMessage:"Duplicate with content"}}),T=e=>{let{title:t}=e;return t},M={maxWidth:400,whiteSpace:"pre-wrap"};function P(e){const{key:t,displayName:n,displayNameInterpolatedValues:o,contextualDisplayName:r,analyticsName:i,analyticsActionType:a,fuzzySearchKeywords:s,svg:l,validators:c,shortcuts:d,sortScoreMultiplier:u,closeParentMenu:p,action:m,subActions:f,collapseSubActionsIntoParent:g,nativeImageReference:h,alwaysShowInSearch:v,right:b,renderTooltip:y,userProvidedSearchName:_,hideFromSlashActionMenu:S}=e,{formattedDisplayName:w,searchName:k}=R({displayName:n,displayNameInterpolatedValues:o,userProvidedSearchName:_,fuzzySearchKeywords:s});return{key:`action ${t}`,displayName:w,analyticsName:i,analyticsActionType:a,searchName:k,validators:c,shortcuts:d,sortScoreMultiplier:u,action:m,subActions:f,collapseSubActionsIntoParent:g,closeParentMenu:p,render:e.render??D({svg:l,formattedDisplayName:w,right:b,contextualDisplayName:r,shortcut:d[0],renderTooltip:y}),nativeImageReference:h,alwaysShowInSearch:v,hideFromSlashActionMenu:S}}function A(e){const{key:t,displayName:n,displayNameInterpolatedValues:o,contextualDisplayName:r,analyticsName:i,analyticsActionType:a,fuzzySearchKeywords:s,svg:l,validators:c,sortScoreMultiplier:d,closeParentMenu:u,action:p,subActions:m,collapseSubActionsIntoParent:f,nativeImageReference:g,alwaysShowInSearch:h,right:v,renderTooltip:b,userProvidedSearchName:y}=e,{formattedDisplayName:_,searchName:S}=R({displayName:n,displayNameInterpolatedValues:o,userProvidedSearchName:y,fuzzySearchKeywords:s});return{key:`action ${t}`,displayName:_,analyticsName:i,analyticsActionType:a,searchName:S,validators:c,sortScoreMultiplier:d,action:p,subActions:m,collapseSubActionsIntoParent:f,closeParentMenu:u,render:e.render??D({svg:l,formattedDisplayName:_,right:v,contextualDisplayName:r,renderTooltip:b}),nativeImageReference:g,alwaysShowInSearch:h}}function R(e){const{displayName:t,displayNameInterpolatedValues:n,fuzzySearchKeywords:o,userProvidedSearchName:r}=e,i=t?S.default.formatMessage(t,n):void 0,a=o||t,s=o?S.default.formatMessage(o):i;let l=r;return l||(l=a?s===a.defaultMessage?s:`${s} ${a.defaultMessage}`:void 0),{formattedDisplayName:i,searchName:l}}function D(e){const{formattedDisplayName:t,svg:n,shortcut:o,right:r,renderTooltip:i}=e;return(a,s,l)=>{const c=(e.contextualDisplayName?e.contextualDisplayName(s):void 0)||t;return(0,C.jsx)(h.ZP,{render:e=>(0,C.jsx)(d.Z,{...(0,k.Z)(a,e),title:c,svg:n,shortcut:o,right:"function"==typeof r?r(a,s,l):r}),renderTooltip:()=>(0,C.jsx)("div",{style:M,children:null==i?void 0:i({title:c})}),disableTooltip:!i,placement:h.ug.Right})}}function E(e){const{key:t,title:n,overrideSearchTitle:o,render:r,actions:i}=e,a=n?S.default.formatMessage(n):void 0,s=o||n,l=s&&S.default.formatMessage(s);return{key:t,title:a,searchTitle:s?l===s.defaultMessage?l:`${l} ${s.defaultMessage}`:void 0,render:r,actions:i}}function B(e){const{key:t,displayName:n,displayNameInterpolatedValues:o,analyticsName:r,validators:i,subActions:a,collapseSubActionsIntoParent:s,svg:l,icon:c,right:g,width:h,initialFocus:b}=e,y=A({key:`extension ${t}`,displayName:n,displayNameInterpolatedValues:o,analyticsName:r,validators:i,subActions:a,collapseSubActionsIntoParent:s,closeParentMenu:!0,action:()=>{},render:(e,t,n)=>(0,C.jsx)(v.Z,{...e,renderOrigin:(e,t)=>l?(0,C.jsx)(d.Z,{...e,title:y.displayName,svg:l,right:g,ref:t}):(0,C.jsx)(p.Z,{...e,title:y.displayName,icon:c,right:g,ref:t}),onFocus:n.onFocus,renderExtension:(e,o)=>{let r;return r=t.environment.device.isPhone?{menuType:w.og.Modal,right:(0,C.jsx)(f.DoneMenuText,{}),onClickRight:o.close,...e}:{menuType:w.og.Popup,width:h??220,...e},(0,C.jsx)(m.Z,{...r,children:(0,C.jsx)(u.Z,{initialFocus:b??0,context:t,sections:a(t),onAccept:n.onAccept})})}})});return y}const F=[y.ff(y.P9(o.Ti.externalObjectInstancePage)),y.ff(y.K5),y.J5,y.ff((e=>e.blocks.some((e=>e.isDefined()&&(0,c.h7)(e))))),y.vd];function O(e){return A({key:`format ${e.key}`,displayName:e.displayName,analyticsName:e.displayName.defaultMessage,validators:e.validators,render:(t,n,o)=>{let{blocks:r,environment:i}=n;const a=r[0].getFormat(),s=Boolean(a[e.property]),{isMobile:l}=i.device;return(0,C.jsx)(g.Z,{...t,title:e.label,icon:e.svg?(0,C.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"},children:e.svg({width:l?20:17,height:l?20:17})}):void 0,on:s})},closeParentMenu:!1,action:t=>{let{environment:n,blocks:o}=t;l.createAndCommit({userAction:"actionRegistry.createFormatAction",environment:n,perform:t=>{const r=o[0],i=r.getFormat(),a=!Boolean(i[e.property]);s.FH({stores:[r],update:{[e.property]:a},transaction:t}),e.afterAction(a,n)}})}})}function Z(e){switch(e){case"default":return x.backgroundColorDefaultKeywords;case"gray":return x.foregroundColorGrayKeywords;case"gray_background":return x.backgroundColorGrayKeywords;case"brown":return x.foregroundColorBrownKeywords;case"brown_background":return x.backgroundColorBrownKeywords;case"orange":return x.foregroundColorOrangeKeywords;case"orange_background":return x.backgroundColorOrangeKeywords;case"yellow":return x.foregroundColorYellowKeywords;case"yellow_background":return x.backgroundColorYellowKeywords;case"teal":return x.foregroundColorTealKeywords;case"teal_background":return x.backgroundColorTealKeywords;case"blue":return x.foregroundColorBlueKeywords;case"blue_background":return x.backgroundColorBlueKeywords;case"purple":return x.foregroundColorPurpleKeywords;case"purple_background":return x.backgroundColorPurpleKeywords;case"pink":return x.foregroundColorPinkKeywords;case"pink_background":return x.backgroundColorPinkKeywords;case"red":return x.foregroundColorRedKeywords;case"red_background":return x.backgroundColorRedKeywords;default:return(0,i.t1)(e)}}function V(e){const t=e.thumbnail?(0,_.D)(null==e?void 0:e.thumbnail):void 0,n=Boolean(void 0!==t&&/^https?:\/\//.test(t));return{remoteImageUrl:t?`${n?"":b.default.domainBaseUrl}${t}`:void 0,localAssetBundleImagePath:n?void 0:t}}function U(e,t,n){const o=e.device.isAndroid&&!(0,I.Y)("supportsNativeMobileDynamicActionBar")?(0,r.gh)({theme:"light"}):(0,r.gh)({theme:e.ThemeStore.state.mode}),i=(0,r.fi)(t,o);let a,s,l;const c="default"!==t;t.includes("background")||null!=n&&n.includes("background")?(a="background",s=c?"square.fill":"square",l="textBackgroundColor"):(a="color",s="character",l="textColor");const d=a in i?i[a]:void 0,u=d&&(0,r.J1)(d);return{sfProGlyphName:s,localImageIdentifier:l,imageTintColor:c?u:void 0}}},52229:(e,t,n)=>{n.d(t,{k:()=>p});n(21703);var o=n(15145),r=n(41432),i=n(4615),a=n(21202),s=n(70279),l=n(95477),c=n(98165),d=n(79797),u=n(9953);function p(e){const{environment:t,parentBlock:n,targetStore:p,transaction:m}=e;if(!p.isDefined())throw new Error("Target store was not defined.");if(!n.isDefined())throw new Error("Parent block store was not defined.");const f=(0,i.ZP)(),g=p instanceof d.G;let h;if(!g){if(c.Dg(p)&&p.isDefined()){const e=p.getParentStore(),t=null==e?void 0:e.getParentStore();var v;if(null!=e&&e.isDefined())h=null==t||null===(v=t.getModel())||void 0===v?void 0:v.getRenderUrl({getRecordModel:p.getRecordModel,baseUrl:l.default.domainBaseUrl,discussionId:e.id,pageVisitSource:o.tY.LinkInPage})}}return u.j4({environment:t,id:f,type:r.Ti.alias,format:{alias_pointer:{table:g?a.iU:s.x_,id:p.id,spaceId:p.getSpaceId()},comment_alias_url:h},spaceId:n.getSpaceId(),useCrdt:n.useCrdt(),inMemoryRecordCache:n.inMemoryRecordCache,transaction:m}),d.G.createChildStore(n.getContentStore(),{table:a.iU,id:f,spaceId:n.getSpaceId()})}},36610:(e,t,n)=>{n.d(t,{NM:()=>b,XW:()=>v,ie:()=>h,vN:()=>dt,j_:()=>mt,gL:()=>ut,jd:()=>pt,cQ:()=>U,tn:()=>Be,dh:()=>M,eT:()=>A,YU:()=>Z,Op:()=>We,Zz:()=>st,Rb:()=>Ge,sd:()=>B,ze:()=>G,tM:()=>$,ik:()=>W,fM:()=>Se,$X:()=>we,$q:()=>N,en:()=>_e,Zr:()=>be,yj:()=>ye,wd:()=>z,By:()=>Xe,P_:()=>it,xh:()=>Pe,_H:()=>V,xb:()=>j,sG:()=>F,y9:()=>L,Rc:()=>H,YO:()=>_,rv:()=>O,ct:()=>k,UJ:()=>R,YM:()=>Ie,RO:()=>ke,PL:()=>Re,Py:()=>x,Bb:()=>y,Md:()=>et,y4:()=>tt,Lf:()=>ct,uD:()=>ce,iA:()=>Ce,FT:()=>Ae,du:()=>Fe,Hc:()=>Oe,K9:()=>T,DC:()=>lt,V:()=>He,Ji:()=>K,sS:()=>Qe,kq:()=>$e,DB:()=>Ke,Fj:()=>Ye,V_:()=>P,y:()=>nt,VJ:()=>qe,iS:()=>S,dw:()=>pe,gP:()=>fe,ZZ:()=>Q,XX:()=>he,WF:()=>me,yT:()=>ue,ud:()=>ge,K1:()=>de,P$:()=>ve,n2:()=>Me,wy:()=>Te,TJ:()=>je,R9:()=>at,gl:()=>Le,mt:()=>D,qD:()=>rt,KI:()=>ze,n4:()=>Ue,IM:()=>xe,f7:()=>Je,JE:()=>le,a_:()=>se,_k:()=>ae,lf:()=>ie,LE:()=>re,ne:()=>oe,gw:()=>ne,Al:()=>ee,H6:()=>J,CB:()=>te,iR:()=>Y,zI:()=>X,Jr:()=>I,l7:()=>Ne,g0:()=>Ve,jR:()=>C,g_:()=>De,Af:()=>Ee,tx:()=>Ze,Mz:()=>E,r5:()=>q,nl:()=>w});var o=n(1302),r=n(4615),i=n(9852),a=n(97978),s=n(28020),l=n(75079),c=n(12955);const d="REDACTED";function u(e){e.childNodes.forEach((e=>{e.nodeType===Node.TEXT_NODE?e.replaceWith(d):e.nodeType===Node.ELEMENT_NODE&&u(e)}))}function p(e){const t=(new DOMParser).parseFromString(e,"text/html").body;return u(t),t.innerHTML}var m=n(77080),f=n(27724),g=n(17224);function h(e,t){a.$A({environment:e,userId:(0,r.F9)(t.user_id),traits:{...t,...t.tags?{original_tags:t.tags}:void 0,user_id:(0,r.F9)(t.user_id)}})}function v(e,t){a.$A({environment:e,userId:(0,r.F9)(t.user_id),traits:{...t,user_id:(0,r.F9)(t.user_id)}})}async function b(){await a.NM()}async function y(e){const{environment:t,experiment_id:n,experiment_group:o,experiment_version:r,logging_source:s}=e,l=(0,i.Ag)(n),d=await c.getExperimentDeviceId(t);Boolean(l)&&l===(0,i.So)(r,o)||(a.j(t,"experiment_exposure",{experiment_id:n,experiment_group:o,experiment_version:r,experiment_device_id:d,logging_source:s}),(0,i.UJ)(n,o,r))}function _(e){a.j(e,"delete_workspace_click"),m.default.logEvent("delete_workspace_click")}function S(e){a.j(e,"quick_workspace_creation_click"),m.default.logEvent("quick_workspace_creation_click")}function w(e){a.j(e,"workspace_invite_copy_link"),m.default.logEvent("workspace_invite_copy_link")}function k(e,t){a.lu(e,"edit_block_text_60","edit_block_text_60",60,t)}function I(e,t){a.j(e,"todo_block_check",t)}function C(e,t){a.j(e,"toggle_block_toggle")}function x(e,t){a.j(e,"equation_block_edit",t)}function T(e,t){a.j(e,"view_link_preview",t)}function M(e,t){o.default.afterNextFlush((()=>{let n;const o=f.default.state.stores[0];o&&(n=o.getType());const{parentTeamStore:r,...i}=t;g.ej(e,"block_action",`block_action-${t.analyticsName}-${t.from}-${t.block_id}`,60,{store:r,...i,final_block_type:n})}))}function P(e){a.j(e,"open_slash_menu")}function A(e){a.j(e,"click_add_menu")}function R(e,t){a.j(e,"edit_lock_toggle",t)}function D(e,t){a.j(e,"rich_text_menu_click",t)}function E(e,t){a.j(e,"update_page_section_visibility",t)}function B(e,t,n){a.j(e,t,n)}function F(e,t){a.j(e,"board_item_delete_newly_created",t)}function O(e,t,n){if(!0===n)a.j(e,"edit_block_property_60",t);else{const n=(0,s.zj)(),{property_type:o,collection_id:r,collection_view_id:i}=t;a.lu(e,"edit_block_property_60",`edit_block_property_60-${n||""}-${o||""}-${r||""}-${i||""}`,60,t)}}function Z(e,t){a.j(e,"click_block_property_url",t)}function V(e,t){a.j(e,"create_property",t),m.default.logEvent("create_property",String(Boolean(t.is_suggested_property)),t)}function U(e,t){a.j(e,"ai_suggested_properties_shown",t),m.default.logEvent("ai_suggested_properties_shown",t.suggestion_size,t)}function N(e,t){a.j(e,"configure_property",t)}function L(e,t){a.j(e,"delete_property",t),m.default.logEvent("delete_property")}function j(e,t){a.j(e,"create_view",t)}function z(e,t){a.j(e,"configure_view",t)}function q(e,t){a.j(e,"view_settings",t),m.default.logEvent("view_settings",t.menu,t)}function H(e,t){a.j(e,"delete_view",t)}function W(e,t){a.j(e,"collection_search",t)}function K(e,t){a.j(e,"open_collection_as_page",t)}function G(e){a.j(e,"collection_no_date_menu_add")}function $(e){a.j(e,"collection_no_date_menu_view")}function Q(e,t){a.j(e,"relation_database_click",t)}function Y(e,t){a.lu(e,"timeline_view","timeline_view",5,t)}function X(e,t){a.j(e,"timeline_zoom_level_update",t)}function J(e,t){a.j(e,"timeline_today_click",t)}function ee(e,t){a.j(e,"timeline_shift_time_click",t)}function te(e,t){a.j(e,"timeline_toggle_table_click",t)}function ne(e,t){a.j(e,"timeline_item_scroll_arrow_click",t)}function oe(e,t){a.j(e,"timeline_item_resize",t)}function re(e,t){a.j(e,"timeline_dependency_arrow_add",t)}function ie(e,t){a.j(e,"timeline_dependency_arrow_delete",t)}function ae(e,t){a.j(e,"subitem_toggle_block_open",t)}function se(e,t){a.j(e,"subitem_toggle_block_close",t)}function le(e,t){a.j(e,"create_subitem",t)}function ce(e){a.j(e,"inline_collection_load_more_click")}function de(e,t){a.j(e,"relation_show_as",t)}function ue(e,t){a.j(e,"relation_reorder",t)}function pe(e,t){a.j(e,"relation_add_block",t)}function me(e,t){a.j(e,"relation_remove_block",t)}function fe(e,t){a.j(e,"relation_customize_displayed_properties",t)}function ge(e,t){a.j(e,"relation_section_link_pages",t)}function he(e,t){a.j(e,"relation_navigate_block",t)}function ve(e,t){a.j(e,"relation_update_property_visibility",t)}function be(e,t){a.j(e,"configure_rollup_relation",t)}function ye(e,t){a.j(e,"configure_rollup_target_property",t)}function _e(e,t){a.j(e,"configure_rollup_aggregation",t)}function Se(e,t){a.j(e,"collection_table_drag_and_fill",t)}function we(e,t){a.j(e,"complete_sprint_action",t)}function ke(e,t){const{collectionContextStore:n}=t.optionalAnalyticsProperties||{},o=(0,l.Pn)(n)||{},r={from:t.from,block_types:t.draggedTypes,block_count:t.draggedTypes.length,as_copy:t.asCopy||!1,draggable:t.draggableProps,dropzone:t.dropzoneProps,...o};a.j(e,"drag",r)}function Ie(e,t){a.j(e,"click_selection_menu",{block_type:t.blockType})}function Ce(e,t){a.j(e,"inline_equation_edit",t)}function xe(e,t){a.j(e,"set_reminder",{date:t.date,reminder:t.reminder})}function Te(e){a.j(e,"resize_column")}function Me(e){a.j(e,"reset_column_sizes")}function Pe(e){a.j(e,"create_column_list")}function Ae(e,t){a.j(e,"insert_column",t)}function Re(e,t){a.j(e,"drag_near_edge_scroll",t)}function De(e,t){a.j(e,"transform_text_block_filter",t)}function Ee(e,t){a.j(e,"unicode_filter",t)}function Be(e,t){a.j(e,"annotation_filter",t)}function Fe(e,t){a.j(e,"keyboard_annotation",t)}function Oe(e,t){a.j(e,"link_filter",t)}function Ze(e,t){a.j(e,"change_email",t)}function Ve(e,t){a.j(e,"toggle_allow_search_engine_indexing",t)}function Ue(e,t){a.j(e,"set_expiration_time_on_public_page",t)}function Ne(e,t){a.j(e,"toggle_allow_duplicate",t)}function Le(e,t){a.j(e,"restrict_permissions",t)}function je(e,t){a.j(e,"restore_permissions",t)}function ze(e,t){a.j(e,"set_database_sync_permissions",t)}function qe(e,t){let{source:n,types:o,fileExtensions:r,htmlContent:i}=t;const s=p(i),l=s.substring(0,m.default.getConfigKey("paste_event_logging","redactedHtmlMaxSize")),c=[...o];c.sort();const d=r.map((e=>e.toLowerCase()));a.UG(e,"paste",m.default.getConfigKey("paste_event_logging","samplePercentage"),{source:n,types:c,file_extensions:d,redacted_html_content:l,original_html_content_size:i.length,truncated:l.length!==s.length})}function He(e){a.j(e,"open_breadcrumb_current_page_menu")}function We(e){a.j(e,"click_breadcrumb_current_page_scroll_to_top")}function Ke(e,t){a.j(e,"open_page_share",t),m.default.logEvent("open_page_share")}function Ge(e,t){a.j(e,"close_page_share",t)}function $e(e){a.j(e,"open_more_menu")}function Qe(e){a.j(e,"open_more_connections_menu")}function Ye(e){a.j(e,"open_public_more_menu")}function Xe(e){a.j(e,"confirm_app_update")}function Je(e,t){a.j(e,"show_page_reload_confirmation_dialog",t)}function et(e,t){a.j(e,"export",t)}function tt(e,t){a.j(e,"export_failed",t)}function nt(e,t){a.j(e,"open_history",{from:t})}function ot(e){return Date.now()-parseInt(e.timestamp)}function rt(e,t){a.j(e,"select_snapshot",{ageMs:ot(t)})}function it(e,t){a.j(e,"history_copy",{ageMs:ot(t)})}function at(e,t){a.j(e,"restore_snapshot",{ageMs:ot(t)})}function st(e,t){var n;a.j(e,"fork_page",{blockId:t},{dontWait:!0}),m.default.logEvent("fork_page",null===(n=document.location)||void 0===n||null===(n=n.host)||void 0===n||null===(n=n.split(".notion."))||void 0===n?void 0:n[1])}function lt(e,t){a.j(e,"offline_access_failure",t)}function ct(e,t){a.j(e,"full_screen_action",t)}function dt(e){a.j(e,"admin_content_search_analytics_acknowledge_confirm")}function ut(e,t){a.j(e,"admin_content_search_analytics_filter_change",t)}function pt(e,t){a.j(e,"admin_content_search_analytics_queried",t)}function mt(e,t){a.j(e,"admin_content_search_analytics_export_requested",t)}},10910:(e,t,n)=>{n.d(t,{Bp:()=>f,HC:()=>p,NF:()=>i,RL:()=>l,Tl:()=>u,UD:()=>_,Vo:()=>s,WP:()=>v,Xw:()=>m,_e:()=>d,bd:()=>y,g_:()=>g,ov:()=>h,qG:()=>c,rT:()=>a,zi:()=>b});var o=n(97978),r=n(77080);function i(e,t){o.j(e,"ai_action",t)}function a(e,t,n){const r={site:"client",...n};o.j(e,t,r)}function s(e,t){o.j(e,"ai_favorite_action",t)}function l(e,t){o.j(e,"ai_block_action",t)}function c(e,t){o.j(e,"ai_autofill_action",t),r.default.logEvent("ai_autofill_action",1,{action_type:t.type})}function d(e,t){o.j(e,"ai_autofill_settings_action",t)}function u(e,t){o.j(e,"ai_completion_popup_open",t)}function p(e,t){o.j(e,"ai_completion_popup_close",t),r.default.logEvent("ai_completion_popup_close",1,{exit_type:t.exit_type})}function m(e,t){o.j(e,"ai_completion_popup_retry",t)}function f(e,t){o.j(e,"ai_completion_popup_history_navigation",t)}function g(e,t){o.j(e,"ai_completion_popup_preview_start",t),r.default.logEvent("ai_completion_popup_preview_start",1,{from:t.from,prompt_key:t.prompt_key})}function h(e,t){o.j(e,"ai_completion_popup_update_prompt_text",t)}function v(e,t){o.j(e,"ai_completion_popup_preview_end",t),r.default.logEvent("ai_completion_popup_preview_end",1,{preview_time:t.preview_time})}function b(e,t){o.j(e,"ai_completion_popup_preview_stopped_by_user",t)}function y(e,t){o.j(e,"ai_user_data_sharing_opt_in_submit",t)}function _(e,t){o.j(e,"getCompletion.emptyResponse",t),r.default.logEvent("getCompletion.emptyResponse",1,{promptKey:t.promptKey})}},8406:(e,t,n)=>{n.d(t,{$q:()=>h,Ac:()=>w,Rc:()=>v,S$:()=>y,YU:()=>I,_H:()=>d,bW:()=>T,bn:()=>P,g2:()=>x,gd:()=>C,gl:()=>g,mH:()=>u,nS:()=>f,qm:()=>k,rv:()=>_,tW:()=>M,tf:()=>A,wd:()=>m,xb:()=>p,y9:()=>b,zF:()=>S});var o=n(34296),r=n(97880),i=n(97978),a=n(75079),s=n(77181),l=n(36610),c=n(92973);function d(e){const{environment:t,collectionContextStore:n,...o}=e,r=(0,a.Pn)(n)||{};l._H(t,{...r,...o})}function u(e,t){i.j(e,"collection_create_suggested_property_latency",t)}function p(e){const{environment:t,collectionContextStore:n,view_type:o,view_config_uri:r,...i}=e,s=(0,a.Pn)(n)||{};l.xb(t,{...s,...i,view_type:o,view_config_uri:r})}function m(e){const{environment:t,collectionContextStore:n,action:o,original_view_type:r,new_view_type:i,new_view_id:s,property_type:c,new_date_shift_mode:d,new_avoid_weekends:u}=e,p=(0,a.Pn)(n);p&&p.view_type&&l.wd(t,{action:o,...p,view_type:p.view_type,original_view_type:r,new_view_type:i,new_view_id:s,property_type:c,new_date_shift_mode:d,new_avoid_weekends:u})}function f(e){const t=(0,a.Pn)(e.collectionContextStore);t&&t.view_type&&c.MU(e.environment,{from:e.from,from_peek_mode:e.from_peek_mode,...t,view_type:t.view_type})}function g(e){const{peek_mode:t,from_peek_mode:n}=e,o=(0,a.Pn)(e.collectionContextStore);o&&o.view_type&&c.lg(e.environment,{from:e.from,peek_mode:t,from_peek_mode:n,...o,view_type:o.view_type})}function h(e){const{environment:t,collectionContextStore:n,property:o,from:r,action:i,new_property_type:s,...c}=e,d=n.normalizedSchemaStore.state[o],u=(0,a.Pn)(n)||{};l.$q(t,{property_type:null==d?void 0:d.type,new_property_type:s,property:o,from:r,action:i,...c,...u})}function v(e){const{environment:t,collectionContextStore:n,view_type:o,from:r,...i}=e,s=(0,a.Pn)(n)||{};l.Rc(t,{from:r,...i,...s,view_type:o})}function b(e){const{environment:t,collectionContextStore:n,property_type:o,from:r,property:i,...s}=e,c=(0,a.Pn)(n)||{};l.y9(t,{property:i,property_type:o,from:r,...s,...c})}function y(e,t,n){var o,s,l;let c="page_properties";const d=(0,a.Pn)(t);switch(d.view_type){case void 0:case"page":case"table":c="table";break;case"list":c="list";break;case"gallery":c="gallery";break;case"board":c="board";break;case"calendar":c="calendar";break;case"timeline":c="timeline";break;case"chart":break;default:(0,r.t1)(d.view_type)}const u={...n,collection_id:null==t||null===(o=t.collectionStore())||void 0===o?void 0:o.id,collection_view_id:null==t||null===(s=t.collectionViewStore())||void 0===s?void 0:s.id,collection_view_block_id:null==t||null===(l=t.collectionViewBlockStore())||void 0===l?void 0:l.id,from:c};i.j(e,"copy_property",u)}function _(e){var t;const{environment:n,collectionContextStore:o,block_id:r,property:i,property_type:c,from:d,isFromBulkActionsToolbar:u,isUnthrottled:p,collection_id:m,...f}=e,g=(0,a.Pn)(o,m)||{};let h;if(null!==(t=o.currentSubitemFormatStoreForCollection.state)&&void 0!==t&&t.property){h=(0,s.EK)({blockId:r,collectionContextStore:o})?"subitem":"parent_item"}else o.currentArrowsByFormatStore.state&&(h="timeline_arrows_by");l.rv(n,{block_id:r,property:i,property_type:c,property_context:h,from:d,isFromBulkActionsToolbar:u,...f,...g},p||!1)}function S(e){const{environment:t,collectionContextStore:n,property:o,property_type:r,from:s,isFromBulkActionsToolbar:l,...c}=e,d=(0,a.Pn)(n)||{};i.j(t,"collection_open_block_property_overlay",{property:o,property_type:r,property_context:undefined,from:s,isFromBulkActionsToolbar:l,...c,...d})}function w(e){const{environment:t,collectionContextStore:n,checkbox_type:o,...r}=e,s=(0,a.Pn)(n)||{};i.j(t,"collection_multi_select_checkbox_clicked",{...s,checkbox_type:o,...r})}function k(e){const{environment:t,collectionContextStore:n,property_type:o,num_rows:r}=e,i=(0,a.Pn)(n)||{};l.fM(t,{property_type:o,num_rows:r,...i})}function I(e){const{environment:t,collectionContextStore:n,...o}=e,r=(0,a.Pn)(n)||{};l.YU(t,{...r,...o})}function C(e){const{environment:t,collectionContextStore:n,...o}=e,r=(0,a.Pn)(n)||{};i.j(t,"convert_db_start",{...r,...o})}function x(e){const{environment:t,collectionContextStore:n,...o}=e,r=(0,a.Pn)(n)||{};i.j(t,"convert_db_complete",{...r,...o})}function T(e){i.j(e,"collections.bypassed_query_collection_request")}function M(e){const{environment:t,totalResults:n,clickedIndex:r,eventName:a,sessionId:s,source:l,queryLength:c}=e;let d;l===o.S.Automation?d="automation_collection_picker":l===o.S.Relation?d="collection_settings_select_relation_source":l===o.S.Source&&(d="collection_settings_source");const u=Boolean(0===c);(0,i.j)(t,a,{source:d,"server-indexAlias":"collection",totalResults:n,clickedIndex:r,sessionId:s,queryLength:c,isEmptyQuery:u})}function P(e){i.j(e,"collection_load_more_blocks")}function A(e){i.j(e,"collection_load_more_groups")}},85344:(e,t,n)=>{n.d(t,{$5:()=>c,Em:()=>w,Je:()=>a,Rn:()=>s,SU:()=>y,Uw:()=>_,Yz:()=>u,ZW:()=>i,Zq:()=>k,bR:()=>m,d2:()=>g,hJ:()=>b,jX:()=>p,k$:()=>h,lL:()=>d,pP:()=>S,x6:()=>f,yr:()=>l,zd:()=>v});var o=n(97978),r=n(77080);function i(e,t){o.j(e,"open_block_discussion_menu",t)}function a(e){let{environment:t,from:n,notificationId:r,activityId:i}=e;o.j(t,"open_reply_discussion_menu",{from:n,notificationId:r,activityId:i})}function s(e){let{environment:t,from:n,notificationId:r,activityId:i}=e;o.j(t,"close_reply_discussion_menu",{from:n,notificationId:r,activityId:i})}function l(e){o.j(e,"open_new_block_discussion")}function c(e){o.j(e,"open_new_inline_discussion")}function d(e){o.j(e,"discard_new_discussion_dialog_show")}function u(e){o.j(e,"discard_new_discussion_dialog_confirm")}function p(e){o.j(e,"discard_new_discussion_dialog_cancel")}function m(e,t){o.j(e,"create_block_discussion",t),r.default.logEvent("create_block_discussion")}function f(e,t){o.j(e,"create_inline_discussion",t),r.default.logEvent("create_inline_discussion")}function g(e,t){o.j(e,"add_comment",t),r.default.logEvent("add_comment",t.from)}function h(e,t){o.j(e,"delete_comment",t)}function v(e,t){o.oP(e,{eventName:"edit_comment",eventProperties:t})}function b(e,t){o.j(e,"resolve_discussion",t),r.default.logEvent("resolve_discussion",t.from)}function y(e,t){o.j(e,"reopen_discussion",t)}function _(e,t){o.j(e,"click_discussion",t)}function S(e){const{environment:t,...n}=e;o.j(t,"add_reaction",n),r.default.logEvent("add_reaction",n.reaction_value)}function w(e){const{environment:t,...n}=e;o.j(t,"remove_reaction",n)}function k(e,t){o.j(e,"comment_upload_attachments",t)}},952:(e,t,n)=>{n.d(t,{W:()=>l,t:()=>c});var o=n(72126),r=n(97978),i=n(24646),a=n(17224);const s=o.P2((e=>{r.Zf(e,{created_page:!0})}),864e5,{trailing:!1});function l(e,t){const{teamStore:n,new_page_id:o,...r}=t;a.ej(e,"create_block",`create_block-${t.type}-${t.from}`,60,{store:n,...r}),"page"===t.type&&(a.YP(e,"create_page",{store:n,...r,new_page_id:o,...(0,i.UF)({environment:e})}),s(e))}function c(e,t){"onboarding"===t.from?function(e,t){const{teamStore:n,...o}=t;a.YP(e,"create_onboarding_page",{store:n,...o})}(e,{from:t.from,teamStore:t.teamStore,forkedTemplateId:t.pageId}):l(e,{type:"page",from:t.from,teamStore:t.teamStore,new_page_id:t.pageId,creating_block_id:t.pageId})}},88864:(e,t,n)=>{n.d(t,{Fn:()=>i,Gl:()=>m,Jg:()=>p,QI:()=>l,QU:()=>f,Uk:()=>s,Wl:()=>a,X0:()=>d,el:()=>c,mC:()=>u});var o=n(64002),r=n(97978);function i(e,t){r.j(e,"embed_block_action",t)}function a(e,t){r.j(e,"embed_block_resize",t)}function s(e,t){r.j(e,"download_file",t)}function l(e,t){r.j(e,"file_open_attempt",t)}function c(e,t){const n=(0,o.gy)(t.url);r.j(e,"open_embed_menu",{url_domain:null==n?void 0:n.hostname})}function d(e,t){var n;r.j(e,"click_embed_menu",{url_domain:t.url?null===(n=(0,o.gy)(t.url))||void 0===n?void 0:n.hostname:void 0,type:t.type})}function u(e,t){r.j(e,"url_turned_bookmark",t)}function p(e,t){r.j(e,"embed_type",t)}function m(e,t){r.j(e,"embed_render",t)}function f(e,t){r.j(e,"embed_client_error",t)}},68425:(e,t,n)=>{n.d(t,{VJ:()=>a,fA:()=>l,kz:()=>s,xu:()=>i});var o=n(97978),r=n(77080);function i(e){o.j(e,"open_emoji_menu")}function a(e,t){o.j(e,"emoji_no_results",t)}function s(e,t,n){o.j(e,t,n)}function l(e,t,n){o.j(e,t,n),r.default.logEvent(t,n.icon)}},57549:(e,t,n)=>{n.d(t,{AS:()=>$,B3:()=>ee,BI:()=>P,Cm:()=>B,D:()=>H,D6:()=>k,DU:()=>D,DW:()=>z,EJ:()=>R,EU:()=>re,FB:()=>O,FI:()=>h,G7:()=>y,Gl:()=>b,IG:()=>W,IN:()=>L,IV:()=>F,Iv:()=>Q,L3:()=>f,Mp:()=>J,Ng:()=>A,PR:()=>E,SC:()=>te,SO:()=>S,Sy:()=>m,Vf:()=>g,YY:()=>Z,Z3:()=>v,Z9:()=>N,_x:()=>X,a1:()=>u,ay:()=>d,bO:()=>C,cV:()=>I,eR:()=>K,fc:()=>U,iI:()=>j,lL:()=>Y,oQ:()=>ne,oS:()=>T,pZ:()=>M,pp:()=>oe,qJ:()=>_,qy:()=>p,re:()=>x,tf:()=>q,uu:()=>w,uy:()=>V,wi:()=>G});var o=n(30845),r=n(64002),i=n(97978),a=n(71776),s=n(24646),l=n(77080),c=n(35057);function d(e,t){i.j(e,"import_button_click",t)}function u(e,t){i.j(e,"import_source_auth",t)}function p(e,t){i.j(e,"import_source_input",t)}function m(e,t){i.j(e,"open_import_modal",{...t,...(0,s.UF)({environment:e})})}function f(e,t){i.j(e,"auth_integration",t)}function g(e,t){i.j(e,"integration_select_all",t)}function h(e,t){i.j(e,"integration_deselect_all",t)}function v(e,t){i.j(e,"integration_select_item",t)}function b(e,t){i.j(e,"integration_deselect_item",t)}function y(e,t){i.j(e,"import_integration",t)}function _(e,t){i.j(e,"remove_integration",t)}function S(e,t){i.j(e,"integration_prompt_auth",t)}function w(e){i.j(e,"open_google_drive_file_picker")}function k(e,t){i.j(e,"google_drive_pick_file",t)}function I(e,t){i.j(e,"google_drive_embed_file",t)}function C(e,t){const{pastedText:n}=t;let a;if(o.B(n,"url")){const e=r.Qc(n);e.host&&(a=e.host)}if(a){const{pastedText:n,...o}={...t,url_domain:a};i.j(e,"paste_url",o)}}function x(e,t){const n=t.file.lastIndexOf("."),o=n>0?t.file.substring(n+1):"",r=c.zt();o&&i.j(e,"file_uploads",{source:t.source,extension:o,subscriptionTier:r})}function T(e,t){const n=t.url?(0,r.gy)(t.url):void 0;i.j(e,"edit_link",{type:t.type,url_domain:null==n?void 0:n.hostname})}function M(e){i.j(e,"edit_link_title")}function P(e){i.j(e,"developer_integrations_list_visit")}function A(e){i.j(e,"developer_integrations_new_click")}function R(e,t){i.j(e,"developer_integrations_filter_click",t)}function D(e,t){const n=a.OS[t.table];i.j(e,"developer_integrations_view_visit",{type:n})}function E(e,t){const n=a.OS[t.table];i.j(e,"developer_integrations_create",{type:n})}function B(e,t){const n=a.OS[t.table];i.j(e,"developer_integrations_view_secret",{type:n})}function F(e,t){const n=a.OS[t.table];i.j(e,"developer_integrations_copy_secret",{type:n})}function O(e,t){const n=a.OS[t.table],{table:o,...r}=t;i.j(e,"developer_integrations_update",{type:n,...r})}function Z(e,t){i.j(e,"developer_integrations_my_integrations_click",t)}function V(e,t){i.j(e,"developer_integrations_all_integrations_click",t)}function U(e,t){i.j(e,"developer_integrations_visit_developer_website_click",t)}function N(e,t){i.j(e,"developer_integrations_contact_developer_click",t)}function L(e,t){i.j(e,"developer_integrations_disconnect_click",t)}function j(e,t){i.j(e,"developer_integrations_open_card_dropdown_click",t)}function z(e,t){i.j(e,"developer_integrations_delete_click",t)}function q(e,t){i.j(e,"developer_integrations_confirm_delete_click",t)}function H(e,t){i.j(e,"install_public_integration_oauth",t)}function W(e,t){i.j(e,"security_and_compliance_integration_oauth_attempt",t)}function K(e,t){i.j(e,"security_and_compliance_integration_install",t)}function G(e,t){i.j(e,"security_and_compliance_integration_uninstall",t)}function $(e,t){i.j(e,"security_and_compliance_integration_update",t)}function Q(e,t){i.j(e,"connect_external_integration",t),l.default.logEvent("connect_external_integration",void 0,t)}function Y(e,t){i.j(e,"disconnect_external_integration",t)}function X(e,t){i.j(e,"activate_link_preview_menu",t)}function J(e,t){i.j(e,"save_link_preview",t)}function ee(e,t){i.j(e,"update_link_preview",t)}function te(e,t){i.j(e,"open_link_preview_help_guide",t)}function ne(e,t){i.j(e,"remove_link_preview_with_error",t)}function oe(e,t){i.j(e,"link_preview_url_miss",t)}function re(e,t){i.j(e,"show_all_discoverable_connected_apps",t)}},91219:(e,t,n)=>{n.d(t,{$2:()=>T,$z:()=>R,E0:()=>M,Mq:()=>A,TC:()=>C,UW:()=>k,bR:()=>E,ci:()=>P,hE:()=>I,jB:()=>w,l5:()=>S,q_:()=>x,yE:()=>D});var o=n(79946),r=n(33728),i=n(72126),a=n(4615),s=n(19889),l=n(97978),c=n(15010),d=n(80444),u=n(77080),p=n(29677),m=n(79797),f=n(88893),g=n(35057),h=n(88280),v=n(81918),b=(n(17224),n(82530)),y=n(37181);function _(e){var t;const n=e.invite_targets.filter(p.cl),o=e.invite_targets.filter(p.fZ),s=n.length+o.length,l=i.oA(e.permission_items.map((e=>{if("user_permission"===e.type)return e.user_id&&(0,a.cj)(e.user_id)}))),c=new Set(null===(t=d.default.state.currentSpaceStore)||void 0===t?void 0:t.getEmailDomains()),u=e.invite_targets.filter((e=>{if("existingUser"!==e.type&&"newUser"!==e.type)return!1;const t=(0,r.Gd)(e.value.email);return t&&c.has(t)})).flatMap((e=>e.value.id?[e.value.id]:[])),m=(0,g.zt)();return{role:e.role,user_count:s,new_user_count:n.length,new_workspace_member_count:e.is_space?s:u.length,new_workspace_member_ids:e.is_space?l:u,is_onboarding:e.is_onboarding,invite_flow_id:e.invite_flow_id,invite_origin:e.invite_origin,invitee_ids:l,invite_message_length:e.invite_message_length,subscription_tier:m,domain_type:e.domainType,...!e.is_space&&{share_menu_session_id:e.share_menu_session_id},allow_domain_auto_invite:u.length>0,is_space:e.is_space}}function S(e,t){const n=_(t);l.j(e,"invite_error",n)}function w(e,t){const n=(0,g.zt)(),i=_(t);l.j(e,"invite",{...i,is_space:t.is_space}),h.subscriptionDataStoreInstance.waitUntilLoaded().then((()=>{const n=h.subscriptionDataStoreInstance.state,o=n?f.Ln(e,n):void 0,a=n?f.Lz(e,n):void 0;l.j(e,"invite_debug_with_block_usage",{...i,is_space:t.is_space,is_over_block_limit:o,block_usage:a}),t.is_space||(!function(e,t){const{currentSpaceStore:n,currentUserStore:o}=d.default.state,i=n&&n.canEditMembership(),a=c.JF(),u=null==o?void 0:o.getEmail();if(!i||!a||!u)return;if("professional"!==a)return;const p=(0,r.Gd)(u),g=f.A7().slice(0,50).map((e=>m.U6.createChildStore(n,{table:s.KJ,id:e.userId}).getEmail())).filter((e=>e&&(0,r.Gd)(e)===p)).length;l.j(e,"page_invite_guest_summary",{...t,guest_with_same_domain_count:g})}(e,i),v.fN(e,{inviteTargets:t.invite_targets,origin:t.invite_origin}))})),(t.is_space||i.allow_domain_auto_invite)&&(l.j(e,"space_invite",i),l.Zf(e,{space_invited:!0}),u.default.logEvent("space_invite",i.allow_domain_auto_invite?`${t.invite_origin}_allow_domain`:t.invite_origin,i),v.Jk(e,{invite_origin:t.invite_origin,domainType:t.domainType,new_workspace_member_count:i.new_workspace_member_count,new_workspace_member_ids:i.new_workspace_member_ids,allow_domain_auto_invite:i.allow_domain_auto_invite}),function(e,t){const n=(0,g.zt)();t.visibleMembersCount<=1&&(l.j(e,"workspace_first_invite_sent"),o.kd(n,t.domainType),"professional"===t.domainType&&(l.j(e,"professional_workspace_first_invite_sent",{visible_members_count:t.visibleMembersCount,is_professional_team_user:t.isProfessionalTeamUser,domain_type:t.domainType}),o.Dq()))}(e,{visibleMembersCount:f.qX(),isProfessionalTeamUser:t.isProfessionalTeamUser,domainType:t.domainType})),t.is_space||i.new_workspace_member_ids.length===t.invite_targets.length||(l.j(e,"page_invite",i),u.default.logEvent("page_invite",n,i),function(e,t){const{currentUserSettingsStore:n}=d.default.state;if(!n)return;const o=n.getKeyStore("settings").getKeyStore("signup_time").getValue(),r=n.getKeyStore("settings").getKeyStore("first_page_invite_at").getValue();if(!Boolean(r)){const r=Date.now(),i={...t,...o?{signup_time_ready:!0,time_from_signup_to_first_page_invite:o-r}:{signup_time_ready:!1}};l.j(e,"page_invite_time",i),u.default.logEvent("page_invite_time",t.subscription_tier,i),b.createAndCommit({userAction:"firstPageInvite",environment:e,userId:n.id,perform:e=>{y.d2({userSettingsStore:n,data:{first_page_invite_at:r},transaction:e})}})}}(e,i))}function k(e,t){l.j(e,"invite_typed",t),u.default.logEvent("invite_typed",t.subscription_tier,{...t})}function I(e,t){l.j(e,"invite_select_target",t),u.default.logEvent("invite_select_target",t.subscription_tier,{selected_user_token_rank:t.selected_user_token_rank,from:t.from,type:t.type??"permission_invite"})}function C(e,t){l.j(e,"invite_change_role",t),u.default.logEvent("invite_change_role",t.subscription_tier,{...t})}function x(e,t){l.j(e,"abandon_permissions_invite",t),u.default.logEvent("abandon_permissions_invite",t.subscription_tier,{...t})}function T(e,t){l.j(e,"open_share_workspace_invite",t),u.default.logEvent("open_share_workspace_invite",t.subscription_tier,{...t})}function M(e,t){l.j(e,"send_share_workspace",t),u.default.logEvent("send_share_workspace",t.subscription_tier,{...t})}function P(e,t){l.j(e,"send_membership_request",t),u.default.logEvent("send_membership_request",t.subscription_tier,{...t})}function A(e,t){l.j(e,"open_page_share_invite",t),u.default.logEvent("open_page_share_invite",t.subscription_tier,{...t})}function R(e){l.j(e,"open_space_invite")}function D(e,t){l.j(e,"invite_modal_input_focus",t)}function E(e,t){l.j(e,"invite_users_to_page",t)}},26189:(e,t,n)=>{n.d(t,{Qq:()=>h,SK:()=>f,TI:()=>c,VN:()=>g,Yo:()=>m,Z0:()=>d,ew:()=>l,iH:()=>u,j1:()=>a,pi:()=>p,z7:()=>s});var o=n(4615),r=n(97978),i=n(77080);function a(e,t){const{analyticsFrom:n,flowId:o}=t;r.j(e,"open_mention_menu",{analyticsFrom:n,flowId:o})}function s(e,t){const{clickIndexGlobal:n,clickIndexLocal:o,sectionIndex:a,timeToClickInMs:s,analyticsFrom:l,queryLength:c,mentionType:d}=t,u={clickIndexGlobal:n,clickIndexLocal:o,sectionIndex:a,timeToClickInMs:s,analyticsFrom:l,queryLength:c,mentionType:d};r.j(e,"insert_mention_from_mention_menu",u),i.default.logEvent("insert_mention_from_mention_menu",void 0,u)}function l(e,t){const{timeToAbandonInMs:n,analyticsFrom:o,queryLength:a,flowId:s}=t,l={timeToAbandonInMs:n,analyticsFrom:o,queryLength:a,flowId:s};r.j(e,"mention_menu_abandon",l),i.default.logEvent("mention_menu_abandon",void 0,l)}function c(e,t){r.j(e,"mention_user",{mentioned_user_id:(0,o.F9)(t.user_id),mentioned_user_access_level:t.user_access_level,from:t.from,block_type:t.block_type})}function d(e,t){r.j(e,"mention_group",{mentioned_group_id:(0,o.F9)(t.group_id),from:t.from,block_type:t.block_type})}function u(e,t){r.j(e,"hover_mention_group",{group_id:(0,o.F9)(t.group_id)})}function p(e,t){r.j(e,"hover_page_mention_start",{hover_session_id:t.hover_session_id,hover_content_type:t.hover_content_type,mentioned_page_id:t.mentioned_page_id,page_visit_id:t.page_visit_id})}function m(e,t){r.j(e,"hover_page_mention_end",{hover_session_id:t.hover_session_id,hover_content_type:t.hover_content_type,mentioned_page_id:t.mentioned_page_id,page_visit_id:t.page_visit_id})}function f(e,t){r.j(e,"page_mention_click",{page_visit_id:t.page_visit_id,mentioned_page_id:t.mentioned_page_id,source_type:t.source_type,hover_preview_enabled:t.hover_preview_enabled,is_navigable_block:t.is_navigable_block})}function g(e,t){r.j(e,"mention_date",{date:t.date,from:t.from,block_type:t.block_type})}function h(e,t){r.j(e,"mention_page",{mentioned_page_id:(0,o.F9)(t.page_id),from:t.from,block_type:t.block_type})}},83249:(e,t,n)=>{n.d(t,{FG:()=>i,YO:()=>r,jD:()=>a,nB:()=>s,w3:()=>c,xx:()=>l});var o=n(97978);function r(e,t){o.j(e,"tap_mobile_action_bar_item",{item_name:t.itemName,from:t.from})}function i(e){o.j(e,"scroll_mobile_action_bar")}function a(e){o.j(e,"open_mobile_sidebar")}function s(e,t){o.j(e,"tap_mobile_bottom_bar_item",{...t})}function l(e){o.j(e,"mobile_add_to_menu_accept")}function c(e,t){o.j(e,"navigation",{...t})}},73990:(e,t,n)=>{n.d(t,{A6:()=>c,Fo:()=>r,Y8:()=>d,_T:()=>a,a6:()=>u,fW:()=>i,mf:()=>s,rY:()=>l,w6:()=>p});var o=n(97978);function r(e){o.j(e,"click_breadcrumb_move_to")}function i(e,t){o.j(e,"move_to_error",t)}function a(e,t){o.j(e,"move_to",t)}function s(e,t){o.j(e,"move_to_value_selected",t)}function l(e,t){o.j(e,"move_to_menu_open",t)}function c(e,t){o.j(e,"move_to_menu_cancel",t)}function d(e,t){o.j(e,"add_editor_permission_to_ensure_undo",t)}function u(e,t){o.j(e,"move_to_autocomplete_query_change",t)}function p(e,t){o.j(e,"move_to_toggle_click",t)}},32441:(e,t,n)=>{n.d(t,{$k:()=>x,AM:()=>h,BR:()=>T,D6:()=>y,Es:()=>f,PB:()=>p,Pu:()=>m,Q4:()=>b,Sn:()=>C,T3:()=>S,VU:()=>I,_W:()=>g,eb:()=>w,ux:()=>_,yv:()=>k,zX:()=>v});var o=n(79946),r=n(15145),i=n(29477),a=n(9852),s=n(64002),l=n(97978),c=n(14654),d=n(24646),u=n(77080);function p(e,t){const{page_id:n,query:o,team_id:i,page_visit_id:a,previous_page_visit_id:u,...p}=t,m=s.Ph(o,r.$X),f=parseInt(m),g="push"===e.RouterStore.getState().action,h=(0,r.bh)(f)&&g?r.tY.LinkInPage:(0,r.xt)(f),v=s.Ph(o,r.Qs),b=c.t3({blockOrCollectionId:n});l.j(e,"page_visit",{...p,page_visit_source:h,notificationId:v,page_visit_id:a,previous_page_visit_id:u,entered_at:Date.now(),home_page_type:b,...(0,d.UF)({environment:e})},{forceOverrideAutomaticEventData:{team_id:i}})}function m(e,t){l.j(e,"page_exit",{exited_at:Date.now(),page_visit_id:t.pageVisitId},{forceOverrideAutomaticEventData:t})}function f(e){const t=[{name:"initial_partner_stack_key",value:e.partner_stack_key,operation:"setOnce"},{name:"partner_stack_key",value:e.partner_stack_key,operation:"set"}];l.fK(t)}function g(e,t){const n=s.nx(t,(0,a.x6)());if(n){const{fbclid:e,gclid:t}=n;e&&o.xx({type:"facebook",id:e}),t&&o.xx({type:"google",id:t}),(0,a.NW)(n)}l.j(e,"visit",{})}function h(e,t){l.j(e,"page_error",t)}function v(e,t){l.j(e,"page_error_button_click",t)}function b(e,t){l.j(e,"reorder_workspaces",t)}function y(e,t){l.j(e,"multi_account_add_or_create_account_clicked",t)}function _(e){l.j(e,"content_classification_proceed")}function S(e,t){l.j(e,"notion_topbar_click",t,{dontWait:!0}),u.default.logEvent("notion_topbar_click",t.variant)}function w(e,t){l.j(e,"template_gallery_public_page_topbar_click",t,{dontWait:!0}),u.default.logEvent("template_gallery_public_page_topbar_click",t.target)}function k(e,t){l.j(e,"getting_started_page_create",t)}function I(e,t){l.j(e,"debug_getting_started_page_error",t)}function C(e,t){l.j(e,"landing_page_visit",{routerName:t}),(0,i.Vs)(4e3).then((n=>{u.default.logEvent(`${t}_page_visit`,e.device.deviceType,{})}))}function x(e,t){l.j(e,"desktop_app_signup_browser_visit",{desktop_app_reroute_email:t.desktopAppRerouteEmail,desktop_app_device_id:t.desktopAppDeviceId})}function T(e,t,n){const o=e=>({blockId:"blockId"in e?e.blockId:void 0,peekViewBlockId:"peekViewBlockId"in e?e.peekViewBlockId:void 0}),{blockId:i,peekViewBlockId:a}=o(t),{blockId:s,peekViewBlockId:c}=o(n),d="pageVisitSource"in n&&n.pageVisitSource?(0,r.xt)(parseInt(n.pageVisitSource)):void 0;l.j(e,"click_in_page_navigation",{current_route_name:t.name,next_route_name:n.name,page_visit_source:d,current_page_id:i,current_peek_view_page_id:a,next_page_id:s,next_peek_view_page_id:c})}},19719:(e,t,n)=>{n.d(t,{Br:()=>D,Cg:()=>U,EH:()=>O,EQ:()=>y,Ee:()=>B,F5:()=>m,FR:()=>Z,GP:()=>I,Jn:()=>x,Md:()=>L,Q6:()=>C,RJ:()=>j,U0:()=>A,Up:()=>k,Xf:()=>P,Z8:()=>b,Zh:()=>N,_H:()=>E,_b:()=>p,b2:()=>T,bE:()=>F,cC:()=>f,gM:()=>V,gY:()=>v,ix:()=>h,kL:()=>q,l2:()=>R,nI:()=>S,pw:()=>w,u_:()=>g,ub:()=>z,zD:()=>M});var o=n(27328),r=n(82813),i=n(97880),a=n(41549),s=n(24646),l=n(77080),c=n(4761),d=n(17659),u=n(97978);function p(e){_({...e,target:"archive"})}function m(e){_({...e,target:"unarchive"})}function f(e){_({...e,target:"mark_as_read"})}function g(e){_({...e,target:"mark_as_unread"})}function h(e){_({...e,target:"frame"})}function v(e){_({...e,target:"open_reply_menu"})}function b(e){let{environment:t,pageId:n,isCurrentlyFollowing:o,from:r,notificationId:i}=e;u.j(t,"click_page_updates_notifications_button",{pageId:n,isCurrentlyFollowing:o,from:r,notificationId:i})}function y(e){let{environment:t,backlinkPageId:n,notificationId:o,alreadyRead:r,activity:i,tab:a}=e;_({environment:t,target:"title",notificationId:o,alreadyRead:r,activity:i,tab:a,otherArgs:{backlinkPageId:n}})}function _(e){let{environment:t,target:n,notificationId:o,alreadyRead:i,activity:a,tab:s,otherArgs:l}=e;w({environment:t,target:n});const d=c.ZP.state.sessionId;U(t,{target:n,notification_id:o,activity_id:a.id,tab:s,sessionId:d,is_filtered:c.ZP.isFilteredToUnreadOnly(),...l}),o&&r.e(u.mc(t),{alreadyRead:i,notificationId:o,activityId:a.id,from:n,sessionId:d})}function S(e){const t=c.ZP.state.sessionId;t&&(u.j(e,"close_sidebar_updates",{sessionId:t,tab:x()}),c.ZP.endSession())}function w(e){let{environment:t,target:n}=e,o=!1;switch(n){case"title":case"body":o=!0;break;case"archive":case"unarchive":case"mark_as_read":case"mark_as_unread":case"add_reaction":case"open_reply_menu":case"frame":case"main":o=!1;break;default:(0,i.t1)(n)}o&&S(t)}function k(e){let{environment:t,from:n}=e;const r=(0,o.w_)(t.TabbedRouterStore.state);var i;"web"===(i=r).type&&"nativeTab"===i.route.name&&"updates"===i.route.tab&&I({environment:t,from:n})}function I(e){let{environment:t,forceRestartSession:n,from:o}=e;c.ZP.startSession({forceRestart:n??!1}),function(e,t){l.default.logEvent("open_sidebar_updates",t.tab,t),u.j(e,"open_sidebar_updates",{...t,...(0,s.UF)({environment:e})})}(t,{tab:x(),unread_notifications_count:d.aY(),sessionId:c.ZP.state.sessionId,from:o})}function C(e){let{environment:t,activityUpdatesSource:n,filters:o,prevFilters:r}=e;u.j(t,"update_notification_filters",{source:n,prev_date_range_filter_start:r.dateRange.start,prev_date_range_filter_end:r.dateRange.end,prev_activity_types:r.activityTypes,date_range_filter_start:o.dateRange.start,date_range_filter_end:o.dateRange.end,activity_types:o.activityTypes})}function x(){const e=c.ZP.state.currentTab;switch(e){case"mentions":return"mentions_comments";case"archive":return"archive";case"allPages":return"all_updates";default:(0,i.t1)(e)}}function T(e){let{environment:t,action:n,args:o}=e;u.j(t,"push_notification_desktop",{...o,action:n})}function M(e,t){u.j(e,"archive_all_notifications",{...t,onlyRead:"read"===t.readFilter,sessionId:c.ZP.state.sessionId})}function P(e){u.j(e,"mark_all_notifications_as_read",{sessionId:c.ZP.state.sessionId})}function A(e,t){u.j(e,"toggle_filter_for_unread_notifications",t)}function R(e){let{environment:t}=e;c.ZP.startSession({forceRestart:!0}),u.j(t,"open_sidebar_updates",{tab:a.Fz(),unread_notifications_count:d.aY(),sessionId:c.ZP.state.sessionId,from:"inbox",...(0,s.UF)({environment:t})})}function D(e){let{environment:t}=e;const n=c.ZP.state.sessionId;n&&(u.j(t,"close_sidebar_updates",{tab:a.Fz(),sessionId:n}),c.ZP.endSession())}function E(e){_({...e,target:"main"})}function B(e,t){const{notificationActivityPairs:n,affectedNotificationIds:o,target:r}=t,i=new Set(o),a=n.filter((e=>{let{notification:t}=e;return i.has(t.id)}));if(0===a.length)return;const s=new Set,l=new Set;a.forEach((e=>{let{notification:t,activity:n}=e;"commented"===t.type?s.add(n.discussion_id):l.add(t.id)})),u.j(e,"click_update_group",{target:r,sessionId:c.ZP.state.sessionId,notification_ids:Array.from(l),discussion_ids:Array.from(s),notification_page_id:a[0].notification.navigable_block_id})}function F(e,t){u.j(e,"toggle_inbox_tab",{...t,sessionId:c.ZP.state.sessionId})}function O(e,t){u.j(e,"click_expand_replies",{...t,sessionId:c.ZP.state.sessionId})}function Z(e){u.j(e,"open_notification_settings_from_all_updates")}function V(e){u.j(e,"open_page_updates")}function U(e,t){u.j(e,"click_update",t)}function N(e,t){const{target:n,...o}=t;let r;"notify_mobile"===n?r="set_mobile_notification":"notify_desktop"===n?r="set_desktop_notification":"notify_email"===n?r="set_email_notification":"notify_email_always"===n?r="set_email_always_notification":"notify_email_digest"===n?r="set_email_digest_notification":(0,i.t1)(n),u.j(e,r,o)}function L(e){u.j(e,"set_marketing_emails_preferences")}function j(e,t){u.j(e,"follow_page",t)}function z(e,t){u.j(e,"unfollow_page",t)}function q(e,t){u.j(e,"update_page_follow_settings",t)}},86615:(e,t,n)=>{n.d(t,{Et:()=>s,G:()=>c,QK:()=>i,QL:()=>a,Wy:()=>l,dl:()=>r,eZ:()=>d,kS:()=>u});var o=n(97978);async function r(e){return o.j(e,"notion_calendar_connect")}function i(e,t){o.j(e,"click_open_in_calendar",t)}function a(e){o.j(e,"calendar_rebrand_onboarding_modal_show")}function s(e,t){o.j(e,"calendar_rebrand_onboarding_modal_click",t)}function l(e){o.j(e,"calendar_rebrand_success_modal_show")}function c(e,t){o.j(e,"calendar_rebrand_success_modal_click",t)}function d(e){o.j(e,"click_calendar_sidebar_link")}function u(e){o.j(e,"click_calendar_upsell_prompt_cta")}},38208:(e,t,n)=>{n.d(t,{$D:()=>g,$l:()=>_,AD:()=>R,C$:()=>I,Gk:()=>c,IE:()=>b,J7:()=>m,NG:()=>d,PL:()=>A,SY:()=>T,TL:()=>P,VZ:()=>E,YV:()=>y,_0:()=>u,a7:()=>B,ax:()=>S,e7:()=>w,fP:()=>x,ho:()=>l,iI:()=>M,jw:()=>p,o7:()=>v,p5:()=>C,qB:()=>O,qJ:()=>f,rx:()=>D,vd:()=>k,wq:()=>F,y6:()=>h});var o=n(79946),r=n(97978),i=n(15010),a=n(80444),s=n(77080);function l(e,t){r.j(e,"onboarding_dialog_error",t),v(e,"onboarding_dialog_error",t)}function c(e,t){r.j(e,"onboarding_error",t),v(e,"onboarding_error",t)}function d(e,t){if(r.j(e,"onboarding_show",t),s.default.logEvent("onboarding_show",1,{...t}),t.is_new_onboarding){var n;const{currentUserSettingsStore:e}=a.default.getState();s.default.logEvent("sign_up_by_domain_type",null==e||null===(n=e.getSettings())||void 0===n?void 0:n.domain_type,{})}}function u(e,t){r.j(e,"onboarding_invite_copy",t),v(e,"onboarding_invite_copy",t)}function p(e,t){r.j(e,"onboarding_close",t),v(e,"onboarding_close",t)}function m(e,t){r.j(e,"onboarding_skip",t),v(e,"onboarding_skip",t)}function f(e,t){r.j(e,"onboarding_invite_send",t),v(e,"onboarding_invite_send",t)}function g(e,t){r.j(e,"onboarding_space_icon_upload",t),v(e,"onboarding_space_icon_upload",t)}function h(e,t){r.j(e,"onboarding_stage",t),s.default.logEvent("onboarding_stage",1,{stage:t.stage,workspace_type:t.initial_workspace_type,is_new_onboarding:t.is_new_onboarding,device_type:e.device.deviceType}),s.default.logEvent("onboarding_stage_by_stage",t.stage,{}),s.default.logEvent("onboarding_stage_by_is_new_user_onboarding",t.is_new_onboarding.toString(),{}),s.default.logEvent("onboarding_stage_by_device_type",e.device.deviceType,{})}function v(e,t,n){r.j(e,"onboarding_serverside",{...n,phase:t},{dontWait:!0})}function b(e,t){r.j(e,"onboarding_join_space_click",t),s.default.logEvent("onboarding_join_space_click",t.joined_space_index,{...t})}function y(e,t){r.j(e,"onboarding_invite_click",t);const{invited_emails:n,...o}=t;s.default.logEvent("onboarding_invite_click",n.length,{...o})}function _(e,t){r.j(e,"onboarding_invite_attempt",t)}function S(e,t){r.j(e,"onboarding_upload_profile_photo",t)}function w(e,t){r.j(e,"onboarding_join_space",t)}function k(e,t){r.j(e,"onboarding_create_space",t)}function I(e,t){r.j(e,"onboarding_plan_type_select",t),s.default.logEvent("onboarding_plan_type_select",t.planType,{...t})}function C(e,t){r.j(e,"onboarding_persona_select",t),s.default.logEvent("onboarding_persona_select","persona",{...t})}function x(e,t){r.j(e,"onboarding_persona_select",t),s.default.logEvent("onboarding_persona_select","role",{...t})}function T(e,t){r.j(e,"onboarding_persona_select",t),s.default.logEvent("onboarding_persona_select","useCases",{...t})}function M(e,t){r.j(e,"onboarding_persona_select",t),s.default.logEvent("onboarding_persona_select","companySize",{...t})}function P(e,t){r.j(e,"onboarding_persona_survey_action",{...t,action:t.action}),s.default.logEvent("onboarding_persona_survey_action",t.action,{}),s.default.logEvent(`onboarding_persona_survey_action_${t.action}`,t.plan_selection,{})}function A(e,t){var n,l;const{currentUserSettingsStore:c,currentUserRootStore:d}=a.default.state,u=s.default.getExperimentsMap();r.Zf(e,{onboarding_complete:!0,onboarding_emails_experiment:u["onboarding-emails"]}),r.j(e,"onboarding_complete",t),o.PL(),s.default.logEvent("onboarding_complete",1,{domain_type:null==c||null===(n=c.getSettings())||void 0===n?void 0:n.domain_type,device_type:e.device.deviceType,is_new_onboarding:t.is_new_onboarding,is_professional_team_user:i.QZ(),user_persona:t.user_persona,plan_type:t.plan_type,create_or_join:t.initial_workspace_type}),s.default.logEvent("onboarding_complete_by_plan_type",t.plan_type,{}),s.default.logEvent("onboarding_complete_by_device_type",e.device.deviceType,{}),s.default.logEvent("onboarding_complete_by_user_persona",t.user_persona,{}),s.default.logEvent("onboarding_complete_by_user_team_role",t.user_team_role,{}),t.user_use_cases&&t.user_use_cases.forEach((e=>{s.default.logEvent("onboarding_complete_by_user_use_case",e,{})})),s.default.logEvent("onboarding_complete_by_domain_type",null==c||null===(l=c.getSettings())||void 0===l?void 0:l.domain_type,{}),s.default.logEvent("onboarding_complete_by_create_or_join_space",t.initial_workspace_type,{}),s.default.logEvent("onboarding_complete_by_is_new_user_onboarding",t.is_new_onboarding.toString(),{}),s.default.logEvent("onboarding_complete_by_workspaces_count",(null==d?void 0:d.getSpaceViewStores().length)||0,{}),i.QZ()&&s.default.logEvent("pro_team_onboarding_complete",1,{})}function R(e,t){r.j(e,"proj_management_onboarding_tooltip_show",t),s.default.logEvent("proj_management_tooltip_show")}function D(e,t){r.j(e,"proj_management_onboarding_tooltip_dismiss",t),s.default.logEvent("proj_management_tooltip_dismiss")}function E(e,t){r.j(e,"onboarding_team_invite_email_entered",t)}function B(e,t){r.j(e,"onboarding_team_invite_add_more_clicked",t)}function F(e,t){r.j(e,"onboarding_bulk_invites_rendered",t)}function O(e,t){r.j(e,"onboarding_desktop_app_download_click",t),s.default.logEvent("onboarding_desktop_app_download_click",1)}},92973:(e,t,n)=>{n.d(t,{$C:()=>s,MU:()=>c,UZ:()=>p,hy:()=>l,lg:()=>u,sx:()=>r,v2:()=>d,vc:()=>a,zP:()=>i});var o=n(97978);function r(e,t){o.j(e,"open_peek_as_page",t)}function i(e,t){o.j(e,"peek_arrow_navigation",t)}function a(e,t){o.j(e,"close_side_peek",t)}function s(e,t){o.j(e,"close_peek",t)}function l(e,t){o.j(e,"expand_block",t)}function c(e,t){o.j(e,"open_peek_mode_picker",t)}function d(e,t){o.j(e,"open_peek_mode_picker",t)}function u(e,t){o.j(e,"update_peek_mode_format",t)}function p(e,t){o.j(e,"update_peek_mode_format",t)}},91536:(e,t,n)=>{n.d(t,{Ad:()=>m,E5:()=>K,If:()=>q,Jp:()=>W,Kf:()=>D,L7:()=>y,LA:()=>h,Mv:()=>C,NL:()=>w,O8:()=>F,PH:()=>$,Pd:()=>M,RP:()=>g,SM:()=>L,Xb:()=>A,b4:()=>b,cO:()=>H,d:()=>B,dE:()=>x,dS:()=>k,dU:()=>j,g9:()=>G,gR:()=>T,hY:()=>I,kM:()=>O,kx:()=>f,nC:()=>z,oE:()=>Z,pZ:()=>v,qT:()=>P,xt:()=>E,zU:()=>R});var o=n(72126),r=n(87479),i=n(72141),a=n(4615),s=n(49902),l=n(97978),c=n(46654),d=n(28578),u=n(77080),p=n(17224);function m(e,t){l.j(e,"permissions_settings_security_banner_show",t)}function f(e,t){l.j(e,"permissions_settings_security_banner_click",t)}function g(e,t){l.j(e,"permissions_settings_search_click",t),u.default.logEvent("permissions_settings_search_click",t.current_tab)}function h(e,t){l.j(e,"permissions_settings_export_guests_button_click",t),u.default.logEvent("permissions_settings_export_guests_button_click",1,t)}function v(e,t){l.j(e,"permissions_settings_table_multiselect_click",t)}function b(e,t){l.j(e,"permissions_settings_table_button_click",t),u.default.logEvent("permissions_settings_table_button_click",t.button_name,t)}function y(e,t){l.j(e,"permissions_settings_invite_button_click",t),u.default.logEvent("permissions_settings_invite_button_click",t.type)}function _(e){const{user_id:t,page_id:n,...o}=e;return o}function S(e,t){l.j(e,"update_page_permission","user_id"in t||"page_id"in t?_(t):t)}function w(e,t){l.j(e,"set_permission_item",t)}function k(e,t){if("team"===t.type){const{team_id:n,...o}=t;l.j(e,"expand_permission",{...o},{forceOverrideAutomaticEventData:{team_id:n}})}else l.j(e,"expand_permission",t)}function I(e,t){l.j(e,"page_share_user_access_role",t)}function C(e){const{newRole:t,availableRoles:n}=e;if("none"===t||"content_only_editor"===t)return;n.some((e=>"content_only_editor"===e.role))&&s.j({name:"save_non_content_editor_role"})}function x(e,t,n){l.j(e,"update_space_permission",{...i.jg(t)&&{updated_user_id:(0,a.cj)(t.user_id)},...i.FB(t)&&{updated_bot_id:(0,a.cj)(t.bot_id)},..."user_id"in t||"page_id"in t?_(t):t,...n}),u.default.logEvent("update_space_permission",null==n?void 0:n.from,{role:t.role})}function T(e,t){var n;let{item:o,teamStore:r}=t;const i=null===(n=r.getPermissionItems())||void 0===n?void 0:n.find((e=>e.type===o.type));(null==i?void 0:i.role)!==o.role&&p.YP(e,"update_team_permission",{store:r,..."user_id"in o||"page_id"in o?_(o):o,..."user_id"in o&&{permission_user_id:(0,a.cj)(o.user_id)},old_role:null==i?void 0:i.role,is_team_role_change:!1,is_permission_change:!0})}function M(e,t){let{permission_user_id:n,store:o,team_role:r}=t;p.YP(e,"update_team_permission",{store:o,permission_user_id:n,team_role:r,is_team_role_change:!0,is_permission_change:!1})}function P(e,t){l.j(e,"permissions_settings_tab_click",t),u.default.logEvent("permissions_settings_tab_click",t.tab,t)}function A(e){l.j(e,"permission_group_rename")}function R(e,t){l.j(e,"permission_group_set_icon",t)}function D(e,t){l.j(e,"permission_group_add_members",t)}function E(e){l.j(e,"permission_group_remove_member")}function B(e){l.j(e,"permission_group_delete")}function F(e){l.j(e,"permission_group_create")}function O(e){let{environment:t,location:n,inSudoMode:o,store:r,newItems:i,fromPermissionWrapper:a}=e;V({store:r,newItems:i}).forEach((e=>{let{role_old_inherited_or_most_permissive:r,role_old_on_page:i,privacy_level:s,old_privacy_level:l,newItem:c}=e;S(t,s||l?{...c,location:n,in_sudo_mode:o||void 0,role_old_inherited_or_most_permissive:r,role_old_on_page:i,privacy_level:s,old_privacy_level:l,share_menu_session_id:d.ZP.state.sessionId,from_permission_wrapper:a}:{...c,location:n,in_sudo_mode:o||void 0,role_old_inherited_or_most_permissive:r,role_old_on_page:i,share_menu_session_id:d.ZP.state.sessionId,from_permission_wrapper:a})}))}function Z(e){const{environment:t,calculatedPermissions:n}=e;l.j(t,"page_share_permissions_summary",{share_menu_session_id:d.ZP.state.sessionId,page_permission_summary:N(n)})}function V(e){let{store:t,newItems:n}=e;const a=e=>`${e.type}:${r.D3(e)}`,s=t.getPermissionItems(),l=o.KX(s,a),d=c.YO(t).map((e=>e.permissionItem)),u=o.KX(d,a);return n.map((e=>{var t;const n=a(e),o=u[n],r=null===(t=l[n])||void 0===t?void 0:t.role,s=null==o?void 0:o.role;return(0,i.ix)(e)?{newItem:e,role_old_inherited_or_most_permissive:s,role_old_on_page:r,privacy_level:U(e),old_privacy_level:o&&(0,i.ix)(o)?U(o):"private"}:{newItem:e,role_old_inherited_or_most_permissive:s,role_old_on_page:r}}))}function U(e){return"none"===e.role?"private":e.unlisted_timestamp?"unlisted":"open"}function N(e){const{mostPermissiveSpaceItem:t,mostPermissiveAncestorTeamOwnerItem:n,mostPermissiveAncestorTeamMemberItem:o,pagePermissionUIModel:r}=e,{mostPermissiveGroupPermissions:a,mostPermissiveUserPermissions:s}=r;return{space:t.permissionItem.role,team_owner:null==n?void 0:n.permissionItem.role,team_member:null==o?void 0:o.permissionItem.role,groups:{full_access:a.filter((e=>{let{permissionItem:{role:t}}=e;return i.zz(t)})).length,can_edit:a.filter((e=>{let{permissionItem:{role:t}}=e;return i.VM(t)})).length,can_edit_content:a.filter((e=>{let{permissionItem:{role:t}}=e;return i.WY(t)})).length,can_comment:a.filter((e=>{let{permissionItem:{role:t}}=e;return i.rG(t)})).length,can_view:a.filter((e=>{let{permissionItem:{role:t}}=e;return i.rz(t)})).length},users:{full_access:s.filter((e=>{let{permissionItem:{role:t}}=e;return i.zz(t)})).length,can_edit:s.filter((e=>{let{permissionItem:{role:t}}=e;return i.VM(t)})).length,can_edit_content:s.filter((e=>{let{permissionItem:{role:t}}=e;return i.WY(t)})).length,can_comment:s.filter((e=>{let{permissionItem:{role:t}}=e;return i.rG(t)})).length,can_view:s.filter((e=>{let{permissionItem:{role:t}}=e;return i.rz(t)})).length},privacy_level:U(t.permissionItem)}}function L(e){l.j(e,"widen_permissions")}function j(e,t){l.j(e,"request_access",t)}function z(e,t){l.j(e,"grant_access",t)}function q(e,t){l.j(e,"grant_access_update_access_level",t)}function H(e,t){l.j(e,"ignore_access_request",t)}function W(e,t){l.j(e,"toggle_request_access_security_setting",t)}function K(e,t){l.j(e,"view_all_requests_from_membership_request_notification",t),u.default.logEvent("view_all_requests_from_membership_request_notification","notification",t)}function G(e){l.j(e,"open_guest_membership_request_modal"),u.default.logEvent("open_guest_membership_request_modal")}function $(e){l.j(e,"render_guest_membership_request_entry_point"),u.default.logEvent("render_guest_membership_request_entry_point")}},51787:(e,t,n)=>{n.d(t,{Cr:()=>b,EH:()=>u,Eb:()=>f,Kk:()=>m,Sn:()=>h,WC:()=>l,Zb:()=>v,Zf:()=>p,fh:()=>g,nL:()=>c,sb:()=>d,wF:()=>s});var o=n(97978),r=n(24646),i=n(77080),a=n(87956);function s(e,t){const n={...t,...(0,r.UF)({environment:e}),isSidePanelCloseable:i.default.checkGate("search_toggle_side_peek")};o.j(e,"open_search",n)}function l(e,t){o.j(e,"space_invitation_email_clicked",t)}function c(e,t){o.j(e,"select_search_item",t);const{numKeystrokes:n,timeToSelectMs:r,selectedItemIndex:a,originalPosition:s,context:l,numLocalResults:c,searchSessionId:d,searchSessionFlowNumber:u,numVisibleMembers:p,localSources:m,isMobile:f}=t,g=Boolean(!!m&&m.length>0),h=p>1;i.default.logEvent("select_search_item",a,{numKeystrokes:n,timeToSelectMs:r,selectedItemIndex:a,numLocalResults:c,originalItemIndex:s,searchSessionFlowNumber:u,searchSessionId:d,context:l,isMultiplayer:h,isLocalResult:g,isMobile:f});const v=1/(a+1);o.j(e,"quick_find_reciprocal_rank",{reciprocalRank:v,context:l,searchSessionId:d,numLocalResults:c,isMultiplayer:h}),i.default.logEvent("quick_find_reciprocal_rank",v,{context:l,searchSessionId:d,numLocalResults:c,isMultiplayer:h,isLocalResult:g,isMobile:f})}function d(e,t){o.j(e,"search_copy_link",t)}function u(e,t){o.j(e,"abandoned_search",t);const{numKeystrokes:n,timeToAbandonMs:r,numLocalResults:a,numVisibleMembers:s,isMobile:l}=t,c=s>1;i.default.logEvent("abandoned_search",n,{numKeystrokes:n,timeToAbandonMs:r,numLocalResults:a,searchSessionId:t.searchSessionId,isMultiplayer:c,isMobile:l}),o.j(e,"quick_find_reciprocal_rank",{reciprocalRank:0,searchSessionId:t.searchSessionId,numLocalResults:a,isMultiplayer:c}),i.default.logEvent("quick_find_reciprocal_rank",0,{searchSessionId:t.searchSessionId,numLocalResults:a,isMultiplayer:c,isMobile:l})}function p(e,t){o.j(e,"search_client_results",t)}function m(e,t){o.j(e,"search_post_click_page_interaction",t)}function f(e,t){var n;o.j(e,"search_post_click_page_exit",{dwellTime:(new Date).getTime()-t.timeEntered.getTime()},{forceOverrideAutomaticEventData:{queryId:null===(n=a.Z.state)||void 0===n?void 0:n.queryId}})}function g(e,t){const{currentSearchSessionId:n,currentWorkspaceId:r,newWorkspaceId:i}=t;o.j(e,"search_quick_search_switch_workspace",{current_search_session_id:n,current_workspace_id:r,new_workspace_id:i})}function h(e,t){o.j(e,"search_open_shortcut_settings_from_command_search_hint",{search_session_id:t.searchSessionId})}function v(e,t){o.j(e,"search_hover_command_search_hint",{search_session_id:t.searchSessionId})}function b(e,t){o.j(e,"search_query_has_operators",{operations:t.operations,search_session_id:t.searchSessionId})}},14549:(e,t,n)=>{n.d(t,{A0:()=>h,AQ:()=>m,He:()=>c,O$:()=>d,SU:()=>a,Wb:()=>f,XI:()=>s,eo:()=>b,gV:()=>l,ps:()=>p,qP:()=>u,wr:()=>g,xG:()=>y,xU:()=>v});var o=n(97978),r=n(24646),i=n(77080);function a(e,t){o.j(e,"open_settings",{...t,...(0,r.UF)({environment:e})})}function s(e,t){o.j(e,"toggle_settings_tab",t)}function l(e,t){o.j(e,"site_settings_action",t)}function c(e){o.j(e,"upload_profile_photo")}function d(e,t){o.j(e,"name_changed",t)}function u(e){o.j(e,"delete_account_clicked")}function p(e){o.j(e,"delete_account_confirmed")}function m(e){o.j(e,"log_out_from_active_sessions_clicked")}function f(e){o.j(e,"change_password_clicked")}function g(e){o.j(e,"remove_password_clicked")}function h(e,t){o.j(e,"locale_changed",t)}function v(e,t){o.j(e,"change_locale_clicked",t)}function b(e,t){o.j(e,"invite_link_updated",t),i.default.logEvent("invite_link_updated",String(t.enabled),t)}function y(e,t){o.j(e,"allowed_email_domains_updated",t)}},66324:(e,t,n)=>{n.d(t,{An:()=>w,HY:()=>_,LM:()=>a,ME:()=>v,MR:()=>f,Qd:()=>s,Se:()=>h,VS:()=>g,Yg:()=>k,Zm:()=>d,_f:()=>p,ai:()=>b,kV:()=>u,ph:()=>c,qY:()=>S,so:()=>y,t8:()=>m,v$:()=>l});var o=n(97978),r=n(24646),i=n(17224);function a(e){o.j(e,"sidebar_expand")}function s(e){o.j(e,"sidebar_unexpand")}function l(e,t){o.j(e,"open_comments_sidebar",t)}function c(e,t){o.j(e,"open_updates_sidebar",t)}function d(e,t){o.j(e,"updates_sidebar_tab_click",t)}function u(e,t){o.j(e,"open_view_all_popover",t)}function p(e,t){o.j(e,"select_page_from_view_all_popover",t)}function m(e,t){const{teamStore:n,...o}=t;i.YP(e,"outliner_item_toggle",{store:n,...o})}function f(e,t){i.YP(e,"outliner_team_toggle",t)}function g(e,t){o.j(e,"outliner_section_toggle",t)}function h(e){o.j(e,"click_nested_child_page")}function v(e,t){o.j(e,"click_desktop_navigator",t)}function b(e){o.j(e,"open_space_switcher")}function y(e){o.j(e,"space_switcher_select_space")}function _(e){o.j(e,"space_switcher_logout_click")}function S(e,t){o.j(e,"pin_page",t)}function w(e,t){o.j(e,"unpin_page",t)}function k(e,t){const{teamStore:n,...o}=t;i.YP(e,"click_outliner_item",{store:n,...(0,r.UF)({environment:e}),...o})}},81918:(e,t,n)=>{n.d(t,{$B:()=>O,BP:()=>g,Cg:()=>ae,Ci:()=>y,Dn:()=>_,Ef:()=>k,HH:()=>S,Io:()=>oe,JX:()=>B,Jk:()=>q,Jo:()=>D,KF:()=>R,KZ:()=>ee,LO:()=>E,NF:()=>T,O8:()=>se,Om:()=>ne,P0:()=>H,P1:()=>C,Rb:()=>h,S4:()=>X,Sw:()=>b,T4:()=>w,TJ:()=>Y,VM:()=>le,VT:()=>p,Vi:()=>$,Y7:()=>J,ZA:()=>G,Zm:()=>P,Zv:()=>te,_6:()=>L,_m:()=>Z,aT:()=>j,am:()=>x,bw:()=>v,dw:()=>V,fN:()=>de,j7:()=>F,jk:()=>ie,kj:()=>m,l0:()=>I,o8:()=>ce,pC:()=>z,pR:()=>Q,rZ:()=>A,rv:()=>N,tB:()=>re,tX:()=>K,vC:()=>U,wV:()=>M,x8:()=>W,z0:()=>f});var o=n(79946),r=n(54642),i=n(97978),a=n(15010),s=n(77080),l=n(29677),c=n(88893),d=n(35057),u=n(88280);function p(e,t){i.oP(e,{eventName:"create_space",eventProperties:t});const n=(0,d.zt)();if("professional"===t.domain_type&&(i.j(e,"professional_workspace_created",t),o.L1({subscriptionTier:n,planType:t.planType})),"team"===t.planType&&(i.j(e,"team_workspace_created",t),o.tO({subscriptionTier:n,planType:t.planType})),o.VT({subscriptionTier:n,domainType:t.domain_type}),"team"===t.planType){const t=o.Q3(),n=o.SY();r.trackConversionEvent(e,{eventName:"create_team_space",fbp:t,clickIds:n})}}function m(e,t){i.j(e,"join_space",t)}function f(e){i.j(e,"leave_space"),q(e,{invite_origin:"workspace_leave",domainType:(0,a.JF)(),new_workspace_member_count:-1,new_workspace_member_ids:[e.currentUser.id??""]})}function g(e){i.j(e,"delete_space"),s.default.logEvent("delete_space")}function h(e,t){i.j(e,"convert_guest_to_member",t),s.default.logEvent("convert_guest_to_member",t.convert_to,{origin:t.origin})}function v(e){i.j(e,"remove_guest")}function b(e,t){s.default.logEvent("remove_member",t.member_user_id,t),q(e,{invite_origin:"workspace_remove_member",domainType:t.domainType,new_workspace_member_count:t.new_workspace_member_count,new_workspace_member_ids:[t.member_user_id]}),i.j(e,"remove_member",{member_user_id:t.member_user_id,member_role:t.member_role,contraction_survey_id:t.contraction_survey_id})}function y(e){i.j(e,"managed_user_reactivate_button_clicked")}function _(e,t){i.j(e,"managed_user_support_access_toggled",t)}function S(e,t){i.j(e,"managed_users_dashboard_search",t)}function w(e,t){i.j(e,"managed_users_external_space_access_set",t)}function k(e,t){i.j(e,"managed_users_prevent_support_access_toggled",t)}function I(e,t){i.j(e,"managed_users_session_duration_modal_confirmed",t)}function C(e,t){i.j(e,"managed_user_delete_button_clicked",t)}function x(e,t){i.j(e,"managed_user_edit_modal_submitted",t)}function T(e){i.j(e,"managed_user_log_out_button_clicked")}function M(e,t){i.j(e,"managed_user_remove_from_external_workspace_button_clicked",t)}function P(e){i.j(e,"managed_user_reset_password_button_clicked")}function A(e){i.j(e,"managed_user_suspend_button_clicked")}function R(e,t){i.j(e,"managed_users_log_out_all_button_clicked",t)}function D(e,t){i.j(e,"managed_users_reset_passwords_all_button_clicked",t)}function E(e,t){i.j(e,"managed_users_session_duration_selected",t)}function B(e,t){i.j(e,"managed_user_edit_profile_modal_open",t)}function F(e,t){i.j(e,"managed_user_delete_modal_confirmed",t)}function O(e,t){i.j(e,"managed_user_edit_modal_confirmed",t)}function Z(e){i.j(e,"managed_user_log_out_modal_confirmed")}function V(e,t){i.j(e,"managed_user_remove_from_external_workspace_modal_confirmed",t)}function U(e){i.j(e,"managed_user_reset_password_modal_confirmed")}function N(e){i.j(e,"managed_user_suspend_modal_confirmed")}function L(e,t){i.j(e,"managed_users_log_out_all_modal_confirmed",t)}function j(e,t){i.j(e,"managed_users_reset_passwords_all_modal_confirmed",t)}function z(e){i.j(e,"managed_users_dashboard_button_clicked")}function q(e,t){const n=(0,d.zt)();i.j(e,"workspace_member_number_update",{new_workspace_member_count:t.new_workspace_member_count,new_workspace_member_ids:t.new_workspace_member_ids,origin:t.invite_origin,subscription_tier:n,domain_type:t.domainType,allow_domain_auto_invite:t.allow_domain_auto_invite,company_segment:(0,c.Ns)()}),s.default.logEvent("workspace_member_number_update",t.new_workspace_member_count,{origin:t.allow_domain_auto_invite?`${t.invite_origin}_allow_domain`:t.invite_origin,subscription_tier:n,domain_type:t.domainType,company_segment:(0,c.Ns)()})}function H(e,t){const n=(0,d.zt)(),o=(0,a.JF)();i.j(e,"person_property_invite_click_menu_item",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id})}function W(e,t){const n=(0,d.zt)(),o=(0,a.JF)();i.j(e,"person_property_invite_render_menu_item",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id})}function K(e,t){const n=(0,d.zt)(),o=(0,a.JF)(),r="member"===t.invite_option?t.can_add_member?"member":"request_member":"guest";i.j(e,"person_property_invite_click_invite_button",{subscription_tier:n,domain_type:o,invited_type:r,invited_user_count:t.invited_user_count,origin:t.origin,invite_token_query:t.inviteTokenQuery,invite_targets:t.inviteTargets,invite_flow_id:t.invite_flow_id})}function G(e,t){const n=(0,d.zt)(),o=(0,a.JF)();i.j(e,"person_property_invite_click_upgrade_button",{subscription_tier:n,domain_type:o,origin:t.origin,invited_user_count:t.invited_user_count,invite_flow_id:t.invite_flow_id})}function $(e,t){const n=(0,d.zt)(),o=(0,a.JF)();i.j(e,"person_property_invite_guest_invited",{subscription_tier:n,domain_type:o,invited_user_count:t.invited_user_count,origin:t.origin,invite_flow_id:t.invite_flow_id})}function Q(e,t){const n=(0,d.zt)(),o=(0,a.JF)();i.j(e,"person_property_invite_member_invited",{subscription_tier:n,domain_type:o,invited_user_count:t.invited_user_count,origin:t.origin,invite_flow_id:t.invite_flow_id})}function Y(e,t){const n=(0,d.zt)(),o=(0,a.JF)();i.j(e,"person_property_invite_member_requested",{subscription_tier:n,domain_type:o,invited_user_count:t.invited_user_count,origin:t.origin,invite_flow_id:t.invite_flow_id})}function X(e,t){const n=(0,d.zt)(),o=(0,a.JF)();i.j(e,"person_property_invite_error",{subscription_tier:n,domain_type:o,invite_stage:t.invite_stage,invite_flow_id:t.invite_flow_id,error:t.error})}function J(e,t){const n=(0,d.zt)(),o=(0,a.JF)(),r="member"===t.invite_option?t.can_add_member?"member":"request_member":"guest";i.j(e,"person_property_invite_completed",{subscription_tier:n,domain_type:o,invited_type:r,invited_user_count:t.invited_user_count,is_success:t.is_success,origin:t.origin,invite_flow_id:t.invite_flow_id})}function ee(e,t){const n=(0,d.zt)(),o=(0,a.JF)();i.j(e,"person_property_invite_message_typed",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id})}function te(e,t){const n=(0,d.zt)(),o=(0,a.JF)();i.j(e,"person_property_invite_dismiss_popup",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id})}function ne(e,t){const n=(0,d.zt)(),o=(0,a.JF)();i.j(e,"person_property_invite_change_permission",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id,invited_role:t.invited_role})}function oe(e,t){const n=(0,d.zt)(),o=(0,a.JF)();i.j(e,"person_property_invite_click_invite_option",{subscription_tier:n,domain_type:o,origin:t.origin,invite_flow_id:t.invite_flow_id,invite_option:t.invite_option})}function re(e,t){i.j(e,"guest_invite_request_setting_toggled",t)}function ie(e,t){i.j(e,"settings_deeplink_clicked",t)}function ae(e,t){i.j(e,"guest_invite_request_resolved",t)}function se(e,t){i.j(e,"resolve_membership_request",t),s.default.logEvent("resolve_membership_request",t.status,t)}function le(e,t){i.j(e,"request_access_review_button_clicked",t),s.default.logEvent("request_access_review_button_clicked",t.status,{from:t.from,user_count:t.user_count,request_type:t.request_type})}function ce(e,t){if(i.j(e,"disable_guest_toggle",t),!0===t.new_value&&!t.keep_existing_guests_if_disabled){const t=u.subscriptionDataStoreInstance.state;if(!t)return;const n=(0,c.ND)(t).length;n>0&&de(e,{origin:"space_setting_disable_guest",changedNumber:-n})}}function de(e,t){let{inviteTargets:n,origin:o,changedNumber:r}=t;const p=(0,a.JF)(),m=(0,d.zt)();if(r)return i.j(e,"workspace_guest_number_update",{new_workspace_guest_count:r,origin:o,subscription_tier:m,domain_type:p,company_segment:(0,c.Ns)()}),void s.default.logEvent("workspace_guest_number_update",r,{origin:o,subscription_tier:m,domain_type:p,company_segment:(0,c.Ns)()});const f=u.subscriptionDataStoreInstance.state;if(!f||!n)return;const g=c.CM(f).map((e=>e.userId)),h=n.filter((e=>!!(0,l.cl)(e)||"existingUser"===e.type&&!g.includes(e.value.id)));0!==h.length&&(i.j(e,"workspace_guest_number_update",{new_workspace_guest_count:h.length,origin:o,subscription_tier:m,domain_type:p,company_segment:(0,c.Ns)()}),s.default.logEvent("workspace_guest_number_update",h.length,{origin:o,subscription_tier:m,domain_type:p,company_segment:(0,c.Ns)()}))}},86572:(e,t,n)=>{n.d(t,{$l:()=>b,Aq:()=>L,Bg:()=>N,Dc:()=>D,EU:()=>v,FR:()=>E,Ib:()=>ne,LY:()=>z,Lc:()=>R,Ls:()=>$,NI:()=>te,PN:()=>O,QO:()=>X,Qr:()=>P,R3:()=>T,VQ:()=>Z,YT:()=>_,Zb:()=>Q,_j:()=>W,_q:()=>q,b0:()=>k,bf:()=>ie,cY:()=>U,e3:()=>y,fZ:()=>F,g3:()=>Y,iL:()=>V,j:()=>se,jh:()=>K,jw:()=>A,k1:()=>C,k6:()=>H,lj:()=>re,lq:()=>x,ms:()=>ae,nd:()=>S,q7:()=>w,qz:()=>B,rO:()=>h,rY:()=>j,rx:()=>J,sA:()=>ee,wl:()=>G,xo:()=>M,y$:()=>I,z2:()=>oe});var o=n(79946),r=n(72126),i=n(4615),a=n(99405),s=n(2438),l=n(63143),c=n(47839),d=n(95477),u=n(97978),p=n(15010),m=n(77080),f=n(88893),g=n(35057);function h(e,t){u.j(e,"pricing_grid_button_click",t),m.default.logEvent("pricing_grid_button_click",void 0,t),te(e,{location:"plans_page",cta_item:t.plan,currency_code:t.currency_code,page_section:"all_plans_grid",button_text:t.button_text})}function v(e){u.j(e,"pricing_grid_contact_sales_click")}function b(e,t){u.j(e,"pricing_grid_view",t),m.default.logEvent("pricing_grid_view",void 0,t)}function y(e){u.j(e,"pricing_grid_view_end"),m.default.logEvent("pricing_grid_view_end")}function _(e,t){u.j(e,"subscription_update_modal_open",t),m.default.logEvent("subscription_update_modal_open",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function S(e,t){u.j(e,"subscription_update_modal_confirmation_click",{...r.CE(t.state,"modalId"),modal_id:t.state.modalId}),m.default.logEvent("subscription_update_modal_confirmation_click",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function w(e,t){u.j(e,"subscription_update_modal_exit",{...r.CE(t.state,"modalId"),modal_id:t.state.modalId}),m.default.logEvent("subscription_update_modal_exit",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function k(e,t){u.j(e,"subscription_update_modal_billing_interval_updated",t),m.default.logEvent("subscription_update_modal_billing_interval_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function I(e,t){u.j(e,"subscription_update_modal_expand_billing_summary",{...r.CE(t.state,"modalId"),modal_id:t.state.modalId}),m.default.logEvent("subscription_update_modal_expand_billing_summary",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function C(e,t){u.j(e,"subscription_update_modal_hide_billing_summary",{...r.CE(t.state,"modalId"),modal_id:t.state.modalId}),m.default.logEvent("subscription_update_modal_hide_billing_summary",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function x(e){u.j(e,"subscription_billing_dismissed"),m.default.logEvent("subscription_billing_dismissed",void 0,{device_os:e.device.os,platform:e.device.platform})}function T(e,t){u.j(e,"subscription_billing_opened",t),m.default.logEvent("subscription_billing_opened",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function M(e){u.j(e,"subscription_plans_dismissed"),m.default.logEvent("subscription_plans_dismissed",void 0,{device_os:e.device.os,platform:e.device.platform})}function P(e,t){u.j(e,"subscription_plans_opened",t),m.default.logEvent("subscription_plans_opened",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function A(e){u.j(e,"currently_subscribed")}function R(e,t){u.j(e,"subscription_upgrade_modal_open",t),m.default.logEvent("subscription_upgrade_modal_open",void 0,t)}function D(e,t){const{event:n,modal_id:o}=t,r={...(0,l.by)(n),modal_id:o};u.j(e,"subscription_upgrade_modal_payment_element_changed",r),m.default.logEvent("subscription_upgrade_modal_payment_element_changed",void 0,{...r,device_os:e.device.os,platform:e.device.platform})}function E(e,t){u.j(e,"subscription_upgrade_modal_billing_interval_updated",t),m.default.logEvent("subscription_upgrade_modal_billing_interval_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function B(e,t){u.j(e,"subscription_upgrade_modal_add_on_features_updated",t),m.default.logEvent("subscription_upgrade_modal_add_on_features_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function F(e,t){u.j(e,"subscription_upgrade_modal_upgrade_accepted",t),m.default.logEvent("subscription_upgrade_modal_upgrade_accepted",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function O(e,t){u.j(e,"subscription_upgrade_modal_upgrade_click",t),m.default.logEvent("subscription_upgrade_modal_upgrade_click",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function Z(e,t){u.j(e,"subscription_upgrade_modal_upgrade_failed_validation",t),m.default.logEvent("subscription_upgrade_modal_upgrade_failed_validation",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function V(e,t){u.j(e,"subscription_upgrade_onboarding_failed_validation",t)}function U(e,t){u.j(e,"subscription_upgrade_modal_upgrade_failed_payment",t),m.default.logEvent("subscription_upgrade_modal_upgrade_failed_payment",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function N(e){u.j(e,"subscription_upgrade_onboarding_failed_payment")}function L(e,t){u.j(e,"subscription_upgrade_modal_upgrade_failed_payment_recovery_initiated",t),m.default.logEvent("subscription_upgrade_modal_upgrade_failed_payment_recovery_initiated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function j(e,t){u.j(e,"subscription_upgrade_modal_address_form_updated",t),m.default.logEvent("subscription_upgrade_modal_address_form_updated",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function z(e,t){u.j(e,"subscription_upgrade_modal_exit",t),m.default.logEvent("subscription_upgrade_modal_exit",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function q(e,t){u.j(e,"subscription_upgrade_modal_stripe_error",t),m.default.logEvent("subscription_upgrade_modal_stripe_error",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function H(e,t){u.j(e,"create_subscription",t),m.default.logEvent("create_subscription",t.plan,t)}async function W(e,t){var n,r,l,g;const h=p.JF(),v=f.qX();u.j(e,"update_subscription_tier",{from:t.from,action:t.action,old_subscription_tier:t.oldSubscriptionTier,new_subscription_tier:t.newSubscriptionTier,old_price_id:t.oldPriceId,new_price_id:t.newPriceId,old_currency:t.oldCurrency,new_currency:t.newCurrency,old_add_ons:t.oldAddOns,new_add_ons:t.newAddOns,old_billing_interval:t.oldBillingInterval,new_billing_interval:t.newBillingInterval,is_cancel_subscription:t.isCancelSubscription,is_professional_team:t.isProfessionalTeamUser,domain_type:h,space_visible_members:v,is_trial:t.isTrial,is_mm_or_ent_trial:t.isMmOrEnt,trial_id:null===(n=t.trialData)||void 0===n?void 0:n.id,trial_from:null===(r=t.trialData)||void 0===r?void 0:r.from}),m.default.logEvent("update_subscription_tier",void 0,{from:t.from,action:t.action,old_subscription_tier:t.oldSubscriptionTier,new_subscription_tier:t.newSubscriptionTier,old_price_id:t.oldPriceId,new_price_id:t.newPriceId,old_currency:t.oldCurrency,new_currency:t.newCurrency,old_add_ons:t.oldAddOns,new_add_ons:t.newAddOns,old_billing_interval:t.oldBillingInterval,new_billing_interval:t.newBillingInterval,is_cancel_subscription:t.isCancelSubscription,space_visible_members:v,is_trial:t.isTrial,device_os:e.device.os,platform:e.device.platform,is_mm_or_ent_trial:t.isMmOrEnt});const b=null===(l=t.oldAddOns)||void 0===l?void 0:l.includes("ai"),y=null===(g=t.newAddOns)||void 0===g?void 0:g.includes("ai");if(!b&&y&&(u.j(e,"ai_addon_purchased",t),o.dG({eventType:"ai_addon_purchased",source:"client"})),!t.oldSubscriptionTier||!t.newSubscriptionTier)return;const{device:_}=e;if(!(0,s.nR)(t.oldSubscriptionTier)&&(0,s.nR)(t.newSubscriptionTier)&&"personal"!==t.newSubscriptionTier){const n={country:t.addressCountry,productName:t.newPriceId,price:t.creditAmount||0,spaceId:(0,i.cj)(t.spaceId),deviceType:_.isTablet?"tablet":_.isMobile?"mobile":"desktop",subscriptionTier:t.newSubscriptionTier};if("professional"===h&&u.j(e,"professional_workspace_upgraded",t),u.j(e,"workspace_upgraded",t),o.dG({eventType:"workspace_upgraded",source:"client",eventData:{...n,domainType:h}}),"professional"===h&&o.dG({eventType:"professional_workspace_upgraded",source:"client"}),"team"===t.planType&&(u.j(e,"team_workspace_upgraded",t),o.dG({eventType:"team_workspace_upgraded",source:"client"})),e.device.isElectron){const o=(0,a.fo)(d.default.domainBaseUrl,{deviceId:await u.cG(e),oldSubscriptionTier:t.oldSubscriptionTier,newSubscriptionTier:t.newSubscriptionTier,isProfessionalTeamUser:t.isProfessionalTeamUser,deviceType:e.device.deviceType,domainType:h,eventData:n});return void c.openExternalUrl(o)}}}function K(e,t){u.j(e,"subscription_update_plan",t),m.default.logEvent("subscription_update_plan",void 0,t)}function G(e,t){u.j(e,"subscription_update_billing",t),m.default.logEvent("subscription_update_billing",void 0,t)}function $(e,t){const{step:n,name:o,email:r,...i}=t;u.j(e,"enterprise_sales_contact",{...i,enterprise_name:o,enterprise_email:r}),m.default.logEvent("enterprise_sales_contact")}function Q(e){u.j(e,"enterprise_sales_contact_opened")}function Y(e){u.j(e,"enterprise_sales_contact_dismissed")}function X(e,t){u.j(e,"enterprise_sales_contact_updated",t)}function J(e,t){u.j(e,"cancel_subscription",t),m.default.logEvent("cancel_subscription",void 0,t)}function ee(e,t){u.j(e,"click_upgrade_button",t),m.default.logEvent("click_upgrade_button",void 0,t)}function te(e,t){u.j(e,"plan_cta_click",t),m.default.logEvent("plan_cta_click",void 0,t)}function ne(e){u.j(e,"compare_all_features_click"),m.default.logEvent("compare_all_features_click",void 0)}function oe(e){u.lu(e,"approaching_block_limit","approaching_block_limit",60)}function re(e){const t=u.lu(e,"reach_block_limit","reach_block_limit",60);m.default.logEvent("reach_block_limit",1),t&&u.Zf(e,{reach_block_limit:!0,reach_block_limit_time:Date.now(),subscription_tier:g.zt()})}function ie(e,t){se(e,{name:"member_requested_ai_addon",args:t}),m.default.logEvent("member_requested_ai_addon",void 0,{...t,device_os:e.device.os,platform:e.device.platform})}function ae(e,t){se(e,{name:"partner_trial_signup",args:t}),m.default.logEvent("partner_trial_signup",void 0,{...t})}function se(e,t){const n=t.name,o="args"in t?t.args:void 0;u.j(e,n,o)}},25888:(e,t,n)=>{n.d(t,{Ar:()=>s,Fs:()=>c,LS:()=>d,Ot:()=>a,V:()=>l,wk:()=>u});var o=n(97978),r=n(24646),i=n(77080);function a(e,t){o.j(e,"open_support_chat",t)}function s(e,t){o.j(e,"click_help",{from:t.from,qna_session_id:t.qnaSessionId}),i.default.logEvent("click_help")}function l(e,t){o.j(e,"click_help_item",{...t,...(0,r.UF)({environment:e})}),"sales_chat"===t.item&&i.default.logEvent("click_help_item")}function c(e,t){o.j(e,"global_click_learn",t)}function d(e){o.j(e,"zendesk_metadata_open_messenger")}function u(e){o.j(e,"zendesk_metadata_signup")}},17224:(e,t,n)=>{n.d(t,{$:()=>M,$1:()=>w,$4:()=>p,BW:()=>R,Bd:()=>g,FN:()=>L,GZ:()=>d,Gp:()=>C,HN:()=>f,IW:()=>T,LB:()=>H,NO:()=>y,OR:()=>D,Ph:()=>j,Pr:()=>_,Qk:()=>E,SJ:()=>V,UD:()=>I,XT:()=>z,YP:()=>O,cX:()=>k,co:()=>W,dw:()=>u,ej:()=>Z,er:()=>A,ix:()=>S,kr:()=>v,mF:()=>x,mi:()=>P,o_:()=>b,pi:()=>m,rF:()=>N,uA:()=>q,v2:()=>h,z:()=>B});var o=n(72126),r=n(97880),i=n(97978),a=n(24646),s=n(68418),l=n(55838),c=n(77080);async function d(e,t){await i.j(e,"manage_teams_filter_click",t)}function u(e,t){i.j(e,"manage_teams_sort",t)}function p(e,t){O(e,"duplicate_team",t)}function m(e,t){i.j(e,"open_team_browser",{...t,...(0,a.UF)({environment:e})})}function f(e,t){i.j(e,"close_team_browser",{...t,num_of_total_teams:t.num_of_joined_teams+t.num_of_unjoined_teams})}function g(e,t){i.j(e,"team_browser_search_cleared",t)}function h(e,t){const{teamStore:n,outliner_type:o}=t;O(e,"team_browser_member_list_hover",{store:n,outliner_type:o})}function v(e,t){i.j(e,"create_team_start",{from:t.from,flow_id:t.flowId}),c.default.logEvent("create_team_start",1,{...t,...(0,a.UF)({environment:e})})}async function b(e,t){const{store:n}=t;await n.load(),O(e,"create_team_complete",t),F("create_team_complete",t)}async function y(e,t){const{store:n}=t;await n.load(),O(e,"enable_teams",t)}function _(e,t){const{screen:n,...o}=t;if(n===s.F.Team){const t={screen:"team",...o};return O(e,"close_create_team_modal",t),void F("close_create_team_modal",t)}const r={screen:"members",flow_id:t.flow_id,from:t.from,team_id:t.team_id,store:t.store};O(e,"close_create_team_modal",r),F("close_create_team_modal",r)}function S(e,t){O(e,"invite_team_members",t),F("invite_team_members",t)}function w(e,t){O(e,"invite_team_groups",t),F("invite_team_groups",t)}function k(e,t){O(e,"set_default_team",t)}function I(e,t){O(e,"join_team",t),F("join_team",t)}function C(e,t){O(e,"archive_team",t)}function x(e,t){O(e,"transition_to_zero_teams",t)}function T(e,t){O(e,"restore_team",t)}function M(e,t){O(e,"remove_team_members",t)}function P(e,t){O(e,"remove_team_groups",t)}function A(e,t){O(e,"change_teams_order",t)}function R(e,t){O(e,"change_team_access_level",t)}function D(e,t){O(e,"update_team_settings",t)}function E(e,t){O(e,"open_outliner_team_overflow",{...t,...(0,a.UF)({environment:e})})}function B(e,t){O(e,"click_outliner_team_overflow_option",t),F("click_outliner_team_overflow_option",t)}function F(e,t){const{store:n,...o}=t;n?c.default.logEvent(e,1,{...i.nB(n),...o}):c.default.logEvent(e,1,t)}async function O(e,t,n){const{store:r,...a}=n;if(!r)return void(await i.j(e,t,{...a}));const s=i.nB(r),l=o.CE(s,"team_id");await i.j(e,t,{...l,...a},{forceOverrideAutomaticEventData:{team_id:s.team_id}})}function Z(e,t,n,r,a){const{store:s,...l}=a;if(!s)return void i.lu(e,t,n,r,{...l});const c=i.nB(s),d=o.CE(c,"team_id");i.lu(e,t,n,r,{...d,...l},{forceOverrideAutomaticEventData:{team_id:c.team_id}})}function V(e,t){O(e,"open_team_home",t)}function U(e){switch(e){case l.a.General:return"general";case l.a.Members:return"members";case l.a.Security:return"security";default:(0,r.t1)(e)}}function N(e,t){O(e,"click_team_settings_tab",{store:t.store,tab_old_value:U(t.tab_old_value),tab_new_value:U(t.tab_new_value)})}function L(e,t){O(e,"restore_team_permissions",t)}function j(e,t){O(e,"team_invite_link_confirmation_selection",t)}function z(e,t){O(e,"copy_team_invite_link",t),F("copy_team_invite_link",t)}function q(e,t){O(e,"click_team_invite_link",t)}function H(e,t){O(e,"request_access_to_team",t)}function W(e,t){O(e,"resolve_team_access_request",t)}},81193:(e,t,n)=>{n.d(t,{$6:()=>F,$K:()=>w,Cu:()=>P,EZ:()=>B,HU:()=>p,Hg:()=>Z,Ib:()=>d,JJ:()=>E,Jw:()=>x,PE:()=>m,T2:()=>c,XQ:()=>y,Xy:()=>u,Y4:()=>R,Yn:()=>I,ZE:()=>k,ar:()=>D,bR:()=>T,dZ:()=>b,en:()=>v,gI:()=>O,jW:()=>f,me:()=>A,n1:()=>g,nn:()=>C,rN:()=>_,sY:()=>S,ye:()=>h});n(57658);var o=n(92996),r=n(4615),i=n(97880),a=n(97978),s=n(24646),l=n(77080);function c(e){a.j(e,"browse_more_templates_click"),l.default.logEvent("browse_more_templates_click",1)}function d(e){a.j(e,"in_app_template_gallery_brand_click")}function u(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];a.j(e,"duplicate_template",{...t,is_paid:!1,is_selectable_fork_page:n}),n&&l.default.logEvent("duplicate_template_from_fork_page_multiple_spaces",t.success?"succeed":"error",{from:t.from,context:t.context})}function p(e,t){a.j(e,"duplicate_template_attempt",t)}function m(e,t){a.j(e,"configure_template_button",t)}function f(e,t){a.j(e,"template_modal_open",{...t,...(0,s.UF)({environment:e})}),l.default.logEvent("template_modal_open",1)}function g(e,t){a.j(e,"template_modal_item_click",t),l.default.logEvent("template_modal_item_click",1)}function h(e,t){a.j(e,"template_modal_get_template_click",t),l.default.logEvent("template_modal_get_template_click",1)}function v(e,t){const{team_id:n,...o}=t;a.j(e,"template_modal_accept",o,{forceOverrideAutomaticEventData:{team_id:n}}),l.default.logEvent("template_modal_accept",1)}function b(e,t){a.j(e,"create_collection_template",t),l.default.logEvent("create_collection_template",1)}function y(e,t){a.j(e,"activate_collection_template",t),l.default.logEvent("activate_collection_template",1)}function _(e,t){a.j(e,"select_template",t)}function S(e,t){a.j(e,"collection_template_action",t)}function w(e,t){a.j(e,"click_outliner_team_new_page",t)}function k(e,t){a.j(e,"click_team_new_page_option",t)}function I(e,t){a.j(e,"show_team_duplicate_template_confirmation",t)}function C(e,t){a.j(e,"click_team_duplicate_template_confirmation_option",t)}function x(e,t){let{from:n,wiki_block_id:r,destination_team_id:i,wiki_template_id:a}=t;M(e,{from:n,preset_uri:"notion://wiki/wiki_preset",created_page_ids:[r],database_types:[o.GZ],destination_team_id:i,wiki_template_id:a})}function T(e,t){let{from:n,preset_uri:o,created_block_stores:r,destination_team_id:a}=t;const s=[],l=[];for(const i of r){var c;const e=null===(c=i.getCollectionStore())||void 0===c?void 0:c.getDatabaseType();e&&(l.push(i.id),s.push(e))}const d=r.map((e=>{var t;return null===(t=e.getFormat())||void 0===t?void 0:t.app_id})).filter(i.$K);M(e,{from:n,preset_uri:o,created_page_ids:l,database_types:s,destination_team_id:a,app_ids:[...new Set(d)]})}function M(e,t){a.j(e,"create_app_template",t)}function P(e,t){a.j(e,"delete_app_template",t)}function A(e,t){a.j(e,"create_typed_dbs_in_team_latency",t)}function R(e,t){a.j(e,"apply_preset_features",t)}function D(e,t){a.j(e,"template_duplication_v2_modal_exposed",{template_block_id:(0,r.F9)(t.templateBlockId),from:t.from,num_of_space_views:t.numOfSpaceViews,num_of_loaded_space_views:t.numOfLoadedSpaceViews,num_of_editable_space_views:t.numOfEditableSpaceViews,group:t.group})}function E(e,t){a.j(e,"template_duplication_v2_modal_open",{template_block_id:(0,r.F9)(t.templateBlockId),from:t.from,num_of_space_views:t.numOfSpaceViews,num_of_loaded_space_views:t.numOfLoadedSpaceViews,num_of_editable_space_views:t.numOfEditableSpaceViews,group:t.group})}function B(e,t){a.j(e,"template_duplication_v2_modal_close",{template_block_id:t.templateBlockId&&(0,r.F9)(t.templateBlockId)})}function F(e,t){a.j(e,"template_duplication_v2_account_switcher_open",{template_block_id:(0,r.F9)(t.templateBlockId),num_of_users:t.numOfUsers})}function O(e,t){a.j(e,"template_duplication_v2_switch_space",{template_block_id:(0,r.F9)(t.templateBlockId),template_destination_space_id:t.templateDestinationSpaceId&&(0,r.F9)(t.templateDestinationSpaceId),num_of_users:t.numOfUsers})}function Z(e,t){a.j(e,"template_duplication_v2_fork_page",{template_block_id:(0,r.F9)(t.templateBlockId),template_destination_space_id:t.templateDestinationSpaceId&&(0,r.F9)(t.templateDestinationSpaceId),template_destination_type:t.templateDestinationType,template_destination_team_id:t.templateDestinationTeamId&&(0,r.F9)(t.templateDestinationTeamId)})}},11969:(e,t,n)=>{n.d(t,{K:()=>r,y:()=>i});var o=n(97978);function r(e,t){const{from:n}=t;o.j(e,"show_tooltip",{from:n,time:Date.now()})}function i(e,t){const{from:n}=t;o.j(e,"dismiss_tooltip",{from:n,time:Date.now()})}},3022:(e,t,n)=>{n.d(t,{F4:()=>u,Gb:()=>i,LA:()=>a,SL:()=>m,Y_:()=>v,ap:()=>f,h2:()=>h,iB:()=>l,kY:()=>c,mc:()=>b,sI:()=>p,vk:()=>r,vt:()=>s,y9:()=>d,zQ:()=>g});var o=n(97978);function r(e,t){o.lu(e,"legacy_transclusion_show",`legacy_transclusion_show_${t.block_type}`,3600,t)}function i(e,t){o.j(e,"legacy_transclusion_autofix",t)}function a(e,t){o.j(e,"transaction_timestamp_collision",t)}function s(e,t){o.j(e,"transaction_timestamp_regression",t)}function l(e,t){o.j(e,"transaction_race_hazard",t)}function c(e,t){o.j(e,"transaction_async_data_loss",t)}function d(e,t){o.j(e,"transaction_deadlock_warning",t)}function u(e,t){o.j(e,"transaction_too_large",t)}function p(e,t){o.j(e,"transaction_queue_error_show",t)}function m(e){o.j(e,"connection_error_show",{})}function f(e,t){o.j(e,"connection_error_indicator_details_show",t)}function g(e,t){o.j(e,"low_storage_error_show",t)}function h(e,t){o.j(e,"transaction_queue_healthcheck",t)}function v(e,t){o.j(e,"save_edits_error_modal_show",t)}function b(e,t){o.j(e,"unsaved_transaction_error",t)}},54642:(e,t,n)=>{n.r(t),n.d(t,{activateReferral:()=>bo,addUserToWaitlist:()=>cc,addUsersToSpace:()=>vn,addWebClipperFile:()=>kt,addWebClipperURLs:()=>Do,adminAddLinkPreviewToSpace:()=>Ql,adminAddPublicEmailDomains:()=>Xr,adminAddZeroRetentionSpace:()=>Qt,adminAllowlistCreditDomain:()=>Qo,adminBanUser:()=>Ka,adminBlockEmailDomain:()=>oa,adminBulkAddEduUniversitiesAndDomains:()=>mc,adminBulkAddPromotionCodes:()=>Wi,adminBulkApplyPromotionCodes:()=>$i,adminBulkBanUsers:()=>Ga,adminBulkCreateTimedTrials:()=>vl,adminBulkRemoveSpaceGuests:()=>Ki,adminBulkUpgradeEduPlusUser:()=>Xi,adminBypassEmailReputationChecks:()=>fr,adminCancelSpaceConsolidation:()=>ns,adminCancelSubscription:()=>Or,adminChangeEmail:()=>jr,adminCheckHIPAAComplianceStatus:()=>Yt,adminCheckStatsigSegment:()=>Ko,adminClaimAndUpgradeForSalesAssisted:()=>Ja,adminContentSearch:()=>Us,adminCopyPageBetweenEnvironments:()=>aa,adminCountWordsInPage:()=>sa,adminCreateMarketingRoute:()=>Wa,adminDelayClaimSpaceDeletion:()=>es,adminDeleteFileFromS3:()=>Bi,adminDeleteSpaces:()=>ln,adminDeleteUser:()=>$t,adminDescribeAccountsToReset:()=>cn,adminDescribeDeleteFileFromS3:()=>Fi,adminDescribeDeletedBlockPermissions:()=>Li,adminDescribeEditSpacePermission:()=>nn,adminDescribeRestoreDeletedGuestPermissions:()=>$l,adminDescribeRunSpaceConsolidation:()=>sn,adminDescribeSpacesToDelete:()=>an,adminDisableReverifyForUser:()=>rn,adminDowngradeFraudSubscription:()=>ys,adminEditBlockPermissions:()=>Jt,adminEditSpacePermissions:()=>tn,adminEditTeamMembership:()=>mn,adminExplainPaymentStatus:()=>Cl,adminFindDeletedUser:()=>$o,adminForceResyncExternalObjects:()=>La,adminGetAutomationsForRecordId:()=>pc,adminGetBulkIds:()=>xl,adminGetBulkSpaceIdsByDomain:()=>rr,adminGetBulkSpaceIdsByEmail:()=>ir,adminGetBulkUserIdsByEmail:()=>ar,adminGetClientExperiments:()=>qo,adminGetCurrentUserPermissions:()=>Ai,adminGetDataAccessConsent:()=>or,adminGetDomainClaimEligibleSpaces:()=>Ya,adminGetDomainManagementSettings:()=>Xa,adminGetIntegrationData:()=>Oa,adminGetOwnership:()=>Pi,adminGetPublicPages:()=>pa,adminGetRateLimits:()=>Ri,adminGetSamlConfig:()=>Di,adminGetSlackIntegrationData:()=>Va,adminGetSpaceMembershipUpdates:()=>hl,adminGetSpacesForAllowedEmailDomain:()=>Oi,adminGetStatsigExperiment:()=>Ho,adminGetStatsigFeatureGate:()=>Wo,adminGetSyncedDatabaseData:()=>Ua,adminGetUserBillingInformation:()=>mr,adminGetWorkspaceWebhookSubscriptions:()=>dc,adminIsSpaceDomainClaimEligible:()=>Qa,adminIsWorkspaceInQnA:()=>rc,adminJoinSpacesForOauthRedirect:()=>Na,adminListData:()=>Xt,adminMergeUsers:()=>ic,adminModifyBlock:()=>Ui,adminMonetizationTaskRunnerEnqueue:()=>Yi,adminOnboardAISlackQnA:()=>dn,adminOptOutNotionAIDataSharing:()=>wl,adminPartnerStackFixMissingProductKeys:()=>Qi,adminPrimaryWorkspaceChange:()=>Ei,adminQnACheckIndexingStatus:()=>un,adminReadBlockPermissions:()=>en,adminRecoverMfa:()=>ur,adminRecoverUserContentInSpace:()=>ac,adminReleaseSubscriptionSchedule:()=>sl,adminRemoveAllowedEducationEmails:()=>Gi,adminRemoveChildFromExternalCollection:()=>ts,adminRemoveSpaceUsersAndTransferContent:()=>pr,adminResetAccounts:()=>pn,adminResetRateLimits:()=>Zi,adminRestoreBlock:()=>Ni,adminRestoreDeletedCollectionProperties:()=>ma,adminRestoreDeletedGuestPermissions:()=>Gl,adminRevokeBotToken:()=>zt,adminRunSpaceConsolidation:()=>os,adminSamlConfigForSpace:()=>gr,adminSearchAuditLog:()=>$a,adminSearchBlocks:()=>sr,adminSearchBots:()=>uc,adminSearchCollectionViews:()=>dr,adminSearchCollections:()=>cr,adminSearchForUsersInSpaces:()=>nr,adminSearchPermanentlyDeletedPages:()=>ra,adminSearchSpaceActivity:()=>ia,adminSearchSpaces:()=>tr,adminSearchTeams:()=>lr,adminSearchUserAdminToolRoles:()=>zo,adminSearchUsers:()=>jo,adminSetDisableSpacePublicAccess:()=>Wr,adminSetPageContentClassification:()=>on,adminSetSpaceDomain:()=>Kr,adminSetupExperiment:()=>Er,adminShowCustomerInvoice:()=>Jr,adminSwapUserDomains:()=>ei,adminSwapUserEmails:()=>ti,adminUpdateAddOnSubscription:()=>al,adminUpdateExperiment:()=>Dr,adminUpdateIntegrationData:()=>Za,adminUpdateNotionAIAvailabilityForSpace:()=>gl,adminUpdateNotionCalendarAvailableForSpace:()=>bc,adminUpdatePaymentStatus:()=>Tl,adminUpdateStatsigSegmentIds:()=>Go,adminUpdateSubscription:()=>Fr,adminUpdateTeamMember:()=>fn,adminUpdateUserSettings:()=>gn,adminViewDeletedCollectionProperties:()=>fa,adminViewExperiments:()=>Rr,aiSourcePicker:()=>ha,allowEducationEmails:()=>Zr,annotateRecentIntercomConversation:()=>Vi,applyCustomerOffer:()=>Ms,authCreateBackupCodes:()=>Xs,authCreateSms:()=>Ft,authCreateTotp:()=>$s,authGetLoginConfiguration:()=>xt,authSendSms:()=>Zt,authUpdateMfa:()=>Ut,authVerifyBackupCodesLogin:()=>Js,authVerifyPassword:()=>el,authVerifySmsEnroll:()=>Ot,authVerifySmsLogin:()=>Vt,authVerifyTotpEnroll:()=>Ys,authVerifyTotpLogin:()=>Qs,authWithAsana:()=>_o,authWithEvernote:()=>Bo,authWithExternalIntegration:()=>xo,authWithGoogleForDrive:()=>Co,authWithSlack:()=>Io,authWithTrello:()=>ko,authenticateConfluenceUser:()=>Le,authenticateJiraUser:()=>je,authenticateMondayUser:()=>We,calculateTax:()=>Ji,cancelSpaceDeletionForDomain:()=>bs,cancelSubscription:()=>Ze,changeEmail:()=>Et,checkFilePermission:()=>eo,checkSpaceDomain:()=>ea,claimAndUpgradeSpace:()=>fs,completeMultipartUpload:()=>Ss,createDomainVerificationCode:()=>as,createEmailUser:()=>fe,createOauthAuthorizationCode:()=>ua,createSpace:()=>Hr,createTeam:()=>xa,deleteBlocks:()=>wn,deleteBot:()=>ta,deleteDomainVerificationCode:()=>rs,deleteGroup:()=>Dn,deleteIntegration:()=>na,deleteManagedUser:()=>_r,deleteSpace:()=>Ht,deleteSpaceForDomain:()=>vs,deleteTemplate:()=>Zl,deleteTemplateDraft:()=>Vl,deleteUser:()=>Wt,disableUserAnalytics:()=>co,disconnectAsana:()=>Mt,disconnectConfluence:()=>Qe,disconnectDrive:()=>Rt,disconnectEvernote:()=>At,disconnectJiraAccount:()=>qe,disconnectMonday:()=>Ye,disconnectTrello:()=>Pt,duplicateBlock:()=>te,enableTeams:()=>Gt,enqueueScanContentTask:()=>gc,enqueueTask:()=>gt,exportAdminContentSearch:()=>so,exportAuditLog:()=>oo,exportBlock:()=>mt,exportBlockPreview:()=>Uo,exportContentAnalytics:()=>ao,exportDomainClaimableSpaces:()=>ro,exportSpace:()=>no,exportSpaceGuests:()=>tc,exportSpaceMembers:()=>ec,exportUserAnalytics:()=>io,finalizeAppTemplate:()=>Lo,findUser:()=>oe,generateTemplateScreenshot:()=>ft,getAIUsageEligibility:()=>ll,getAboutNotionDevelopers:()=>qs,getAccessRequests:()=>ii,getActiveExportTasks:()=>Il,getActiveImportTasks:()=>ne,getActivityLog:()=>Dt,getAdminHistory:()=>Ti,getAiSuggestedProperties:()=>pl,getAiWaitlistRequestsForSpace:()=>hc,getAllTeamsInSpaceForAdmin:()=>Aa,getAsanaAccount:()=>$,getAsanaWorkspacesNames:()=>X,getAssetsJson:()=>W,getAssetsJsonV2:()=>K,getAssetsJsonV3:()=>G,getAssistantAutomationsInSpace:()=>Te,getAssistantLibraryCode:()=>Re,getAssistantLogs:()=>Ae,getAuthorizedEmailPreferenceCenterLink:()=>li,getAvailableCountries:()=>wi,getBacklinksForBlock:()=>Nt,getBillingHistory:()=>to,getBlockAdminApiLog:()=>xi,getBlockFileDownloadUrl:()=>ue,getBookmarks:()=>Sn,getBotToken:()=>Lt,getBots:()=>po,getChatTranscriptSessionHistoryForUser:()=>Me,getClientExperiments:()=>Pr,getClientExperimentsV2:()=>Ar,getCollectionViewBlocksByAppId:()=>ks,getCompletion:()=>wo,getCompletionForProperty:()=>cl,getCompletionForSelectOption:()=>ul,getConfluenceAccount:()=>$e,getConfluenceSpaces:()=>Ge,getConnectedAppsStatus:()=>So,getContentEngagementAnalytics:()=>Es,getCostForSpaceUpgrade:()=>ms,getCustomerOffer:()=>xs,getCustomerOfferEligibility:()=>Ts,getDailyUsersAnalytics:()=>Rs,getDataAccessConsent:()=>di,getDataAccessConsentForManagedUser:()=>kr,getDesktopAppRegistration:()=>Ks,getDesktopDownloadUrl:()=>Oe,getDeveloperBotsAndIntegrations:()=>zi,getDomainVerificationCodesForSpace:()=>ss,getEmailDomainSettings:()=>xr,getEmailDomainsForSpace:()=>vr,getEmailsWithoutAccessToBlock:()=>ya,getEvernoteAccount:()=>Q,getEvernoteNotebooks:()=>Ao,getExternalCollectionSyncState:()=>ba,getExternalIntegrationAccessToken:()=>Ps,getExternalIntegrations:()=>la,getExternalNotificationChannels:()=>Vs,getExternalOrgData:()=>lc,getGenericEmbedBlockData:()=>Nr,getGeoIpLocation:()=>bl,getGiphyRandomId:()=>Jo,getGoogleDriveAccounts:()=>To,getHarmonicData:()=>ke,getHistoricalAuditLogUsers:()=>ce,getHomeEnabledSpaceViews:()=>vc,getIdFromUniqueId:()=>ol,getInAppCategoriesAndTemplates:()=>il,getInferenceTestExamples:()=>Ls,getIntegrationDataForGallery:()=>Ea,getIntegrationDomainVerifications:()=>qi,getIntegrationIdsForGallery:()=>Ba,getIntegrationSecret:()=>Hi,getInvoiceData:()=>hn,getJoinableSpaces:()=>yn,getLivestormEvents:()=>Be,getLivestormSessions:()=>Fe,getLoginOptions:()=>Ct,getManagedUsers:()=>br,getMondayFoldersAndBoards:()=>Je,getMondayUser:()=>Ke,getMondayWorkspaces:()=>Xe,getNextRelabelingTask:()=>Pe,getNotificationLog:()=>Fn,getNotificationLogPrototype:()=>Zn,getNotificationLogV2:()=>On,getPageAnalytics:()=>Cs,getPageAssistantPreferences:()=>Wl,getPageVisitors:()=>pi,getPrivatePageInfo:()=>Ra,getPromoCode:()=>Ur,getPublicApiObject:()=>Gs,getPublicPageData:()=>Kt,getPublicSpaceData:()=>$n,getPublishedPagesForUser:()=>oc,getQnaOnboardingData:()=>Ue,getRecentPageVisits:()=>me,getRecentlyRemovedUsers:()=>qa,getRecoverableSpaceUserContent:()=>ja,getSamlConfigForSpace:()=>hr,getSamlRedirect:()=>Tt,getSelectPropertyValues:()=>En,getSignedFileUrl:()=>xc,getSkillsInSpace:()=>xe,getSnapshotContents:()=>ho,getSnapshotsList:()=>go,getSpaceAdminApiLog:()=>Ci,getSpaceMembershipUpdates:()=>Ll,getSpaces:()=>_n,getSpacesCreatedByUserWithDomains:()=>us,getSpacesInOrganization:()=>fc,getSprintBoardViewBlocks:()=>Is,getSubitems:()=>H,getSubscriptionData:()=>Ve,getSuggestedPageQna:()=>ml,getTasks:()=>oi,getTeamAccessRequestMetadata:()=>yl,getTeams:()=>Pa,getTeamsAndProjectsInAsanaWorkspace:()=>J,getTemplateContentGroup:()=>ve,getTemplateCreator:()=>Al,getTemplateDrafts:()=>Ul,getTemplateSearchResults:()=>Ml,getTemplates:()=>Pl,getTestFlightStatus:()=>ri,getTransitivePageRelations:()=>kl,getTrelloAccount:()=>Y,getTrelloBoards:()=>ee,getTypedDatabases:()=>ws,getUniversitiesAndDomains:()=>Jl,getUnreadAccessRequestCount:()=>si,getUnvisitedNotificationIds:()=>Vn,getUploadFileUrl:()=>qt,getUserAdminApiLog:()=>Ii,getUserAnalyticsSettings:()=>In,getUserContractionData:()=>jl,getUserEngagementAnalytics:()=>Ds,getUserHomePages:()=>Si,getUserNotifications:()=>zn,getUserSharedPagesInSpace:()=>yi,getUserSignals:()=>_i,getUserSpaceExternalBots:()=>da,getUserTasks:()=>ni,getVerifiedEmailDomain:()=>Zs,getVisibleUsers:()=>Ne,getWebClipperData:()=>Ro,getWebhookSubscriptions:()=>mo,getZendeskTicketConversation:()=>ca,handleRecordMapForResponse:()=>O,identifySegmentUser:()=>Ln,identifySegmentWorkspace:()=>Nn,importAsanaIntoBetterTemplate:()=>st,importConfluenceExport:()=>ot,importEvernote:()=>pt,importFile:()=>et,importJiraProjectsIntoTeamspace:()=>lt,importTrello:()=>at,initializeGoogleDriveBlock:()=>Mo,initializePageTemplate:()=>No,initializeUserAnalytics:()=>Yn,initializeUserAnalyticsEmptySync:()=>Xn,initiateMultipartUpload:()=>_s,initiateWorkspaceTransfer:()=>ps,invalidateSubscriptionData:()=>ki,inviteGuestsToSpace:()=>Qr,isEligibleForGuestMembershipRequest:()=>js,isEmailEducation:()=>Vr,isRecordKeyAvailable:()=>nl,isUserDomainJoinable:()=>Lr,leaveBlock:()=>Gn,listExternalCollections:()=>Ia,listExternalObjects:()=>Ca,listPrices:()=>ye,loadBlockSubtree:()=>Qn,loadCachedPageChunk:()=>Tn,loadCachedPageChunkBatched:()=>_c,loadCachedPageChunks:()=>Mn,loadContacts:()=>Hs,loadContentAnalytics:()=>Fs,loadPageChunk:()=>Pn,loadSearchAnalytics:()=>Os,loadUserContent:()=>xn,loadWorkspaceAnalyticsUsers:()=>Bs,loginWithAppleAuth:()=>ht,loginWithAppleNativeAuth:()=>vt,loginWithEmail:()=>bt,loginWithGoogleAuth:()=>_t,loginWithGoogleJwt:()=>yt,logout:()=>St,logoutActiveSessions:()=>qr,logoutManagedUsers:()=>Tr,markDiscussionNotificationsRead:()=>Da,moveToSpace:()=>$r,parallelAsanaImport:()=>dt,parallelImportConfluenceExport:()=>rt,parallelImportConfluenceViaApi:()=>it,parallelJiraImport:()=>ct,parallelMondayImport:()=>ut,pendingTaskEventsById:()=>Tc,pendingTaskIds:()=>z,performAiSearch:()=>Ce,ping:()=>Oo,postGiphyAnalytics:()=>er,previewMidtermSubscriptionChanges:()=>_e,processShareActionToBlock:()=>_a,publishAiSession:()=>nc,queryCollection:()=>An,recordCookieConsent:()=>Fa,recordPageExit:()=>fi,recordPageVisit:()=>mi,recoverSpace:()=>Zo,recoverUser:()=>Fo,recoverUserContentInSpace:()=>Ha,refetchExternalObjectInstanceBlocks:()=>ka,refreshGoogleDriveBlock:()=>Po,refreshInviteLink:()=>Yr,registerDesktopApp:()=>Ws,releaseSubscriptionSchedule:()=>be,removeManagedUserFromSpace:()=>Cr,removeUsersFromSpace:()=>bn,renameGroup:()=>Rn,reportBadQnA:()=>le,reportBadSearch:()=>se,reportPage:()=>Mi,requestAccess:()=>ci,requestClaimAndUpgrade:()=>gs,resetExperimentOverrides:()=>wa,resetPasswordsForManagedUsers:()=>Mr,resolveAccessRequest:()=>sc,resolveAddress:()=>ji,restoreBlock:()=>kn,restoreSnapshot:()=>vo,resubscribeExternalCollection:()=>va,retrieveFeedbackRecord:()=>fl,revokeBotToken:()=>jt,revokeUserTokens:()=>Vo,runAsyncAiSearch:()=>tt,runFinetuningDataGenerator:()=>nt,saveAssistantFeedback:()=>Ie,saveAssistantLabelerFeedback:()=>De,saveRelabelingTaskFeedback:()=>Ee,saveTransactions:()=>Gr,search:()=>re,searchAuditLog:()=>ie,searchContacts:()=>ae,searchGiphyImages:()=>Xo,searchIntegrations:()=>de,searchUnsplashImages:()=>Yo,searchVectors:()=>Ns,searchWebClipperPages:()=>Eo,sendEmailVerification:()=>Bt,sendTemporaryPassword:()=>It,sendVerifyTransferEmail:()=>As,setAdminPrivilegedTeamMembership:()=>Ta,setBookmarkMetadata:()=>yo,setDataAccessConsent:()=>ui,setDataAccessConsentForManagedUser:()=>Ir,setLocale:()=>pe,setNotificationsAsRead:()=>jn,setNotificationsStatus:()=>Hn,setPageAssistantPreferences:()=>Kl,setPageNotificationsAsRead:()=>qn,setPassword:()=>zr,setRecordKey:()=>tl,setSamlConfig:()=>ds,setSeenGuestMembershipRequests:()=>zs,setSpaceNotificationsAsRead:()=>Wn,setStatusPropertyDefaults:()=>Bn,spaceAdminRestoreAccess:()=>gi,streamCascadeInference:()=>dl,stripeAdvanceTestClock:()=>_l,stripeGetTestClock:()=>Sl,submitContactSales:()=>Se,submitEducationGroupApplication:()=>Xl,submitFormstack:()=>we,submitTemplate:()=>Rl,submitTemplateCreator:()=>Dl,submitTemplateDraft:()=>Ol,suggestRecordKey:()=>rl,syncRecordValue:()=>wc,syncRecordValues:()=>Cn,testCreatePage:()=>ql,testDeleteRecord:()=>Hl,testSetupWorkspace:()=>zl,testWebhookConnection:()=>fo,trackConversionEvent:()=>hi,trackSegmentEvent:()=>Un,transferPermissionGroup:()=>lo,transferSpaceUserContent:()=>za,transferWorkspaceToUser:()=>hs,unfurlUrl:()=>ga,unsubscribeFromEmails:()=>Kn,unsubscribeFromIntercomEmails:()=>uo,updateDisableGuestsOnSpace:()=>Yl,updateEmailDomainSettings:()=>Sr,updateExperimentOverride:()=>Sa,updateJiraSyncedTaskCollectionSchema:()=>ze,updateJiraWebhook:()=>He,updateOrganization:()=>ai,updatePaymentMethod:()=>he,updatePinnedTemplates:()=>Nl,updatePublicHomePage:()=>bi,updateSpaceDomain:()=>vi,updateSubscription:()=>ge,updateSubscriptionToEducationPlan:()=>Br,updateTeamMembers:()=>Ma,updateUserProfile:()=>wr,updateUserSuspension:()=>yr,updateWorkspaceCreationForEmailDomains:()=>ls,validateTemplate:()=>El,validateTemplateCreatorHandle:()=>Bl,validateTemplateDraftSlug:()=>Fl,validateUserCanCreateWorkspace:()=>cs,verifyDomain:()=>is,verifyEmail:()=>wt});n(57658);var o=n(39593),r=n.n(o),i=n(28084),a=n(54064),s=n(43593),l=n(68626),c=n(59730),d=n(74229),u=n(72126),p=n(97213),m=n(45953),f=n(606),g=n(89101),h=n(32739),v=n(63143),b=n(95477),y=n(97978),_=n(41424),S=n(33954),w=n(24608),k=n(33929),I=n(18514),C=n(80444),x=n(88632),T=n(79167),M=n(77144),P=n(33759),A=n(47307),R=n(97977),D=n(4408),E=n(8055),B=n(12170);const F=function(e){for(const t of Object.keys(e)){const n=e[t];(u.Ft(n)||u.o8(n))&&delete e[t]}};function O(e){const{environment:t,eventName:n,response:o,userId:r}=e;if(o&&o.recordMap){const e=m.PF.create(o.recordMap);"syncRecordValues"!==n&&D.fL({environment:t,userId:r,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,recordMap:e,maybeStaleRecordMap:"loadCachedPageChunk"===n||"loadCachedPageChunks"===n,debugSource:"handleRecordMapForResponse"})}}let Z;async function V(e,t,n,o){if((0,c.tn)(n.body)){A.showError(n);const t=n.body.clientData&&(0,S.cq)(n.body.clientData);y.j(e,"show_user_validation_response",{type:null==t?void 0:t.type})}if(n.offline)return n;console.error(n.error);const{RouterStore:r}=e;if(401===n.status&&l.log({level:"error",from:"api",type:"httpTrigger401",data:{eventName:t,isLoggedIn:e.currentUser.isLoggedIn(),miscDataToConvertToString:{response:n},routeName:r.state.route.name}}),403===n.status&&n.headers["content-type"]&&n.headers["content-type"].startsWith("text/html")&&l.logWithSampleRate({logMessage:{level:"error",from:"api",type:"httpTrigger403",data:{eventName:t,isLoggedIn:e.currentUser.isLoggedIn(),miscDataToConvertToString:{response:n},userId:e.currentUser.id,routeName:r.state.route.name}},samplePercentage:1}),401===n.status&&Boolean(n.body&&n.body.errorId)&&e.currentUser.isLoggedIn())switch(r.state.route.name){case"page":if((0,I.Sr)()){await R.actuallyLogoutAndDeleteMostLocalData({environment:e,nextLocation:window.location.pathname,logoutOrigin:p.F.PublicPageAccessDenied});break}case"root":case"space":case"onboarding":case"myIntegrations":case"inAppTemplateSubmission":case"inAppTemplateCreatorSubmission":case"creatorProfile":case"creatorProfileAnalytics":case"creatorProfileTemplates":case"studentGroupSignup":if(o&&o===e.currentUser.id){const t=u.Ds((async()=>await R.actuallyLogoutAndDeleteMostLocalData({environment:e,userId:o,doNotRedirect:!0,logoutOrigin:p.F.PageAccessDenied})),1e3);await t();!function(e,t){if((0,c.Jx)(t.body)&&"saml_sso_required"===t.body.clientData.type){const e=(0,S.wf)(k.default.getIntl(),t);P.Z.setState({...P.Z.state,loginType:"saml",alert:e})}E.c4({environment:e,url:g._j.login})}(await R.clearCurrentUser(e),n)}}return n}async function U(e){const{environment:t,eventName:n,data:o,userId:r,tracking:i,abortSignal:a,prefetchCacheKey:s,encoding:c}=e;F(o);const d=r||t.currentUser.id,u=(0,_.yX)({environment:t,eventName:n,data:o,activeUserId:d,tracking:i,abortSignal:a,encoding:c});let p;s&&t.prefetchCache&&(p=t.prefetchCache.getPrefetchedHttpRequest(s,u,a)),p||(p=(0,w.ZP)(u)),M.Z.incrementNumApiCallsInitiated();const m=await p;return M.Z.incrementNumApiCallsCompleted(),"success"===m.type?(O({environment:t,eventName:n,response:m.data,userId:d}),function(e){const{environment:t,responseUserId:n,eventName:o}=e;if(!n)return;if("saveTransactions"!==o)return;const{id:r}=t.currentUser;if(n!==r){if(Z===n)return;const{currentUserStore:e,currentUserRootStore:t,currentUserSettingsStore:i,currentSpaceViewStore:a}=C.default.state,s=r||"<undefined>",c=`currentUser ${s} didn't match user's cookie ${n}`;l.log({from:"client/api",level:"error",type:"currentUserWrong",data:{eventName:o,miscDataToConvertToString:{responseUserId:n,connectionStoreState:x.Z.state,currentUserId:s,userStoreId:e&&e.id,userRootStoreId:t&&t.id,userSettingsStoreId:i&&i.id,currentSpaceViewStoreParentId:a&&a.getParentId()},message:c}}),Z=n}else Z=void 0}({environment:t,eventName:n,responseUserId:m.headers["X-Notion-User-Id"]}),m):V(t,n,m,d)}function N(e){return function(t,n,o,r,i,a,s){return U({environment:t,eventName:e,data:n,userId:o,tracking:r,abortSignal:i,prefetchCacheKey:a,encoding:s})}}function L(e){return async function(t,n,o,r){const i=o||t.currentUser.id,a=(0,_.tZ)({environment:t,eventName:e,data:n,activeUserId:i,tracking:r,abortSignal:void 0,format:"jsonStream"}),s=await(0,w.ZP)(a);return"failed"===s.type?V(t,e,s,i):(d.H1.is(s.data)||O({environment:t,eventName:e,response:s.data,userId:i}),s)}}const j=async function(e){return new Promise(((t,n)=>{Tc.addOnceListener(e,(e=>{t(e)}))}))},z=new Set,q=function(e){return async function*(t,n){const o={task:{eventName:e,request:n}},r=await gt(t,o);if("failed"===r.type)yield{error:r.error,taskStatus:"not_started"};else{const{taskId:o}=r.data;for(z.add(o);;){const r=await j(o);if("success"===r.state){const n=r.status;O({environment:t,eventName:e,response:n}),yield{value:n,taskStatus:r.state};break}if("failure"===r.state){yield{error:new c.hm(r.error||"Something went wrong.",{eventName:e,request:n},r.clientData),taskStatus:r.state};break}"in_progress"===r.state&&r.status&&(yield{value:r.status,taskStatus:r.state})}}}},H=N("getSubitems"),W=N("getAssetsJson"),K=N("getAssetsJsonV2"),G=N("getAssetsJsonV3"),$=N("getAsanaAccount"),Q=N("getEvernoteAccount"),Y=N("getTrelloAccount"),X=N("getAsanaWorkspacesNames"),J=N("getTeamsAndProjectsInAsanaWorkspace"),ee=N("getTrelloBoards"),te=q("duplicateBlock"),ne=N("getActiveImportTasks"),oe=N("findUser"),re=N("search"),ie=N("searchAuditLog"),ae=N("searchContacts"),se=N("reportBadSearch"),le=N("reportBadQnA"),ce=N("getHistoricalAuditLogUsers"),de=N("searchIntegrations"),ue=N("getBlockFileDownloadUrl"),pe=N("setlocale"),me=N("getRecentPageVisits"),fe=N("createEmailUser"),ge=N("updateSubscription"),he=N("updatePaymentMethod"),ve=N("getTemplateContentGroup"),be=N("releaseSubscriptionSchedule"),ye=N("listPrices"),_e=N("previewMidtermSubscriptionChanges"),Se=N("submitContactSales"),we=N("submitFormstack"),ke=N("getHarmonicData"),Ie=N("saveAssistantFeedback"),Ce=N("performAiSearch"),xe=N("getSkillsInSpace"),Te=N("getAssistantAutomationsInSpace"),Me=N("getChatTranscriptSessionHistoryForUser"),Pe=N("getNextRelabelingTask"),Ae=N("getAssistantLogs"),Re=N("getAssistantLibraryCode"),De=N("saveAssistantLabelerFeedback"),Ee=N("saveRelabelingTaskFeedback"),Be=N("getLivestormEvents"),Fe=N("getLivestormSessions"),Oe=N("getDesktopDownloadUrl"),Ze=N("cancelSubscription"),Ve=N("getSubscriptionData"),Ue=N("getQnaOnboardingData"),Ne=N("getVisibleUsers"),Le=N("authenticateConfluenceUser"),je=N("authenticateJiraUser"),ze=N("updateJiraSyncedTaskCollectionSchema"),qe=N("disconnectJiraAccount"),He=N("updateJiraWebhook"),We=N("authenticateMondayUser"),Ke=N("getMondayUser"),Ge=N("getConfluenceSpaces"),$e=N("getConfluenceAccount"),Qe=N("disconnectConfluence"),Ye=N("disconnectMonday"),Xe=N("getMondayWorkspaces"),Je=N("getMondayFoldersAndBoards"),et=q("importFile"),tt=q("runAsyncAiSearch"),nt=q("runFinetuningDataGenerator"),ot=q("importConfluenceExport"),rt=q("parallelImportConfluenceExport"),it=q("parallelImportConfluenceViaApi"),at=q("importTrello"),st=q("importAsanaIntoBetterTemplate"),lt=q("importJiraProjectsIntoTeamspace"),ct=q("parallelJiraImport"),dt=q("parallelAsanaImport"),ut=q("parallelMondayImport"),pt=q("importEvernote"),mt=q("exportBlock"),ft=q("generateTemplateScreenshot"),gt=N("enqueueTask"),ht=N("loginWithAppleAuth"),vt=N("loginWithAppleNativeAuth"),bt=N("loginWithEmail"),yt=N("loginWithGoogleJwt"),_t=N("loginWithGoogleAuth"),St=N("logout"),wt=N("verifyEmail"),kt=N("addWebClipperFile"),It=N("sendTemporaryPassword"),Ct=N("getLoginOptions"),xt=N("authGetLoginConfiguration"),Tt=N("getSamlRedirect"),Mt=N("disconnectAsana"),Pt=N("disconnectTrello"),At=N("disconnectEvernote"),Rt=N("disconnectDrive"),Dt=N("getActivityLog"),Et=N("changeEmail"),Bt=N("sendEmailVerification"),Ft=N("authCreateSms"),Ot=N("authVerifySmsEnroll"),Zt=N("authSendSms"),Vt=N("authVerifySmsLogin"),Ut=N("authUpdateMfa"),Nt=N("getBacklinksForBlock"),Lt=N("getBotToken"),jt=N("revokeBotToken"),zt=N("adminRevokeBotToken"),qt=N("getUploadFileUrl"),Ht=q("deleteSpace"),Wt=N("deleteUser"),Kt=N("getPublicPageData"),Gt=N("enableTeams"),$t=N("adminDeleteUser"),Qt=N("adminAddZeroRetentionSpace"),Yt=N("adminCheckHIPAAComplianceStatus"),Xt=N("adminListData"),Jt=N("adminEditBlockPermissions"),en=N("adminReadBlockPermissions"),tn=N("adminEditSpacePermissions"),nn=N("adminDescribeEditSpacePermission"),on=N("adminSetPageContentClassification"),rn=N("adminDisableReverifyForUser"),an=N("adminDescribeSpacesToDelete"),sn=N("adminDescribeRunSpaceConsolidation"),ln=N("adminDeleteSpaces"),cn=N("adminDescribeAccountsToReset"),dn=N("adminOnboardAISlackQnA"),un=N("adminQnACheckIndexingStatus"),pn=N("adminResetAccounts"),mn=N("adminEditTeamMembership"),fn=N("adminUpdateTeamMember"),gn=N("adminUpdateUserSettings"),hn=N("getInvoiceData"),vn=N("addUsersToSpace"),bn=N("removeUsersFromSpace"),yn=N("getJoinableSpaces"),_n=N("getSpaces"),Sn=N("getBookmarks"),wn=N("deleteBlocks"),kn=N("restoreBlock"),In=N("getUserAnalyticsSettings"),Cn=N("syncRecordValues"),xn=N("loadUserContent"),Tn=N("loadCachedPageChunk"),Mn=N("loadCachedPageChunks"),Pn=N("loadPageChunk"),An=N("queryCollection"),Rn=q("renameGroup"),Dn=q("deleteGroup"),En=N("getSelectPropertyValues"),Bn=N("setStatusPropertyDefaults"),Fn=N("getNotificationLog"),On=N("getNotificationLogV2"),Zn=N("getNotificationLogPrototype"),Vn=N("getUnvisitedNotificationIds"),Un=N("trackSegmentEvent"),Nn=N("identifySegmentWorkspace"),Ln=N("identifySegmentUser"),jn=N("setNotificationsAsRead"),zn=N("getUserNotifications"),qn=N("setPageNotificationsAsRead"),Hn=N("setNotificationsStatus"),Wn=N("setSpaceNotificationsAsRead"),Kn=N("unsubscribeFromEmails"),Gn=N("leaveBlock"),$n=N("getPublicSpaceData"),Qn=N("loadBlockSubtree"),Yn=N("initializeUserAnalytics"),Xn=N("initializeUserAnalyticsEmptySync"),Jn=N("getSignedFileUrls"),eo=N("checkFilePermission"),to=N("getBillingHistory"),no=q("exportSpace"),oo=q("exportAuditLog"),ro=q("exportDomainClaimableSpaces"),io=q("exportUserAnalytics"),ao=q("exportContentAnalytics"),so=q("exportAdminContentSearch"),lo=N("transferPermissionGroup"),co=N("disableUserAnalytics"),uo=N("unsubscribeFromIntercomEmails"),po=N("getBots"),mo=N("getWebhookSubscriptions"),fo=N("testWebhookConnection"),go=N("getSnapshotsList"),ho=N("getSnapshotContents"),vo=q("restoreSnapshot"),bo=N("activateReferral"),yo=N("setBookmarkMetadata"),_o=N("authWithAsana"),So=N("getConnectedAppsStatus"),wo=L("getCompletion"),ko=N("authWithTrello"),Io=N("authWithSlack"),Co=N("authWithGoogleForDrive"),xo=N("authWithExternalIntegration"),To=N("getGoogleDriveAccounts"),Mo=N("initializeGoogleDriveBlock"),Po=N("refreshGoogleDriveBlock"),Ao=N("getEvernoteNotebooks"),Ro=N("getWebClipperData"),Do=N("addWebClipperURLs"),Eo=N("searchWebClipperPages"),Bo=N("authWithEvernote"),Fo=N("recoverUser"),Oo=N("ping"),Zo=N("recoverSpace"),Vo=N("revokeUserTokens"),Uo=N("exportBlockPreview"),No=N("initializePageTemplate"),Lo=N("finalizeAppTemplate"),jo=N("adminSearchUsers"),zo=N("adminSearchUserAdminToolRoles"),qo=N("adminGetClientExperiments"),Ho=N("adminGetStatsigExperiment"),Wo=N("adminGetStatsigFeatureGate"),Ko=N("adminCheckStatsigSegment"),Go=N("adminUpdateStatsigSegmentIds"),$o=N("adminFindDeletedUser"),Qo=N("adminAllowlistCreditDomain"),Yo=N("searchUnsplashImages"),Xo=N("searchGiphyImages"),Jo=N("getGiphyRandomId"),er=N("postGiphyAnalytics"),tr=N("adminSearchSpaces"),nr=N("adminSearchForUsersInSpaces"),or=N("adminGetDataAccessConsent"),rr=N("adminGetBulkSpaceIdsByDomain"),ir=N("adminGetBulkSpaceIdsByEmail"),ar=N("adminGetBulkUserIdsByEmail"),sr=N("adminSearchBlocks"),lr=N("adminSearchTeams"),cr=N("adminSearchCollections"),dr=N("adminSearchCollectionViews"),ur=N("adminRecoverMfa"),pr=N("adminRemoveSpaceUsersAndTransferContent"),mr=N("adminGetUserBillingInformation"),fr=N("adminBypassEmailReputationChecks"),gr=N("adminSamlConfigForSpace"),hr=N("getSamlConfigForSpace"),vr=N("getEmailDomainsForSpace"),br=N("getManagedUsers"),yr=N("updateUserSuspension"),_r=N("deleteManagedUser"),Sr=N("updateEmailDomainSettings"),wr=N("updateUserProfile"),kr=N("getDataAccessConsentForManagedUser"),Ir=N("setDataAccessConsentForManagedUser"),Cr=N("removeManagedUserFromSpace"),xr=N("getEmailDomainSettings"),Tr=N("logoutManagedUsers"),Mr=N("resetPasswordsForManagedUsers"),Pr=N("getClientExperiments"),Ar=N("getClientExperimentsV2"),Rr=N("adminViewExperiments"),Dr=N("adminUpdateExperiment"),Er=N("adminSetupExperiment"),Br=N("updateSubscriptionToEducationPlan"),Fr=N("adminUpdateSubscription"),Or=N("adminCancelSubscription"),Zr=N("allowEducationEmails"),Vr=N("isEmailEducation"),Ur=N("getPromoCode"),Nr=N("getGenericEmbedBlockData"),Lr=N("isUserDomainJoinable"),jr=N("adminChangeEmail"),zr=N("setPassword"),qr=N("logoutActiveSessions"),Hr=N("createSpace"),Wr=N("adminSetDisableSpacePublicAccess"),Kr=N("adminSetSpaceDomain"),Gr=N("saveTransactions"),$r=q("moveToSpace"),Qr=N("inviteGuestsToSpace"),Yr=N("refreshInviteLink"),Xr=N("adminAddPublicEmailDomains"),Jr=N("adminShowCustomerInvoice"),ei=N("adminSwapUserDomains"),ti=N("adminSwapUserEmails"),ni=N("getUserTasks"),oi=N("getTasks"),ri=N("getTestFlightStatus"),ii=N("getAccessRequests"),ai=N("updateOrganization"),si=N("getUnreadAccessRequestCount"),li=N("getAuthorizedEmailPreferenceCenterLink"),ci=N("requestAccess"),di=N("getDataAccessConsent"),ui=N("setDataAccessConsent"),pi=N("getPageVisitors"),mi=N("recordPageVisit"),fi=N("recordPageExit"),gi=N("spaceAdminRestoreAccess"),hi=N("trackConversionEvent"),vi=N("updateSpaceDomain"),bi=N("updatePublicHomePage"),yi=N("getUserSharedPagesInSpace"),_i=N("getUserSignals"),Si=N("getUserHomePages"),wi=N("getAvailableCountries"),ki=N("invalidateSubscriptionData"),Ii=N("getUserAdminApiLog"),Ci=N("getSpaceAdminApiLog"),xi=N("getBlockAdminApiLog"),Ti=N("getAdminHistory"),Mi=N("reportPage"),Pi=N("adminGetOwnership"),Ai=N("adminGetCurrentUserPermissions"),Ri=N("adminGetRateLimits"),Di=N("adminGetSamlConfig"),Ei=N("adminPrimaryWorkspaceChange"),Bi=N("adminDeleteFileFromS3"),Fi=N("adminDescribeDeleteFileFromS3"),Oi=N("adminGetSpacesForAllowedEmailDomain"),Zi=N("adminResetRateLimits"),Vi=N("annotateRecentIntercomConversation"),Ui=N("adminModifyBlock"),Ni=N("adminRestoreBlock"),Li=N("adminDescribeDeletedBlockPermissions"),ji=N("resolveAddress"),zi=N("getDeveloperBotsAndIntegrations"),qi=N("getIntegrationDomainVerifications"),Hi=N("getIntegrationSecret"),Wi=N("adminBulkAddPromotionCodes"),Ki=N("adminBulkRemoveSpaceGuests"),Gi=N("adminRemoveAllowedEducationEmails"),$i=N("adminBulkApplyPromotionCodes"),Qi=N("adminPartnerStackFixMissingProductKeys"),Yi=N("adminMonetizationTaskRunnerEnqueue"),Xi=N("adminBulkUpgradeEduPlusUser"),Ji=N("calculateTax"),ea=N("checkSpaceDomain"),ta=N("deleteBot"),na=N("deleteIntegration"),oa=N("adminBlockEmailDomain"),ra=N("adminSearchPermanentlyDeletedPages"),ia=N("adminSearchSpaceActivity"),aa=N("adminCopyPageBetweenEnvironments"),sa=N("adminCountWordsInPage"),la=N("getExternalIntegrations"),ca=N("getZendeskTicketConversation"),da=N("getUserSpaceExternalBots"),ua=N("createOauthAuthorizationCode"),pa=N("adminGetPublicPages"),ma=N("adminRestoreDeletedCollectionProperties"),fa=N("adminViewDeletedCollectionProperties"),ga=N("unfurlUrl"),ha=N("aiSourcePicker"),va=N("resubscribeExternalCollection"),ba=N("getExternalCollectionSyncState"),ya=N("getEmailsWithoutAccessToBlock"),_a=N("processShareActionToBlock"),Sa=N("updateExperimentOverride"),wa=N("resetExperimentOverrides"),ka=N("refetchExternalObjectInstanceBlocks"),Ia=N("listExternalCollections"),Ca=N("listExternalObjects"),xa=N("createTeam"),Ta=N("setAdminPrivilegedTeamMembership"),Ma=N("updateTeamMembers"),Pa=N("getTeams"),Aa=N("getAllTeamsInSpaceForAdmin"),Ra=N("getPrivatePageInfo"),Da=N("markDiscussionNotificationsRead"),Ea=N("getIntegrationDataForGallery"),Ba=N("getIntegrationIdsForGallery"),Fa=N("recordCookieConsent"),Oa=N("adminGetIntegrationData"),Za=N("adminUpdateIntegrationData"),Va=N("adminGetSlackIntegrationData"),Ua=N("adminGetSyncedDatabaseData"),Na=N("adminJoinSpacesForOauthRedirect"),La=N("adminForceResyncExternalObjects"),ja=N("getRecoverableSpaceUserContent"),za=N("transferSpaceUserContent"),qa=N("getRecentlyRemovedUsers"),Ha=N("recoverUserContentInSpace"),Wa=N("adminCreateMarketingRoute"),Ka=N("adminBanUser"),Ga=N("adminBulkBanUsers"),$a=N("adminSearchAuditLog"),Qa=N("adminIsSpaceDomainClaimEligible"),Ya=N("adminGetDomainClaimEligibleSpaces"),Xa=N("adminGetDomainManagementSettings"),Ja=N("adminClaimAndUpgradeForSalesAssisted"),es=N("adminDelayClaimSpaceDeletion"),ts=N("adminRemoveChildFromExternalCollection"),ns=N("adminCancelSpaceConsolidation"),os=N("adminRunSpaceConsolidation"),rs=N("deleteDomainVerificationCode"),is=N("verifyDomain"),as=N("createDomainVerificationCode"),ss=N("getDomainVerificationCodesForSpace"),ls=N("updateWorkspaceCreationForEmailDomains"),cs=N("validateUserCanCreateWorkspace"),ds=N("setSamlConfig"),us=N("getSpacesCreatedByUserWithDomains"),ps=N("initiateWorkspaceTransfer"),ms=N("getCostForSpaceUpgrade"),fs=N("claimAndUpgradeSpace"),gs=N("requestClaimAndUpgrade"),hs=N("transferWorkspaceToUser"),vs=N("deleteSpaceForDomain"),bs=N("cancelSpaceDeletionForDomain"),ys=N("adminDowngradeFraudSubscription"),_s=N("initiateMultipartUpload"),Ss=N("completeMultipartUpload"),ws=N("getTypedDatabases"),ks=N("getCollectionViewBlocksByAppId"),Is=N("getSprintBoardViewBlocks"),Cs=N("getPageAnalytics"),xs=N("getCustomerOffer"),Ts=N("getCustomerOfferEligibility"),Ms=N("applyCustomerOffer"),Ps=N("getExternalIntegrationAccessToken"),As=N("sendVerifyTransferEmail"),Rs=N("getDailyUsersAnalytics"),Ds=N("getUserEngagementAnalytics"),Es=N("getContentEngagementAnalytics"),Bs=N("loadWorkspaceAnalyticsUsers"),Fs=N("loadContentAnalytics"),Os=N("loadSearchAnalytics"),Zs=N("getVerifiedEmailDomain"),Vs=N("getExternalNotificationChannels"),Us=N("adminContentSearch"),Ns=N("searchVectors"),Ls=N("getInferenceTestExamples"),js=N("isEligibleForGuestMembershipRequest"),zs=N("setSeenGuestMembershipRequests"),qs=N("getAboutNotionDevelopers"),Hs=N("loadContacts"),Ws=N("registerDesktopApp"),Ks=N("getDesktopAppRegistration"),Gs=N("getPublicApiObject"),$s=N("authCreateTotp"),Qs=N("authVerifyTotpLogin"),Ys=N("authVerifyTotpEnroll"),Xs=N("authCreateBackupCodes"),Js=N("authVerifyBackupCodesLogin"),el=N("authVerifyPassword"),tl=N("setRecordKey"),nl=N("isRecordKeyAvailable"),ol=N("getIdFromUniqueId"),rl=N("suggestRecordKey"),il=N("getInAppCategoriesAndTemplates"),al=N("adminUpdateAddOnSubscription"),sl=N("adminReleaseSubscriptionSchedule"),ll=N("getAIUsageEligibility"),cl=L("getCompletionForProperty"),dl=L("streamCascadeInference"),ul=N("getCompletionForSelectOption"),pl=N("getAiSuggestedProperties"),ml=N("getSuggestedPageQna"),fl=N("retrieveFeedbackRecord"),gl=N("adminUpdateNotionAIAvailabilityForSpace"),hl=N("adminGetSpaceMembershipUpdates"),vl=N("adminBulkCreateTimedTrials"),bl=N("getGeoIpLocation"),yl=N("getTeamAccessRequestMetadata"),_l=N("stripeAdvanceTestClock"),Sl=N("stripeGetTestClock"),wl=N("adminOptOutNotionAIDataSharing"),kl=N("getTransitivePageRelations"),Il=N("getActiveExportTasks"),Cl=N("adminExplainPaymentStatus"),xl=N("adminGetBulkIds"),Tl=N("adminUpdatePaymentStatus"),Ml=N("getTemplateSearchResults"),Pl=N("getTemplates"),Al=N("getTemplateCreator"),Rl=N("submitTemplate"),Dl=N("submitTemplateCreator"),El=N("validateTemplate"),Bl=N("validateTemplateCreatorHandle"),Fl=N("validateTemplateDraftSlug"),Ol=N("submitTemplateDraft"),Zl=N("deleteTemplate"),Vl=N("deleteTemplateDraft"),Ul=N("getTemplateDrafts"),Nl=N("updatePinnedTemplates"),Ll=N("getSpaceMembershipUpdates"),jl=N("getUserContractionData"),zl=N("testSetupWorkspace"),ql=N("testCreatePage"),Hl=N("testDeleteRecord"),Wl=N("getPageAssistantPreferences"),Kl=N("setPageAssistantPreferences"),Gl=N("adminRestoreDeletedGuestPermissions"),$l=N("adminDescribeRestoreDeletedGuestPermissions"),Ql=N("adminAddLinkPreviewToSpace"),Yl=N("updateDisableGuestsOnSpace"),Xl=N("submitEducationGroupApplication"),Jl=N("getUniversitiesAndDomains"),ec=N("exportSpaceMembers"),tc=N("exportSpaceGuests"),nc=N("publishAiSession"),oc=N("getPublishedPagesForUser"),rc=N("adminIsWorkspaceInQnA"),ic=N("adminMergeUsers"),ac=N("adminRecoverUserContentInSpace"),sc=N("resolveAccessRequest"),lc=N("getExternalOrgData"),cc=N("addUserToWaitlist"),dc=N("adminGetWorkspaceWebhookSubscriptions"),uc=N("adminSearchBots"),pc=N("adminGetAutomationsForRecordId"),mc=N("adminBulkAddEduUniversitiesAndDomains"),fc=N("getSpacesInOrganization"),gc=N("enqueueScanContentTask"),hc=N("getAiWaitlistRequestsForSpace"),vc=N("getHomeEnabledSpaceViews"),bc=N("adminUpdateNotionCalendarAvailableForSpace"),yc=new i.Z({performRequests:async e=>{const{environment:t}=e[0],n=e.map((e=>e.args)),o=await Mn(t,{requests:n});if("failed"===o.type)throw o.error;return[]},batchSize:50,maxWorkers:2,requestDelayMs:20,requestTimeoutMs:10*v.C0});async function _c(e,t){return await yc.enqueue({environment:e,args:t})}const Sc=new i.Z({performRequests:async e=>{const t=new Array(e.length),n=e.map(((e,t)=>({environment:e.environment,request:e.args,index:t}))),o=u.vM(n,(e=>e.request.userId));for(const[r,i]of Object.entries(o)){const e=i[0].environment,n=[];for(const{request:t}of i){const{pointer:e,version:o}=t;n.push({pointer:e,version:o})}const o=await Cn(e,{requests:n},r);if("failed"===o.type)throw o.error;const a=m.PF.create(o.data.recordMap);T.Z.addFromRecordMapWithRole(a),T.Z.isEmpty()||B.dY({environment:e});for(const{request:r,index:s}of i)if(r.pointer){const e=a.getValue(r.pointer),n=a.getRole(r.pointer);n&&(t[s]={value:e,role:n})}}return t},batchSize:500,maxWorkers:2,requestDelayMs:20,requestTimeoutMs:30*v.C0});async function wc(e,t){if(t.pointer&&(0,f.Ok)(t.pointer))try{const n=await Sc.enqueue({environment:e,args:t});return n||-1!==t.version?n:{value:void 0,role:"editor"}}catch(n){}}const kc=e=>[e.url,e.downloadName,e.download].filter(Boolean).join(":");const Ic=new class{constructor(){this.lru=new(r())({max:1e3,maxAge:v.U6})}set(e,t){this.lru.set(kc(e),t)}get(e){return this.lru.get(kc(e))}},Cc=new i.Z({performRequests:async e=>{const t=e.map((e=>{let{url:t}=e;return t})),n=await Jn(e[0].environment,{urls:t});if("failed"===n.type)throw n.error;const{signedUrls:o}=n.data;return t.forEach(((e,t)=>{const n=o[t];Ic.set(e,n)})),o},batchSize:500,maxWorkers:1});async function xc(e,t,n){const o=Ic.get(t);let r;return r=o||await Cc.enqueue({environment:e,url:t}),r&&(0,s.x$)(r)&&n&&(r=(0,h.NV)({httpUrl:r,protocol:b.default.protocol,includePort:!0})),r}const Tc=new a.Z},35793:(e,t,n)=>{n.d(t,{Bs:()=>me,_S:()=>ge,qY:()=>_e,mc:()=>pe,KJ:()=>he,Uz:()=>fe});var o=n(50112),r=n(15145),i=n(82813),a=n(7406),s=n(68626),l=n(97213),c=n(4615),d=n(99405),u=n(21202),p=n(13493),m=n(65311),f=n(19889),g=n(66079),h=n(28182),v=n(9852),b=n(54153),y=n(64002),_=n(63143),S=n(25320),w=n(17707),k=n(97978),I=n(19124),C=n(84210),x=n(98165),T=n(18514),M=n(51),P=n(80444),A=n(81258),R=n(69327),D=n(64970),E=n(93220),B=n(72014),F=n(89523),O=n(79797),Z=n(32470),V=n(87956),U=n(29026),N=n(34583),L=n(28517),j=(n(21703),n(97880)),z=n(80736),q=n(54642);var H=n(32441),W=n(98688),K=n(50950),G=n(47307),$=n(57400),Q=n(94273),Y=n(97977),X=n(98958),J=n(17659),ee=n(31304),te=n(40277),ne=n(32953),oe=n(8055),re=n(87531),ie=n(29974),ae=n(82530),se=n(12170),le=n(70782),ce=n(12321),de=n(37181),ue=n(65452);function pe(e){P.default.setState(P.default.getInitialState());const{id:t}=e.currentUser;(!P.default.state.currentUserStore||t&&t!==P.default.state.currentUserStore.id)&&(t?(ce.j(e,t),Q.Bk(e,t),he(e,t)):(P.default.setState({...P.default.state,initialized:!0}),K.dd(e)))}function me(){const{currentSpaceStore:e}=P.default.getState();return e?e.id:void 0}async function fe(e){const{nextRoute:t,currentRoute:n,environment:f,query:g}=e,h=P.default.state.mainEditorCurrentBlockStore,b=P.default.state.currentCollectionViewStore,_=f.currentUser.id,x=e=>{P.default.state.lastUpdater===x&&(f.device.isMobileNative&&e.currentSpaceStore&&s.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"AppStore setting space with update in updateCurrentRoute: ",spaceId:e.currentSpaceStore.id}}),P.default.setState({...P.default.state,...e}))};P.default.setState({...P.default.state,lastUpdater:x});const T=e=>{P.default.state.lastUpdater===x&&M.Z.setState({publicPageData:e})};if("page"===t.name&&t.queryId&&V.Z.setState({queryId:t.queryId,pageId:t.blockId,timeEntered:new Date}),"page"===t.name||"space"===t.name||"nativeTab"===t.name||"quickSearch"===t.name||"chat"===t.name||"workspaceSetup"===t.name){let e;Q.nr(t,_);const p=async()=>{e||(e=te.I6({environment:f,request:{type:"block-space",...t}}));const[n]=await Promise.all([e.next(),P.default.waitUntil((()=>P.default.state.initialized))]),o=n.value;return T(o),o},b=(0,v.QG)();if((0,I.AC)(f),"page"===t.name&&(!h||h.id!==t.blockId||n&&"page"===n.name&&n.blockId!==t.blockId||h.userId!==_)){ne.Pg(f),ne.LU(f),N.$B(),ne.rM(f);const{blockId:e}=t,a=new O.G(f,{table:u.iU,id:e}),d=new E.Z;x({mainEditorCurrentBlockStore:a,currentLoadingContainerStore:d}),h||await ge({environment:f,store:a});const v=await p(),{currentUserSettingsStore:I}=P.default.state;if(ye({publicPageData:v}))return void function(e){const{store:t,environment:n}=e,o=(0,C.ZP)({store:t,preferPublicLink:!1,pageVisitSource:void 0});oe.c4({environment:n,url:o})}({store:a,environment:f});const{presenceStore:T,currentUserRootStore:M}=P.default.state;ee.E(T,f,B.$g,h),S.UX(f,{block:a,fromPageRefresh:b,pageVisitStore:P.default.state.pageVisitStore,timestamp:Date.now()}),w.Y0(a.id);const A=new F.Z;x({presenceStore:A});const D=B.$g.getCurrentPageVisitId();if(B.$g.initializeNewPageVisitId(),ee._({userId:_,rootStore:a,presenceStore:A,environment:f,pageVisitIdStore:B.$g}),M){if("root"===(null==n?void 0:n.name)){if(M.getSpaceViewStores().map((e=>e.getSpaceId())).indexOf(v.spaceId)<0){if(I)return f.device.isMobileNative&&s.log({level:"warning",from:"loginActions",type:"setLoggedInUserId",data:{message:"SpaceDebug: navigateToFirstSpace because updateCurrentRoute is root and page is not in current spaceView"}}),void(await ie.L5({environment:f,userRootStore:M,userSettingsStore:I,pageVisitSource:r.tY.BackForward}));if(_)return void(await Y.logoutSingleAccount({environment:f,userId:_,logoutOrigin:l.F.NoAvailableSpaces}))}}if(v.spaceId&&(v.canJoinSpace||v.userHasExplicitAccess)){const e=await ie.j({environment:f,userRootStore:M,spaceId:v.spaceId,navigate:!1,analyticsFrom:"redirect",userSettingsStore:I});f.device.isMobileNative&&s.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"updateCurrentRoute updating space because the route is a page with spaceId",spaceId:v.spaceId}}),x({currentSpaceViewStore:e.spaceViewStore,currentSpaceStore:e.spaceViewStore.getSpaceStore()})}else if(!v.spaceId&&P.default.state.currentSpaceStore){const e=await ie.j({environment:f,userRootStore:M,spaceId:P.default.state.currentSpaceStore.id,navigate:!1,analyticsFrom:"redirect",userSettingsStore:I});var H;if(f.device.isMobileNative)s.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"updateCurrentRoute updating space because of joinSpaceResult of current space",spaceId:null===(H=e.spaceViewStore)||void 0===H?void 0:H.getSpaceId()}});x({currentSpaceViewStore:e.spaceViewStore,currentSpaceStore:e.spaceViewStore.getSpaceStore()})}}v.spaceId&&_&&(ue.h({environment:f,spaceId:v.spaceId,userId:_}),L.I({environment:f,spaceId:v.spaceId,userId:_}));const{currentSpaceStore:Z}=P.default.state;Z?(N.OR({environment:f,spaceId:Z.id}).then((async()=>{await a.load(),be(f,a,g,B.$g,D)})),k.Jq(f)):v&&v.spaceId&&(await a.load(),be(f,a,g,B.$g,D)),async function(e,t,n){const a=(0,y.Qc)(t).query,s=a[o.gS];if(parseInt(a[r.$X])===r.tY.Email&&(s.includes("email_digest")||s.includes("email_push"))&&a[r.Qs]&&n){const t=(0,c.wr)(a[r.Qs]),o=O.Xo.createChildStore(n,{table:m.uX,id:t});await o.load();const s=o.getModel();if(!s)return;if((0,i.e)((0,k.mc)(e),{alreadyRead:s.getRead(),notificationId:t,activityId:s.getActivityId(),from:"email"}),!s.getRead()){const t={id:s.id,space_id:s.getSpaceId(),read:s.getRead()};ae.createAndCommit({userAction:"appActions.setNotificationAsReadFromEmail",environment:e,perform:e=>J.$h({notification:t,rootStore:n,transaction:e,read:!0})})}}}(f,g,Z);const V=(null==Z?void 0:Z.id)||v.spaceId;V&&(se.pt({environment:f,spaceId:V,force:!1}),W.L({environment:f,spaceId:V,force:!1})),V&&async function(e){const{environment:t,spaceId:n,force:o}=e;await P.default.waitUntilRendered();const r=z.Z.state,i=t.currentUser.id,{currentSpaceStore:a}=P.default.state;if(i&&a&&(!r.loaded&&!r.loading||r.loaded&&n!==r.spaceId||r.loaded&&i!==r.userId||o)){z.Z.setState({...z.Z.state,loading:!0});const e=await q.getAiWaitlistRequestsForSpace(t,{spaceId:n});if("success"!==e.type)throw new Error("Request failed.");const{aiWaitlistIds:o}=e.data,r=a.getRole()??"none";(0,j.Of)(o)?z.Z.setState({loaded:!0,loading:!1,spaceId:n,userId:i,isOnWaitlist:!0,spaceRole:r,aiWaitlistIds:o}):z.Z.setState({loaded:!0,loading:!1,spaceId:n,userId:i,isOnWaitlist:!1,spaceRole:r,aiWaitlistIds:void 0})}}({environment:f,spaceId:V,force:!1}),V&&_&&(R.Z.isInitialized||R.Z.reinitializeState(f,_,V))}else if("space"===t.name){const e=await p();if(e.publicHomePage){const t=new O.G(f,{table:u.iU,id:e.publicHomePage}),n=new E.Z;x({mainEditorCurrentBlockStore:t,currentLoadingContainerStore:n})}else if(x({mainEditorCurrentBlockStore:void 0,currentLoadingContainerStore:void 0}),ye({publicPageData:e}))return void _e({spaceDomain:e.spaceDomain,environment:f})}else if("nativeTab"===t.name||"quickSearch"===t.name||"chat"===t.name){ne.Pg(f),ne.LU(f),N.$B(),ne.rM(f),await P.default.waitUntil((()=>P.default.state.initialized));const e="spaceId"in t?t.spaceId:void 0;if((!P.default.state.currentSpaceViewStore||!P.default.state.currentSpaceStore||e&&P.default.state.currentSpaceStore.id!==e)&&P.default.state.currentUserRootStore){const n=P.default.state.currentUserRootStore.getSpaceViewStores(),o=e?n.find((t=>{var n;return(null===(n=t.getSpaceId())||void 0===n?void 0:n.replaceAll("-",""))===(null==e?void 0:e.replaceAll("-",""))})):n[0],r=null==o?void 0:o.getSpaceStore();if(o&&r){var K,X;if(f.device.isMobileNative)s.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:`updateCurrentRoute updating space because it's native tab and current space store id (${null===(K=P.default.state.currentSpaceStore)||void 0===K?void 0:K.id}, spaceView: ${null===(X=P.default.state.currentSpaceViewStore)||void 0===X?void 0:X.id}) doesn't match nextRoute space id`,spaceId:e}});x({currentSpaceStore:r,currentSpaceViewStore:o});const n="nativeTab"===t.name&&"search"===t.tab&&_&&!1,i="quickSearch"===t.name&&_;(n||i)&&R.Z.reinitializeState(f,_,r.id)}}"chat"===t.name&&x({mainEditorCurrentBlockStore:void 0,currentCollectionViewStore:void 0})}else if((0,d.wO)(t)&&(ne.Pg(f),ne.LU(f),N.$B(),ne.rM(f),await P.default.waitUntil((()=>P.default.state.initialized)),t.spaceId&&P.default.state.currentUserRootStore)){const e=P.default.state.currentUserRootStore.getSpaceViewStores().find((e=>e.getSpaceId()===t.spaceId)),n=null==e?void 0:e.getSpaceStore();e&&n&&(f.device.isMobileNative&&s.log({level:"info",from:"appActions",type:"SpaceSwitchingDebug",data:{message:"updateCurrentRoute updating space because routeWithoutSpecificBlock and current nextRoute space id is",spaceId:t.spaceId}}),x({currentSpaceStore:n,currentSpaceViewStore:e,mainEditorCurrentBlockStore:void 0}))}if("searchQuery"in t||"searchRequest"in t)if(t.searchQuery)re.UT({environment:f,analyticsFrom:"query-args",renderAsPage:!1}),U.ZP.setState({...U.ZP.state,query:{...U.ZP.state.query,text:t.searchQuery}});else if(t.searchRequest)try{const e=JSON.parse(t.searchRequest),{text:n,sort:o,filters:r}=e;g&&U.ZP.setState({...U.ZP.state,query:{text:n,sort:o,filters:r}}),Z.ZP.setState({...Z.ZP.state,showDebugInfo:!0,debug:"everything"})}catch(de){G.deprecatedShowErrorMessage("Invalid json in searchRequest param"),s.log({level:"error",from:"appActions",type:"JSONParseError",error:{miscDataString:(0,a.tg)(de).message}})}if(e)for await(const t of e)T(t);$.Yh(f),(0,v.um)(!1)}const le=b?b.id:void 0;if("page"===t.name&&le!==t.collectionViewId){const e=t.collectionViewId;x({currentCollectionViewStore:e?new O.Xr(f,{table:p.n,id:e}):void 0})}const ce=(0,y.Qc)(g).query[r.RL];Boolean(ce)&&(D.m.setState(!0),A.Z.setState({open:!0}))}async function ge(e){const{environment:t,store:n}=e,o=await async function(e){const{environment:t,blockId:n}=e,{currentUser:o}=t,r=(0,_.jj)([...o.id?[o.id]:[],...o.loggedInUserIds]);for(const i of r){const e=new O.G(t,{table:u.iU,id:n},{userId:i});if(await e.load(),e.isDefined())return o.id===i?void 0:i}}({environment:t,blockId:n.id});o&&await le.f({newCurrentUserId:o,environment:t,store:n})}async function he(e,t){const n=new O.U6(e,{table:f.KJ,id:t},{userId:t}),o=new O.vO(e,{table:h.Sr,id:t},{userId:t});o.addListener(ve);const r=new O.r9(e,{table:g.dx,id:t},{userId:t});X.registerPushNotifications(e),P.default.setState({...P.default.state,currentUserStore:n,currentUserSettingsStore:o,currentUserRootStore:r,initialized:!1}),await ce.w(),P.default.setState({...P.default.state,initialized:!0}),de.fG(e),K.oG(e)}function ve(e){const t=e.getSettingsStore().getKeyStore("preferred_locale").getValue();t||b.Z.set("preferredLocale",t)}function be(e,t,n,o,r){var i,a;H.PB(e,{query:n,page_id:t.id,is_peek:!1,peek_mode:void 0,type:"collection"===t.getParentTable()?"database_page":"page",collection_id:t.getAssociatedCollectionId()??(null===(i=t.getCollectionViewCollectionStore())||void 0===i?void 0:i.id),team_id:null===(a=(0,x.VP)(t))||void 0===a?void 0:a.id,page_visit_id:o.getCurrentPageVisitId(),previous_page_visit_id:r})}function ye(e){const{publicPageData:t}=e;return!(!(0,T.Sr)()||"none"!==t.publicAccessRole||!t.spaceName)}function _e(e){const{spaceDomain:t,environment:n}=e,o=(0,T.Rs)(t);oe.c4({environment:n,url:o,redirect:!0})}},2449:(e,t,n)=>{n.d(t,{D$:()=>g,M0:()=>p,W$:()=>v,ac:()=>h,cM:()=>m,hC:()=>u,uG:()=>b});n(21703);var o=n(68626),r=n(9852),i=n(54153),a=n(63143),s=n(11342),l=n(95477),c=n(53730),d=n(47839);function u(e){var t;const{environment:n,url:i,version:a}=e,{AppUpdateStore:s,device:l}=n;l.isElectron&&i.startsWith("https:")?o.log({level:"error",from:"appUpdateActions",type:"installAppJsUpdate",error:{message:"Attempting to refresh app js on desktop for an https url",stack:(new Error).stack},data:{url:i}}):(s.setState({electronUpdate:s.state.electronUpdate,appUpdate:void 0}),a&&g(a),p(a)||(n.mobileNative&&n.mobileNative.showSplashscreen(),(0,r.um)(!0),null!==(t=d.electronApi)&&void 0!==t&&t.installAppJsUpdate?d.electronApi.installAppJsUpdate(i):i!==window.location.href?window.location.href=i:window.location.reload()))}function p(e){return(0,s.isEqualVersion)(e,b())}function m(e,t){if(!t)return!1;if("ready"!==t.state)return!1;if(c.transactionQueue.hasTasks())return!1;if(!e.currentUser.isLoggedIn())return!1;if(t.type===s.UpdateType.Silent){if(e.device.isMobileNative)return!1;const t=v(),n=168;if(t&&(Date.now()-t)/a.U6<n)return!1;o.log({level:"info",from:"appUpdateActions",type:"shouldUpdateOnNavigate",data:{lastKnownUpdateTime:t}})}return!0}const f="lastKnownAppJsVersion";function g(e){i.Z.set(f,{version:e,time:Date.now()})}function h(){const e=i.Z.get(f);if(e&&e.version)return e.version;{const e=(0,s.parseVersion)(l.default.version);return i.Z.set(f,{version:e,time:Date.now()}),e}}function v(){const e=i.Z.get(f);if(e&&e.time)return e.time}function b(){return(0,s.parseVersion)(l.default.version)}},35253:(e,t,n)=>{n.d(t,{Bw:()=>i,Js:()=>s,qL:()=>a});var o=n(97880),r=n(22294);const i=e=>{const{id:t,styleKey:n,contentKey:i,removeTimeout:s,bannerStore:l,blockStore:c,context:d,disabled:u}=e,{banners:p}=l.state;if(!p.find((e=>e.id===t))){let m;switch(i){case"template_in_page":case"template_in_button":m={id:t,contentKey:i,styleKey:n,blockStore:c,context:d,disabled:u};break;case"space_content_duplication":case"deleted_or_moved_page":case"importing_evernote":case"asana_importer_banner":case"site":m={id:t,contentKey:i,styleKey:n,blockStore:c};break;case"over_free_block_limit":case"editing_page":case"subscription_trial_add_payment_method":case"upload_limit_exceeded":case"admin_mode":case"subscription_payment_status":case"minor_app_update":case"mobile_platform_unsupported":case"page_in_archived_team":case"crdt_page":case"test_clock":m={id:t,contentKey:i,styleKey:n};break;default:(0,o.t1)(i)}const f=e.prepend?[m,...p]:[...p,m];l.setState({banners:f}),r.Z.setKeyboardMode(!1),s&&setTimeout((()=>{a({bannerStore:l,id:t})}),s)}},a=e=>{const{id:t,bannerStore:n}=e,{banners:o}=n.state,r=o.filter((e=>e.id!==t));r.length!==o.length&&n.setState({banners:r})},s=e=>{e.bannerStore.state.banners.length>0&&e.bannerStore.setState({banners:[]})}},54564:(e,t,n)=>{n.d(t,{Ib:()=>w,LZ:()=>k,Xv:()=>I});var o=n(1302),r=n(72126),i=n(29477),a=n(33709),s=n(23867),l=n(17707),c=n(34047),d=n(65598),u=n(58202),p=n(46351),m=n(74948),f=n(24646),g=n(36391),h=n(24229),v=n(79797),b=n(85344),y=n(24677),_=n(98104);function S(e,t){const n=p.Z.find((e=>e.getStore().id===t));n&&(y.ZH(e),_.NX({store:n.getInputStore().state.textStore}))}async function w(e){var t;const{environment:n,blockStore:p,analyticsFrom:w,discussionIds:k,shouldFocusDiscussion:I,recursivelyLoadAllDiscussions:C}=e,x=(null==k?void 0:k.map((e=>v.t1.createChildStore(p,{table:a.qF,id:e,spaceId:(0,s.C)(p.pointer.spaceId)}))))||d.al(p,{recursivelyLoadAllDiscussions:C});let{rect:T}=e;const{resolved:M,unresolved:P}=d.bB(x),A=(0,c.uC)(P.length>0?P:M)||[],R=null==A||null===(t=A[0])||void 0===t?void 0:t.id,{device:D}=n;D.isMobile&&"updates_sidebar"!==w&&(y.ZH(n),D.isIOS&&_.sD()),l.AM(A.map((e=>e.id))),await o.default.afterNextFlush();const E=(0,f.Sx)(n);if(p.isNavigableBlock()){if(R){"PageDetailsStore"in n&&n.PageDetailsStore.setToggleState({type:"discussion",id:p.id,environment:n},!0);const e=v.t1.createChildStore(p,{table:a.qF,id:R,spaceId:(0,s.C)(p.pointer.spaceId)});if((E||!E&&I)&&l.T4(R),e.getResolved())if((0,f.Sx)(n))m.setUpdateSidebarCommentsMode(g.F7.Resolved);else{const e=u.R.findBlockFromStoreWithMethod(p,"openResolvedDiscussionPopup");e&&(e.openResolvedDiscussionPopup(),await o.default.afterNextFlush(),l.T4(R))}b.ZW(n,{from:w,discussion_id:e.id})}if(!E)return}if(!T&&!E&&"margin_comments"!==w){const e=u.R.getRect(p);if(!e)return;const t=e.width,n=e.height,o=e.right-t;T=new DOMRect(o,e.top,t,n)}let B=h.u.Open;if(R){const e=v.t1.createChildStore(p,{table:a.qF,id:R,spaceId:(0,s.C)(p.pointer.spaceId)});e.getResolved()&&(B=h.u.Resolved),e.getResolved()||(m.setUpdateSidebarCommentsMode(g.F7.Unresolved),m.setUpdateSidebarTab(g.gY.Comments))}else B=h.u.Resolved;if(D.isMobile&&"updates_sidebar"!==w&&(y.ZH(n),D.isIOS&&_.sD()),h.Z.setState({open:!0,rect:T,tab:B,blockStore:p,discussionIds:x.map((e=>e.id)),recursivelyLoadAllDiscussions:C}),b.ZW(n,{from:w,discussion_id:R}),I)if(R){if(await i.Vs(10),await o.default.afterNextFlush(),l.T4(R),n.device.isMobile)return;(function(e){var t;const{blockStore:n,discussionIds:o}=e;return h.Z.state.open&&h.Z.state.blockStore.id===n.id&&r.Xy(null===(t=h.Z.state)||void 0===t?void 0:t.discussionIds,o)})(e)||S(n,R)}else{if(n.device.isMobile)return;P.length>0&&(await i.Vs(10),await o.default.afterNextFlush(),S(n,P[0].id))}}function k(){const e=h.Z.state;e.open&&h.Z.setState({open:!1,rect:e.rect})}function I(){const e=h.Z.state;if(e.open&&e.tab===h.u.Open){0===d.vV(e.blockStore,{recursivelyLoadAllDiscussions:!1}).length&&k()}}},6404:(e,t,n)=>{n.d(t,{$Z:()=>p,Qn:()=>u,xv:()=>m});var o=n(75079),r=n(95802),i=n(24646),a=n(8949),s=n(17903),l=n(83212),c=n(50628),d=n(17224);function u(e){const{environment:t,left:n,top:o,actionSectionGroupKey:r,showInput:i,stores:c,analyticsFrom:d,optionalAnalyticsProperties:u,pageAnnotationToken:p}=e,m=new DOMRect(n,o,1,1);a.Z.setState({isActive:!0,inputValue:"",actionSectionGroupKey:r,stores:c,frameScrollTop:s.Z.state.scrollTop,originBlockRect:m,showInput:i,analyticsFrom:d,publicEditMode:c[0]?l.Z.getMode(t,c[0]):void 0,collectionContextStore:null==u?void 0:u.collectionContextStore,clickedPageAnnotation:p}),f(t,{from:d,block_type:c[0]&&c[0].getType(),optionalAnalyticsProperties:u})}const p=function(e){const{environment:t,analyticsFrom:n,actionSectionGroupKey:o,stores:i,showInput:d}=e,u=r.C.findSelectableFromStore(i[0]);if(!u)return;const p=c.Z.state.selectableRectMap.get(u);p&&a.Z.setState({isActive:!0,inputValue:"",actionSectionGroupKey:o,stores:i,frameScrollTop:s.Z.state.scrollTop,originBlockRect:p,showInput:void 0===d||d,analyticsFrom:n,publicEditMode:i[0]?l.Z.getMode(t,i[0]):void 0}),t&&f(t,{from:n,block_type:i[0]&&i[0].getType()})},m=function(){a.Z.setState({isActive:!1})};function f(e,t){const{optionalAnalyticsProperties:n,...r}=t,{teamStore:a,collectionContextStore:s,...l}=t.optionalAnalyticsProperties||{},c=(0,o.Pn)(s)||{};d.YP(e,"open_block_menu",{store:a,...(0,i.UF)({environment:e}),...c,...r,...l})}},79554:(e,t,n)=>{n.d(t,{Dq:()=>R,H8:()=>D,RH:()=>M,_x:()=>C,kE:()=>I,ry:()=>E,wK:()=>P,xv:()=>x});n(21703);var o=n(15145),r=n(41432),i=n(1800),a=n(72126),s=n(606),l=n(21202),c=n(70203),d=n(97880),u=n(95477),p=n(28020),m=n(95802),f=n(61207),g=n(79797),h=n(52229),v=n(19785),b=n(9953),y=n(42858),_=n(24677),S=n(64964),w=n(993),k=n(82530);function I(e){const{blocks:t,copiedStores:n,pageSource:o}=e,r=a.Z$(t);if(!r)return;const i=m.C.getRectFromStore(r);i&&f.Z.setState({open:!0,type:"blocks",blocks:t,rect:i,copiedStores:n,pageSource:o})}function C(e){const{blocks:t,copiedLinks:n,rootStore:o}=e;if(!t.every(T))return!1;if(n.some((e=>e.blockId===o.id)))return!1;const r=a.Z$(t);if(!r)return!1;const i=m.C.getRectFromStore(r);return!!i&&(f.Z.setState({open:!0,type:"links",blocks:t,rect:i,copiedLinks:n}),!0)}function x(){f.Z.setState({open:!1})}function T(e){return!(e.isType(r.Ti.copyIndicator)||e.isTransclusionType()||e.isInsideCollection())}function M(e){const{blocks:t,pageSource:n,wasContiguousSelection:o,action:i,rootStore:a,copiedStores:l}=e;return"copy"===i&&o&&!(0,s.qo)(n,a.pointer)&&(P(e)||D({currentSpaceId:a.getSpaceId(),...e}))&&t.every(T)&&!l.every((e=>e.getType()===r.Ti.externalObjectInstance))}function P(e){const{blocks:t}=e;return 1===t.length}function A(e){const{transaction:t,blockUrl:n,spaceId:o,useCrdt:i,environment:a}=e,s=b.j4({environment:a,type:r.Ti.text,inMemoryRecordCache:a.defaultRecordCache.inMemoryRecordCache,transaction:t,spaceId:o,useCrdt:i}),l=[(0,c.V3y)(n,[(0,c.edl)(n)])];return w.sO({environment:a,store:s.getBlockTitleStore(),value:l,transaction:t}),s}async function R(e){const{environment:t,blocks:n,source:r}=e,s=a.Ps(n);if(!s)return;const c=s.getParentBlockStore();if(!c)return;const p=s.getContentStore();let m;await k.createAndCommitAsync({environment:t,userAction:"blockPasteMenuActions.acceptLinkToPage",waitForServerCommit:!0,perform:async e=>{if("blocks"===r.type){const{copiedStores:n,pageSource:a}=r,d=s,f=n[0];if(!d||!f)return;const v=g.G.createChildStore(p,{table:l.iU,id:f.id});if(v.isNavigableBlock())await v.load(),m=[h.k({environment:t,parentBlock:c,targetStore:v,transaction:e})];else{const n=(0,i.Z)({pageId:a.id,scrollToBlockId:v.id,baseUrl:u.default.domainBaseUrl,pageVisitSource:o.tY.LinkInPage});m=[A({blockUrl:n,spaceId:s.getSpaceId(),useCrdt:s.useCrdt(),environment:t,transaction:e})]}}else if("links"===r.type){const{copiedLinks:a}=r;if(a.length!==n.length)return;m=await Promise.all(a.map((async n=>{const r=n.scrollToBlockId||n.peekViewBlockId||n.blockId,a=g.G.createChildStore(p,{table:l.iU,id:r});if(await a.load(),a.isNavigableBlock())return h.k({environment:t,parentBlock:c,targetStore:a,transaction:e});{const r=n.peekViewBlockId||n.blockId,c=g.G.createChildStore(p,{table:l.iU,id:r});await c.load();return A({blockUrl:(0,i.Z)({pageId:r,pageModel:c.getModel(),scrollToBlockId:a.id,baseUrl:u.default.domainBaseUrl,pageVisitSource:o.tY.LinkInPage}),spaceId:s.getSpaceId(),useCrdt:s.useCrdt(),environment:t,transaction:e})}})))}else(0,d.t1)(r);const a=y.is({environment:t,blocks:m,selection:n,replaceEmptyTextBlock:!0,transaction:e});y.Cl({environment:t,blocks:n,transaction:e}),_.Z5({environment:t,stores:a}),x()}})}function D(e){const{currentSpaceId:t,blocks:n,copiedStores:o}=e;return n.length>0&&!o.some((e=>e.isInsideCollection()))&&o.every((e=>e.canEdit()))&&o.every((e=>e.getSpaceId()===t))&&o.every((e=>e.useCrdt()===n[0].useCrdt()))}async function E(e){const{environment:t,blocks:n,copiedBlockIds:o}=e,i=await Promise.all(o.map((async e=>{const t=g.G.createChildStore(n[0],{table:l.iU,id:e});await t.load();const o=t.getParentBlockStore();if(!o)throw new Error("Block has no parent.");await o.load();const r=o.getContentStore();return{store:g.G.createChildStore(r,{table:l.iU,id:e}),parentStore:o,parentContentStore:r}}))),a=i[0];if(!a)return;const s=(0,p.RM)();if(!s)return;if(a.store.useCrdt()!==s.useCrdt())return void S.oV({label:s.useCrdt()?"Cannot sync a non-CRDT block in a CRDT page.":"Cannot sync a CRDT block in a non-CRDT page."});const{serverCommitResult:c}=k.createAndCommit({userAction:"blockPasteMenuActions.acceptCreateTransclusion",environment:t,perform:e=>{let o;if(a.store.getType()===r.Ti.transclusionContainer)o=a.store;else if(a.store.getType()===r.Ti.transclusionReference){const e=a.store.getTransclusionReferenceTargetStore();if(!e)throw new Error("Could not find target");o=e}else if(a.parentStore.getType()===r.Ti.transclusionContainer)o=a.parentStore;else{o=b.j4({environment:t,type:r.Ti.transclusionContainer,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:a.store.pointer.spaceId,useCrdt:a.store.useCrdt()});const n=o.getContentStore();v.rS({parentStore:a.parentContentStore,oldChildStore:a.store,newChildStore:o,transaction:e});for(const{store:t}of i)v.jG({parentStore:n,childStore:t,transaction:e})}const l=b.j4({environment:t,type:r.Ti.transclusionReference,format:{transclusion_reference_pointer:o.pointer},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:0!==n.length?n[n.length-1].pointer.spaceId:s.pointer.spaceId,useCrdt:0!==n.length?n[n.length-1].useCrdt():s.useCrdt()}),c=y.is({environment:t,blocks:[l],selection:n,transaction:e,replaceEmptyTextBlock:!0});y.Cl({environment:t,blocks:n,transaction:e}),_.Z5({environment:t,stores:c}),x()}});await c}},51365:(e,t,n)=>{n.d(t,{$o:()=>b,RX:()=>y,bA:()=>g,fG:()=>w,gT:()=>_,i2:()=>S,mm:()=>k,vO:()=>v,xv:()=>h});var o=n(73935),r=n(1302),i=n(99036),a=n(80951),s=n(70203),l=n(58299),c=n(9953),d=n(61045),u=n(24677),p=n(993),m=n(98104),f=n(82530);function g(e){const{environment:t,blockPropertyValueOverlayStore:n,store:a,additionalStores:c=[],property:g,format:h,preventClearSelection:v,insertChar:b,uploadFiles:y,disableHorizontalEdgeScroll:_,isNewBlock:S,collectionContextStore:w,mode:k,collectionsBulkActionsToolbarStore:I,readOnly:C}=e,x=((null==w?void 0:w.normalizedSchemaStore.state)??a.getSchema())[g],T=l.Z.findBlockPropertyValue(a,g);let M=e.rect;const P=null==T?void 0:T.getNode();if(P&&(d.bx({element:P,vertical:{reveal:"closest"},horizontal:_?void 0:{reveal:"closest"},scrollers:{verticalScroller:null==T?void 0:T.getContextVerticalScroller(),horizontalScroller:null==T?void 0:T.getContextHorizontalScroller()}}),!M)){const e=o.findDOMNode(P);e instanceof Element&&(M=e.getBoundingClientRect())}if(!M)return;const A=a.clone();if(n.setState({isOpen:!0,store:a,clonedStore:A,additionalStores:c,property:g,format:h,rect:M,preventClearSelection:v,insertChar:b,uploadFiles:y,isNewBlock:S,collectionContextStore:w,mode:k,collectionsBulkActionsToolbarStore:I,readOnly:C}),!I||"title"!==(null==x?void 0:x.type)&&"text"!==(null==x?void 0:x.type)||null==I||I.setState({textStoresBeingEdited:[...c,a],lastBlockPropertyValueOverlayCloseTime:void 0}),x&&i.Yl(x.type)){v||u.ZH(t);const e=A.getNormalizedPropertyStore(g);b&&f.createAndCommit({userAction:"blockPropertyValueOverlayActions.open",environment:t,perform:n=>{p.sO({environment:t,store:e,value:s.TPx(b),transaction:n})}}),r.default.afterNextFlush((()=>{r.default.afterNextFlush((()=>{r.default.afterNextFlush((()=>{m.NX({store:e})}))}))}))}else v||u.ZH(t),m.ZH(t)}function h(e){const{environment:t,blockPropertyValueOverlayStore:n}=e,o=n.state;o.isOpen&&(o.preventClearSelection||u.ZH(t),n.reset(),r.default.afterNextFlush((()=>{var e;return null===(e=o.collectionsBulkActionsToolbarStore)||void 0===e?void 0:e.setState({textStoresBeingEdited:[],lastBlockPropertyValueOverlayCloseTime:Date.now()})})))}const v=function(e){const{stores:t,property:n,transaction:o}=e,r=t[0].getPropertyStore(n),i=(0,a.Ml)(r.getValue());for(const s of t)c.sO({store:s.getPropertyStore(n),value:(0,a._I)(!i),transaction:o})};function b(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:i}=n,a=l.Z.findBlockPropertyValue(t,i);var o,r;if(null!=a&&a.getProps().onTab)null==a||null===(o=(r=a.getProps()).onTab)||void 0===o||o.call(r);else h(e)}}function y(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:i}=n,a=l.Z.findBlockPropertyValue(t,i);var o,r;if(null!=a&&a.getProps().onUntab)null==a||null===(o=(r=a.getProps()).onUntab)||void 0===o||o.call(r);else h(e)}}function _(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:i}=n,a=l.Z.findBlockPropertyValue(t,i);var o,r;if(null!=a&&a.getProps().onEnter)null==a||null===(o=(r=a.getProps()).onEnter)||void 0===o||o.call(r);else h(e)}}function S(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:i}=n,a=l.Z.findBlockPropertyValue(t,i);var o,r;if(null!=a&&a.getProps().onEsc)null==a||null===(o=(r=a.getProps()).onEsc)||void 0===o||o.call(r);else h(e)}}function w(e){const{blockPropertyValueOverlayStore:t}=e,n=t.state;if(n.isOpen){const{store:t,property:i}=n,a=l.Z.findBlockPropertyValue(t,i);var o,r;if(null!=a&&a.getProps().onBgClick)null==a||null===(o=(r=a.getProps()).onBgClick)||void 0===o||o.call(r);else h(e)}}function k(e){const{blockPropertyValueOverlayStore:t,openProperty:n}=e,o=t.state;if(o.isOpen){var r,i;const{store:t,property:a}=o,s=l.Z.findBlockPropertyValue(t,a);(null==s||null===(r=(i=s.getProps()).onOpenProperty)||void 0===r?void 0:r.call(i,n))||h(e)}}},48948:(e,t,n)=>{n.d(t,{K:()=>p});var o=n(41432),r=n(29477),i=n(23867),a=n(70203),s=n(80444),l=n(54642),c=n(9953),d=n(993),u=n(82530);async function p(e){const{store:t,url:n,environment:p,teamId:m}=e,f=void 0!==e.transformTimeout?e.transformTimeout:3e3,{serverCommitResult:g}=u.createAndCommit({userAction:"bookmarkBlockActions.createBookmark",environment:p,perform:e=>{c.sW({store:t.getPropertiesStore(),data:{link:a.TPx(n)},transaction:e}),d.sO({environment:p,store:t.getBlockTitleStore(),value:a.TPx(n),transaction:e})}}),{winner:h,rest:v}=await r.S3([g,r.Vs(f)]);if(1===h&&(await async function(e,t){const{serverCommitResult:n}=u.createAndCommit({userAction:"bookmarkBlockActions.transformIntoBookmark",environment:e,perform:e=>{c.sW({store:t,data:{type:o.Ti.bookmark},transaction:e})}});await n}(p,t),await v),m){const{currentSpaceStore:e}=s.default.state;await l.setBookmarkMetadata(p,{type:"team-invite-bookmark",block:{id:t.id,spaceId:(0,i.C)(t.pointer.spaceId)},url:n,teamId:m,spaceId:e&&e.id})}else await l.setBookmarkMetadata(p,{type:"external-bookmark",block:{id:t.id,spaceId:(0,i.C)(t.pointer.spaceId)},url:n})}},893:(e,t,n)=>{n.d(t,{tq:()=>it,JG:()=>Ft,IK:()=>un,VG:()=>cn,g9:()=>pn,Hs:()=>ln,Dw:()=>dn,RD:()=>mn,Pm:()=>hn,by:()=>Bt,tk:()=>Jt,of:()=>qt,e0:()=>xt,Mt:()=>bn,wc:()=>vn,v:()=>rn,AL:()=>Ot,R$:()=>Lt,jm:()=>Pt,f4:()=>gn,Lh:()=>yn});n(57658);var o=n(27856),r=n.n(o),i=n(1302),a=n(66897),s=n(15145),l=n(41432),c=n(99036),d=n(8848),u=n(1800),p=n(15095),m=n(64962),f=n(61075),g=n(42509),h=n(43593),v=n(35102),b=n(68626),y=n(38297),_=n(42875),S=n(19531),w=n(64572),k=n(22808),I=n(30845),C=n(72126),x=n(25718),T=n(59753),M=n(482),P=n(77337),A=n(19233),R=n(4615),D=n(71644),E=n(45953),B=n(606),F=n(82883),O=n(99405),Z=n(21202),V=n(6287),U=n(70279),N=n(23867),L=n(54153),j=n(70203),z=n(44805),q=n(95371),H=n(97880),W=n(64002),K=n(9291),G=n(96313),$=n(94419),Q=n(37524),Y=n(75330),X=n(95477),J=n(24990),ee=n(28020),te=n(56518),ne=n(44486),oe=n(84210),re=n(33929),ie=n(68056),ae=n(45162),se=n(70219),le=n(65598),ce=n(73959),de=n(41984),ue=n(89224),pe=n(89086),me=n(28685),fe=n(50694),ge=n(80444),he=n(87143),ve=n(88632),be=n(77080),ye=n(30874),_e=n(22294),Se=n(79797),we=n(27724),ke=n(24666),Ie=n(34583),Ce=n(36610),xe=n(952),Te=n(57549),Me=n(79554),Pe=(n(21703),n(374)),Ae=n(70842),Re=n(82798),De=n(78791),Ee=n(27105),Be=n(98165),Fe=n(69645),Oe=n(95802),Ze=n(54532),Ve=n(19358),Ue=n(993),Ne=n(98104),Le=n(68422);function je(e){const{environment:t,clipboardData:n,transaction:o,allowPasteIntoHeaderWithoutChildren:r,selectAll:a,developerDebug:s}=e;if(ke.default.isEditingComment()||(0,pe.qK)())return!1;if(n.blockSelection.blocks.some((e=>!e.blockSubtree)))return!1;const c=ke.default.state;if("editing"!==c.mode)return!1;const d=c.multiSelection.start.store;if(!d.isTable(Z.iU))return!1;const u=(0,ce.sQ)(d);if(!u)return!1;if(d!==u.getBlockTitleStore())return!1;const p=u.getType(),m=u.getFormat();if(!p)return!1;if(!((0,l.Um)(p,m)||r&&(0,l.zp)(p)))return!1;if(r&&(0,l.zp)(p)){const e=n.blockSelection.blocks[0],t=null==e?void 0:e.blockId,o=null==e?void 0:e.blockSubtree,r=t&&o?o.getModel({id:t,table:"block"}):void 0;if(Boolean(null==r?void 0:r.getContentLength()))return!1}const f=(0,Fe.dq)({includeNonSelectableListContainer:!0});if(!f)return!1;const g=(0,Fe.v5)(u,[f]);if(!g)return!1;let h=0;for(let i=g.length-1;i>=0;i--){const e=g[i].value.store,t=Oe.C.findSelectableFromStore(e),n=e.getModel();if(null!=n&&n.isType(l.$t)||t&&!t.props.canSelect){h=i;break}}const v=g.slice(h);if(0===v.length)return!1;const b=v[0].value.store,y=b.pointer.spaceId,_=b.isInsideTemplate()||b.isInsideFactoryOrDuplicateBlocksAction();s("pasting at",v,{spaceId:y,pastingIntoTemplate:_,insertionPathRootStore:b});const S=n.blockSelection.blocks.map((e=>{var n;let{blockId:r,blockSubtree:i}=e;if(!i)throw new Error("Missing data for local duplicate block during paste");const a=(null===(n=i.getModel({table:Z.iU,id:r}))||void 0===n?void 0:n.getType())===l.Ti.factory,s=!(_||a),c=Se.G.createChildStore(b,{table:Z.iU,id:r}),d=Ze.E9({environment:t,sourceBlockId:r,targetBlockPointer:{table:Z.iU,id:(0,R.ZP)(),spaceId:y},sourceBlockSubtree:i,targetInMemoryRecordCache:b.inMemoryRecordCache,addCopyName:(0,de.Z)(c),deepCopyTransclusionContainers:!1,resolveTemplateVariables:s,transaction:o,useCrdt:b.useCrdt()}),u=d.targetBlock.getType();return u&&xe.W(t,{from:"paste",type:u,new_page_id:"page"===u?d.targetBlock.id:void 0,creating_block_id:d.targetBlock.id}),d})),w=n.multiTextSelection.start.pointerPath,k=n.multiTextSelection.end.pointerPath,I=[],C=[],x=Math.max(w.length,k.length),T=(v[v.length-x]||v[0]).value.store,M=(0,q.MW)({node:n.tree,recordStoreParent:T},(e=>{let{node:t,recordStoreParent:n}=e;const o=((e,t)=>{let n;for(const{originalToDuplicate:o}of S)if(n=o.get(t),n)break;if(n)return Se.G.createChildStore(e,n)})(n,t.value),r=I.length<w.length?w[I.length]:void 0,i=C.length<k.length?k[C.length]:void 0;let a=!1;if((null==r?void 0:r.id)===t.value.id&&(a=!0,I.push(o)),(null==i?void 0:i.id)===t.value.id&&(a=!0,C.push(o)),!a)return{value:{store:o}};const s=(null==o?void 0:o.getContentStore())||b;return{value:{store:o},children:t.children.map((e=>({node:e,recordStoreParent:s})))}}));if(I.length!==w.length||0===I.length)throw new Error(`Failed to hydrate start path during paste (found ${I.length} of ${w.length})`);if(C.length!==k.length||0===C.length)throw new Error(`Failed to hydrate end path during paste (found ${C.length} of ${k.length})`);const P=I[I.length-1],A=C[C.length-1];if(!P||!A)throw new Error(`Failed to hydrate position during paste (${P?"":"missing start"} ${A?"":"missing end"})`);const D=(0,q.DY)([M],(e=>e.value.store===P)),E=(0,q.DY)([M],(e=>e.value.store===A)),B=D&&E&&Ae.T.fromNearestCommonAncestor(D,E);if(!B)throw new Error(`Failed to build range for paths: ${D?"":"missing start"} ${E?"":"missing end"}`);Ue.pz({environment:t,multiSelection:c.multiSelection,transaction:o});const F=ke.default.state,O="editing"===F.mode?F.multiSelection:c.multiSelection;if((0,le.PF)(u)&&0===n.multiTextSelection.start.textIndex){const e=P.getType();e&&(0,l.Zu)(e)&&Le.Cj({environment:t,blocks:[u],blockType:e,transaction:o})}let V;return b.useCrdt()?(qe({transaction:o,developerDebug:s,clipboardData:n,startBlock:u,duplicateStartStore:P,range:B,insertionPath:v,duplicates:S,insertionPathRootStore:b}),V=ze({environment:t,transaction:o,clipboardData:n,insertionPoint:O,developerDebug:s,textSelectionState:c,duplicateEndStore:A,pastingIntoTemplate:_}).newSelectionIndex):(V=ze({environment:t,transaction:o,clipboardData:n,insertionPoint:O,developerDebug:s,textSelectionState:c,duplicateEndStore:A,pastingIntoTemplate:_}).newSelectionIndex,qe({transaction:o,developerDebug:s,clipboardData:n,startBlock:u,duplicateStartStore:P,range:B,insertionPath:v,duplicates:S,insertionPathRootStore:b})),i.default.afterNextFlush((()=>{const e=(0,Fe.kC)({rootStore:b,root:f,target:B.end}),t=e&&(0,ce.mh)(e[e.length-1]);if(!t)return;const n={start:{index:a?O.start.index:V,store:a?O.start.store:t},end:{index:V,store:t}};Ne.NA({multiSelection:n})})),!0}function ze(e){const{insertionPoint:t,duplicateEndStore:n,pastingIntoTemplate:o,environment:r,transaction:i,developerDebug:a,clipboardData:s}=e;let l=0;const c=t.end.store,d=t.end.index,u=(0,ce.mh)(n);if(u){l=j.eeV(u.getValue()).length;const e=(0,Re.TO)((0,ce.sQ)(c)),t=(0,Re.TO)((0,ce.sQ)(u));Ee.Ls({store:c,blockStore:e})&&Ee.Ls({store:u,blockStore:t})?(De.Wc({sourceBlockStore:e,targetBlockStore:t,splitAtGraphemeIndex:d,transaction:i,moveIntoNewBlock:!1}),a("(CRDT) pasted suffix into end",u)):(Ue.gc({environment:r,sourceStore:c,sourceIndex:d,targetStore:u,targetIndex:l,transaction:i}),a("pasted suffix into end",u))}else Ue.pe({environment:r,transaction:i,store:c,selection:{startIndex:d,endIndex:1/0}}),a("no end title store to paste text into");let p=j.OAI(s.multiTextSelection.start.copiedText);return o||(p=j.KV2(p,{currentUserId:r.currentUser.id,currentTimeZone:(0,_.r)()})),Ue.mM({environment:r,index:t.start.index,store:t.start.store,tokens:p,transaction:i}),{newSelectionIndex:l}}function qe(e){const{transaction:t,clipboardData:n,startBlock:o,duplicateStartStore:r,insertionPath:i,insertionPathRootStore:a,duplicates:s,range:l,developerDebug:c}=e;for(const u of l.iterateInsertionAt(i))(0,Fe.D_)({transaction:t,treeOperation:u,deleteFrom:"tree-parent"}),Pe.f.applyMutable(u);if(n.blockSelection.wasContiguousSelection&&n.blockSelection.blocks.length>0&&!o.hasContent())for(const u of r.getContentStores())$.R3({parent:o.getContentStore(),append:u,transaction:t});const d=new Set;for(const{originalToDuplicate:u}of s){const e=u.getByTable(Z.iU);for(const{value:n}of e){if(!n||d.has(n.id))continue;d.add(n.id);const e=Se.G.createChildStore(r,n);(0,Be.qA)(e).find((e=>e.id===a.id))||(c("disposing of unwanted duplicated block:",e,e.id===r.id),Ve.YM({childStore:e,parentStore:a,alive:!1,transaction:t}))}}}var He=n(42274),We=n(47307),Ke=n(31781),Ge=n(89951),$e=n(9953),Qe=n(42858),Ye=n(24677),Xe=n(64964),Je=n(80402),et=n(82530),tt=n(12170);const nt=!1;function ot(){if(nt){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log("clipboardActions:",...t)}}const rt=(0,K.defineMessages)({offlineError:{id:"clipboardActions.offlineError.message",defaultMessage:"Please go online to copy this block."}}),it=(0,K.defineMessages)({copiedQnAMessageToClipboard:{id:"action.copiedQnAMessageToClipboard",defaultMessage:"Copied response to clipboard"},copiedLinkToClipboard:{id:"action.copiedLinkToClipboard.snackBarMessage",defaultMessage:"Copied link to clipboard"},copiedBlockLinkToClipboard:{id:"action.copiedBlockLinkToClipboard.snackBarMessage",defaultMessage:"Copied block link to clipboard"},copiedLinksToClipboard:{id:"action.copiedLinksToClipboard.snackBarMessage",defaultMessage:"Copied links to clipboard"},copiedPropertyToClipboard:{id:"action.copiedPropertyToClipboard.snackBarMessage",defaultMessage:"Copied property to clipboard"},copiedCodeToClipboard:{id:"action.copiedCodeToClipboard.snackBarMessage",defaultMessage:"Copied code to clipboard"},copiedTokenToClipboard:{id:"action.copiedTokenToClipboard.snackBarMessage",defaultMessage:"Copied token to clipboard"},copiedToClipboard:{id:"action.copiedToClipboard.snackBarMessage",defaultMessage:"Copied to clipboard"},copiedApiObjectToClipboard:{id:"action.copiedApiObjectToClipboard.snackBarMessage",defaultMessage:"Copied API object to clipboard"}}),at={...A.Y,dockerfile:"Docker",javascriptreact:"JavaScript",jsonc:"JSON","objective-c":"Objective-C",proto:"Protobuf",shellscript:"Shell",typescriptreact:"TypeScript",vb:"Visual Basic"},st="text/_notion-blocks-v3-production",lt="text/_notion-text-production",ct="text/_notion-multi-text-production",dt="text/_notion-page-source-production",ut="vscode-editor-data",pt=[st,lt,ct,dt],mt=new Set(pt);const ft={fromJson:e=>e,toJson:e=>e},gt=ft,ht=ft,vt=ft,bt={fromJson(e){const t=(0,q.MW)(e.tree,(e=>e)),n=yt.fromJson(e.blockSelection);return{...e,tree:t,blockSelection:n}},toJson(e){const t=yt.toJson(e.blockSelection);return{...e,blockSelection:t}}},yt={fromJson:e=>({...e,blocks:e.blocks.map((e=>({...e,blockSubtree:e.blockSubtree?E.Ak.create(e.blockSubtree):void 0})))}),toJson:e=>({...e,blocks:e.blocks.map((e=>({...e,blockSubtree:e.blockSubtree?e.blockSubtree.toJson({allowVersionDowngrade:!1}):void 0})))})},_t="VirtualClipboard:production";let St;function wt(e){return e.isAndroid}function kt(e,t){if(!wt(t))return e;const n=(0,te.nZ)(e.getData("text/html"));if(n){St||(St=L.Z.get(_t));const t=St;if(n===(null==t?void 0:t.id)){const n=e.types.concat(Object.keys(t.mimeTypes));return{getData(n){const o=e.getData(n);return!o&&function(e){return mt.has(e)}(n)?t.mimeTypes[n]||"":o},types:[...new Set(n)].filter((n=>{const o=t.mimeTypes[n];return""!==e.getData(n)||o&&""!==o})),items:e.items}}}return e}function It(e,t,n,o){if(!e.clipboardData)return;const r=n.toJson(o),i=JSON.stringify(r);e.clipboardData.setData(t,i)}function Ct(e,t,n){try{const o=e.getData(t),r=JSON.parse(o);return n.fromJson(r)}catch(o){return}}function xt(e){const{clipboardData:t}=e,{text:n,html:o,isFromMicrosoftOffice:r,isHtmlTable:i}=function(e){const{clipboardData:t,tinyMceMicrosoftWordPasteFilter:n}=e,o=t.getData("text/uri-list").trim(),r=t.getData("text/plain").trim().replace(on,"\n")||o,i=t.getData("text/html").trim(),a=$t(i),{isHtmlTable:s,htmlContainsRichFormatting:l}=function(e){var t;const n=document.createElement("div");n.innerHTML=Qt(e);const o=Boolean("table"===(null===(t=n.firstElementChild)||void 0===t?void 0:t.nodeName.toLowerCase()));return{htmlContainsRichFormatting:S.RE({node:n,window,emojiData:J.Z.state}),isHtmlTable:o}}({html:i,tinyMceMicrosoftWordPasteFilter:n});if(!l&&!function(e,t){return nn.test(e)&&nn.test(t)}(i,r))return{text:r,isFromMicrosoftOffice:a,isHtmlTable:s};return{text:r,html:i,isFromMicrosoftOffice:a,isHtmlTable:s}}(e);return{text:n,html:o,multiTextSelectionData:Ct(t,ct,bt),textSelectionData:Ct(t,lt,gt),blockSelectionData:Ct(t,st,yt),isFromMicrosoftOffice:r,isHtmlTable:i}}function Tt(e){const{blocks:t,action:n,environment:o}=e;if(0===t.length)return{action:n,blocks:[],wasContiguousSelection:!1};const r=t[0],i=r.inMemoryRecordCache,a=C.jj(C.oA(t.map((e=>e.id)))),s=r.getParentBlockStore(),l=s?s.getRenderableContentIds():[],c=l.indexOf(r.id),d=Boolean(s&&t.every(((e,t)=>l.indexOf(e.id)===c+t)));if(i.isTemplatePreview){return{blocks:a.map((e=>({blockId:e,snapshotData:void 0,blockSubtree:Ze.K8(o,{blockId:e,inMemoryRecordCache:i,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0})}))),action:n,wasContiguousSelection:d}}if(i.snapshotData){Ce.P_(o,i.snapshotData);return{blocks:a.map((e=>({blockId:e,snapshotData:i.snapshotData,blockSubtree:Ze.K8(o,{blockId:e,inMemoryRecordCache:i,allowCopyCollections:!0,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0})}))),action:n,wasContiguousSelection:d}}{const e=(0,te.IU)(t),r=e&&function(e){var t;const{environment:n,multiColumnPasteInfo:o,inMemoryRecordCache:r}=e,{columnListId:i,columnIds:a,spaceId:s}=o,l=E.Ak.create(),c=null===(t=r.getEntry({pointer:{table:Z.iU,id:i,spaceId:s},userId:n.currentUser.id}))||void 0===t?void 0:t.value.value;if("column_list"!==(null==c?void 0:c.type))return;const d={...c,content:(c.content||[]).filter((e=>a.has(e)))};l.setValue({table:Z.iU,id:i,spaceId:s},d);for(const m of a){var u;const e=null===(u=r.getEntry({pointer:{table:Z.iU,id:m,spaceId:s},userId:n.currentUser.id}))||void 0===u?void 0:u.value.value;if("column"!==(null==e?void 0:e.type))return;const t={...e,content:(e.content||[]).filter((e=>o.blockIds.has(e)))};l.setValue({table:Z.iU,id:m,spaceId:s},t)}const p=[l];for(const m of o.blockIds){const e=Ze.K8(n,{blockId:m,inMemoryRecordCache:r,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0});if(!e)return;p.push(e)}return E.Ak.merge(p)}({environment:o,inMemoryRecordCache:i,multiColumnPasteInfo:e});if(e&&r){let t=!1;const s=[];for(const n of a)e.blockIds.has(n)?t||(s.push({blockId:e.columnListId,snapshotData:void 0,blockSubtree:r}),t=!0):s.push({blockId:n,snapshotData:void 0,blockSubtree:Ze.K8(o,{blockId:n,inMemoryRecordCache:i,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0})});return{blocks:s,action:n,wasContiguousSelection:d}}return{blocks:a.map((e=>({blockId:e,snapshotData:void 0,blockSubtree:Ze.K8(o,{blockId:e,inMemoryRecordCache:i,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0})}))),action:n,wasContiguousSelection:d}}}function Mt(e){const{markdown:t,markdownOptions:n,markdownLinkifyIt:o}=e;if(o)return x.c8({...o,markdown:t,plugin:null==n?void 0:n.plugin})}function Pt(e){const{rootBlock:t,getRecordValue:n}=e,o=n(t);if(!o)return;const r=(0,y.ky)({block:o,getRecordValue:n});if(!r)return;const i=(0,te.ax)({rootBlock:t,getRecordValue:n}),a=(0,c.oC)(r),s=Object.keys(a),l=C.MR(s,(e=>{const t=a[e];return t&&t.name||""}));let d="";for(const c of l){const e=a[c];if(e&&"title"!==c){const t=(0,f.Wy)({property:c,schema:a,block:o,exportArgs:i,renderers:m.O});t&&(d+=`${e.name}: ${t}\n`)}}return d||void 0}function At(e){const{treePath:t,textPosition:n,endpoint:o}=e,{store:r,index:i}=n,a=t.map((e=>e.value.store.pointer)),s=n.store.path,l=j.xrQ(r.getValue(),i,i);return{copiedText:"end"===o?l.tokensBeforeRange:l.tokensAfterRange,textIndex:i,attributePath:s,pointerPath:a}}function Rt(e){var t;const{multiSelection:n,action:o,environment:r}=e;(0,ie.qS)(n)&&console.warn("Warning, serializeMultiTextSelectionToClipboardData() was called with a single-store text selection! This function should only be  called with a multi-selection that spans multiple blocks.");const i=null===(t=(0,ae.tp)({filterCommonAncestors:!0,multiSelection:n,focus:void 0}))||void 0===t?void 0:t.stores;if(!i)return;const a=Tt({action:o,blocks:i,environment:r});if(0===a.blocks.length)return;const s=(0,ae.Nj)({multiSelection:n,includeNonSelectable:!1});if(!s)return;const{treeRange:l}=s,c=[],d=new Map,u=(e,t)=>{t.forEach((e=>u(e,[])));const n=d.get(e),o=n&&n.length>t.length?n:t;d.set(e,o)};for(const{start:v,end:b}of l.iterateAnalogousNodes()){if(v){const e=v.childrenBeforeRange.slice(-1).concat(v.childrenInsideRange);u(v.parent,e)}b&&(u(b.parent,b.childrenInsideRange),c.push(M.op.set({pointer:b.parent.value.store.pointer,path:["content"],args:b.childrenInsideRange.map((e=>e.value.store.id))})))}const p=At({textPosition:n.start,endpoint:"start",treePath:l.startPath}),m=At({textPosition:n.end,endpoint:"end",treePath:l.endPath});c.push(...(0,te.FQ)(p),...(0,te.FQ)(m));for(const v of[null===(f=a.blocks[0])||void 0===f?void 0:f.blockSubtree,null===(g=a.blocks[a.blocks.length-1])||void 0===g?void 0:g.blockSubtree]){var f,g;v&&(0,P.FS)({recordMap:v,operations:c,updateOnly:!0})}const h=(0,q.MW)(l.commonAncestor,(e=>{const t=d.get(e);if(t)return{value:e.value.store.pointer,children:t}}));if(h)return{blockSelection:a,tree:h,multiTextSelection:{start:p,end:m},action:o};ot("unexpected: trimming tree produced undefined")}function Dt(e){const{environment:t,event:n}=e,o=(0,R.ZP)();!function(e){const{environment:t,event:n,markdownLinkifyIt:o}=e;if(!n.clipboardData)return;const r=we.default.state.stores,i=ke.default.isEditingComment(),a=fe.g$.getSimpleTableCellFromTextSelection(),s="empty"!==ke.default.state.mode&&ke.default.state.multiSelection,c=t.currentUser.id,u="copy"===n.type?"copy":"cut",p=ee.RM();p&&(0,B.$O)(p.pointer,Z.iU)&&It(n,dt,ht,p.pointer);const m=s&&(0,ie.QY)(s);if(m&&m.selection.startIndex!==m.selection.endIndex){const e=re.default.getIntl(),{store:o,selection:r}=m,i=o.inMemoryRecordCache,a=o.getValue();if(ot("copy: copying single-store text selection"),n.preventDefault(),a&&!Jt()){var f;const e="title"===o.path[o.path.length-1],t=null===(f=(0,ce.sQ)(o))||void 0===f?void 0:f.getType(),i=e&&t&&(0,l.Zu)(t)?t:void 0,s=a.filter((e=>!j.eIM(e)));It(n,lt,gt,{blockType:i,editing:s,selection:r,action:u})}const s=j.KU1(a,r.startIndex,r.endIndex),p=T.om.fromGetRecordValueFn(i.makeGetRecordValueFn(c)),g=i.makeGetRecordRoleFn(c),h=(0,F.X)({intl:e,textValue:s,getRecordModel:p,userTimeZone:(0,_.r)()});n.clipboardData.setData("text/plain",(0,te.ZI)(t.device.isWindows,h));const v=z.hW({textValue:s&&{value:s,spaceId:(0,N.C)(o.pointer.spaceId)},getRecordModel:p,getRecordRole:g,userTimeZone:(0,_.r)(),isAndroid:!1,isSafariOrIOS:!1,isWindows:!1,disableLinks:!1,disabled:!0,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,baseUrl:X.default.domainBaseUrl,publicDomainName:X.default.publicDomainName,showEmojiInline:!0,emojiType:"raw",theme:(0,d.Vx)(),intl:e,katex:void 0,isClient:void 0,currentUserId:void 0,overwriteBaseUrlFromSpaceId:(0,se.b)(t),externalIntegrations:ye.Z.integrations.state,formulaValueTypes:[],emojiData:J.Z.state,isMobileNative:!1});return void n.clipboardData.setData("text/html",(0,te.ZI)(t.device.isWindows,v))}if(s&&!(0,ie.iG)(s)&&!i&&s.start.store.table===Z.iU&&s.end.store.table===Z.iU){const e=Rt({environment:t,multiSelection:s,action:u});if(e){ot("copy: copying multi-text selection"),n.preventDefault(),It(n,ct,bt,e);const r=s.start.store.inMemoryRecordCache,i=s.start.store.getRecordStoreUIRoot().getValue();if(!i)return;const{markdown:a,html:l}=(0,te.Ef)({clipboardData:e,rootBlock:{id:i.id,table:Z.iU,spaceId:i.space_id},isWindows:t.device.isWindows,fallbackGetRecordValue:r.makeGetRecordValueFn(c),markdownLinkifyIt:o});return a&&n.clipboardData.setData("text/plain",a),void(l&&n.clipboardData.setData("text/html",l))}}if(s&&!(0,ie.iG)(s)&&!i&&s.start.store.table===U.x_&&s.end.store.table===U.x_){ot("copy: copying comment multi-text selection"),n.preventDefault();const e=(0,ae.L5)(s),o=re.default.getIntl(),r=e.map((e=>{let{store:n,selection:r}=e;if(r.startIndex===r.endIndex)return;const i=n.inMemoryRecordCache,a=T.om.fromGetRecordValueFn(i.makeGetRecordValueFn(c)),s=i.makeGetRecordRoleFn(c),l=j.KU1(n.getValue(),r.startIndex,r.endIndex);return{plainText:(0,F.X)({intl:o,textValue:l,getRecordModel:a,userTimeZone:(0,_.r)()}),htmlContent:z.hW({textValue:l&&{value:l,spaceId:(0,N.C)(n.pointer.spaceId)},getRecordModel:a,getRecordRole:s,userTimeZone:(0,_.r)(),isAndroid:!1,isSafariOrIOS:!1,isWindows:!1,disableLinks:!1,disabled:!0,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,baseUrl:X.default.domainBaseUrl,publicDomainName:X.default.publicDomainName,showEmojiInline:!0,emojiType:"raw",theme:(0,d.Vx)(),intl:o,katex:void 0,isClient:void 0,currentUserId:void 0,overwriteBaseUrlFromSpaceId:(0,se.b)(t),externalIntegrations:ye.Z.integrations.state,formulaValueTypes:[],emojiData:J.Z.state,isMobileNative:!1}),textValue:l}})).filter(H.$K),i=r.map((e=>e.plainText)).join("\n\n"),a=`<div>${r.map((e=>e.htmlContent)).join("</div><div>")}</div>`;return n.clipboardData.setData("text/plain",(0,te.ZI)(t.device.isWindows,i)),void n.clipboardData.setData("text/html",(0,te.ZI)(t.device.isWindows,a))}if(r.length>0&&!i&&!a){ot("copy: copying block selection"),n.preventDefault();const e=r[0],i=e.inMemoryRecordCache,a=Tt({blocks:r,environment:t,action:u});if(It(n,st,yt,a),!e.isDefined())return;const s=C.oA(r.map((e=>e.computeWithRecordValues((t=>{let{getRecordValueAndSubscribe:n}=t;return n(e)}))))),l=i.makeGetRecordValueFn(c),{markdown:d,html:p}=(0,te.X4)({rootBlock:{id:e.id,table:Z.iU,spaceId:e.getSpaceId()},blockValues:s,getRecordValue:l,isWindows:t.device.isWindows,markdownLinkifyIt:o});return d&&n.clipboardData.setData("text/plain",d),void(p&&n.clipboardData.setData("text/html",p))}ot("copy: doing nothing")}(e),(0,te.Li)(n,o),function(e){let{event:t,device:n,customEventId:o}=e;if(!t.clipboardData||!wt(n))return;const r={};for(const s of pt)r[s]=t.clipboardData.getData(s);const i=t.clipboardData.getData("text/html");t.clipboardData.setData("text/html",`${i}${(0,te.Gp)(o)}`),St={id:o,mimeTypes:r};try{L.Z.set(_t,St)}catch(a){b.log({level:"error",from:"clipboardActions",type:"setVirtualClipboardData",error:{message:"Unable to persistently store virtual clipboard data."}})}}({event:n,device:t.device,customEventId:o})}const Et=function(e){return e.clipboardData?e.clipboardData.items?C.oA(C.UI(e.clipboardData.items,(e=>{const t=e.getAsFile();if(t&&t.size>0)return new File([t],"Untitled",{type:e.type})}))):p.p4(e.clipboardData.files):[]};async function Bt(e){const{event:t,environment:n,markdownLinkifyIt:o}=e;Ne.Zk(n);const r=we.default.state.stores,i=ke.default.isEditingComment(),a=ee.JE(),s="editing"===ke.default.state.mode&&ke.default.state.multiSelection,{phase:l}=we.default.state;Ft({environment:n,event:t,disableSyncTextSelection:!0,markdownLinkifyIt:o}),s&&!(0,ie.iG)(s)?et.createAndCommit({userAction:"clipboardActions.cutWithMaybeConfirmation",environment:n,perform:e=>{Ue.pz({environment:n,multiSelection:s,transaction:e})}}):(l===we.SelectionPhase.Selected||s)&&r.length>0&&!i&&!a&&await Qe.Qw({environment:n,blocks:r}),_e.Z.setKeyboardMode(!0)}function Ft(e){const{environment:t,event:n,disableSyncTextSelection:o,markdownLinkifyIt:r}=e;o||Ne.Zk(t),Dt({environment:t,event:n,markdownLinkifyIt:r}),_e.Z.setKeyboardMode(!0)}function Ot(e){const{environment:t,files:n,transaction:o}=e,r=we.default.getCurrentRecordCache(),i=ee.qQ(t);if(r){var a,s;const e=we.default.state.stores,l=Ke.z({environment:t,files:n,inMemoryRecordCache:r,transaction:o,pageWidth:i,spaceId:0!==e.length?e[0].pointer.spaceId:null===(a=ee.RM())||void 0===a?void 0:a.pointer.spaceId,useCrdt:0!==e.length?e[0].useCrdt():(null===(s=ee.RM())||void 0===s?void 0:s.useCrdt())??!1});l.forEach((e=>{const n=e.getType();n&&xe.W(t,{from:"paste",type:n,creating_block_id:e.id})})),Ut({environment:t,blocks:l,transaction:o,replaceEmptyTextBlock:!0})}}function Zt(e){const{environment:t,store:n,tokens:o,index:r,transaction:a,multiTextSelection:s,disableEmbedMenu:l,selectAll:c}=e,d=(0,ie.QY)(s),u=d?{value:d.store.getValue()}:void 0;Ue.mM({environment:t,store:n,tokens:o,index:r,transaction:a,selectAll:c});const m=Vt(o);!l&&u&&m&&function(e){const{environment:t,hyperlink:n,oldTextValue:o}=e,r="editing"===ke.default.state.mode&&(0,ie.QY)(ke.default.state.multiSelection),a=we.default.state;if(r&&a.stores.length>0){const e=r.store.getValue(),a=j.QaF(e),s=p.p4(a.substring(0,a.indexOf(n.text))).length,l=s+p.p4(n.text).length;if(r.store.isTable(Z.iU)||r.store.isTable(U.x_)){if(tt.KT({environment:t,blockStore:we.default.state.stores[0],textStore:r.store,textValueBeforePaste:o,url:n.url,urlSelection:{startIndex:s,endIndex:l}}))return;if(G.QZ({environment:t,textStore:r.store,blockStore:we.default.state.stores[0],oldTextValue:o,url:n.url,urlSelection:{startIndex:s,endIndex:l}}))return}i.default.afterNextFlush((()=>{let e=n.url;try{e=decodeURIComponent(n.url)}catch(i){b.log({level:"info",from:"clipboardActions",type:"activateMenuFromLink",error:{message:`Encountered error in decodeURIComponent ${n.url}`}})}Ge.KT({environment:t,textStore:r.store,oldTextValue:o,url:e,urlSelection:{startIndex:s,endIndex:l}})}))}}({environment:t,hyperlink:m,oldTextValue:u.value,transaction:a})}function Vt(e){if(1!==e.length)return;const t=e[0];if(!j.AJd(t))return;const[n,o]=t;if(1!==o.length)return;const r=o[0];if(!j.j0F(r))return;return{text:n,url:j.zW$(r)}}function Ut(e){const{environment:t,blocks:n,transaction:o,replaceEmptyTextBlock:r}=e,i=we.default.state.stores;if(1===i.length){const e=i[0];if(e.getType()&&e.isType(l.hY)&&function(e){if("editing"!==ke.default.state.mode||!ke.default.state.multiSelection)return!1;const t=(0,ie.QY)(ke.default.state.multiSelection);if(!t)return!1;return t.store===e.getTitleStore()}(e)){const r=e.getContentStore(),i=C.d9(n).reverse().map((e=>$.Ce({parent:r,prepend:e,transaction:o}).child));return Ye.Z5({environment:t,stores:i}),i}}return Qe.is({selection:i,environment:t,blocks:n,transaction:o,replaceEmptyTextBlock:r})}function Nt(e,t,n,o){const r=(0,ee.RM)();if(!r)return;const a=we.default.state.stores,s=0!==a.length?a[0].pointer.spaceId:r.pointer.spaceId,c=0!==a.length?a[0].useCrdt():r.useCrdt();let d=function(e,t){if("cut"!==t.action||!be.default.checkGate("convert_cut_paste_to_move"))return;const n=[];for(const o of t.blocks){const t=Se.G.createChildStore(e,{table:Z.iU,id:o.blockId});if(!t.isReady())return;if(t.useCrdt()!==e.useCrdt())return;const r=t.getModel();if(!r)return;if(r.getSpaceId()!==e.getSpaceId())return;if(!1!==r.alive)return;n.push(t)}return n}(r,t);d||(d=t.blocks.map((t=>{var n;let{blockId:i,blockSubtree:a,snapshotData:l}=t;const d=Se.G.createChildStore(r,{table:Z.iU,id:i});let u;if(d.isDefined())u=d.getModel();else{const e=null==a?void 0:a.getValue({table:Z.iU,id:i});u=e&&T.kk.fromBlock(e)}const p=!(r.isInsideTemplate()||en()||r.isInsideFactoryOrDuplicateBlocksAction()||null!==(n=u)&&void 0!==n&&n.isTemplateVariableContainerBlock());if(a){const t=Ze.E9({environment:e,sourceBlockId:i,targetBlockPointer:{table:Z.iU,spaceId:s,id:(0,R.ZP)()},sourceBlockSubtree:a,targetInMemoryRecordCache:d.inMemoryRecordCache,addCopyName:(0,de.Z)(d),deepCopyTransclusionContainers:!1,resolveTemplateVariables:p,transaction:o,useCrdt:c}).targetBlock,n=t.getType();return n&&xe.W(e,{from:"paste",type:n,new_page_id:"page"===n?t.id:void 0,creating_block_id:t.id}),t}{ve.Z.state.online||We.showErrorMessage(re.default.formatMessage(rt.offlineError));const[t,n]=Ze.WJ({environment:e,sourceBlocks:[{id:i,spaceId:(0,N.C)(void 0)}],targetInMemoryRecordCache:d.inMemoryRecordCache,addCopyName:(0,de.Z)(d),transaction:o,deepCopyTransclusionContainers:!1,resolveTemplateVariables:p,snapshotData:l,targetSpaceId:(0,N.C)(s),convertExternalObjectInstancesToPlaceholders:!1,useCrdt:c}),r=t[0],a=r.getType();return n.then((t=>{t?We.showErrorMessage(t):a&&xe.W(e,{from:"paste",type:a,new_page_id:"page"===a?r.id:void 0,creating_block_id:r.id})})),r}}))),Ut({environment:e,blocks:d,transaction:o,replaceEmptyTextBlock:!0});const u=we.default.state.stores,p=u.length>0?u:[r],m=t.blocks.map((e=>{const t=p.length>0?p[0]:function(e){return e.isCollectionView()?e.getCollectionViewCollectionStore()||e:e.getContentStore()}(r);return Se.G.createChildStore(t,{table:Z.iU,id:e.blockId})}));i.default.afterNextFlush((async()=>{await Promise.all(p.map((e=>e.waitUntil((()=>{const t=e.getType();return Boolean(t&&t!==l.Ti.copyIndicator)}))))),await Promise.all(m.map((e=>e.load()))),n&&Me.RH({environment:e,blocks:p,pageSource:n,copiedStores:m,action:t.action,wasContiguousSelection:t.wasContiguousSelection,rootStore:r})&&Me.kE({copiedStores:m,blocks:p,pageSource:n})}))}function Lt(e){const{environment:t,disableEmbedMenu:n,transaction:o,overwrite:r,selectAll:i,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c=e.text.trim(),d=c.includes("\n"),u=ke.default.state,p=Xt(u);d&&"inline"!==p||"editing"!==u.mode?r?(ot("paste: pasting as markdown overwrite"),function(e){const{environment:t,text:n,transaction:o,selectAll:r,markdownOptions:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s}=e,l=Mt({markdown:n,markdownOptions:i,markdownLinkifyIt:a});if(!l)return;let c=zt({html:l,wrapInEmptyBlocks:!1,tinyMceMicrosoftWordPasteFilter:s});c||(c=zt({html:l,wrapInEmptyBlocks:!0,tinyMceMicrosoftWordPasteFilter:s}));if(!c)return;je({environment:t,clipboardData:c,transaction:o,allowPasteIntoHeaderWithoutChildren:!0,selectAll:r,developerDebug:ot})}({environment:t,text:c,transaction:o,selectAll:i,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l})):c&&(ot("paste: pasting as markdown append"),function(e){const{environment:t,text:n,transaction:o,markdownOptions:r,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a}=e,s=Mt({markdown:n,markdownOptions:r,markdownLinkifyIt:i});if(s)Wt({environment:t,html:s,transaction:o,tinyMceMicrosoftWordPasteFilter:a})}({environment:t,text:c,transaction:o,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l})):(ot("paste: pasting as inline markdown"),function(e){const{environment:t,text:n,disableEmbedMenu:o,transaction:r,selectAll:i,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c="editing"===ke.default.state.mode&&ke.default.state.multiSelection;if(c){const e=(0,ie.QY)(c);if(e&&function(e){const t=ke.default.state;return"editing"===t.mode&&!(0,ie.iG)(t.multiSelection)&&(0,ie.qS)(t.multiSelection)&&I.B(e,"url")}(n))tn({environment:t,text:n,transaction:r,editingSelection:e,selectAll:i});else if((0,pe.Ld)("c"))Ue.hJ({environment:t,multiSelection:c,string:n,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableEmojiCommands:!0,disableSlashCommands:!0,transaction:r,selectAll:i});else{const e=s&&x.lM({...s,markdown:n,plugin:null==a?void 0:a.plugin});if(!e)return;Ht({environment:t,html:e,transaction:r,stripText:!0,disableEmbedMenu:o,selectAll:i,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l})}}}({environment:t,text:c,disableEmbedMenu:n,transaction:o,selectAll:i,markdownOptions:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}))}function jt(e,t){const n=e.getValue({table:Z.iU,id:t});if(!n)return;const o={table:Z.iU,id:t,spaceId:n.space_id},r=(n.content??[]).map((t=>jt(e,t))).filter(H.$K);return new q.mp(o,r)}function zt(e){var t,n,o,r;const{html:i,wrapInEmptyBlocks:a,tinyMceMicrosoftWordPasteFilter:s}=e,l=Gt({html:i,tinyMceMicrosoftWordPasteFilter:s,useCrdt:!1});if(!l)return;let{allOperations:c,rootContentIds:d}=l;if(a){const e=Kt(),t=Kt();if(!e||!t)return;c=[e.operation,...c,t.operation],d=[e.id,...d,t.id]}const u=E.Ak.create();(0,P.FS)({recordMap:u,operations:c,updateOnly:!1});const p=[];for(const S of d)p.push({blockId:S,snapshotData:void 0,blockSubtree:u.clone()});const m=new q.mp({table:Z.iU,id:(0,R.ZP)(),spaceId:void 0},d.map((e=>jt(u,e))).filter(H.$K));if(0===m.children.length)return;const f=m.children[0],g=null===(t=(0,q.DY)([m],(e=>e===f)))||void 0===t?void 0:t.map((e=>e.value)),h=null===(n=u.getValue(f.value))||void 0===n||null===(n=n.properties)||void 0===n?void 0:n.title,v=(0,q.CY)(m),b=null===(o=(0,q.DY)([m],(e=>e===v)))||void 0===o?void 0:o.map((e=>e.value)),y=null===(r=u.getValue(v.value))||void 0===r||null===(r=r.properties)||void 0===r?void 0:r.title,_=y?j.QaF(y).length:0;return h&&g&&y&&b?{blockSelection:{blocks:p,wasContiguousSelection:!0,action:"copy"},tree:m,multiTextSelection:{start:{textIndex:0,copiedText:h,attributePath:["properties","title"],pointerPath:g},end:{textIndex:_,copiedText:y,attributePath:["properties","title"],pointerPath:b}},action:"copy"}:void 0}function qt(e){const{text:t,html:n,stripText:o,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:i}=e,a=n||(t?Mt({markdown:t,markdownLinkifyIt:r}):void 0);if(!a)return;const s=document.createElement("div");return s.innerHTML=Qt({html:a,tinyMceMicrosoftWordPasteFilter:i}),S.xR({node:s,window,stripText:o,emojiData:J.Z.state})}function Ht(e){const{environment:t,html:n,transaction:o,stripText:r,disableEmbedMenu:i,selectAll:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l}=e,c="editing"===ke.default.state.mode&&ke.default.state.multiSelection;if(c){const e=qt({html:n,stripText:r,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l});if(!e)return;const d=1===e.length;if(d){if(d&&(!e[0][1]||0===e[0][1].length)){ot("pasteInlineHtml: insertString");const n=e[0][0];return void Ue.hJ({environment:t,multiSelection:c,string:n,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:o,selectAll:a})}const n=(0,ie.QY)(c);if(n&&!(0,ie.iG)(c)){const[,r]=e[0],i=r&&j.rlz(r);if(i){ot("pasteInlineHtml: pasteLinkOverText");return void tn({environment:t,text:j.zW$(i),transaction:o,editingSelection:n,selectAll:a})}}}ot("pasteInlineHtml: delete selection and insert"),Ue.pz({environment:t,multiSelection:c,transaction:o}),Zt({environment:t,store:c.start.store,tokens:e,index:c.start.index,transaction:o,disableEmbedMenu:i,multiTextSelection:c,selectAll:a})}}function Wt(e){const{environment:t,html:n,transaction:o,tinyMceMicrosoftWordPasteFilter:r}=e,a=ee.RM();if(!a)return;const s=Gt({html:n,tinyMceMicrosoftWordPasteFilter:r,useCrdt:a.useCrdt()});if(!s)return;const{allOperations:c,rootContentIds:d}=s;for(const i of c){const e=(0,Se.Kv)(a,i.pointer);et.applyOperation({store:e,operation:i,transaction:o})}const u=d.map((e=>Se.G.createChildStore(a,{table:Z.iU,id:e})));u.forEach((e=>{const n=e.getType();n&&xe.W(t,{from:"paste",type:n,creating_block_id:e.id})}));const p=Ut({environment:t,blocks:u,transaction:o,replaceEmptyTextBlock:!0}).slice().reverse();return i.default.afterNextFlush((()=>{const e=p.map((e=>{if(e.getType()!==l.Ti.text)return;const n=Vt(e.getTitleValue());if(!n)return;const o=(0,O.Wj)({url:n.url,baseUrl:X.default.domainBaseUrl,publicDomainName:X.default.publicDomainName,isMobile:t.device.isMobile,protocol:X.default.protocol,currentUrl:window.location.href});return"page"===o.name?o:void 0})).filter(H.$K);e.length===p.length&&Me._x({environment:t,rootStore:a,blocks:p,copiedLinks:e})})),u}function Kt(){const e=(0,R.ZP)(),{currentUserStore:t}=ge.default.state,n=ee.RM();if(!t||!n)return;const o=t.id;if(!o)return;const r=n.id,i=n.pointer.spaceId;return{operation:{pointer:{table:"block",id:e,spaceId:i},command:"set",path:[],args:{id:e,version:1,type:"text",properties:{title:[[""]]},parent_id:r,parent_table:"block",space_id:i,created_by_table:"notion_user",created_by_id:o,created_time:Date.now(),last_edited_by_table:"notion_user",last_edited_by_id:o,last_edited_time:Date.now(),alive:!0}},id:e}}function Gt(e){const{useCrdt:t,...n}=e,o=document.createElement("div");o.innerHTML=Qt(n);const{currentUserStore:r}=ge.default.state,i=ee.RM();if(!r||!i)return;const s=r.getValue();return s?S.$O({actor:(0,a.dp)(s),parentId:i.id,parentTable:"block",spaceId:i.pointer.spaceId,rootNode:o,importFileMap:{},window,secureFileS3Url:X.default.secureFileS3.url,secureFileS3UrlV2:X.default.secureFileS3V2.url,ignoreBlockCount:!1,intl:re.default.getIntl(),randomID:R.ZP,randomShortID:D.ZP,isPhoneNumber:Yt,emojiData:J.Z.state,useCrdt:t}):void 0}function $t(e){return/schemas-microsoft-com:office/.test(e)||/xmlns:m="http:\/\/schemas.microsoft.com\/office\/2004\/12\/omml"/.test(e)}function Qt(e){const{html:t,tinyMceMicrosoftWordPasteFilter:n}=e;return r().sanitize(n&&$t(t)?n(t):t)}function Yt(e){return/^(\+\d{1,2}\s)?\(?\d{3}\)?[\s.-]\d{3}[\s.-]\d{4}$/.test(e)}function Xt(e){const t="editing"===e.mode&&e.multiSelection;if(!t)return;const n=me.E.findEditableWithStore(t.start.store),o=null==n?void 0:n.props;return o&&!o.disabled?o.pasteBehavior:void 0}function Jt(){if("editing"!==ke.default.state.mode)return;const e=ke.default.state.multiSelection.start,t=e.store.path;if("formula"!==t[t.length-1])return;const n=e.store.getRecordStoreAtRootPath();if(n.table!==Z.iU)return;const o=n.getParentId();if(!o)return;const r={table:V.v,id:o,spaceId:n.getSpaceId()},i=n.getRecordModel(r);return i?{parentCollection:i,start:e,getRecordModel:n.getRecordModel}:void 0}function en(){const e=we.default.state.stores;if("editing"!==ke.default.state.mode)return e.length>0&&e[0].isInsideFactoryOrDuplicateBlocksAction();if(0===e.length)return!1;const{multiSelection:t}=ke.default.state,n=t.start.store;if(!n.isTable(Z.iU))return!1;const o=ne.W(n);return Boolean(o)}function tn(e){const{text:t,transaction:n,environment:o,editingSelection:r,selectAll:i}=e,a=(0,O.Wj)({url:t,baseUrl:X.default.domainBaseUrl,publicDomainName:X.default.publicDomainName,isMobile:o.device.isMobile,protocol:X.default.protocol,currentUrl:window.location.href}),s="page"===a.name?(0,w.nR)({pageId:a.blockId,peekViewBlockId:a.peekViewBlockId,peekMode:a.peekMode,discussionId:a.discussionId,scrollToBlockId:a.scrollToBlockId,collectionViewId:a.collectionViewId}):t;Ue.Be({environment:o,store:r.store,selection:r.selection,type:"a",transaction:n}),Ue.i8({environment:o,store:r.store,selection:r.selection,annotation:["a",s],transaction:n}),Ne.Z5({store:r.store,selection:{startIndex:i?r.selection.startIndex:r.selection.endIndex,endIndex:r.selection.endIndex}})}const nn=/\<\!-- wp:/;const on=/\u2028/g;function rn(e){var t;let{environment:n,event:o,disableEmbedMenu:r,transaction:i,onPasteFiles:a,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c}=e;if(o.preventDefault(),Ne.Zk(n),!o.clipboardData)return;if(!Ie.M_(n))return;const d=kt(o.clipboardData,n.device),u=Array.from(Array((null===(t=d.items)||void 0===t?void 0:t.length)??0).keys()).flatMap((e=>{var t;const n=d.items[e];if("file"!==n.kind)return[];const o=null===(t=n.getAsFile())||void 0===t||null===(t=t.name.match(/\.[^.]+$/))||void 0===t?void 0:t[0];return o?[o]:[]}));Ce.VJ(n,{source:"editor",types:d.types||[],fileExtensions:u,htmlContent:d.getData("text/html")});const{text:p,html:m,multiTextSelectionData:f,textSelectionData:g,blockSelectionData:h,isFromMicrosoftOffice:b,isHtmlTable:y}=xt({clipboardData:d,tinyMceMicrosoftWordPasteFilter:c}),S=Ct(d,dt,ht),w=Et(o),k=Xt(ke.default.state),I=(null==h?void 0:h.action)||(null==f?void 0:f.action)||(null==g?void 0:g.action);i.annotateWithUserAction("cut"===I?"paste.from_cut":te.xF);const C=p.includes("\n"),x=function(e){const t=Ct(e,ut,vt),n=null==t?void 0:t.mode;if(!n)return;return at[n]||"Plain Text"}(d),T=C&&x&&"inline"!==k&&!(0,pe.qK)()?function(e){const{codeLanguage:t,environment:n,transaction:o}=e,r=ke.default.state,i="editing"===r.mode&&r.multiSelection,a=we.default.state.stores;if(!i&&0===a.length)return;let s,c,d;i?(s=i.start.store,c=i.end.store,d=(0,ce.sQ)(c)):(s=a[0],c=a[a.length-1],d=c);if(!d)return;let u=d;if((0,le.PF)(d))!function(e){const{block:t,environment:n,transaction:o,codeLanguage:r}=e;Le.Cj({environment:n,blocks:[t],blockType:"code",transaction:o}),He.E5({blocks:[t],language:r,transaction:o})}({block:d,environment:n,transaction:o,codeLanguage:t});else{const e=(0,ce.sQ)(d);if(!e)return;const t=s.inMemoryRecordCache;if(!t)return;u=$e.j4({environment:n,type:l.Ti.code,inMemoryRecordCache:t,transaction:o,spaceId:e.pointer.spaceId,useCrdt:e.useCrdt()}),$.BE({parent:e.getContentStore(),after:c,insert:u,transaction:o})}ue.clear(n);const p=(0,ce.mh)(u);p&&Ne.N_({store:p});return u}({codeLanguage:x,environment:n,transaction:i}):void 0;Te.bO(n,{pastedText:p,source:"editor_paste"});const M=fe.g$.getSimpleTableCellFromTextSelection(),P=o.clipboardData.getData(Q.mH),A=Jt();if(w.length>0&&!b&&!y)ot("paste: file/image detected -> onPasteFiles"),a({environment:n,files:w,transaction:i});else if("body"!==(0,pe.qK)()||g)if(T)ot("paste: pasting code in existing empty text block with no selection or new code block after selection  -> pasteRawText"),an(n,p,i);else if(A){ot("paste: formulaInformation detected, attempting to paste as formula");const{parentCollection:e,start:t}=A,o=[[p]],r=e;if(!r)return void an(n,p,i);const a=ke.default.state;"multiSelection"in a&&Ue.pz({environment:n,multiSelection:a.multiSelection,transaction:i});const s=(0,v.UQ)(o,r,A.getRecordModel);Ue.mM({environment:n,tokens:s,store:t.store,index:t.index,transaction:i})}else if(f){ot("paste: multiTextSelectionData detected, attempting to paste as textselection");const e=function(e){const{environment:t,transaction:n,multiTextSelectionData:o,disableEmbedMenu:r,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a}=e,s=e.pasteBehavior||"inline",l=e.html||Mt({markdown:e.text,markdownLinkifyIt:i});if("editing"===ke.default.state.mode)switch(s){case"inline":return!!l&&(Ht({environment:t,html:l,transaction:n,stripText:!1,disableEmbedMenu:r,markdownLinkifyIt:i,tinyMceMicrosoftWordPasteFilter:a}),!0);case"block":return je({environment:t,clipboardData:o,transaction:n,developerDebug:ot});default:(0,H.t1)(s)}}({multiTextSelectionData:f,environment:n,html:m,text:p,transaction:i,disableEmbedMenu:r,pasteBehavior:k,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c});e||(ot("paste: could not paste as textSelection -> paste as blockSelection"),Nt(n,f.blockSelection,S,i))}else if(g&&g.editing)ot("paste: textSelectionData detected, pasting text selection"),function(e){const{environment:t,textSelectionData:n,transaction:o,disableEmbedMenu:r}=e,i=we.default.getCurrentRecordCache(),{editing:a,selection:s}=n;let{tokensInsideRange:c}=j.xrQ(a,s.startIndex,s.endIndex);c=j.OAI(c);const d=(0,ee.RM)();if(d&&!(d.isInsideTemplate()||en()||d.isInsideFactoryOrDuplicateBlocksAction())&&(c=j.KV2(c,{currentUserId:t.currentUser.id,currentTimeZone:(0,_.r)()})),"body"===(0,pe.qK)()){const e=j.vNd(c);e&&(c=e)}const u="editing"===ke.default.state.mode&&ke.default.state.multiSelection;if(u){Ue.pz({environment:t,multiSelection:u,transaction:o});const e=ke.default.state;if("editing"===e.mode){const i=e.multiSelection;if(n.blockType&&0===s.startIndex){const e=(0,ce.sQ)(i.start.store);e&&"page"!==n.blockType&&(0,le.PF)(e)&&Le.Cj({environment:t,blocks:[e],blockType:n.blockType,transaction:o})}Zt({environment:t,store:i.end.store,tokens:c,index:i.end.index,transaction:o,disableEmbedMenu:r,multiTextSelection:u})}}else if(i){var p,m;const e=we.default.state.stores,n=$e.j4({environment:t,type:l.Ti.text,inMemoryRecordCache:i,transaction:o,spaceId:0!==e.length?e[e.length-1].pointer.spaceId:null===(p=ee.RM())||void 0===p?void 0:p.pointer.spaceId,useCrdt:0!==e.length?e[e.length-1].useCrdt():(null===(m=ee.RM())||void 0===m?void 0:m.useCrdt())??!1}),r=n.getTitleStore();r&&Ue.mM({environment:t,store:r,tokens:c,index:0,transaction:o}),xe.W(t,{from:"paste",type:l.Ti.text,creating_block_id:n.id}),Ut({environment:t,blocks:[n],transaction:o,replaceEmptyTextBlock:!1})}}({environment:n,textSelectionData:g,transaction:i,disableEmbedMenu:r});else if(h&&h.blocks.length>0&&"inline"!==k)ot("paste: blockSelectionData detected, pasting block selection"),Nt(n,h,S,i);else if(M&&P){const{simpleTableStore:e,selection:t}=M.getProps(),r=fe.g$.getColumnOrder(e);t&&r&&Je.j0({environment:n,simpleTableStore:e,selection:t,currentRows:e.getContentStores(),columnOrder:r,event:o,transaction:i,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c})}else if(m)if(M){const{simpleTableStore:e,selection:t}=M.getProps(),r=fe.g$.getColumnOrder(e);t&&r&&(ot("paste: pasting selection into simple table"),Je.j0({environment:n,simpleTableStore:e,selection:t,currentRows:e.getContentStores(),columnOrder:r,event:o,transaction:i,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c}))}else(C||y)&&"inline"!==k?(ot("paste: pasting as html"),Wt({environment:n,html:m,transaction:i,tinyMceMicrosoftWordPasteFilter:c})):(ot("paste: pasting as inline html"),Ht({environment:n,html:m,transaction:i,stripText:!1,disableEmbedMenu:r,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c}));else ot("paste: pasting as markdown"),Lt({environment:n,text:p,disableEmbedMenu:r,transaction:i,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:c});else ot("paste: editing code block contents with no Notion text selection -> pasteRawText"),an(n,p,i);_e.Z.setKeyboardMode(!0)}function an(e,t,n){const o="editing"===ke.default.state.mode&&ke.default.state.multiSelection;o&&Ue.hJ({environment:e,multiSelection:o,string:t,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:n})}function sn(e){const t=e.getNavigableBlockStore();if(t)return(0,oe.Hu)({store:t,scrollToBlockId:t.id===e.id?void 0:e.id,fullyQualified:!0,pageVisitSource:s.tY.CopyLink})}function ln(e){const{environment:t,blocks:n}=e,o=n[0];Y.wG(),fe.HM.clearSelection();const r=sn(o);if(r){mn({environment:t,stringValue:r,copiedMessage:o.isPageBlock()?it.copiedLinkToClipboard:it.copiedBlockLinkToClipboard})}}function cn(e){const{environment:t,blocks:n}=e,o=n[0];Y.wG(),fe.HM.clearSelection();const r=sn(o),i=function(e,t){var n;const o=sn(t);if(!o)return;const r=e.currentUser.id,i=(0,f.Ho)({blockId:t.id,intl:re.default.getIntl(),getRecordValue:t.inMemoryRecordCache.makeGetRecordValueFn(r),userTimeZone:(0,_.r)()}),a=null===(n=t.getBlockIconStore())||void 0===n?void 0:n.getValue(),s=[(0,k.Z)(a)?a:void 0,i].filter(H.$K).join(" ");return s?`<a href="${o}"><span>${s}</span></a>`:o}(t,o);if(r&&i){pn({environment:t,stringValue:r,htmlValue:i,copiedMessage:it.copiedLinkToClipboard})}}function dn(e){const{environment:t,blocks:n}=e;if(n.length<2)return ln(e);Y.wG(),fe.HM.clearSelection();const o=n.map(sn).filter(H.$K);if(o.some(Boolean)){const e=o.length>1?it.copiedLinksToClipboard:it.copiedLinkToClipboard;mn({environment:t,stringValue:o.join("\n\n"),copiedMessage:e})}}function un(e){const{environment:t,blocks:n}=e,o=n[0];if(!o.isDefined())return;const r=o.getModel(),i=o.getProperties(),a=o.getFormat();let s;if(o.isType(l.Ti.bookmark))s=null==i?void 0:i.link,s=j.QaF(s);else if(r.isType(l.Ok))s=null==i?void 0:i.source,s=j.QaF(s);else if(o.isType(l.Ti.file))s=null==i?void 0:i.source,s=j.QaF(s);else if(o.isType(l.Ti.externalObjectInstance)||o.isType(l.Ti.externalObjectInstancePage))s=(null==a?void 0:a.original_url)||(null==a?void 0:a.uri);else if(o.isType(l.Ti.collectionView)){var c;const e=null===(c=o.getCollectionViewCollectionStore())||void 0===c?void 0:c.getValue();var d;if(e&&(0,g.Gq)(e))s=null===(d=e.format)||void 0===d?void 0:d.original_url}else{if(!o.isType(l.Ti.alias))return;s=null==a?void 0:a.comment_alias_url}if(!s)return;if(h.E$(s,[X.default.secureFileS3.url,X.default.secureFileS3V2.url]))return void b.log({level:"error",from:"clipboardActions",type:"copyDirectLinkToContent",error:{message:"Attempted to copy a direct signed url for S3-housed content."}});if(s=W.yn(s),!s)return;Y.wG(),fe.HM.clearSelection();mn({environment:t,stringValue:s,copiedMessage:it.copiedLinkToClipboard})}function pn(e){return fn(e)}function mn(e){return fn(e)}async function fn(e){const{environment:t,htmlValue:n,stringValue:o,copiedMessage:r,showCopyModal:i}=e;function a(){Ye.ZH(t),he.Z.setState({...he.Z.state,active:!0,stringValue:o})}if(i)a();else try{if("undefined"==typeof ClipboardItem)await navigator.clipboard.writeText(o);else{const e={"text/plain":new Blob([o],{type:"text/plain"})};n&&(e["text/html"]=new Blob([n],{type:"text/html"}));const t=new ClipboardItem(e);await navigator.clipboard.write([t])}Xe.oV({label:re.default.formatMessage(r)})}catch{a()}}function gn(){document.queryCommandSupported("copy")&&document.execCommand("copy")}async function hn(e,t){let n;n="string"==typeof t?t:JSON.stringify(t),n&&await mn({environment:e,stringValue:n,copiedMessage:it.copiedToClipboard})}function vn(e){const{environment:t,textSelection:n,markdownSerializationOptions:o,markdownLinkifyIt:r}=e,i=(0,ie.QY)(n);if(i&&i.selection.startIndex!==i.selection.endIndex)return function(e){const{environment:t,singleStoreTextSelection:n,markdownSerializationOptions:o}=e,{store:r,selection:i}=n,a=t.currentUser.id,l=r.inMemoryRecordCache,c=re.default.getIntl(),d=r.getValue(),p=j.KU1(d,i.startIndex,i.endIndex),m=r.getRecordStoreUIRoot().getValue();if(!m)return;const f={id:m.id,table:Z.iU,spaceId:m.space_id},g=l.makeGetRecordValueFn(a);return x.CK({textValue:p,exportArgs:{root:f,navigableBlockId:f.id,renderParentBlockId:void 0,blockId:f.id,userTimeZone:(0,_.r)(),intl:c,getRecordValue:g,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>{let{toPageId:t}=e;return(0,u.Z)({pageId:t,pageValue:g({table:Z.iU,id:t}),baseUrl:X.default.domainBaseUrl,pageVisitSource:s.tY.Export})},baseUrl:X.default.domainBaseUrl,publicDomainName:X.default.publicDomainName,transformAnnotation:null==o?void 0:o.transformAnnotation,transformBlockMapping:null==o?void 0:o.transformBlockMapping,resultCache:new Map}})}({environment:t,singleStoreTextSelection:i,markdownSerializationOptions:o});const a=Rt({environment:t,multiSelection:n,action:"copy"});if(!a)return;const l=n.start.store.inMemoryRecordCache,c=n.start.store.getRecordStoreUIRoot().getValue();if(!c)return;const d=t.currentUser.id,{markdown:p}=(0,te.Ef)({clipboardData:a,rootBlock:{id:c.id,table:Z.iU,spaceId:c.space_id},isWindows:t.device.isWindows,fallbackGetRecordValue:l.makeGetRecordValueFn(d),markdownSerializationOptions:o,markdownLinkifyIt:r});return p}function bn(e){const{environment:t,inMemoryRecordCache:n,text:o,transaction:r,markdownOptions:i,markdownLinkifyIt:s,tinyMceMicrosoftWordPasteFilter:l,useCrdt:c}=e,d=Mt({markdown:o,markdownOptions:i,markdownLinkifyIt:s});if(!d)return;const u=document.createElement("div");u.innerHTML=Qt({html:d,tinyMceMicrosoftWordPasteFilter:l});const{currentUserStore:p,currentSpaceStore:m}=ge.default.state;if(!p||!m)return;const f=p.getValue();if(!f)return;const g=(ee.RM()??m).id,{allOperations:h,rootContentIds:v}=S.$O({actor:(0,a.dp)(f),parentId:g,parentTable:"block",spaceId:m.id,rootNode:u,importFileMap:{},window,secureFileS3Url:X.default.secureFileS3.url,secureFileS3UrlV2:X.default.secureFileS3V2.url,ignoreBlockCount:!1,intl:re.default.getIntl(),randomID:R.ZP,randomShortID:D.ZP,isPhoneNumber:Yt,emojiData:J.Z.state,useCrdt:c});for(const a of h){const e=new Se.ST({environment:t,pointer:a.pointer,inMemoryRecordCache:n,userId:f.id});et.applyOperation({store:e,operation:a,transaction:r})}return v.map((e=>new Se.G(t,{table:Z.iU,id:e},{inMemoryRecordCache:n})))}function yn(e){const{environment:t,stores:n,listId:o,inMemoryRecordCache:r,transaction:i}=e,a=new Se.ST({environment:t,pointer:{table:Z.iU,id:o||(0,R.ZP)()},inMemoryRecordCache:r,userId:t.currentUser.id,path:["content"]});for(const s of n)$.R3({parent:a,append:s,transaction:i}),$e.sW({store:s,data:{parent_id:a.id,parent_table:a.table,alive:!0},transaction:i});return a}},42274:(e,t,n)=>{n.d(t,{XQ:()=>d,Cn:()=>u,pZ:()=>c,E5:()=>l});const o={TypeScript:async()=>({plugins:[(await n.e(8182).then(n.t.bind(n,90119,23))).default],parser:"babel"}),JavaScript:async()=>({plugins:[(await n.e(8182).then(n.t.bind(n,90119,23))).default],parser:"babel"}),GraphQL:async()=>({plugins:[(await n.e(214).then(n.t.bind(n,80214,23))).default],parser:"graphql"}),HTML:async()=>({plugins:[(await n.e(2237).then(n.t.bind(n,72237,23))).default],parser:"html"}),CSS:async()=>({plugins:[(await n.e(5657).then(n.t.bind(n,45657,23))).default],parser:"css"}),Scss:async()=>({plugins:[(await n.e(5657).then(n.t.bind(n,45657,23))).default],parser:"scss"}),JSON:async()=>({plugins:[(await n.e(8182).then(n.t.bind(n,90119,23))).default],parser:"json"}),XML:async()=>({plugins:[await Promise.all([n.e(9236),n.e(4219)]).then(n.t.bind(n,84219,23))],parser:"xml",prettierOptionsOverride:{xmlWhitespaceSensitivity:"ignore"}}),Rust:async()=>({plugins:[await Promise.all([n.e(9236),n.e(3411)]).then(n.bind(n,73411))],parser:"jinx-rust"})};var r=n(70203),i=n(96802),a=n(9953),s=n(82530);function l(e){const{blocks:t,language:n,transaction:o}=e,i=r.TPx(n);for(const r of t)a.sW({store:r.getPropertiesStore(),data:{language:i},transaction:o})}function c(e){const{environment:t,blocks:n,previewFormat:o}=e;s.createAndCommit({userAction:"codeBlockActions.setPersistedCodePreviewFormat",environment:t,perform:e=>{i.FH({stores:n,update:{code_preview_format:o},transaction:e})}})}async function d(e){const{codeSnippet:t,language:r}=e,i=o[r];if(!i)return;const{parser:a,plugins:s,prettierOptionsOverride:l}=await i();let c="";try{c=(await n.e(3945).then(n.t.bind(n,73945,23))).format(t,{parser:a,plugins:s,...l})}finally{if(!c||c===t)return}return c=function(e){const t=e.split("\n");t.length>0&&""===t[t.length-1].trim()&&t.pop();return t.join("\n")}(c),c}async function u(e){const{codeBlock:t,environment:n}=e,{title:o,language:i}=t.getProperties(),l=r.QaF(o);if(!l||0===l.length)return;const c=r.QaF(i),u=await d({codeSnippet:l,language:c});if(!u)return;const p=r.TPx(u);s.createAndCommit({userAction:"codeBlockActions.formatCode",environment:n,perform:e=>{a.sW({store:t.getPropertiesStore(),data:{title:p},transaction:e})}})}},74882:(e,t,n)=>{n.d(t,{K:()=>a});var o=n(68626),r=n(6287),i=n(54642);async function a(e){const{environment:t,collectionStore:n}=e,a={id:n.id,table:r.v,spaceId:n.getSpaceId()},s=await i.suggestRecordKey(t,{...a,shouldSetSuccessfullySuggestedRecord:!0});if("success"===s.type)return s.data.key;o.log({level:"error",from:"collectionAutoIncrementIdActions.suggestRecordKeyResponse",type:"JSONParseError",error:{miscDataString:s.error.message}})}},34993:(e,t,n)=>{n.d(t,{mO:()=>w,Ys:()=>k,k7:()=>I,ul:()=>M,iU:()=>C,RD:()=>T,_x:()=>x});n(67294);var o=n(1302),r=n(76205),i=n(14714),a=n(72126),s=n(97880),l=n(64964),c=n(75330),d=n(480),u=n(9291),p=n(52423),m=n(6854),f=n(85893);function g(){return(0,f.jsx)(u.FormattedMessage,{defaultMessage:"Changes saved for everyone.",id:"database.filterBar.saved.title"})}function h(e){window.__c={n:"SaveChangesSnackbarUndoButton"};const{collectionContextStore:t,temporaryState:n}=e,o=(0,d.O7)();return(0,f.jsx)(m.Pn,{onClick:()=>{p.Yw(o,!0),l.rN(),C({environment:o,collectionContextStore:t,temporaryState:n})},children:(0,f.jsx)(u.FormattedMessage,{defaultMessage:"Undo",id:"database.filterBar.undo.title"})})}var v=n(97004),b=n(80444),y=n(5149),_=n(82530),S=n(37181);let w=function(e){return e[e.All=0]="All",e[e.Filters=1]="Filters",e[e.Sorts=2]="Sorts",e}({});function k(e){const{environment:t,collectionContextStore:n,targetCollectionView:o,preventSnackbarNotification:r,type:i,transaction:a}=e,s=n.temporaryState.state,d=n.currentPropertyFiltersStore.state,u=o.getPropertyFiltersStore(),p=(0,v.Zh)(n,"persisted");if(i===w.All||i===w.Filters){p.combinatorFilter&&c.Es({collectionViewStore:o,update:{filter:p.combinatorFilter.value||null},transaction:a});for(const e of p.filters.removed)_.applyOperation({store:u,operation:{pointer:u.pointer,command:"keyedObjectListRemove",path:u.path,args:{remove:{id:e}}},transaction:a});for(const{id:e,beforeId:t}of p.filters.moveOps){const n=d.find((t=>t.id===e));n&&(t?_.applyOperation({store:u,operation:{pointer:u.pointer,command:"keyedObjectListBefore",path:u.path,args:{before:{id:t},value:n}},transaction:a}):_.applyOperation({store:u,operation:{pointer:u.pointer,command:"keyedObjectListAfter",path:u.path,args:{value:n}},transaction:a}))}for(const e of p.filters.updated){const t=d.find((t=>t.id===e));t&&_.applyOperation({store:u,operation:{pointer:u.pointer,command:"keyedObjectListUpdate",path:u.path,args:{value:t}},transaction:a})}}i!==w.All&&i!==w.Sorts||!p.sorts||c.Es({collectionViewStore:o,update:{sort:p.sorts.value||null},transaction:a}),x({environment:t,collectionContextStore:n,temporaryState:i===w.All?void 0:i===w.Filters?{...s,combinatorFilter:void 0,propertyFilters:void 0}:{...s,sorts:void 0}}),r||l.oV({label:(0,f.jsx)(g,{}),right:(0,f.jsx)(h,{collectionContextStore:n,temporaryState:s})})}function I(e){const{environment:t,intl:n,collectionContextStore:r,transaction:i}=e,a=r.collectionViewStore(),s=r.isFullScreen.state,l=r.isRootChild.state,d=r.isInPeekRenderer.state;if(!a)return;const u=c.tG({environment:t,collectionContextStore:r,collectionViewStore:a,intl:n,collectionSettingsStore:r.settingsStore,transaction:i});u&&(k({environment:t,type:w.All,collectionContextStore:r,targetCollectionView:u,transaction:i}),u&&(c.f8({environment:t,collectionContextStore:r,collectionViewId:u.id,isFullScreen:s,isRootChild:l,isInPeekRenderer:d}),o.default.afterNextFlush((()=>{y.r$({collectionContextStore:r,collectionSettingsStore:r.settingsStore,selectViewNameInitial:!0})}))))}function C(e){x(e),function(e){const{environment:t,collectionContextStore:n}=e,o=n.collectionViewStore();if(!o)return;n.blockIsPrivateStore.state&&n.permissionScopes.state.canConfigureBlock&&_.createAndCommit({userAction:"collectionFilterActions.applyTemporaryStateIfPrivate",environment:t,perform:e=>{k({environment:t,collectionContextStore:n,type:w.All,targetCollectionView:o,preventSnackbarNotification:!0,transaction:e})}})}(e)}function x(e){const{environment:t,collectionContextStore:n,temporaryState:o}=e,r=n.collectionViewStore();if(!r)return;const i=t.currentUser.id;n.temporaryState.setState(o||{}),c.bu({currentUserId:i,collectionViewId:r.id,temporaryState:o}),n.groupsStore.resetAllLimits()}function T(e){const{environment:t,seen:n}=e,{currentUserSettingsStore:o}=b.default.state;o&&_.createAndCommit({userAction:"collectionFilterActions.setSeenFiltersIntroTooltip",environment:t,perform:e=>{S.d2({userSettingsStore:o,transaction:e,data:{seen_filters_tooltip:n}})}})}function M(e){var t;let{transaction:n,newGroups:o,collectionContextStore:l,environment:c}=e;const d=l.collectionViewStore(),u=l.currentCombinatorFilterStore.state,p=(0,a.Xh)(u),m=null==p||null===(t=p.filters)||void 0===t?void 0:t.find(r.s9),f=(0,v.yU)(l);if(!(d&&p&&p.filters&&m))return;const g=m.filter.value.filter((e=>"exact"===e.type)).map((e=>e.value)).filter(s.$K),h=o.map((e=>e.value)).filter(i.tL).map((e=>e.value)).filter(i.RA).map((e=>e.id)),b=(0,a.zu)(h,...g);0!==b.length&&(m.filter.value=[...m.filter.value,...b.map((e=>({type:"exact",value:e})))],x({environment:c,collectionContextStore:l,temporaryState:{...l.temporaryState.state,combinatorFilter:{value:p}}}),f||k({environment:c,collectionContextStore:l,type:w.Filters,targetCollectionView:d,preventSnackbarNotification:!0,transaction:n}))}},54569:(e,t,n)=>{n.d(t,{$D:()=>be,$T:()=>oe,A6:()=>ue,BN:()=>te,BO:()=>ce,ID:()=>Ie,IW:()=>de,Od:()=>ne,V$:()=>_e,by:()=>ae,hz:()=>pe,iE:()=>me,mp:()=>re,o3:()=>ve,tH:()=>ke,tQ:()=>se,uo:()=>Se,w$:()=>we,yk:()=>fe});n(57658);var o=n(15145),r=n(92996),i=n(41432),a=n(14248),s=n(14714),l=n(99036),c=n(93824),d=n(43593),u=n(42875),p=n(15157),m=n(72126),f=n(21202),g=n(6287),h=n(23867),v=n(70203),b=n(95371),y=n(97880),_=n(9291),S=n(75330),w=n(10906),k=n(28020),I=n(97004),C=n(75079),x=n(92918),T=n(65183),M=n(77181),P=n(33929),A=n(18245),R=n(80444),D=n(55367),E=n(79797),B=n(8406),F=n(952),O=n(54642),Z=n(34993),V=n(98834),U=n(30188),N=n(47307),L=n(42239),j=n(31781),z=n(96802),q=n(94419),H=n(19785),W=n(9953),K=n(79978),G=n(26999),$=n(42858),Q=n(24677),Y=n(82530),X=n(27370),J=n(37181);const ee=(0,_.defineMessages)({removeSortingConfirmation:{id:"databaseActions.removeSortingConfirmationDialog.prompt",defaultMessage:"Would you like to remove sorting?"},removeSortingButton:{id:"databaseActions.removeSortingConfirmationDialog.removeSortingButton.label",defaultMessage:"Remove"},removeSortingCancel:{id:"databaseActions.removeSortingConfirmationDialog.cancelRemoveSortingButton.label",defaultMessage:"Don't remove"}});function te(e){const{store:t,groupsPointer:n,environment:o,collectionContextStore:r,transaction:i}=e;if(!t.isDefined())return;const s=r.normalizedSchemaStore.state,l=r.relativeVariableStore.state,c=new Map;for(const d of n){const e=a.ND({block:t.getModel(),schema:s,propertyMapping:void 0,userFilterContext:{userId:o.currentUser.id,userTimeZone:(0,u.r)(),userStartOfWeek:k.AK.state},group:d,getRecordModel:t.getRecordModel,intl:P.default.getIntl(),relativeVariableResult:l,resultCache:c});Object.keys(e).length>0&&W.sW({store:t.getPropertiesStore(),data:e,transaction:i})}}function ne(e){const{store:t,transaction:n}=e;H.hh({childStore:t,transaction:n})}function oe(e){var t,n;const{environment:o,collectionContextStore:r,before:i,insertStores:a,store:s,groupsPointer:l,transaction:c}=e,d=r.collectionViewStore(),u=(null===(t=r.groupsStore.getGroupState(l))||void 0===t?void 0:t.resultsStore.state)||[],p=null===(n=r.groupsStore.getGroupState(l))||void 0===n?void 0:n.groupUiParentStore;if(!p)return[];const m=[];for(const b of a){const t=e.collectionStore??b.getAssociatedCollectionStore();t&&(re({environment:o,store:b,collectionStore:t,collectionContextStore:r,groupsPointer:l,shouldCoerce:!0,transaction:c}),m.push(E.G.createChildStore(p,{table:f.iU,id:b.id})))}const g=u.indexOf(s),h=i?g:g+1,v=[...u.slice(0,h),...m,...u.slice(h)];return d&&ie({resultIds:v.map((e=>e.id)),collectionViewStore:d,collectionContextStore:r,transaction:c}),r.groupsStore.setLimitIfGreater(l,v.length),m}function re(e){var t;const{environment:n,store:o,collectionStore:r,collectionContextStore:s,groupsPointer:c,transaction:d,shouldCoerce:p,alreadyMovedToCollection:f}=e,g=r.getSchema(),h=r.getParentBlockStore(),v=h&&h.isLocked();let b=!p;const y=(null==s||null===(t=s.groupsStore.getGroupState(c))||void 0===t?void 0:t.resultsStore.state)||[];if(o.isDefined()){var _,C;const e=f?(0,l.Kc)(P.default.getIntl()):o.getSchema()||{},t=null===(_=o.getAssociatedCollectionStore())||void 0===_?void 0:_.getDatabaseType(),i=r.getDatabaseType(),s=void 0!==t&&t===i,c=a.Xq({blockProperties:o.getProperties(),oldSchema:e,oldPropertyMapping:null===(C=o.getAssociatedCollectionStore())||void 0===C?void 0:C.getPropertyMapping(),newPropertyMapping:r.getPropertyMapping(),newSchema:g,typesMatch:s});c.propertyUpdate&&Object.keys(c.propertyUpdate).length>0&&W.sW({store:o.getPropertiesStore(),data:c.propertyUpdate,transaction:d}),m.Xy(g,c.newSchema)||v||!w.eD({collectionStore:r,collectionViewBlockStore:h,checkNavigableAncestorLocked:!1})||S.Rm({environment:n,collectionStore:r,update:{schema:c.newSchema},transaction:d})}if(o.getType()===i.Ti.page||o.getType()===i.Ti.collectionViewPage&&o.isAssociatedCollectionAPageTree()||r.isPageTreeCollection()||o.getType()===i.Ti.copyIndicator||o.getType()===i.Ti.externalObjectInstancePage||W.sW({store:o,data:{type:i.Ti.page},transaction:d}),s){if(s.collectionViewStore()){const e=o.getModel(),t=s.relativeVariableStore.state,i=(0,I.ze)(s,!1);if(e&&p){const l=o.getAssociatedCollectionStore(),p="collectionTypedView"===s.contextType&&l?l.getSchema():s.normalizedSchemaStore.state,m=a.RA({block:e,schema:p,propertyMapping:r.getPropertyMapping(),filter:i,userFilterContext:{userId:n.currentUser.id,userTimeZone:(0,u.r)(),userStartOfWeek:k.AK.state},relativeVariableResult:t,groupsPointer:c,getRecordModel:r.getRecordModel,intl:P.default.getIntl(),resultCache:new Map}),f=m.update;Object.keys(f).length>0&&W.sW({store:o.getPropertiesStore(),data:f,transaction:d}),b=m.coercionSucceeded}}}const x="collectionTypedView"===(null==s?void 0:s.contextType)&&w.fm(o)===s;if(f||x?Y.applyOperation({store:o,operation:{pointer:o.pointer,path:["alive"],command:"set",args:!0},transaction:d}):H.zw({childStore:o,parentStore:r,transaction:d}),s&&s.resultSet.addLocalChange([o.id]),s){var T;const e=null===(T=s.groupsStore.getGroupState(c))||void 0===T?void 0:T.currentLimit;if(e){const t=e.state,n=y.find((e=>e.id===o.id));y.length>=t&&!n&&e.setState(y.length+1)}}return b}function ie(e){const{resultIds:t,collectionViewStore:n,collectionContextStore:o,transaction:r}=e,i=n.getPageSortStore(),a=i.getValue()||[],{beforeOps:s}=(0,c.q)(a,t.slice(0,l.gq));for(const[l,c]of Object.entries(s))if(c){const e=(0,E.Kv)(n,{table:f.iU,id:c});q.Vt({parent:i,insert:(0,E.Kv)(n,{table:f.iU,id:l}),before:e,transaction:r})}else{const e=t.findIndex((e=>e===l)),o=t[e-1],a=o?(0,E.Kv)(n,{table:f.iU,id:o}):void 0;q.BE({parent:i,insert:(0,E.Kv)(n,{table:f.iU,id:l}),after:a,transaction:r})}!function(e){const{collectionContextStore:t,collectionViewStore:n,transaction:o}=e,r=n.getPageSortStore(),i=r.getValue(),a=t.groupsStore.getAllGroupStates(),s=new Set(a.flatMap((e=>e.resultsStore.state.map((e=>e.id))))),c=function(e){const{pageSort:t,currentResults:n}=e;if(!t||t.length<=l.gq)return[];const o=t.filter((e=>!n.has(e))),r=m.jj([...o.reverse(),...m.d9(t).reverse()]).slice(0,t.length-l.gq);return r}({pageSort:i,currentResults:s});for(const l of c)q.Od({parent:r,childToRemove:(0,E.Kv)(r,{table:f.iU,id:l}),transaction:o})}({collectionContextStore:o,collectionViewStore:n,transaction:r})}function ae(e){var t,n,o;const{environment:i,collectionStore:a,targetStore:s,droppedDirection:c,droppedStores:d,transaction:u,duplicate:p,collectionContextStore:h,groupsPointer:v,subitemPath:y}=e,_=h.collectionViewStore();if(!_)return;if(!(null===(t=h.groupsStore.getGroupState(v))||void 0===t?void 0:t.groupUiParentStore))return;const S=(null===(n=h.groupsStore.getGroupState(v))||void 0===n?void 0:n.resultsStore.state)||[],w=d.every((e=>e.isExternalObjectInstancePageBlockStore()))&&!(null!=a&&a.isSyncedCollection()&&(null===(o=d[0])||void 0===o?void 0:o.getParentId())===(null==a?void 0:a.id))||p;if(c===D.vh.Onto){Q.ZH(i);const e=s.getContentStore(),t=L.LQ({environment:i,droppedStores:d,duplicate:w,duplicateUseCrdt:s.useCrdt(),transaction:u,resolveTemplateVariables:!1});for(const n of t)q.R3({parent:e,append:n,transaction:u});return[]}let k=!1,I=[];if(!w&&a){const e=function(e){const{environment:t,droppedStores:n,collectionStore:o,transaction:r}=e,i=ve({environment:t,stores:n,spaceId:o.getSpaceId(),transaction:r});for(const a of i){if(a.getParentTable()===g.v||a.getAssociatedCollectionStore())return;if(!H.zw({childStore:a,parentStore:o,transaction:r}))return}return i}({environment:i,droppedStores:d,collectionStore:a,transaction:u});k=void 0!==e,I=e??[]}const C=L.LQ({environment:i,droppedStores:d,duplicate:w,duplicateUseCrdt:!1,transaction:u,resolveTemplateVariables:!1});k||(I=ve({environment:i,stores:C,spaceId:s.getSpaceId(),transaction:u})),u.postSubmitCallbacks.push((async e=>{!e&&a&&await U.YE({droppedStores:d,createdStores:C,collectionStore:a,environment:i,collectionContextStore:h,groupsPointer:v,alreadyMovedToCollection:k,shouldDuplicate:w})}));for(const r of I){const e=a??r.getAssociatedCollectionStore();e&&re({environment:i,store:r,collectionStore:e,collectionContextStore:h,groupsPointer:v,shouldCoerce:!0,transaction:u,alreadyMovedToCollection:k})}const x=(0,M.Af)([...(null==y?void 0:y.map((e=>e.value.store.pointer)))??[]]),T=h.subitemExpandedStore.state.get(x),P=y&&y.length>1||(null==T?void 0:T.isExpanded)&&c===D.vh.Below;a&&function(e){var t;const{environment:n,isInsertingAsSubitem:o,shouldDuplicate:r,collectionContextStore:i,collectionStore:a,droppedStores:s,wrappedStores:c,targetSubitemExpandedState:d,subitemPath:u,targetStore:p,transaction:m}=e,f=i.currentSubitemFormatStoreForCollection.state,g=null==f?void 0:f.inverse,h=g&&i.normalizedSchemaStore.state[g],v=null==f?void 0:f.property,y=v&&i.normalizedSchemaStore.state[v],_=null===(t=i.collectionViewStore())||void 0===t?void 0:t.getType(),S=f&&_&&(0,M.Av)(_)&&h&&(0,l.p_)(h),w=(0,M.g0)(s[0]);null!=w&&w.subitemFormat&&f&&y&&(0,l.p_)(y)&&U.i6({blocksToDuplicate:[...s],duplicatedBlocks:[...c],environment:n,shouldDuplicate:r,originSubitemFormat:w.subitemFormat,destinationSubitemFormat:f,transaction:m,subitemRelationSchema:y,relationPropertyCollectionId:a.id});const k=f?(0,M.Kg)(c,f):void 0,I=k?c.filter(((e,t)=>k.includes(t))):[];for(const l of I){if(S){const e=(0,M.xb)({store:l,subitemFormat:f,propertySchema:h});for(const t of e){const e=E.G.createChildStore(l,t);K.Bl({environment:n,sourceStore:e,destStore:l,propertyWithInverse:f,transaction:m})}}if(o){const e=null!=d&&d.isExpanded?"into":"below";ge({environment:n,collectionContextStore:i,collectionStore:a,subitemPath:u&&(null==u?void 0:u.length)>0?u:[new b.mp((0,M.SM)(p),[])],store:p,before:"into"===e,insertBlock:l,insertDirection:e,transaction:m})}}}({environment:i,isInsertingAsSubitem:Boolean(P),shouldDuplicate:w,collectionContextStore:h,collectionStore:a,droppedStores:d,wrappedStores:I,targetSubitemExpandedState:T,subitemPath:y,targetStore:s,transaction:u});const A=S.filter((e=>!C.includes(e))),B=A.indexOf(s),F=c===D.vh.Above||c===D.vh.Left?B:B+1;ie({resultIds:[...A.slice(0,F),...I,...A.slice(F)].map((e=>e.id)),collectionViewStore:_,collectionContextStore:h,transaction:u}),le({environment:i,collectionContextStore:h});const O=h.collectionViewBlockStore();if(!O)return;const Z=P?s:O,V=m.UI(I,(e=>E.G.createChildStore(Z,{table:f.iU,id:e.id})));return Q.Z5({environment:i,stores:V}),function(e,t){var n,o;const i=(null===(n=e.collectionViewStore())||void 0===n?void 0:n.getFormat().app_config_uri)===r.g3&&"sprint_board"===(null===(o=R.default.state.mainEditorCurrentBlockStore)||void 0===o?void 0:o.getFormat().special_page_for_pm_launch);i&&X.tutorialAdvanceToStepAfter(t,"sprints-onboarding","sprint-task-tooltip")}(h,u),V}function se(e){const{environment:t,collectionStore:n,targetStore:o,droppedDirection:r,files:i,transaction:a,collectionContextStore:s,groupsPointer:l}=e,c=s.collectionViewStore(),u=k.qQ(t);if(!c)return;const p=n.inMemoryRecordCache,m=j.z({environment:t,files:i,inMemoryRecordCache:p,pageWidth:u,transaction:a,spaceId:n.pointer.spaceId,useCrdt:!1}).map(((e,o)=>{const r=i[o],s=W.j4({environment:t,type:"page",inMemoryRecordCache:p,properties:{title:(0,v.TPx)(d.AA(r.name))},transaction:a,spaceId:n.pointer.spaceId,useCrdt:!1});return q.R3({parent:s.getContentStore(),append:e,transaction:a}),s}));ae({environment:t,collectionStore:n,targetStore:o,droppedDirection:r,collectionContextStore:s,groupsPointer:l,droppedStores:m,duplicate:!1,transaction:a})}function le(e){const{environment:t,collectionContextStore:n}=e,o=n.collectionViewBlockStore(),r=n.collectionViewStore();if(!r||!o)return!1;const i=n.currentViewHasSort(),a=r.getType(),s=n.permissionScopes.state;return!!(i&&a&&T.Km[a]&&s.canConfigureBlock)&&(N.showDialog({message:P.default.formatMessage(ee.removeSortingConfirmation),items:[{label:P.default.formatMessage(ee.removeSortingButton),color:"red",onAccept:()=>{Y.createAndCommit({userAction:"collectionGroupActions.offerToRemoveSort",environment:t,perform:e=>{S.Es({collectionViewStore:r,update:{sort:[]},transaction:e})}})}},{label:P.default.formatMessage(ee.removeSortingCancel),onAccept:()=>{}}],showCancel:!1,keepFocus:!0}),!0)}function ce(e){const{environment:t,droppedStores:n,duplicate:o,collectionContextStore:r,groupsPointer:i,transaction:a}=e,s=r.collectionStore(),l=r.collectionViewStore(),c=L.LQ({environment:t,droppedStores:n,duplicate:o,duplicateUseCrdt:!1,transaction:a,resolveTemplateVariables:!1});if(s)for(const d of c)re({environment:t,store:d,collectionStore:s,collectionContextStore:r,groupsPointer:i,shouldCoerce:!0,transaction:a});return l&&ie({resultIds:c.map((e=>e.id)),collectionViewStore:l,collectionContextStore:r,transaction:a}),a.postSubmitCallbacks.push((async e=>{!e&&s&&await U.YE({droppedStores:n,createdStores:c,collectionStore:s,environment:t,collectionContextStore:r,groupsPointer:i,shouldDuplicate:o})})),[]}function de(e){var t,n,o;const{environment:r,collectionContextStore:a,groupsPointer:s,insertAtIndex:l,shouldCoerce:c,initializeDefaultTemplate:d,transaction:u,from:p,tracker:m,useCrdt:g}=e,h=A.default.mark("collections.add_item_lag");A.default.measureAfterNextFlush(h,{environment:r,getData:()=>({...C.vS(a),from:p})});const v=null===(t=R.default.state.currentSpaceStore)||void 0===t?void 0:t.id,b=W.j4({environment:r,type:i.Ti.page,inMemoryRecordCache:r.defaultRecordCache.inMemoryRecordCache,transaction:u,spaceId:v,tracker:m,useCrdt:g??!1}),y=a.collectionStoresStore.state,_=a.databaseType,S="collectionTypedView"===a.contextType,w=y.find((e=>e.canEdit()||e.canEditCollection()||e.canEditContentOnly()))||y[0],k=R.default.state.currentUserSettingsStore;!S&&_&&w&&J.zq({transaction:u,dbType:_,collectionId:w.id});const I=S&&_&&v&&k&&k.getPreferredCollections(v,_)||[];let x;for(const i of I){const e=y.find((e=>e.id===i&&(e.canEdit()||e.canEditCollection()||e.canEditContentOnly())));e&&(x=e)}const T=x??w,M=a.collectionViewStore(),P=a.getViewType();if(!T||!M||!P)return{coercionSucceeded:!0,newStore:b};const D=null===(n=a.groupsStore.getGroupState(s))||void 0===n?void 0:n.groupUiParentStore;if(!D)return{coercionSucceeded:!0,newStore:b};const B=E.G.createChildStore(D,{table:f.iU,id:b.id});if(d){const e=a.defaultPageTemplateStore.state;e&&V.ob({title:"template",environment:r,store:b,templateStore:e,isKeyboard:!1,isCreateIn:!1,transaction:u,from:"collection_group_actions"})}const F=re({environment:r,store:b,collectionStore:T,collectionContextStore:a,groupsPointer:s,shouldCoerce:c,transaction:u}),O=(null===(o=a.groupsStore.getGroupState(s))||void 0===o||null===(o=o.reducerResultStore.state)||void 0===o?void 0:o.blockIds)||[],Z=void 0!==l?l:O.length;if(a.permissionScopes.state.canEditContent){ie({resultIds:[...O.slice(0,Z),B.id,...O.slice(Z)],collectionViewStore:M,collectionContextStore:a,transaction:u})}return{coercionSucceeded:F,newStore:B}}function ue(e){const{collectionContextStore:t,newGroups:n,groupsFormatKey:o,transaction:r}=e,i=t.collectionViewStore();i&&z.FH({stores:[i],update:{[o]:n},transaction:r})}function pe(e){const{environment:t,collectionStore:n,property:o,oldValue:r,newValue:i,transaction:s}=e,l=n.getSchema(),c=t.currentUser.id;n.inMemoryRecordCache.forEachRecord(c,(e=>{var t;let{model:c}=e;if(c.table!==f.iU)return;const d=E.G.createChildStore(n,{table:f.iU,id:c.id});if(d.canEdit()&&(null===(t=d.getAssociatedCollectionStore())||void 0===t?void 0:t.id)===n.id){const e=a.hz({block:c,schema:l,property:o,oldValue:r,newValue:i});if(Object.keys(e).length>0){const t=d.getPropertiesStore();W.sW({store:t,data:e,transaction:s})}}})),n.isDefaultRecordCache()&&s.postSubmitCallbacks.push((async e=>{const a=n.pointer,{value:s}=await O.renameGroup(t,{collection:{id:a.id,spaceId:(0,h.C)(a.spaceId)},property:o,oldValue:r,newValue:i}).next();if(s.error)throw s.error}))}function me(e){const{environment:t,collectionStore:n,groupsFormatKey:o,property:r,groupFormat:i,currentGroups:c,collectionContextStore:d,transaction:p,intl:m}=e,g=n.getSchema(),v=g[i.property];ue({collectionContextStore:d,newGroups:c.filter((e=>!(0,s.we)(i.value,e.value))),groupsFormatKey:o,transaction:p});const b=i.value;if(v&&(0,l.cu)(v)&&b.type===v.type&&n){const e=(v.options||[]).filter((e=>e.value!==b.value)),o={...v,options:e},r={...g,[i.property]:o};S.Rm({environment:t,collectionStore:n,update:{schema:r},transaction:p})}const y=t.currentUser.id,_=new Map;n.inMemoryRecordCache.forEachRecord(y,(async e=>{let{model:o}=e;if(o.table!==f.iU)return;const i=E.G.createChildStore(n,o.pointer);if(a.wg({block:o,schema:g,property:r,value:b,intl:m,timeZone:(0,u.r)(),getRecordModel:n.getRecordModel,resultCache:_}))if(o.parent_id===n.id)H.hh({childStore:i,transaction:p});else{const e=i.getAssociatedCollectionStore();e&&e.id===n.id&&("page"===i.getType()||"collection_view_page"===i.getType()&&!i.isCollectionViewPageWithContent())&&await $.Qw({environment:t,blocks:[i]})}})),n.isDefaultRecordCache()&&p.postSubmitCallbacks.push((async e=>{const o=await O.deleteGroup(t,{collection:{id:n.id,spaceId:(0,h.C)(n.pointer.spaceId)},property:r,value:b}).next();if(o.value.error)throw o.value.error}))}function fe(e){const{environment:t,collectionContextStore:n,before:r,store:a,groupsPointer:s,collectionStore:l,transaction:c,subitemPath:d,subitemInsertDirection:u,from:p}=e,m=n.collectionViewStore();if(!m)return;const g=n.groupsStore.getGroupState(s),h=null==g?void 0:g.groupUiParentStore,v=(null==g?void 0:g.resultsStore.state)||[];if(!h)return;const b=W.j4({environment:t,type:i.Ti.page,inMemoryRecordCache:a.inMemoryRecordCache,transaction:c,spaceId:m.pointer.spaceId,useCrdt:!1});if(p){const e="collectionTypedView"===n.contextType?b.getAssociatedCollectionId():void 0;F.W(t,{from:p,type:"page",new_page_id:b.id,creating_block_id:b.id,...C.Pn(n,e)})}const y=re({environment:t,store:b,collectionStore:l,collectionContextStore:n,groupsPointer:s,shouldCoerce:!0,transaction:c}),_=n.defaultPageTemplateStore.state;_&&V.ob({title:"template",environment:t,store:b,templateStore:_,isKeyboard:!1,isCreateIn:!1,transaction:c,from:"collection_group_actions"});const S=E.G.createChildStore(h,{table:f.iU,id:b.id});d&&d.length>0&&ge({environment:t,collectionContextStore:n,subitemPath:d,collectionStore:l,store:a,before:!1,insertBlock:S,insertDirection:u,transaction:c});const k=v.indexOf(a),I=r?k:k+1;if(ie({resultIds:[...v.slice(0,I),S,...v.slice(I)].map((e=>e.id)),collectionViewStore:m,collectionContextStore:n,transaction:c}),y){if(d){var x;const e="into"===u?a:null===(x=d[d.length-2])||void 0===x?void 0:x.value.store;return e?E.G.createChildStore(e,S.pointer):S}return Q.Ys({environment:t,store:S}),le({environment:t,collectionContextStore:n}),S}G.CH({environment:t,store:S,peekMode:w.kr(m),resultsStore:null==g?void 0:g.resultsStore,collectionContextStore:n,pageVisitSource:o.tY.Create})}function ge(e){const{environment:t,collectionContextStore:n,subitemPath:o,collectionStore:r,store:i,before:a,insertBlock:s,insertDirection:l,transaction:c}=e,d=n.currentSubitemFormatStoreForCollection.state;if(!d)return;const u=r.getSchema()[d.property];if(!u||"relation"!==u.type)return;if("into"===l){var p;const e=o[o.length-1],n=e.value.store;return void K.hE({environment:t,sourceStore:n,destStore:s,position:a?{type:"before",before:null===(p=e.children[0])||void 0===p?void 0:p.value.store.id}:{type:"after"},propertyWithInverse:d,transaction:c})}const m=o[o.length-2];if(!m)return;const f=m.value.store;K.hE({environment:t,sourceStore:f,destStore:s,propertyWithInverse:d,position:a?{type:"before",before:i.id}:{type:"after",after:i.id},transaction:c})}function he(e){const{environment:t,collectionContextStore:n,groupFormat:o,newGroupFormat:r,groupsFormatKey:i,currentGroups:a,transaction:l}=e,c=n.collectionStore();!(0,s.we)(o.value,r.value)&&c&&pe({environment:t,collectionStore:c,property:o.property,oldValue:o.value,newValue:r.value,transaction:l});ue({collectionContextStore:n,newGroups:a.map((e=>(0,s.we)(o.value,e.value)?r:e)),groupsFormatKey:i,transaction:l})}function ve(e){const{environment:t,stores:n,spaceId:o,transaction:r}=e;return n.map((e=>{const n=e.getType();if(n&&(i.Ok[n]||n===i.Ti.file||n===i.Ti.externalObjectInstance)){const n=W.j4({environment:t,type:"page",inMemoryRecordCache:e.inMemoryRecordCache,transaction:r,spaceId:o,useCrdt:!1});return H.jG({parentStore:n,childStore:e,transaction:r}),n}return e}))}function be(e){const{environment:t,format:n,groupsFormatKey:o,collectionContextStore:r,currentGroups:i}=e,a=n[o]||[];if(!r.permissionScopes.state.canConfigureBlock)return;if(0===i.length)return;const s=i.slice(0,x.XD),l=a.slice(0,x.XD);m.Xy(s,l)||Y.createAndCommit({userAction:"collectionGroupActions.persistFormatGroups",environment:t,canUndo:!1,perform:e=>{ue({collectionContextStore:r,newGroups:i,groupsFormatKey:o,transaction:e})}})}function ye(e,t){return`group-${e}-${(0,s.mD)(t)}`}function _e(e){const{environment:t,groupFormat:n,collectionContextStore:o}=e,r=o.collectionViewStore();if(!r)return;const i=o.groupsStore.getGroupState(n);if(!i)return;const a=p.Z.get({userId:t.currentUser.id,key:ye(r.id,n)});i.toggleStateStore.setState(a??!0)}function Se(e){const{environment:t,groupFormat:n,toggleStateStore:o,newValue:r,collectionContextStore:i}=e,a=i.collectionViewStore();a&&(o.setState(r),p.Z.set({userId:t.currentUser.id,key:ye(a.id,n),value:r}))}function we(e){const{newGroupValue:t,groupFormat:n,schema:o,collectionContextStore:r,currentGroups:i,groupsFormatKey:a,collectionStore:c,environment:d}=e,u=o[n.property];if(!u)return;if(!(0,s.LG)(u))return;const p=n.value;if((0,l.cu)(u)){if(p.type!==u.type)return;if(t.type!==u.type)return;if(void 0===t.value)return;const e=u.options||[],s=t.value,l=e.map((e=>e.value===p.value?{...e,value:s}:e)),m={...u,options:l},f={...o,[n.property]:m},g={...n,value:{...p,value:s}};Y.createAndCommit({userAction:"collectionGroupActions.handleCollectionGroupValueChange",environment:d,perform:e=>{he({environment:d,collectionContextStore:r,groupFormat:n,newGroupFormat:g,currentGroups:i,transaction:e,groupsFormatKey:a}),S.Rm({environment:d,collectionStore:c,update:{schema:f},transaction:e})}})}else if("person"!==u.type)if((0,s.HB)(u.type)){if(p.type!==u.type)return;if(t.type!==u.type)return;if(!t.value||"exact"!==t.value.type)return;const e={...n,value:t};Y.createAndCommit({userAction:"collectionGroupActions.handleCollectionGroupValueChange",environment:d,perform:t=>{he({environment:d,collectionContextStore:r,groupFormat:n,newGroupFormat:e,currentGroups:i,groupsFormatKey:a,transaction:t})}})}else"status"===u.type||(0,s.A1)(u.type)||"created_by"===u.type||"last_edited_by"===u.type||"number"===u.type||"checkbox"===u.type||"formula"===u.type||"relation"===u.type||"location"===u.type||(0,y.t1)(u.type);else{if(p.type!==u.type)return;if(t.type!==u.type)return;const e={...n,value:t};Y.createAndCommit({userAction:"collectionGroupActions.handleCollectionGroupValueChange",environment:d,perform:t=>{he({environment:d,collectionContextStore:r,groupFormat:n,newGroupFormat:e,currentGroups:i,groupsFormatKey:a,transaction:t})}})}}async function ke(e){const{update:t,collectionContextStore:n,groupsFormatKey:o,collectionStore:r,environment:a,schema:s,groupBy:c}=e,d=s[c.property];if(!d)return;const u="relation"===d.type&&(0,l.F0)(d),p=u&&new E.NW(a,{table:g.v,id:u});p&&await p.load(),Y.createAndCommit({userAction:"collectionGroupActions.handleCollectionAddGroupButtonAccept",environment:a,perform:e=>{if(t.newGroups&&(ue({collectionContextStore:n,newGroups:t.newGroups,groupsFormatKey:o,transaction:e}),Z.ul({transaction:e,newGroups:t.newGroups,collectionContextStore:n,environment:a})),t.newSchema&&S.Rm({environment:a,collectionStore:r,update:{schema:t.newSchema},transaction:e}),t.newPage&&"relation"===d.type&&p){const n=(0,v.TPx)(t.newPage.name),o={id:t.newPage.id,version:0,type:i.Ti.page,parent_id:u,parent_table:g.v,alive:!0,properties:{title:n},collection_id:void 0,space_id:t.newPage.spaceId},s=W.ae({environment:a,table:f.iU,value:o,inMemoryRecordCache:r.inMemoryRecordCache,transaction:e}),l=p.getDefaultTemplatePageStore();l&&V.ob({title:{text:n},environment:a,store:E.G.createChildStore(p,s.pointer),templateStore:l,isKeyboard:!1,isCreateIn:!1,transaction:e,from:"collection_group_actions"})}}})}function Ie(e){const{collectionContextStore:t,environment:n,incrementLimitArgs:o}=e;t.groupsStore.incrementLimit(e.incrementLimitArgs),t.loadingDetails.setState({type:"load_more_blocks",group:o.groupsPointer}),B.bn(n)}},16956:(e,t,n)=>{n.d(t,{Bv:()=>D,E2:()=>V,G3:()=>P,LC:()=>A,OK:()=>E,TI:()=>O,bL:()=>R,er:()=>B,fH:()=>F,yV:()=>Z});n(57658),n(67294);var o=n(46283),r=n(99036),i=n(95200),a=n(71644),s=n(6287),l=n(97880),c=n(82990),d=n(9291),u=n(91851),p=n(75330),m=n(10906),f=n(76798),g=n(65183),h=n(33929),v=n(29376),b=n(85526),y=n(79797),_=n(8406),S=n(31869),w=n(5149),k=n(87085),I=n(47307),C=n(96802),x=n(82530),T=n(12304),M=n(85893);function P(e){const{environment:t,collectionViewArgs:n,collectionStore:s,propertyName:c,propertyType:d,selectOptions:u,transaction:m}=e,f={},v=s.getSchema(),b=Object.keys(v),y=(0,i.Z)(c??g.SO[d],(e=>!b.find((t=>{const n=v[t];return Boolean(n&&n.name===e)})))),_=(0,a.ZP)();let S;const w=(0,g.k4)();if((0,r.XU)(d))switch(d){case"ai_custom_prompt":S={name:y,type:"text",ai_inference:{type:"custom",prompt:"",auto_update_on_edit:w}};break;case"ai_summary":S={name:y,type:"text",ai_inference:{type:"summarize",auto_update_on_edit:w}};break;case"ai_extract":S={name:y,type:"text",ai_inference:{type:"extract",prompt:"",auto_update_on_edit:w}};break;case"ai_translate":S={name:y,type:"text",ai_inference:{type:"translate",targetProperties:["title"],toLanguage:"english",auto_update_on_edit:w}};break;case"ai_keywords":S={name:y,type:"multi_select",select_ai_inference:{type:"multi_select",add_options:!0,auto_update_on_edit:!1}};break;default:(0,l.t1)(d)}else S=!u||"select"!==d&&"multi_select"!==d?{name:y,type:d}:{name:y,type:d,options:u};if(f[_]=S,r.iE(S)&&(b.includes(o.k.Owner)||(f[o.k.Owner]={name:h.default.formatMessage(T.Zi.ownerPropertyName),type:"person",default:"created_by"}),S.verifier_property=o.k.Owner),n){const{format:e,formatKey:t,collectionViewStore:o}=n,r=[...e[t]||[],{property:_,visible:!0}];C.FH({stores:[o],update:{[t]:r},transaction:m})}return p.xO({environment:t,collectionStore:s,update:f,transaction:m}),_}function A(e){const{environment:t,collectionStore:n,property:o,type:i,transaction:a}=e,s=n.getSchema()[o];if(!s||s.type===i)return;const l={...s};l.type=(0,r.TN)(i),p.xO({environment:t,collectionStore:n,update:{[o]:l},transaction:a})}function R(e){const{collectionStore:t,property:n,autoRelate:o,transaction:r}=e;t.getSchema()[n]&&x.applyOperation({store:t,operation:{pointer:t.pointer,path:["schema",n,"autoRelate"],command:"set",args:o},transaction:r})}function D(e){const{collectionStore:t,property:n,name:o,transaction:r}=e;t.getSchema()[n]&&x.applyOperation({store:t,operation:{pointer:t.pointer,path:["schema",n,"name"],command:"set",args:o},transaction:r})}function E(e){const{collectionStore:t,property:n,icon:o,transaction:r}=e;t.getSchema()[n]&&x.applyOperation({store:t,operation:{pointer:t.pointer,path:["schema",n,"icon"],command:"set",args:o},transaction:r})}function B(e){const{formatStore:t,formatKey:n,property:o,update:r,transaction:i}=e,a=[...t.getFormat()[n]||[]],s=a.findIndex((e=>e.property===o));-1!==s?a[s]={...a[s],...r}:a.push({property:o,...r}),C.FH({stores:[t],update:{[n]:a},transaction:i})}function F(e){const{collectionContextStore:t,collectionStore:n,environment:o,isInPeekRenderer:i,onCloseMenu:a}=e,s=t.settingsStore;w.H4({collectionSettingsStore:s,item:{type:"propertyType",onAccept:(e,l,c,d)=>{if("relation"===e)return void w.H4({collectionSettingsStore:s,item:{type:"selectRelationSource",property:void 0,formatKey:"collection_page_properties"}});const{performResult:u}=x.createAndCommit({userAction:"PageProperties.handleAddPropertyClick",environment:o,perform:t=>P({environment:o,collectionStore:n,collectionViewArgs:void 0,propertyType:e,propertyName:c,selectOptions:d,transaction:t})});null==a||a(),w.FK({collectionSettingsStore:s,item:{type:"property",formatKey:"collection_page_properties",property:u,selectNameInitial:!o.device.isMobile}}),b.Z.setState({...b.Z.state,openProperty:{property:u,isInPeekRenderer:i},forceShowProperties:!0}),(0,r.XU)(e)&&k.K7({propertyType:e,propertyId:u,collectionContextStore:t}),_._H({environment:o,collectionContextStore:t,from:"page_properties",property_type:(0,r.TN)(e),property:(0,r.XU)(e)?e:void 0,is_suggested_property:l})},propertyTypes:(0,g.TP)({isSyncedCollection:n.isSyncedCollection(),collectionContextStore:t,environment:o})}})}async function O(e){const{environment:t,collectionContextStore:n,property:o,handleDeleteAccept:r}=e,i=n.collectionStore();if(!i)return;if(i.isTypedProperty(o)){if(await u.w0({environment:t,property:o,collectionContextStore:n,theme:e.theme,from:e.from}))return}const a=n.normalizedSchemaStore.state,s=a[o],l=v.ny(n,s);await(null==l?void 0:l.load());const p=l&&v.OP(n,o,l),m=l&&v.gZ(l),g=l&&i.id===l.id,h=[{label:(0,M.jsx)(d.FormattedMessage,{id:"database.viewSettings.propertyTab.deleteProperty.modal.confirmButton",defaultMessage:"Delete"}),color:"red",onAccept:r}];let b;if(p&&i&&m&&!g&&h.push({label:(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteProperty.modal.inverseConfirmButton",defaultMessage:"Delete, but keep related property"}),color:"red",onAccept:()=>{x.createAndCommit({userAction:"collectionPropertyActions.showDeletePropertyDialog",environment:t,perform:e=>{if(s&&"relation"===s.type&&s.property&&l){const n=s.property,o=l.getSchema();S.q0({environment:t,collectionStore:l,propertySchema:o[n],property:n,targetPropertyID:void 0,autoRelate:i.isSyncedCollection()&&!l.isSyncedCollection()?{enabled:!1}:s.autoRelate,transaction:e})}S.kQ({environment:t,collectionStore:i,property:o,transaction:e})}})}}),"auto_increment_id"===(null==s?void 0:s.type))b=v.pR(a)?(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteUniqueIdWithGithubProperty.modal.prompt",defaultMessage:"You will no longer be able to link new GitHub PRs and status automations will stop working."}):(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteUniqueIdProperty.modal.prompt",defaultMessage:"The ID property will be permanently deleted."});else if("status"===(null==s?void 0:s.type)){const e=v.Pi(a);if(e){const t=e.connectedRelation.automation;t&&t[o]&&(b=(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteStatusProperty.modal.prompt",defaultMessage:"Deleting this status property will stop the GitHub Pull Requests status automation."}))}}else l&&m&&!g&&p&&(b=(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteRelatedProperty.modal.prompt",defaultMessage:"This property has a related property on {relationTargetName} which will also be deleted.",values:{relationTargetName:(0,M.jsx)(f.Z,{style:{display:"inline",fontWeight:c.Z.fontWeight.medium},store:l})}}));I.showDialog({message:(0,M.jsx)("span",{children:(0,M.jsx)(d.FormattedMessage,{id:"database.tableHeaderCell.deleteProperty.modal.prompt",defaultMessage:"Delete this property for everyone on {databaseName}?",values:{databaseName:(0,M.jsx)(f.Z,{style:{display:"inline",fontWeight:c.Z.fontWeight.medium},shouldWrap:!0,store:i})}})}),description:b,showCancel:!0,keepFocus:!0,items:h,mode:"wide"})}async function Z(e){const{environment:t,collectionStore:n,schema:o,property:i,transaction:a}=e,s=o[i];if(s)if("relation"===s.type&&r.F0(s)&&s.property&&r.F0(s)!==n.id){const e=new y.NW(t,r.j0(s));await e.load(),V({environment:t,collectionStore:n,schema:o,property:i,transaction:a,targetCollectionStore:e})}else V({environment:t,collectionStore:n,schema:o,property:i,transaction:a})}function V(e){const{environment:t,collectionStore:n,schema:o,property:r,transaction:i,targetCollectionStore:a,permanentlyDelete:l}=e;if(!n.isDefined())return;const c=Boolean(l),d=m.zm({environment:t,collectionId:n.id,schema:o,property:r,targetCollectionStore:a});if(!d)return;p.Rm({environment:t,collectionStore:n,update:{schema:d.newSchema,...!c&&d.deletedSchema&&{deleted_schema:d.deletedSchema}},transaction:i}),d.otherCollectionId&&d.otherCollectionSchema&&p.Rm({environment:t,collectionStore:y.NW.createChildStore(n,{table:s.v,id:d.otherCollectionId}),update:{schema:d.otherCollectionSchema,...!c&&d.otherCollectionDeletedSchema&&{deleted_schema:d.otherCollectionDeletedSchema}},transaction:i});const u=o[r];("auto_increment_id"===(null==u?void 0:u.type)||c)&&p.$N({collectionStore:n,update:{[r]:null},transaction:i})}},75134:(e,t,n)=>{n.d(t,{H:()=>x,r:()=>T});n(67294);var o=n(40682),r=n(52936),i=n(42875),a=n(72126),s=(n(57658),n(21703),n(80951)),l=n(61158),c=n(45953);const d=500;function*u(e){const{startingBlock:t,relationPropertyIdGroups:n,receiver:o}=e;let r,i=n.map((e=>function*(e){const{startingBlock:t,relationPropertyIds:n,receiver:o}=e,r=new Set,i=[{block:t}];let l=0;for(;;){const e=i.shift();if(!e)break;const{block:t}=e;if(r.has(t.id))continue;r.add(t.id);const c=n.flatMap((e=>{var n;return(0,s.rq)(null===(n=t.properties)||void 0===n?void 0:n[e])}));if(!o.receive(c))return;if(c.length>0){const{recordMap:e}=yield{recordPointers:c};i.push(...a.oA(c.map((t=>{const n=e.getValue(t);if(n&&n.alive)return{block:n}}))))}if(l++,l>d)throw new Error("Reached maximum number of iterations")}}({relationPropertyIds:e,startingBlock:t,receiver:o})));for(;i.length>0;){const e=[];i=i.filter((t=>{const n=r?t.next(r):t.next();return!n.done&&(e.push(n.value),!0)})),e.length>0&&(r=yield{recordPointers:e.flatMap((e=>e.recordPointers))})}}class p{constructor(e){this.blockPointerSet=new l.Z,this.limit=e}getBlockPointers(){return this.blockPointerSet.entries()}receive(e){return this.blockPointerSet.add(...e),this.blockPointerSet.size<this.limit}}function m(e){return function(e){const{startingBlock:t,relationPropertyIdGroups:n,getRecordValue:o,limit:r}=e,i=new p(r),a=u({startingBlock:t,relationPropertyIdGroups:n,receiver:i});let s=a.next();for(;!s.done;){const e=c.Ak.create();for(const t of s.value.recordPointers)e.setValue(t,o(t));s=a.next({recordMap:e})}return i.getBlockPointers()}(e).every((t=>Boolean(e.getRecordValue(t))))}var f=n(97880),g=n(9291),h=n(6854),v=n(81166),b=n(80444),y=n(77080),_=n(79797),S=n(54642),w=n(64964),k=n(82530),I=n(85893);const C=100;function x(e){const{environment:t,store:n}=e;P({environment:t,store:n,change:{type:"date",...e}})}function T(e){const{environment:t,store:n}=e;P({environment:t,store:n,change:{type:"relation",...e}})}const M=new o.z(1);function P(e){const{environment:t,store:n,change:o}=e;if(!y.default.checkGate("dependency_date_shifting_by_space"))return;const s=n.getAssociatedCollectionStore();if(!s)return;const l=s.getDatabaseType(),c=s.getSchema(),d=s.getNormalizedDependencyDateShiftingConfig();if(!d)return;const u=s.getFormatStore().getKeyStore("collection_default_arrows_by").getValue();if(!u)return;const p=c[u];if("relation"!==(null==p?void 0:p.type))return;const x=p.property;x&&M.enqueue((()=>async function(e){var t,n;const{environment:o,store:s,dateShiftConfig:l,databaseType:c,blockedByPropertyId:d,blockingPropertyId:u,change:p,collectionSchema:y}=e,x={id:s.id,properties:s.getProperties()},T=null===(t=b.default.state.currentUserSettingsStore)||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.locale,M=(0,i.r)();let P,A,R;if("date"===p.type){var D;if(0===a.jV(a.oA([l.date_property,l.end_date_property]),a.oA([p.dateProperty.id,null===(D=p.otherDateProperty)||void 0===D?void 0:D.id])).length)return;const e=new Map;e.set(p.dateProperty.id,p.dateProperty),p.otherDateProperty&&e.set(p.otherDateProperty.id,p.otherDateProperty);const t=t=>{const n=e.get(t);if((0,f.$K)(n))return n;{var o;const e=null===(o=x.properties)||void 0===o?void 0:o[t];return{id:t,oldValue:e,newValue:e}}};P=t(l.date_property),(0,f.$K)(l.end_date_property)&&(A=t(l.end_date_property))}else if("relation"===p.type){if(p.relationPropertyId!==u&&p.relationPropertyId!==d)return;if("preserve_gap"===l.mode)return;P={id:l.date_property,oldValue:void 0,newValue:x.properties[l.date_property]},l.end_date_property&&(A={id:l.end_date_property,oldValue:void 0,newValue:x.properties[l.end_date_property]})}else(0,f.t1)(p);"preserve_gap"===l.mode?R=[[d,u]]:"consume_gap"===l.mode?R=[[d],[u]]:(0,f.t1)(l.mode);m({startingBlock:x,relationPropertyIdGroups:R,limit:C,getRecordValue:s.getRecordValue})?await Promise.resolve():await S.getTransitivePageRelations(o,{blockId:x.id,limit:C,relationPropertyIdGroups:R}).then((()=>{}));const E=(0,r.yu)({block:{id:x.id,properties:{...x.properties,...P.oldValue?{[P.id]:P.oldValue}:{},...null!==(n=A)&&void 0!==n&&n.oldValue?{[A.id]:A.oldValue}:{}}},blockingPropertyId:u,blockedByPropertyId:d,dateProperty:P,endDateProperty:A,getRecordValue:s.getRecordValue,timeZone:M,locale:T,options:l,collectionSchema:y,getRecordRole:s.getRecordRole}),{operations:B}=E;k.createAndCommit({userAction:"collectionDateActions.handleDependencyDateShifting",environment:o,perform:e=>{for(const t of B){const n=(0,_.Kv)(s,t.pointer);k.applyOperation({store:n,operation:t,transaction:e})}}});const F=(0,v.vi)({result:E,databaseType:c});F&&w.oV({label:(0,I.jsx)(g.FormattedMessage,{...F.message}),right:F.canUndo?(0,I.jsx)(h.ow,{}):void 0})}({environment:t,store:n,dateShiftConfig:d,databaseType:l,blockedByPropertyId:x,blockingPropertyId:u,change:o,collectionSchema:c}))).catch((e=>{console.error(e)}))}},31869:(e,t,n)=>{n.d(t,{gy:()=>b,kQ:()=>h,n7:()=>v,q0:()=>g,qK:()=>_,sf:()=>y});var o=n(80951),r=n(71644),i=n(36610),a=n(9953),s=n(75330),l=n(29376),c=n(8406),d=n(16956),u=n(75134),p=n(96802),m=n(82530);function f(e){const{environment:t,collectionStore:n,collectionPointer:o,property:r,name:i,autoRelate:a,limit:l,targetPropertyID:c,connectedRelation:d,transaction:u,hideByDefaultInUnconfiguredViews:p}=e,m={type:"relation",name:i,collection_id:o.id,collection_pointer:o,limit:"1"===l?1:void 0,property:c,version:"v2",autoRelate:a,connectedRelation:d,hideByDefaultInUnconfiguredViews:p};s.xO({environment:t,collectionStore:n,update:{[r]:m},transaction:u})}function g(e){const{environment:t,collectionStore:n,propertySchema:o,targetPropertyID:r,property:i,autoRelate:a,transaction:l}=e;s.xO({environment:t,collectionStore:n,update:{[i]:{...o,autoRelate:a,property:r,version:"v2"}},transaction:l})}function h(e){const{environment:t,collectionStore:n,property:o,transaction:r}=e,i=n.getSchema()[o];i&&"relation"===i.type&&(s.xO({environment:t,collectionStore:n,update:{[o]:null},transaction:r}),s.$N({collectionStore:n,update:{[o]:i},transaction:r}))}function v(e){const{environment:t,collectionContextStore:n,collectionStore:o,property:i,propertyName:a,propertyLimit:s,targetCollectionStore:u,hasInverseRelation:p,inverseName:m,autoRelate:g,intl:h,connectedRelation:v,transaction:b,from:y,analyticsFrom:_,onlyCheckPermissions:S}=e,w=u.pointer.id===o.id&&Boolean(p)?"separate_property":"same_property",k=l.KV(n,i),I="subitem"===y||void 0,C=function(e){const{environment:t,collectionContextStore:n,property:o,limit:i,collectionPointer:a,selfRelationType:s,oneWay:l,autoRelate:c,connectedRelation:d,transaction:u,hideByDefaultInUnconfiguredViews:p}=e,m=n.collectionStore();if(!m)return;const g=m.getSchema()[o];if(!g)return;const h=a.id===m.id?"same_property"===s?o:(0,r.ZP)():l?void 0:(0,r.ZP)();return f({environment:t,collectionStore:m,collectionPointer:a,property:o,name:g.name,autoRelate:c,limit:i,targetPropertyID:h,connectedRelation:d,transaction:u,hideByDefaultInUnconfiguredViews:p}),h}({environment:t,collectionContextStore:n,property:i,limit:s,collectionPointer:u.pointer,selfRelationType:w,oneWay:!p,autoRelate:g,connectedRelation:v,transaction:b,hideByDefaultInUnconfiguredViews:I});if((null==k?void 0:k.name)!==a&&(d.Bv({collectionStore:o,property:i,name:a,transaction:b}),c.$q({environment:t,collectionContextStore:n,property:i,from:_??"view_settings",action:"rename"})),S&&p&&null!=o&&o.canEditCollection()&&C){const e=l.rj({inverseName:m,collectionStore:o,propertySchema:k,intl:h,targetCollectionStore:u,from:y});f({environment:t,collectionStore:u,collectionPointer:o.pointer,property:C,name:e,autoRelate:g,limit:"subitem"===y?"1":"no_limit",targetPropertyID:i,connectedRelation:v,transaction:b,hideByDefaultInUnconfiguredViews:I})}if(p&&l.gZ(u)&&C){const e=l.rj({inverseName:m,collectionStore:o,propertySchema:k,intl:h,targetCollectionStore:u,from:y});f({environment:t,collectionStore:u,collectionPointer:o.pointer,property:C,name:e,autoRelate:g,limit:"subitem"===y?"1":"no_limit",targetPropertyID:i,connectedRelation:v,transaction:b,hideByDefaultInUnconfiguredViews:I})}}function b(e){const{environment:t,collectionContextStore:n,property:o,hasInverseRelation:i,inverseName:a,autoRelate:s,intl:c,transaction:u}=e,p=l.KV(n,o);if(!p||"relation"!==p.type)return;const m=l.ny(n,p),v=n.collectionStore();if(!v||!m)return;const b=l.rj({inverseName:a,collectionStore:v,propertySchema:p,intl:c,targetCollectionStore:m});if(i&&!l.OP(n,o,m)){const e=(0,r.ZP)();g({environment:t,collectionStore:v,propertySchema:p,property:o,targetPropertyID:e,autoRelate:s,transaction:u}),f({environment:t,collectionStore:m,collectionPointer:v.pointer,property:e,name:b,autoRelate:s,limit:"no_limit",targetPropertyID:o,transaction:u,hideByDefaultInUnconfiguredViews:void 0})}else if(i){const e=p.property;if(!e)return;d.Bv({collectionStore:m,property:e,name:b,transaction:u}),s&&(d.bL({collectionStore:v,property:o,autoRelate:s,transaction:u}),d.bL({collectionStore:m,property:e,autoRelate:s,transaction:u}))}else{s&&d.bL({collectionStore:v,property:o,autoRelate:s,transaction:u});const e=p.property;if(!e)return;g({environment:t,collectionStore:v,propertySchema:p,property:o,targetPropertyID:void 0,autoRelate:s,transaction:u}),h({environment:t,collectionStore:m,property:e,transaction:u})}}function y(e){var t;const{store:n,propertyId:r,value:i,environment:s,relatedPageId:l,propertySchema:d,transaction:p,collectionContextStore:m,analyticsData:f,isUnthrottled:g}=e,{analyticsFrom:h,isFromBulkActionsToolbar:v}=f,b=n.getPropertyStore(r),y=o.ow(i);a.sO({store:b,value:y,transaction:p}),c.rv({environment:s,block_id:l,property:r,property_type:d.type,from:h,collectionContextStore:m,isFromBulkActionsToolbar:v,isUnthrottled:g,integration_id:null===(t=d.connectedRelation)||void 0===t?void 0:t.integration_id,action:"remove"}),u.r({environment:s,store:n,relationPropertyId:r})}function _(e){const{propertyFormat:t,visibility:n,collectionStore:r,property:a,environment:s}=e,c=t.property,d=l.U1({collectionStore:r,property:a}),u=(0,o.pX)(d,c,!n),f={...l.ZI(r)};f[a]||(f[a]={}),f[a].related_properties=u,m.createAndCommit({userAction:"collectionRelationActions.updateRelationPropertyVisibility",environment:s,perform:e=>{p.FH({stores:[r],update:{collection_relation_options:f},transaction:e})}}),i.P$(s,{collection_id:r.id,property_id:a,related_property_id:c,visible:!n})}},5149:(e,t,n)=>{n.d(t,{E3:()=>V,FK:()=>N,H4:()=>U,NG:()=>Z,Ol:()=>W,R0:()=>G,TT:()=>q,iN:()=>K,nr:()=>$,qU:()=>z,r$:()=>O,wl:()=>L,z$:()=>j,zt:()=>H});n(67294);var o=n(1302),r=n(15145),i=n(92996),a=n(41432),s=n(59730),l=n(15157),c=n(29477),d=n(21202),u=n(15047),p=n(29369),m=n(63143),f=n(9291),g=n(40663),h=n(75330),v=n(95477),b=n(92918),y=n(84210),_=n(33929),S=n(16402),w=n(77907),k=n(80444),I=n(8406),C=n(54642),x=n(893),T=n(47307),M=n(96802),P=n(19785),A=n(9953),R=n(42858),D=n(64964),E=n(82530),B=n(85893);const F=(0,f.defineMessages)({copySuccessMessage:{defaultMessage:"Link to view copied to clipboard",id:"database.viewSettings.copyLinkSnackBarItem.title"}});function O(e){const{collectionContextStore:t,selectViewNameInitial:n,collectionSettingsStore:o,hideSettingsPopup:r,fromBlock:i}=e,a=t.hasSingleCollection()&&!t.collectionStore()?{type:"createViewSource"}:{type:"main",selectViewNameInitial:n};o.setState({open:!0,hideSettingsPopup:r,stack:[a],fromBlock:i})}function Z(e){const{collectionSettingsStore:t}=e;L({collectionSettingsStore:t,item:{type:"createSyncedViewSource"}})}function V(e){const{collectionSettingsStore:t}=e;t.setState({...t.state,open:!1,hideSettingsPopup:void 0,stack:[]})}function U(e){const{collectionSettingsStore:t,item:n,hideSettingsPopup:o}=e,r=t.state;t.setState({...r,open:!0,stack:[...r.stack,n],...void 0!==o?{hideSettingsPopup:o}:{}})}function N(e){const{collectionSettingsStore:t,item:n}=e,o=t.state;t.setState({open:!0,stack:[...o.stack.slice(0,o.stack.length-1),n]})}function L(e){const{collectionSettingsStore:t,item:n}=e;t.setState({open:!0,stack:[n]})}function j(e){const{collectionSettingsStore:t}=e,n=t.state,o=n.stack.slice(0,n.stack.length-1);0===o.length?V({collectionSettingsStore:t}):t.setState({open:!0,stack:o})}function z(e){const{collectionSettingsStore:t,property:n,formatKey:o,selectNameInitial:r}=e,i=t.state,a=i.stack.findIndex((e=>"property"===e.type));t.setState({open:!0,stack:[...a>=0?i.stack.slice(0,a):i.stack,{type:"property",property:n,formatKey:o,selectNameInitial:r}]})}function q(e){const{environment:t,collectionContextStore:n,collectionViewStore:o,collectionSettingsStore:r,from:i}=e,a=(0,c.UZ)();return T.showDialog({showCancel:!0,keepFocus:!1,message:(0,B.jsx)(f.FormattedMessage,{defaultMessage:"Are you sure you want to delete this view?",id:"database.viewSettings.mainTab.deleteViewConfirm.text"}),items:[{label:(0,B.jsx)(f.FormattedMessage,{defaultMessage:"Delete view",id:"database.viewSettings.deleteButton.text"}),color:"red",onAccept:()=>{const e=n.collectionViewStore(),s=n.collectionViewBlockStore(),l=n.isFullScreen.state,c=o.getType();e&&s&&c&&(E.createAndCommit({userAction:"collectionSettingsActions.handleDeleteCollectionView",environment:t,perform:a=>{if(h.dp({collectionViewBlockStore:s,collectionViewStore:o,transaction:a}),V({collectionSettingsStore:r}),e.id===o.id){const e=s.getCollectionViewStores()[0];e?h.f8({environment:t,collectionContextStore:n,collectionViewId:e.id,isFullScreen:n.isFullScreen.state,isRootChild:n.isRootChild.state,isInPeekRenderer:n.isInPeekRenderer.state}):(h.ME({environment:t,collectionContextStore:n,transaction:a}),l||R.Cl({environment:t,blocks:[s],transaction:a}))}I.Rc({environment:t,collectionContextStore:n,view_type:c,from:i})}}),a.resolve(!0))}}],handleCancel:()=>a.resolve(!1)}),a.promise}function H(e){const{environment:t,collectionContextStore:n,collectionViewStore:r,collectionSettingsStore:i,intl:a}=e,s=n.isFullScreen.state,l=n.isRootChild.state,c=n.isInPeekRenderer.state,{performResult:d}=E.createAndCommit({userAction:"collectionSettingsActions.newView",environment:t,perform:e=>h.tG({environment:t,collectionContextStore:n,collectionViewStore:r,collectionSettingsStore:i,intl:a,transaction:e})});d&&(h.f8({environment:t,collectionContextStore:n,collectionViewId:d.id,isFullScreen:s,isRootChild:l,isInPeekRenderer:c}),o.default.afterNextFlush((()=>{O({collectionContextStore:n,collectionSettingsStore:i,selectViewNameInitial:!0})})))}async function W(e){const{environment:t,collectionContextStore:n,collectionViewStore:o}=e,i=n.collectionViewBlockStore();if(!o||!i)return;const a=(0,y.ZP)({store:i,collectionViewId:o.id,fullyQualified:!0,pageVisitSource:r.tY.CopyLink});await x.RD({environment:t,stringValue:a,copiedMessage:x.tq.copiedLinkToClipboard}),D.oV({label:_.default.formatMessage(F.copySuccessMessage)})}function K(e){const{environment:t,collectionContextStore:n}=e,o=n.normalizedFormatStore.state.board_columns_by,r=n.collectionViewStore();if(!o||!r)return;const i=!(0,b.h6)(t,n);E.createAndCommit({userAction:"collectionSettingsActions.handleBoardGroupColorColumnsClick",environment:t,perform:e=>{M.FH({stores:[r],update:{board_columns_by:{...o,disableBoardColorColumns:i}},transaction:e})}}),I.wd({environment:t,collectionContextStore:n,action:"toggle_group_color_columns"})}async function G(e){const{environment:t,uri:n,botId:o,collectionId:r,isStale:i,nextSync:a,setNextSync:c}=e;if(!a||Date.now()>a){var d;let e=Date.now()+m.U6;const a=await C.resubscribeExternalCollection(t,{botId:o,uri:n,isStale:i,collectionId:r});if("failed"===a.type&&(0,s.A6)(a.body)&&"rate_limited"===(null===(d=a.body.clientData)||void 0===d?void 0:d.type)){const t=a.body.clientData.retryAfter;t&&(e=Date.now()+t*m.C0),D.oV({label:(0,B.jsx)(f.FormattedMessage,{id:"database.viewSettings.syncedSourceTab.update.rateLimitError",defaultMessage:"This database was synced recently. You may try again in {time}.",values:{time:(0,S.hH)(Date.now(),e)}})})}if(v.default.isAdminMode)return;l.Z.set({userId:t.currentUser.id,key:`${o}:${n}`,value:e}),c(e)}}async function $(e){const{appTemplatesSetupActions:t,appConfigs:n}=await w.deps.AppTemplates.loader(),{environment:r,selectedDBType:s,collectionName:l,collectionContextStore:c,collectionViewBlockStore:m,collectionViewStore:f,useTemporaryRecordCache:v,temporaryRecordCache:b,baseViewType:y}=e,{currentSpaceViewStore:_}=k.default.state;let S=f,C=m,x=m.getParentStore();var T;v&&(S=f.clone(b),C=m.clone(b),x=null===(T=m.getParentStore())||void 0===T?void 0:T.clone(b));if(s===i.br)I.wd({environment:r,collectionContextStore:c,action:"select_new_collection"}),E.createAndCommit({userAction:"CollectionSettingsNewDBType.handleCreateDB",environment:r,perform:e=>{if(v){A.sW({store:S,data:{name:void 0,format:void 0,query2:void 0,type:y??"table"},transaction:e}),A.sW({store:C,data:{properties:void 0},transaction:e});const t=C.getCollectionViewSourceCollectionStore();t&&h.A9({collectionViewBlockStore:C,collectionStore:t,transaction:e})}h.TM({environment:r,collectionViewStore:S,collectionViewBlockStore:C,name:l,transaction:e});const t=C.getCollectionViewSourceCollectionStore();c.setContext({type:"collectionView",collectionViewBlockStore:m,collectionStore:t,collectionViewStore:f})}}),o.default.afterNextFlush((()=>{h.W1({environment:r,collectionContextStore:c})}));else{const e=s,o=(0,g.YB)(n(),e);if(!o)return;const i=(0,g.Zu)(o,e);if(!i)return;E.createAndCommit({userAction:"CollectionSettingsNewDBType.handleCreateDB",environment:r,perform:e=>{if(!x||x.table!==u.bx&&x.table!==p.e0&&x.table!==d.iU||!_)return;if(!v&&b){r.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(b);C.getCollectionViewStores().forEach((t=>h.dp({collectionViewBlockStore:C,collectionViewStore:t,transaction:e})))}const s=(0,g.KC)(n(),i);t.applyFeatures({environment:r,spaceViewStore:_,appParentStore:x,appUri:o.uri,features:s,createOrModify:"create",initializeStore:C,transaction:e});const l=C.getCollectionViewSourceCollectionStore();if(l){const t=x.table===u.bx?x.id:x.getSpaceId();if(!t)return;for(let o=0;o<3;o++){const n=A.j4({environment:r,type:a.Ti.page,inMemoryRecordCache:C.inMemoryRecordCache,transaction:e,spaceId:t,useCrdt:!1});P.zw({childStore:n,parentStore:l,transaction:e})}const n=C.getCollectionViewStores()[0];c.setContext({type:"collectionView",collectionViewBlockStore:m,collectionStore:l,collectionViewStore:n}),c.filtersBarOpen.setState(!1)}}})}}},87085:(e,t,n)=>{n.d(t,{G0:()=>E,Jw:()=>O,K7:()=>B,PW:()=>F});n(57658),n(21703);var o=n(92996),r=n(90559),i=n(99036),a=n(77657),s=n(74181),l=n(72126),c=n(21202),d=n(9844),u=n(15047),p=n(29369),m=n(97880),f=n(9291),g=n(40663),h=n(75330),v=n(10906),b=n(33929),y=n(77907),_=n(80444),S=n(30874),w=n(79797),k=n(8406),I=n(54642),C=n(74882),x=n(16956),T=n(31869),M=n(5149),P=n(28673),A=n(96802),R=n(82530);const D=(0,f.defineMessages)({aiCustomPromptDefaultPropertyName:{id:"collectionSettingsCreatePropertyActions.createProperty",defaultMessage:"Text"}});async function E(e){var t;const{appTemplatesSetupActions:n,appTemplatesSprintBoardActions:i,appConfigs:l}=await y.deps.AppTemplates.loader(),{environment:m,collectionContextStore:f,feature:h}=e,{currentSpaceViewStore:v}=_.default.state,b=f.collectionStore(),x=f.collectionViewStore(),T=null==b?void 0:b.getParentBlockStore(),D=null==T?void 0:T.getParentStore(),E=null==b||null===(t=b.getFormat())||void 0===t?void 0:t.app_config_uri,B=E&&(0,g.YB)(l(),E);if(!b||!T||!D||D.table!==u.bx&&D.table!==c.iU&&D.table!==p.e0||!B)return;const F=b.getSchema(),O=T.getFormat().app_id,Z=O?await I.getCollectionViewBlocksByAppId(m,{spaceId:T.getSpaceId(),appId:O}):void 0,V="success"===(null==Z?void 0:Z.type)&&Z.data.result.length?Z.data.result.map((e=>w.G.createChildStore(D,{table:c.iU,id:e.blockId,spaceId:T.getSpaceId()}))):[T],U=h.integrationId;if(U){const e=S.Z.getIntegrationsAsRecordMap().getValue({table:d.K2,id:U});if(!e||!(0,s.VM)(e))return;await P.V(m,b,e,Boolean(h.canOnlyAdminAuth))}U===a.U9&&F&&0===(0,r.$z)(F).length&&await C.K({environment:m,collectionStore:b});const N=Date.now();R.createAndCommit({environment:m,userAction:"collectionSettingsCreatePropertyActions.handleCreateNewSuggestedProperty",perform:e=>{var t;if(!B||!v)return;const r=null===(t=b.getFormat())||void 0===t?void 0:t.app_config_uri;if(!r)return;const a=n.applyFeatures({environment:m,spaceViewStore:v,appParentStore:D,appUri:B.uri,features:[{type:"simple",featureUri:h.uri}],transaction:e,createOrModify:"modify",appCollectionViewBlockStores:V});if(i.createSprintPage({environment:m,spaceViewStore:v,appParentStore:D,transaction:e,blockStores:a,creationEntryPoint:{type:"sprint_relation"}}),"notion://tasks/sub_task_feature"===h.uri&&A.FH({stores:[b],update:{subitem_property:o.Es.SubTaskRelation},transaction:e}),"notion://tasks/task_dependencies_feature"===h.uri&&(A.FH({stores:[b],update:{collection_default_arrows_by:o.Es.BlockingRelation},transaction:e}),x&&A.FH({stores:[x],update:{timeline_arrows_by:{property:o.Es.BlockingRelation}},transaction:e})),"dependencies"in h&&h.dependencies.forEach((e=>{"property"===e.type&&e.collectionUri===r&&k._H({environment:m,collectionContextStore:f,from:"view_settings",property:e.uri,property_type:e.propertySchema.type,is_suggested_property:!0})})),"dependencies"in h&&h.dependencies.map((e=>e.type)).every((e=>"property"===e))){const t=f.collectionViewStore(),n=f.getPropertyFormatKey(),o=f.normalizedFormatStore.state;if(n&&t){const r=o[n]||[],i=[...r];h.dependencies.forEach((e=>{const t=r.findIndex((t=>t.property===e.uri));-1===t?i.push({visible:!0,property:e.uri}):i[t]={...r[t],visible:!0}})),A.FH({stores:[t],update:{[n]:i},transaction:e})}}if(void 0!==h.propertyIdCollectionSettingToNavigateTo){const e={type:"property",property:h.propertyIdCollectionSettingToNavigateTo,selectNameInitial:!1,formatKey:f.getPropertyFormatKey()};M.H4({collectionSettingsStore:f.settingsStore,item:e})}else M.E3({collectionSettingsStore:f.settingsStore});e.postSubmitCallbacks.push((e=>{k.mH(m,{collection_uri:h.collectionUri,feature_uri:h.uri,time:Date.now()-N,status:Boolean(e)?"fail":"success"})}))}})}function B(e){let{propertyType:t,collectionContextStore:n,propertyId:o}=e;switch(t){case"ai_custom_prompt":case"ai_summary":case"ai_extract":case"ai_translate":return M.H4({collectionSettingsStore:n.settingsStore,item:{type:"propertyAiAutofill",propertySchema:n.normalizedSchemaStore[o],property:o}});case"ai_keywords":return M.H4({collectionSettingsStore:n.settingsStore,item:{type:"property",property:o,formatKey:n.getPropertyFormatKey()}});default:(0,m.t1)(t)}}function F(e){const{environment:t,collectionContextStore:n,propertyType:o,isSuggestedProperty:r,propertyName:a,selectOptions:s,from:l}=e,c=n.collectionStore(),d=n.collectionViewStore(),u=n.getPropertyFormatKey();if(!c||!u)return;if("relation"===o)return void M.H4({collectionSettingsStore:n.settingsStore,item:{type:"selectRelationSource",property:void 0,formatKey:"collection_page_properties"}});let p=a;"ai_custom_prompt"===o&&(p=b.default.formatMessage(D.aiCustomPromptDefaultPropertyName));const{performResult:m}=R.createAndCommit({userAction:"collectionSettingsCreatePropertyActions.handleCreateNewStandardProperty",environment:t,perform:e=>x.G3({environment:t,collectionStore:c,collectionViewArgs:d?{collectionViewStore:d,format:d.getFormat(),formatKey:u}:void 0,propertyName:p,propertyType:o,selectOptions:s,transaction:e})});(0,i.XU)(o)?B({propertyType:o,propertyId:m,collectionContextStore:n}):M.qU({collectionSettingsStore:n.settingsStore,property:m,formatKey:u,selectNameInitial:!0}),k._H({environment:t,collectionContextStore:n,from:l,property_type:(0,i.TN)(o),property:(0,i.XU)(o)?o:void 0,is_suggested_property:r})}async function O(e){const{environment:t,collectionContextStore:n,intl:o,connectedRelationProperty:s}=e,c=n.collectionStore(),d=n.collectionViewStore(),u=n.getPropertyFormatKey();if(!c||!u)return;const p=s.integration.id;[a.f3,a.mQ].includes(p)||await P.V(t,c,s.integration,Boolean(s.canOnlyAdminAuth));const f=c.getSchema();let g;s.integration.id===a.U9&&f&&0===(0,r.$z)(f).length&&(g=await C.K({environment:t,collectionStore:c})),R.createAndCommit({environment:t,userAction:"collectionSettingsCreatePropertyActions.handleCreateNewConnectedRelationProperty",perform:e=>{g&&x.G3({environment:t,collectionStore:c,collectionViewArgs:d?{collectionViewStore:d,format:d.getFormat(),formatKey:u}:void 0,propertyType:"auto_increment_id",transaction:e});const r=c.getDeletedSchema(),p=(0,m.qP)(r).map((e=>{let[t,n]=e;if(n&&i.NK(n)&&n.connectedRelation.integration_id===a.U9)return{propertyId:t,propertySchema:n}})).filter(m.$K);if(!l.xb(p)){const{propertyId:o}=p[0],i=(0,v.D8)({deletedSchema:r,property:o});if(!i)throw new Error("Deleted property schema was not found");h.xO({environment:t,collectionStore:c,update:i.updateSchema,transaction:e}),h.$N({collectionStore:c,update:i.updateDeletedSchema,transaction:e});const a={type:"property",property:o,formatKey:u};return void M.H4({collectionSettingsStore:n.settingsStore,item:a})}const f=P.c({environment:t,pattern:s.pattern,integration:s.integration,parentCollectionStore:c,transaction:e}),b=x.G3({environment:t,collectionStore:c,collectionViewArgs:d&&u?{collectionViewStore:d,format:d.getFormat(),formatKey:u}:void 0,propertyType:"relation",transaction:e});T.n7({environment:t,collectionContextStore:n,collectionStore:c,property:b,propertyName:s.name,propertyLimit:"no_limit",targetCollectionStore:f,hasInverseRelation:!0,autoRelate:void 0,intl:o,connectedRelation:{integration_id:s.integration.id},transaction:e});const y={type:"property",property:b,formatKey:u};M.H4({collectionSettingsStore:n.settingsStore,item:y}),k._H({environment:t,collectionContextStore:n,from:"view_settings",property_type:"relation",integration_id:s.integration.id})}})}},98834:(e,t,n)=>{n.d(t,{$p:()=>R,R5:()=>M,Zh:()=>T,nx:()=>x,ob:()=>A});n(21703),n(57658);var o=n(41432),r=n(76837),i=n(42875),a=n(23867),s=n(70203),l=n(9291),c=n(27105),d=n(33929),u=n(18245),p=n(94896),m=n(79797),f=n(81193),g=n(54642),h=n(47307),v=n(54532),b=n(96802),y=n(94419),_=n(9953),S=n(993),w=n(98724),k=n(29373);const I=(0,l.defineMessages)({duplicateTemplateError:{id:"databaseTemplatePickerActions.duplicateTemplateFailedError.message",defaultMessage:"Duplicate template failed."}});function C(e){const{environment:t,pageStore:n,copiedFromPointer:o,useInMemoryRecordCache:s,addCopyName:l,transaction:c,resolveTemplateVariables:u}=e,f=n.useCrdt(),b=new m.G(t,o,{inMemoryRecordCache:s});if(s){const e=v.K8(t,{blockId:b.id,inMemoryRecordCache:b.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:!0});if(!e)throw new Error("Client copy could not be created.");v.E9({environment:t,sourceBlockId:b.id,targetBlockPointer:n.pointer,sourceBlockSubtree:e,targetInMemoryRecordCache:n.inMemoryRecordCache,addCopyName:l,transaction:c,deepCopyTransclusionContainers:!1,resolveTemplateVariables:u,useCrdt:f})}else{if(P({environment:t,store:n,properties:b.getProperties(),transaction:c}),u&&w.bt({environment:t,store:n,context:{currentUserId:t.currentUser.id,currentTimeZone:(0,i.r)()},transaction:c}),l){const e=n.getBlockTitleStore();S.sO({environment:t,store:e,value:r.eb(e.getValue()),transaction:c})}const e={copied_from:o.id};_.sW({store:n,data:e,transaction:c});const s={...b.getFormat(),copied_from_pointer:o};delete s.use_crdt,delete s.text_clocks,delete s.text_slice_tree,delete s.automation_id,delete s.app_config_uri,_.sW({store:n.getFormatStore(),data:s,transaction:c}),b.hasContent()&&(p.Z.setStatus(n.id,!0),c.postSubmitCallbacks.push((async e=>{if(e)return h.showErrorMessage(d.default.formatMessage(I.duplicateTemplateError)),void p.Z.setStatus(n.id,!1);await g.duplicateBlock(t,{sourceBlocks:[{id:o.id,spaceId:(0,a.C)(o.spaceId)}],targetBlocks:[{id:n.id,spaceId:(0,a.C)(n.pointer.spaceId)}],addCopyName:l,appendContentOnly:!0,isTemplateInstantiation:!0,resolveTemplateVariables:!!u&&{currentUserId:t.currentUser.id,currentTimeZone:(0,i.r)()},deepCopyTransclusionContainers:!1,useCrdt:f}).next().finally((()=>{p.Z.setStatus(n.id,!1)}))})))}return n}function x(e){const{environment:t,collectionStore:n,transaction:r,title:i,useCrdt:a}=e,l=_.j4({environment:t,type:o.Ti.page,inMemoryRecordCache:n.inMemoryRecordCache,transaction:r,spaceId:n.getTemplatePagesStore().pointer.spaceId,properties:{title:(0,s.TPx)(i||"")},useCrdt:a});return _.sW({store:l,data:{is_template:!0},transaction:r}),y.R3({parent:n.getTemplatePagesStore(),append:l,transaction:r}),l}function T(e){const{environment:t,event:n,collectionStore:r,templateStore:i,transaction:a}=e,s=_.j4({environment:t,type:o.Ti.page,inMemoryRecordCache:i.inMemoryRecordCache,transaction:a,spaceId:r.getTemplatePagesStore().pointer.spaceId,useCrdt:(0,c.SL)({event:n,source:"collection_instantiate_template",contextualDefault:i.useCrdt()})});_.sW({store:s,data:{is_template:!0},transaction:a}),y.BE({parent:r.getTemplatePagesStore(),after:i,insert:s,transaction:a});try{C({environment:t,copiedFromPointer:i.pointer,pageStore:s,addCopyName:!0,transaction:a,resolveTemplateVariables:!1})}catch(l){h.showErrorMessage(d.default.formatMessage(I.duplicateTemplateError))}return s}function M(e){const{collectionStore:t,templateStore:n,transaction:o}=e;y.Od({parent:t.getTemplatePagesStore(),childToRemove:n,transaction:o})}function P(e){const{environment:t,store:n,properties:o,transaction:r}=e,i=n.getPropertiesStore();if("title"in o){const{title:e,...a}=o;return S.sO({environment:t,store:n.getBlockTitleStore(),value:e,transaction:r}),void _.sW({store:i,data:a,transaction:r})}_.sW({store:i,data:o,transaction:r})}function A(e){const{environment:t,store:n,templateStore:o,title:r,isKeyboard:i,isCreateIn:a,transaction:s,from:l}=e,c=n.getProperties(),d=u.default.mark("rum.initialize_collection_template");if(C({environment:t,pageStore:n,copiedFromPointer:o.pointer,useInMemoryRecordCache:n.inMemoryRecordCache!==t.defaultRecordCache.inMemoryRecordCache?n.inMemoryRecordCache:void 0,transaction:s,resolveTemplateVariables:!0}),"template"!==r){const e="empty"===r?void 0:r.text;S.sO({environment:t,store:n.getBlockTitleStore(),value:e,transaction:s})}P({environment:t,store:n,properties:c,transaction:s}),_.sW({store:n,data:{is_template:null},transaction:s}),b.Wq({environment:t,store:n,isLocked:!1,transaction:s}),0===o.getContentLength()&&k.ls({environment:t,store:n,transaction:s}),u.default.measure(d,{environment:t}),f.XQ(t,{template_id:o.id,collection_id:o.getParentId(),is_keyboard:i,is_create_in:a,from:l})}function R(e){const{collectionStore:t,newTemplateIds:n,transaction:o}=e;_.sW({store:t,data:{template_pages:n},transaction:o})}},30188:(e,t,n)=>{n.d(t,{Bb:()=>le,Cz:()=>me,FC:()=>te,R2:()=>ie,VP:()=>de,W9:()=>pe,YE:()=>se,cI:()=>ae,e2:()=>ee,h5:()=>ue,i6:()=>ce,km:()=>ne,rT:()=>J,wA:()=>$,xr:()=>oe});n(57658),n(21703),n(52262),n(24506),n(67294);var o=n(1302),r=n(15145),i=n(92996),a=n(99036),s=n(80951),l=n(72126),c=n(4615),d=n(21202),u=n(23867),p=n(29369),m=n(95371),f=n(39721),g=n(73597),h=n(70842),v=n(97880),b=n(82990),y=n(9291),_=n(75754),S=n(51592),w=n(10906),k=n(97978),I=n(77181),C=n(33929),x=n(29376),T=n(35328),M=n(80444),P=n(77080),A=n(53730),R=n(79797),D=n(36610),E=n(8406),B=n(952),F=n(54642),O=n(54569),Z=n(16956),V=n(31869),U=n(47307),N=n(54532),L=n(96802),j=n(19785),z=n(9953),q=n(79978),H=n(42858),W=n(24677),K=n(82530),G=n(85893);function $(e){const{environment:t,transaction:n,blocks:o,action:r}=e,i=(0,w.fm)(o[0]);if(!i)return;const a=i.subitemTreeStore.state;if(!a)return;const s=i.currentSubitemFormatStoreForUiDisplay.state;if(!s||!s.property)return;const l=i.collectionViewBlockStore();if(!l)return;const c=new m.mp({store:l,pathKey:""},a.map((e=>e)).children),d=function(e,t){const n=new Set(e);let o,r;for(const i of g.JK(t)){if(!n.has(i.value.store)){if(o)return;continue}const e=(0,m.DY)([t],(e=>e===i));if(!e||e.length<2)return;if(o??=e,r=e,n.delete(i.value.store),0===n.size)break}if(o&&r)return h.T.fromNearestCommonAncestor(o,r)}(o,c);if(!d)return;const u=f.o.getIndentOperationsFromTreeRange(d,r),p=new Set,b=[],y="unindentSelf"===r?new Set(u.map((e=>e.target))):new Set;for(const g of u){const{target:e,operation:o}=g,r=(0,m.DY)([c],(t=>t===e));if(void 0===r)return;const a=r[r.length-2];if("indentSelfAndSubtree"===o){if(p.has(a)){p.add(e),b.push(e.value.store);continue}const o=a.children,r=o.indexOf(e);if(0===r)return;const l=o[r-1].value.store;Q({environment:t,parentStore:a.value.store,previousSiblingStore:l,targetStore:e.value.store,subitemFormat:s,transaction:n}),b.push(R.G.createChildStore(l,e.value.store.pointer)),J({collectionContextStore:i,pathKey:(0,I.zV)(a.value.pathKey,l)})}else{if("unindentSelf"!==o)break;{var _;if(y.has(a)){y.delete(e),b.push(e.value.store);continue}if(1===r.length)return;const o=null===(_=r[r.length-3])||void 0===_?void 0:_.value.store;Y({environment:t,parentStore:a.value.store,grandparentStore:o,targetStore:e.value.store,subitemFormat:s,transaction:n}),b.push(R.G.createChildStore(o&&o.isPageBlock()?o:i.collectionViewBlockStore(),e.value.store.pointer))}}if(f.F.applyMutable(c,g))if("indentSelfAndSubtree"===o)p.add(e);else if("unindentSelf"===o){const t=i.subitemExpandedStore.state,n=a.value.pathKey,o=t.get(n);0===a.children.length&&null!=o&&o.isExpanded&&(t.delete(n),i.subitemExpandedStore.emit()),y.delete(e)}else(0,v.t1)(o)}b&&W.Z5({environment:t,stores:b})}function Q(e){const{environment:t,parentStore:n,previousSiblingStore:o,targetStore:r,subitemFormat:i,transaction:a}=e;n.isPageBlock()&&q.Bl({environment:t,sourceStore:n,destStore:r,propertyWithInverse:i,transaction:a}),q.hE({environment:t,sourceStore:o,destStore:r,propertyWithInverse:i,transaction:a,position:{type:"after"}})}function Y(e){const{environment:t,parentStore:n,grandparentStore:o,targetStore:r,subitemFormat:i,transaction:a}=e;q.Bl({environment:t,sourceStore:n,destStore:r,propertyWithInverse:i,transaction:a}),o&&o.isPageBlock()&&q.hE({environment:t,sourceStore:o,destStore:r,propertyWithInverse:i,position:{type:"after",after:n.id},transaction:a})}function X(e){var t,n;const{blocksToDuplicate:o,duplicatedBlocks:r,environment:i,transaction:s,migrateSubitemFormat:c,collectionContextStoreFromPage:d,originalSubitemSchemas:u}=e;if(o.length!==r.length)throw new Error("Error rebuilding relations. blocksToDuplicate and duplicatedBlocks must be the same length");const p=o.at(0);if(!p)return;const{from:m,to:f}=c||function(e){const t=(0,I.g0)(e);if(!t)throw new Error("Error rebuilding relations");const{subitemFormat:n}=t;return{from:n,to:n}}(p),g=(0,w.fm)(p)||d;if(!g)return;const h=(null===(t=g.collectionStore())||void 0===t?void 0:t.getSchema()[m.property])||(null==u?void 0:u.subitemRelationSchema),v=(null===(n=g.collectionStore())||void 0===n?void 0:n.getSchema()[m.inverse])||(null==u?void 0:u.parentRelationSchema);if(!(h&&v&&(0,a.p_)(h)&&(0,a.p_)(v)))return;const b=new Map(l.$R(o.map((e=>e.id)),r));l.$R(o,r).forEach((e=>{let[t,n]=e;const o=(0,I.CJ)({store:t,subitemFormat:{property:m.property},propertySchema:h}),r=(0,I.xb)({store:t,subitemFormat:m,propertySchema:v});o.forEach((e=>{const t=R.G.createChildStore(n,e),o=b.get(e.id);o&&(q.Bl({environment:i,sourceStore:n,destStore:t,propertyWithInverse:m,transaction:s}),q.hE({environment:i,sourceStore:n,destStore:o,propertyWithInverse:f,transaction:s,position:{type:"after"}}))})),r.forEach((e=>{const t=R.G.createChildStore(n,e);b.get(e.id)&&q.Bl({environment:i,sourceStore:t,destStore:n,propertyWithInverse:m,transaction:s})}))}))}function J(e){const{collectionContextStore:t,pathKey:n}=e,o=t.subitemExpandedStore.state,r=o.get(n);null!=r&&r.isExpanded||(o.set(n,{isExpanded:!0,limit:20}),t.subitemExpandedStore.emit())}function ee(e){const t=(0,w.fm)(e);if(!t)return;const n=t.subitemTreeStore.state,o=(0,m.DY)(n.children,(t=>t.value.store===e));if(!o)return;const r=o.map((e=>e.value.store.pointer)),i=(0,I.Af)(r),a=t.subitemExpandedStore.state,s=a.get(i);s&&s.isExpanded&&(a.delete(i),t.subitemExpandedStore.emit())}function te(e){var t;const n=(0,w.fm)(e);if(!n)return;const o=n.subitemTreeStore.state,r=(0,m.DY)(o.children,(t=>t.value.store===e));if(!r)return;const i=n.currentSubitemFormatStoreForUiDisplay.state;if(!i)return;const a=null===(t=n.collectionStore())||void 0===t?void 0:t.getSchema()[i.property];if(!a||"relation"!==a.type)return;if(0===(0,I.CJ)({store:e,subitemFormat:i,propertySchema:a}).length)return;const s=r.map((e=>e.value.store.pointer));J({collectionContextStore:n,pathKey:(0,I.Af)(s)})}function ne(e){var t;const{collectionContextStore:n,relationPropertyId:o,transaction:r,environment:a}=e,s=n.collectionStore();if(!s)return;const l=o?s.getSchema()[o]:void 0,c="relation"===(null==l?void 0:l.type)&&l.property&&"relation"===(null===(t=s.getSchema()[l.property])||void 0===t?void 0:t.type)?l.property:void 0,d=s.getFormat().subitem_property&&o?"collectionViewSubitemActions.changeSubitemProperty":s.getFormat().subitem_property?"collectionViewSubitemActions.turnOffSubitems":"collectionViewSubitemActions.turnOnSubitems";L.FH({stores:[s],update:{subitem_property:o,...s.getFormat().app_config_uri===i.iS?{app_uri_map:{...s.getFormat().app_uri_map?s.getFormat().app_uri_map:{},[i.Es.SubTaskRelation]:o,[i.Es.ParentTaskRelation]:c}}:{}},transaction:r}),k.j(a,"update_subitem_property",{userAction:d})}async function oe(e){const{environment:t,blocks:n,options:o}=e;if(n.some((e=>!e.isPageBlock())))return[];const r=l.Ps(n);if(!r)return[];const i=e.collectionContextStore??(0,w.fm)(r);if(!i)return[];const s=i.collectionStore();if(!s)return[];const c=i.currentSubitemFormatStoreForCollection.state,d=i.normalizedSchemaStore.state,u=(null==c?void 0:c.inverse)&&d[c.inverse];if(!u||!(0,a.p_)(u))return[];const p=u.property;if(!p)return[];const m=s.id,f=s.getSpaceId();if(!n.some((e=>(0,I.CJ)({store:e,subitemFormat:c,propertySchema:u}).length>0)))return[];await A.transactionQueue.drain();const g=await F.getSubitems(t,{collection:{id:m,spaceId:f},blocks:n.map((e=>({id:e.id,spaceId:f}))),childRelationProperty:p,canEdit:null==o?void 0:o.canEdit});return"failed"===g.type?[]:g.data.blocks.map((e=>R.G.createChildStore(s,{table:"block",...e})))}function re(e){const t=l.Ps(e);if(!t)return[];const n=(0,w.fm)(t);if(!n)return[];const o=n.collectionStore(),r=n.collectionViewBlockStore();if(!o||!r)return[];const i=n.currentSubitemFormatStoreForCollection.state,s=n.normalizedSchemaStore.state,c=(null==i?void 0:i.inverse)&&s[i.inverse];if(!c||!(0,a.p_)(c))return[];if(!c.property)return[];const d=new Set(e.map((e=>e.id)));let u=e;const p=[];for(;u.length>0;){const e=l.xH(u.map((e=>(0,I.CJ)({store:e,subitemFormat:i,propertySchema:c})))).filter((e=>!d.has(e.id))).map((e=>R.G.createChildStore(r,e)));for(const t of e)d.add(t.id);p.push(...e),u=e}return p}function ie(e){let{environment:t,blocks:n,recordMaps:o,analyticsFrom:r,transaction:i,migrateSubitemFormat:a,collectionContextStore:s,originalSubitemSchemas:l}=e;const m=n.at(0);if(!m)return[];const f=e=>{const n=o?o.get(e.id):N.K8(t,{blockId:e.id,inMemoryRecordCache:e.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0,skipBlockContent:!0});if(!n)throw new Error("Could not find cached copy of block during sub-item duplication.");return n};n.forEach((e=>{var n;const o=e.getModel();if(!o)return[];const{currentSpaceStore:i}=M.default.getState();let a;i&&o.getParentTable()===p.e0&&o.parent_id&&(a=R.zX.createChildStore(i,{table:p.e0,id:o.parent_id})),B.W(t,{from:r??"copy",type:o.type,teamStore:a,is_toggleable:(0,T._A)(o.type,o.getFormat()),collection_id:e.getAssociatedCollectionId()??(null===(n=e.getCollectionViewCollectionStore())||void 0===n?void 0:n.id),new_page_id:"page"===o.type?e.id:void 0,creating_block_id:e.id})}));const g=n.map((e=>{const n=N.E9({environment:t,transaction:i,sourceBlockId:e.id,targetBlockPointer:{id:(0,c.ZP)(),table:d.iU,spaceId:(0,u.C)(e.pointer.spaceId)},sourceBlockSubtree:f(e),targetInMemoryRecordCache:e.inMemoryRecordCache,addCopyName:!1,deepCopyTransclusionContainers:!m.isTransclusionType(),resolveTemplateVariables:!(m.isInsideTemplate()||m.isInsideFactoryOrDuplicateBlocksAction()),useCrdt:!1}).targetBlock;return z.sW({store:n,data:{content:[]},transaction:i}),n}));return X({blocksToDuplicate:n,duplicatedBlocks:g,environment:t,transaction:i,migrateSubitemFormat:a,collectionContextStoreFromPage:s,originalSubitemSchemas:l}),i.postSubmitCallbacks.push((async e=>{e||await Promise.all(n.map(((e,n)=>F.duplicateBlock(t,{sourceBlocks:[{id:e.pointer.id,spaceId:(0,u.C)(e.pointer.spaceId)}],targetBlocks:[{id:g[n].pointer.id,spaceId:(0,u.C)(g[n].pointer.spaceId)}],addCopyName:!1,appendContentOnly:!0,isTemplateInstantiation:!0,resolveTemplateVariables:!1,deepCopyTransclusionContainers:!1,useCrdt:e.useCrdt()}).next().finally((()=>{})))))})),g}function ae(e){let{blocks:t,transaction:n,from:o,to:r,environment:i,originAction:a}=e;return t.forEach((e=>{(0,I.dI)({store:e,subitemFormat:{property:o.property},originAction:a}).forEach((t=>{const o=R.G.createChildStore(e,t);q.hE({environment:i,sourceStore:e,destStore:o,propertyWithInverse:r,transaction:n,position:{type:"after"}})}))})),t}async function se(e){let{droppedStores:t,createdStores:n,collectionStore:o,environment:r,collectionContextStore:i,groupsPointer:a,alreadyMovedToCollection:s,shouldDuplicate:c}=e;if(!P.default.checkGate("collection_subitem_nested_operations"))return;const d=t.at(0);if(!d)return;const u=(0,I.g0)(d);let p=(0,I.ko)(o);if(!u)return;const m=await oe({environment:r,blocks:t,options:{canEdit:!0}});if(m.length<=0)return;let f=[...m];if(c){const e=await pe({environment:r,blocks:m,analyticsFrom:"subitem_option_drag_drop"});e&&(f=[...e])}K.createAndCommit({userAction:"collectionGroupActions.handleGroupDrop.subitemsDrop",environment:r,perform:e=>{if(!p){le({transaction:e,collectionContextStore:i,environment:r})&&(p=(0,I.ko)(o))}for(const t of f)O.mp({environment:r,store:t,collectionStore:o,collectionContextStore:i,groupsPointer:a,shouldCoerce:!0,transaction:e,alreadyMovedToCollection:s});p&&ce({blocksToDuplicate:[...t,...m],duplicatedBlocks:[...n,...f],environment:r,shouldDuplicate:c,originSubitemFormat:u.subitemFormat,destinationSubitemFormat:p,transaction:e,subitemRelationSchema:u.childRelationSchema,relationPropertyCollectionId:o.id})}}),D.RO(r,{draggedTypes:l.oA(f.map((e=>e.getType()))),from:"subitem_drag",asCopy:c,optionalAnalyticsProperties:{collectionContextStore:i}})}function le(e){let{transaction:t,collectionContextStore:n,environment:o}=e;if(n.permissionScopes.state.isLocked)return;const r=n.collectionStore(),i=n.collectionViewStore();if(!r)return;const a=r.getModel();if(!a)return;const s=n.normalizedSchemaStore.state,l=x.m8(C.default.getIntl(),{targetCollectionStore:r,isSelfRelation:!0,sourceSchema:s,createUnique:!0,from:"subitem"}),c=x.aI(C.default.getIntl(),{sourceCollection:a,isSelfRelation:!0,targetCollectionStore:r,createUnique:!0,from:"subitem"}),d=Z.G3({environment:o,collectionStore:r,collectionViewArgs:i?{collectionViewStore:i,format:i.getFormat(),formatKey:"collection_page_properties"}:void 0,propertyType:"relation",transaction:t});return V.n7({environment:o,collectionContextStore:n,collectionStore:r,property:d,propertyName:l,targetCollectionStore:r,hasInverseRelation:!0,inverseName:c,autoRelate:{enabled:!1},propertyLimit:"no_limit",intl:C.default.getIntl(),transaction:t,from:"subitem",analyticsFrom:"nested_subitem_operation",onlyCheckPermissions:!0}),ne({environment:o,collectionContextStore:n,relationPropertyId:d,transaction:t}),E._H({environment:o,collectionContextStore:n,from:"nested_subitem_operation",property_type:"relation"}),d}function ce(e){let{blocksToDuplicate:t,duplicatedBlocks:n,environment:o,shouldDuplicate:r,originSubitemFormat:i,destinationSubitemFormat:a,transaction:s,subitemRelationSchema:l,relationPropertyCollectionId:c}=e;r?X({blocksToDuplicate:t,duplicatedBlocks:n,environment:o,transaction:s,migrateSubitemFormat:{from:i,to:a}}):ae({blocks:t,transaction:s,from:i,to:a,environment:o})}async function de(e){var t;let{blocks:n,subitems:o,environment:r,canUndo:i,skipConfirmation:a}=e;const s=o||re(n),l=[...n,...s];H.zO(l);const c=n.at(0);if(!c)return;const d=(0,w.fm)(c)??(0,I.Ll)(c,r),u=o||await oe({environment:r,blocks:n,options:{canEdit:!0},collectionContextStore:d}),p=null==d||null===(t=d.collectionStore())||void 0===t?void 0:t.getFormat().app_config_uri,m=(0,S.sN)(p,!0),f=(0,S.Q_)(p,!0);if(!a&&u.length>0){const e=await function(e){let{itemCount:t,subitemCount:n,newItemName:o,newItemNamePlural:r}=e;return new Promise((e=>{U.showDialog({onDismiss(){e(!1)},description:(0,G.jsx)(y.FormattedMessage,{id:"deleteSubitems.confirmation.description",defaultMessage:"This will also delete {subitemCount, plural, one {{subitemCount} sub-{newItemName}} other {{subitemCount} sub-{newItemNamePlural}}}.",values:{subitemCount:n,newItemName:o,newItemNamePlural:r}}),message:(0,G.jsx)("div",{style:{fontWeight:b.Z.fontWeight.semibold,fontSize:18},children:(0,G.jsx)(y.FormattedMessage,{id:"deleteSubitems.confirmation.message",defaultMessage:"Are you sure you want to delete {itemCount, plural, one {this {newItemName}} other {these {newItemNamePlural}}}?",values:{itemCount:t,newItemName:o,newItemNamePlural:r}})}),innerStyle:{textAlign:"center"},showCancel:!0,keepFocus:!0,items:[{label:(0,G.jsx)(y.FormattedMessage,{id:"deleteSubitems.confirmation.acceptLabel",defaultMessage:"Delete"}),color:"red",onAccept:()=>{e(!0)}}]})}))}({itemCount:n.length,subitemCount:u.length,newItemName:m,newItemNamePlural:f});if(!e)return H.bj(l),!1}const{serverCommitResult:g}=K.createAndCommit({userAction:"collectionViewSubitemActions.removeBlocksWithSubitems",environment:r,canUndo:i,perform:e=>{H.Cl({environment:r,blocks:n,transaction:e});for(const t of u)z.sW({store:t,data:{alive:!1},transaction:e})}});return await g,!0}async function ue(e){let{environment:t,blocks:n,collectionContextStore:o}=e;const i=await oe({environment:t,blocks:n,collectionContextStore:o,options:{canEdit:!0}});await Promise.all(i.map((e=>e.load())));const a=(0,I.JR)(o);if(!a)throw new Error("Could not find subitem info during duplication");const s=a.subitemFormat;K.createAndCommit({userAction:"collectionViewSubitemActions.duplicateBlocksWithSubitemsFromPage",environment:t,perform:e=>{const a=ie({blocks:[...n,...i],environment:t,transaction:e,migrateSubitemFormat:{from:s,to:s},collectionContextStore:o,analyticsFrom:"subitem_duplication_page_menu"}),l=o.collectionStore();if(!l)return;a.map((t=>{j.zw({childStore:t,parentStore:l,transaction:e})}));const c=a.at(0);c&&_._({environment:t,store:c,pageVisitSource:r.tY.Duplicate})}})}async function pe(e){var t;let{environment:n,blocks:r,analyticsFrom:i}=e;const a=r.at(0);if(!a)return;const s=(0,I.g0)(a),l=null===(t=(0,w.fm)(a))||void 0===t?void 0:t.collectionViewBlockStore();if(!l||!s)return;const{parentRelationProperty:c,parentRelationSchema:d}=s,u=[...r,...re(r)];H.zO(u);const p=r.at(-1);if(!p)return;const m=await oe({environment:n,blocks:r,options:{canEdit:!0}});let f=[],g=[];K.createAndCommit({userAction:"actionRegistry.duplicateToSelectionWithSubitems",environment:n,perform:e=>{g=ie({blocks:[...r,...m],environment:n,transaction:e,analyticsFrom:i}),f=H.is({environment:n,blocks:g,selection:r,transaction:e,replaceEmptyTextBlock:!1,insertAfterBlock:p,preventSetSelection:!0})}});const h=(0,I.T2)({blocks:f,parentRelationProperty:c,parentRelationSchema:d,collectionViewBlockStore:l});return o.default.afterNextFlush((()=>{o.default.afterNextFlush((()=>{W.Z5({environment:n,stores:h})}))})),H.bj(u),g}function me(e){const{environment:t,block:n,collectionStore:o,subitemFormat:r,transaction:i}=e,a=n.getPropertyValue(r.inverse);s.rq(a).forEach((e=>{const a=R.G.createChildStore(o,e);q.Bl({environment:t,sourceStore:n,destStore:a,propertyWithInverse:{property:r.inverse,inverse:r.property},transaction:i})}))}},98688:(e,t,n)=>{n.d(t,{L:()=>p,v:()=>u});n(21703);var o=n(72126),r=n(45953),i=n(9844),a=n(35794),s=n(80444),l=n(72371),c=n(54642),d=n(9377);async function u(e){const{currentSpaceStore:t}=s.default.state;t&&await p({environment:e.environment,spaceId:t.id,force:!0})}async function p(e){const{environment:t,spaceId:n,force:u}=e;await s.default.waitUntilRendered();const p=l.Z.state;if(!p.loaded&&!p.loading||p.loaded&&n!==p.spaceId||u){l.Z.setState({...l.Z.state,loading:!0});const[e,s]=await Promise.all([c.searchIntegrations(t,{query:"",type:"compliance",spaceId:n}),d.j({environment:t,spaceId:n})]);if("success"!==e.type)throw new Error("Request failed.");const u=r.PF.create(e.data.recordMap),p=r.PF.create(s.recordMap);l.Z.setState({loaded:!0,loading:!1,spaceId:n,integrations:o.MR(o.oA(e.data.integrationIds.map((e=>u.getModel({table:i.K2,id:e})))),(e=>{let{created_at:t}=e;return t})),webhookSubscriptions:o.oA(s.webhookSubscriptionIds.map((e=>p.getModel({table:a.b,id:e,spaceId:n}))))})}}},86080:(e,t,n)=>{n.d(t,{b:()=>i,x:()=>a});var o=n(29477),r=n(81700);const i=function(e){const t=o.UZ();return r.Z.setState({...e,open:!0,onComplete:t.resolve,inputValue:""}),t.promise},a=function(e){const t=r.Z.state;t.open&&(t.onComplete(e.didConfirm),r.Z.reset())}},28673:(e,t,n)=>{n.d(t,{V:()=>h,c:()=>v});n(21703);var o=n(4615),r=n(6287),i=n(23867),a=n(97880),s=n(9291),l=n(70764),c=n(33929),d=n(32363),u=n(79797),p=n(47307),m=n(89475),f=n(9953);const g=(0,s.defineMessages)({authError:{defaultMessage:"Auth failed. Please try again or contact Notion support.",id:"database.viewSettings.propertyTypeSection.connected.authFail"},mobileAdminError:{defaultMessage:"Ask your workspace admin to configure the GitHub (Workspace) app in settings to use this feature.",id:"database.viewSettings.propertyTypeSection.connected.mobileAdminError"},mobileError:{defaultMessage:"Please authorize this integration on the desktop app or a browser.",id:"database.viewSettings.propertyTypeSection.connected.mobileError"}});async function h(e,t,n,o){const r=e.device.isMobile,i=null==t?void 0:t.getSpaceStore();if(!i)return;const a=(0,l.NP)(n.id).length;if(r&&o&&!a){const e=c.default.formatMessage(g.mobileAdminError);throw p.showErrorMessage(e),new Error(e)}if(r&&!o&&!a){const e=c.default.formatMessage(g.mobileError);throw p.showErrorMessage(e),new Error(e)}if(!a&&o&&i.canAdmin()||!a&&!o)try{await m.hM({environment:e,integration:n,spaceId:i.id,from:"collection_settings_property_type"})}catch(s){const e=c.default.formatMessage(g.authError);throw p.showErrorMessage(e),new Error(e)}if(!(0,l.NP)(n.id).length){const e=c.default.formatMessage(g.authError);throw p.showErrorMessage(e),new Error(e)}}function v(e){const{environment:t,pattern:n,integration:s,parentCollectionStore:l,transaction:c}=e;if(!n.connected_relation_properties)throw new Error("Cannot create a connected relation collection without properties");const p=new u.NW(t,{table:r.v,id:(0,o.ZP)(),spaceId:l.pointer.spaceId}),m={};n.connected_relation_sub_schemas&&(0,a.qP)(n.connected_relation_sub_schemas).map((e=>{let[n,a]=e;const s=new u.NW(t,{table:r.v,id:(0,o.ZP)(),spaceId:l.pointer.spaceId}),d={bot_id:void 0,external_object_id:void 0,uri:n,integration_id:void 0,is_placeholder:void 0,original_url:void 0,domain:void 0,external_schema:a,sync_state:void 0,pattern_name:void 0},g={id:s.id,version:0,space_id:(0,i.C)(l.pointer.spaceId),parent_table:r.v,parent_id:p.id,alive:!0,format:d,schema:{}};m[n]=s.id,f.sW({store:s,data:g,transaction:c})}));const g={id:p.id,version:0,space_id:(0,i.C)(l.pointer.spaceId),parent_table:r.v,parent_id:l.id,alive:!0,format:{attributes:[{id:"title",name:"title",type:"inline",format:{type:"title",section:"title"},values:[(0,d.ni)({pattern:n,integration:s})]}],bot_id:void 0,external_object_id:void 0,uri:`notion://user-defined-collection/${s.id}/${n.name}`,integration_id:s.id,is_placeholder:void 0,original_url:void 0,domain:void 0,external_schema:n.connected_relation_properties,sync_state:void 0,pattern_name:n.name,related_external_object_uris_to_instance_ids:m},schema:{}};return f.sW({store:p,data:g,transaction:c}),p}},50950:(e,t,n)=>{n.d(t,{wk:()=>D,Tz:()=>B,OM:()=>N,qo:()=>L,oG:()=>j,dd:()=>z,Nh:()=>F,a9:()=>Z});n(67294);var o=n(15145),r=n(86658),i=n(74686),a=n(55632),s=n(68626),l=n(72126),c=n(91155),d=n(71644),u=n(63143),p=n(9291),m=n(54642),f=n(480),g=n(24405),h=n(56666),v=n(10182),b=n(89728),y=n(85893);const _=function(){window.__c={n:"CookieSnackbarButtons"};const e=(0,f.O7)(),t=(0,g.Fg)();return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(b.Z,{onClick:()=>N(e,{necessary:!0,performance:!0,preference:!0,targeting:!0}),children:(0,y.jsx)("b",{style:{color:t.contentBackground},children:(0,y.jsx)(p.FormattedMessage,{...r.ze.acceptAllButtonLabel})})}),(0,y.jsx)(b.Z,{onClick:()=>N(e,{necessary:!0,performance:!1,preference:!1,targeting:!1}),children:(0,y.jsx)("b",{style:{color:t.contentBackground},children:(0,y.jsx)(p.FormattedMessage,{...r.ze.rejectAllButtonLabel})})}),(0,y.jsx)(v.Z,{hasDismissButton:!0,renderOrigin:e=>(0,y.jsx)(b.Z,{style:{paddingLeft:8,paddingRight:8},...e,children:(0,h.o)({width:14,marginLeft:4,fill:t.contentBackground})})})]})};var S=n(42402),w=n(97978),k=n(12955),I=n(33929),C=n(36867),x=n(80444),T=n(61893),M=n(45293),P=n(1310),A=n(47307);const R=(0,p.defineMessages)({cookieConsentSaveError:{id:"cookieConsent.saveError",defaultMessage:"Cannot record cookie consent, please try again later."}});async function D(e){const{environment:t,onboardingState:n}=e;if(await E(t))return(0,C.g)(t.currentUser.id)>=2?(U(),M.Z.setState({open:!0}),H({environment:t,type:"modal",onboardingState:n}),void w.j(t,"cookie_modal_shown")):void(P.ZP.state.currentItem||(P.ZP.setState({...P.ZP.state,currentItem:{key:(0,d.ZP)(),label:(0,y.jsx)("div",{children:(0,r.Fd)(B,"snackbar")}),right:(0,y.jsx)(_,{})}}),H({environment:t,type:"snackbar",onboardingState:n})))}async function E(e){if(!(0,k.canSetCookie)(e))return!1;if(!(0,k.canShowCookieUi)(e))return!1;const t=await(0,k.getHasPermissionArgs)(e);return"true"===(null==t?void 0:t.notion_check_cookie_consent)&&(null==t||!t.notion_cookie_consent)}function B(e,t){return(0,y.jsx)(S.Z,{href:e,children:t})}function F(e,t){if("necessary"===t)return;const n={...T.Z.getState().permission};n[t]=!n[t],T.Z.setPermission(n),O(e,n)}const O=l.Ds(((e,t)=>{Z(e,t)}),2e3);async function Z(e,t){const n=await m.recordCookieConsent(e,{id:T.Z.getId(),permission:t,document_version:r.fV,userId:e.currentUser.id}).catch((e=>{V({type:"recordCookieConsentError",error:(0,c.Ui)(e)})}));if(!n)return void V({type:"recordCookieConsentEmptyResult"});if("success"!==n.type)return void V({type:"recordCookieConsentReturnsNonSuccess",data:{miscDataToConvertToString:{result:n}}});const s=n.data;await T.Z.setCookieConsent(e,s),o.e9();const l=await w.cG(e),d=o.Zk(l);await a.Pv(d);const{permission:u}=s;w.j(e,"record_cookie_consent",{permission:u,consent_type:(0,i.JT)(u)})}function V(e){let{type:t,data:n,error:o}=e;A.showErrorMessage(I.default.formatMessage(R.cookieConsentSaveError)),s.log({level:"error",from:"cookieActions",type:t,data:n,error:o})}function U(){P.ZP.setState({...P.ZP.state,currentItem:void 0})}function N(e,t){Z(e,t),U(),L()}function L(){A.showMessage({message:I.default.formatMessage(r.ze.reloadAfterSaveMessage),onAccept:()=>{window.location.reload()}})}async function j(e){const{currentUserSettingsStore:t}=x.default.state;if(!t)return;await t.load();const n=t.getSettings();if(!n)return;const o=n.cookie_consent;o?(await T.Z.setCookieConsent(e,o),U()):(T.Z.clearCookieConsent(),await E(e)&&T.Z.setPermission(r.cW))}async function z(e){const t=await(0,k.getCookieConsentCookie)(e);if(!t)return;const n=(0,u.dj)(t);n&&T.Z.setState(n)}const q={tracked:!1};function H(e){let{environment:t,type:n,onboardingState:o}=e;if(q.tracked)return;const r={type:n,onboardingStage:null==o?void 0:o.stage};w.j(t,"cookie_banner_shown",r),q.tracked=!0}},41433:(e,t,n)=>{n.d(t,{Ns:()=>I,ZI:()=>x,fC:()=>C,jf:()=>T,nF:()=>k});n(21703),n(57658);var o=n(80951),r=n(97531),i=n(76837),a=n(42875),s=n(59730),l=n(15157),c=n(19233),d=n(4615),u=n(45953),p=n(21202),m=n(19889),f=n(70203),g=n(95477),h=n(83960),v=n(80444),b=n(79797),y=n(952),_=n(96802),S=n(9953),w=n(993);const k="calloutBlockIcon",I="calloutBlockBackground";function C(e){var t,n,o;const{environment:r,createBlockItem:i,from:a,inMemoryRecordCache:s,transaction:l,useCrdt:c}=e;if(!i.templateRootBlockId||!i.createTemplate)throw new Error("Invalid createBlock item.");const m=(null===(t=v.default.state.currentSpaceStore)||void 0===t?void 0:t.id)??(null===(n=v.default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.getSpaceId()),{targetBlock:f}=x({environment:r,sourceBlockId:i.templateRootBlockId,targetBlockPointer:{id:(0,d.ZP)(),table:p.iU,spaceId:m},sourceBlockSubtree:(0,u.R3)(i.createTemplate(r)),targetRecordCache:s,transaction:l,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,useCrdt:c});if(null===(o=i.postCreateCallback)||void 0===o||o.call(i,f,r),T({store:f,transaction:l}),a&&i.blockType){var g;const e=i.collectionViewType;y.W(r,{from:a,type:i.blockType,collection_id:f.getAssociatedCollectionId()??(null===(g=f.getCollectionViewCollectionStore())||void 0===g?void 0:g.id),view_type:"inline"===e||"full_page"===e?"table":e,is_toggleable:i.isToggleable,automation_id:f.getAutomationId(),new_page_id:"page"===i.blockType?f.id:void 0,creating_block_id:f.id})}return f}function x(e){const{environment:t,sourceBlockId:n,sourceBlockSubtree:o,targetBlockPointer:l,targetRecordCache:c,transaction:d,deepCopyTransclusionContainers:u,resolveTemplateVariables:f,recordPointerMap:h,useCrdt:v}=e,y=t.currentUser.id,{duplicateRecordMap:_,originalToDuplicate:k}=i.PZ({sourceBlockId:n,targetBlockPointer:l,recordMap:o,recordPointerMap:h,options:{deepCopyTransclusionContainers:u,resolveTemplateVariables:!!f&&{currentUserId:y,currentTimeZone:(0,a.r)()},blocksShouldUseCrdt:v},baseUrl:g.default.domainBaseUrl,publicDomainName:g.default.publicDomainName,actor:y?{table:m.KJ,id:y}:void 0,getRecordRole:c.makeGetRecordRoleFn(y)}),I=new b.G(t,l,{inMemoryRecordCache:c});d.postPerformAssertions.push((function(){if(d.isLocal)return;if(!I.getParentStore())throw new s.p8(`Initialized template was not given a parent before being committed in transaction ${d.getUserActionForAnalyticsPurposesOnly()}`)}));for(const{pointer:i,model:a}of _){const e=null==a?void 0:a.__IM_SORRY__getValue();if(!e)continue;const n=(0,b.Kv)(I,i);if(i.table===l.table&&i.id===l.id&&void 0!==c.getRecord({pointer:i,userId:y})){const o=e,{format:r,properties:a,...s}=o,{title:l,...u}=a??{};S.sW({store:n,data:{...s,properties:u},transaction:d});const p=n;if(r){var C;const e=(null===(C=c.getRecord({pointer:i,userId:y}))||void 0===C||null===(C=C.value)||void 0===C?void 0:C.format)??{};for(const t of Object.keys(e))void 0===r[t]&&(r[t]=null);delete r.use_crdt,delete r.text_slice_tree,delete r.text_clocks,Object.keys(r).length>0&&S.sW({store:p.getFormatStore(),data:r,transaction:d})}w.sO({environment:t,store:p.getBlockTitleStore(),value:null==a?void 0:a.title,transaction:d})}else S.sO({store:n,value:i.table===p.iU?(0,r.j1)(e):e,transaction:d})}return{targetBlock:I,originalToDuplicate:k}}function T(e){const{store:t,transaction:n}=e;"code"===t.getType()?function(e){const{store:t,transaction:n}=e,r=t.getProperties(),i=t.getFormat(),a=t.environment.currentUser.id,s=l.Z.get({userId:a,key:h.T.localLanguagePreferenceKey}),d=s&&c.W[s]?s:h.T.defaultLanguage,u=l.Z.get({userId:a,key:h.T.localCodeWrapPreferenceKey}),p=t.getBlockTitleStore(),m=p.getValue(),g=f.vNd(m);g&&w.sO({environment:t.environment,store:p,value:g,transaction:n});void 0===r.language&&S.sW({store:t.getPropertiesStore(),data:{language:o.O2(d)},transaction:n});void 0===i.code_wrap&&S.sW({store:t.getFormatStore(),data:{code_wrap:u},transaction:n})}({store:t,transaction:n}):"table_of_contents"===t.getType()?function(e){const{store:t,transaction:n}=e,o=t.getFormat();void 0===o.block_color&&_.FH({stores:[t],update:{block_color:"gray"},transaction:n})}({store:t,transaction:n}):"callout"===t.getType()?function(e){const{store:t,transaction:n}=e,o=t.environment.currentUser.id,r=l.Z.get({userId:o,key:k})||"💡",i=l.Z.get({userId:o,key:I})||"gray_background",a=t.getFormat();void 0===a.block_color&&_.FH({stores:[t],update:{block_color:i},transaction:n});void 0===a.page_icon&&_.FH({stores:[t],update:{page_icon:r},transaction:n})}({store:t,transaction:n}):"quote"===t.getType()&&function(e){const{store:t,transaction:n}=e,o=t.environment.currentUser.id,r=l.Z.get({userId:o,key:h.l.localSizePreferenceKey});void 0!==r&&S.sW({store:t.getFormatStore(),data:{quote_size:r},transaction:n})}({store:t,transaction:n})}},67133:(e,t,n)=>{n.d(t,{b:()=>a,x:()=>s});var o=n(28748),r=n(24677),i=n(98104);function a(e,t){r.ZH(e),i.ZH(e),o.Z.setState({open:!0,...t})}function s(){o.Z.setState({open:!1,originRect:o.Z.state.originRect})}},99813:(e,t,n)=>{n.d(t,{Wl:()=>b,ji:()=>g,oi:()=>h});var o=n(43593),r=n(17755),i=n(68626),a=n(29477),s=n(11342),l=n(95477),c=n(88864),d=n(54642),u=n(47839),p=n(12714);function m(e){if(!Boolean(e.mobileNative))return!1;const{device:t}=e,n=(0,s.parseMobileAppVersion)(t.mobileAppVersion,t.isAndroid);return!!n&&(t.isIOS?(0,s.isGreaterThanOrEqualToVersion)(n,[0,4,669]):!!t.isAndroid&&(0,s.isGreaterThanOrEqualToVersion)(n,[0,6,735]))}async function f(e,t){return e.device.isElectron||e.device.isMobileNative?await d.getSignedFileUrl(e,t,!1):(0,r.g)({...t,baseURL:l.default.domainBaseUrl,currentUserId:e.currentUser&&e.currentUser.id})}async function g(e,t){let n=t.url;const s=e.mobileNative&&m(e),c=o.E$(t.url,[l.default.secureFileS3.url,l.default.secureFileS3V2.url]);c&&(s&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:"file",from:"download",state:"fetching"}),n=(await a.OI(r.nK,f(e,t))).result),n?c&&s?e.mobileNative.showLightBoxV2({url:n,downloadName:t.downloadName,type:"file",from:"download",state:"url_ready"}):c?v({environment:e,url:n}):p.D({environment:e,url:n}):(s&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:"file",from:"download",state:"error"}),i.log({level:"error",from:"routerActions",type:"openFileUrl",data:{message:`failed to get url for ${t.url}`}}))}function h(e,t){const n=e.mobileNative&&m(e);if(o.x$(t)&&n){const n=o.rF({title:void 0,source:t});e.mobileNative.showLightBoxV2({url:void 0,downloadName:n,type:"file",from:"download",state:"fetching"}),e.mobileNative.showLightBoxV2({url:t,downloadName:n,type:"file",from:"download",state:"url_ready"})}else v({environment:e,url:t})}function v(e){const{environment:t,url:n}=e;t.mobileNative?t.mobileNative.openInAppBrowser(n):t.device.isElectron?u.downloadUrl(n):window.location.href=n}async function b(e,t){c.QI(e,{from:"embedded_block_click",type:t.type});let n=t.url;const s=e.mobileNative&&m(e),d=o.E$(t.url,[l.default.secureFileS3.url,l.default.secureFileS3V2.url]);d&&(s&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:t.type,from:t.from,state:"fetching"}),n=(await a.OI(r.nK,f(e,t))).result),n?d&&s?e.mobileNative.showLightBoxV2({url:n,downloadName:t.downloadName,type:t.type,from:t.from,state:"url_ready"}):p.D({environment:e,url:n}):(s&&e.mobileNative.showLightBoxV2({url:void 0,downloadName:t.downloadName,type:t.type,from:t.from,state:"error"}),i.log({level:"error",from:"routerActions",type:"openFileUrl",data:{message:`failed to get url for ${t.url}`}}))}},42239:(e,t,n)=>{n.d(t,{LQ:()=>F,_4:()=>D,cQ:()=>A,eN:()=>O,f$:()=>B,fX:()=>R,td:()=>E});n(57658);var o=n(41432),r=n(8848),i=n(15095),a=n(42875),s=n(72126),l=n(4615),c=n(23867),d=n(97880),u=n(10906),p=n(95477),m=n(97978),f=n(43250),g=n(98165),h=n(41984),v=n(27406),b=n(81844),y=n(95802),_=n(55367),S=n(86486),w=n(27724),k=n(36610),I=n(47307),C=n(54532),x=n(42858),T=n(24677),M=n(98724),P=n(98104);function A(e,t){_.ZP.state.isDragging&&(_.ZP.reset(),T.$Y({environment:e,phase:w.SelectionPhase.Selected,preventClearEditingText:t}))}function R(e){if(_.ZP.state.isDragging){const{draggedStores:r,currentDropZone:i}=_.ZP.state,a=e.optionKey;let c;if(i){var t,n;const e=i.type===_.Dl.Selectable?y.C.findSelectablesFromStore(i.store):v.Z.findDropTargetsFromKey(i.key);null===(t=e.find((e=>Boolean(e.props.onSelectableDrop))))||void 0===t||null===(t=t.props)||void 0===t||null===(n=t.onSelectableDrop)||void 0===n||n.call(t,{droppedDirection:i.direction,droppedStores:r,duplicate:a}),c=function(e,t){const n=t.props,o="store"in n?n.store:void 0,r=o?b.Z.findOutlinerItemFromStore(o):void 0,i=o&&g.VP(o),a=i&&(0,m.nB)(i),s={...r&&{...a,type:r.type},..."analyticsName"in n&&{dropzone_from:n.analyticsName}};if(!e)return{...s,has_dropzone:!1};let c;switch(e.direction){case _.vh.Above:c="above";break;case _.vh.Below:c="below";break;case _.vh.Left:c="left";break;case _.vh.Onto:c="onto";break;case _.vh.Right:c="right";break;default:(0,d.t1)(e.direction)}if(e.type===_.Dl.Selectable)return{...s,has_dropzone:!0,dropzone_type:"selectable",dropzone_block_id:(0,l.cj)(e.store.id),dropzone_direction:c};return{...s,has_dropzone:!0,dropzone_type:"drop_target",dropzone_key:e.key,dropzone_direction:c}}(i,e[0])}const p=r.find((e=>{const t=e.getType();return Boolean(t&&(0,o.S9)(t))})),f=p&&g.VP(p),h=p&&(0,u.fm)(p);k.RO(e.environment,{draggedTypes:s.oA(r.map((e=>e.getType()))),from:e.analyticsFrom,asCopy:a,draggableProps:{draggable_from:e.analyticsFrom,...f&&(0,m.nB)(f)},dropzoneProps:c,optionalAnalyticsProperties:{collectionContextStore:h}}),A(e.environment),e.environment.device.isPhone&&T.ZH(e.environment)}}function D(e){const{environment:t,files:n,analyticsFrom:o}=e;if(_.ZP.state.isDragging){var r;const e=_.ZP.state.currentDropZone;let s;var i,a;if(e)s=e.type===_.Dl.Selectable?y.C.findSelectableFromStore(e.store):v.Z.findDropTargetFromKey(e.key),null===(i=s)||void 0===i||null===(i=i.props)||void 0===i||null===(a=i.onNativeDrop)||void 0===a||a.call(i,{files:n,droppedDirection:e.direction});k.RO(t,{draggedTypes:[],from:o,asCopy:!1}),A(t,null===(r=s)||void 0===r?void 0:r.props.keepTextSelectionOnDrop)}}function E(e,t){_.ZP.state.isDragging&&(P.ZH(e),_.ZP.setState({..._.ZP.state,...t}))}function B(e,t){if(_.ZP.state.isDragging)return!1;{const{startX:n,startY:o,isNativeDrag:r}=t,i=T.aw(t.stores);P.ZH(e);const a=y.C.getRectFromStore(i[0]);return _.ZP.setState({isDragging:!0,startX:n,startY:o,currentX:n,currentY:o,offsetX:n-(a&&a.left||0),offsetY:o-(a&&a.top||0),currentHintDropZones:[],draggedStores:i,isNativeDrag:r,ghostElements:i.map((e=>t.getGhostElement?t.getGhostElement(e):function(e){const{store:t}=e,n=y.C.findSelectablesFromStore(t);return s.oA(n.map((e=>{if(e.props.canSelect){const t=e.getNode();if(t)return O(t)}})))}({store:e})))}),T.$Y({environment:e,phase:w.SelectionPhase.Selected}),S.default.reset(),!0}}function F(e){const{droppedStores:t,transaction:n,environment:r,duplicate:i,duplicateUseCrdt:s}=e,l=e.resolveTemplateVariables;return t.map((e=>{if(!y.C.findSelectableFromStore(e))return e;if(i){const t=!e.isTransclusionType(),[i,a]=C.Qi({environment:r,stores:[e],addCopyName:(0,h.Z)(e),transaction:n,deepCopyTransclusionContainers:t,targetSpaceId:(0,c.C)(e.pointer.spaceId),resolveTemplateVariables:e.getType()!==o.Ti.factory&&l,baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:s}),d=i[0];return a.then((e=>{e&&I.showErrorMessage(e)})),d}return l&&M.bt({environment:r,store:e,context:{currentUserId:r.currentUser.id,currentTimeZone:(0,a.r)()},transaction:n}),x.Od({store:e,transaction:n}),e}))}function O(e){const t=e.style.transform,n=e.style.transition;e.style.transform="",e.style.transition="";const o=e.getBoundingClientRect();e.style.transform=t,e.style.transition=n;const i=e.cloneNode(!0);!function(e,t){const{firstElementChild:n}=e;if(n&&n.hasAttribute("embed-ghost")){const n=Z(e,[]);if(n){const i=V(e,n),a=V(t,n);if(i&&a)if(i.shadowRoot){const e=i.shadowRoot;let t=null;if(a.createShadowRoot)t=a.createShadowRoot();else if(a.attachShadow)try{t=a.attachShadow({mode:"open"})}catch(o){}t&&(t.innerHTML=e.innerHTML)}else if(!i.src&&i.contentDocument){const e=document.createElement("iframe");e.width=i.offsetWidth,e.height=i.offsetHeight,U(e,a),a.parentElement.replaceChild(e,a),e.onload=t=>{const n=e.contentDocument.children[0],o=i.contentDocument.children[0];U(n,o),n.innerHTML=o.innerHTML}}else a.width=i.offsetWidth,a.height=i.offsetHeight,a.style.backgroundColor=r.ZP.blackWithAlpha(.12),a.style.backgroundImage=null,a.src=""}}}(e,i);const a=getComputedStyle(e);for(let r=0;r<a.length;r++){const e=a[r],t=a.getPropertyValue(e);"app-region"===e&&"none"===t||(i.style[e]=t)}"absolute"!==a.position&&"relative"!==a.position||(i.style.position="",i.style.top="",i.style.left="",i.style.bottom="",i.style.right="");const s=i.querySelectorAll(`.${f.No6}`);for(const r of s)r.remove();i.style.pointerEvents="none";const l=i.querySelectorAll("*");for(const r of l)r.style&&(r.style.pointerEvents="none");return{cloned:i,rect:o}}function Z(e,t){if(e.shadowRoot)return t;if(e instanceof HTMLIFrameElement)return t;{const{firstElementChild:n,nextElementSibling:o}=e;if(n){t.push(0);const e=Z(n,t);if(e)return e;t.pop()}if(o){t[t.length-1]+=1;const e=Z(o,t);if(e)return e}return null}}function V(e,t){return t.reduce(((e,t)=>e&&e.children&&e.children[t]?e.children[t]:null),e)}function U(e,t){i.p4(t.attributes).forEach((t=>{let{name:n,value:o}=t;e.setAttribute(n,o)}))}},91584:(e,t,n)=>{n.d(t,{O$:()=>k,Ui:()=>b,WO:()=>y,cR:()=>S,qN:()=>w,vQ:()=>_});var o=n(99405),r=n(23867),i=n(64002),a=n(9291),s=n(57549),l=n(47307),c=n(47839),d=n(95477),u=n(91924),p=n(7844),m=n(53730),f=n(54642),g=n(92625),h=n(15356);const v=(0,a.defineMessages)({authenticatingWithGoogle:{id:"googleDriveActions.authenticatingWithGoogle.loadingMessage",defaultMessage:"Authenticating with Google…"},googleLoginTitle:{defaultMessage:"Google login",id:"googleDriveActions.loginWithGoogleModal.title"}});async function b(e){const{environment:t,store:n,fileId:o,token:i}=e;await m.transactionQueue.awaitRecordTransaction(n.pointer);const a=await f.initializeGoogleDriveBlock(t,{block:{id:n.id,spaceId:(0,r.C)(n.pointer.spaceId)},fileId:o,token:i});if("failed"!==a.type)return a.data.file&&s.cV(t,{file_type:a.data.file.mimeType??void 0}),a.data;l.showError(a)}function y(e,t){f.refreshGoogleDriveBlock(e,{block:t})}async function _(e){const t=await f.getGoogleDriveAccounts(e,{});return"success"===t.type&&t.data.accounts?t.data:{accounts:[]}}function S(e,t){const{onSuccess:n,onFailure:o}=t;p.Z.setState({open:!0,onConfirm:async()=>{const t=await w(e);t&&t.token?n(t.token):o&&o()},onDecline:o})}async function w(e){const t=(0,u.eC)(e);let n=(0,o.ZQ)(d.default.domainBaseUrl,{authType:t});if(n=t.redirectToAuth?n:await(0,u.HU)(e,n),e.device.isElectron)return void c.openExternalUrl(n);const r=await h.M(e,{width:610,height:700,url:n,titleMessage:v.googleLoginTitle});if(!r)return;const a=i.Qc(r);return await k(e,a.query.code)}async function k(e,t){if(!t)return;g.j({message:v.authenticatingWithGoogle});const n=await f.authWithGoogleForDrive(e,{code:t});if(g.x(),"failed"!==n.type)return s.L3(e,{integration_name:"google"}),n.data;{const e=n.error;console.error(e),l.showError(n)}}},54532:(e,t,n)=>{n.d(t,{E9:()=>Z,K8:()=>N,Qi:()=>U,WJ:()=>V});n(21703),n(57658);var o=n(41432),r=n(76837),i=n(42875),a=n(59730),s=n(64572),l=n(59753),c=n(29477),d=n(4615),u=n(45953),p=n(606),m=n(98963),f=n(18844),g=n(21202),h=n(6287),v=n(13493),b=n(29369),y=n(70203),_=n(9291),S=n(95477),w=n(33954),k=n(33929),I=n(35328),C=n(80444),x=n(88632),T=n(79797),M=n(952),P=n(54642),A=n(41433),R=n(47307),D=n(29533),E=n(9953),B=n(993),F=n(39865);const O=(0,_.defineMessages)({offlineError:{id:"duplicateActions.offlineError.message",defaultMessage:"Please go online to copy this block."},unknownError:{id:"duplicateActions.unknownError.message",defaultMessage:"An unknown error occurred."}});function Z(e){const{environment:t,sourceBlockId:n,targetBlockPointer:o,sourceBlockSubtree:i,targetInMemoryRecordCache:a,addCopyName:s,deepCopyTransclusionContainers:l,resolveTemplateVariables:c,transaction:d,useCrdt:u}=e,{targetBlock:p,originalToDuplicate:m}=A.ZI({environment:t,sourceBlockId:n,targetBlockPointer:o,sourceBlockSubtree:i,targetRecordCache:a,transaction:d,deepCopyTransclusionContainers:l,resolveTemplateVariables:c,useCrdt:u});if(s&&p&&p.isNavigableBlock()){const e=p.getTitleStore();if(e){const n=e.getValue(),o=r.eb(n);B.sO({environment:t,store:e,value:o,transaction:d})}}return{targetBlock:p,originalToDuplicate:m}}function V(e){const{environment:t,sourceBlocks:n,targetInMemoryRecordCache:r,snapshotData:s,addCopyName:l,deepCopyTransclusionContainers:d,resolveTemplateVariables:u,transaction:p,targetSpaceId:m,convertExternalObjectInstancesToPlaceholders:f,useCrdt:g,duplicateOnlyCollectionSchema:h}=e;if(0===n.length)throw new Error("Must duplicate at least one block");const v=n.map(((e,n)=>E.j4({environment:t,type:o.Ti.copyIndicator,inMemoryRecordCache:r,transaction:p,spaceId:m,useCrdt:g}))),b=c.UZ();return p.postSubmitCallbacks.push((async e=>{if(e)(0,a.Jx)(e)?b.resolve((0,w.nX)(k.default.getIntl(),e)):b.resolve(k.default.formatMessage(O.unknownError));else{const e=P.duplicateBlock(t,{sourceBlocks:n,targetBlocks:v.map((e=>({id:e.id,spaceId:e.getSpaceId()}))),snapshotData:s,addCopyName:l,deepCopyTransclusionContainers:d,resolveTemplateVariables:!!u&&{currentUserId:t.currentUser.id,currentTimeZone:(0,i.r)()},convertExternalObjectInstancesToPlaceholders:f,useCrdt:g,duplicateOnlyCollectionSchema:h});let o;for await(const t of e){for(const e of v)D.R(t,e.id);o=t}for(const t of v)D.h(t.id);if(!o)return void b.resolve(void 0);if(o.error){F.Tq({environment:t,blocks:v});const e=(0,w.HV)(k.default.getIntl(),o.error);b.resolve(e)}else b.resolve(void 0)}})),[v,b.promise]}function U(e){const{environment:t,stores:n,addCopyName:o,deepCopyTransclusionContainers:r,resolveTemplateVariables:i,transaction:a,targetSpaceId:s,preferDuplicateLocation:l,analyticsFrom:c,useCrdt:u,duplicateOnlyCollectionSchema:p}=e;if(0===n.length)throw new Error("Must duplicate at least one block");const m=n[0].getSpaceId();if(!n.every((e=>e.getSpaceId()===m)))throw new Error("All stores must be in the same space");if(n.length>1&&!n.every((e=>e.isTypedCollectionViewBlock())))throw new Error("Multiple source blocks only supported for grouped typed DB duplication");for(const d of n){const e=d.getRecordStoreAtRootPath().getValue();let n;const{currentSpaceStore:o}=C.default.getState();var f;if(o&&(null==e?void 0:e.parent_table)===b.e0&&(n=T.zX.createChildStore(o,{table:b.e0,id:e.parent_id})),e)M.W(t,{from:c??"copy",type:e.type,teamStore:n,is_toggleable:(0,I._A)(e.type,e.format),collection_id:d.getAssociatedCollectionId()??(null===(f=d.getCollectionViewCollectionStore())||void 0===f?void 0:f.id),new_page_id:"page"===e.type?d.id:void 0,creating_block_id:d.id})}const h=m!==s;if("local"===l&&1===n.length){const e=n[0],l=N(t,{blockId:e.id,inMemoryRecordCache:e.inMemoryRecordCache,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!r,allowCopyExternalObjectInstances:!h});if(l){const{targetBlock:n}=Z({environment:t,sourceBlockId:e.id,targetBlockPointer:{id:(0,d.ZP)(),table:g.iU,spaceId:s},sourceBlockSubtree:l,targetInMemoryRecordCache:e.inMemoryRecordCache,addCopyName:o,deepCopyTransclusionContainers:r,resolveTemplateVariables:i,transaction:a,useCrdt:u});return[[n],Promise.resolve(void 0)]}}for(const d of n)if(d.inMemoryRecordCache!==t.defaultRecordCache.inMemoryRecordCache)throw new Error("Can only server duplicate from the environment.defaultRecordCache.inMemoryRecordCache.");const v=t.defaultRecordCache.inMemoryRecordCache;return x.Z.state.online||R.showErrorMessage(k.default.formatMessage(O.offlineError)),V({environment:t,sourceBlocks:n.map((e=>({id:e.id,spaceId:e.getSpaceId()}))),targetInMemoryRecordCache:v,addCopyName:o,transaction:a,deepCopyTransclusionContainers:r,resolveTemplateVariables:i,targetSpaceId:s,convertExternalObjectInstancesToPlaceholders:h,useCrdt:u,duplicateOnlyCollectionSchema:p})}function N(e,t){const{blockId:n,inMemoryRecordCache:r,allowCopyCollections:i,requireFullSubtree:a,skipTransclusionContainerChildren:c,allowCopyExternalObjectInstances:d,skipBlockContent:b}=t,_=e.currentUser.id,w=u.Ak.create(),k=new Set,I=[{pointer:{table:g.iU,id:n},parentId:"doesn't matter"}];for(;I.length>0;){const e=I.shift();if(!e)continue;if(k.has(e.pointer.id))continue;k.add(e.pointer.id);const t=n===e.pointer.id;if((0,p.$O)(e.pointer,g.iU)){var C,x,T;const n=r.getRecord({pointer:e.pointer,userId:_});if(!n||!n.value){if(a)return;continue}const i=n.value;if(!t&&i.parent_id!==e.parentId)continue;if(i.type===o.Ti.externalObjectInstance&&!d)return;if(w.setValue(e.pointer,i),null!==(C=i.format)&&void 0!==C&&C.collection_pointer&&I.push({pointer:i.format.collection_pointer,parentId:i.id}),i.collection_id&&I.push({pointer:{table:h.v,id:i.collection_id},parentId:i.id}),i.view_ids)for(const e of i.view_ids)I.push({pointer:{table:v.n,id:e,spaceId:i.space_id},parentId:i.id});if(!(b||c&&"transclusion_container"===i.type)){const e=l.kk.fromBlock(i).getRenderableContentIds();for(const t of e)I.push({pointer:{table:g.iU,id:t},parentId:i.id})}if(i.type===o.Ti.externalObjectInstance){var M,P;const e=(null===(M=i.format)||void 0===M?void 0:M.related_external_object_uris_to_instance_ids)&&Object.values(null===(P=i.format)||void 0===P?void 0:P.related_external_object_uris_to_instance_ids)||[];for(const t of e)I.push({pointer:{table:g.iU,id:t,spaceId:i.space_id},parentId:i.id})}if(i.properties)for(const e of Object.values(i.properties))if(e)for(const t of e)for(const e of y.hDy(t)){if(y.STW(e)){const t=y.TOT(e);I.push({pointer:{table:g.iU,id:t},parentId:i.id})}if(y.j0F(e)){const t=y.zW$(e),n=(0,s.A5)({url:t,baseUrl:S.default.domainBaseUrl,publicDomainName:S.default.publicDomainName});n&&I.push({pointer:{table:g.iU,id:n},parentId:i.id})}if(y.nSN(e)){const t=y.frW(e);t&&I.push({pointer:{table:g.iU,id:t,spaceId:i.space_id},parentId:i.id})}}null!==(x=i.format)&&void 0!==x&&x.automation_id&&I.push({pointer:{table:m.cv,id:i.format.automation_id,spaceId:i.space_id},parentId:i.id}),null!==(T=i.format)&&void 0!==T&&T.ai_instructions_page_pointer&&I.push({pointer:i.format.ai_instructions_page_pointer,parentId:i.id})}else if((0,p.$O)(e.pointer,h.v)){var A;if(!i)return;const t=r.getRecord({pointer:e.pointer,userId:_});if(!t||!t.value){if(a)return;continue}if(t.value.parent_id!==e.parentId)continue;const n=t.value;w.setValue(e.pointer,n),r.forEachRecord(_,(t=>{let{model:n}=t;n.table===g.iU&&n&&n.parent_id===e.pointer.id&&n.alive&&I.push({pointer:n.pointer,parentId:e.pointer.id})}));const o=(null===(A=n.format)||void 0===A?void 0:A.automation_ids)??[];for(const e of o)I.push({pointer:{table:m.cv,id:e,spaceId:n.space_id},parentId:n.id})}else if((0,p.$O)(e.pointer,v.n)){const t=r.getRecord({pointer:e.pointer,userId:_});if(!t||!t.value){if(a)return;continue}if(t.value.parent_id!==e.parentId)continue;w.setValue(e.pointer,t.value)}else if((0,p.$O)(e.pointer,m.cv)){const t=r.getRecord({pointer:e.pointer,userId:_});if(!t||!t.value){if(a)return;continue}if(t.value.parent_id!==e.parentId)continue;w.setValue(e.pointer,t.value);for(const e of t.value.action_ids??[])I.push({pointer:{table:f.Xj,id:e,spaceId:t.value.space_id},parentId:t.value.id})}else if((0,p.$O)(e.pointer,f.Xj)){const t=r.getRecord({pointer:e.pointer,userId:_});if(!t||!t.value){if(a)return;continue}if(t.value.parent_id!==e.parentId)continue;w.setValue(e.pointer,t.value);for(const e of t.value.blocks??[])I.push({pointer:{table:g.iU,id:e,spaceId:t.value.space_id},parentId:t.value.id})}}return w}},47839:(e,t,n)=>{n.r(t),n.d(t,{appUpdateAvailable:()=>M,appUpdateChecking:()=>T,appUpdateError:()=>x,appUpdateFinished:()=>D,appUpdateInstall:()=>E,appUpdateNotAvailable:()=>P,appUpdateProgress:()=>R,appUpdateReady:()=>C,appUpdateReload:()=>A,checkForUpdates:()=>_,clearBrowserHistory:()=>g,clearCookies:()=>ne,clearGoogleAuthCookies:()=>oe,closeGlobalSearchModal:()=>be,closeQuickSearch:()=>_e,downloadUrl:()=>ie,electronApi:()=>d,electronAppFeatures:()=>pe,electronUpdateAvailable:()=>w,electronUpdateChecking:()=>S,electronUpdateError:()=>y,electronUpdateNotAvailable:()=>k,electronUpdateProgress:()=>I,electronUpdateReady:()=>b,fullscreen:()=>O,getAppPath:()=>re,getCurrentZoom:()=>L,getDesktopVersion:()=>u,getSubstitutions:()=>G,inPageSearch:()=>Z,initializeElectron:()=>de,installElectronUpdate:()=>B,isActiveTab:()=>ge,isMainTabOrWindow:()=>$,isProtocolRegistered:()=>le,isRunningUnderArm64Translation:()=>F,isWindowVisible:()=>he,onNewWindow:()=>X,openDevTools:()=>W,openExternalUrl:()=>f,openGoogleDrivePickerPopup:()=>ee,openInNewTab:()=>p,openInNewWindow:()=>m,openOauthPopup:()=>J,openPageFromGlobalSearch:()=>ye,openQuickSearchResult:()=>Se,openQuickSearchShortcutSetting:()=>Ce,openSearchModalFromQuickSearch:()=>Te,quickSearchNotReady:()=>ke,quickSearchReady:()=>we,quickSearchRefresh:()=>Ie,quickSearchVisibilityState:()=>xe,ready:()=>ce,refreshAll:()=>ue,setBadge:()=>h,setLogglyData:()=>te,setOverlay:()=>v,setTabColors:()=>Y,setTheme:()=>Q,setWindowTitle:()=>K,sidebarState:()=>me,subscribeToProtocolUrl:()=>ae,subscribeToSettingsMenuItem:()=>se,toggleMaximized:()=>H,track:()=>ve,windowSidebarState:()=>fe,zoomIn:()=>j,zoomOut:()=>z,zoomReset:()=>q});n(97391);var o=n(40654),r=n(68626),i=n(72126),a=n(64002);function s(){const e=function(e){const t=e.match(/Mac OS X (\d+_\d+)/);if(t)return t[1].split("_").map((e=>parseInt(e,10)));return}(arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.userAgent);return!!e&&(10===e[0]&&e[1]<15)}var l=n(63643);let c="lastProtocolUrlDeduplicationId";const d=l.electronApi,u=l.getDesktopVersion;function p(e){const t=a.T1(e.url);d&&(d.openInNewTab?d.openInNewTab(t,e.makeTabActive,e.position):d.openInNewWindow(t))}function m(e){const t=a.T1(e);null==d||d.openInNewWindow(t)}function f(e){if(d){void 0!==a.yn(e)&&d.openExternalUrl(e)}}function g(){null==d||d.clearBrowserHistory()}function h(e){return null==d?void 0:d.setBadge(e)}function v(e){var t;return null==d||null===(t=d.setOverlay)||void 0===t?void 0:t.call(d,e)}const b={addListener(e){null==d||d.updateReady.addListener(e)},removeListener(e){null==d||d.updateReady.removeListener(e)}},y={addListener(e){var t;null==d||null===(t=d.updateError)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.updateError)||void 0===t||t.removeListener(e)}},_=()=>{var e;null==d||null===(e=d.checkForUpdates)||void 0===e||e.call(d)},S={addListener(e){var t;null==d||null===(t=d.updateChecking)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.updateChecking)||void 0===t||t.removeListener(e)}},w={addListener(e){var t;null==d||null===(t=d.updateAvailable)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.updateAvailable)||void 0===t||t.removeListener(e)}},k={addListener(e){var t;null==d||null===(t=d.updateNotAvailable)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.updateNotAvailable)||void 0===t||t.removeListener(e)}},I={addListener(e){var t;null==d||null===(t=d.updateProgress)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.updateProgress)||void 0===t||t.removeListener(e)}},C={addListener(e){var t;null==d||null===(t=d.appUpdateReady)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateReady)||void 0===t||t.removeListener(e)}},x={addListener(e){var t;null==d||null===(t=d.appUpdateError)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateError)||void 0===t||t.removeListener(e)}},T={addListener(e){var t;null==d||null===(t=d.appUpdateChecking)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateChecking)||void 0===t||t.removeListener(e)}},M={addListener(e){var t;null==d||null===(t=d.appUpdateAvailable)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateAvailable)||void 0===t||t.removeListener(e)}},P={addListener(e){var t;null==d||null===(t=d.appUpdateNotAvailable)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateNotAvailable)||void 0===t||t.removeListener(e)}},A={emit:e=>{var t;null==d||null===(t=d.appUpdateReload)||void 0===t||t.emit(e)},addListener(e){var t;null==d||null===(t=d.appUpdateReload)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateReload)||void 0===t||t.removeListener(e)}},R={addListener(e){var t;null==d||null===(t=d.appUpdateProgress)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateProgress)||void 0===t||t.removeListener(e)}},D={addListener(e){var t;null==d||null===(t=d.appUpdateFinished)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateFinished)||void 0===t||t.removeListener(e)}},E={addListener(e){var t;null==d||null===(t=d.appUpdateInstall)||void 0===t||t.addListener(e)},removeListener(e){var t;null==d||null===(t=d.appUpdateInstall)||void 0===t||t.removeListener(e)}};function B(){null==d||d.installUpdate()}function F(){var e;return null==d||null===(e=d.isRunningUnderArm64Translation)||void 0===e?void 0:e.call(d)}const O={get:()=>null==d?void 0:d.fullscreen.get(),addListener(e){null==d||d.fullscreen.addListener(e)},removeListener(e){null==d||d.fullscreen.removeListener(e)}},Z={start(e){d&&d.inPageSearch&&d.inPageSearch.start(e)},stop(){d&&d.inPageSearch&&d.inPageSearch.stop()},started:{addListener(e){d&&d.inPageSearch&&d.inPageSearch.started.addListener(e)},removeListener(e){d&&d.inPageSearch&&d.inPageSearch.started.removeListener(e)}},stopped:{addListener(e){d&&d.inPageSearch&&d.inPageSearch.stopped.addListener(e)},removeListener(e){d&&d.inPageSearch&&d.inPageSearch.stopped.removeListener(e)}}},V=(e,t,n)=>Math.min(Math.max(e,n),t);let U,N=1;function L(){return N}function j(){d&&d.zoom&&(N+=o.to,d.zoom.set(V(o.x_,o.A_,N)))}function z(){d&&d.zoom&&(N-=o.to,d.zoom.set(V(o.x_,o.A_,N)))}function q(){d&&d.zoom&&(N=o.lO,d.zoom.set(N))}function H(){d&&d.toggleMaximized&&d.toggleMaximized()}function W(){d&&d.openDevTools&&d.openDevTools()}function K(e){d&&d.setWindowTitle&&d.setWindowTitle(e)}function G(){return U||[]}async function $(){return d&&d.isMainTab?d.isMainTab():!d||!d.isMainWindow||d.isMainWindow()}function Q(e){d&&d.setTheme&&d.setTheme(e)}function Y(e){d&&d.setTabColors&&d.setTabColors(e)}function X(e){d&&d.newWindow&&d.newWindow.addListener(e)}async function J(e){if(d&&d.openOauthPopup)return d.openOauthPopup(e)}async function ee(e){if(d&&d.openGoogleDrivePickerPopup)return d.openGoogleDrivePickerPopup(e)}function te(e){d&&(d.setLoggerData?d.setLoggerData(e):d.setLogglyData&&d.setLogglyData(e))}function ne(){d&&d.clearCookies&&d.clearCookies()}function oe(){d&&d.clearAllCookies&&d.clearAllCookies()}async function re(){if(d&&d.getAppPath)return d.getAppPath()}function ie(e){if(d&&d.downloadUrl)d.downloadUrl(e);else{const t=document.createElement("a");t.download=e,t.href=e,t.click()}}function ae(e){d&&d.onNavigate&&d.onNavigate.addListener(((t,n)=>{if("string"!=typeof n&&n.deduplicationID){const e=n.deduplicationID;if(c===e)return void r.log({level:"warning",from:"electronActions",type:"duplicateOnNavigateObjectDetected"});c=e}e(n)}))}function se(e){d&&d.onOpenSettings&&d.onOpenSettings.addListener(((t,n)=>e(n)))}async function le(e){return!(!d||!d.isProtocolRegistered)&&d.isProtocolRegistered(e)}function ce(){d&&d.ready&&d.ready()}async function de(e){const{device:t,electronSqlite:n}=e;if(d){if(await l.getAndCacheDesktopVersionAsync(),d.zoom&&(N=await d.zoom.get()),n&&n.sqliteConnection&&(await n.sqliteConnection.ensureMigrated(),n.sqliteConnection.optimize()),d.getSubstitutions&&t.isElectronMac){const e=await d.getSubstitutions();U=e.filter((e=>e.replace!==e.with)).map((e=>({length:e.replace.length,replace:new RegExp(`\\b${i.hr(e.replace)} $`),with:`${e.with} `})))}t.isElectronMac&&s()&&pe.setPreference("isAutoUpdaterDisabled",!0)}}function ue(e){d&&d.refreshAll&&d.refreshAll(e.includeFocusedWindow)}const pe={get(){if(d&&d.electronAppFeatures)return d.electronAppFeatures.get()},setPreference(e,t){var n;d&&null!==(n=d.electronAppFeatures)&&void 0!==n&&n.setPreference&&d.electronAppFeatures.setPreference(e,t)},addListener(e){d&&d.electronAppFeatures&&d.electronAppFeatures.addListener(e)},removeListener(e){d&&d.electronAppFeatures&&d.electronAppFeatures.removeListener(e)}},me={set(e){d&&d.sidebarState&&d.sidebarState.set(e)},addSetSidebarOpenListener(e){var t;d&&null!==(t=d.sidebarState)&&void 0!==t&&t.addSetSidebarOpenListener&&d.sidebarState.addSetSidebarOpenListener(e)},removeSetSidebarOpenListener(e){var t;d&&null!==(t=d.sidebarState)&&void 0!==t&&t.removeSetSidebarOpenListener&&d.sidebarState.removeSetSidebarOpenListener(e)},addToggleListener(e){d&&d.sidebarState&&d.sidebarState.addToggleListener(e)},removeToggleListener(e){d&&d.sidebarState&&d.sidebarState.removeToggleListener(e)}},fe={get:()=>d&&d.windowSidebarState?d.windowSidebarState.get():Promise.resolve(void 0),set(e){d&&d.windowSidebarState&&d.windowSidebarState.set(e)},addListener(e){d&&d.windowSidebarState&&d.windowSidebarState.addListener(e)},removeListener(e){d&&d.windowSidebarState&&d.windowSidebarState.removeListener(e)}},ge={get:()=>d&&d.isActiveTab?d.isActiveTab.get():Promise.resolve(!1),addListener(e){d&&d.isActiveTab&&d.isActiveTab.addListener(e)},removeListener(e){d&&d.isActiveTab&&d.isActiveTab.removeListener(e)}};async function he(){return d&&d.windowIsVisible?d.windowIsVisible():"visible"===document.visibilityState}const ve={addListener(e){d&&d.track&&d.track.addListener(e)},removeListener(e){d&&d.track&&d.track.removeListener(e)}};function be(){d&&d.closeGlobalSearchModal&&d.closeGlobalSearchModal()}function ye(e){d&&d.openPageFromGlobalSearch&&d.openPageFromGlobalSearch(e)}function _e(){d&&d.closeQuickSearch&&d.closeQuickSearch()}function Se(e){d&&d.openQuickSearchResult&&d.openQuickSearchResult(e)}function we(){d&&d.quickSearchReady&&d.quickSearchReady()}function ke(){d&&d.quickSearchNotReady&&d.quickSearchNotReady()}function Ie(){d&&d.quickSearchRefresh&&d.quickSearchRefresh()}function Ce(){d&&d.openQuickSearchShortcutSetting&&d.openQuickSearchShortcutSetting()}const xe={isVisible:()=>d&&d.quickSearchVisibilityState?d.quickSearchVisibilityState.isVisible():Promise.resolve(!1),addListener(e){d&&d.quickSearchVisibilityState&&d.quickSearchVisibilityState.addListener(e)},removeListener(e){d&&d.quickSearchVisibilityState&&d.quickSearchVisibilityState.removeListener(e)}},Te={addListener(e){d&&d.openSearchModalFromQuickSearch&&d.openSearchModalFromQuickSearch.addListener(e)},removeListener(e){d&&d.openSearchModalFromQuickSearch&&d.openSearchModalFromQuickSearch.removeListener(e)}}},31781:(e,t,n)=>{n.d(t,{vW:()=>E,z:()=>F,TH:()=>L,I:()=>Z,qC:()=>B,qL:()=>U,x1:()=>j,cT:()=>O});n(57658);var o=n(1302),r=n(41432),i=n(80951),a=n(95538),s=n(43593),l=n(70203),c=n(9291),d=n(54642),u=n(48948),p=n(95477),m=n(33929),f=n(45010),g=n(18245),h=n(58202),v=n(53809),b=n(30548);const y=new v.D({key:"urlTurnedBookmarkToastStatusSetting",namespace:b.$p,important:!0,trackingType:"preference"});var _=n(77080),S=n(27411),w=n(88864),k=n(99813),I=n(62365),C=n(96802),x=n(27153),T=n(9953),M=n(64964),P=n(993),A=n(82530),R=n(53471);const D=(0,c.defineMessages)({urlTurnedBookmark:{id:"action.urlTurnedBookmark.snackBarMessage",defaultMessage:"Pasted url is not embeddable, turned to bookmark instead!"}});let E=function(e){return e[e.Page=0]="Page",e[e.PageComment=1]="PageComment",e[e.SidebarComment=2]="SidebarComment",e}({});function B(e){return e===E.PageComment||e===E.SidebarComment}function F(e){const{environment:t,files:n,inMemoryRecordCache:o,transaction:r,pageWidth:i,ignoreOversizedFiles:a,spaceId:s,useCrdt:l}=e;return n.filter((e=>{if(a){if(!R.Q7({environment:t,file:e,preventLimitFreeFileSize:!1}))return R.A3(t),!1}return!0})).map((e=>{if(!e.type||0!==e.type.indexOf("image")&&0!==e.type.indexOf("video")&&0!==e.type.indexOf("audio")||e.type.includes("photoshop")){const n=T.j4({environment:t,type:"file",inMemoryRecordCache:o,transaction:r,spaceId:s,useCrdt:l});return r.postSubmitCallbacks.push((o=>{o||I.c({environment:t,store:n,file:e})})),n}{const n=T.j4({environment:t,type:"embed",inMemoryRecordCache:o,transaction:r,spaceId:s,useCrdt:l});return r.postSubmitCallbacks.push((o=>{o||O({environment:t,store:n,file:e,pageWidth:i,preferredType:void 0})})),n}}))}function O(e){const{environment:t,store:n,file:r,pageWidth:i,preferredType:s}=e,l=S.default.getBlockKey(n.id);x.Z(),R.cT({environment:t,file:r,bucket:"secure",record:n.pointer,onStart:e=>{if(S.default.setKeyState(l,{progressPercent:0,file:r,name:e.name,size:e.size}),r.type.indexOf("image")>=0&&!(0,a.y_)(e.name,"tiff")&&!(0,a.y_)(e.name,"tif")){const e=URL.createObjectURL(r),a=new Image;a.onload=function(){V(t,{store:n,width:a.naturalWidth,height:a.naturalHeight,scale:!0,type:"image",pageWidth:i}),t.device.isMobile&&o.default.afterNextFlush((()=>{f.Z.PageScroller&&f.Z.PageScroller.scrollerHack()})),URL.revokeObjectURL(e)},a.src=e}else{const e=(0,a.Dz)({url:r.name||"",baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,preferredType:s});V(t,{store:n,width:i,type:e,pageWidth:i})}},onProgress:e=>{const t=S.default.getKeyState(l);t&&S.default.setKeyState(l,{...t,progressPercent:e.progressPercent})},onComplete:async e=>{const o=S.default.getKeyState(l);if(o){const r=Boolean(o.dataURL),a=o.name,c=o.size;await Z(t,{source:e,store:n,isDataURL:r,pageWidth:i,preferredType:s,name:a,size:c}),S.default.setKeyState(l,void 0)}},onError:()=>{S.default.setKeyState(l,void 0)},retryWhenOffline:!0})}async function Z(e,t){const{store:n,source:o,isDataURL:i,pageWidth:s,preferredType:c,name:f,size:h}=t;let v=i?"image":(0,a.Dz)({url:o,baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,preferredType:c});const b=z(v,o),{properties:_,type:S,format:k}=await(0,a.Ol)({source:b,type:v,isDataURL:i,pageWidth:s,isMobileDevice:e.device.isMobile,getEmbedData:async t=>{const n=await d.getGenericEmbedBlockData(e,t);return"failed"===n.type?void console.error(n.error):n.data},trackEmbedType:t=>w.Jg(e,{embedType:t})});if(v=S,v===r.Ti.bookmark){const o=n;return await u.K({environment:e,store:o,url:b,transformTimeout:0}),w.mC(e),function(){if("do_not_prompt"===y.state)return;y.state?"displayed_once"===y.state?y.setState("displayed_twice"):"displayed_twice"===y.state&&y.setState("do_not_prompt"):y.setState("displayed_once");M.oV({label:m.default.formatMessage(D.urlTurnedBookmark)})}(),void(t.metric&&g.default.measure(t.metric,{environment:e,data:{embedType:v}}))}let I,x;w.Gl(e,{embedType:S}),f&&h&&(I={size:l.TPx(h)},x=l.TPx(f));const{serverCommitResult:R}=A.createAndCommit({userAction:"embedBlockActions.initializeEmbedBlock",environment:e,perform:t=>{T.sW({store:n.getPropertiesStore(),data:{..._||{},...I},transaction:t}),x&&P.sO({environment:e,store:n.getBlockTitleStore(),value:x,transaction:t}),C.FH({stores:[n],update:k,transaction:t}),T.sW({store:n,data:{type:v},transaction:t})}});await R,t.metric&&g.default.measure(t.metric,{environment:e,data:{embedType:v}})}function V(e,t){let{store:n,...o}=t;A.createAndCommit({userAction:"embedBlockActions.initializeFormat",environment:e,perform:e=>{C.FH({stores:[n],update:(0,a.tj)(o),transaction:e})}})}async function U(e,t){const{store:n}=t,o=n.getProperties();if(o){const u=n.getType(),p=u===r.Ti.bookmark?o.link:o.source,m=i.zB(p),f=l.QaF(o.title),{display_source:g,original_url:h}=n.getFormat(),v=n.isExternalObjectInstanceBlockStore()?h:m||g;let b;v&&(b=s.rF({title:f,source:v}));var a,c,d="file";if("image"===u?d="image":"video"===u&&(d="video"),v)await k.Wl(e,{url:v,downloadName:b,type:d,from:t.from,permissionRecord:t.store.pointer,download:(null===(a=b)||void 0===a?void 0:a.endsWith(".html"))||(null===(c=b)||void 0===c?void 0:c.endsWith(".htm"))})}}const N=(0,c.defineMessages)({downloadingImage:{id:"embedBlockActions.downloading.label",defaultMessage:"Downloading…"}});async function L(e){const{store:t,environment:n}=e,o=await async function(e){let{store:t,environment:n,calledFrom:o}=e;const r=t.getNavigableBlockStore();if(!r)return;const i=await d.getBlockFileDownloadUrl(n,{blockId:t.id,pageBlockId:r.id,meta:{name:o}});if("success"!==i.type)return;const{url:a,fileName:s}=i.data;return{url:a,fileName:s}}({store:t,environment:n,calledFrom:"downloadSource"});if(!o)return;const{url:r,fileName:i}=o;if(r){let o;w.Uk(n,{url:r,fileName:i,from:"embedBlockActions"}),o=s.E$(r,[p.default.secureFileS3.url,p.default.secureFileS3V2.url])?k.ji(n,{url:r,download:!0,downloadName:i,permissionRecord:t.pointer}):function(e){const{store:t,environment:n}=e;if(!n.currentUser.id)return Promise.resolve();const o=t.getProperties(),r=l.QaF(null==o?void 0:o.source),i=l.QaF(null==o?void 0:o.caption);return s.GN(r,t.pointer,p.default.domainBaseUrl,n.currentUser.id,i)}(e),M.oV({label:m.default.formatMessage(N.downloadingImage),durationMs:"keep"}),await o.finally((()=>{M.rN()}))}}const j=e=>{const{store:t}=e,n=h.R.findBlockFromStoreWithMethod(t,"replace");n&&n.replace()},z=function(e,t){return"maps"===e?/^https?:\/\//i.test(t)?_.default.checkGate("remove_apostrophe_for_maps_url")?t.replace(/'/g,""):t:`https://maps.google.com/maps/search/${encodeURIComponent(t)}`:"embed"===e&&/^https:\/\/[^\/]+\.streamlit\.app/.test(t)?`${t}?embed=true`:(0,a.x$)(t)}},89951:(e,t,n)=>{n.d(t,{KT:()=>F,RL:()=>O,f_:()=>B,xv:()=>Z});var o=n(1302),r=n(41432),i=n(95538),a=n(43593),s=n(72126),l=n(99405),c=n(21202),d=n(13493),u=n(70203),p=n(95477),m=n(69783),f=n(28020),g=n(63085),h=n(89224),v=n(58202),b=n(64233),y=n(19111),_=n(79797),S=n(27724),w=n(10743),k=n(52229),I=n(88864),C=n(79554),x=n(48948),T=n(96802),M=n(72711),P=n(9953),A=n(42858),R=n(993),D=n(82530),E=n(68422);function B(e){const t=e.getRecordStoreAtRootPath();return t instanceof _.G&&void 0!==t.getAssociatedCollectionStore()}function F(e){const{environment:t,textStore:n,url:o,oldTextValue:r,urlSelection:a}=e;if(w.Z.state.open||m.Z.state.open||y.Z.state.open||b.Z.state.open||B(n)&&i.Cm({url:o,baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName}))return;const s=h.get();if(!s)return;const l=h.getRect(s);l&&(b.Z.setState({open:!0,textStore:n,url:o,oldTextValue:r,urlSelection:a,selectionRect:l}),I.el(t,{url:o}))}async function O(e){const{environment:t}=e,n=b.Z.state;if(n.open){const{url:i,textStore:m,oldTextValue:h}=n,b=S.default.state.stores,y=b[0];if(!y)return;const w=(0,a.Wv)(i,p.default.secureFileS3.url,p.default.secureFileS3V2.url,p.default.secureFileConfig.rootPath,p.default.secureFileConfig.hostname),I=w?w.link:i,B=(0,l.Wj)({url:I,baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,isMobile:t.device.isMobile,protocol:p.default.protocol,currentUrl:window.location.href});if("page"===B.name)await D.createAndCommitAsync({environment:t,userAction:"embedMenuActions.embedPageAlias",waitForServerCommit:!1,perform:async r=>{let i;if(R.sO({environment:t,store:m,value:h,transaction:r}),B.peekViewBlockId){const e=_.G.createChildStore(m,{table:c.iU,id:B.peekViewBlockId});await e.load(),e.isPageBlock()&&(i=e)}if(i||(i=_.G.createChildStore(m,{table:c.iU,id:B.blockId})),i){if("mention-page"===e.type){const e=i.getRecordModel({id:i.id,table:c.iU});R.lZ({environment:t,store:m,selection:{startIndex:n.urlSelection.startIndex,endIndex:n.urlSelection.startIndex},annotation:u.$0A(B.scrollToBlockId??i.id,null==e?void 0:e.space_id),transaction:r,analyticsFrom:"block"})}else if("create-transclusion"===e.type){if(!B.scrollToBlockId)return;C.ry({environment:t,blocks:S.default.state.stores,copiedBlockIds:[B.scrollToBlockId]})}else if(i.isCollectionView()){const e=B.collectionViewId?_.Xr.createChildStore(i,{table:d.n,id:B.collectionViewId}):void 0;await Promise.all([i.load(),e?e.load():void 0]);const n=e?e.getCollectionStore():i.getCollectionViewCollectionStore();n&&(await n.load(),M.Y_({environment:t,store:y,collectionStore:n,collectionViewStore:e,transaction:r}))}else{const e=y.getParentBlockStore();if(e){const n=k.k({environment:t,parentBlock:e,targetStore:i,transaction:r});A.is({environment:t,blocks:[n],selection:b,transaction:r,replaceEmptyTextBlock:!0})}}o.default.afterNextFlush((()=>{D.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{A.MD({blocks:b,transaction:e})}})}))}}});else if(e.type===r.Ti.bookmark||"teamsInvite"===B.name){const{performResult:e}=D.createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,perform:e=>{var n,o;R.sO({environment:t,store:m,value:h,transaction:e});const i=P.j4({environment:t,type:r.Ti.bookmark,inMemoryRecordCache:y.inMemoryRecordCache,transaction:e,spaceId:0!==b.length?b[b.length-1].pointer.spaceId:null===(n=(0,f.RM)())||void 0===n?void 0:n.pointer.spaceId,useCrdt:0!==b.length?b[b.length-1].useCrdt():(null===(o=(0,f.RM)())||void 0===o?void 0:o.useCrdt())??!1}),a=A.is({environment:t,blocks:[i],selection:b,transaction:e,replaceEmptyTextBlock:!0});return T.FH({stores:[i],transaction:e,update:{bookmark_loading_ttl:Date.now()}}),a}});o.default.afterNextFlush((()=>{D.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{A.MD({blocks:b,transaction:e})}})}));const n=e[0];"teamsInvite"===B.name?await x.K({environment:t,store:n,url:i,teamId:B.teamId}):await x.K({environment:t,store:n,url:i})}else if(e.type===r.Ti.drive){const{performResult:e}=D.createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,perform:e=>{var n,o;R.sO({environment:t,store:m,value:h,transaction:e});const i=P.j4({environment:t,type:r.Ti.drive,inMemoryRecordCache:y.inMemoryRecordCache,transaction:e,spaceId:0!==b.length?b[b.length-1].pointer.spaceId:null===(n=(0,f.RM)())||void 0===n?void 0:n.pointer.spaceId,useCrdt:0!==b.length?b[b.length-1].useCrdt():(null===(o=(0,f.RM)())||void 0===o?void 0:o.useCrdt())??!1});return A.is({environment:t,blocks:[i],selection:b,transaction:e,replaceEmptyTextBlock:!0})}});o.default.afterNextFlush((()=>{D.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{A.MD({blocks:b,transaction:e})}})}));const n=e[0];o.default.afterNextFlush((()=>{const e=v.R.find((e=>e.getBlockStore()===n));e&&e.initializeGoogleDriveBlockFromUrl(i)}))}else{const{performResult:n}=D.createAndCommit({userAction:"embedMenuActions.insertedBlocks",environment:t,perform:e=>{var n,o;R.sO({environment:t,store:m,value:h,transaction:e});const i=P.j4({environment:t,type:r.Ti.copyIndicator,inMemoryRecordCache:y.inMemoryRecordCache,transaction:e,spaceId:0!==b.length?b[b.length-1].pointer.spaceId:null===(n=(0,f.RM)())||void 0===n?void 0:n.pointer.spaceId,useCrdt:0!==b.length?b[b.length-1].useCrdt():(null===(o=(0,f.RM)())||void 0===o?void 0:o.useCrdt())??!1});return A.is({environment:t,blocks:[i],selection:b,transaction:e,replaceEmptyTextBlock:!0})}});o.default.afterNextFlush((()=>{D.createAndCommit({userAction:"embedMenuActions.accept",environment:t,perform:e=>{A.MD({blocks:b,transaction:e})}})}));const i=n[0],a=n=>{D.createAndCommit({environment:t,userAction:"embedMenuActions.accept.insertExtractedData",perform:t=>{let o;e.type&&"mention-page"!==e.type&&"create-transclusion"!==e.type?o=e.type:(o=r.Ti.embed,n&&n.media&&("photo"===n.media.type?o=r.Ti.image:"video"===n.media.type&&(o=r.Ti.video))),E.vs({environment:e.environment,block:i,blockType:o,transaction:t})}}),o.default.afterNextFlush((()=>{const e=v.R.find((e=>e.getBlockStore()===i&&s.mf(e.embed)));e&&e.embed(I)}))};g.W4(t,I).then(a)}}Z()}const Z=function(){b.Z.setState({open:!1})}},4727:(e,t,n)=>{n.d(t,{RL:()=>g,_P:()=>f,jZ:()=>v,xv:()=>h});var o=n(70203),r=n(69783),i=n(68056),a=n(89224),s=n(64233),l=n(19111),c=n(10743),d=n(24666),u=n(68425),p=n(993),m=n(82530);function f(e){const{environment:t,textStore:n,oldSelection:i,oldTextValue:d}=e,p=o.eeV(n.getValue()||[]),m=i.startIndex;if(":"!==p[m])return;const f=o.gPn(p,m-5,m).join("");if(/[0-9]$/.test(f[f.length-1]))return;if(f.endsWith("http")||f.endsWith("https"))return;if(f.endsWith(":"))return;if(c.Z.state.open||r.Z.state.open||l.Z.state.open||s.Z.state.open)return;if(t.device.isPhone)return;const g=a.get();if(!g)return;const h=a.getRect(g);h&&(r.Z.setState({open:!0,textStore:n,oldTextValue:d,oldSelection:i,selectionRect:h}),u.xu(t))}function g(e){const t=r.Z.state,{environment:n,emoji:o,transaction:i}=e;t.open&&(p.sO({environment:n,store:t.textStore,value:t.oldTextValue,transaction:i}),p.Q0({environment:n,store:t.textStore,selection:t.oldSelection,emoji:o,transaction:i}),h())}function h(){r.Z.setState({open:!1})}function v(e){p.N3({direction:"end"});const t=d.default.state;if("editing"!==t.mode)return;const n=(0,i.QY)(t.multiSelection);if(!n)return;let a=!1;if(n.selection.startIndex>0){const e=n.store.getValue()||[],t=o.eeV(e)[n.selection.startIndex-1];/[\s]/g.test(t)||(a=!0)}m.createAndCommit({userAction:"emojiMenuActions.triggerInsertEmojiMenu",environment:e,perform:t=>{a?(p.hJ({environment:e,store:n.store,string:" ",selection:n.selection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t}),p.hJ({environment:e,store:n.store,string:":",selection:{startIndex:n.selection.startIndex+1,endIndex:n.selection.endIndex+1},disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!1,transaction:t})):p.hJ({environment:e,store:n.store,string:":",selection:n.selection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!1,transaction:t})}});const s=r.Z.state;s.open&&r.Z.setState({...s,showPopupWithEmptyFilter:!0})}},36280:(e,t,n)=>{n.d(t,{Wj:()=>g,gt:()=>v,qn:()=>f});n(21703);var o=n(1302),r=n(70203),i=n(97880),a=n(83631),s=n(68056),l=n(89224),c=n(89086),d=n(66949),u=n(24666),p=n(993),m=n(98104);function f(e){var t;const{environment:n,selectedToken:o,selectionRect:i,analyticsFrom:p}=e,f=l.get();if(!f)return;if("editing"!==u.default.state.mode)return;const g=null===(t=(0,s.QY)(u.default.state.multiSelection))||void 0===t?void 0:t.store;if(!g)return;const h=o||a.JT(u.default.state);h&&m.Z5({store:g,selection:h.position});const v=c.lV(u.default.state),b=h?r.o0h(h.token):a.Jf(v),y=a.by({environment:n,equation:b,displayMode:"inline"}),_=h?{editingToken:h.token}:{annotations:a.nk(u.default.state)};d.Z.setState({open:!0,value:b,error:y,savedTextSelectionState:u.default.state,savedTextSelectionRect:i||a.TJ({environment:n,selection:f}),..._,analyticsFrom:a.D9({source:p,currentEquationToken:Boolean(h),selectedText:v})}),u.default.setState({mode:"empty"})}function g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d.P.Forward;d.Z.isOpen()&&(h({equationStore:d.Z,getNextSelection:t=>e===d.P.Forward?{startIndex:t.endIndex,endIndex:t.endIndex}:e===d.P.Backward?{startIndex:t.startIndex,endIndex:t.startIndex}:(0,i.t1)(e)}),d.Z.reset(),o.default.afterNextFlush((()=>{u.default.emit()})))}function h(e){const{equationStore:t,getNextSelection:n}=e;if(!t.isOpen())return;const{savedTextSelectionState:o}=t.state,r=(0,s.QY)(o.multiSelection);if(!r)return;const i=n(r.selection);if(m.Z5({store:r.store,selection:i}),"editing"!==u.default.state.mode)throw new Error("TextSelectionStore should have a selection after calling `setSelection`.");t.setState({...t.state,savedTextSelectionState:u.default.state})}function v(e){const{environment:t,equationStore:n,transaction:o}=e;n.isOpen()&&(n.state.error||n.state.editingToken&&r.o0h(n.state.editingToken)===n.state.value||(!function(e){const{environment:t,equationStore:n,transaction:o}=e;if(!n.isOpen())return;if(n.state.error)return;const{savedTextSelectionState:i}=n.state,{multiSelection:s}=i;let l;p.pz({environment:t,multiSelection:s,transaction:o}),n.state.value&&(l=a.qZ({equationState:n.state,isTemporary:!1}),p.mM({environment:t,store:s.start.store,index:s.start.index,tokens:[l],transaction:o})),h({equationStore:n,getNextSelection:e=>{const t=l?r.eeV([l]).length:0;return{startIndex:e.startIndex,endIndex:e.startIndex+t}}}),u.default.setState({mode:"empty"})}({environment:t,equationStore:d.Z,transaction:o}),h({equationStore:n,getNextSelection:e=>({startIndex:e.endIndex,endIndex:e.endIndex})}),a.ND({environment:t,equation:n.state.value,from:n.state.analyticsFrom})))}},57400:(e,t,n)=>{n.d(t,{BX:()=>f,Of:()=>g,Th:()=>p,Tm:()=>m,Yh:()=>u,mc:()=>v});var o=n(15157),r=n(12139),i=n(54642),a=n(47307),s=n(12955),l=n(64496),c=n(77080),d=n(7339);async function u(e){const t=await(0,s.getExperimentDeviceId)(e),n=e.currentUser.id;let r;const i=(0,l.qE)();if(r=(0,l._3)(e)&&i?(0,l.fP)(t,n,i):o.Z.get({userId:n,key:c.localExperimentsV2Key}),r){const e=r.deviceId!==t,o=r.userId!==n,i=Boolean(r.test);!e&&!o||i||(r=void 0,c.default.reset())}r?c.default.updateState(r,e):await p({environment:e,force:!1}),c.default.getState().isLoaded||c.default.updateState({experimentsBySpace:{},experimentsWithoutSpace:[],isLoaded:!0,userId:n,deviceId:t,test:!1},e),c.default.isStatsigEnabled()&&await d.C.initialize(e)}async function p(e){const{environment:t,force:n}=e;if((0,l._3)(t)&&!n){var o;if(null!==(o=t.mobileNative)&&void 0!==o&&o.api.getExperimentData){const e=await t.mobileNative.api.getExperimentData();e?c.default.updateState(e,t):b({message:"Attempt to get experiments from the mobile cache did not return a result."})}else b({message:"getExperimentData is not implemented in the react native API."})}else{const e=await h(t);"failed"!==e.type&&c.default.updateState(e.data,t)}}async function m(e){const t=await h(e);"failed"!==t.type&&o.Z.set({userId:t.data.userId,key:c.localExperimentsV2Key,value:t.data})}async function f(e,t,n){if(!c.default.state.isLoaded)return;const o=await(0,s.getExperimentDeviceId)(e),r=await i.updateExperimentOverride(e,{experimentId:t,experimentGroup:n,deviceId:o});"failed"!==r.type?await p({environment:e,force:!1}):a.showError(r)}async function g(e){if(!c.default.state.isLoaded)return;const t=await(0,s.getExperimentDeviceId)(e),n=await i.resetExperimentOverrides(e,{deviceId:t});"failed"!==n.type?(await p({environment:e,force:!1}),a.showMessage({message:"Successfully reset experiment overrides."})):a.showError(n)}async function h(e){const t=await(0,s.getExperimentDeviceId)(e),n=e.currentUser.id,o=await i.getClientExperimentsV2(e,{deviceId:t});return"failed"===o.type&&b(o,n,t),o}function v(){c.default.reset()}function b(e,t,n){r.rn(e,{from:"experimentActions",type:"ExperimentFetchError",data:{deviceId:n,userId:t}})}},89475:(e,t,n)=>{n.d(t,{$$:()=>A,cM:()=>D,hM:()=>R});n(21703);var o=n(77657),r=n(74181),i=n(149),a=n(99405),s=n(89101),l=n(98275),c=n(9852),d=n(94826),u=n(64002),p=n(9291),m=n(95477),f=n(91924),g=n(24608),h=n(77080),v=n(30874),b=n(92083),y=n(57549),_=n(54642),S=n(47307),w=n(47839),k=n(94273),I=n(15356),C=n(31120),x=n(8055),T=n(97627),M=n(12170);const P=(0,p.defineMessages)({authenticating:{id:"externalIntegrationAuthActions.authenticationWithIntegration.loadingMessage",defaultMessage:"Authorizing with integration…"},titleMessage:{id:"externalIntegrationAuthActions.loginWithExternalIntegrationPopupModal.title",defaultMessage:"Authenticate"}});async function A(e){const{environment:t,integration:n,spaceId:o,from:r}=e,i=n.id,s=t.currentUser.id,l=(0,f.eC)(t);if(!s)throw new Error("No user id found");let c;y.Iv(t,{integrationId:i,from:r});const u=(0,d.I$)(i);if("dlp"===(null==u?void 0:u.type)||"ediscovery"===(null==u?void 0:u.type)){const e=await _.createOauthAuthorizationCode(t,{integrationId:i,spaceId:o});if("failed"===e.type)return S.showError(e),{error:`Unexpected error creating authorization code: ${(0,g.pO)(e)}`};c=e.data.code}await E({environment:t,notionAuthorizationCode:c,integration:n,spaceId:o,userId:s,authType:l,from:r,callbackRouteName:(null==u?void 0:u.id)===d.ZB.datadog.id?a.AY.datadogAuthCallback:a.AY.authCallback}),await M.pJ({environment:t}),"workspace_connections_redirect"===r&&b.Z.setState({open:!0,openedFrom:"workspace_connections_redirect",currentTab:"integrations",defaultSubtab:"workspace_connections",highlightedSetting:void 0})}async function R(e){const{environment:t,spaceId:n,integration:d,externalObjectInstanceBlockId:p,unfurlUrl:b,from:A}=e;c.In(void 0);const R=d.id,D=R===o.nO?v.Z.completeSlackAuthentications.state:v.Z.externalAuthentications.state,B=new Set(D.filter((e=>{let{integration_id:t}=e;return t===R})).map((e=>e.parent_id)));R===o.f3&&T.pc(t);const F=(0,o.BP)({integrationId:R,env:"production"}),O=(0,r.lT)(m.default.domainBaseUrl),Z=d.redirect_uris.includes(O)?O:d.redirect_uris[0],V=await _.createOauthAuthorizationCode(t,{integrationId:R,spaceId:n,...F?{redirectUri:Z}:{}});if("failed"===V.type)return S.showError(V),{error:`Unexpected error creating authorization code: ${(0,g.pO)(V)}`};const U=V.data.code,N=t.currentUser.id,L=(0,f.eC)(t),j=a.AY.authCallback;if(!N)return{error:"User must be signed in."};const z={environment:t,notionAuthorizationCode:U,integration:d,spaceId:n,externalObjectInstanceBlockId:p,unfurlUrl:b,authType:L,from:A,userId:N,callbackRouteName:j};(0,o.BP)({integrationId:R,env:"production"})?await async function(e){const{environment:t,redirectUri:n,notionAuthorizationCode:o,integration:r,spaceId:c,externalObjectInstanceBlockId:d,unfurlUrl:p,authType:f,userId:g}=e,v=await async function(e){const{integration:t}=e;if("external"===t.type&&void 0!==t.info.handled_by_integrations_server){if("github"===t.info.handled_by_integrations_server)return await async function(e){const{environment:t,notionAuthorizationCode:n,spaceId:o,authType:r}=e,i={notion_workspace_id:o,notion_user_id:t.currentUser.id,notion_last_visited_url:window.location.href,notion_authorization_code:n,callback_type:r.callbackType,...r.redirectToAuth&&{redirectToAuth:"true"}},c=h.default.checkGate("enable_server_integrations_proxy"),d=(0,u.bf)({url:(0,l.r8)("production",c),query:{...i}});if((t.device.isTablet||t.device.isMobile)&&t.mobileNative&&"on"===h.default.getEligibleGroup({experimentId:"allow_auth_with_app_browser_for_mobile",defaultGroup:"control"}))return void t.mobileNative.openInAppBrowser(d);if(t.device.isElectron){if(h.default.checkGate("enable_oauth_from_desktop_ux_v2")){const e=(0,u.bf)({url:`${m.default.domainBaseUrl}${s._j.initiateExternalAuthenticationFromDesktop}`,query:{redirectUri:encodeURIComponent(d)}});w.openExternalUrl(e)}else w.openExternalUrl(d);return}const p=await I.M(t,{width:610,height:700,url:d,titleMessage:P.titleMessage});if(!p)return;const f=(0,a.Wj)({url:p,isMobile:t.device.isMobile,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,protocol:m.default.protocol,currentUrl:window.location.href}),{url:g}=k.Vr(t);"externalAuthCallback"===f.name&&await C.xp({route:f,environment:t});x.c4({url:g||s._j.root,environment:t})}(e),{value:{success:!0}};if("slack"===t.info.handled_by_integrations_server){return h.default.checkGate("link_preview_auth_with_server_integration")?(await async function(e){const{environment:t,userId:n,spaceId:o,authType:r,from:i,externalObjectInstanceBlockId:c,options:d,notionAuthorizationCode:p}=e,f={notion_workspace_id:o,notion_user_id:n,notion_last_visited_url:window.location.href,auth_initiator:i,callback_type:r.callbackType,slack_workspace_id:null==d?void 0:d.slackWorkspaceId,external_object_instance_block_id:c,...r.redirectToAuth&&{redirectToAuth:"true"},notion_authorization_code:p},g=h.default.checkGate("enable_server_integrations_proxy"),v=(0,u.bf)({url:(0,l.St)("production",g),query:{...f}});if(t.mobileNative)return void t.mobileNative.openInAppBrowser(v);if(t.device.isElectron){if(h.default.checkGate("enable_oauth_from_desktop_ux_v2")){const e=(0,u.bf)({url:`${m.default.domainBaseUrl}${s._j.initiateExternalAuthenticationFromDesktop}`,query:{redirectUri:encodeURIComponent(v)}});w.openExternalUrl(e)}else w.openExternalUrl(v);return}const b=await I.M(t,{width:610,height:700,url:v,titleMessage:P.titleMessage});if(!b)return;const y=(0,a.Wj)({url:b,isMobile:t.device.isMobile,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,protocol:m.default.protocol,currentUrl:window.location.href});"externalAuthCallback"===y.name&&await C.xp({route:y,environment:t})}(e),{value:{success:!0}}):{error:{success:!1}}}return"zendesk"===t.info.handled_by_integrations_server?(await async function(e){const{environment:t,notionAuthorizationCode:n,spaceId:o,authType:r,externalObjectInstanceBlockId:i}=e,l={notion_workspace_id:o,notion_user_id:t.currentUser.id,notion_last_visited_url:window.location.href,notion_authorization_code:n,external_object_instance_block_id:i,callback_type:r.callbackType,integration_id:e.integration.id,...r.redirectToAuth&&{redirectToAuth:"true"}},c=(0,u.bf)({url:`${m.default.domainBaseUrl}/initiateExternalAuthentication`,query:{...l}});if(t.device.isElectron)return void w.openExternalUrl(c);const d=await I.M(t,{width:610,height:700,url:c,titleMessage:P.titleMessage});if(console.log(`The popup callback: ${d}`),!d)return;const p=(0,a.Wj)({url:d,isMobile:t.device.isMobile,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,protocol:m.default.protocol,currentUrl:window.location.href}),{url:f}=k.Vr(t);"externalAuthCallback"===p.name&&await C.xp({route:p,environment:t});x.c4({url:f||s._j.root,environment:t})}(e),{value:{success:!0}}):{error:{success:!1}}}return{error:{success:!1}}}(e);if(i.x.isSuccess(v))return;const b={externalObjectInstanceBlockId:d,spaceId:c,userId:g,callbackType:f.callbackType,...f.redirectToAuth&&{redirectToAuth:"true"}},y={code:o,notion_state:JSON.stringify(b),integration_id:r.id,external_url:p,redirect_uri:n},_=(0,u.bf)({url:n,query:{...y}});if(t.device.isElectron){if(h.default.checkGate("enable_oauth_from_desktop_ux_v2")){const e=(0,u.bf)({url:`${m.default.domainBaseUrl}${s._j.initiateExternalAuthenticationFromDesktop}`,query:{redirectUri:encodeURIComponent(_)}});w.openExternalUrl(e)}else w.openExternalUrl(_);return}const S=await I.M(t,{width:610,height:700,url:_,titleMessage:P.titleMessage});if(!S)return;const T=(0,a.Wj)({url:S,isMobile:t.device.isMobile,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,protocol:m.default.protocol,currentUrl:window.location.href});"externalAuthCallback"===T.name&&await C.xp({route:T,environment:t})}({...z,integration:d,notionAuthorizationCode:U,redirectUri:Z}):await E(z),y.Iv(t,{integrationId:d.id,numberOfAccountsAlreadyConnected:B.size,from:A}),await M.pJ({environment:t});return{value:{externalAuthentication:v.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===R})).find((e=>!B.has(e.parent_id)))}}}function D(e){const{environment:t,notion_workspace_id:n,notion_user_id:o,notion_last_visited_url:r,notion_authorization_code:i,external_object_instance_block_id:a,callback_type:s,redirectToAuth:c,zendeskSubDomain:d}=e,p={notion_workspace_id:n,notion_user_id:o,notion_last_visited_url:r,notion_authorization_code:i,external_object_instance_block_id:a,callback_type:s,zendeskSubDomain:d,...c&&{redirectToAuth:"true"}},m=h.default.checkGate("enable_server_integrations_proxy"),f=(0,u.bf)({url:(0,l.vl)("production",m),query:{...p}});t.device.isElectron?w.openExternalUrl(f):window.location.href=f}async function E(e){const{environment:t,notionAuthorizationCode:n,integration:o,spaceId:r,userId:i,authType:l,externalObjectInstanceBlockId:c,from:d,callbackRouteName:p}=e,g=o.id,h={notionAuthorizationCode:n,userId:i,spaceId:r,integrationId:g,externalObjectInstanceBlockId:c,callbackType:l.callbackType,...l.redirectToAuth&&{redirectToAuth:"true"}};let v=(0,u.bf)({url:`${m.default.domainBaseUrl}${s._j.externalIntegrationPopupRedirect}`,query:{...h}});if(v=l.redirectToAuth?v:await(0,f.HU)(t,v),t.device.isElectron)return void w.openExternalUrl(v);const b=await I.M(t,{width:610,height:700,url:v,titleMessage:P.titleMessage});if(!b)return;const y=(0,a.Wj)({url:b,isMobile:t.device.isMobile,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,protocol:m.default.protocol,currentUrl:window.location.href});y.name===p&&await C.wN({route:y,environment:t,integrationId:g,from:d})}},62365:(e,t,n)=>{n.d(t,{c:()=>u,v:()=>p});var o=n(70203),r=n(64002),i=n(27411),a=n(27153),s=n(9953),l=n(993),c=n(82530),d=n(53471);function u(e){const{store:t,file:n,environment:o}=e,r=i.default.getBlockKey(t.id);a.Z(),d.cT({environment:o,file:n,bucket:"secure",record:t.pointer,onStart:e=>{i.default.setKeyState(r,{progressPercent:0,file:n,name:e.name,size:e.size})},onProgress:e=>{const t=i.default.getKeyState(r);t&&i.default.setKeyState(r,{...t,progressPercent:e.progressPercent})},onComplete:e=>{const n=i.default.getKeyState(r);n&&c.createAndCommit({userAction:"fileBlockActions.uploadFile",environment:o,perform:a=>{p({environment:o,store:t,source:e,name:n.name,size:n.size,transaction:a}),i.default.setKeyState(r,void 0)}})},onError:()=>{i.default.setKeyState(r,void 0)},retryWhenOffline:!0})}const p=function(e){const{environment:t,store:n,source:i,name:a,size:c,transaction:d}=e;let u;a?u=a:i&&(u=(0,r.je)(i)),l.sO({environment:t,store:n.getBlockTitleStore(),value:o.TPx(u),transaction:d}),s.sW({store:n.getPropertiesStore(),data:{source:o.TPx(i),size:o.TPx(c)},transaction:d})}},3297:(e,t,n)=>{n.d(t,{DK:()=>U,OH:()=>L,S:()=>Z,VE:()=>q,fD:()=>j,nM:()=>H,qd:()=>W,sC:()=>O,yR:()=>N});var o=n(15145),r=n(42875),i=n(15157),a=n(72126),s=n(29477),l=n(89101),c=n(97880),d=n(9291),u=n(35683),p=n(75754),m=n(91851),f=n(95477),g=n(27105),h=n(97978),v=n(28020),b=n(84210),y=n(33929),_=n(80444),S=n(89256),w=n(36610),k=n(81193),I=n(47307),C=n(54532),x=n(96802),T=n(92625),M=n(11302),P=n(19785),A=n(69915),R=n(8055),D=n(28014),E=n(82530);const B=750,F="forkPageTemplate";function O(){S.Z.setState({open:!1})}async function Z(e){const{environment:t,store:n,originRect:r}=e;w.Zz(t,n.id);const{RouterStore:i}=t,a=i.state.route;if("page"===a.name&&a.requestedOnPublicDomain){const e=(0,b.ZP)({store:n,fullyQualified:!1,duplicate:!0,pageVisitSource:o.tY.Duplicate});return void R.Li({environment:t,url:e,extraSearchParams:{...await A.tc(t),utm_source:"public_page",utm_content:"duplicate_button",tid:await(0,h.cG)(t),from:"public_page",n:"duplicate_public_page"}})}const{currentUserRootStore:s}=_.default.state;if(s){const e=v.o(s);if(1===e.length){const o=e[0],r=o.getSpaceStore();if(!r)return;U({environment:t,store:n,spaceStore:r,spaceViewStore:o,isPrivate:!0,context:"public_page_duplicate_single_workspace"})}else S.Z.setState({open:!0,store:n,originRect:r})}else H({currentUserId:t.currentUser.id,blockId:n.id}),R.c4({environment:t,url:l._j.login})}const V=(0,d.defineMessages)({untitledBlockRecordTitle:{defaultMessage:"Untitled",id:"forkPageActions.untitledBlockRecordTitle"},untitledSpaceRecordTitle:{defaultMessage:"Untitled",id:"forkPageActions.untitledSpaceRecordTitle"},loadingStateDisplayText:{defaultMessage:"Duplicating {blockTitle} to {spaceTitle}…",id:"forkPageActions.loadingStateDisplayText"}});async function U(e){const{environment:t,store:n,spaceStore:r,context:i}=e,{blockTitle:a}=N({store:n,spaceStore:r}),l=Date.now();let c;const d=e.duplicateFunc?e.duplicateFunc():L({...e,useCrdt:K(e)}),[m]=await Promise.all([d.then((e=>(c=Date.now()-l,e))),(0,s.Vs)(B)]);T.x();const f=Date.now()-l;"public_page_duplicate_multiple_workspace"!==i&&"public_page_duplicate_single_workspace"!==i&&"signin_after_duplicate"!==i||k.Xy(t,{from:"publicPage",success:!m.error,template_name:a,template_block_id:n.id,target_space_id:r.id,context:i,template_duplication_duration_ms:c,template_duplication_duration_with_minimum_ms:f},e.shouldLogToStatsig),void 0!==m.error?I.showErrorMessage(m.error):p._({environment:t,store:m.value,visitType:u.vu.Link,pageVisitSource:o.tY.Duplicate})}function N(e){var t,n;const{store:o,spaceStore:i}=e,a=y.default.getIntl();let s=null===(t=o.getModel())||void 0===t?void 0:t.getRenderTitleWithEmoji({getRecordModel:o.getRecordModel,userTimeZone:(0,r.r)(),placeholder:a.formatMessage(V.untitledBlockRecordTitle),intl:a});void 0===s&&(s=a.formatMessage(V.untitledBlockRecordTitle));let l=null===(n=i.getModel())||void 0===n?void 0:n.getRenderTitleWithEmoji({placeholder:a.formatMessage(V.untitledSpaceRecordTitle)});return void 0===l&&(l=a.formatMessage(V.untitledSpaceRecordTitle)),T.j({message:V.loadingStateDisplayText,interpolatedValues:{blockTitle:s,spaceTitle:l}}),{blockTitle:s,spaceTitle:l}}async function L(e){const{environment:t,store:n,spaceStore:o,spaceViewStore:r,isPrivate:i,duplicateOnlyCollectionSchema:a}=e;return new Promise((s=>{E.createAndCommit({userAction:"forkPageActions.forkPage",environment:t,perform:l=>{const[c,d]=C.Qi({environment:t,stores:[n],transaction:l,addCopyName:!1,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,targetSpaceId:o.id,baseUrl:f.default.domainBaseUrl,publicDomainName:f.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:K(e),duplicateOnlyCollectionSchema:a}),u=c[0];d.then((e=>{e?s({error:e}):(s({value:u}),u.isLocked()&&E.createAndCommit({userAction:"forkPageActions.forkPageWithLoadingAndNavigate",environment:t,perform:e=>{x.Wq({environment:t,store:u,isLocked:!1,transaction:e})}}))})),D.Hj({environment:t,spaceStore:o,spaceViewStore:r,pageStore:u,isPrivate:i,location:{type:"prepend"},transaction:l})}})}))}async function j(e){const{environment:t,store:n,duplicateOnlyCollectionSchema:o}=e,r=_.default.state.currentSpaceStore,i=_.default.state.currentSpaceViewStore,s=_.default.state.mainEditorCurrentBlockStore;if(!r||!i||!s)return;const l=await m.NN({environment:t,block:n,action:"duplicate"});if("user_canceled"===l)return;return await new Promise((s=>{E.createAndCommit({userAction:"forkPageActions.duplicateTo",environment:t,perform:d=>{const[u,p]=C.Qi({environment:t,stores:l,transaction:d,addCopyName:e.addCopyName,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,targetSpaceId:r.id,baseUrl:f.default.domainBaseUrl,publicDomainName:f.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:z({...e,blocksToDuplicate:l}),duplicateOnlyCollectionSchema:o});p.then((n=>{n?s({error:n}):(s({value:u}),e.unlockPage&&u.find((e=>e.isLocked()))&&E.createAndCommit({userAction:"forkPageActions.duplicateToHelper",environment:t,perform:e=>{u.forEach((n=>{n.isLocked()&&x.Wq({environment:t,store:n,isLocked:!1,transaction:e})}))}}))}));const m={type:"append",after:e.appendWithoutAfter?void 0:n.id},g=a.d9(u).reverse();if("team"===e.newParent.table)M.at({transaction:d,currentSpaceViewStore:i,teamStore:e.newParent,targets:u,environment:t,location:m,action:"move",value:{type:"team",id:e.newParent.id,spaceId:r.id}});else if("block"===e.newParent.table)for(const t of g)P.jG({parentStore:e.newParent,childStore:t,transaction:d,after:m.after});else if("space"===e.newParent.table)for(const e of g)D.Hj({environment:t,spaceStore:r,spaceViewStore:i,pageStore:e,isPrivate:!0,location:m,transaction:d});else(0,c.t1)(e.newParent);return u}})}))}function z(e){const{newParent:t,blocksToDuplicate:n,event:o}=e;return"block"===t.table?t.useCrdt():"space"===t.table&&(0,g.Sy)({event:o,contextualDefault:n.every((e=>e.useCrdt()))})}async function q(e){const{environment:t}=e,n=await j({...e,addCopyName:!0});n&&(void 0!==n.error?I.showErrorMessage(n.error):p._({environment:t,store:n.value[0],visitType:u.vu.Link,pageVisitSource:o.tY.Duplicate}))}function H(e){let{currentUserId:t,blockId:n}=e;i.Z.set({userId:t,key:F,value:n})}function W(e){return i.Z.get({userId:e,key:F})}function K(e){const{isPrivate:t,store:n,useCrdt:o}=e;return"boolean"==typeof o?o:t?(0,g.dy)({source:"private",contextualDefault:n.useCrdt()}):n.useCrdt()}},96802:(e,t,n)=>{n.d(t,{FH:()=>m,MF:()=>_,Mp:()=>S,Wq:()=>f,bf:()=>w,eO:()=>v,fs:()=>h,hc:()=>g,is:()=>y,zM:()=>b});var o=n(41432),r=n(43593),i=n(15157),a=n(72126),s=n(63143),l=n(95477),c=n(24990),d=n(79797),u=n(41433),p=n(9953);function m(e){const{stores:t,update:n,transaction:r}=e;for(const a of t)p.sW({store:a.getFormatStore(),data:(0,s.Q2)(n),transaction:r}),a instanceof d.G&&a.getType()===o.Ti.callout&&n.block_color&&i.Z.set({userId:a.environment.currentUser.id,key:u.Ns,value:n.block_color})}function f(e){const{environment:t,store:n,isLocked:o,transaction:r}=e,{id:i}=t.currentUser;if(!i)return;const a={block_locked:o,block_locked_by:i};p.sW({store:n.getFormatStore(),data:a,transaction:r})}function g(e){const{environment:t,store:n,alignment:o,transaction:r}=e,{id:i}=t.currentUser;if(!i)return;const a={block_alignment:o};p.sW({store:n.getFormatStore(),data:a,transaction:r})}function h(e){const{store:t,url:n,position:o,transaction:i}=e,a=(0,r.Wv)(n,l.default.secureFileS3.url,l.default.secureFileS3V2.url,l.default.secureFileConfig.rootPath,l.default.secureFileConfig.hostname),s=a?a.link:n;m({stores:[t],update:{page_cover_position:o},transaction:i});const c=t.getCoverStore();c&&p.sO({store:c,value:s,transaction:i})}function v(e){const{store:t,url:n,transaction:o}=e,i=(0,r.Wv)(n,l.default.secureFileS3.url,l.default.secureFileS3V2.url,l.default.secureFileConfig.rootPath,l.default.secureFileConfig.hostname);m({stores:[t],update:{social_media_image_preview_url:i?i.link:n},transaction:o})}function b(){const e=a.UP(["Activities","Objects","Travel & Places"]),t=c.Z.state.emojiByCategory[e];return a.UP(t)}function y(e){const{store:t,transaction:n}=e,o=t.getIconStore();if(o){if(!o.getValue()){const e=b();p.sO({store:o,value:e,transaction:n})}}}function _(e){const{store:t,transaction:n}=e,o=t.getCoverStore();o&&p.sO({store:o,value:null,transaction:n})}function S(e){const{store:t,coverPosition:n,transaction:o}=e;if(t.isCollectionView()){const e=t.getCollectionViewCollectionStore();if(e)return void p.sW({store:e.getFormatStore(),data:{collection_cover_position:n},transaction:o})}m({stores:[t],update:{page_cover_position:n},transaction:o})}function w(e){const{store:t,coverPosition:n,transaction:o}=e;m({stores:[t],update:{card_cover_position:n},transaction:o})}},47678:(e,t,n)=>{n.d(t,{Y:()=>u});var o=n(72126),r=n(45010),i=n(80444),a=n(24612),s=n(27724),l=n(77503),c=n(54564),d=n(42858);function u(e){const{RouterStore:t}=e,{PageScroller:n}=r.Z;if("page"===t.state.route.name&&i.default.state.currentLoadingContainerStore&&i.default.state.currentLoadingContainerStore.state.ready)if(a.Z.reset(),l.Z.reset(),t.state.route.scrollToBlockId){const n=[t.state.route.scrollToBlockId];d.WG(e,n);const o=s.default.state.stores[0];o&&t.state.route.discussionId&&c.Ib({environment:e,blockStore:o,discussionIds:[t.state.route.discussionId],analyticsFrom:"page_load",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:!1})}else t.state.route.discussionId&&i.default.state.mainEditorCurrentBlockStore?c.Ib({environment:e,blockStore:i.default.state.mainEditorCurrentBlockStore,discussionIds:[t.state.route.discussionId],analyticsFrom:"page_load",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:!1}):"pop"===t.state.action&&t.state.historyState&&(n&&o.hj(t.state.historyState.scrollTop)&&n.scrollTo(t.state.historyState.scrollTop,void 0),t.state.historyState.blockIds&&d.DQ(e,t.state.historyState.blockIds))}},54604:(e,t,n)=>{n.d(t,{ui:()=>a,xv:()=>s,zp:()=>l});var o=n(36610),r=n(17903),i=n(38302);function a(e){const{environment:t,renderFullScreenNode:n,fullScreenNodeRect:a,contentAspectRatio:s,block:l,imageUrl:c}=e;o.Lf(t,{type:"open"}),i.Z.setState({...i.Z.state,isOpen:!0,fullscreenNodeAnimationComplete:!1,backgroundAnimationComplete:!1,renderFullScreenNode:n,startScrollTop:r.Z.state.scrollTop,fullScreenNodeRect:a,contentAspectRatio:s,block:l,imageUrl:c})}function s(){i.Z.setState({...i.Z.state,isOpen:!1})}function l(e){return e<1020?0:32}},44886:(e,t,n)=>{n.d(t,{A1:()=>h,WY:()=>f,dD:()=>p,gq:()=>y,nt:()=>b,rB:()=>g,uv:()=>m,vi:()=>v});n(57658);var o=n(41432),r=n(72126),i=n(28020),a=n(73959),s=n(35328),l=n(95802),c=n(26664),d=n(45131),u=n(94419);function p(e){const{parentStore:t,block:n,type:o,transaction:r}=e,i=t.getTransclusionReferenceTargetStore()??t,a=i.getContentStores(),l=a.indexOf(n);if(l<=0)return;const c=a[l-1];if(!c)return;if(!_(i)||!_(c))return;u.Od({parent:i.getContentStore(),childToRemove:n,transaction:r});const{child:p}=u.R3({parent:c.getContentStore(),append:n,transaction:r});if("self"===o&&!p.isType("table"))for(const s of p.getContentStores().reverse())u.Od({parent:p.getContentStore(),childToRemove:s,transaction:r}),u.BE({parent:c.getContentStore(),insert:s,after:p,transaction:r});return s.BX(c)&&d.Z.setOpen(c.id,!0),p}function m(e){const{grandparentStore:t,parentStore:n,block:o,transaction:r}=e,i=t.getTransclusionReferenceTargetStore()??t;if(i.getContentStores().indexOf(n)<0)return;const a=n.getContentStores(),s=a.indexOf(o);if(s<0)return;if(!_(i)||!_(n))return;if("transclusion_container"===n.getType()||"transclusion_reference"===n.getType())return;if(_(o))for(let c=s+1;c<a.length;c++){const e=a[c];u.Od({parent:n.getContentStore(),childToRemove:e,transaction:r}),u.R3({parent:o.getContentStore(),append:e,transaction:r})}u.Od({parent:n.getContentStore(),childToRemove:o,transaction:r});const{child:l}=u.BE({parent:i.getContentStore(),insert:o,after:n,transaction:r});return l}function f(e){const{transaction:t}=e,n=e.blocks,o=n[0];if(!o)return;const r=S(o);if(!r)return;const{previousChildStore:i}=r,a=i.getContentStore();return s.BX(i)&&d.Z.setOpen(i.id,!0),n.map((e=>{const n=e.getRecordStoreUIParent();null!=n&&n.valueIs(c.i)&&u.Od({parent:n,childToRemove:e,transaction:t});return u.R3({parent:a,append:e,transaction:t}).child}))}function g(e){const{transaction:t}=e;let n=e.blocks;const o=n[0];if(!o)return;const i=w(o);if(!i)return;const{closestParentStore:a,closestParentParentStore:s}=i,l=a.getContentStores(),d=s.getContentStore();if(l){let e;for(const[t,o]of l.entries())if(o.id===n[n.length-1].id){e=l.splice(t+1);break}n=r.d9(n).reverse(),n=n.map(((n,o)=>{const r=n.getRecordStoreUIParent();null!=r&&r.valueIs(c.i)&&u.Od({parent:r,childToRemove:n,transaction:t});const i=u.BE({parent:d,insert:n,after:a,transaction:t});if(0===o&&e&&_(n))for(const a of e){const e=a.getRecordStoreUIParent();null!=e&&e.valueIs(c.i)&&u.Od({parent:e,childToRemove:a,transaction:t}),u.BE({parent:n.getContentStore(),insert:a,transaction:t})}return i.child}))}return n}function h(e){const{transaction:t,blocks:n}=e,o=n[0];if(!o)return;const a=i.RM();if(!a)return;const s=I(a),l=r.cx(s,(e=>e.parent===o.getRecordStoreUIParent()&&e.after===o)),c=r.qr(s,((e,t)=>t<l&&e.parent===o.getRecordStoreUIParent())),d=r.dF(s,((e,t)=>t<c&&!o.uiContains(e.parent)));return d?x({blocks:n,listPosition:d,transaction:t}):void 0}function v(e){const{transaction:t,blocks:n}=e,o=r.Z$(n);if(!o)return;const a=i.RM();if(!a)return;const s=I(a),l=r.cx(s,(e=>e.parent===o.getRecordStoreUIParent()&&e.after===o)),c=s.find(((e,t)=>t>l&&!o.uiContains(e.parent)));return c?x({blocks:n,listPosition:c,transaction:t}):void 0}function b(e){return Boolean(e&&S(e))}function y(e){return Boolean(e&&w(e))}function _(e){const t=i.np(),n=e.getType(),r=e.getFormat();return n&&((0,o.TT)(n,r)||e===t)}function S(e){const t=(0,a.sQ)(e);if(null==t||!t.isDefined()||!_(t))return;const n=t.getContentStores(),o=n[n.indexOf(e)-1];return null!=o&&o.isDefined()&&_(o)?{previousChildStore:o}:void 0}function w(e){const t=(0,a.sQ)(e);if(!t)return;if(!t.isDefined()||!_(t))return;const n=(0,a.sQ)(t);return n&&n.isDefined()&&_(n)?{closestParentStore:t,closestParentParentStore:n}:void 0}function k(e,t){let n=[];const{store:o}=e.props;if(e.props.canDropAbove&&C(o)){const e=o.getRecordStoreUIParent();null!=e&&e.valueIs(c.i)&&n.push({parent:e})}const i=t.filter((t=>t.getContextClosestSelectable()===e));for(const a of i)n=r.G0(n,k(a,t));if(e.props.canDropBelow&&C(o)){const e=o.getRecordStoreUIParent();null!=e&&e.valueIs(c.i)&&(e.id===o.id?n.push({parent:e}):n.push({parent:e,after:o}))}return n}function I(e){let t=[];const n=l.C.getMembersByDOMOrder({filter:()=>!0}),o=e.getContentStores();for(const i of o){const e=n.find((e=>e.props.store===i));e&&(t=r.G0(t,k(e,n)))}return t}function C(e){return"collection"!==e.getParentTable()}function x(e){const{blocks:t,listPosition:n,transaction:o}=e,i=r.d9(t).reverse();for(const r of t){const e=r.getRecordStoreUIParent();null!=e&&e.valueIs(c.i)&&u.Od({parent:e,childToRemove:r,transaction:o})}let a;return a=n.after?i.map((e=>u.BE({insert:e,after:n.after,parent:n.parent,transaction:o}).child)):i.map((e=>u.Ce({prepend:e,parent:n.parent,transaction:o}).child)),a}},88295:(e,t,n)=>{n.d(t,{Hk:()=>M,c_:()=>C,f8:()=>I,gt:()=>T,lP:()=>x});var o=n(41432),r=n(21202),i=n(97880),a=n(82798),s=n(19785),l=n(68422),c=n(28020),d=n(98165),u=n(46654),p=n(80444),m=n(83212),f=n(79797),g=n(952),h=n(54569),v=n(98834),b=n(94419),y=n(60870),_=n(11302),S=n(19358),w=n(9953),k=n(82530);function I(e){const{environment:t,transaction:n,titleText:o,recordStoreParent:i}=e,{databaseTemplate:s,createInValue:l}=function(e,t){let n;if("page"===e.type){const o=f.G.createChildStore(t,{table:r.iU,id:e.id});if(o.isTemplate()){const t=(0,d.Dg)(o,1);t&&(n=o,e={type:"page",id:t.id})}}return{databaseTemplate:n,createInValue:e}}(e.createInValue,i),c="block"===l.type?f.G.createChildStore(i,{table:r.iU,id:l.id}):void 0,u=w.j4({transaction:n,environment:t,type:"page",inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,properties:o?{title:[[o]]}:void 0,spaceId:i.pointer.spaceId,useCrdt:"block"===l.type&&(0,a.TO)(c).useCrdt()});let p;if("block"===l.type)S.YM({transaction:n,childStore:u,parentStore:(0,a.TO)(c),alive:!0});else p=_.Ws({transaction:n,environment:t,targets:[u],value:l});return{environment:t,databaseTemplate:s,createdPages:[u],moveToStorePromise:p}}async function C(e){const{environment:t,createdPages:n,databaseTemplate:o,moveToStorePromise:i}=e.createInState;let a;(null==n?void 0:n.length)>0&&(a=n[0].id),g.W(t,{type:"page",from:e.analyticsFrom,new_page_id:a,creating_block_id:a});const{currentSpaceStore:s}=p.default.state;if(o)k.createAndCommit({userAction:"inlinePageActions.completeCreateIn",environment:t,perform:e=>{n.forEach((n=>v.ob({title:{text:n.getTitleValue()},environment:t,store:n,templateStore:o,isKeyboard:!1,isCreateIn:!0,transaction:e,from:"inline_page_action"})))}}),s&&await y.j2(s,s.id,o.id);else{const e=await i;s&&e&&e.table===r.iU&&await y.j2(s,s.id,e.id)}}function x(e){const{environment:t,transaction:n,parentStore:a,inlinePageIds:l}=e;if(0===l.length)return;const c=f.G.createChildStore(a,a.pointer),p=(0,d.qA)(c).find((e=>{if(e.table!==r.iU)return!1;const t=e.getType(),n=e.getFormat();return!(!t||!n)&&((0,o.Um)(t,n)||(0,o.S9)(t))})),g=p&&p.isCollectionView()?p.getCollectionViewCollectionStore():p,v=g&&m.Z.getMode(t,g);if(!g||(0,u.YF)(v)||!g.canEdit()){for(const e of l)s.nO({pageStore:f.G.createChildStore(a,{table:r.iU,id:e}),transaction:n});return}let y=a;for(const o of l){const e=f.G.createChildStore(a,{table:r.iU,id:o});if(e.isEmptyPage()){s.nO({pageStore:e,transaction:n});continue}const l=!e.isDefined()||Boolean(e.getAlive());S.YM({parentStore:g,childStore:e,transaction:n,alive:l}),"block"!==g.table?"collection"!==g.table?(0,i.t1)(g):h.mp({environment:t,store:e,collectionStore:g,shouldCoerce:!0,groupsPointer:[],transaction:n}):(b.BE({parent:g.getContentStore(),after:y,insert:e,transaction:n}),y=e)}}function T(e){const t=c.np();if(t){if(e&&e.table===r.iU)return{pageStore:(0,d.Dg)(e,0)||t,createInValue:{type:"block",id:e.id}};if(e&&(0,d.n3)(e)){const t=(0,d.Dg)(e,0);if(t)return{pageStore:t,createInValue:{type:"page",id:t.id}}}return{pageStore:t,createInValue:{type:"page",id:t.id}}}}async function M(e,t){const{createInValue:n,blocksToTransform:o}=t,i="page"===n.type?new f.G(e,{table:r.iU,id:n.id}):void 0,a=Boolean(i&&i.isTemplate()),{performResult:{transformedPages:s,pageStore:c}}=await k.createAndCommitAsync({environment:e,userAction:"inlinePageActions.createNewPageIn",waitForServerCommit:!0,perform:async t=>{const s=o.map((n=>l.vs({environment:e,block:n,blockType:"page",transaction:t})));let c;if("page"===n.type)if(i&&a){const n=i.getAssociatedCollectionStore(),o=null==n?void 0:n.getParentPointer();o&&o.table===r.iU&&(c=await _.Y({transaction:t,environment:e,targets:s,value:{type:"page",id:o.id}}))}else{const{mainEditorCurrentBlockStore:o}=p.default.state;o&&o.id!==n.id&&(c=await _.Y({transaction:t,environment:e,targets:s,value:n}))}else"team"===n.type&&await _.Ws({transaction:t,environment:e,targets:s,value:n});return{transformedPages:s,pageStore:c}}});await C({analyticsFrom:"new_page_in",createInState:{environment:e,createdPages:s,databaseTemplate:a?i:void 0,moveToStorePromise:Promise.resolve(c)}})}},96313:(e,t,n)=>{n.d(t,{QZ:()=>D,az:()=>B,pg:()=>E});var o=n(26263),r=n(14577),i=n(41432),a=n(59753),s=n(99405),l=n(21202),c=n(33709),d=n(23867),u=n(70203),p=n(97880),m=n(9953),f=n(24677),g=n(98104),h=n(95477),v=n(69783),b=n(65598),y=n(89224),_=n(70726),S=n(64233),w=n(48863),k=n(19111),I=n(79797),C=n(10743),x=n(52229),T=n(88864),M=n(94419),P=n(4408),A=n(993),R=n(82530);function D(e){const{environment:t,textStore:n,blockStore:i,url:a,oldTextValue:u,urlSelection:p}=e;if(C.Z.state.open||v.Z.state.open||k.Z.state.open||S.Z.state.open)return!1;const m=y.get();if(!m)return!1;const f=y.getRect(m);if(!f)return!1;const g=(0,s.Wj)({url:a,baseUrl:h.default.domainBaseUrl,publicDomainName:h.default.publicDomainName,isMobile:t.device.isMobile,protocol:h.default.protocol,currentUrl:window.location.href});if("page"===g.name&&!!g.discussionId&&g.discussionId){const e=g.discussionId,s=g.blockId,m=i.getParentBlockStore();if(!m)return!1;const h=(0,I.Kv)(m,{table:l.iU,id:s,spaceId:(0,d.C)(m.pointer.spaceId)}),v=(0,I.Kv)(h,{table:c.qF,id:e,spaceId:(0,d.C)(i.pointer.spaceId)});if("none"===v.getRole())return!1;const y=new r.Z((()=>b.D4(v)[0]),{debugName:"firstCommentStore"}),S=new o.Z({name:"internalUnfurlingMenuActions.activate",isTemporaryData:!0});t.defaultRecordCache.inMemoryRecordCache.addCacheOverride(S);const k=i.clone(S),C=n.clone(S),x=m.clone(S);return w.Z.setState({args:{commentStore:y},stores:{blockStore:i,textStore:n,parentStore:m},temporaryStores:{blockStore:k,textStore:C,parentStore:x},temporaryRecordCache:S,focusedIndex:_.Z.Preview,selectionRect:f,oldTextValue:u,open:!0,url:a,urlSelection:p}),T.el(t,{url:a}),!0}return!1}function E(e){const{actionType:t,environment:n,commentStore:o,useTempStores:r}=e,i=w.Z.state;if(!i.open)return;const{oldTextValue:s}=i,l=r?i.temporaryStores:i.stores,{textStore:c,blockStore:m,parentStore:h}=l,v=n.currentUser.id;if(v){if(r){i.temporaryRecordCache.clearCache();for(const e in i.temporaryStores){const t=i.temporaryStores[e],o={userId:v,pointer:t.pointer},r=n.defaultRecordCache.inMemoryRecordCache.getRecord(o);r?P.Wl({environment:n,inMemoryRecordCache:i.temporaryRecordCache,pointer:t.pointer,model:a.kk.fromValue(t.pointer.table,r.value),role:r.role,updatePaths:[[]],userId:v,force:!0,debugSource:"setUnfurlType"}):P.uo({environment:n,inMemoryRecordCache:i.temporaryRecordCache,persistedRecordCache:void 0,pointer:t.pointer,userId:v})}}else n.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(i.temporaryRecordCache);switch(t){case _.Z.Link:f.eP({environment:n,store:i.stores.blockStore}),g.Z5({store:i.stores.textStore,selection:{startIndex:i.urlSelection.endIndex,endIndex:i.urlSelection.endIndex}}),w.Z.setState({...i,focusedIndex:_.Z.Link});break;case _.Z.Mention:if(!o)return;const e=(0,d.C)(c.pointer.spaceId);if(!e)return;const r=o.id;R.createAndCommit({environment:n,userAction:"internalUnfurlingMenuActions.mention",perform:t=>{A.sO({environment:n,store:c,value:s,transaction:t}),A.lZ({environment:n,store:c,selection:{startIndex:i.urlSelection.startIndex,endIndex:i.urlSelection.startIndex},annotation:u.mfJ(r,e),transaction:t,analyticsFrom:"block"})}}),w.Z.setState({...i,focusedIndex:_.Z.Mention});break;case _.Z.Preview:if(!o)return;R.createAndCommit({environment:n,userAction:"internalUnfurlingMenuActions.preview",perform:e=>{A.sO({environment:n,store:c,value:s,transaction:e});const t=b.GP(o);if(!t)return;if(!b.HK(t)||!h||!t.getParentId())return;const r=x.k({environment:n,parentBlock:h,targetStore:o,transaction:e});if(M.BE({parent:h.getContentStore(),insert:r,after:m,transaction:e}),0===u.QaF(i.oldTextValue).trim().length){const t=I.G.createChildStore(h.getContentStore(),i.stores.blockStore.pointer);M.Od({parent:h.getContentStore(),childToRemove:t,transaction:e})}}}),w.Z.setState({...i,focusedIndex:_.Z.Preview});break;default:throw(0,p.t1)(t)}r||w.Z.setState({open:!1})}}function B(e){var t,n;const{block:o,transaction:r}=e,a=o.getType(),s=o.getFormat(),l=o.getSpaceId();if(!o.isDefined()||a!==i.Ti.alias||null==s||null===(t=s.alias_pointer)||void 0===t||!t.id)return;const c=[u.YCD(u.mfJ(null==s||null===(n=s.alias_pointer)||void 0===n?void 0:n.id,l))];m.sO({store:o,value:{type:i.Ti.text,properties:{title:c},format:null},transaction:r})}},62134:(e,t,n)=>{n.d(t,{B4:()=>d,Fe:()=>a,Zm:()=>l,dJ:()=>i,fg:()=>c,ys:()=>s});n(57658);var o=n(72126);function r(e,t){return e.KeyboardShortcutStackStore.state.stack.some((e=>t===e.listener))}function i(e,t,n){const{stack:o}=e.KeyboardShortcutStackStore.state;for(let r=o.length-1;r>=0;r--){const i=o[r],a=i.shortcuts[n];if(e.KeyboardShortcutStackStore.debugPropagation){const[t,o]=e.KeyboardShortcutStackStore.getDebugInfoForStackItem(r),s=i.enable&&a?`propagating ${n} to ${t}`:`not propagating ${n} to ${t}`;console.info(`keyboardShortcutStackActions: ${s}`,o)}if(i.enable&&a)return void a(t)}}function a(e){const{environment:t,stackItem:n}=e,i=t.KeyboardShortcutStackStore;if(r(t,n.listener)){const e=i.state.stack.map((e=>e.listener===n.listener?n:e));i.setState({...i.state,stack:e})}else i.state.stack.push(n),i.setState({stack:o.MR(i.state.stack,(e=>e.priority))})}function s(e,t){if(r(e,t)){const n=e.KeyboardShortcutStackStore,r=n.state.stack,i=o.d1(r,(e=>t===e.listener));n.setState({...n.state,stack:i})}}function l(e,t){i(e,t,t.type)}function c(e){return{command:e.device.isMac?"⌘":"ctrl",enter:"↵",delete:"del",backspace:"del",esc:"escape",left:"←",right:"→",up:"↑",down:"↓",tab:"⇥",alt:e.device.isMac?"⌥":"alt"}}function d(e){return{command:e.device.isMac?"command":"control",esc:"escape"}}},94273:(e,t,n)=>{n.d(t,{Bk:()=>p,Ie:()=>f,Vr:()=>m,nr:()=>g,vq:()=>h});var o=n(99405),r=n(21202),i=n(54153),a=n(95477),s=n(84210),l=n(46654),c=n(79797);const d="lastVisitedRoute",u="lastVisitedRouteUserId";function p(e,t){const n=o.Wj({url:window.location.href,isMobile:e.device.isMobile,baseUrl:a.default.domainBaseUrl,publicDomainName:a.default.publicDomainName,protocol:a.default.protocol,currentUrl:window.location.href}),{route:i,userId:s}=v();("root"===n.name||"new"===n.name||"nativeTab"===n.name)&&i&&"page"===i.name&&i.blockId&&s===t&&new c.G(e,{table:r.iU,id:i.blockId,spaceId:i.spaceId}).load()}function m(e){const{route:t,userId:n}=v();if(t&&"page"===t.name){return{url:(0,s.ZP)({fullyQualified:!1,store:new c.G(e,{table:r.iU,id:t.blockId,spaceId:t.spaceId},{userId:n}),scrollToBlockId:t.scrollToBlockId,peekViewBlockId:t.peekViewBlockId,peekMode:t.peekMode,collectionViewId:t.collectionViewId,templateGalleryItem:t.templateGalleryItem,projectManagementLaunch:t.projectManagementLaunch,discussionId:void 0,pageVisitSource:void 0}),userId:n}}if(t&&"space"===t.name){return{url:(0,o.Xs)({route:t}),userId:n}}return{}}async function f(e){const{route:t,userId:n}=v();let i,a;if(t)if("page"===t.name){const d=new c.G(e,{table:r.iU,id:t.blockId,spaceId:t.spaceId},{userId:n});await d.load();l.IJ(e,d)?(a=t.spaceId??d.getSpaceId(),i=a?o.pv(a):void 0):(i=(0,s.ZP)({fullyQualified:!1,store:d,scrollToBlockId:t.scrollToBlockId,peekViewBlockId:t.peekViewBlockId,peekMode:t.peekMode,collectionViewId:t.collectionViewId,templateGalleryItem:t.templateGalleryItem,projectManagementLaunch:t.projectManagementLaunch,discussionId:void 0,pageVisitSource:void 0}),a=d.getSpaceId())}else"space"===t.name?(a=t.spaceId,i=(0,o.Xs)({route:t})):("nativeTab"===t.name||"workspaceSetup"===t.name)&&(a=t.spaceId);return{url:i,userId:n,route:t,spaceId:a}}function g(e,t){i.Z.set(d,e),i.Z.set(u,t)}function h(){i.Z.remove(d),i.Z.remove(u)}function v(){return{route:i.Z.get(d),userId:i.Z.get(u)}}},20747:(e,t,n)=>{n.d(t,{FZ:()=>v,U_:()=>h,fU:()=>_});var o=n(41432),r=n(21202),i=n(82798),a=n(79797),s=n(26664),l=n(36610),c=n(96802),d=n(94419),u=n(9953);const p=function(e){const t=e.getRecordStoreUIAncestor(2);if(t&&t instanceof a.G&&t.isType(o.Ti.columnList))return t},m=function(e){return e&&e instanceof a.G&&e.isType(o.Ti.column)};function f(e){const{environment:t,targets:n,inMemoryRecordCache:r,transaction:a}=e;(0,i.T)(n.length>0);const s=u.j4({environment:t,type:o.Ti.columnList,properties:{},inMemoryRecordCache:r,transaction:a,spaceId:n[0].pointer.spaceId,useCrdt:n[0].useCrdt()}),c=s.getContentStore();for(const o of n)d.R3({parent:c,append:o,transaction:a});return l.xh(t),s}function g(e){const{environment:t,targets:n,inMemoryRecordCache:r,transaction:a}=e;(0,i.T)(n.length>0);const s=u.j4({environment:t,type:o.Ti.column,format:{column_ratio:1},inMemoryRecordCache:r,transaction:a,spaceId:n[0].pointer.spaceId,useCrdt:n[0].useCrdt()}),l=s.getContentStore();for(const o of n)d.R3({parent:l,append:o,transaction:a});return s}function h(e){const{environment:t,parent:n,insertStores:o,left:i,transaction:s}=e;if(0===o.length)return[];let c,u;if(l.FT(t,{side:"left"}),m(i))c=i,u=p(i);else{c=g({environment:t,targets:[i],inMemoryRecordCache:n.inMemoryRecordCache,transaction:s});const o=f({environment:t,targets:[c],inMemoryRecordCache:n.inMemoryRecordCache,transaction:e.transaction});u=d.rS({parent:n,oldChild:i,newChild:o,transaction:s}).child}const h=g({environment:t,targets:o,inMemoryRecordCache:n.inMemoryRecordCache,transaction:s});if(u){const t=u.getContentStore();d.Vt({parent:t,insert:h,before:c,transaction:e.transaction}),b({columnList:u,addedColumn:h,transaction:s});return a.G.createChildStore(t,{table:r.iU,id:h.id}).getContentStores()}return[]}function v(e){const{environment:t,parent:n,insertStores:o,right:i,transaction:s}=e;if(0===o.length)return[];let c,u;if(l.FT(t,{side:"right"}),m(i))c=i,u=p(i);else{c=g({environment:t,targets:[i],inMemoryRecordCache:n.inMemoryRecordCache,transaction:s});const o=f({environment:t,targets:[c],inMemoryRecordCache:n.inMemoryRecordCache,transaction:e.transaction});u=d.rS({parent:n,oldChild:i,newChild:o,transaction:s}).child}const h=g({environment:t,targets:o,inMemoryRecordCache:n.inMemoryRecordCache,transaction:s});if(u){const t=u.getContentStore();d.BE({parent:t,insert:h,after:c,transaction:e.transaction}),b({columnList:u,addedColumn:h,transaction:s});return a.G.createChildStore(t,{table:r.iU,id:h.id}).getContentStores()}return[]}const b=function(e){const{columnList:t,addedColumn:n,transaction:o}=e,r=t.getContentStores(),i=1/r.length;c.FH({stores:[n],update:{column_ratio:i},transaction:o});for(const a of r)if(a.id!==n.id){const e=a.getColumnRatio();c.FH({stores:[a],update:{column_ratio:(1-i)*e},transaction:o})}},y=function(e){const{columnList:t,removedColumn:n,transaction:o}=e,r=t.getContentStores(),i=n.getColumnRatio();for(const a of r){const e=a.getColumnRatio();c.FH({stores:[a],update:{column_ratio:e/(1-i)},transaction:o})}},_=function(e){const{parent:t,transaction:n}=e,o=t.getRecordStoreUIParent();let r;if(m(o)&&(r=p(o)),r){const e=r.getContentStore(),t=r.getContentStores();for(const i of t){0===i.getContentStores().length&&(d.Od({parent:e,childToRemove:i,shouldGarbageCollect:!1,transaction:n}),y({columnList:r,removedColumn:i,transaction:n}))}const o=r.getContentStores();if(0===o.length){const e=r.getRecordStoreUIParent();null!=e&&e.valueIs(s.i)&&d.Od({parent:e,childToRemove:r,transaction:n,shouldGarbageCollect:!1})}else if(1===o.length){const e=r.getRecordStoreUIParent(),t=o[0],i=t.getContentStore(),a=t.getContentStores();if(a.reverse(),null!=e&&e.valueIs(s.i)){for(const t of a)d.Od({parent:i,childToRemove:t,shouldGarbageCollect:!1,transaction:n}),d.BE({parent:e,insert:t,after:r,transaction:n});d.Od({parent:e,childToRemove:r,transaction:n,shouldGarbageCollect:!1})}}}}},65770:(e,t,n)=>{n.d(t,{YJ:()=>y,Z2:()=>b});n(57658),n(21703),n(41432);var o=n(68626),r=n(91155),i=n(4615),a=n(21202),s=n(23867),l=(n(9953),n(42858)),c=(n(993),n(82530)),d=n(95477),u=(n(28020),n(65598)),p=(n(50694),n(63208),n(79797)),m=(n(27724),n(3022)),f=n(54532),g=n(94419),h=n(24677);const v=new Set(["text","table_row","header","sub_header","sub_sub_header","to_do","bulleted_list","numbered_list"]);function b(e){const{parentStore:t,transaction:n,store:s,environment:l}=e,c=s.path[1];if(2!==s.path.length||"properties"!==s.path[0]||"string"!=typeof c)return;const d=s.getRecordStoreAtRootPath();if(!(d instanceof p.G))return;const u=d.getType();if(!u||!v.has(u))return;const h=function(e){var t;const{environment:n,store:o,parentStore:r,transaction:s}=e;if(o.getSpaceId()!==r.getSpaceId())return;const l=null===(t=r.getModel())||void 0===t?void 0:t.getContentIds();if(null==l||!l.includes(o.id))return;const c=f.K8(n,{blockId:o.id,inMemoryRecordCache:o.inMemoryRecordCache,allowCopyCollections:!1,requireFullSubtree:!0,skipTransclusionContainerChildren:!0,allowCopyExternalObjectInstances:!0});if(!c)return;const d=f.E9({environment:n,sourceBlockId:o.id,targetBlockPointer:{table:a.iU,id:(0,i.ZP)(),spaceId:o.pointer.spaceId},sourceBlockSubtree:c,targetInMemoryRecordCache:o.inMemoryRecordCache,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!1,transaction:s,useCrdt:r.getRecordStoreAtRootPath().useCrdt()});return g.rS({parent:r.getContentStore(),oldChild:o,newChild:d.targetBlock,transaction:s}),d.targetBlock}({environment:l,store:d,parentStore:t,transaction:n}),b=null==h?void 0:h.getPropertyStore(c);if(b)return n.postSubmitCallbacks.push((e=>{e&&o.log({from:"legacyTransclusionActions",level:"error",type:"maybeAutofixLegacyTransclusionProperty",error:{miscErrorString:(0,r.LK)(e)}}),m.Gb(l,{block_type:u,successful:!e})})),b;o.log({from:"legacyTransclusionActions",level:"error",type:"maybeAutofixLegacyTransclusionProperty",error:{message:"copied transclusion block does not have expected property"}})}function y(e){const{environment:t,store:n}=e,o=n.getRecordStoreUIParent();o&&(0,u.dz)(o)&&c.createAndCommit({userAction:"legacyTransclusionActions.fixLegacyTransclusion",environment:t,perform:e=>{const[r]=f.Qi({environment:t,stores:[n],addCopyName:!1,transaction:e,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,targetSpaceId:(0,s.C)(n.pointer.spaceId),baseUrl:d.default.domainBaseUrl,publicDomainName:d.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:o.getRecordStoreAtRootPath().useCrdt()}),i=r[0],{child:a}=g.BE({parent:o,insert:i,after:n,transaction:e});l.Od({store:n,transaction:e}),h.Z5({environment:t,stores:[a]})}})}},45990:(e,t,n)=>{n.d(t,{F5:()=>h,PP:()=>f,dz:()=>p,gp:()=>m,iX:()=>g});var o=n(70203),r=n(48709),i=n(68056),a=n(89224),s=n(23178),l=n(24666),c=n(993),d=n(98104),u=n(82530);const p=e=>{const t=l.default.state;if("editing"!==t.mode)return;const n="selectionFocus"===e.type?(0,i.TD)({store:e.store,selection:e.selection}):t.multiSelection,c=(0,i.QY)(n);if(!c)return;const{tokensInsideRange:d}=o.xrQ(c.store.getValue(),n.start.index,n.end.index),u=d.find((e=>Boolean(o.Hze(e)))),p=a.get();if(!p)return;const m=a.getRect(p);if(!m)return;const f=Boolean(u);s.Z.setState({open:!0,url:"",title:u&&(0,r.Ts)(u)||"",editingToken:u,savedTextSelectionState:{...t,multiSelection:n},selectionRect:m,focusLinkInput:!f&&e.focus,focusTitleInput:f&&e.focus})};function m(e){const{environment:t,transaction:n,url:o,title:r,editingToken:a,savedTextSelectionState:s}=e,l=(0,i.QY)(s.multiSelection);if(!l)return;a&&c.Be({environment:t,store:l.store,type:"a",selection:l.selection,transaction:n});const u=["a",o];return c.i8({environment:t,store:l.store,annotation:u,selection:l.selection,transaction:n}),d.Z5({store:l.store,selection:{startIndex:l.selection.startIndex,endIndex:l.selection.endIndex}}),r?{editingToken:[r,[u]]}:void 0}function f(e){const t=s.Z.state;if(!t.open)return;const{editingToken:n,savedTextSelectionState:o}=t;if(!n)return;const r=(0,i.QY)(o.multiSelection);r&&(u.createAndCommit({userAction:"linkAnnotationActions.unlinkSelection",environment:e,perform:t=>{c.Be({environment:e,store:r.store,type:"a",selection:r.selection,transaction:t})}}),l.default.emit(),s.Z.reset())}function g(e){const{environment:t,title:n,transaction:r,editingToken:a,savedTextSelectionState:s}=e;if(!n||!a)return;const l=(0,i.QY)(s.multiSelection);if(!l)return;const u=l.store;c.pz({environment:t,multiSelection:s.multiSelection,transaction:r});const p=l.selection.startIndex,m=p+n.length,f={startIndex:p,endIndex:m},g=["a",o.Hze(a)],h=o.V3y(n);return c.mM({environment:t,store:u,tokens:[h],index:p,transaction:r}),c.i8({environment:t,store:u,annotation:g,selection:f,transaction:r}),d.Z5({store:u,selection:f}),{editingToken:[n,[g]],savedTextSelectionState:{...s,multiSelection:{start:{store:u,index:p},end:{store:u,index:m}}}}}function h(){s.Z.setState({open:!1})}},94419:(e,t,n)=>{n.d(t,{BE:()=>s,Ce:()=>p,HP:()=>m,MK:()=>d,Od:()=>c,R3:()=>u,Vt:()=>l,rS:()=>a});n(57658);var o=n(20747),r=n(19358),i=n(82530);const a=function(e){const{parent:t,oldChild:n,newChild:o,transaction:a}=e,s=n.id,l=o.id,c=(t.getValue()||[]).indexOf(s);r.D0({parentStore:t,childStore:o,transaction:a}),r.If({parentStore:t,childStore:n,transaction:a}),c>=0&&(i.applyOperation({transaction:a,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{id:l,after:s}}}),i.applyOperation({transaction:a,store:t,operation:{pointer:t.pointer,path:t.path,command:"listRemove",args:{id:s}}}));return{parent:t,child:o.cloneWithNewUIParent(t)}},s=function(e){const{parent:t,insert:n,after:o,transaction:a}=e;let s;o&&(s=o.id),r.D0({parentStore:t,childStore:n,transaction:a}),i.applyOperation({transaction:a,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{after:s,id:n.id}}});return{parent:t,child:n.cloneWithNewUIParent(t)}},l=function(e){const{parent:t,insert:n,before:o,transaction:a}=e;let s;o&&(s=o.id),r.D0({parentStore:t,childStore:n,transaction:a}),i.applyOperation({transaction:a,store:t,operation:{pointer:t.pointer,path:t.path,command:"listBefore",args:{before:s,id:n.id}}});return{parent:t,child:n.cloneWithNewUIParent(t)}},c=function(e){void 0===e.shouldGarbageCollect&&(e.shouldGarbageCollect=!0);const{parent:t,childToRemove:n,shouldGarbageCollect:a,transaction:s}=e;r.If({parentStore:t,childStore:n,transaction:s}),i.applyOperation({transaction:s,store:t,operation:{pointer:t.pointer,path:t.path,command:"listRemove",args:{id:n.id}}}),a&&s.preEnqueueActions.push((()=>{o.fU({parent:t,transaction:s})}));const l=n.cloneWithNewUIParent(t);return{parent:t,child:l}},d=function(e){const{parent:t,append:n,transaction:o}=e;r.D0({parentStore:t,childStore:n,transaction:o}),i.applyOperation({transaction:o,store:t,operation:{pointer:t.pointer,path:t.path,command:"keyedObjectListAfter",args:{value:n.pointer,after:void 0}}});return{parent:t,child:n.cloneWithNewUIParent(t)}},u=function(e){const{parent:t,append:n,transaction:o,after:a}=e;r.D0({parentStore:t,childStore:n,transaction:o}),i.applyOperation({transaction:o,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{id:n.id,after:a}}});return{parent:t,child:n.cloneWithNewUIParent(t)}},p=function(e){const{parent:t,prepend:n,transaction:o,before:a}=e;r.D0({parentStore:t,childStore:n,transaction:o}),i.applyOperation({transaction:o,store:t,operation:{pointer:t.pointer,path:t.path,command:"listBefore",args:{id:n.id,before:a}}});return{parent:t,child:n.cloneWithNewUIParent(t)}},m=function(e){const{parent:t,current:n,after:o,transaction:r}=e;o?s({parent:t,insert:n,after:o,transaction:r}):p({parent:t,prepend:n,transaction:r});return{parent:t,child:n.cloneWithNewUIParent(t)}}},13084:(e,t,n)=>{n.d(t,{Bm:()=>M,DC:()=>T,HO:()=>P,LQ:()=>C,UG:()=>A,dM:()=>E,uQ:()=>x});n(21703);var o=n(1302),r=n(41432),i=n(14248),a=n(72126),s=n(21202),l=n(95371),c=n(28020),d=n(65598),u=n(69645),p=n(73959),m=n(55367),f=n(79797),g=n(34583),h=n(54569),v=n(42239),b=n(31781),y=n(20747),_=n(94419),S=n(9953),w=n(42858),k=n(24677),I=n(98104);function C(e){const{environment:t,droppedDirection:n,droppedStores:o,targetStore:l,targetParentStore:c,transaction:d,duplicate:u}=e,p=o.every((e=>e.isExternalObjectInstancePageBlockStore()))||u;if(l&&n===m.vh.Onto){k.ZH(t);const e=!(l.isInsideTemplate()||l.isInsideFactoryOrDuplicateBlocksAction()),n=v.LQ({environment:t,droppedStores:o,duplicate:p,transaction:d,resolveTemplateVariables:e,duplicateUseCrdt:l.useCrdt()});let a=l;if(l.isType(r.Ti.alias)){const e=l.getAliasTargetStore();if(!e)throw new Error("Alias has no target.");e instanceof f.G&&(a=e)}const s=a.getCollectionViewCollectionStore();if(a.isCollectionView()&&!a.isCollectionViewPageWithContent()){if(!s)throw new Error("CollectionStore is not defined.");const e=h.o3({environment:t,stores:n,transaction:d,spaceId:s.getSpaceId()});for(const n of e)h.mp({environment:t,store:n,collectionStore:s,shouldCoerce:!0,groupsPointer:[],transaction:d});return e}{const e=a.getAssociatedCollectionStore();if(null!=e&&e.isPageTreeCollection())for(const o of n){if("page"!==o.getType())continue;if(!o.isDefined())continue;const t=i.Xq({blockProperties:o.getProperties(),oldSchema:o.getSchema(),newSchema:e.getSchema(),typesMatch:!1,oldPropertyMapping:void 0,newPropertyMapping:void 0});t.propertyUpdate&&Object.keys(t.propertyUpdate).length>0&&S.sW({store:o.getPropertiesStore(),data:t.propertyUpdate,transaction:d})}const t=a.getContentStore();for(const o of n)_.R3({parent:t,append:o,transaction:d});return n}}{const e=!!l&&!(l.isInsideTemplate()||l.isInsideFactoryOrDuplicateBlocksAction(!1)),r=c.getRecordStoreAtRootPath();let i=v.LQ({environment:t,droppedStores:o,duplicate:p,transaction:d,resolveTemplateVariables:e,duplicateUseCrdt:l?l.useCrdt():r.table===s.iU&&r.useCrdt()});return n===m.vh.Above?(i=a.d9(i),l?i=a.UI(i,(e=>_.Vt({parent:c,insert:e,before:l,transaction:d}).child)):(i.reverse(),i=a.UI(i,(e=>_.Ce({parent:c,prepend:e,transaction:d}).child)))):n===m.vh.Below?(i=a.d9(i),l?(i.reverse(),i=a.UI(i,(e=>_.BE({parent:c,insert:e,after:l,transaction:d}).child))):i=a.UI(i,(e=>_.R3({parent:c,append:e,transaction:d}).child))):l&&n===m.vh.Left?i=y.U_({environment:t,parent:c,insertStores:i,left:l,transaction:d}):l&&n===m.vh.Right&&(i=y.FZ({environment:t,parent:c,insertStores:i,right:l,transaction:d})),w.DV({environment:t,insertedStores:i}),k.Z5({environment:t,stores:i}),i}}function x(e){var t;const{environment:n,files:o,droppedDirection:r,targetStore:i,targetParentStore:a,transaction:s}=e,l=a.inMemoryRecordCache,d=c.qQ(n);C({environment:n,targetParentStore:a,targetStore:i,droppedDirection:r,droppedStores:b.z({environment:n,files:o,inMemoryRecordCache:l,pageWidth:d,transaction:s,spaceId:null==i?void 0:i.pointer.spaceId,useCrdt:(null===(t=(0,p.sQ)(a))||void 0===t?void 0:t.useCrdt())??!1}),duplicate:!1,transaction:s})}function T(e){const{environment:t,targetStore:n,isAtStartOfLine:o}=e;(function(e){const{environment:t,isClick:n,targetStore:o}=e;if(!n)return!1;const i=o.findRecordStoreUIAncestor((e=>e instanceof f.G&&e.isTransclusionType())).ancestor;if(i&&i instanceof f.G){const e=o.findRecordStoreUIAncestor((e=>e instanceof f.G&&e.getType()===r.Ti.transclusionReference)).ancestor,n=(e&&e instanceof f.G?e:void 0)||i,a=n.getRecordStoreUIParent();if(!a||!(0,d.dz)(a))return;return k.Z5({environment:t,stores:[n]}),!0}return!1})(e)||E({environment:t,store:n,isAtStartOfLine:o})||function(e){const{environment:t,targetStore:n,isAtStartOfLine:o}=e,r=k.KX(),i=r.indexOf(n);if(-1===i)return!1;if(o)for(let a=i;a>=0&&a>i-20;a--){if(E({environment:t,store:r[a],isAtStartOfLine:!1}))return!0}else for(let a=i;a<r.length&&a<i+20;a++){if(E({environment:t,store:r[a],isAtStartOfLine:!0}))return!0}}(e)}function M(e){const{environment:t,targetStore:n,isAtStartOfLine:o}=e;E({environment:t,store:n,isAtStartOfLine:o})||D({...e,placement:"after"})}function P(e){return R(e)}function A(e){return R(e)}function R(e){const{environment:t,container:n,store:o,transaction:i}=e,c=function(e){var t;const{container:n,store:o}=e;let i=(0,u.dq)({includeNonSelectableListContainer:!0,container:n});i&&o&&(i=a.Z$((0,l.DY)([i],(e=>e.value.store===o))));if(!i)return;let s=i;for(;s.children.length>0;){const e=a.Z$(s.children);if(0===e.children.length)break;const t=e.value.store.getType();if(t&&r.BT[t])break;s=e}return{parentStore:s.value.store,siblingStore:null===(t=a.Z$(s.children))||void 0===t?void 0:t.value.store}}({container:n,store:o});if(!c)return!1;const{parentStore:p,siblingStore:m}=c;if(m&&(0,d.PF)(m))return!1;const f=p.getParentStore();return D({environment:t,targetParentStore:(p.getType()===r.Ti.tab&&(null==f?void 0:f.table)===s.iU?f:p).getContentStore(),placement:"after",transaction:i})}function D(e){const{environment:t,targetStore:n,targetParentStore:i,placement:a,transaction:s}=e;if(i.getValue()&&g.M_(t)&&g.M_(t)){var l;const e=S.j4({environment:t,type:r.Ti.text,inMemoryRecordCache:i.inMemoryRecordCache,transaction:s,spaceId:i.pointer.spaceId,useCrdt:(null===(l=(0,p.sQ)(i))||void 0===l?void 0:l.useCrdt())??!1}),c="after"===a?_.BE({parent:i,after:n,insert:e,transaction:s}):_.Vt({parent:i,before:n,insert:e,transaction:s});return o.default.afterNextFlush((()=>{E({environment:t,store:c.child,isAtStartOfLine:!1})})),!0}return!1}function E(e){const{environment:t,store:n,isAtStartOfLine:o}=e,r=(0,p.mh)(n);return!!r&&(k.eP({environment:t,store:n}),o?I.N_({store:r}):I.NX({store:r}),!0)}},92625:(e,t,n)=>{n.d(t,{j:()=>i,x:()=>a});var o=n(33929),r=n(31104);const i=function(e){let{message:t,interpolatedValues:n,targetRecordId:i}=e;r.Z.setState({open:!0,message:o.default.formatMessage(t,n),targetRecordId:i})},a=function(){r.Z.setState({open:!1,targetRecordId:void 0})}},98730:(e,t,n)=>{n.d(t,{S:()=>s});var o=n(97638),r=n(96820),i=n(80444),a=n(84166);const s=async e=>{const{hasPublicAccessPermission:t}=o.bC(e),n=i.default.state.currentSpaceStore,s=i.default.state.currentSpaceViewStore;if(t)return;if(!n)return;const l=await(0,r.S)({environment:e,currentSpaceStore:n,currentSpaceViewStore:s,excludeCurrentPage:!1});l&&a.Z.update((e=>({...e,localSearchableBlocksCache:l})))}},35979:(e,t,n)=>{n.d(t,{Be:()=>c,TR:()=>h,V_:()=>u,WA:()=>v,_5:()=>d,lJ:()=>m,nk:()=>g,wt:()=>f,z_:()=>l});var o=n(79946),r=n(38208),i=n(97978),a=n(77080);function s(e,t){i.j(e,t)}function l(e){s(e,"request_login_with_apple"),p(e,"login-with-apple")}function c(e){s(e,"request_login_with_google"),p(e,"login-with-google")}function d(e){s(e,"send_temporary_password"),p(e,"temporary-passcode")}function u(e){s(e,"redirect_to_saml_login"),p(e,"saml")}function p(e,t){i.j(e,"login_attempt",{login_method:t})}function m(e,t){r.o7(e,"signup_login_button_clicked",t),a.default.logEvent("signup_login_button_clicked",t.login_method,t)}function f(e,t){i.j(e,"login_success",t,{dontWait:!0})}function g(e,t){const{isBannedGoogleSSOUserAgent:n,isSignup:i}=t;r.o7(e,"onboarding_landing_page",{is_banned_google_sso_user_agent:n,is_signup:i}),i&&o.T1()}function h(e,t){const{actionType:n,isSignup:o}=t;i.j(e,"google_one_tap_login_button_click",{is_signup:Boolean(o),action_type:n},{dontWait:!0})}function v(e,t){i.lu(e,"login_email_input_updates","login_email_input_updates",1)}},97977:(e,t,n)=>{n.r(t),n.d(t,{actuallyLogoutAndDeleteMostLocalData:()=>Ie,clearCurrentUser:()=>ke,clearMostUserStorageAndState:()=>de,handleLoginFailureIfSamlRequired:()=>Ee,handleLoginSuccess:()=>Ce,handleLoginWithMfa:()=>xe,handleLoginWithTemporaryPasscodeSuccess:()=>fe,initialize:()=>Pe,loginPasswordReset:()=>ye,loginSamlUser:()=>_e,loginSamlUserWithToken:()=>be,loginWithAppleAuth:()=>ge,loginWithGoogleAuth:()=>he,loginWithTemporaryPasscode:()=>me,logout:()=>we,logoutSingleAccount:()=>Se,openBrowserInMobileNative:()=>pe,redirectToSaml:()=>ve,requestLoginWithGoogleOneTap:()=>ue,setLocalStorageUserId:()=>Me,shouldCreatePassword:()=>Re,showSamlRedirectMessage:()=>Be});n(57658),n(21703);var o=n(87997),r=n(79946),i=n(15145),a=n(53504),s=n(68626),l=n(72126),c=n(91155),d=n(29477),u=n(4615),p=n(99405),m=n(89101),f=n(19889),g=n(66079),h=n(9852),v=n(54153),b=n(97880),y=n(64002),_=n(66504),S=n(9291),w=n(47839),k=n(29974),I=n(95477),C=n(97978),x=n(91924),T=n(12955),M=n(33954),P=n(87381),A=n(33929),R=n(28125),D=n(57491),E=n(78873),B=n(18514),F=n(15517),O=n(32223),Z=n(75538),V=n(18245),U=n(19034),N=n(78861),L=n(84693),j=n(58455),z=n(80444),q=n(77080),H=n(53730),W=n(79797),K=n(27724),G=n(24666),$=n(88893),Q=n(36610),Y=n(54642),X=n(35793),J=n(47307),ee=n(57400),te=n(3297),ne=n(94273),oe=n(92625),re=n(35979),ie=n(4408),ae=n(8055),se=n(32219),le=n(70782);const ce=(0,S.defineMessages)({unsavedChanges:{id:"loginActions.dialogError.logoutUnsavedChanges.message",defaultMessage:"You have unsaved changes. If you log out now, you could lose them."},logoutWithoutSaving:{defaultMessage:"Discard edits and log out",id:"loginActions.dialogError.logoutUnsavedChanges.confirmButton.label"},signupPendingMessage:{defaultMessage:"Creating Notion account…",id:"loginActions.signup.pending.message"},loginPendingMessage:{defaultMessage:"Logging in to Notion…",id:"loginActions.login.pending.message"},redirectSamlMessage:{defaultMessage:"SAML SSO required. Redirecting to the configured login page.",id:"loginActions.login.redirect.saml.message"}});async function de(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const o=[];if(t){const e=(0,h.DD)();sessionStorage.clear(),(0,h.In)(e)}else sessionStorage.clear();if(F.ZL(),n&&o.push(ke(e)),o.push(Q.NM()),e.mobileNative&&(o.push(e.mobileNative.logoutOfGoogle()),o.push(e.mobileNative.cancelUserBackgroundTasks())),e.device.isElectron&&(w.clearBrowserHistory(),t||w.clearCookies()),z.default.reset(),K.default.reset(),G.default.reset(),ie.LK(e),O.resetRecordSubscriptions(),U.Z.reset(),j.default.reset(),Z.default.reset(),o.push(H.transactionQueue.reset()),"on"===q.default.getGroup("clear-record-cache-on-login")){const t=e.defaultRecordCache.persistedRecordCache;t&&"reset"in t&&o.push(t.reset())}q.default.reset(),await Promise.all(o)}async function ue(e){const{environment:t,idToken:n,store:o,frontPathName:r}=e,i=await(0,P.loadCurrentUserId)(t),a=V.default.mark("login_time.google"),s=await Y.loginWithGoogleJwt(t,{idToken:n});if(V.default.measure(a,{environment:t}),"success"===s.type){const{isNewSignup:e,userId:n}=s.data;return await Ce({environment:t,isNewSignup:e,userId:n,previousPersistedUserId:i,loginMethod:"login-with-google-onetap",frontPathName:r}),{status:"success"}}{await Ee(t,s);const e=(0,M.wf)(A.default.getIntl(),s);return o.setState({...o.state,alert:e}),{status:"fail"}}}function pe(e,t){e.mobileNative&&((0,x.Q7)(e)?e.mobileNative.openAuthSessionBrowser(t):e.mobileNative.openInAppBrowser(t))}async function me(e){const{environment:t,state:n,password:o,redirectURL:r,webBrowserDeviceId:i,passcodeEnterMethod:a,showInvitationVersion:s}=e,l=V.default.mark("login_time.passcode"),c=await(0,P.loadCurrentUserId)(t),d=await Y.loginWithEmail(t,{state:n,password:o});if(V.default.measure(l,{environment:t}),"success"!==d.type){await Ee(t,d);return(0,M.wf)(A.default.getIntl(),d)}{const{isNewSignup:e,userId:n}=d.data;if(w.electronApi&&function(e){let{environment:t,isNewSignup:n,webBrowserDeviceId:o}=e;const r=t.device.isElectron&&n&&!o;if(!r)return!1;return q.default.checkGate("desktop_app_login_with_email_redirect")}({environment:t,isNewSignup:e,webBrowserDeviceId:i})){const e=y.$U(y.bf({url:`${I.default.domainBaseUrl}${m._j.loginSuccess}`}));w.electronApi.openExternalUrl(e)}else await fe({environment:t,isNewSignup:e,userId:n,redirectURL:r,previousPersistedUserId:c,loginMethod:"temporary-passcode",webBrowserDeviceId:i,passcodeEnterMethod:a,showInvitationVersion:s})}}async function fe(e){const{environment:t}=e;await Ce(e);const[n,o,r]=await Promise.all([Re(t),De(t),Ae()]);(n&&o||n&&r)&&E.E({environment:t})}async function ge(e){const{environment:t,code:n,encryptedToken:o,encryptedNonce:r,encryptedUserObject:i,webBrowserDeviceId:a}=e,s=V.default.mark("login_time.apple"),l=await(0,P.loadCurrentUserId)(t),c=await Y.loginWithAppleAuth(t,{code:n,encryptedToken:o,encryptedNonce:r,encryptedUserObject:i});if(V.default.measure(s,{environment:t}),"success"!==c.type)return await Ee(t,c),(0,M.wf)(A.default.getIntl(),c);{const{isNewSignup:e,userId:n}=c.data;await Ce({environment:t,isNewSignup:e,userId:n,previousPersistedUserId:l,loginMethod:"login-with-apple",webBrowserDeviceId:a})}}async function he(e){const{environment:t,encryptedToken:n,code:o,callbackType:r,webBrowserDeviceId:i}=e,a=await(0,P.loadCurrentUserId)(t),s=await Y.loginWithGoogleAuth(t,{code:o,encryptedToken:n,callbackType:r});if("success"!==s.type)return await Ee(t,s),(0,M.wf)(A.default.getIntl(),s);{const{isNewSignup:e,userId:n}=s.data;await Ce({environment:t,isNewSignup:e,userId:n,previousPersistedUserId:a,loginMethod:"login-with-google",webBrowserDeviceId:i})}}function ve(e,t){re.V_(e),e.mobileNative?pe(e,t):e.device.isElectron&&w.electronApi?w.electronApi.openExternalUrl(t):window.location.href=t}async function be(e){const{environment:t,csrfState:n,token:o,isNewSignup:r}=e,i=await(0,P.loadCurrentUserId)(t),a=await T.getBrowserId(t);n||o||s.log({level:"error",type:"loginSamlUserWithToken",from:"loginActions",error:{stack:(new Error).stack},data:{miscDataToConvertToString:{deviceId:a,isNewSignup:r}}});const l=await Y.loginWithEmail(t,{state:n,password:o});if("success"!==l.type)return await Ee(t,l),(0,M.wf)(A.default.getIntl(),l);{const{userId:e}=l.data;await Ce({environment:t,isNewSignup:r,userId:e,previousPersistedUserId:i,loginMethod:"saml"})}}async function ye(e){const{environment:t,csrfState:n,password:o,loginStore:r}=e,i=await(0,P.loadCurrentUserId)(t);if(!n){const e=await T.getCookie(t,"notion_browser_id");s.log({level:"error",type:"loginPasswordReset",from:"loginActions",error:{stack:(new Error).stack},data:{miscDataToConvertToString:{deviceId:e,previousPersistedUserId:i}}})}const a=await Y.loginWithEmail(t,{state:n,password:o,passwordReset:!0});if("success"!==a.type)return await Ee(t,a),(0,M.wf)(A.default.getIntl(),a);{const{userId:e,enabledMfaSettings:n}=a.data;n&&n.length>0?(xe({environment:t,isNewSignup:!1,userId:e,previousPersistedUserId:i,loginMethod:"password-reset",loginStore:r,mfaSettings:n}),ae.Li({environment:t,url:m._j.login}),E.E({environment:t})):(await Ce({environment:t,isNewSignup:!1,userId:e,previousPersistedUserId:i,loginMethod:"password-reset"}),E.E({environment:t}))}}async function _e(e){const{environment:t,userId:n,previousUserId:o,isNewSignup:r}=e;await Ce({environment:t,isNewSignup:r,userId:n,previousPersistedUserId:o,loginMethod:"saml"})}async function Se(e){const{environment:t,userId:n,logoutOrigin:o}=e,{nextUserId:r,nextSpaceViewStore:a}=function(e){const{environment:t,userId:n}=e,o=t.currentUser.id;if(n===o){const e=N.Z.getAllSpaceViewStores(t).filter((e=>{const t=e.getUserRootParentId();return t&&t!==n}))[0];return{nextUserId:e&&e.getUserRootParentId(),nextSpaceViewStore:e}}{const{currentSpaceViewStore:e}=z.default.state;return{nextUserId:o,nextSpaceViewStore:e}}}(e);if(r&&a){if(await H.transactionQueue.hasTasksForUser(n)){if(!(await J.confirmUserAction({message:A.default.formatMessage(ce.unsavedChanges),acceptLabel:A.default.formatMessage(ce.logoutWithoutSaving)})))return}await Y.logout(t,{userId:n,logoutOrigin:o}),await H.transactionQueue.clearForUser(n),F.ZL(n);const e=await le.x({environment:t,newCurrentUserId:r,loggedOutUserId:n}),{currentUserRootStore:s,currentUserSettingsStore:l}=z.default.state;s&&l&&k.y3({environment:e,spaceViewStore:a,userSettingsStore:l,userRootStore:s,pageVisitSource:i.tY.Login,navigationType:"switchingToOrLoadingSpace"}),w.refreshAll({includeFocusedWindow:!1})}else await we(t),w.refreshAll({includeFocusedWindow:!1})}async function we(e){if(await H.transactionQueue.anySessionHasTasks()){if(!(await J.confirmUserAction({message:A.default.formatMessage(ce.unsavedChanges),acceptLabel:A.default.formatMessage(ce.logoutWithoutSaving)})))return}(0,B.Sr)()?window.location.href=`${I.default.domainBaseUrl}/logout`:ae.c4({environment:e,url:m._j.logout})}async function ke(e){if(e.mobileNative&&await e.mobileNative.unregisterPushNotifications(),e.updateCurrentUserId){const t={environment:e,currentUserId:void 0,userIds:[]};e.updateCurrentUserId(t)}return{...e,currentUser:new o.CurrentUser}}async function Ie(e){const{environment:t,nextLocation:n,userId:o,doNotRedirect:r,logoutOrigin:i}=e;o?await Y.logout(t,{userId:o,logoutOrigin:i}):await Y.logout(t,{logoutOrigin:i}),await de(t),w.clearGoogleAuthCookies(),w.refreshAll({includeFocusedWindow:!1}),r||(window.location.href=n||m._j.root)}async function Ce(e){const{environment:t,isNewSignup:n,userId:o,redirectURL:i,previousPersistedUserId:l,frontPathName:c,webBrowserDeviceId:f,passcodeEnterMethod:g,showInvitationVersion:v}=e;n?oe.j({message:ce.signupPendingMessage}):oe.j({message:ce.loginPendingMessage});try{const y=R.k(t);if(ie.LK(t),t.device.isElectron&&(w.clearBrowserHistory(),w.refreshAll({includeFocusedWindow:!1})),l&&l!==o){const e=await H.transactionQueue.getTotalNumberOfTasks();e>5&&s.log({level:"warning",from:"loginActions",type:"setLoggedInUserId",data:{userId:o,currentUserId:l,clearedTransactionCount:e}}),await de(t,y,!t.currentUser.loggedInUserIds.includes(l))}if(!l){const e=te.qd(void 0);te.nM({currentUserId:o,blockId:e}),te.nM({currentUserId:void 0,blockId:void 0})}const _=await Te(t,o);if(re.lJ(_,{is_new_signup:n,login_method:e.loginMethod,front_pathname:c}),n){Q.ie(_,{user_id:o,tags:(0,h.mM)(),origin_initial_page:se.getInitialPage(o)});const t=await(0,C.of)(_);await(0,d.OI)(200,Y.initializeUserAnalyticsEmptySync(_,{isNewSignup:n,analyticsProperties:(0,a.Z)({...(0,C.Ts)(),...(0,C.eR)(),...(0,D.getMobileNativeDeviceInfo)(),...t,experiments:q.default.getExperimentsMap(),login_method:e.loginMethod,signup_from:t.route_name,front_pathname:c,web_browser_device_id:f,passcode_enter_method:g},"ignore-class-instances")}))}let S;if(i&&(S=p.Wj({url:i,isMobile:_.device.isMobile,baseUrl:I.default.domainBaseUrl,publicDomainName:I.default.publicDomainName,protocol:I.default.protocol,currentUrl:window.location.href})),S)if(!S||"space"!==S.name&&"page"!==S.name){if(S&&"oauthAuthorization"===S.name){const{responseType:e,redirectUri:t,integrationId:n,state:o,owner:r,userId:i,spaceId:a}=S;(0,h.In)({responseType:e,redirectUri:t,integrationId:n,state:o,owner:r,userId:i,spaceId:a})}}else ne.nr(S,o);if(X.mc(_),ee.mc(),await ee.Yh(_),n&&(q.default.logEvent("sign_up",void 0,{login_method:e.loginMethod,device_type:t.device.deviceType}),q.default.logEvent("sign_up_by_login_method",e.loginMethod),q.default.logEvent("sign_up_by_device_type",t.device.deviceType)),re.wt(_,{is_new_signup:n,login_method:e.loginMethod,logged_in_user_ids:_.currentUser.loggedInUserIds.map((e=>(0,u.F9)(e))),most_recent_user_id:(0,u.F9)(o),web_browser_device_id:f,passcode_enter_method:g}),r.j({device:_.device,event:{facebook:{eventName:"ViewContent"},google:{eventName:"loggedIn"}},cookieService:t.cookieService}),I.default.isAdminMode){if(!(await T.getGhostAdminUserId(t)))return void ae.c4({environment:t,url:"/__admin"})}const k=q.default.checkGate("enable_oauth_from_desktop_ux_v2"),x=(0,h.r4)({config:k?I.default:void 0,fileHostProtocol:I.default.secureFileConfig.protocol,fileHostName:I.default.secureFileConfig.hostname});x?((0,h.Rq)(),window.location.href=x):!y&&l&&l!==o?window.location.href=m._j.root:n?v?ae.c4({environment:_,url:m._j.onboarding}):ae.c4({environment:_,url:m._j.root}):S&&"space"!==S.name&&"page"!==S.name&&(0,b.qg)(m.VP,S.name)?ae.c4({environment:_,url:m.VP[S.name]}):ae.c4({environment:_,url:m._j.root})}finally{oe.x()}}function xe(e){const{loginStore:t,userId:n}=e,o=new W.U6(e.environment,{table:f.KJ,id:n},{userId:n});t.setState({...t.state,settings:e.mfaSettings,loginType:"mfa",redirectURL:e.redirectURL,previousPersistedUserId:e.previousPersistedUserId,userStore:o})}async function Te(e,t){await async function(e,t){await Me(e,t)}(e,t);let n=[t];const r=await(0,P.getUserIdsFromCookie)(e);r&&(r.push(t),n=l.jj(r));const i=await T.getGhostAdminUserId(e),a={...e,currentUser:new o.CurrentUser({id:t,loggedInUserIds:n,adminUserId:i})};if(e.updateCurrentUserId){const o={environment:e,currentUserId:t,userIds:n};await e.updateCurrentUserId(o)}return a.device.isFirefox||F.lr(),a}async function Me(e,t){const n=await(0,P.getUserIdsFromCookie)(e);n&&!n.includes(t)||v.Z.set(P.currentUserIdKey,t)}async function Pe(e){const t=await(0,P.loadCurrentUserId)(e),{mobileNative:n}=e;if(n&&n.sqliteConnection)try{await L.y6(n.sqliteConnection,t||_.I)}catch(o){s.log({level:"error",from:"loginAction.ts",type:"backfillRecordsWithUserId",error:(0,c.Ui)(o),data:{}})}return t?await Te(e,t):e}async function Ae(){var e;const{currentUserStore:t}=z.default.state;if(!t)return!1;if(!t.getEmail())return!1;const{currentUserSettingsStore:n}=z.default.state;return!!n&&(await n.load(),Boolean(null===(e=n.getSettings())||void 0===e?void 0:e.should_set_password_on_login))}async function Re(e){const{currentUserStore:t}=z.default.state;if(!t)return!1;const n=t.getEmail();if(!n)return!1;const o=await E.c({environment:e,userEmail:n});if(o.error)throw o.error;return!o.value.isSamlEnforced&&!o.value.hasPassword&&!o.value.didLogInWithSaml}async function De(e){const t=e.currentUser.id;if(!t)return!1;const n=new W.r9(e,{table:g.dx,id:t});await n.load();return(await(0,$.Gh)({environment:e,userRootStore:n})||[]).some((e=>e===I.default.pricing.student.productId))}async function Ee(e,t){var n,o;if("saml_sso_required"===(null===(n=t.body.clientData)||void 0===n?void 0:n.type)&&null!==(o=t.body.clientData)&&void 0!==o&&o.redirectUrl){await Be(2e3);ve(e,t.body.clientData.redirectUrl)}}async function Be(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;oe.j({message:ce.redirectSamlMessage}),await(0,d.Vs)(e),oe.x()}},27153:(e,t,n)=>{n.d(t,{$:()=>i,Z:()=>a});var o=n(91390),r=n(24677);function i(e,t){t.disableClearSelection||r.ZH(e),o.Z.setState({...t,isActive:!0})}function a(){const e=o.Z.state;e.isActive&&e.onCancel&&e.onCancel(),o.Z.reset()}},67060:(e,t,n)=>{n.d(t,{Br:()=>Z,RL:()=>F,WI:()=>B,_P:()=>D,lZ:()=>E,xv:()=>O});var o=n(49085),r=n(72126),i=n(4615),a=n(21202),s=n(70203),l=n(69783),c=n(28020),d=n(49117),u=n(44486),p=n(68056),m=n(98165),f=n(89224),g=n(80444),h=n(64233),v=n(77080),b=n(19111),y=n(83212),_=n(72087),S=n(10743),w=n(24666),k=n(34583),I=n(35057),C=n(26189),x=n(88295),T=n(98730),M=n(993),P=n(82530);function A(e){const{textStore:t,environment:n}=e,o=(0,m.n3)(t)&&y.Z.getMode(n,t).hasPublicPermission,r=t.isDefaultRecordCache(),i=!o,a=i&&function(e){const t=(0,c.np)(),n=g.default.state.currentSpaceStore;if(!t||!n)return!1;return v.default.checkGate("inline_mention_invites")&&t.canEditMembership()&&n.canEditMembership()&&"enterprise"!==(0,I.zt)()&&!e.device.isMobile}(n),s=!o;return{page:true,createPage:r,user:i,inviteUser:a,bot:i,date:!0,reminder:!0,templateVariable:R(t),group:s,heading:!0}}function R(e){const t=(0,c.RM)();if(!t||"block"!==e.table)return!1;if(t.isInsideTemplate())return!0;const n=u.W(e);if(n||t.isInsideFactoryOrDuplicateBlocksAction()){const t=null==n?void 0:n.getTitleStore();return!(n&&t&&t.id===e.id&&r.Xy(t.path,e.path))}return!!(0,d.td)(e)}function D(e){const{environment:t,textStore:n,oldSelection:r,oldTextValue:a,disableDateMentions:c,disableDateReminderMentions:d,disableTemplateVariableMentions:u}=e,p=function(e){const{textStore:t,oldSelection:n}=e;if(S.Z.state.open||l.Z.state.open||h.Z.state.open)return;const o=s.eeV(t.getValue()||[]),r=n.startIndex,i=(o[r]||"").normalize("NFKD"),a=(o[r-1]||"").normalize("NFKD"),c=b.Z.state;if(c.open)return"[["===c.insertionType&&"]"===i&&"]"===a?"]]":void 0;if("@"===i){if(a&&!/[\s\(\)\[\]]/g.test(a))return;return"@"}if("+"===i){if(a&&!/[\s\(\)\[\]]/g.test(a))return;return"+"}if("[["===o.slice(r-1,r+1).join("")){const e=o[r-1];if(e&&!/[\s\(\)\[\]]/g.test(e))return;return"[["}}(e);if(!p)return;const m=b.Z.state;if("]]"===p){if(m.open){const e=m.temporaryInputData.state;e&&m.temporaryInputData.setState({...e,suffix:"]]"}),b.Z.setState({...m,showCreateIn:!0})}return}const g=f.get();if(!g)return;const v=f.getRect(g);if(!v)return;const y=A({textStore:n,environment:t}),w=y.page,k=y.heading,I=y.createPage,x=y.user&&"@"===p,M=y.inviteUser&&"@"===p,P=y.bot&&"@"===p,R=y.date&&"@"===p&&!c,D=y.reminder&&"@"===p&&!c&&!d,E=y.templateVariable&&"@"===p&&!c&&!u,F=y.group&&"@"===p;if(!(x||F||w||I||R||D||E))return;if("+"===p&&!I)return;const O=(0,i.ZP)();T.S(t),b.Z.setState({open:!0,flowId:O,openTime:Date.now(),insertionType:p,textStore:n,oldTextValue:a,oldSelection:r,selectionRect:v,userRequestStore:new _.Z,botRequestStore:new _.Z,pageRequestStore:new _.Z,temporaryInputData:o.default.createValue(void 0),mentionTypes:{page:w,createPage:I,user:x,inviteUser:M,bot:P,date:R,reminder:D,templateVariable:E,group:F,heading:k},expandSection:void 0,showCreateIn:!1,showInvite:!1,createInQuery:"",isEmptyPageTitle:!1}),C.j1(t,{analyticsFrom:B(),flowId:O})}function E(e,t){M.N3({direction:"end"});const n=w.default.state;if("editing"!==n.mode)return;const o=(0,p.QY)(n.multiSelection);if(!o)return;let r=!1;if(o.selection.startIndex>0){const e=o.store.getValue()||[],t=s.eeV(e)[o.selection.startIndex-1];/[\s]/g.test(t)||(r=!0)}P.createAndCommit({userAction:"mentionMenuActions.insertMention",environment:e,perform:t=>{r?(M.hJ({environment:e,store:o.store,string:" ",selection:o.selection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t}),M.hJ({environment:e,store:o.store,string:"@",selection:{startIndex:o.selection.startIndex+1,endIndex:o.selection.endIndex+1},disableMentions:!1,disableDateMentions:!1,disableDateReminderMentions:!1,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})):M.hJ({environment:e,store:o.store,string:"@",selection:o.selection,disableMentions:!1,disableDateMentions:!1,disableDateReminderMentions:!1,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:t})}});const i=b.Z.state;if(!i.open)return;const a=A({environment:e,textStore:o.store});b.Z.setState({...i,mentionTypes:{page:a.page&&t.page,createPage:a.createPage&&t.createPage,user:a.user&&t.user,inviteUser:a.inviteUser&&t.inviteUser,bot:a.bot&&t.bot,date:a.date&&t.date,reminder:a.reminder&&t.reminder,templateVariable:a.templateVariable&&t.templateVariable,group:a.group&&t.group,heading:a.heading&&t.heading}})}function B(){const e=b.Z.state;if(e.open)return e.textStore.table===a.iU?"block":"comment"}function F(e){const t=b.Z.state,{environment:n,annotations:o=[],transaction:r,menuListItemAction:i,query:a,mentionType:l}=e;if(t.open){let e=t.oldTextValue,c=t.oldSelection;const d=t.insertionType.length-1;d>0&&(e=s._QS(e,t.oldSelection.startIndex-d,t.oldSelection.startIndex),c={startIndex:c.startIndex-d,endIndex:c.endIndex-d}),M.sO({environment:n,store:t.textStore,value:e,transaction:r});const u=B();o.forEach((e=>{M.lZ({environment:n,store:t.textStore,selection:c,annotation:e,analyticsFrom:u,transaction:r})})),l&&C.z7(n,{clickIndexGlobal:null==i?void 0:i.index,clickIndexLocal:null==i?void 0:i.indexLocal.indexLocal,sectionIndex:null==i?void 0:i.indexLocal.section,analyticsFrom:u,timeToClickInMs:Date.now()-t.openTime,queryLength:a.length,mentionType:l,flowId:t.flowId}),O()}}function O(){b.Z.setState({open:!1,userRequestStore:b.Z.state.userRequestStore,botRequestStore:b.Z.state.botRequestStore,pageRequestStore:b.Z.state.pageRequestStore,mentionTypes:b.Z.state.mentionTypes})}async function Z(e){const{environment:t,titleText:n,ignoreSelectionAreaStore:o,createInValue:r,onPageCreated:i,menuListItemAction:a}=e,s=b.Z.state;if(!s.open)return;if(!k.M_(t))return;o.reset();const{performResult:l}=await P.createAndCommitAsync({environment:t,userAction:"mentionMenuActions.acceptCreateIn",waitForServerCommit:!0,perform:async e=>{const o=x.f8({environment:t,transaction:e,titleText:n,createInValue:r,recordStoreParent:s.textStore}),l=o.createdPages[0];if(l)return i&&i(l),F({environment:t,annotations:[["p",l.id]],transaction:e,menuListItemAction:a,query:n,mentionType:"createPage"}),await o.moveToStorePromise,{createInState:o}}});if(l){const{createInState:e}=l;return await x.c_({analyticsFrom:"mention_menu",createInState:e}),e}}},91376:(e,t,n)=>{n.d(t,{CT:()=>l,r$:()=>s});var o=n(97799),r=n(80444),i=n(64404),a=n(92083);function s(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{currentTab:t,subtab:n,isMobile:i,openedFrom:s}=e;if(i)"notifications"!==t&&"notifications_and_settings"!==t&&"user_settings"!==t||o.Z.setState({open:!0});else if(t)a.Z.setState({open:!0,openedFrom:s,...c({currentTab:t,subtab:n}),highlightedSetting:void 0});else{const{currentSpaceStore:e}=r.default.state;a.Z.setState({open:!0,openedFrom:s,currentTab:l(e),defaultSubtab:void 0,highlightedSetting:void 0})}}function l(e){return e&&e.canRead()?"members":"settings"}function c(e){const{currentTab:t,subtab:n}=e;if("members"===t){return{currentTab:"members",defaultSubtab:n===i.Q.Members||n===i.Q.Groups||n===i.Q.Guests||n===i.Q.Reprovisioning||n===i.Q.Requests?n:void 0}}if("integrations"===t){return{currentTab:"integrations",defaultSubtab:"member_connections"===n||"workspace_connections"===n?n:void 0}}return{currentTab:t,defaultSubtab:void 0}}},60971:(e,t,n)=>{n.d(t,{aV:()=>i,eV:()=>a,kW:()=>c,sv:()=>d});var o=n(72126),r=n(85818);function i(e){const{store:t,itemsPerRow:n,sections:o,disableKeyboardArrowWrap:r}=e,{focus:i}=t.state;if(void 0===i.indexLocal)return c({store:t,sections:o,indexGlobal:0});const a=i.indexLocal+n,d=o[i.section],u=d.items.length-1;if(a<=u)return c({store:t,sections:o,indexLocal:{section:i.section,indexLocal:a}});const p=function(e){const{indexLocal:t,section:n,itemsPerRow:o}=e,r=l({indexLocal:t,section:n,itemsPerRow:o});if(!r)return;const i=s({section:n,itemsPerRow:o});if(!i)return;return r.rowsBefore===i.rowsBefore}({indexLocal:i.indexLocal,section:d,itemsPerRow:n});if(void 0===p)return;if(!1===p)return c({store:t,sections:o,indexLocal:{section:i.section,indexLocal:u}});const m=function(e){const{currentSection:t,sections:n,disableWrap:o}=e;if(0===n.length)return;if(t&&t>=n.length&&o)return;const r=void 0===t?0:(t+1)%n.length,i=n[r];if(!i)return;return{index:r,section:i}}({currentSection:i.section,sections:o,disableWrap:r});if(!m)return;const f=i.indexLocal%n;return m.section.items.length<=f?c({store:t,sections:o,indexLocal:{section:m.index,indexLocal:0}}):c({store:t,sections:o,indexLocal:{section:m.index,indexLocal:f}})}function a(e){const{store:t,itemsPerRow:n,sections:o,disableKeyboardArrowWrap:i}=e,{focus:a}=t.state;if(void 0===a.indexLocal){return c({store:t,indexGlobal:r.tM(o)-1,sections:o})}const l=a.indexLocal-n;if(l>=0)return c({store:t,sections:o,indexLocal:{section:a.section,indexLocal:l}});const d=function(e){const{currentSection:t,sections:n,disableWrap:o}=e;if(0===n.length)return;if(0===t||void 0===t){if(o)return;const e=n.length-1,t=n[e];if(!t)return;return{index:e,section:t}}const r=n[t-1];if(!r)return;return{index:t-1,section:r}}({currentSection:a.section,sections:o,disableWrap:i});if(!d)return;const u=s({section:d.section,itemsPerRow:n});if(!u)return;const p=a.indexLocal%n;if(u.column<p)return c({store:t,sections:o,indexLocal:{section:d.index,indexLocal:u.indexLocal}});{const e=u.rowsBefore*n+p;return c({store:t,sections:o,indexLocal:{section:d.index,indexLocal:e}})}}function s(e){const{section:t,itemsPerRow:n}=e;if(0===t.items.length)return;if(0===n)return;const o=t.items.length-1,r=l({indexLocal:o,section:t,itemsPerRow:n});return r?{indexLocal:o,...r}:void 0}function l(e){const{indexLocal:t,section:n,itemsPerRow:o}=e;if(!(o<=0||t>=n.items.length))return{rowsBefore:Math.trunc(t/o),column:t%o}}function c(e){const{store:t,sections:n}=e;if(e.indexLocal){const o=r.$6(e.indexLocal,n);if(!r._K(e.indexLocal,n))return;t.setState({...t.state,focus:{...e.indexLocal,indexGlobal:o}})}else if(void 0===e.indexGlobal)t.unsetFocus();else{const o=r.Ds(e.indexGlobal,n);if(!o)return;t.setState({...t.state,focus:{...o.index,indexGlobal:e.indexGlobal}})}}function d(e){let{store:t,focus:n}=e;"number"==typeof t.state.focus.indexLocal&&(o.Xy(n,t.state.focus)||t.setState({...t.state,focus:n}))}},98958:(e,t,n)=>{n.r(t),n.d(t,{handleTokenRefresh:()=>m,initializeMobileNativeApp:()=>u,registerPushNotifications:()=>p,waitForCssInsets:()=>f});var o=n(68626),r=n(91155),i=n(29477),a=n(62643),s=(n(95477),n(97978)),l=n(54642),c=n(9953),d=n(82530);async function u(e){if(e.device.isMobileNative&&e.mobileNative&&(await f(e),e.mobileNative.updateReceiveApiHandlers({track:t=>{s.j(e,t.eventName,{...t.eventData,logging_source:"mobile_native"})}}),e.mobileNative&&e.mobileNative.sqliteConnection))try{await e.mobileNative.sqliteConnection.ensureMigrated(),e.mobileNative.sqliteConnection.optimize()}catch(t){o.log({level:"error",from:"loginAction.ts",type:"backfillRecordsWithUserId",error:(0,r.Ui)(t),data:{}})}}async function p(e){const{mobileNative:t}=e;if(t&&t.api.registerPushNotifications){const n=await t.api.registerPushNotifications();n&&m(e,n,"registration")}}async function m(e,t,n){const o=e.currentUser.id;if(t&&o){const n=(0,a.r9)({user_id:o,token:t}),r=await l.syncRecordValue(e,{pointer:{table:a.q4,id:n},userId:o,version:-1});let i=!1;r&&(r.value&&!r.value.invalid||(d.createAndCommit({userAction:"mobileNativeActions.handleTokenRefresh",environment:e,perform:r=>{c.ae({environment:e,table:a.q4,value:{id:n,token:t,user_id:o,invalid:!1},inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,transaction:r})}}),i=!0))}}async function f(e){if(!e.device.isIOS||!e.device.isMobileNative)return;const t=document.createElement("div");t.style.width=`calc(${["env(safe-area-inset-top)","env(safe-area-inset-bottom)","env(safe-area-inset-left)","env(safe-area-inset-right)"].join(" + ")})`,t.style.visibility="hidden",document.body.appendChild(t);let n=0;for(;n<50&&!(t.offsetWidth>0);)await i.Vs(1),n++;document.body.removeChild(t),e.WindowSizeStore.updateWindowSize()}},29533:(e,t,n)=>{n.d(t,{R:()=>i,h:()=>a});var o=n(149),r=n(17294);function i(e,t){const n={taskStatus:e.taskStatus,...o.x.isSuccess(e)?{completeBlocks:e.value.completeBlocks,totalBlocks:e.value.totalBlocks}:{}};r.Z.update((e=>({...e,[t]:n})))}function a(e){r.Z.update((t=>({...t,[e]:void 0})))}},60870:(e,t,n)=>{n.d(t,{I0:()=>y,eX:()=>v,j2:()=>b,wS:()=>h});n(67294);var o=n(15157),r=n(72126),i=n(21202),a=n(63143),s=n(75770),l=n(98110),c=n(80444),d=n(79797),u=n(73990),p=n(76464),m=n(64964),f=n(85893);const g=10;function h(e){const{environment:t,movedItems:n,previousParentIds:o,moveToLocation:r,disableSuccessToast:i,numSubitems:a}=e,c=n.some((e=>{const t=o[e.id],n=e.getParentId();return!(!t||t===n)}));!i&&c&&m.oV({label:(0,s.ah)({environment:t,movedItems:n,moveToLocation:r,numSubitems:a}),right:(0,f.jsx)(l.Z,{moveToLocation:r,movedItems:n})})}function v(e){const{environment:t,transaction:n,moveToStore:o,targetBlocks:r,from:i}=e,{currentUserStore:a}=c.default.state;null!=a&&a.isDefined()&&o.canEdit()&&!o.canAdmin()&&r.forEach((e=>{if(e.canAdmin())return u.Y8(t,{from:i}),p.ep({transaction:n,store:e,environment:t,permissionItems:[{type:"user_permission",user_id:a.id,role:"editor"}]})}))}async function b(e,t,n){const i=await y(e,t),a=r.jj([n,...i]).slice(0,g);o.Z.set({userId:e.environment.currentUser.id,key:_(t),value:JSON.stringify(a)})}async function y(e,t){const n=o.Z.get({userId:e.environment.currentUser.id,key:_(t)});if(n){const t=(0,a.dj)(n);if(t){const n=await Promise.all(t.map((async t=>{const n=d.G.createChildStore(e,{table:i.iU,id:t});return await n.load(),n.canEdit()})));return t.filter(((e,t)=>n[t]))}}return[]}function _(e){return`recentMoveToTargets2:${e}`}},11302:(e,t,n)=>{n.d(t,{$X:()=>ne,QF:()=>oe,RL:()=>ie,Ws:()=>se,Y:()=>ce,at:()=>me,bA:()=>te,kj:()=>le,pB:()=>re,xv:()=>ae,z1:()=>J});n(52262),n(24506),n(21703);var o=n(15145),r=n(92996),i=n(41432),a=n(99036),s=n(68626),l=n(59730),c=n(72126),d=n(4615),u=n(21202),p=n(6287),m=n(97880),f=n(9291),g=n(10906),h=n(27105),v=n(19037),b=n(97978),y=n(77181),_=n(33929),S=n(75770),w=n(98165),k=n(48779),I=n(5162),C=n(80444),x=n(77556),T=n(77080),M=n(42330),P=n(98452),A=n(79797),R=n(52258),D=n(52229),E=n(73990),B=n(6404),F=n(54569),O=n(30188),Z=n(47307),V=n(57400),U=n(94419),N=n(92625),L=n(60870),j=n(72711),z=n(19785),q=n(9953),H=n(1357),W=n(24677),K=n(64964),G=n(29974),$=n(150),Q=n(82530),Y=n(68422),X=n(65452);const J=()=>[v._z,v.Gg,v.jl,v.ff(v.$I),v.ff(v.xw),v.ff(v.P9(i.Ti.externalObjectInstancePage)),v.ff(v.Vw),v.k5,v.ff(v.q4)],ee=(0,f.defineMessages)({duplicatingContent:{id:"moveToMenuActions.duplicatingContent.loadingMessage",defaultMessage:"Duplicating content…"},duplicatedToSpace:{id:"moveToMenuActions.duplicatedToSpace.toast",defaultMessage:"Duplicated {name} to {spaceName}"}});function te(e){const{environment:t,blocks:n,originRect:o,moveToContext:i,onAccept:a,isAddTo:s,isDefaultPrivateLocation:l,disableSuccessToast:c,forceUntyped:u}=e,p=Date.now(),m=(0,M.rJ)(n),f=function(e){const{hasDatabaseType:t,forceUntyped:n}=e;if(n)return r.br;if(t)return r.ii;return r.br}({forceUntyped:u,hasDatabaseType:Boolean(m)}),g=(0,d.ZP)();n.length&&(R.Z.reset(),P.Z.reset(),B.xv(),M.ZP.setState({variant:f,isOpen:!0,rect:o,targets:n,autocompleteQuery:"",moveToContext:i,onAccept:a,isAddTo:s,isDefaultPrivateLocation:l,lastPageId:M.ZP.state.lastPageId,disableSuccessToast:c,openedTimeMs:p,flowId:g}),E.rY(t,{from:i,render_type:"web",target_block_ids:n.map((e=>e.id)),targets_database_type:m,flowId:g}))}async function ne(e){const t=await async function(e){var t;const{environment:n,blocks:o,originRect:i,moveToContext:a,onAccept:s,isAddTo:l}=e,{currentSpaceStore:c}=C.default.state,u=Date.now(),p=M.ZP.state.isOpen?M.ZP.state.flowId:(0,d.ZP)(),m=(0,M.rJ)(o);if(m&&m!==r.GZ)return!1;if(!(0,I.Y)("supportsNativeMoveTo")||null===(t=n.mobileNative)||void 0===t||!t.api.moveTo||0===o.length||!c)return!1;const f=o.map((e=>e.id)),g=await n.mobileNative.moveTo({targets:f,spaceId:c.id,isAddTo:l||!1,moveToContext:a,flowId:p});if(!g)return!1;if(!g.supported||!g.destination)return g.supported;R.Z.reset(),P.Z.reset(),B.xv(),M.ZP.setState({variant:r.br,isOpen:!0,rect:i,targets:o,autocompleteQuery:"",moveToContext:a,onAccept:s,isAddTo:l,lastPageId:M.ZP.state.lastPageId,renderType:"mobileNative",openedTimeMs:u,flowId:p});const h=M.ZP.state.isOpen&&M.ZP.state.useSudoMode;return await re({environment:n,value:g.destination,useSudoMode:h,renderType:"native",isSearchResult:g.isSearchResult}),ae(n),!0}(e);t||te(e)}function oe(e,t,n){if("page"!==n.type)return!1;const o=new A.G(e,{table:u.iU,id:n.id}),r=(0,w.qA)(o);for(const i of r)if(t.includes(i.id))return!0;return!1}async function re(e){const{environment:t,value:n,useSudoMode:o,renderType:r,shouldClearPagePermissions:i,isSearchResult:a}=e;await Q.createAndCommitAsync({environment:t,userAction:"MoveToMenuRenderer.completeMoveTransaction",waitForServerCommit:!1,useSudoMode:o,perform:async e=>{const o=M.ZP.state;if(!o.isOpen)return;const{targets:s,disableSuccessToast:l,moveToContext:c,isDefaultPrivateLocation:d,flowId:u,autocompleteQuery:p}=o;await ie({targets:s,value:n,transaction:e,environment:t,shouldClearPagePermissions:i,disableSuccessToast:l,moveToContext:c,isDefaultPrivateLocation:d,renderType:r,timeToSelectMs:Date.now()-o.openedTimeMs,flowId:u,isSearchResult:Boolean(p)||a}),o.onAccept&&o.onAccept(n)}})}async function ie(e){let{targets:t}=e;const{value:n,transaction:o,environment:r,shouldClearPagePermissions:s,disableSuccessToast:l,moveToContext:d,isDefaultPrivateLocation:f,renderType:h,timeToSelectMs:v,flowId:_,isSearchResult:k}=e,{currentSpaceStore:I}=C.default.state;if(!I)return;let x=[];T.default.checkGate("collection_subitem_nested_operations")&&(x=await async function(e,t,n,o){let r=[];const i=c.Ps(e);if(!i)return[];const s=(0,g.fm)(i)??(0,y.Ll)(i,n);if(!s)return[];if(!s.collectionStore())return[];const l=s.currentSubitemFormatStoreForCollection.state,d=s.normalizedSchemaStore.state,u=(null==l?void 0:l.inverse)&&d[l.inverse];if(!u||!(0,a.p_)(u))return[];if(!e.some((e=>(0,y.CJ)({store:e,subitemFormat:l,propertySchema:u}).length>0)))return[];const p=(0,S.uw)(t);if(p instanceof A.NW||p instanceof A.G){if(await ue(p)instanceof A.NW)return r=await O.xr({environment:n,blocks:e,options:{canEdit:!0},collectionContextStore:s}),r}return[]}(t,n,r),t=[...t,...x]),ae(r);const P=I.id,R=function(e){const{type:t}=e;switch(t){case"page":case"collection":case"space-private-pages":case"team":return e.spaceId;case"space":return e.id;default:(0,m.t1)(t)}}(n);if(R&&P!==R){if(!(await(0,S.cJ)()))return}const D=t.find((e=>{const t=e.getType();return Boolean(t&&(0,i.S9)(t))})),B=D&&(0,w.VP)(D),F=(0,M.rJ)(t),Z=Object.fromEntries(t.map((e=>[e.id,e.getParentId()]))),V=await le({environment:r,value:n,targets:t,transaction:o,shouldClearPagePermissions:s});if(!V)return;const U=(0,S.HE)(n,r);L.wS({environment:r,previousParentIds:Z,movedItems:t,moveToLocation:U,disableSuccessToast:l,numSubitems:x.length});const N=D&&(0,w.VP)(D);E._T(r,{table:V.table,from:d,type:null==U?void 0:U.type,team_before:B&&(0,b.nB)(B),team_after:N&&(0,b.nB)(N),targets_database_type:F,destination_database_type:V.table===p.v?V.getDatabaseType():void 0,isDefaultPrivateLocation:f,render_type:h,time_to_select_ms:v,flowId:_,isSearchResult:k,subitemTreeSize:x.length>0?x.length:void 0}),V.table===u.iU&&await L.j2(I,I.id,V.id)}function ae(e){const t=M.ZP.state;M.ZP.setState({isOpen:!1,lastPageId:t.lastPageId}),W.ZH(e),t.isOpen&&"home_tab"===t.moveToContext&&H.d(e)}async function se(e){return de({...e,action:"add"})}async function le(e){return de({...e,action:"move"})}async function ce(e){return de({...e,action:"retain-alias"})}async function de(e){const{value:t,transaction:n,targets:r,shouldClearPagePermissions:i}=e;if("user_cancelled_move"===await $.Hl({transaction:n,moveStores:r,moveTargetStore:(0,S.uw)(t)}))return;i&&G.O2({blocks:r,transaction:n});const a=T.default.checkGate("collection_subitem_nested_operations");let l;const c=r.at(0);a&&c&&(l=(0,y.g0)(c)||(0,y.kG)(c,e.environment));const d=await async function(e){const{transaction:t,targets:n,value:r,environment:i,action:a}=e,{mainEditorCurrentBlockStore:l,currentSpaceStore:c,currentSpaceViewStore:d}=C.default.state,{id:p}=i.currentUser;if(!l||!p||!d)return;const f=(0,S.uw)(r);if(!f)return;if(f instanceof A.G&&T.default.checkGate("enable_text_crdt_client")&&(await f.load(),(0,h.iG)(f,n)))return void K.oV({label:(0,h.s8)(f)});let g;const{table:v}=f;switch(v){case"collection":case"block":g=await async function(e){const{environment:t,blockOrCollectionStore:n,targets:o,transaction:r,retainAliasInCurrentParent:i}=e,a=await ue(n);if(!a)throw new Error("Move to store invalid.");for(const s of o){const e=s.getParentStore();if(e instanceof A.G&&i){const n=D.k({environment:t,parentBlock:e,targetStore:s,transaction:r});z.jG({parentStore:e.getContentStore(),after:s.id,childStore:n,transaction:r})}if(a instanceof A.G)z.jG({parentStore:a,childStore:s,transaction:r});else if(a instanceof A.NW){const e=F.o3({environment:t,stores:[s],spaceId:a.getSpaceId(),transaction:r})[0];F.mp({environment:t,store:e,collectionStore:a,shouldCoerce:!0,groupsPointer:[],transaction:r}),z.zw({parentStore:a,childStore:e,transaction:r})}}return a}({environment:i,blockOrCollectionStore:f,targets:n,transaction:t,retainAliasInCurrentParent:"retain-alias"===a});break;case"space":g="space-private-pages"===r.type&&f.id===(null==c?void 0:c.id)?pe({environment:i,spaceStore:f,spaceViewStore:d,targets:n,transaction:t,currentUserId:p,retainAliasToBlock:"retain-alias"===a}):await async function(e){const{environment:t,transaction:n,currentSpaceViewStore:r,currentBlockStore:i,currentUserId:a,spaceStore:l,targets:c,action:d,value:p}=e;if("space"!==p.type&&p.spaceId&&p.spaceId!==l.id)throw new Error("Wrong value to move to another space");Y._w({environment:t,blocks:c,transaction:n});const m=i.getSpaceId()||l.id;let f;if("move"===d&&("space"!==p.type&&p.spaceId&&p.spaceId!==m||"space"===p.type&&p.id!==m||"space-private-pages"!==p.type)){N.j({message:ee.duplicatingContent,targetRecordId:l.id});const e=await G.eX({environment:t,blockStores:c,spaceId:l.id,targetParent:fe(p)});if(N.x(),void 0!==e.error)return void Z.showErrorMessage(e.error);f=e.value}else"space-private-pages"===p.type&&pe({environment:t,spaceStore:l,spaceViewStore:r,targets:c,transaction:n,currentUserId:a,retainAliasToBlock:"retain-alias"===d});await async function(e){const{environment:t,currentBlockStore:n,currentUserId:r,spaceStore:i,targets:a,crossSpaceTargetBlockId:l}=e,c=Boolean(a.find((e=>e.id===n.id))),d=(0,k.w3)(i.id);if(!c||!d)return;const p=l?A.G.createChildStore(n,{table:u.iU,id:l}):n;await X.l({environment:t,spaceId:i.id,userId:r}),await async function(e){const{environment:t,spaceStore:n,spaceViewStore:o,blockStore:r}=e;n&&o&&(t.device.isMobileNative&&s.log({level:"info",from:"moveToMenuActions",type:"SpaceSwitchingDebug",data:{message:"moveToMenuActions.switchToSpace"}}),C.default.setState({...C.default.state,currentSpaceStore:n,currentSpaceViewStore:o,mainEditorCurrentBlockStore:r}),await V.Yh(t))}({environment:t,spaceStore:i,spaceViewStore:d,blockStore:p}),j.ru({environment:t,blocks:[p],pageVisitSource:o.tY.Move})}({environment:t,currentBlockStore:i,currentUserId:a,targets:c,spaceStore:l,crossSpaceTargetBlockId:f}),f&&K.oV({label:_.default.formatMessage(ee.duplicatedToSpace,{name:(0,S.EC)({movedItems:c}),spaceName:l.getName()})});return l}({environment:i,transaction:t,currentSpaceViewStore:d,currentBlockStore:l,currentUserId:p,spaceStore:f,targets:n,value:r,action:a});break;case"team":g=me({environment:i,transaction:t,currentSpaceViewStore:d,teamStore:f,targets:n,value:r,action:a,location:{type:"append"}});break;default:(0,m.t1)(v)}"move"===a&&L.eX({environment:i,transaction:t,moveToStore:f,targetBlocks:n,from:"move_to"});return g}({...e});if(!d)return;if(a&&l&&d instanceof A.NW&&c){let t=(0,y.ko)(d);if(!t){const o=new x.Z(e.environment);if(o.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:d}),o){O.Bb({transaction:n,collectionContextStore:o,environment:e.environment})&&(t=(0,y.ko)(d))}}l&&t&&O.cI({blocks:r,transaction:n,from:l.subitemFormat,to:{property:t.property,inverse:t.inverse},environment:e.environment})}return d}async function ue(e){let t;return await e.load(),t=e instanceof A.NW?e:e.isLinkedCollectionView()?e.getCollectionViewSourceOrLinkCollectionStores()[0]:e.isCollectionView()?e.getCollectionViewCollectionStore():e,t}function pe(e){let{environment:t,spaceStore:n,spaceViewStore:o,targets:r,currentUserId:i,transaction:a,retainAliasToBlock:s}=e;for(const c of r){const e=c.getParentStore();if(e instanceof A.H2){if(e.id!==n.id)throw new l.D3("moveOrAddToPrivatePages: Try to move to a different space");U.Od({parent:e.getPagesStore(),childToRemove:c,transaction:a})}else if(e instanceof A.zX)$.sp({teamStore:e,store:c,transaction:a});else if(e instanceof A.G){if(s){const n=D.k({environment:t,parentBlock:e,targetStore:c,transaction:a});z.jG({parentStore:e.getContentStore(),after:c.id,childStore:n,transaction:a})}z.hr({parentStore:e,childStore:c,transaction:a})}const r={type:"user_permission",user_id:i,role:"editor"};q.sW({store:c,data:{permissions:[r]},transaction:a}),U.R3({parent:o.getPrivatePagesStore(),append:c,transaction:a})}return n}function me(e){let{transaction:t,currentSpaceViewStore:n,teamStore:o,targets:r,location:i,environment:a}=e;const s=n.getTeamsStores(),l=o.getTeamPagesStore();Y._w({environment:a,blocks:r,transaction:t});for(const d of r){const e=c.sE(s,(e=>{const t=e.getTeamPagesStore().getValue();if(t)return t.includes(d.id)}));(null==e?void 0:e.id)!==o.id&&("append"===i.type?z.jG({parentStore:l,childStore:d,after:i.after,transaction:t}):"prepend"===i.type?z.SH({parentStore:l,childStore:d,before:i.before,transaction:t}):(0,m.t1)(i),e&&$.sp({teamStore:e,store:d,transaction:t}))}return o}function fe(e){const{type:t}=e;switch(t){case"space":case"space-private-pages":return;case"page":return e.spaceId?{id:e.id,table:"block",spaceId:e.spaceId}:void 0;case"collection":case"team":return e.spaceId?{id:e.id,table:t,spaceId:e.spaceId}:void 0;default:(0,m.t1)(t)}}},17659:(e,t,n)=>{n.d(t,{$h:()=>B,E1:()=>E,G7:()=>Z,Jl:()=>P,Qy:()=>O,aY:()=>F,aZ:()=>D,go:()=>T,qQ:()=>V,rG:()=>A,w1:()=>U});var o=n(68626),r=n(91155),i=n(65311),a=n(97880),s=n(9291),l=n(95477),c=n(33929),d=n(50770),u=n(74948),p=n(24646),m=n(19034),f=n(38676),g=n(80444),h=n(45325),v=n(88923),b=n(79797),y=n(4761),_=n(83249),S=n(19719),w=n(54642),k=n(47307),I=n(99553),C=n(82530);const x=(0,s.defineMessages)({archiveError:{id:"notificationActions.archiveNotification.errorMessage",defaultMessage:"Failed to archive. Please try again."},setReadError:{id:"notificationActions.setRead.errorMessage",defaultMessage:"Failed to mark notification as read. Please try again."},setAllAsReadError:{id:"notificationActions.setAllAsRead.errorMessage",defaultMessage:"Failed to mark all notifications as read. Please try again."},setUnreadError:{id:"notificationActions.setUnread.errorMessage",defaultMessage:"Failed to mark notification as unread. Please try again."}});async function T(e){const t=y.ZP.state.currentTab,{currentSpaceStore:n}=g.default.state;if(n&&!l.default.isAdminMode&&(0,y.g0)(t)){try{await w.setNotificationsAsRead(e,{spaceId:n.id,timestamp:Date.now(),type:t})}catch(i){return k.showErrorMessage(c.default.formatMessage(x.setAllAsReadError)),void o.log({level:"error",from:"notificationActions",type:"setCurrentUpdatesTabAsRead",error:(0,r.Ui)(i)})}P(t,n.id,M.decrementToZero)}}const M={incrementByOne:e=>e+1,decrementByOne:e=>Math.max(e-1,0),decrementToZero:e=>0};function P(e,t,n){const{results:o}=m.Z.state,r=o.map((o=>{if(o.spaceId===t){const t=o.unread[e];return void 0===t?o:{...o,unread:{...o.unread,[e]:n(t)}}}return o}));m.Z.setState({results:r})}async function A(e,t,n){const{currentSpaceStore:i}=g.default.state;if(i&&!l.default.isAdminMode){try{for(;;){if(!(await R({environment:e,currentSpaceStore:i,inbox:t,readFilter:n})).more)break}}catch(a){return k.showErrorMessage(c.default.formatMessage(x.archiveError)),void o.log({level:"error",from:"notificationActions",type:"archiveAll",error:(0,r.Ui)(a)})}"read"!==n&&P(t,i.id,M.decrementToZero)}}async function R(e){const{environment:t,currentSpaceStore:n,inbox:i,readFilter:a}=e,s=await w.getUnvisitedNotificationIds(t,{spaceId:n.id,timestamp:Date.now(),type:i,size:500,readFilter:a});if("failed"===s.type)return k.showErrorMessage(c.default.formatMessage(x.archiveError)),o.log({level:"error",from:"notificationActions",type:"archiveApiError",error:(0,r.Ui)(s.error)}),{more:!1};const{notificationIds:l}=s.data;return await async function(e){const{environment:t,notificationIds:n,rootStore:o}=e,{serverCommitResult:r}=C.createAndCommit({userAction:"notificationActions.archiveNotificationIds",environment:t,canUndo:!0,undoCheckpoint:!0,perform:e=>{for(const t of n)E({transaction:e,rootStore:o,visited:!0,notificationId:t})}});await r}({environment:t,notificationIds:l,rootStore:n}),l.length>=500?{more:!0}:{more:!1}}function D(e){const{notification:t,rootStore:n,transaction:a}=e;if(!t.visited){try{E({notificationId:t.id,rootStore:n,transaction:a,visited:!0})}catch(s){return k.showErrorMessage(c.default.formatMessage(x.archiveError)),void o.log({level:"error",from:"notificationActions",type:"archiveNotification",error:(0,r.Ui)(s)})}if(!t.read){P(i.hE[t.type],t.space_id,M.decrementByOne)}}}function E(e){const{transaction:t,notificationId:n,rootStore:o,visited:r}=e,a=(0,b.Kv)(o,{table:i.uX,id:n});C.applyOperation({transaction:t,store:a,operation:{command:"update",pointer:{table:i.uX,id:n},path:[],args:r?{visited:!0,read:!0,archived_at:Date.now()}:{visited:!1,archived_at:null}}})}function B(e){const{transaction:t,notification:n,rootStore:a,read:s}=e;if(n.read===s)return;const l=(0,b.Kv)(a,{table:i.uX,id:n.id});try{C.applyOperation({transaction:t,store:l,operation:{command:"update",pointer:{table:i.uX,id:n.id},path:[],args:{read:s}}})}catch(d){return e.suppressErrorMessage||k.showErrorMessage(c.default.formatMessage(s?x.setReadError:x.setUnreadError)),void o.log({level:"error",from:"notificationActions",type:"setRead",error:(0,r.Ui)(d)})}P("mentions",n.space_id,s?M.decrementByOne:M.incrementByOne)}function F(){return m.Z.getUnreadCountForCurrentSpace().mentions}async function O(e){const{environment:t}=e,{currentSpaceStore:n}=g.default.state;if(!n)return[];const o=await w.getUnvisitedNotificationIds(t,{spaceId:n.id,timestamp:Date.now(),type:"mentions",size:100,readFilter:"unread"});return"failed"===o.type?[]:o.data.notificationIds}function Z(e){let{environment:t,newTab:n,shouldTrack:o}=e;const r=y.ZP.state.currentTab;if(r!==n&&("mentions"===n?y.ZP.update((e=>({...e,currentTab:n,containsBothReadAndUnreadNotifications:!1,containsUnreadNotifications:!1,showOnlyUnreadNotifications:!1,unreadNotificationIds:[]}))):y.ZP.update((e=>({...e,currentTab:n})))),o){const e=t.device.isMobile;S.GP({environment:t,forceRestartSession:!1,from:"updates-tab-click"}),e&&_.nB(t,{itemName:"updates"})}"mentions"===r&&async function(e){const t=(0,d.H7)(),n=await w.getUserNotifications(e,{size:1e3,isInboxV2:t});if("failed"===n.type)return;const{results:o}=n.data;m.Z.setState({results:o})}(t)}function V(e){const{environment:t,open:n}=e;if(n){h.default.setState({...h.default.state,openState:"opening",mode:(0,d.r_)()?"peek":"panel"});const e=f.sidebarExpandedStore.state;f.sidebarOpenStore.state&&!e&&u.close(),(0,p.Sx)(t)&&u.setUpdateExpand({environment:t,isExpanded:!1,from:"close_for_space"}),v.default.isSidePeekOpen()&&I.xv(t,"inbox_panel_expand"),S.l2({environment:t})}else h.default.setState({...h.default.state,openState:"closing"}),S.Br({environment:t})}function U(e){const{openState:t}=h.default.state;switch(t){case"open":case"opening":V({environment:e,open:!1});break;case"closed":case"closing":V({environment:e,open:!0});break;default:(0,a.t1)(t)}}},36110:(e,t,n)=>{n.d(t,{V:()=>v,g:()=>h});var o=n(77657),r=n(74181),i=n(56589),a=n(82036),s=n(89101),l=n(9852),c=n(64002),d=n(63143),u=n(86615),p=n(54642),m=n(47307),f=n(12714),g=n(8055);function h(e){const{environment:t,responseType:n,integrationId:o,redirectUri:r,state:i,owner:a,userId:l,spaceId:u}=e,p=c.bf({url:s._j.oauthAuthorization,query:(0,d.m8)(Object.entries({response_type:n,client_id:o,redirect_uri:r,state:i,owner:a,user_id:l,space_id:u}).filter((e=>{let[,t]=e;return t})))});g.c4({environment:t,url:p,redirect:!0})}async function v(e){const{environment:t,params:n,integration:d}=e;l.In(void 0);const h=d&&i._(d,n.redirectUri);if(!h)return void g.c4({environment:t,url:s._j.root,redirect:!0});let b;if("errorType"in e)b={error:e.errorType,state:n.state};else{const{integration:o,spaceId:i,blockIdsForBot:s,acceptedIntegrationCapabilities:l}=e;let c;if(c=(0,r.VM)(o)?await p.createOauthAuthorizationCode(t,{integrationId:o.id,spaceId:i,redirectUri:n.redirectUri,acceptedIntegrationCapabilities:l}):await p.createOauthAuthorizationCode(t,{integrationId:o.id,spaceId:i,redirectUri:n.redirectUri,blockIdsForBot:s,templatePageId:e.templatePageId,acceptedIntegrationCapabilities:l}),"failed"===c.type){m.showError(c);return v({environment:t,params:n,integration:o,errorType:503===c.status?a._.temporarily_unavailable:a._.server_error})}b={code:c.data.code,state:n.state}}d.id===o.Dv&&await u.dl(t);const y=c.bf({url:h,query:{...b}});f.D({environment:t,url:y,targetSelf:!0})}},15356:(e,t,n)=>{n.d(t,{M:()=>m});var o=n(29477),r=n(89101),i=n(64002),a=n(9291),s=n(95477),l=n(33929),c=n(77080),d=n(47307),u=n(47839);const p=(0,a.defineMessages)({allowPopup:{id:"authAction.authorize.popupBlocked",defaultMessage:"It looks like your browser is currently blocking popups. Please allow pop-ups to continue"},dismissButtonLabel:{defaultMessage:"Okay",id:"dialog.dismissButton.label"}});async function m(e,t){const{width:n,height:a,url:m,titleMessage:g}=t,h=l.default.formatMessage(g);if(e.device.isElectron)return u.openOauthPopup({width:n,height:a,url:m,title:h});const v=e.device.isMobile,b=void 0!==window.screenX?window.screenX:window.screenLeft,y=void 0!==window.screenY?window.screenY:window.screenTop,_=void 0!==window.outerWidth?window.outerWidth:document.documentElement.clientWidth,S=void 0!==window.outerHeight?window.outerHeight:document.documentElement.clientHeight-22,w=v?0:n,k=v?0:a;let I="toolbar=0,menubar=0,location=0";0!==w&&(I+=`,width=${w}`),0!==k&&(I+=`,height=${k}`),I+=`,left=${(b<0?window.screen.width+b:b)+(_-w)/2}`,I+=`,top=${y+(S-k)/2.5}`,I+=",scrollbars=1";const C=f()?(0,i.bf)({url:`${s.default.domainBaseUrl}${r._j.verifyNoPopupBlockerHtmlAndRedirect}`,query:{redirectUri:m}}):m,x=window.open(C,h,I);if(x)x.focus();else if(f())return void d.showDialog({showCancel:!1,keepFocus:!1,message:l.default.formatMessage(p.allowPopup),items:[{label:l.default.formatMessage(p.dismissButtonLabel),onAccept:()=>{}}]});const T=o.UZ();if(C.includes("evernotepopupredirect")&&c.default.checkGate("is_evernote_authpopup_closing_fix_enabled")){const e=e=>{if(e&&e.data&&"popup-callback"===e.data.type){const t=e.data.url;T.resolve(t)}const t=localStorage.getItem("externalAuthCallback");t&&T.resolve(t)};window.addEventListener("message",e,!1);const t=await T.promise;return window.removeEventListener("message",e,!1),localStorage.removeItem("externalAuthCallback"),x&&x.close(),window.focus(),t}{const e=e=>{if(e&&e.data&&"popup-callback"===e.data.type){const t=e.data.url;T.resolve(t)}},t=setInterval((()=>{const e=localStorage.getItem("externalAuthCallback");e?T.resolve(e):x&&x.closed&&T.resolve(void 0)}),300);window.addEventListener("message",e,!1);const n=await T.promise;return window.removeEventListener("message",e,!1),localStorage.removeItem("externalAuthCallback"),clearInterval(t),x&&x.close(),window.focus(),n}}function f(){return"on"===c.default.getEligibleGroup({experimentId:"show_instruction_on_auth_popup_blocked",defaultGroup:"control"})}},89858:(e,t,n)=>{n.d(t,{A5:()=>re,D0:()=>Q,Eo:()=>oe,LR:()=>ne,NP:()=>te,kC:()=>Y,mv:()=>X,pq:()=>J,v9:()=>ee});n(21703),n(57658),n(67294);var o=n(15145),r=n(41432),i=n(15157),a=n(72126),s=n(72141),l=n(29369),c=n(9291),d=n(35683),u=n(75754),p=n(91851),m=n(27105),f=n(75770),g=n(35026),h=n(48779),v=n(95697),b=n(81844),y=n(74948),_=n(24646),S=n(77999),w=n(80444),k=n(55367),I=n(42330),C=n(79797),x=n(34583),T=n(88893),M=n(88280),P=n(73292),A=n(952),R=n(66324),D=n(98834),E=n(47307),B=n(94419),F=n(13084),O=n(60870),Z=n(11302),V=n(19785),U=n(76464),N=n(9953),L=n(26999),j=n(64964),z=n(29974),q=n(28014),H=n(150),W=n(82530),K=n(68422),G=n(1742),$=n(85893);function Q(e){var t;const{environment:n,store:i,transaction:a,navigateToParent:s}=e,l=N.j4({environment:n,type:r.Ti.page,inMemoryRecordCache:i.inMemoryRecordCache,transaction:a,spaceId:i.isCollectionView()?null===(t=i.getCollectionViewCollectionStore())||void 0===t?void 0:t.pointer.spaceId:i.pointer.spaceId,useCrdt:i.useCrdt()}),c=i.getAssociatedCollectionStore();if(i.isCollectionView()){const e=i.getCollectionViewCollectionStore()||c;if(!e)throw new Error("getCollectionViewCollectionStore() returned undefined");if(!V.zw({parentStore:e,childStore:l,transaction:a}))throw new Error("parentChildActions.moveToCollection() returned false");const t=e.getDefaultTemplatePageStore();t&&D.ob({title:"template",environment:n,store:l,templateStore:t,isKeyboard:!1,isCreateIn:!1,transaction:a,from:"outliner_actions"})}i.isCollectionView()||V.jG({parentStore:i.getContentStore(),childStore:l,transaction:a}),I.ZP.setState({...I.ZP.state,lastPageId:w.default.state.mainEditorCurrentBlockStore?w.default.state.mainEditorCurrentBlockStore.id:void 0}),n.device.isMobile?u._({environment:n,store:l,showMoveTo:!1,saveParent:!1,visitType:d.vu.Link,pageVisitSource:o.tY.Create}):L.CH({environment:n,store:l,showMoveTo:!0,saveParent:!1,currentBlockStore:s?i:void 0,peekMode:void 0,resultsStore:void 0,collectionContextStore:void 0,pageVisitSource:o.tY.Create}),A.W(n,{from:"sidebar_outliner_item",type:"page",new_page_id:l.id,creating_block_id:l.id})}async function Y(e){const{environment:t,spaceStore:n,spaceViewStore:r,type:i,prepend:a,outlinerToggleButtonStore:s,shouldPersistToggleState:l,title:p,useCrdt:m}=e,f=new G.sA(t,"createPageInSection");if(x.M_(t)){if("workspace"===i){const e=M.subscriptionDataStoreInstance.state,t=e?(0,T.su)(e):1;if(t>=10){if(!(await E.confirmUserAction({message:(0,$.jsx)("span",{children:(0,$.jsx)(c.FormattedMessage,{defaultMessage:"Are you sure you want to create a new top-level page? <strongtext>This page will be visible in the sidebar to all {memberCount} members of your workspace.</strongtext>",id:"sidebarActions.confirmDialog.newWorkspacePage.message",values:{strongtext:e=>(0,$.jsx)("strong",{children:e}),memberCount:t}})}),acceptLabel:(0,$.jsx)(c.FormattedMessage,{defaultMessage:"Create top-level page",id:"sidebarActions.confirmDialog.newWorkspacePage.confirmButton.label"})})))return null}}const{serverCommitResult:e,performResult:{createdPage:g}}=W.createAndCommit({userAction:"outlinerActions.createPageInSection",environment:t,perform:e=>{const o=q.KE({environment:t,spaceStore:n,spaceViewStore:r,isPrivate:"private"===i,prepend:a,transaction:e,title:p,tracker:f,useCrdt:m});return s&&oe({environment:t,spaceViewStore:r,type:i,outlinerToggleButtonStore:s,newIsHidden:!1,shouldPersistToggleState:Boolean(l)}),t.device.isMobile&&y.close(),{createdPage:o}}});"private"===i?A.W(t,{from:"sidebar_private_section",type:"page",new_page_id:g.id,creating_block_id:g.id}):"workspace"===i&&A.W(t,{from:"sidebar_workspace_section",type:"page",new_page_id:g.id,creating_block_id:g.id});const h=n.getDisableSpacePageEdits();return"workspace"===i&&h&&await e,u._({environment:t,store:g,visitType:d.vu.Link,pageVisitSource:o.tY.Create}),g}}async function X(e){const{environment:t,spaceStore:n,spaceViewStore:r,teamStore:i,andNavigate:a,from:s,outlinerToggleButtonStore:l,shouldPersistToggleState:c,title:p,loading:m,appendOrPrepend:f,event:g}=e,{serverCommitResult:h,performResult:{createdPage:v}}=W.createAndCommit({userAction:"outlinerActions.createPageInTeam",environment:t,perform:e=>({createdPage:J({environment:t,spaceStore:n,spaceViewStore:r,teamStore:i,from:s,title:p,event:g,loading:m,appendOrPrepend:f,transaction:e})})});return await h,a&&u._({environment:t,store:v,visitType:d.vu.Link,pageVisitSource:o.tY.Create}),l&&P.k7({environment:t,spaceViewStore:r,teamStore:i,outlinerToggleButtonStore:l,newIsHidden:!1,shouldPersistToggleState:Boolean(c),isExplicitUserAction:!1}),v}function J(e){const{environment:t,spaceStore:n,spaceViewStore:o,teamStore:r,from:i,title:a,event:s,loading:c,appendOrPrepend:d,transaction:u}=e;if(!(0,g.si)({teamStore:r,environment:t}))throw new Error("User is not eligible to create top-level page in team");const p=q.KE({environment:t,spaceStore:n,spaceViewStore:o,isPrivate:!1,prepend:!1,title:a,loading:c,transaction:u,useCrdt:(0,m.Sy)({event:s,source:"team"})});A.t(t,{teamStore:r,from:i,pageId:p.id,transaction:u}),U.u9({store:p,transaction:u});const h=(0,f.uw)({type:"team",id:r.id});if(h.table!==l.e0)throw new Error("Assertion failure, moveToStore table is not TeamTable!");return Z.at({environment:t,transaction:u,action:"add",teamStore:h,currentSpaceViewStore:o,targets:[p],value:{type:"team",id:r.id},location:{type:d}}),p}async function ee(e){var t,n;const{environment:o,droppedStores:i,droppedDirection:a,type:l,targetStore:d,targetParentStore:u}=e,g=await(0,f.ed)({environment:e.environment,blocks:i,from:"dragAndDrop",dropArgs:{direction:a,destination:d,destinationOutlinerType:l}});if(!g.confirmed)return;const{shouldClearPagePermissions:v}=g;if(1===i.length&&(null===(t=u.getValue())||void 0===t||null===(n=t.includes)||void 0===n||!n.call(t,i[0].id))){let e=[];for(const n of i)if(e=await p.NN({environment:o,block:n,action:"move"}),"user_canceled"===e)return;const t=i[0].id;for(const n of e)n.id!==t&&i.push(n)}const y=Object.fromEntries(i.map((e=>[e.id,e.getParentId()]))),{performResult:{moved:_}}=await W.createAndCommitAsync({environment:o,userAction:"outlinerActions.confirmAndHandleDrop",waitForServerCommit:!0,perform:async t=>{const n=await async function(e){const{environment:t,type:n,droppedDirection:o,targetStore:i,targetParentStore:a,droppedStores:l,transaction:d,isTopLevelItem:u,shouldClearPagePermissions:p}=e,g=function(e){for(const t of e){const e=b.Z.findOutlinerItemFromStore(t);if(e)return e.type}}(l),{currentSpaceStore:v,currentUserStore:y}=w.default.state,_=null==v?void 0:v.id,S=M.subscriptionDataStoreInstance.state,I="bookmarks"===g&&"bookmarks"===n,x=ie(e),P=_&&l.some((e=>e.isTopLevelWorkspacePage(_))),A=i&&_&&i.isTopLevelWorkspacePage(_),R=null==v?void 0:v.getDisableSpacePageEdits();if(_&&R&&(P||A)&&!I&&o!==k.vh.Onto&&null!=y&&y.isDefined()&&S){const e=(0,T.hn)(S).filter((e=>e.userId===y.id))[0];if(e&&!s.zz(e.role))return E.showErrorMessage((0,$.jsx)(c.FormattedMessage,{defaultMessage:"This workspace has locked top-level workspace page operations.",id:"sidebarActions.confirmDialog.lockedWorkspaceTopLevel.message"})),!1}const D=function(e){let{targetStore:t,targetParentStore:n}=e;if(t)return t;const{id:o,table:r}=n;let i;switch(r){case"space":case"space_view":i={type:"space",id:o};break;case"block":i={type:"page",id:o};break;case"team":i={type:"team",id:o};break;default:throw new Error("Unexpected table type")}return(0,f.uw)(i)}({targetStore:i,targetParentStore:a});if(function(e){const{droppedDirection:t,targetStore:n,droppedStores:o,targetParentStore:r}=e,i=t===k.vh.Onto?n:r.getRecordStoreAtRootPath();if(!(i instanceof C.G))return!1;const a=(0,m.iG)(i,o);a&&j.oV({label:(0,m.s8)(i)});return a}(e))return!1;if(!I&&!x){if("user_cancelled_move"===await H.Hl({transaction:d,moveStores:l,moveTargetStore:D}))return!1}O.eX({environment:t,transaction:d,moveToStore:D,targetBlocks:l,from:"drag_and_drop"});const B=function(e){const{environment:t,type:n,targetStore:o,targetParentStore:i,droppedDirection:a,droppedStores:s,duplicate:l,transaction:c}=e,{currentSpaceViewStore:d,currentSpaceStore:u,currentUserSettingsStore:p}=w.default.state;let m;const f=null==o?void 0:o.getModel();if(a===k.vh.Onto&&o&&i&&null!=f&&f.isType(r.m3))m=F.LQ({environment:t,targetParentStore:i,targetStore:o,droppedDirection:k.vh.Below,droppedStores:s,duplicate:l,transaction:c});else if(ie(e)&&o){if(!d||!p)throw new Error("currentSpaceViewStore or currentUserSettingsStore not found");const{visibleSharedPagesStores:e}=(0,h.MC)({environment:t,spaceViewStore:d,userSettingsStore:p}).state,n=e.map((e=>e.id)),r=s.map((e=>e.id)),i=n.filter((e=>r.indexOf(e)<0)),l=i.findIndex((e=>e===o.id));let u=[];u=a===k.vh.Above?[...i.slice(0,l),...r,...i.slice(l)]:[...i.slice(0,l+1),...r,...i.slice(l+1)],N.sW({store:d,data:{shared_pages:u},transaction:c}),m=s}else"private"===n&&u&&d&&q.OQ({environment:t,spaceStore:u,spaceViewStore:d,transaction:c}),m=F.LQ({environment:t,targetParentStore:i,targetStore:o,droppedDirection:a,droppedStores:s,duplicate:l,transaction:c});return m}(e),Z=B.filter((e=>e.isTopLevel()));p&&z.O2({blocks:B,transaction:d});"workspace"===n?z.lF({environment:t,blocks:Z,transaction:d}):"private"===n&&z.IY({environment:t,blocks:Z,transaction:d});const V=u&&o!==k.vh.Onto;V&&K._w({environment:t,blocks:l,transaction:d});return!0}({...e,transaction:t,shouldClearPagePermissions:v});return{moved:n}}});_&&O.wS({environment:o,movedItems:i,previousParentIds:y,moveToLocation:(0,f.vz)({targetStore:d,droppedDirection:a,outlinerSectionType:l,environment:o})})}async function te(e){const{droppedStores:t,duplicate:n}=e.dropArgs,{environment:o,type:r,isTopLevel:i,parentStore:a}=e,s=k.vh.Below;return!!a&&(await ee({environment:o,type:r,targetParentStore:a,isTopLevelItem:i,droppedDirection:s,droppedStores:t,duplicate:n}),!0)}function ne(e){const{environment:t,store:n,parentStore:o,insertStores:r,transaction:i,before:s,type:l}=e,{currentSpaceViewStore:c,currentSpaceStore:d}=w.default.state,u=a.d9(r).reverse();"private"===l&&d&&c&&q.OQ({environment:t,spaceStore:d,spaceViewStore:c,transaction:i});const p=s?r.map((e=>B.Vt({parent:o,insert:e,before:n,transaction:i}).child)):u.map((e=>B.BE({parent:o,insert:e,after:n,transaction:i}).child)),m=p.filter((e=>e.isTopLevel()));return"workspace"===l?z.lF({environment:t,blocks:m,transaction:i}):"private"===l&&z.IY({environment:t,blocks:m,transaction:i}),p}function oe(e){const{environment:t,spaceViewStore:n,type:o,outlinerToggleButtonStore:r,newIsHidden:a,shouldPersistToggleState:s}=e;r.setState({...r.state,isHidden:a}),R.VS(t,{is_toggled:!a,outliner_type:o}),s&&i.Z.set({userId:n.environment.currentUser.id,key:(0,_.Fl)(n,o),value:a}),"inactive"!==S.default.state.type&&a&&S.default.setState({type:"inactive"})}function re(e){const{type:t,targetStore:n,targetParentStore:o,transaction:r,isTopLevelItem:i}=e,a=(0,v.bq)()&&"team"===t&&o.table===l.e0&&i;if(B.Od({childToRemove:n,parent:o,transaction:r}),a&&n.getParentId()===o.id){const t=C.zX.createChildStore(e.targetParentStore,{...e.targetParentStore.pointer,table:l.e0});H.sp({teamStore:t,store:n,transaction:r})}}function ie(e){let{type:t,droppedDirection:n,isTopLevelItem:o}=e;return"shared"===t&&n!==k.vh.Onto&&o}},65889:(e,t,n)=>{n.d(t,{I:()=>o,O:()=>r});const o=function(e){const{key:t,overlayContainerStore:n}=e;n.state.overlays.has(t)||(n.state.overlays.add(t),n.emit())},r=function(e){const{key:t,overlayContainerStore:n}=e;n.state.overlays.has(t)&&(n.state.overlays.delete(t),n.emit())}},72711:(e,t,n)=>{n.d(t,{Y_:()=>P,bo:()=>R,hc:()=>M,og:()=>E,ru:()=>A,tk:()=>D});n(21703);var o=n(1302),r=n(41432),i=n(72126),a=n(4615),s=n(21202),l=n(6287),c=n(75754),d=n(10906),u=n(84210),p=n(12534),m=n(39500),f=n(89014),g=n(58202),h=n(80444),v=n(94896),b=n(79797),y=n(26664),_=n(17963),S=n(52229),w=n(96802),k=n(94419),I=n(9953),C=n(8055),x=n(29373),T=n(82530);const M=function(e){const{environment:t,store:n,targetStore:o,transaction:r}=e,i=n.getParentBlockStore();if(i){const e=i.getContentStore(),a=S.k({environment:t,parentBlock:i,targetStore:o,transaction:r});return k.rS({parent:e,oldChild:n,newChild:a,transaction:r}).child}throw new Error("Could not create alias block.")};function P(e){const{environment:t,store:n,collectionStore:i,collectionViewStore:c,transaction:u}=e,{id:p}=t.currentUser,m=n.getRecordStoreUIParent();if(null!=m&&m.valueIs(y.i)){if(!n.isDefined())throw new Error("Block to replace was not defined.");if(m&&p){var h,v;const e=(0,a.ZP)(),p=null===(h=(0,d.Vv)(i))||void 0===h?void 0:h.getFormatStore().getKeyStore("table_properties").getValue(),y=null===(v=(0,d.Vv)(i))||void 0===v||null===(v=v.getQueryStore())||void 0===v?void 0:v.getKeyStore("sort").getValue(),_={id:(0,a.ZP)(),version:0,type:"table",parent_id:e,parent_table:"block",alive:!0,space_id:n.getSpaceId(),format:{table_properties:p,collection_pointer:{table:l.v,id:i.id,spaceId:i.pointer.spaceId}},query2:{sort:y}};I.ae({environment:t,table:"collection_view",value:_,inMemoryRecordCache:n.inMemoryRecordCache,transaction:u});const S=I.j4({environment:t,id:e,type:r.Ti.collectionView,spaceId:n.getSpaceId(),useCrdt:n.useCrdt(),inMemoryRecordCache:n.inMemoryRecordCache,transaction:u});I.sW({store:S,data:{view_ids:[_.id]},transaction:u});const w=k.rS({parent:m,oldChild:n,newChild:b.G.createChildStore(m,{table:s.iU,id:e}),transaction:u}).child;return(0,f.u)(_.id,{viewPointer:null==c?void 0:c.pointer}),o.default.afterNextFlush((()=>{const e=g.R.findBlockFromStoreWithMethod(w,"handleCreated");e&&e.handleCreated()})),w}}}function A(e){const{environment:t,blocks:n,openInNew:o,pageVisitSource:r}=e,i=n[0];if(o){const e=(0,u.ZP)({store:i,pageVisitSource:r});C.c4({environment:t,url:e,openInNew:o})}else{const e=i.recordStoreUIParentStore instanceof b.G&&i.recordStoreUIParentStore.isCollectionView(),{mainEditorCurrentBlockStore:n}=h.default.state;if(e&&n){const e=(0,u.ZP)({store:n,fullyQualified:!1,peekViewBlockId:i.id,pageVisitSource:r});C.c4({environment:t,url:e})}else c._({environment:t,store:i,pageVisitSource:r})}}function R(e){const{environment:t,store:n,lock:o}=e,{id:r}=t.currentUser;if(!r)return;const i={block_locked:o,block_locked_by:r};T.createAndCommit({userAction:"pageBlockActions.setPageLock",environment:t,perform:e=>{I.sW({store:n.getFormatStore(),data:i,transaction:e})}})}function D(e){const{transaction:t,store:n,coverStore:o,pageCovers:r}=e,a=Object.keys(r),s=r[a[i.MX(0,a.length-1)]],l=s.items[i.MX(0,s.items.length-1)],c=l.coverUrl,d=l.position;I.sO({store:o,value:c,transaction:t}),w.Mp({store:n,coverPosition:d,transaction:t})}function E(e,t,n){(0,p.ZP)({event:e,context:p.Af.EditorClick,callback:()=>function(e,t){const n=Boolean(_.Z.state.pageMap[e.id])||v.Z.state.pages.has(e.id);!e.canEdit()||e.isLocked()||n||(0,m.X9)()||T.createAndCommit({userAction:"PageViewBlock.handlePlaceholderClick",environment:t,perform:n=>{x.ls({environment:t,store:e,transaction:n})}})}(t,n)})}},73661:(e,t,n)=>{n.d(t,{P:()=>a});var o=n(55320),r=n(32441),i=n(54642);function a(e,t,n){r.Pu(t,{page_id:e.id,searchSessionId:o.default.state.sessionId,spaceId:e.getSpaceId(),pageVisitId:n.getCurrentPageVisitId()}),i.recordPageExit(t,{block:{id:e.id,spaceId:e.getSpaceId()},timestamp:Date.now()})}},25320:(e,t,n)=>{n.d(t,{Ri:()=>y,UX:()=>b,s4:()=>v});var o=n(50475),r=n(72126),i=n(21202),a=n(70017),s=n(89470),l=n(23867),c=n(97880),d=n(46654),u=n(65598),p=n(80444),m=n(53730),f=n(79797),g=n(54642);const h=32,v=100;async function b(e,t){await p.default.waitUntilRendered();const{fromPageRefresh:n,block:r,pageVisitStore:c,timestamp:h}=t,v=e.currentUser.id;if(void 0===v||n)return;t.block.id!==c.state.pageId&&c.setState({...c.getInitialState(),pageId:t.block.id});const b=(0,f.Kv)(r,{table:s.UI,id:(0,s.Pv)({parent_id:r.id,user_id:v}),spaceId:(0,l.C)(r.pointer.spaceId)}),y=(0,f.Kv)(r,{table:a.Kk,id:(0,s.Pv)({parent_id:r.id,user_id:v}),spaceId:(0,l.C)(r.pointer.spaceId)});if(await m.transactionQueue.awaitRecordTransaction({table:i.iU,id:r.id}),await(0,u.M1)(r),!r.canRead()||(0,d.IJ)(e,r))return;await b.load(),await y.load();const S=b.getKeyStore("visited_at").getValue(),w=y.getKeyStore("exited_at").getValue(),k=await async function(e,t,n,r){const{id:i}=e.currentUser,a=t.id,s=t.getSystemBlockTypeStore().getValue();if((0,o.EW)(s))return{type:"skipped"};var l;i&&(null==e||null===(l=e.mobileNative)||void 0===l||l.recordPageVisit(i,{blockId:a,spaceId:n,visitedAt:r}));const c=await g.recordPageVisit(e,{block:{id:a,spaceId:n},timestamp:r});return c}(e,r,(0,l.C)(r.pointer.spaceId),h);if("skipped"===k.type)return;if("failed"===k.type)return;const I=_({pageVisits:k.data.pageVisits,omittedUserIds:[],currentState:c.state,block:r});c.state.pageId===r.id&&c.setState({...I,lastViewTime:S,lastExitTime:w})}async function y(e,t){await p.default.waitUntilRendered();const n=e.currentUser.id;if(void 0===n)return;const{block:o,pageVisitStore:i,incremental:a}=t,s=t.limit||h;let d;if(a){const{pageId:e,lastViewTime:t,lastExitTime:o,omittedUserIds:a,...s}=i.state,l=Object.entries(s).map((e=>{let[t,o]=e;if(n===t)return;const r=o.getVisitedAt();return void 0!==r?r+1:void 0}));d=r.Fp(l.filter(c.$K))}const u=await g.getPageVisitors(e,{block:{id:o.id,spaceId:(0,l.C)(o.pointer.spaceId)},sinceTimestamp:d,limit:s});if("failed"===u.type)return;const m=_({pageVisits:u.data.pageVisits,omittedUserIds:u.data.omittedUserIds,block:o,currentState:i.state});let f;if(Object.keys(m).length<=v)f=m;else{const{pageId:e,lastViewTime:t,lastExitTime:n,omittedUserIds:o,...i}=m,a=(0,c.qP)(i).map((e=>{let[t,n]=e;return[t,n.getVisitedAt()??0]}));f={pageId:e,omittedUserIds:o,lastViewTime:void 0,lastExitTime:void 0};const s=r.MR(a,(e=>{let[,t]=e;return-t})).slice(0,v);for(const[r]of s)f[r]=m[r]}i.state.pageId===m.pageId&&i.setState(f)}function _(e){const{block:t,pageVisits:n,currentState:o,omittedUserIds:r}=e,i={...o,pageId:t.id,omittedUserIds:[...o.omittedUserIds,...r]};for(const a of n){const{id:e,user_id:n}=a;n in i||(i[n]=f.t1.createChildStore(t,{table:s.UI,id:e,spaceId:(0,l.C)(t.pointer.spaceId)}))}return i}},19785:(e,t,n)=>{n.d(t,{SH:()=>m,hh:()=>c,hr:()=>u,jG:()=>p,nO:()=>d,rS:()=>f,zo:()=>l,zw:()=>s});n(21703);var o=n(45681),r=n(65598),i=n(9953),a=n(82530);const s=e=>{const{childStore:t,parentStore:n,transaction:o}=e,r=t.getRecordStoreAtRootPath().getValue(),i=n.getParentBlockStore();if(i&&i.isCollectionViewPageWithContent())return p({parentStore:i,childStore:t,transaction:o}),!0;if(r){const{parent_id:e,parent_table:i,alive:s}=r;if(e!==n.id||i!==n.table||!s)return a.applyOperation({store:n,operation:{pointer:t.pointer,path:[],command:"setParent",args:{parentId:n.id,parentTable:n.table}},transaction:o}),!0}return!1},l=e=>{const{block:t,transaction:n}=e,r=t.getParentStore();if(r){(0,o.A6)(r.table,t.table)?u({parentStore:r,childStore:t,transaction:n}):c({childStore:t,transaction:n})}},c=e=>{const{childStore:t,transaction:n}=e;if((0,r.OY)(t)){const e=t,o=e.getAssociatedCollectionStore();if(null!=o&&o.isPageTreeCollection()){const o=t.getParentBlockStore();o&&u({childStore:e,parentStore:o,transaction:n})}}t.getRecordStoreAtRootPath().getAlive()&&i.sW({store:t,data:{alive:!1},transaction:n})},d=e=>{const{pageStore:t,transaction:n}=e;t.getRecordStoreAtRootPath().getAlive()&&i.sW({store:t,data:{alive:!1},transaction:n})},u=e=>{const{childStore:t,parentStore:n,transaction:r}=e,i=(0,o.A6)(n.table,t.table);if(!i)throw new Error(`Could not find child path for parent table ${n.table} and child table ${t.table}`);a.applyOperation({store:n,operation:{pointer:n.pointer,path:i,command:"removeChild",args:{id:t.id}},transaction:r})},p=e=>{const{childStore:t,parentStore:n,transaction:r}=e,i=(0,o.A6)(n.table,t.table);if(!i)throw new Error(`Could not find child path for parent table ${n.table} and child table ${t.table}`);a.applyOperation({store:n,operation:{pointer:n.pointer,path:i,command:"insertChildrenAfter",args:{ids:[t.id],after:e.after}},transaction:r})},m=e=>{const{childStore:t,parentStore:n,transaction:r}=e,i=(0,o.A6)(n.table,t.table);if(!i)throw new Error(`Could not find child path for parent table ${n.table} and child table ${t.table}`);a.applyOperation({store:n,operation:{pointer:n.pointer,path:i,command:"insertChildrenBefore",args:{ids:[t.id],before:e.before}},transaction:r})},f=function(e){const{parentStore:t,oldChildStore:n,newChildStore:o,transaction:r}=e,i=n.id;(t.getValue()||[]).indexOf(i)>=0&&(p({parentStore:t,childStore:o,transaction:r,after:i}),u({parentStore:t,childStore:n,transaction:r}))}},19358:(e,t,n)=>{n.d(t,{D0:()=>h,If:()=>v,YM:()=>g});n(57658);var o=n(73360),r=n(18844),i=n(21202),a=n(6287),s=n(70279),l=n(91644),c=n(15047),d=n(77858),u=n(29369),p=n(66079),m=n(27105),f=n(9953);function g(e){const{childStore:t,parentStore:n,transaction:o}=e,r=t.getRecordStoreAtRootPath().getValue();if(r){const{parent_id:i,parent_table:a,alive:s}=r;i===n.id&&a===n.table&&s===e.alive||(f.sW({store:t,data:{parent_id:n.id,parent_table:n.table,alive:e.alive},transaction:o}),o.postPerformAssertions.push((()=>{(0,m.be)({parentStore:n,childStore:t})})))}}function h(e){if((0,o.hL)(e.childStore.table)){const t=e.childStore;return function(e){const{childStore:t,parentStore:n,transaction:o}=e,m=t.getRecordStoreUIParent();if(n.table===c.bx&&t.table===i.iU||n.table===u.e0&&t.table===i.iU||n.table===p.dx&&t.table===d.zU||n.table===r.Xj&&t.table===i.iU||n.table===l.AT&&t.table===i.iU)g({childStore:t,parentStore:n,alive:!0,transaction:o});else if(n.table===d.zU&&n.path&&"private_pages"===n.path[0]&&t.table===i.iU){const e=n.getRecordStoreUIParent().getSpaceStore();e&&g({childStore:t,parentStore:e,alive:!0,transaction:o})}else n.table===i.iU&&m&&m.table===d.zU&&m.path&&"private_pages"===m.path[0]?g({childStore:t,parentStore:n,alive:!0,transaction:o}):n.table!==i.iU&&n.table!==a.v&&n.table!==s.x_||g({childStore:t,parentStore:n,alive:!0,transaction:o})}({...e,childStore:t})}{const{childStore:t,parentStore:n,transaction:o}=e,{parent_id:r,parent_table:i}=t.getValue()||{};r===n.id&&i===n.table||f.sW({store:t,data:{parent_id:n.id,parent_table:n.table},transaction:o})}}function v(e){const{childStore:t,parentStore:n,transaction:o}=e,{parent_id:r,parent_table:i,alive:a}=t.getValue()||{},s=n.table===d.zU&&n.path&&"private_pages"===n.path[0]&&a,l=r===n.id&&i===n.table&&a;(s||l)&&f.sW({store:t,data:{alive:!1},transaction:o})}},99553:(e,t,n)=>{n.d(t,{Af:()=>M,E5:()=>A,ME:()=>E,Om:()=>B,Xd:()=>F,bA:()=>T,jG:()=>P,xv:()=>D});n(57658);var o=n(15145),r=n(89101),i=n(59183),a=n(10906),s=n(28020),l=n(84210),c=n(74948),d=n(38676),u=n(80444),p=n(22294),m=n(45325),f=n(88923),g=n(86486),h=n(27724),v=n(24666),b=n(36610),y=n(92973),_=n(94419),S=n(17659),w=n(32953),k=n(8055),I=n(82530),C=n(39865),x=n(37181);function T(e,t){const{mode:n}=t,o=e.WindowSizeStore.state.width,r=f.default.state.preferredSidePeekWidth||o/2;f.default.setState({...f.default.state,open:!0,preferredSidePeekWidth:Math.min(r,o/1.5),isOpening:!0,isClosing:!1,...t}),n===f.PeekModeSide&&c.toggleLeftSidebarByWindowSize(e),m.default.isOpen()&&S.qQ({environment:e,open:!1})}function M(e){const{resultsStore:t,collectionContextStore:n,pageVisitSource:o}=e;null==n||n.searchOpen.setState(!1),f.default.setState({...f.default.state,resultsStore:t,collectionContextStore:n,pageVisitSource:o})}function P(e){(f.default.isSidePeekOpen()||f.default.isCenterPeekOpen())&&R(e)}function A(e){f.default.isSidePeekOpen()&&R(e)}function R(e){s.kw.state&&!p.Z.state.isKeyboardMode||g.default.state.isOpen&&g.default.state.menuIsOpen||h.default.isSelected()||v.default.hasSelection()||D(e,"empty_space_click")}function D(e,t,n){const a=f.default.state;if(!a.open||a.isClosing)return;f.default.isSidePeekOpen()&&(f.default.setState({...a,isClosing:!0}),B({environment:e,seen:!0}));const{mode:s,target:c,showMoveTo:p,collectionContextStore:m,savedSelectionStoreState:g,savedTableSelectionStoreState:v,savedSidebarExpandedStoreState:S}=a,x=c.getContentStores(),T=1===x.length?x[0]:void 0,M=T&&T.isEmptyEditableBlock(),P=p&&c.isEmptyTitle()&&(c.isEmptyPage()||M);I.createAndCommit({userAction:"PeekRenderer.close",environment:e,perform:t=>{P?(C.y8({environment:e,blocks:[a.target],transaction:t}),t.postSubmitCallbacks.push((t=>{t||b.dh(e,{analyticsName:"delete",from:"peek_actions",block_id:c.id,block_type:"page"})}))):M&&_.Od({parent:c.getContentStore(),childToRemove:T,transaction:t})}}),t&&"side_peek"===s&&y.vc(e,{from:t}),y.$C(e,{peek_mode:s,from:t,target_page_id:c.id,target_parent_id:c.getParentId(),page_source:n,should_delete:P}),w.jC(e,s),w.LU(e),w.rM(e),h.default.setState({...h.default.state,...g}),v.isActive&&i.Z.setState(v),S&&d.sidebarExpandedStore.setState(!0);const{mainEditorCurrentBlockStore:A}=u.default.state,{RouterStore:R}=e,D=R.state.route;if(null!=m&&m.searchQuery.state&&(null==m||m.searchOpen.setState(!0)),A&&"page"===D.name){const t=(0,l.ZP)({store:A,fullyQualified:!1,scrollToBlockId:D.scrollToBlockId,collectionViewId:D.collectionViewId,discussionId:D.discussionId,showMoveTo:D.showMoveTo,saveParent:D.saveParent,pageVisitSource:o.tY.PeekClose});k.c4({environment:e,url:t})}else"chat"===D.name&&k.c4({environment:e,url:r._j.chat})}function E(){const e=f.default.state;e.open&&!e.isClosing&&f.default.setState({...e,open:!1,resultsStore:void 0,collectionContextStore:void 0})}function B(e){const{environment:t,seen:n}=e,{currentUserSettingsStore:o}=u.default.state;o&&I.createAndCommit({userAction:"peekActions.setSeenPeekModeIntroTooltip",environment:t,perform:e=>{x.d2({userSettingsStore:o,transaction:e,data:{seen_peek_mode_tooltip:n}})}})}function F(e){const{collectionContextStore:t,resultsStore:n}=e;(0,a.YG)(null==t?void 0:t.collectionViewStore())||M({collectionContextStore:t,resultsStore:n,pageVisitSource:void 0})}},76464:(e,t,n)=>{n.d(t,{GQ:()=>ce,Kh:()=>re,MX:()=>ne,Pk:()=>te,ep:()=>X,hs:()=>oe,n_:()=>se,u9:()=>ue});n(57658);var o=n(1302),r=n(66897),i=n(7406),a=n(59730),s=n(24211),l=n(72126),c=n(63306),d=n(87479),u=n(72141),p=n(4615),m=n(77420),f=n(84683),g=n(15047),h=n(29369),v=n(19889),b=n(94044),y=n(64684),_=n(97880),S=n(9291),w=n(15010),k=n(33954),I=n(33929),C=n(98165),x=n(46654),T=n(45101),M=n(65598),P=n(48779),A=n(95697),R=n(18245),D=n(28578),E=n(80444),B=n(81236),F=n(79797),O=n(34583),Z=n(88893),V=n(35057),U=n(88280),N=n(9867),L=n(36610),j=n(91219),z=n(91536),q=n(81918),H=n(17224),W=n(54642),K=n(47307),G=n(9953),$=n(29974),Q=n(82530);const Y=(0,S.defineMessages)({preventFullPageAccessDeletion:{id:"permissionsActions.preventRemovingAllFullAccess.message",defaultMessage:"Please give someone else Full Access before removing this permission."},preventUserOrGroupDeletion:{id:"permissionsActions.preventUserOrGroupDeletion.message",defaultMessage:"At least one person or group must have access."},confirmUpgradeMessage:{defaultMessage:"To add members to your workspace, you need to switch it to the Team plan. You will be charged a prorated amount based on your current billing interval and account balance.",id:"permissions.confirmDialog.upgradeToTeamWorkspace.message"},confirmUpgradeButtonLabel:{defaultMessage:"Upgrade to Team workspace",id:"permissions.confirmDialog.upgradeToTeamWorkspace.confirmButton.label"}});function X(e){const{environment:t,store:n,permissionItems:r,transaction:i,from:a,skipAnalytics:s,pagePermissionChangeLocation:c,fromPermissionWrapper:p}=e;if((0,x.SO)(e))return!1;if(!n.isDefined())return!1;const m=n.getPermissionItems();let f=[...m];const{id:h}=t.currentUser,v=n instanceof F.H2,b=n instanceof F.G&&n.getParentTable()===g.bx,S=n instanceof F.G&&(b||n.isRestricted());s||(n instanceof F.G?z.kM({environment:t,store:n,newItems:r,location:c,inSudoMode:i.useSudoMode,fromPermissionWrapper:p}):r.forEach((e=>{v?z.dE(t,e,{from:a}):n instanceof F.zX?z.gR(t,{item:e,teamStore:n}):(0,_.t1)(n)}))),f=f.filter((e=>!r.some((t=>d.Kf(e,t)))));for(const o of r)f.push(o);f=f.filter((e=>"none"!==u.cY(e)));const w=Boolean(r.find((e=>"user_permission"===e.type&&e.user_id===h&&!u.zz(e.role))));if(n instanceof F.G&&S&&h){const e=C.Pj(n),t=e?(0,P.jv)(e):[],o=e?e.getPermissionGroups():[],a=Boolean(f.find((e=>"user_permission"===e.type&&u.zz(e.role)&&e.user_id===h))),s=C.VP(n),l=null==s?void 0:s.getMembers(),c=void 0!==l&&(0,y.pd)({membership:l},h),d=e&&s&&(0,A.AL)({teamStore:s,spaceStore:e,userId:h}),p=t.find((e=>"user_permission"===e.type&&e.user_id===h)),m=r.find((e=>"space_permission"===e.type&&u.zz(e.role))),g=r.find((e=>"space_permission"===e.type&&u.YX(e.role))),v=r.find((e=>"space_permission"===e.type&&!u.YX(e.role))),b=f.find((e=>Boolean("group_permission"===e.type&&u.zz(e.role)&&o.find((t=>Boolean(t.id===e.group_id&&t.user_ids&&t.user_ids.indexOf(h)>=0)))))),_=(0,A.bq)();if(e&&e.canEdit()&&!_){const t=e.getPagesStore();g?Q.applyOperation({transaction:i,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{id:n.id}}}):v&&Q.applyOperation({transaction:i,store:t,operation:{pointer:t.pointer,path:t.path,command:"listRemove",args:{id:n.id}}})}if(!_&&a&&p&&(m||b)&&(f=f.filter((e=>!("user_permission"===e.type&&e.user_id===h)))),!w){f.some((e=>!("space_permission"!==e.type||!u.zz(e.role)||!p)||(!("user_permission"!==e.type||!u.zz(e.role)||e.user_id!==h)||(!("group_permission"!==e.type||!u.zz(e.role)||!o.find((t=>Boolean(t.id===e.group_id&&t.user_ids&&t.user_ids.indexOf(h)>=0))))||(!!((0,u.zU)(e)&&u.zz(e.role)&&(null==s?void 0:s.id)===e.team_id&&d)||!!((0,u.LW)(e)&&u.zz(e.role)&&(null==s?void 0:s.id)===e.team_id&&c))))))||i.useSudoMode||(f=f.filter((e=>!("user_permission"===e.type&&e.user_id===h))),f.push({type:"user_permission",user_id:h,role:"editor"}))}}if(!f.some((e=>{const t=u.cY(e);return u.zz(t)}))&&(v||S))return o.default.afterNextFlush((()=>{K.showErrorMessage(I.default.formatMessage(Y.preventFullPageAccessDeletion))})),!1;const k=f.some((e=>(u.jg(e)||u.hV(e))&&"editor"===e.role));if((0,A.bq)()&&b&&!k)return o.default.afterNextFlush((()=>{K.showErrorMessage(I.default.formatMessage(Y.preventUserOrGroupDeletion))})),!1;const T=(0,F.Vh)(n,n.pointer,"permissions"),M=[];for(const o of m){!f.find((e=>d.Kf(o,e)))&&u.C2(o)&&M.push({...o,role:"none"})}for(const o of f){const e=m.find((e=>d.Kf(o,e)));!u.C2(o)||e&&l.Xy(e,o)||M.push(o)}let D=[];const E=C.Om(n);if(n instanceof F.G&&!n.isRestricted()&&E&&E instanceof F.G){const e=(0,x.YO)(E);D=M.map((t=>e.find((e=>l.Xy(e.permissionItem,t)))?{...t,role:"none"}:t))}else D=M;for(const o of D)Q.applyOperation({store:T,operation:{pointer:T.pointer,command:"setPermissionItem",path:T.path,args:o},transaction:i});return i.postSubmitCallbacks.push((async n=>{z.NL(t,{status:Boolean(n)?"fail":"success",location:c}),n||await O.bi(t),e.metric&&R.default.measure(e.metric,{environment:t})})),!0}function J(e){var t;const{environment:n,store:o,permissionItems:r,transaction:i,inviteFlowId:a,inviteMessage:s,inviteOrigin:l,disable_invite_email:c}=e,d=null===(t=E.default.state.currentSpaceStore)||void 0===t?void 0:t.id,{id:u}=n.currentUser;for(const p of r)if(d&&"user_permission"===p.type&&p.invite_id){const{inviteeId:e,inviteeTable:t}=ee({item:p,spaceId:d}),n={id:p.invite_id,version:1,flow_id:a,space_id:d,target_id:o.id,target_table:o.table,inviter_id:u,inviter_table:v.KJ,invitee_id:e,invitee_table_or_group:t,message:s,created_time:Date.now(),attributes:{permission:p,origin_type:l,disable_invite_email:c}};G.sW({store:(0,F.Kv)(o,{table:"invite",id:n.id,spaceId:d}),data:n,transaction:i})}return i.postSubmitCallbacks.push((e=>{j.bR(n,{status:Boolean(e)?"fail":"success",origin:l})})),!0}function ee(e){const{item:t,spaceId:n}=e;return u.jg(t)?{inviteeId:t.user_id,inviteeTable:v.KJ}:u.FB(t)?{inviteeId:t.bot_id,inviteeTable:m.cZ}:u.hV(t)?{inviteeId:t.group_id,inviteeTable:f._e}:u.ix(t)?{inviteeId:n,inviteeTable:g.bx}:u.zU(t)?{inviteeId:t.team_id,inviteeTable:h.e0}:{}}function te(e){const{environment:t,store:n,permissionItem:o,transaction:i,shouldInherit:a,fromPermissionWrapper:s}=e;if(!n.isDefined())return;const l=[];if(a){const e=(0,x.YO)(n).map((e=>e.permissionItem)).filter((e=>!d.Kf(e,o)));for(const t of e)u.C2(t)&&(n.isCollectionView()||!u.WY(t.role)||u.FB(t)?l.push(t):l.push({...t,role:"read_and_write"}))}const p=t.currentUser.id,m=p?n.getRecordValue({table:v.KJ,id:p}):void 0,f=m&&(0,r.dp)(m),g=c.DW(n.pointer,n.getRecordModel);!p||d.ZO({actor:f,ancestors:g,updatedPermissionItem:o})||i.useSudoMode||l.push({type:"user_permission",user_id:p,role:"editor"}),l.push(o);const h=n.getPermissionItemsStore();z.kM({environment:t,store:n,newItems:[o],fromPermissionWrapper:s});for(const r of l)Q.applyOperation({store:h,operation:{pointer:h.pointer,command:"setPermissionItem",path:h.path,args:r},transaction:i});Q.applyOperation({store:h,operation:{pointer:h.pointer,command:"setSingletonPermissionItem",path:h.path,args:{singletonPermissionItem:{type:"restricted_permission"},set:!0}},transaction:i}),L.gl(t,{type:"none"===o.role?"remove":"narrow"}),i.postSubmitCallbacks.push((e=>{e||O.bi(t)}))}function ne(e){const{environment:t,store:n,transaction:o}=e;if(!n.isDefined())return;const r=n.getPermissionItems(),i=C.Om(n),a=i?d.Wo(C.fJ(i)):[],s=d.Ub(n.getModel(),r,a),l=n.getPermissionItemsStore();for(const c of s)Q.applyOperation({store:l,operation:c,transaction:o});L.TJ(t,{using_admin_api:!1}),o.postSubmitCallbacks.push((e=>{e||O.bi(t)}))}async function oe(e){const{environment:t,store:n}=e,{currentSpaceStore:o}=E.default.state;if(o){const e=o.id,r=n.id,i=await W.spaceAdminRestoreAccess(t,{spaceId:e,blockId:r});L.TJ(t,{using_admin_api:!0}),"failed"===i.type&&K.showError(i)}}function re(e){const{environment:t,store:n,transaction:o}=e,r=n.getPermissionItems();if(!n.isTopLevelTeamPage()||0===r.length)return;const i=r.filter((e=>u.FB(e)));G.sW({store:n,transaction:o,data:{permissions:i}}),H.FN(t,{store:C.VP(n)})}function ie(e){const t=e.inviteTargets[0];return!(!t||"bot"!==t.type)}function ae(e){return u.jg(e.permissionItem)&&(0,T.OA)(e.inviteTarget)}async function se(e){const{environment:t,isOnboarding:n,invite:o}=e;if(0===e.inviteTargets.length)return{success:!0,invitedUsers:{},requestedUsers:{}};const r=U.subscriptionDataStoreInstance.state,a=(0,Z.qX)();let s;if(ie(e))if((0,M.Mm)(e.store)){const t=e.inviteRole;s=e.inviteTargets.map((e=>({inviteTarget:e,permissionItem:{type:"bot_permission",role:t,bot_id:e.value.id}})))}else(0,M.OY)(e.store)?s=e.inviteTargets.map((e=>({inviteTarget:e,permissionItem:{type:"bot_permission",role:d.uH(e.value.capabilities),bot_id:e.value.id,parent_table:e.value.parent_table,parent_id:e.value.parent_id}}))):(0,_.t1)(e.store);else s=await async function(e){const{environment:t,inviteTargets:n,inviteRole:o}=e;return Promise.all(n.map((async n=>{if("newUser"===n.type){const e=await le(t,n),r={type:"user_permission",role:o,user_id:e};return{inviteTarget:{...n,value:{...n.value,id:e}},permissionItem:r}}if("existingUser"===n.type){return{inviteTarget:n,permissionItem:{type:"user_permission",role:e.inviteRole,user_id:n.value.id}}}if("group"===n.type){return{inviteTarget:n,permissionItem:{type:"group_permission",role:e.inviteRole,group_id:n.value.id}}}(0,_.t1)(n)})))}({environment:t,inviteTargets:e.inviteTargets,inviteRole:e.inviteRole,data:r});const{toInvite:l,toRequest:c}=function(e,t){if(!((0,P.Q6)(E.default.state.currentSpaceStore)&&e instanceof F.G))return{toInvite:t,toRequest:[]};const n=[],o=[];for(const r of t)ae(r)?n.push(r):o.push(r);return{toInvite:o,toRequest:n}}(e.store,s),m={};if(e.store instanceof F.G&&c.length>0){const n=await async function(e){const{environment:t,permissionItems:n,inviteMessage:o,store:r}=e,i=await Promise.allSettled(n.map((async e=>W.requestAccess(t,{type:"guest-invite-request",block:{id:r.id,spaceId:r.getSpaceId()},forActorId:e.user_id,message:void 0,attributes:{role:e.role,inviteMessage:o}}))));return!i.find((e=>"rejected"===e.status||"fulfilled"===e.status&&"failed"===e.value.type))}({environment:t,store:e.store,permissionItems:c.map((e=>e.permissionItem)),inviteMessage:o.inviteMessage});if(!n)return{success:!1};for(const e of c)m[e.inviteTarget.value.email]=e.permissionItem.user_id}if(0===l.length)return{success:!0,invitedUsers:{},requestedUsers:m};const f=l.map((e=>e.inviteTarget)),g=l.map((e=>e.permissionItem));let h,v;if(e.store instanceof F.G&&void 0!==(0,V.c4)(r))h=await async function(e){const{environment:t,store:n,permissionItems:o,invite:r}=e,i=n.getSpaceId();if(!i)return!1;const a=B.Z.getPublicSpaceData(t,i);if(!a)return!1;const s=o.filter(u.jg).map((e=>({...e,invite_id:(0,p.ZP)()}))),l=await W.inviteGuestsToSpace(t,{block:{id:n.id,spaceId:i},permissionItems:s});if("failed"===l.type)return!1;const{serverCommitResult:c}=Q.createAndCommit({userAction:"permissionsActions.saveInvites",environment:t,perform:e=>{const{inviteFlowId:o,inviteMessage:i,inviteOrigin:a,disable_invite_email:l}=r;J({environment:t,store:n,permissionItems:s,transaction:e,inviteFlowId:o,inviteMessage:(0,b.my)(i),inviteOrigin:a,disable_invite_email:l})}});await c;const d=o.filter(u.FB);d.length>0&&await de({environment:t,store:n,permissionItems:d,invite:r});return!0}({environment:t,store:e.store,permissionItems:g,invite:o});else try{await de({environment:t,store:e.store,sudoModeStore:e.sudoModeStore,permissionItems:g,invite:o}),h=!0}catch(C){h=!1,v=(0,i.tg)(C)}var y,S;ie(e)||(h?j.jB(t,{role:e.inviteRole,is_space:e.store instanceof F.H2,invite_targets:f,is_onboarding:e.isOnboarding,invite_origin:o.inviteOrigin,permission_items:g,invite_message_length:(null===(y=o.inviteMessage)||void 0===y?void 0:y.length)??0,invite_flow_id:o.inviteFlowId,isProfessionalTeamUser:(0,w.QZ)(),domainType:(0,w.JF)(),share_menu_session_id:D.ZP.state.sessionId}):j.l5(t,{error:v,role:e.inviteRole,is_space:e.store instanceof F.H2,invite_targets:f,is_onboarding:e.isOnboarding,invite_origin:o.inviteOrigin,permission_items:g,invite_message_length:(null===(S=o.inviteMessage)||void 0===S?void 0:S.length)??0,invite_flow_id:o.inviteFlowId,isProfessionalTeamUser:(0,w.QZ)(),domainType:(0,w.JF)(),share_menu_session_id:D.ZP.state.sessionId}));n||await O.bi(t);const k={};f.forEach(((e,t)=>{var n;const o=g[t];"newUser"!==e.type&&"existingUser"!==e.type||null===(n=e.value)||void 0===n||!n.email||"user_permission"!==o.type||(k[e.value.email]=o.user_id)}));const I=1===a&&(0,Z.qX)()>1;return(0,V.QM)()&&I&&($.sw(t),$.Yj(t)),{success:h,error:v,invitedUsers:k,requestedUsers:m}}async function le(e,t){const n=(0,s.E2)(I.default.getIntl()),o=t.value.email,r=await W.createEmailUser(e,{email:o,preferredLocaleOrigin:"inferred_from_inviter",preferredLocale:n});if("failed"===r.type){if((0,a.Jx)(r.error)){const e=(0,k.nX)(I.default.getIntl(),r.error);e?K.showErrorMessage(e):K.deprecatedShowErrorMessage(r.error.message)}else K.deprecatedShowErrorMessage(r.error.message);throw r.error}return r.data.userId}async function ce(e){let{environment:t,store:n,inviteTargets:o,inviteRole:r,createNewTeamFlowId:i}=e;const a=n.getSpaceId(),s=t.currentUser.id;if(0===o.length)return!0;if(!a||!s)return!1;const l=U.subscriptionDataStoreInstance.state,{teamMemberInfos:c,invitedMemberIds:d}=await async function(e){const{environment:t,inviteTargets:n,inviteRole:o}=e,r=[],i=[];for(const a of n){let e;if("newUser"===a.type){const n=await le(t,a);e={entity_type:"user",type:o,user_id:n},r.push(n)}else"existingUser"===a.type?(e={entity_type:"user",type:o,user_id:a.value.id},"none"!==a.spaceRole&&"not_in_space"!==a.spaceRole||r.push(a.value.id)):"group"===a.type?e={entity_type:"group",type:"member",group_id:a.value.id}:(0,_.t1)(a);i.push(e)}return{teamMemberInfos:i,invitedMemberIds:r}}({environment:t,inviteTargets:o,inviteRole:r,data:l}),u=await N.Uj({environment:t,teamMemberInfos:c,teamStore:n,isSettingDefaultTeam:!1,createNewTeamFlowId:i});return u&&(q.Jk(t,{invite_origin:"team_invite_overlay",domainType:(0,w.JF)(),new_workspace_member_count:d.length,new_workspace_member_ids:d}),await O.bi(t)),u}async function de(e){const{environment:t,store:n,sudoModeStore:o,permissionItems:r,invite:i}=e,{serverCommitResult:a}=Q.createAndCommit({userAction:"permissionsActions.savePermissionItems",environment:t,useSudoMode:"block"===n.table&&(null==o?void 0:o.shouldSaveTransactionWithSudoMode(n)),perform:e=>{const o=r.map((e=>"user_permission"!==e.type?e:{...e,invite_id:(0,p.ZP)()})),{inviteFlowId:a,inviteMessage:s,inviteOrigin:l,disable_invite_email:c}=i;J({environment:t,store:n,permissionItems:o,transaction:e,inviteFlowId:a,inviteMessage:(0,b.my)(s),inviteOrigin:l,disable_invite_email:c}),X({environment:t,store:n,permissionItems:o,transaction:e,from:l})}});await a}const ue=function(e){const{store:t,transaction:n}=e;G.sW({store:t,data:{permissions:null},transaction:n})}},9700:(e,t,n)=>{n.d(t,{m:()=>m});var o=n(87078),r=n(4023),i=n(15723),a=n(60709);const{Top:s,Bottom:l,Left:c,Right:d}=r.u,{Start:u,Center:p}=r.v,m=function(e){const{store:t,placementToOrigin:n,alignmentToOrigin:r,popupRect:u,originRect:p,viewportPadding:m,placementFlipped:g,viewportAdditionalBottomPadding:h}=e,v=(0,o.Z)();let b=i.jn(v,-m||0);0!==h&&(b=new i.iL(b.x,b.y,b.width,b.height-h));const y=f(u,p,n,r),_=Math.max(b.left-y.left,0)+Math.min(b.right-y.right,0),S=Math.max(b.top-y.top,0)+Math.min(b.bottom-y.bottom,0),w=n===c&&Math.abs(_)>0&&i.TF(b,f(u,p,(0,a.FJ)(n),r)),k=n===d&&Math.abs(_)>0&&i.TF(b,f(u,p,(0,a.FJ)(n),r)),I=n===s&&Math.abs(S)>0&&i.kL(b,f(u,p,(0,a.FJ)(n),r)),C=n===l&&Math.abs(S)>0&&i.kL(b,f(u,p,(0,a.FJ)(n),r)),x={placementFlipped:!1,offsetX:0,offsetY:0};x.placementFlipped=g||w||k||I||C,(!x.placementFlipped||n!==c&&n!==d)&&(x.offsetX=Math.round(_)),(!x.placementFlipped||n!==s&&n!==l)&&(x.offsetY=Math.round(S)),t.setState({...t.state,...x})},f=function(e,t,n,o){if(n===s||n===l){let r,i;return r=o===u?t.left:o===p?t.left+t.width/2-e.width/2:t.right-e.width,i=n===s?t.top-e.height:t.bottom,new DOMRect(r,i,e.width,e.height)}{let r,i;return r=o===u?t.top:o===p?t.top+t.height/2-e.height/2:t.bottom-e.height,i=n===c?t.left-e.width:t.right,new DOMRect(i,r,e.width,e.height)}}},31304:(e,t,n)=>{n.d(t,{E:()=>w,_:()=>k});var o=n(18466),r=n(68626),i=n(72126),a=n(91155),s=n(75189),l=n(44615),c=n(63143),d=n(36054),u=n(41641),p=n(95477),m=n(2688),f=n(85844),g=n(79797),h=n(27724),v=n(24666),b=n(73661);const y=1e3,_=1*c.U6,S="presenceActions";function w(e,t,n,o){!function(e,t){const{persistAutoListener:n,rootStore:o,isActive:i,listenerReference:s,userId:c}=e.state;if(i){if(n&&n.destroy(),s&&m.ZP.removeListener(s,t),c&&o&&x({userId:c,rootStore:o})){const e=(0,l.T0)(o.id);m.ZP.updateField(e,c,{present:!1},_,t),m.ZP.clearOnDisconnect(e,S,t).catch((e=>{r.log({level:"error",from:"destroyPresence",type:"SystemError",error:(0,a.Ui)(e)})}))}e.reset()}}(e,t),o&&b.P(o,t,n)}async function k(e){const{userId:t,rootStore:n,presenceStore:r,environment:a,pageVisitIdStore:c}=e;if(await n.load(),C({userId:t,rootStore:n})){r.setState({...r.state,isActive:!0,rootStore:n,userId:t});const e=i.P2((()=>{r&&r.state.isActive&&r.state.rootStore===n&&I(r,a)}),y),u=(e,t)=>{r&&r.state.isActive&&r.state.rootStore===n&&function(e,t){const{remotePresenceData:n}=t.state,o=e||{};i.Xy(n,o)||t.setState({...t.state,remotePresenceData:o})}(function(e){const t={};if(i.Kn(e)){const n=Object.keys(e);for(const o of n){const n=e[o];n&&!(0,d.Gu)(s.uP,n)&&(t[o]=n)}}return t}(t),r)},p=(0,l.T0)(n.id),f=m.ZP.addListener(p,u,void 0,a);r.setState({...r.state,persistAutoListener:new o.Z({onChange:e}),listenerReference:f}),t&&x({userId:t,rootStore:n})&&await m.ZP.onDisconnect(p,[{operation:"updateField",key:p,field:t,updates:{present:!1},ttl:_},{operation:"logPageExit",userId:t,blockId:n.id,spaceId:n.getSpaceId(),pageVisitId:c.getCurrentPageVisitId()}],S,a),I(r,a)}}function I(e,t){const{persistAutoListener:n,rootStore:o,userId:r}=e.state;if(n&&n.startListener({incrementCycle:!0}),!o||!x({userId:r,rootStore:o}))return;let i;if(r&&o.canEdit()){var a,s;let e;const t=h.default.state;t.stores.length&&(e=t.stores[0]);const n=v.default.state,l="editing"===n.mode&&n.multiSelection;l&&o.uiContains(l.start.store)&&"block"===l.start.store.table&&(e=l.start.store),e||t.pivot&&(e=t.pivot);const d=null===(a=e)||void 0===a?void 0:a.findRecordStoreUIAncestors((e=>e instanceof g.G)).map((e=>e.id)),u=c.ud(Date.now());i={userId:r,present:f.Z.state.isVisible,activityTimestampNearestMinuteMs:u,blockId:(null===(s=e)||void 0===s?void 0:s.id)||null,blockPath:d||null}}if(n&&n.stopListener({isEndOfCycle:!0}),i){const e=(0,l.T0)(o.id);r&&m.ZP.updateField(e,r,i,_,t)}}function C(e){const{userId:t,rootStore:n}=e;return Boolean(n)&&(0,u.Z)(n.id)&&n.canEdit()&&t}function x(e){const{userId:t,rootStore:n}=e;return C({userId:t,rootStore:n})&&!p.default.isAdminMode}},40277:(e,t,n)=>{n.d(t,{th:()=>D,Jv:()=>M,I6:()=>P,Hr:()=>R});n(21703),n(57658);var o=n(7406),r=n(68626),i=n(15157),a=n(91155),s=n(63306),l=n(66897),c=n(33728),d=n(72126),u=n(59753),p=n(87479),m=n(72141),f=n(21202),g=n(6287),h=n(15047);function v(e,t,n){return!!b(e,t)||!!(t&&(0,l.pu)(t)&&n)}function b(e,t){if(!t)return!1;if(!t.isUser())return!1;let n=!1;const o=e.getEmailDomains()||[],r=e.getPermissionItems()||[];if(t&&t.email&&o){const e=(0,c.Gd)(t.email);n=d.q9(o,e)}return r.find((e=>"user_permission"===e.type&&e.user_id===t.id))&&(n=!0),n}function y(e){const{block:t,space:n,viewer:o}=e;if(!t)return;if(!b(n,o))return;const r=t.getPermissionItems().filter((e=>"user_permission"===e.type&&(0,m.zz)(e.role))).map((e=>e.user_id));if(0===r.length)return;const i=n.getUserPermissionItems();return r.find((e=>(0,p.GU)({spacePermissions:i,userId:e})))}var _=n(73360),S=n(19889),w=n(33929),k=n(45950),I=n(5659),C=n(77080),x=n(54642);const T="publicAccessPageId";async function*M(e){const{environment:t,request:n}=e;if("block-space"===n.type){const e=await I.A.measure("loadPublicPageData",`block:${n.blockId} space:${n.spaceId}`,(()=>A(t,n)));"value"in e&&(yield e.value)}const o=await x.getPublicPageData(t,n);"success"===o.type?yield o.data:(r.log({level:"error",from:"publicPageDataActions",type:"loadPublicPageData",error:(0,a.Ui)(o.error)}),yield)}async function*P(e){const{environment:t,request:n}=e;if("block-space"===n.type){const e=await I.A.measure("loadPublicPageData",`block:${n.blockId} space:${n.spaceId}`,(()=>A(t,n)));"value"in e&&(yield e.value)}const o=await x.getPublicPageData(t,n);if("success"!==o.type)throw r.log({level:"error",from:"publicPageDataActions",type:"loadPublicPageDataUnsafely",error:(0,a.Ui)(o.error)}),o.error;yield o.data}async function A(e,t){if("block-space"!==t.type)return{error:Error("Shouldn't be looking for a non-block-space page")};const{blockId:n}=t,{id:r}=e.currentUser;if(n&&r){let t,a,l,c;try{const o=await k.yY({environment:e,recordPointers:[{table:f.iU,id:n},{table:S.KJ,id:r}],recurFn:e=>{const o=[];return e.table===f.iU&&e.id===n&&(t=e),e.table===h.bx&&(a=e),e.table===g.v&&t&&t.parent_id===e.id&&(l=e),e.table===S.KJ&&(c=e),(0,_.tz)(e)&&o.push(e.getParentPointer()),o},recordIsRequired:()=>!0});if(t&&a&&c){const e=s.om({table:f.iU,id:n},o),r=c,i=Boolean(s.YL(e,r)),d=s.YP(e),p=function(e){window.__c={n:"getPublicPageData"};const{spaceDomain:t,actor:n,userHasExplicitAccess:o,intl:r,requireInterstitial:i,requireLogin:a,publicAccessRole:s,publicHomePage:l,template:c,securitySettings:d}=e,p=u.kk.fromValue(f.iU,e.block),m=u.kk.fromValue(h.bx,e.space),_=u.kk.fromValue(g.v,e.associatedCollectionValue),S="none"!==s,w=b(m,n),k=_&&(o||S)?_.getNormalizedSchema():void 0,I=_&&(o||S)?_.id:void 0,C=_&&(o||S)?_.getFormat():void 0;return{pageId:null==p?void 0:p.id,spaceName:m.name||r.formatMessage({id:"publicPageDataHelpers.untitledWorkspace.placeholder",defaultMessage:"Untitled Workspace"}),spaceId:m.id,spaceDomain:t,canJoinSpace:w,icon:m.icon,userHasExplicitAccess:o,ownerUserId:y({block:p,space:m,viewer:n}),collectionId:I,collectionSchema:k,collectionFormat:C,betaEnabled:m.beta_enabled,canRequestAccess:v(m,n,e.publicAccessRequestExpEnabled),requireInterstitial:i,requireLogin:Boolean(a),publicAccessRole:s,publicHomePage:l,securitySettings:d,template:c}}({block:t,space:a,spaceDomain:void 0,associatedCollectionValue:l,actor:r,userHasExplicitAccess:i,intl:w.default.getIntl(),requireInterstitial:void 0,publicAccessRole:d,securitySettings:void 0,publicHomePage:void 0,template:void 0,publicAccessRequestExpEnabled:C.default.checkGate("allow_public_page_access_request")});return{value:p}}}catch(i){return{error:(0,o.tg)(i)}}}return{error:Error("No offline public page data found.")}}function R(e){let{currentUserId:t,blockId:n}=e;i.Z.set({userId:t,key:T,value:n})}function D(e){return i.Z.get({userId:e,key:T})}},68305:(e,t,n)=>{n.d(t,{tA:()=>S});n(21703);var o=n(43690),r=n(42875),i=n(606),a=n(149),s=n(21202),l=n(97880),c=n(28020),d=n(33929),u=n(80444),p=n(77080),m=n(37598),f=n(79797),g=n(54642);const h=1e3;class v extends Error{constructor(e,t){super(t),this.type=e}}class b extends v{constructor(){super("query_collection_limit_outside_range",`Query collection limit must be between 0 and ${h}`)}}class y extends v{constructor(e){super("query_collection_failed",`Query collection failed: ${e.reason}`),this.data=e}}class _ extends v{constructor(){super("query_collection_too_many_items","Query collection updating too many items")}}async function S(e,t){const{source:n,parentRecordStore:v,collectionPointer:S,filter:w,sort:k,limit:I,vectorSearch:C}=t,x=I??h;if(x<0||x>h)return{error:new b};const T=f.NW.createChildStore(v,S);await T.load();const M=T.getModel();if(!M)return{error:new y({reason:"no collection value"})};const P=T.getParentBlockStore();if(!P)return{error:new y({reason:"no collection parent"})};await P.load();const A=P.getCollectionViewStores()[0],R=A.getSpaceId();if(!A||!R)return{error:new y({reason:"no first collection view"})};const D="results",E={[D]:{type:"results",limit:x}},B=Object.keys(t.aggregations??{});for(const o of B){var F;if(o===D)return{error:new y({reason:`${D} is a reserved reducer keyword.`})};const e=null===(F=t.aggregations)||void 0===F?void 0:F[o];if(!e)return{error:new y({reason:`no aggregation provided for ${o}.`})};e&&(E[o]={type:"aggregation",aggregation:e})}const O=T.getSchema(),Z={filter:w&&o.Ih(w,O),sort:k&&o.zh(k,O),userId:e.currentUser.id,userTimeZone:(0,r.r)(),searchQuery:void 0,vectorSearch:C,reducers:E},V=await g.queryCollection(e,{source:{type:"collection",id:S.id,spaceId:S.spaceId},collectionView:{id:A.id,spaceId:R},loader:Z},void 0,{src:n});if("failed"===V.type)return{error:new y({reason:"server query failed",cause:V.error})};const U=V.data.result.reducerResults[D];if(!U||"results"!==U.type)return{error:new y({reason:"unexpected server result"})};if(U.blockIds.length===h&&U.hasMore)return{error:new _};const{groupsReducerIds:N,reducerIdsWithNoGroupDependencies:L}=o.x3(Z.reducers,Z.reducerDependencies),j=p.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs"),z=p.default.checkGate("better_database_text_sorts"),q=Date.now(),H={pageSort:[],schema:O,loader:Z,userId:e.currentUser.id,userStartOfWeek:c.AK.state,currentTime:q,getRecordModel:u.default.getCurrentBlockModelFn(),intl:d.default.getIntl(),isSorted:!1,visibleProperties:void 0,relativeVariableResult:null==V?void 0:V.data.relativeVariableResult,isSprintPlanningView:!1,collectionSourceType:"collection",groupsReducerIds:N,reducerIdsWithNoGroupDependencies:L,formulaTimeoutMs:j,resultCache:new Map,useImprovedSort:z},W=o.fk(H);for(const r of U.blockIds){var K;const e=f.G.createChildStore(v,{table:s.iU,id:r}),t=null===(K=e.getAssociatedCollectionStore())||void 0===K?void 0:K.pointer;if(!(t&&i.dr.isEqualIdTable(t,T.pointer)))continue;const n=v.getRecordModel(e);n&&o.BW(n,M,H,W)}const G=m.Z.getEditedBlocksForCollection(M.id),$=new Set(U.blockIds);for(const r of G){if($.has(r))continue;const e=v.getRecordModel({table:s.iU,id:r});e&&o.BW(e,M,H,W)}const{result:Q}=o.kk(H,W),Y=o.aW({result:Q}),X={};for(const r of B){var J;const e=o.Oi({expectedAggregator:null===(J=t.aggregations)||void 0===J||null===(J=J[r])||void 0===J?void 0:J.aggregator,aggregationReducerResult:V.data.result.reducerResults[r]});if(a.x.isFail(e)){const t="no aggregation provided"===e.error?`no aggregation provided for ${r}`:"unexpected response returned for aggregation"===e.error?`unexpected response returned for aggregation ${r}`:(0,l.t1)(e.error);return{error:new y({reason:t})}}X[r]=e.value}return{value:{blockIds:Y,...X}}}},9953:(e,t,n)=>{n.d(t,{Ue:()=>b,ae:()=>m,j4:()=>f,nj:()=>v,sO:()=>g,sW:()=>h});n(57658);var o=n(97531),r=n(59730),i=n(59753),a=n(4615),s=n(73360),l=n(606),c=n(21202),d=n(79797),u=n(82530),p=n(1742);function m(e){const{environment:t,table:n,value:o,transaction:r,inMemoryRecordCache:i}=e;o.id||(o.id=(0,a.ZP)());const c=o,p=s.mk.create(n,c),m=l.dr.fromRecordWithTable(p),f=d.t1.createUniqueRootStore(t,m,{userId:r.userId,inMemoryRecordCache:i});return u.applyOperation({store:f,operation:{pointer:f.pointer,path:[],command:"set",args:o},transaction:r}),f}function f(e){var t;const{environment:n,type:i,properties:s,permissions:l,transaction:m,inMemoryRecordCache:f,useCrdt:h}=e;let v=e.tracker;const b=e.id||(0,a.ZP)(),y=e.format||h?{...e.format??{},...h?o.K$(b,null==s?void 0:s.title):{}}:void 0,_=e.spaceId||m.spaceId,S=new d.G(n,{table:c.iU,id:b,spaceId:_},{userId:m.userId,inMemoryRecordCache:f});if(!v&&!m.getUserFlowForAnalyticsPurposesOnly()){const e="page"===i?"user_flow_create_page":"user_flow_create_block";v=new p.BW({environment:n,entryPointName:"recordActions.createBlock",userFlow:e,succeedOnEnqueue:!0})}return null===(t=v)||void 0===t||t.track(S.pointer,m),g({store:S,transaction:m,value:o.j1({type:i,permissions:l,properties:s,format:y,space_id:_})}),u.updateMetadataForTransaction({environment:n,transaction:m}),m.postPerformAssertions.push((function(){if(m.isLocal)return;if(!S.getParentStore())throw new r.p8(`Created block was not given a parent before being committed in transaction ${m.getUserActionForAnalyticsPurposesOnly()}`)})),S}const g=function(e){const{store:t,value:n,transaction:o}=e,r=t.path;u.applyOperation({store:t,operation:{pointer:t.pointer,path:r,command:"set",args:n||null},transaction:o})};function h(e){const{store:t,data:n,transaction:o}=e,r=t.path;u.applyOperation({store:t,operation:{pointer:t.pointer,path:r,command:"update",args:n},transaction:o})}function v(e){const{store:t,source:n,fileIds:o,transaction:r}=e,i=t.path;for(const a of o)u.applyOperation({store:t,operation:{pointer:t.pointer,path:i,command:"copyFile",args:{source:n,fileId:a}},transaction:r})}function b(e){let{environment:t,table:n,args:o,transaction:r,inMemoryRecordCache:a}=e;const s=i.vk[n],{model:l,operation:c}=s.create(o),p=d.t1.createUniqueRootStore(t,l.pointer,{userId:r.userId,inMemoryRecordCache:a});return u.applyOperation({store:p,operation:c,transaction:r}),p}},4408:(e,t,n)=>{n.d(t,{HB:()=>fe,LK:()=>he,Wl:()=>ue,bG:()=>me,fL:()=>pe,uo:()=>ge});var o=n(59753),r=n(72141),i=n(29477),a=n(54368),s=n(51650),l=n(8542),c=n(10188),d=n(98963),u=n(18844),p=n(21202),m=n(6359),f=n(44312),g=n(19639),h=n(32161),v=n(82447),b=n(49953),y=n(14710),_=n(66726),S=n(30754),w=n(84683),k=n(11318),I=n(94578),C=n(80396),x=n(24836),T=n(86135),M=n(84323),P=n(1311),A=n(83200),R=n(67627),D=n(65963),E=n(14130),B=n(34406),F=n(42314),O=n(16663),Z=n(19221),V=n(93646),U=n(91644),N=n(15047),L=n(96740),j=n(75990),z=n(57829),q=n(56877),H=n(47238),W=n(35623),K=n(77858),G=n(26195),$=n(14718),Q=n(14327),Y=n(71495),X=n(53412),J=n(24494),ee=n(19889),te=n(98897),ne=n(66079),oe=n(58161),re=n(28182),ie=n(35794),ae=n(70203),se=n(44133),le=n(84709),ce=n(53730),de=n(54642);function ue(e){const{environment:t,pointer:n,userId:o,inMemoryRecordCache:i,model:a,role:s,force:l,maybeStaleRecordMap:c,updatePaths:d,debugSource:u}=e;"block"===n.table&&(0,se.setBlockIdDebugSource)(n.id,u);const m=o||t.currentUser.id,f=null==a?void 0:a.getVersion(),g=i.getRole({pointer:n,userId:m}),h=i.getVersion({pointer:n,userId:m}),v="number"==typeof f&&f>h;if(!(l||v||void 0!==s&&g!==s))return;let b=a;if(!l&&!v&&function(e){const{oldRole:t,newRole:n}=e;if(!r.YX(n))return!1;if(t&&!r.J5(t))return!1;return!0}({oldRole:g,newRole:s})){const e=i.getRecordModel({pointer:n,userId:m});e&&(b=e)}i.setModelAndRole({pointer:n,userId:m},b,s);for(const r of d)i.emitRecord(n,r);if(b){const e=b.__IM_SORRY__getValue();if(n.table===p.iU&&e){const t=e;t.properties&&t.properties.title&&(t.properties.title=t.properties.title.map((e=>ae.Y_F(e))))}const o=t.defaultRecordCache.persistedRecordCache;if(o&&be[n.table]){const i=function(e){const{environment:t,pointer:n,model:o,role:i}=e,{id:a}=t.currentUser,s=n.table===ee.KJ||n.table===ne.dx||n.table===re.Sr;if(s&&a===n.id)return ve.LoggedInUser;if((null==o?void 0:o.table)===K.zU&&o.parent_id===a)return ve.JoinedSpace;if(n.table===N.bx&&(0,r.Jy)(i))return ve.JoinedSpace;return}({environment:t,pointer:n,model:b,role:s}),a={value:e,role:s};o.set(n,a,i,m,c)}}i===t.defaultRecordCache.inMemoryRecordCache&&le.unsubscribeAfterDelay({pointer:n,userId:m,environment:t})}function pe(e){const{environment:t,userId:n,recordMap:r,inMemoryRecordCache:a,force:s,maybeStaleRecordMap:l,debugSource:c}=e,d=t.defaultRecordCache.persistedRecordCache;(0,i.Lc)(r,100,(async e=>{let{pointer:r,model:i,role:u}=e,p=i,m=u;if(ce.transactionQueue.isPendingTransactionForRecord(r)&&d){const e=await d.get(r,n||t.currentUser.id);e&&(p=o.kk.fromValue(r.table,e.value),m=u)}ue({environment:t,inMemoryRecordCache:a,pointer:r,userId:n,model:p,role:m,updatePaths:[[]],force:s,maybeStaleRecordMap:l,debugSource:c})}))}async function me(e){const{inMemoryRecordCache:t,pointer:n,userId:r,environment:i,minimumVersion:a}=e,s=ce.transactionQueue.isPendingTransactionForRecord(n),l=i.defaultRecordCache.persistedRecordCache;if(s)return l&&await l.get(n,r);let c,d;l&&(c=await l.get(n,r),c&&ue({environment:i,inMemoryRecordCache:t,pointer:n,userId:r,model:o.kk.fromValue(n.table,c.value),role:c.role,updatePaths:[[]],debugSource:"refreshAndReturnRecord (localResult)"}));try{const e=t.getEntry({pointer:n,userId:r}),s=e?e.value:void 0,l=e?e.pointer:void 0;if(a&&null!=s&&s.value&&(null==s?void 0:s.value.version)>=a)return s;d=await de.syncRecordValue(i,{userId:r,version:s&&s.value&&s.value.version?s.value.version:-1,pointer:l||n}),d&&ue({environment:i,inMemoryRecordCache:t,pointer:n,userId:r,model:o.kk.fromValue(n.table,d.value),role:d.role,updatePaths:[[]],debugSource:"refreshAndReturnRecord (remoteResult)"})}catch(u){console.error(u)}return d||c}async function fe(e){const{inMemoryRecordCache:t,pointer:n,userId:r,environment:i}=e,{defaultRecordCache:a}=i,s=await de.syncRecordValue(i,{pointer:n,userId:r,version:-1});s&&(ge({environment:i,inMemoryRecordCache:t,persistedRecordCache:a.persistedRecordCache,pointer:n,userId:r}),ue({environment:i,inMemoryRecordCache:t,pointer:n,userId:r,model:o.kk.fromValue(n.table,s.value),role:s.role,updatePaths:[[]],debugSource:"forceFetchRemoteRecord"}))}function ge(e){const{inMemoryRecordCache:t,persistedRecordCache:n,pointer:o,userId:r}=e;t.deleteRecord({pointer:o,userId:r}),t.emitRecord(o,[]),null==n||n.deleteRecord(o,r)}function he(e){const t=e.defaultRecordCache.inMemoryRecordCache;for(const{pointer:n}of t.data)le.unsubscribeForAllUsers({pointer:n,environment:e});t.clearCache()}const ve={LoggedInUser:100,JoinedSpace:50},be={block:!0,notion_user:!0,space:!0,space_bot:!0,space_user:!0,organization:!0,organization_space:!0,space_view:!0,user_root:!0,collection:!0,collection_view:!0,follow:!0,discussion:!0,comment:!0,user_settings:!0,slack_integration:!0,bot:!0,integration:!0,space_invite_link:!0,page_visit:!0,page_exit:!0,[h.P]:!0,team:!0,[C.yo]:!0,[a.y]:!0,[U.AT]:!0,[J.w]:!0,[k.B]:!0,activity:!1,notification:!1,access_request:!1,customer:!1,temporary_password:!1,password:!1,slack_notification:!1,snapshot:!1,credit:!1,used_credit:!1,space_recover_pages:!1,user_metadata:!1,saml_config:!1,experiment:!1,education_domain:!1,education_email:!1,public_email_domain:!1,user_data_consent_permissions:!1,token:!1,apple_token:!1,google_token:!1,firebase_token:!1,trello_token:!1,asana_token:!1,confluence_token:!1,monday_token:!1,external_entity:!1,external_integration_app:!1,external_token:!1,evernote_token:!1,drive_token:!1,block_token:!1,bot_token:!1,integration_token:!1,subscription:!1,space_domain:!1,admin_api_log:!1,admin_api_op_log:!1,oauth_authorization_code:!1,mfa_settings:!1,device:!1,user_device:!1,[y.Dw]:!1,[oe.t]:!1,[V.O]:!1,[m.H]:!1,[S.G]:!1,[_.l]:!1,[v.r]:!1,[b.r9]:!1,[f.Jd]:!1,[g.mz]:!1,[j.F]:!1,[w.Tu]:!1,[d.cv]:!1,[x.qV]:!1,[T.FM]:!1,[u.Xj]:!1,[z.fF]:!1,[H.x]:!1,[te.pm]:!1,[L.L]:!1,[q.L9]:!1,[X.nt]:!1,[G.nE]:!1,[Q.z]:!1,[$.u]:!1,[Y.Az]:!1,[W.M]:!1,[s.b]:!1,[ie.b]:!1,[l.t_]:!1,[c.J4]:!1,[D.a]:!1,[O.h]:!1,[B.f1]:!1,[F.P]:!1,[A.w]:!1,[E.O]:!1,[R.m]:!1,[M.b]:!1,[P.M]:!1,[Z.a]:!1,[I.P9]:!1}},52989:(e,t,n)=>{n.d(t,{AI:()=>h,MZ:()=>v,qw:()=>b});n(57658);var o=n(72126),r=n(75330),i=n(73744),a=n(28314),s=n(77546),l=n(95802),c=n(50694),d=n(15723),u=n(4926),p=n(69784),m=n(50628),f=n(27724),g=n(24677);function h(e){const{environment:t,target:n,startX:o,startY:d,showSelectionRect:m,preventSelectStores:h,allowVerticalEdgeScroll:b,allowHorizontalEdgeScroll:y}=e,_=f.default.getDefaultContainerFromTarget(n);if(!_)return;if(o>=window.innerWidth-u.Z.state)return;if(d>=window.innerHeight-u.Z.state)return;const S=s.VW(n),w=s.xH(n),k=l.C.getMembersByDOMOrder({filter:e=>e.getContextSelectableContainer()===_}),I=()=>{p.default.state.isActive&&(g.Jy(),v({environment:t,currentX:p.default.state.currentX,currentY:p.default.state.currentY,toggle:a.yA().shift}))};S&&i.lj(S,"scroll",I),w&&i.lj(w,"scroll",I),p.default.setState({moved:!1,isActive:!0,startX:o,startY:d,currentX:o,currentY:d,currentRect:void 0,defaultContainer:_,startSelection:f.default.state.stores,startSelectables:k,verticalScrollerEl:S,horizontalScrollerEl:w,startScrollTop:S?S.scrollTop:0,startScrollLeft:w?w.scrollLeft:0,showSelectionRect:m,handleScroll:I,preventSelectStores:h,allowVerticalEdgeScroll:b,allowHorizontalEdgeScroll:y}),g.ZH(t),r.wG(),c.HM.clearSelection()}function v(e){const{environment:t}=e,n=p.default.state;if(n.isActive){const{currentX:r,currentY:i,verticalScrollerEl:a,horizontalScrollerEl:s,startScrollTop:l,startScrollLeft:c,preventSelectStores:u}=n;let f=n.startY;if(a){f-=a.scrollTop-l}let h=n.startX;if(s){h-=s.scrollLeft-c}const v={top:Math.min(f,i),bottom:Math.max(f,i),left:Math.min(h,r),right:Math.max(h,r)},b=m.Z.state.selectableRectMap,y=n.startSelectables.filter((e=>{const t=b.get(e),o=e.props.store;return e.props.canSelect&&t&&d.kK(v,t)&&u.indexOf(o)<0&&(!n.showSelectionRect||o.isTransclusionType()||!o.isInsideTransclusion())})),S=_(y);let w=[];const k=S.find((e=>e.length>1));if(k)w=k;else{const e=o.Z$(S);e&&(w=e)}let I=o.UI(w,(e=>e.props.store));if(e.toggle)for(const e of n.startSelection)o.q9(I,e)?I=o.zu(I,e):I.push(e);p.default.setState({...n,moved:!0,currentX:e.currentX,currentY:e.currentY,currentRect:v}),g.Z5({environment:t,stores:I})}}function b(e){const t=p.default.state;if(t.isActive){const{moved:n,verticalScrollerEl:o,horizontalScrollerEl:r,handleScroll:a}=t;n||g.ZH(e),o&&i.ZV(o,"scroll",a),r&&i.ZV(r,"scroll",a),p.default.setState({isActive:!1})}}const y=function(e){if(e)for(;;){if(!(e=e.getContextClosestSelectable()))return;if(e.props.canSelect)return e}},_=function(e){const t=new Map,n={root:!0};for(const o of e){const e=y(o)||n;t.get(e)||t.set(e,[]),t.get(e).push(o)}return Array.from(t.values())}},79978:(e,t,n)=>{n.d(t,{Bl:()=>u,hE:()=>d,tG:()=>c});var o=n(80951),r=n(75134),i=n(9953),a=n(82530);function s(e){const{environment:t,store:n,propertyId:o,id:i,position:s,transaction:l}=e;let c;c="before"===s.type?{pointer:n.pointer,path:["properties",o],command:"addRelationBefore",args:{id:i,spaceId:n.getSpaceId(),before:s.before}}:{pointer:n.pointer,path:["properties",o],command:"addRelationAfter",args:{id:i,spaceId:n.getSpaceId(),after:s.after}},a.applyOperation({store:n,operation:c,transaction:l}),r.r({environment:t,store:n,relationPropertyId:o})}function l(e){const{environment:t,store:n,propertyId:o,id:i,transaction:s}=e;a.applyOperation({store:n,operation:{pointer:n.pointer,path:["properties",o],command:"removeRelation",args:{id:i,spaceId:n.getSpaceId()}},transaction:s}),r.r({environment:t,store:n,relationPropertyId:o})}function c(e){const{environment:t,store:n,propertyId:a,transaction:s,pointers:l}=e,c=(0,o.ow)(l);i.sW({store:n.getPropertiesStore(),data:{[a]:c},transaction:s}),r.r({environment:t,relationPropertyId:a,store:n})}function d(e){const{environment:t,sourceStore:n,destStore:o,propertyWithInverse:r,position:i,transaction:a}=e;s({environment:t,store:n,propertyId:r.property,id:o.id,position:i,transaction:a}),s({environment:t,store:o,propertyId:r.inverse,id:n.id,transaction:a,position:{type:"after"}})}function u(e){const{environment:t,sourceStore:n,destStore:o,propertyWithInverse:r,transaction:i}=e;l({environment:t,store:n,propertyId:r.property,id:o.id,transaction:i}),l({environment:t,store:o,propertyId:r.inverse,id:n.id,transaction:i})}},43008:(e,t,n)=>{n.d(t,{g:()=>l,x:()=>c});var o=n(95802),r=n(80444),i=n(79797),a=n(64951),s=n(24677);const l=function(e){const{mainEditorCurrentBlockStore:t}=r.default.state;if(t){const n=i.G.createChildStore(t,e.blockStore.pointer);a.Z.setState({...a.Z.state,originRect:e.originRect||o.C.getRectFromStore(e.blockStore),blockStore:n})}};function c(e){a.Z.reset(),s.ZH(e)}},52771:(e,t,n)=>{n.d(t,{$:()=>l,x:()=>c});var o=n(95802),r=n(80444),i=n(79797),a=n(82187),s=n(24677);const l=function(e){const{mainEditorCurrentBlockStore:t}=r.default.state;if(t){const n=i.G.createChildStore(t,e.blockStore.pointer);a.Z.setState({...a.Z.state,originRect:e.originRect||o.C.getRectFromStore(e.blockStore),clonedBlockStore:n,originalBlockStore:e.blockStore,renderDelete:e.renderDelete})}};function c(e){a.Z.reset(),s.ZH(e)}},52423:(e,t,n)=>{n.d(t,{AZ:()=>O,L0:()=>F,hv:()=>N,K9:()=>R,dA:()=>B,M7:()=>U,XT:()=>V,KX:()=>E,Yw:()=>D,qB:()=>Z});n(57658),n(52262),n(24506);var o=n(59730),r=n(72126),i=n(606),a=n(67175),s=n(97880),l=n(82798),c=n(16861),d=n(79797),u=n(70354),p=n(27724),m=n(24666),f=n(993),g=n(82530),h=n(73959),v=n(65663),b=n(54843);function y(e,t,n,o){const i=o.getClosestPageAndTransclusionReferenceAncestorIds(t),a=o.getClosestPageAndTransclusionReferenceAncestorIds(n);if(0===i.length||0===a.length)return[];const s=[];for(const c of r.jV(i,a)){const r=(0,l.TO)(o.getPathToBlock(c)),i=(0,l.TO)(S(e,r));s.push(..._(i,t,n))}return s.sort(((e,t)=>e.length-t.length)),s}function _(e,t,n){const o=[];let r=[];for(const i of function*(e,t){let n=!1;for(const o of function*(e){function t(e){let n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function*(){if(yield e,(!e.isNavigableBlock()||n)&&("transclusion_reference"!==e.getType()||o))for(const n of(0,b.y)(e))yield*t(n,!1,!1)}()}yield*t(e,!0,!0)}(e))o.id===t&&(n=!0),n&&(yield o)}(e,t))if(i.id!==t){if(r.length>0){if("transclusion_reference"===i.getType()){r=[];continue}r.push(i),i.id===n&&(o.push(r),r=[])}}else r=[i],t===n&&(o.push(r),r=[]);return o.sort(((e,t)=>e.length-t.length)),o}function S(e,t){(0,l.T)(t.length>0,"Path must not be empty"),(0,l.T)(e.id===t.shift(),"Path must start with root store id");let n=e;for(;t.length>0;){const e=(0,l.TO)(t.shift()),o=(0,b.y)(n).find((t=>t.id===e));if(!o)return;n=o}return n}var w=n(77282),k=n(28685);function I(e){const{store:t}=e;let n;(0,l.T)(t.useCrdt());const o=w.Z.getPageStoreForBlockStore(t);if(n=o?C({...e,pageStore:o,allowNonRenderedSingleStoreSelection:!1}):x(e),n&&(n.start.store!==n.end.store||n.start.index<n.end.index))return n}function C(e){var t,n;const{store:o,startTextInstanceId:i,startId:a,endTextInstanceId:s,endId:c,pageStore:d,allowNonRenderedSingleStoreSelection:u}=e,p=(0,l.TO)(w.Z.getPageTextInstanceTrackerForPage(d.pointer)),m=p.getBlockIdForTextInstanceItemId(i,a),f=p.getBlockIdForTextInstanceItemId(s,c);if(void 0===m||void 0===f)return;const g=y(d,m,f,(0,l.TO)(w.Z.getPageBlockTrackerForPage(d.pointer)));let h,v;const b=r.MR(g,(e=>(0,l.TO)(e.at(0))===o?-1:1));for(const r of b){const e=(0,l.TO)(r.at(0)),t=(0,l.TO)(r.at(-1));if(k.E.findEditableWithStore(e.getBlockTitleStore())&&k.E.findEditableWithStore(t.getBlockTitleStore())){h=e,v=t;break}}if((!h||!v)&&u&&b.length>0&&b[0].at(0)===b[0].at(-1)&&(h=(0,l.TO)(b[0].at(0)),v=(0,l.TO)(b[0].at(-1))),!h||!v)return;let _=(0,l.TO)(null===(t=h.getTextSliceTree())||void 0===t?void 0:t.findGraphemeIndexOfOpId(i,a)),S=(0,l.TO)(null===(n=v.getTextSliceTree())||void 0===n?void 0:n.findGraphemeIndexOfOpId(s,c));return _<0&&(_=-_-1),S<0?S=-S-1:S+=1,{start:{store:h.getBlockTitleStore(),index:_},end:{store:v.getBlockTitleStore(),index:S}}}function x(e){const{store:t,startTextInstanceId:n,startId:o,endTextInstanceId:r,endId:i}=e;(0,l.T)(t.useCrdt());const a=t.getSerializedTextClocksStore().getValue();if(!a||void 0===a[n]||void 0===a[r])return;const s=(0,l.TO)(t.getTextSliceTree());let c=s.findGraphemeIndexOfOpId(e.startTextInstanceId,e.startId);if(!c)return;let d=r===n&&i===o?c:s.findGraphemeIndexOfOpId(e.endTextInstanceId,e.endId);return d?(c<0&&(c=-c-1),d<0?d=-d-1:d+=1,{start:{store:t.getBlockTitleStore(),index:c},end:{store:t.getBlockTitleStore(),index:d}}):void 0}function T(e){const{store:t,textInstanceId:n,itemId:o,options:r}=e;(0,l.T)(t.useCrdt());const i=w.Z.getPageStoreForBlockStore(t);if(!i)return;const a=(0,l.TO)(w.Z.getPageTextInstanceTrackerForPage(i.pointer)).getBlockIdForTextInstanceItemId(n,o,r);if(!a)return;const s=y(i,a,a,(0,l.TO)(w.Z.getPageBlockTrackerForPage(i.pointer)));if(s.length>0){const e=s[0];return(0,l.T)(1===e.length),e[0]}}function M(e){const{store:t,transaction:n,operation:o}=e,r=function(e){const{store:t,textInstanceId:n,id:o}=e;(0,l.T)(t.useCrdt());const r=w.Z.getPageStoreForBlockStore(t),i=r?C({store:t,startTextInstanceId:n,startId:o,endTextInstanceId:n,endId:o,pageStore:r,allowNonRenderedSingleStoreSelection:!0}):x({store:t,startTextInstanceId:n,startId:o,endTextInstanceId:n,endId:o});return null==i?void 0:i.end}({store:t,textInstanceId:o.args.textInstanceId,id:o.args.originId});if(!r)return"err_no_store_position";const i=(0,l.TO)((0,h.sQ)(r.store)),a=(0,l.TO)(i.getTextSliceTree()),{operations:s,invertedOperations:c}=a.getOperationsForInsertTextValueAfterOriginId(o.args.textInstanceId,o.args.originId,o.args.textValue);return v.F({transaction:n,store:i,crdtOperations:s,invertedOperations:c}),"success"}function P(e){const{environment:t,store:n,transaction:o,operation:r}=e;switch(r.command){case"invertedInsertText":return function(e){const{environment:t,store:n,transaction:o,operation:r}=e,i=I({store:n,startTextInstanceId:r.args.textInstanceId,startId:r.args.startId,endTextInstanceId:r.args.textInstanceId,endId:r.args.endId});return i?(f.pz({environment:t,multiSelection:i,transaction:o}),"success"):"err_no_multiselection"}({environment:t,store:n,transaction:o,operation:r});case"invertedDeleteText":return M({environment:t,store:n,transaction:o,operation:r});case"invertedMoveTextSlice":return function(e){const{store:t,transaction:n,operation:o}=e,r=T({store:t,textInstanceId:o.args.textInstanceId,itemId:o.args.textSliceStartItemId,options:{type:"start"}});if(!r)return"err_no_source_block_store";const i=T({store:t,textInstanceId:o.args.targetTextInstanceId,itemId:o.args.targetTextSliceEndItemId,options:{type:"end"}});if(!i)return"err_no_target_block_store";const a=(0,l.TO)(r.getTextSliceTree()),s=(0,l.TO)(a.findTextSliceTreeBeforeTextSliceStartingWithItemId(o.args.textInstanceId,o.args.textSliceStartItemId)).getTextSlice();return g.applyCrdtTextOperation({transaction:n,store:r,operation:{command:"moveTextSlice",path:[],pointer:r.pointer,args:{textInstanceId:o.args.textInstanceId,textSliceStartItemId:o.args.textSliceStartItemId,targetBlockId:i.id,targetTextInstanceId:o.args.targetTextInstanceId,targetTextSliceEndItemId:o.args.targetTextSliceEndItemId}},invertedOperation:{command:"invertedMoveTextSlice",path:[],pointer:r.pointer,args:{textInstanceId:o.args.textInstanceId,textSliceStartItemId:o.args.textSliceStartItemId,targetTextInstanceId:s.textInstanceId,targetTextSliceEndItemId:s.getEndItem().id}}}),"success"}({environment:t,store:n,transaction:o,operation:r});case"invertedAddAnnotation":return function(e){const{environment:t,store:n,transaction:o,operation:r}=e,i=I({store:n,startTextInstanceId:r.args.startTextInstanceId,startId:r.args.startId,endTextInstanceId:r.args.endTextInstanceId,endId:r.args.endId});return i?(f.QX({environment:t,multiSelection:i,annotationTypeOrKey:r.args.annotationKey,transaction:o}),"success"):"err_no_multiselection"}({environment:t,store:n,transaction:o,operation:r});case"invertedRemoveAnnotation":return function(e){const{environment:t,store:n,transaction:o,operation:r}=e,i=I({store:n,startTextInstanceId:r.args.startTextInstanceId,startId:r.args.startId,endTextInstanceId:r.args.endTextInstanceId,endId:r.args.endId});return i?(f.KM({environment:t,multiSelection:i,annotation:r.args.annotation,transaction:o}),"success"):"err_no_multiselection"}({environment:t,store:n,transaction:o,operation:r});default:(0,s.t1)(r)}}var A=n(24161);const R=function(e){const t=u.default.state,{undoStack:n,invertedTextOperationIdMapper:o}=t,r=e.currentTime??Date.now(),i=e.transaction.getUserActionForAnalyticsPurposesOnly()??"unknown";if("string"==typeof e.undoCheckpoint){const t=n.find((t=>t.namedRevisionId===e.undoCheckpoint));t?(t.transactions.push(e.transaction),t.userActions.push(i)):n.push({userActions:[i],transactions:[e.transaction],timestamp:r,namedRevisionId:e.undoCheckpoint,undoRedoCount:0})}else{const t=n.at(-1);!e.undoCheckpoint&&t&&!t.namedRevisionId&&r-t.timestamp<=u.groupIntervalMs&&0===t.undoRedoCount&&t.transactions[0].isLocal===e.transaction.isLocal&&t.transactions[0].operations.some(a.Qf)===e.transaction.operations.some(a.Qf)?(t.transactions.push(e.transaction),t.userActions.push(i)):n.push({userActions:[i],transactions:[e.transaction],timestamp:r,undoRedoCount:0})}u.default.setState({undoStack:n,redoStack:[],invertedTextOperationIdMapper:o}),u.default.emit()};function D(e,t){const n=u.default.state,{invertedTextOperationIdMapper:o}=n,{undoStack:r,redoStack:i}=q(n),a=r.pop();if(a){const n=j({environment:e,revision:a,preventSelectText:t,invertedTextOperationIdMapper:o});i.push(n),u.default.setState({undoStack:r,redoStack:i,invertedTextOperationIdMapper:o})}}function E(e,t){const n=u.default.state,{invertedTextOperationIdMapper:o}=n,{undoStack:r,redoStack:i}=q(n),a=i.pop();if(a){const n=j({environment:e,revision:a,preventSelectText:t,invertedTextOperationIdMapper:o});r.push(n),u.default.setState({undoStack:r,redoStack:i,invertedTextOperationIdMapper:o})}}const B=function(){u.default.reset()},F=function(){return Boolean(V())},O=function(){return Boolean(U())};function Z(e){const t=u.default.state,{environment:n,namedRevisionId:o}=e,{invertedTextOperationIdMapper:r}=t,{undoStack:i,redoStack:a}=q(t),s=i.findIndex((e=>e.namedRevisionId===o));if(s<0)return;const l=j({environment:n,revision:i.splice(s,1)[0],invertedTextOperationIdMapper:r});a.push(l),u.default.setState({undoStack:i,redoStack:a,invertedTextOperationIdMapper:r})}function V(){const e=u.default.state.undoStack.at(-1);return e?L(e):void 0}function U(){const e=u.default.state.redoStack.at(-1);return e?L(e):void 0}function N(e){return u.default.state.undoStack.some((t=>t.namedRevisionId===e))}function L(e){return{getUserActions:()=>e.userActions.slice(),getFirstStore(){var t;return null==e||null===(t=e.transactions)||void 0===t||null===(t=t[0].stores)||void 0===t?void 0:t[0]}}}function j(e){const{environment:t,revision:n,invertedTextOperationIdMapper:o,preventSelectText:a}=e;let{transactions:u}=n;c.Z.provider&&console.log("Undoing/redoing transactions with user actions",n.userActions.join(","));const{performResult:f}=g.createAndCommit({userAction:"revisionActions.performUndoRedoRevisionTransaction",environment:t,canUndo:!1,perform:e=>{u=r.d9(u),u.reverse();for(const n of u){const u=r.d9(n.invertedOperations);u.reverse();for(const r of u)if((0,A.v)(r)){const a=n.stores.filter((e=>(0,i.qo)(e.pointer,r.pointer)&&e instanceof d.G)),u=a.find((e=>Boolean(e.uiLocation.uiParent)))??a.at(0);if(!u)continue;const p=e.operations.length,m=o.getInvertedTextOperationWithMaybeRemappedIds(r),f=P({environment:t,store:u,transaction:e,operation:m});"success"!==f&&c.Z.logInvertedTextOperationError({transaction:n,invertedOperation:r,maybeRemappedInvertedOperation:m,errorCode:f});const g=e.operations.length;if("invertedDeleteText"===m.command&&g>p){const t=z(e.operations.slice(p,g));o.remapIdsForReinsertedText(m,(0,l.Fb)(t,(0,s.AO)((e=>"insertText"===e.command?{true:e}:{false:e}))))}}else{const t=n.stores.find((e=>(0,i.qo)(e.pointer,r.pointer)));if(!t)continue;g.applyOperation({transaction:e,store:t,operation:r})}n.beforeSelection&&p.default.setState({...p.default.state,...n.beforeSelection}),n.beforeTextSelection&&!a&&m.default.setState(n.beforeTextSelection)}return e}});return{...n,transactions:[f],undoRedoCount:n.undoRedoCount+1}}function z(e){for(const t of e)if("insertText"===t.command)return t;throw new o.p8("Operations should conatin an InsertTextOperation")}function q(e){const{undoStack:t,redoStack:n}=e;return{undoStack:t.slice(),redoStack:n.slice()}}},56863:(e,t,n)=>{n.d(t,{w:()=>i});var o=n(49557),r=n(4935);const i=function(){o.Z.state.isActive&&(r.Z.setState({...r.Z.state,open:!1}),o.Z.setState({...o.Z.state,isActive:!1,isAnimatingClosed:!0}))}},75754:(e,t,n)=>{n.d(t,{_:()=>c});var o=n(15145),r=n(64002),i=n(35683),a=n(84210),s=n(46735),l=n(8055);function c(e){const{environment:t,store:n,redirect:c,scrollToBlockId:d,collectionViewId:u,openInNew:p,discussionId:m,showMoveTo:f,saveParent:g,visitType:h,templateGalleryItem:v,projectManagementLaunch:b,pageVisitSource:y,openInSidePeek:_,queryId:S,callback:w,peekMode:k}=e,I=(0,a.Hu)({store:n,fullyQualified:!1,scrollToBlockId:d,collectionViewId:u,discussionId:m,showMoveTo:f,saveParent:g,templateGalleryItem:v,projectManagementLaunch:b,openInSidePeek:_,pageVisitSource:y,peekMode:k});n.isNavigableBlock()&&s.Z.recordVisit({id:n.id,systemBlockType:n.getSystemBlockTypeStore().getValue(),type:void 0!==h?h:i.vu.Default,currentUserId:t.currentUser.id}),l.c4({environment:t,url:y?r.SK(I,{[o.$X]:y,[o.Mf]:p?S:void 0}):I,redirect:c,openInNew:p,queryId:S,callback:w})}},12714:(e,t,n)=>{n.d(t,{D:()=>a});var o=n(64002),r=n(95477),i=n(47839);function a(e){const{environment:t,targetSelf:n}=e;let a=e.url;"/"===a[0]&&(a=r.default.domainBaseUrl+a);const s=o.yn(a);if(s)if(t.device.isElectron)i.openExternalUrl(s);else if(t.mobileNative)s.startsWith("http:")||s.startsWith("https:")?t.mobileNative.openInAppBrowser(s):window.location.href=s;else{const t=document.createElement("a");t.href=e.url,t.classList.add("notion-link"),n||t.setAttribute("target","_blank"),t.setAttribute("rel","noopener noreferrer"),document.body.appendChild(t),t.click(),t.remove()}}},32953:(e,t,n)=>{n.d(t,{Hu:()=>G,LU:()=>z,M3:()=>H,Pg:()=>N,UV:()=>W,Vz:()=>K,jC:()=>L,rM:()=>j});var o=n(15157),r=n(72126),i=n(75330),a=n(18821),s=n(95306),l=n(9080),c=n(74948),d=n(36896),u=n(50694),p=n(80444),m=n(16772),f=n(89256),g=n(17903),h=n(19671),v=n(13023),b=n(98452),y=n(99332),_=n(24612),S=n(55320),w=n(86486),k=n(27724),I=n(52258),C=n(66708),x=n(77503),T=n(62820),M=n(54564),P=n(6404),A=n(51365),R=n(47839),D=n(54604),E=n(43008),B=n(52771),F=n(52423),O=n(24677),Z=n(64964),V=n(98104),U=n(53471);function N(e){C.Z.reset(),x.Z.reset(),I.Z.reset(),f.Z.reset(),A.xv({environment:e,blockPropertyValueOverlayStore:h.Z}),U.W8(),Z.C1()}function L(e,t){b.Z.reset(),y.Z.reset(),_.Z.reset(),A.xv({environment:e,blockPropertyValueOverlayStore:v.Z})}function j(e){var t;R.inPageSearch.stop(),O.ZH(e),V.ZH(e),i.wG(),u.HM.clearSelection(),O.Fp({pivot:void 0}),P.xv(),w.default.reset(),F.dA(),M.LZ(),B.x(e),E.x(e),m.default.resetStore({environment:e}),D.xv(),null===(t=e.NativeMobileActionBarStore)||void 0===t||t.clear(!1)}function z(e){d.Z.reset(),S.default.reset(),T.Z.state.open&&(T.Z.reset(),e.device.isMobile&&c.close()),l.Z.state.open&&s.UZ(e),a.Cd(e)}function q(){const{mainEditorCurrentBlockStore:e}=p.default.state;let t=0,n=[];if(e){const{stores:e}=k.default.state;n=r.oA(e.map((e=>e.id))),t=g.Z.state.scrollTop}return{scrollTop:t,blockIds:n}}function H(e){let{historyId:t,currentUserId:n}=e;const r=o.Z.get({userId:n,key:t});return r?r.index:0}function W(e){let{historyId:t,historyIndex:n,currentUserId:r}=e;const i={...q(),index:n};o.Z.set({userId:r,key:t,value:i})}function K(e){let{historyId:t,currentUserId:n}=e;const r=o.Z.get({userId:n,key:t});if(!r)return;const i={...q(),index:r.index};o.Z.set({userId:n,key:t,value:i})}function G(e){let{RouterStore:t,currentUserId:n}=e;const r=t.state.id;o.Z.remove({userId:n,key:r})}},31120:(e,t,n)=>{n.d(t,{Rd:()=>wt,fE:()=>ct,dH:()=>Je,FA:()=>Tt,xp:()=>ft,E4:()=>ut,LW:()=>mt,ST:()=>ot,Z1:()=>At,WC:()=>rt,wo:()=>_t,OO:()=>vt,kd:()=>ht,hY:()=>It,o9:()=>Ye,HR:()=>tt,r$:()=>yt,uO:()=>nt,KR:()=>bt,td:()=>at,D_:()=>Xe,nN:()=>lt,rH:()=>dt,OP:()=>xt,JW:()=>Ct,YU:()=>pt,cQ:()=>kt,Z_:()=>st,Mj:()=>it,wN:()=>gt,AL:()=>St,yD:()=>et,HB:()=>$e,pN:()=>Qe});n(82801),n(21703),n(57658);var o=n(15145),r=n(50475),i=n(7406),a=n(68626),s=n(97213),l=n(4615),c=n(71644),d=n(45953),u=n(99405),p=n(89101),m=n(21202),f=n(33709),g=n(23867),h=n(77858),v=n(19889),b=n(66079),y=n(9852),_=n(54153),S=n(94826),w=n(97880),k=n(64002),I=n(36054),C=n(74487),x=n(9291),T=n(72899),M=n(91851),P=n(59183),A=n(95477),R=n(28020),D=n(70764),E=n(12955),B=n(21969),F=n(35683),O=n(15070),Z=n(9844),V=n(80444),U=n(49065);var N=n(33929),L=n(98165),j=n(18514),z=n(48779),q=n(55081),H=n(10929),W=n(75538),K=n(30806),G=n(94841),$=n(74948),Q=n(38676),Y=n(36391),X=n(51),J=n(19511),ee=n(77080),te=n(30874),ne=n(46735),oe=n(33759),re=n(89403),ie=n(49085);class ae extends ie.default{getInitialState(){return{args:void 0}}}const se=new ae;var le=n(42330),ce=n(93220),de=n(72014),ue=n(30539),pe=n(88923),me=n(89523),fe=n(79797),ge=n(55320),he=n(27724),ve=n(92083),be=n(83941),ye=n(29949),_e=n(57549),Se=n(32441),we=n(19719),ke=n(51787),Ie=n(54642),Ce=n(35793),xe=n(47307),Te=n(91584),Me=n(47839),Pe=n(3297),Ae=n(94273),Re=n(92625),De=n(97977),Ee=n(36110),Be=n(73661),Fe=n(25320),Oe=n(99553),Ze=n(31304),Ve=n(40277),Ue=n(4408),Ne=n(87531),Le=n(29974),je=n(12170),ze=n(75754),qe=n(32953),He=n(21862),We=n(65729),Ke=n(8055);const Ge=(0,x.defineMessages)({errorSamlMessage:{defaultMessage:"Could not log you in.",id:"router.loginWithSamlError.message"},appleErrorMessage:{id:"loginActions.loggingInWithApple.errorMessage",defaultMessage:"Something went wrong while trying to log in with Apple."},authenticating:{id:"externalIntegrationAuthActions.authenticationWithIntegration.loadingMessage",defaultMessage:"Authorizing with integration…"},joinedTeamMessage:{id:"joinedTeam.confirmationMessage",defaultMessage:"Joined {teamName}"},backToContent:{id:"router.joinSpaceError.acceptLabel.backToContent",defaultMessage:"Back to my content"},goBack:{id:"router.joinSpaceError.acceptLabel.goBack",defaultMessage:"Go back"},thirdPartyDebugPrefix:{id:"router.debugMessage.thirdPartyError",defaultMessage:"Error from third party"}});function $e(e,t){if(E.canSetCookie(e))try{const n=new URL(t),o=n.searchParams.get("ps_partner_key"),r=n.searchParams.get("ps_xid");if(r&&o){const t={partnerKey:window.atob(o),clickId:r};return E.setS2STrackingCookie(e,t),void Se.Es({partner_stack_key:t.partnerKey})}const i=n.searchParams.get("gspk");if(i){const t=window.atob(i);return E.setPartnerStackCookie(e,t),void Se.Es({partner_stack_key:t})}}catch(n){}}function Qe(e,t){if(t)try{const{experimentGroups:n,inviteeEmail:o,inviterName:r}=JSON.parse(window.atob(t));ke.WC(e,{invitee_email:o,invitation_experiment_groups:n}),re.Z.setState({...re.Z.state,inviteeEmail:o,inviterName:r}),o&&oe.Z.setState({...oe.Z.state,email:o})}catch(n){}}async function Ye(e,t,n,o){if(!e.currentUser.id)return void Ke.c4({environment:e,url:p._j.root,redirect:!0});let r;if(t.spaceId)r=t.spaceId;else{const{spaceId:t}=await Ae.Ie(e);r=t}if(Ce.Uz({nextRoute:{...t,spaceId:r},currentRoute:n,environment:e,query:""}),"search"===t.tab){if(!ge.default.state.sessionId){const t=(0,l.ZP)();ge.default.update((e=>({...e,open:!1,openAsPage:!0,openedTimeMs:Date.now(),sessionId:t}))),ke.wF(e,{from:"pop"===o?"mobile-back-navigation":"mobile-bottom-bar",searchSessionId:t})}}else"updates"===t.tab&&we.Up({environment:e,from:"pop"===o?"mobile-back-navigation":"mobile-bottom-bar"})}async function Xe(e,t,n){if(!e.currentUser.id)return;Ce.Uz({nextRoute:t,currentRoute:n,environment:e,query:""});const o=e.device.isElectron&&!(await Me.quickSearchVisibilityState.isVisible());Ne.UT({environment:e,analyticsFrom:"quick-search",renderAsPage:!0,isQuickSearch:!0,doNotTrackOpenSearchEvent:o})}function Je(e,t,n){e.currentUser.id&&Ce.Uz({nextRoute:t,currentRoute:n,environment:e,query:""})}function et(e,t,n){e.currentUser.id&&t.spaceId&&W.default.state.isOnboarding?Ce.Uz({nextRoute:t,currentRoute:n,environment:e,query:""}):Ke.c4({environment:e,url:p._j.root,redirect:!0})}async function tt(e,t){if(!e.currentUser.id)return void Ke.c4({environment:e,url:p._j.root,redirect:!0});const{id:n,type:o,from:r}=t;let a,s;if(t.spaceId)a=t.spaceId;else{const{spaceId:t}=await Ae.Ie(e);a=t}if(a){const{currentUserSettingsStore:t}=V.default.state,n=new fe.r9(e,{table:b.dx,id:e.currentUser.id});if(await n.load(),void 0===V.default.state.currentSpaceStore||V.default.state.currentSpaceStore.id!==a)try{await Le.j({environment:e,userRootStore:n,spaceId:a,navigate:!0,analyticsFrom:"redirect",userSettingsStore:t})}catch(l){return void xe.showMessage({message:(0,i.tg)(l).message,onAccept:()=>{Ke.op(e)}})}}else Ke.c4({environment:e,url:p._j.root,redirect:!0}),await V.default.waitUntil((()=>void 0!==V.default.state.currentSpaceStore&&void 0!==V.default.state.currentSpaceViewStore&&void 0!==V.default.state.currentUserRootStore));if(o){if(!(0,I.Gu)(C.literals(...le.o1),o)){const e=o;switch(e){case"page":case"team":n&&(s={type:e,spaceId:a,id:n});break;case"space":n&&(s={type:e,id:n});break;case"space-private-pages":s={type:e,spaceId:a}}}}$.quickAddPage({environment:e,from:r||"route",redirect:!0,quickAddParentOverride:s})}async function nt(e){if(e.currentUser.isLoggedIn()){await q.zJ(e)&&await q.yH(e)}else{const t=W.default.state,n=_.Z.get(H.WX);t.isOnboarding||n?Ke.c4({environment:e,url:p._j.signup}):Ke.c4({environment:e,url:p._j.login})}}async function ot(e,t){const{code:n,frontPathName:o}=t;if(!n)return void Ke.c4({environment:e,url:p._j.signup});"fail"===(await De.requestLoginWithGoogleOneTap({environment:e,store:oe.Z,idToken:n,frontPathName:o})).status&&Ke.c4({environment:e,url:p._j.signup})}function rt(e){e.currentUser.isLoggedIn()||Ke.c4({environment:e,url:p._j.login})}function it(e){e.currentUser.isLoggedIn()||Ke.c4({environment:e,url:p._j.login})}function at(e,t,n){var o;if(e.device.isMobile)return;const i=pe.default.state;let a,s,l=!1,c=!1;if("page"===t.name&&t.peekViewBlockId){const{mainEditorCurrentBlockStore:e}=V.default.state;if(e){const n=fe.G.createChildStore(e,{table:m.iU,id:t.peekViewBlockId});l=Boolean(t.showMoveTo),c=Boolean(t.saveParent),a=n;const o="page"===t.name&&t.peekMode?t.peekMode:void 0;s=(0,pe.getPeekModeFromUrlParam)(o)}}else if("chat"===t.name&&t.peekViewBlockId){l=!1,c=!1,a=new fe.G(e,{table:m.iU,id:t.peekViewBlockId}),s=pe.PeekModeSide}if(!(0,r.u7)(null===(o=a)||void 0===o?void 0:o.getSystemBlockTypeStore().getValue())){if(a&&(!i.open||a.id!==i.target.id||s!==i.mode)){var d,u;i.open&&Be.P(i.target,e,de.jx);const t=de.jx.getCurrentPageVisitId();de.jx.initializeNewPageVisitId();const o=he.default.cloneState(),r=P.Z.cloneState(),p=J.Z.cloneState(),m=e.currentUser.id;qe.jC(e,i.mode),qe.LU(e),qe.rM(e),Se.PB(e,{page_id:a.id,collection_id:a.getAssociatedCollectionId()??(null===(d=a.getCollectionViewCollectionStore())||void 0===d?void 0:d.id),team_id:null===(u=(0,L.VP)(a))||void 0===u?void 0:u.id,is_peek:!0,peek_mode:s,type:"page",query:n,page_visit_id:de.jx.getCurrentPageVisitId(),previous_page_visit_id:t});const f=new fe.G(e,a.pointer),g=new ue.Z,h=new me.Z,v=new ce.Z;Oe.bA(e,{mode:s??pe.PeekModeCenter,target:f,pageVisitStore:g,presenceStore:h,showMoveTo:l,saveParent:c,loadingContainerStore:v,savedSelectionStoreState:o,savedTableSelectionStoreState:r,savedCollectionViewSelectionStoreState:p,savedSidebarExpandedStoreState:Q.sidebarExpandedStore.state}),Ze._({userId:m,rootStore:f,presenceStore:h,environment:e,pageVisitIdStore:de.jx}),Fe.UX(e,{block:f,pageVisitStore:g,timestamp:Date.now(),fromPageRefresh:(0,y.QG)()}),ne.Z.recordVisit({id:a.id,systemBlockType:a.getSystemBlockTypeStore().getValue(),type:F.vu.Default,currentUserId:m})}i.open&&!a&&(Oe.ME(),Ze.E(i.presenceStore,e,de.jx,i.target),qe.jC(e,i.mode))}}function st(e,t){if(e.device.isMobile)return;const{mainEditorCurrentBlockStore:n}=V.default.state;if(n)if("page"===t.name&&t.templateGalleryItem){if("closed"===ye.Z.state.status){const e=t.pageVisitSource===o.tY.PersonalHomeTileTemplates.toString()?"home_tile_templates":"direct_link";ye.Z.open({analyticsFrom:e,cloneTo:"destination_picker"})}}else"closed"!==ye.Z.state.status&&ye.Z.setState({...ye.Z.state,status:"closed"})}async function lt(e,t,n){const r=t.currentUser.isLoggedIn(),{RouterStore:i,device:s}=t,l=s.isMobileNative&&s.isIOS,c=i.state.route,d=(e,t)=>{l&&"root"!==i.state.route.name?a.log({level:"warning",from:"routerActions",type:"handleRootRedirect",data:{message:`Prevented ${e} as route has since changed to "${i.state.route.name}"]. Initial route at the start of handleRootRedirect was "${c.name}"}`}}):(l&&a.log({level:"info",from:"routerActions",type:"handleRootRedirect",data:{message:`Redirecting for ${e} as route is still root. Initial route at the start of handleRootRedirect was "${c.name}"}`}}),t())};if(r){l&&a.log({level:"info",from:"routerActions",type:"handleRootRedirect",data:{message:"Called handleRootRedirect"}});const e=await(0,z.iX)({environment:t,disableRedirectUrl:!1}),{firstSpaceView:i,lastVisitedSpaceView:s,forkPageBlockId:c,publicAccessPageId:u,oauthAuthorizationParams:p,userRootStore:f,redirectUrl:g,userSettingsStore:v,userStore:b,isPersonalHomeRedirect:y}=e;y&&(0,K.$X)({environment:t,from:"on_app_start_page"}),await ee.default.waitUntil((()=>ee.default.state.isLoaded));await q.zJ(t,b)&&await q.yH(t);const S=W.default.state,w=t.currentUser.id,I=_.Z.get(H.WX);if(I&&r)return void(await kt(t,I));if(p&&i&&(e.onboardingCompleted||H.BB(S))){const{responseType:e,redirectUri:n,integrationId:o,state:r,owner:i,userId:a,spaceId:s}=p;return void Ee.g({environment:t,responseType:e,redirectUri:n,integrationId:o,state:r,owner:i,userId:a,spaceId:s})}const C=We.A(void 0);We.j({currentUserId:void 0,params:void 0});const x=(null==n?void 0:n.templateGalleryItem)||(null==C?void 0:C.tg),T=(null==n?void 0:n.projectManagementLaunch)||Boolean(null==C?void 0:C.pjm);if(S.isOnboarding)if(H.BB(S)){if(S.spaceViewId){const e=new fe.V9(t,{table:h.zU,id:S.spaceViewId});"workspace_setup"===S.stage?M.Xi(t,{spaceViewStore:e}):await Le.y3({environment:t,spaceViewStore:e,userSettingsStore:v,userRootStore:f,templateGalleryItem:null==n?void 0:n.templateGalleryItem,projectManagementLaunch:null==n?void 0:n.projectManagementLaunch,pageVisitSource:o.tY.Onboarding,navigationType:"joiningOrCreatingSpace"})}}else Ke.T4(t);else if(p&&e.onboardingCompleted){const{responseType:e,integrationId:n,redirectUri:o,state:r,owner:i,userId:a,spaceId:s}=p;Ee.g({environment:t,responseType:e,integrationId:n,redirectUri:o,state:r,owner:i,userId:a,spaceId:s})}else if(u&&e.onboardingCompleted){Ve.Hr({currentUserId:w,blockId:void 0});const e=fe.G.createChildStore(f,{table:m.iU,id:u});await e.load(),ze._({environment:t,store:e,pageVisitSource:o.tY.Direct})}else if(i&&e.onboardingCompleted){const n=g;if(t.device.isMobile&&!e.mobileOnboardingCompleted)return void(await q.I1(t,{type:"mobile-onboarding",redirectUrl:g}));if(c){Pe.nM({currentUserId:w,blockId:void 0});const e=fe.G.createChildStore(f,{table:m.iU,id:c});await e.load(),await R.wU(f);const n=R.o(f);if(1===n.length){const o=n[0],r=o.getSpaceStore();if(!r)return;return void Pe.DK({environment:t,store:e,spaceStore:r,spaceViewStore:o,isPrivate:!0,context:"signin_after_duplicate"})}await ee.default.waitUntilStatsigReady();if(!(0,be.M)({disableExposureLogging:!0}))return void ze._({environment:t,store:e,pageVisitSource:o.tY.Duplicate})}if(n){let e=n;(T||x)&&(e=k.SK(e,{tg:x,pjm:T})),d("redirectUrl",(()=>{Ke.c4({environment:t,url:e,redirect:!0})}))}else s?d("lastVisitedSpaceView",(()=>{Le.y3({environment:t,spaceViewStore:s,userRootStore:f,userSettingsStore:v,templateGalleryItem:x,projectManagementLaunch:T,pageVisitSource:o.tY.Login,navigationType:"switchingToOrLoadingSpace"})})):(t.device.isMobileNative&&a.log({level:"info",from:"routerActions",type:"SpaceSwitchingDebug",data:{message:"navigateToFirstSpace because handleRootRedirect"}}),d("spaceActions.navigateToFirstSpace",(()=>{Le.L5({environment:t,userRootStore:f,userSettingsStore:v,templateGalleryItem:x,projectManagementLaunch:T,pageVisitSource:o.tY.Login})})))}else await q.I1(t,{type:"new-user",redirectUrl:g})}}async function ct(e,t){const{callbackType:n,encryptedToken:o,encryptedNonce:r,code:i,error:a,encryptedUserObject:s,webBrowserDeviceId:l}=e;if("native"===n&&!t.device.isNative)return void Ke.RX({url:window.location.href,environment:t});if("user_cancelled_authorize"===a)return oe.Z.setState({...oe.Z.state,loginType:"email"}),void Ke.c4({environment:t,url:p._j.login});if(a||!i||!o||!r){const e=N.default.formatMessage(Ge.appleErrorMessage);return oe.Z.setState({...oe.Z.state,alert:e}),void Ke.c4({environment:t,url:p._j.login})}const c=await De.loginWithAppleAuth({environment:t,encryptedToken:o,encryptedNonce:r,code:i,encryptedUserObject:s,webBrowserDeviceId:l});c&&(oe.Z.setState({...oe.Z.state,alert:c}),Ke.c4({url:p._j.login,environment:t}))}async function dt(e,t){let n;e.userId?await De.loginSamlUser({environment:t,userId:e.userId,isNewSignup:e.isNewSignup||!1,previousUserId:e.previousUserId}):n=e.token&&e.csrfState?await De.loginSamlUserWithToken({environment:t,csrfState:e.csrfState,token:e.token,isNewSignup:e.isNewSignup||!1}):e.error||N.default.formatMessage(Ge.errorSamlMessage),n&&(oe.Z.setState({...oe.Z.state,alert:n}),Ke.c4({environment:t,url:p._j.login}))}async function ut(e,t){const{callbackType:n,encryptedToken:o,code:r,error:i,webBrowserDeviceId:a}=e;if("native"===n&&!t.device.isNative)return void Ke.RX({url:window.location.href,environment:t});if("access_denied"===i&&oe.Z.setState({...oe.Z.state,loginType:"email"}),i||!r||!o)return oe.Z.setState({...oe.Z.state,alert:i}),void Ke.c4({environment:t,url:p._j.login});const s=await De.loginWithGoogleAuth({environment:t,encryptedToken:o,code:r,callbackType:"native"===n||"nativeredirect"===n?n:void 0,webBrowserDeviceId:a});s&&(oe.Z.setState({...oe.Z.state,alert:s}),Ke.c4({url:p._j.login,environment:t}))}async function pt(e){const{route:t,environment:n}=e;"legacy"===t.type?await async function(e){const{route:{code:t,state:n},environment:o}=e;let r;if(t&&n){const e=await Ie.authWithSlack(o,{code:t,encryptedState:n});"failed"===e.type&&(r=e.error.message)}else r="Something went wrong.";r&&xe.deprecatedShowErrorMessage(r);const{url:i}=Ae.Vr(o);Ke.c4({url:i||p._j.root,environment:o})}({environment:n,route:t}):"new"===t.type?await async function(e){const{route:{error:t},environment:n}=e;if(t){const e=N.default.formatMessage((0,D.mO)(t),{value:t});xe.showErrorMessage(e)}else await je.pJ({environment:n});const{url:o}=Ae.Vr(n);Ke.c4({url:o||p._j.root,environment:n})}({environment:n,route:t}):(0,w.t1)(t)}function mt(e,t){const{code:n,error:o}=e;!o&&n&&Te.O$(t,n);const{url:r}=Ae.Vr(t);Ke.c4({url:r||p._j.root,environment:t})}async function ft(e){const{route:t,environment:n}=e;let o=t.error?t.errorDescription||N.default.formatMessage((0,D.mO)(t.error),{value:t.error}):void 0;try{if(!t.notionState)throw new Error("No notionState.");const e=JSON.parse(decodeURIComponent(t.notionState));await je.pJ({environment:n}),await je.FD({environment:n,notionState:e})}catch(r){o||(o="An unknown error occurred.")}o&&xe.deprecatedShowErrorMessage(o),Ke.iy(n)}async function gt(e){const{route:t,environment:n,integrationId:o,from:r,options:a}=e;let s=t.error?t.errorDescription||N.default.formatMessage((0,D.mO)(t.error),{value:t.error}):void 0;try{if(!t.state)throw new Error("No state provided.");if(!t.code)throw new Error("No code provided.");Re.j({message:Ge.authenticating});const e=await Ie.authWithExternalIntegration(n,{code:t.code,state:t.state,...t.name===u.AY.datadogAuthCallback?{accountName:t.organizationName,accountId:t.organizationId,accountDomain:t.site}:void 0});if(Re.x(),"failed"===e.type){var l;const t="access_token_retrieval_failed"===(null===(l=e.body)||void 0===l||null===(l=l.clientData)||void 0===l?void 0:l.type)?N.default.formatMessage(Ge.thirdPartyDebugPrefix):void 0;xe.showError(e,t)}else{const{externalObjectInstanceBlockId:t,spaceId:r}=e.data;if(await je.pJ({environment:n}),await je.FD({environment:n,notionState:{externalObjectInstanceBlockId:t,spaceId:r}}),o&&(0,S.z6)(o)){const e=te.Z.bots.state.filter((e=>e.integration_id===o))[0];_e.eR(n,{integration_id:o,configuration_type:"oauth",bot_id:null==e?void 0:e.id})}}}catch(c){s||(s=(0,i.tg)(c).message)}s&&xe.deprecatedShowErrorMessage(s),await async function(e){const{environment:t,integrationId:n,from:o}=e;if(function(e){const{currentUserRootStore:t}=V.default.state;if(!t||!e)return!1;const n=(0,U.Kv)(t,{id:e,table:Z.K2}).getKeyStore("capabilities").getValue();return(0,O.ms)(n)}(n)&&!(0,S.uw)(n)){const{spaceId:e}=await Ae.Ie(t);Ee.g({environment:t,responseType:"code",spaceId:e,integrationId:n,redirectUri:void 0,state:void 0,owner:void 0,userId:void 0})}else"workspace_connections_redirect"!==o&&Ke.iy(t)}({environment:n,integrationId:o,shouldOpenSettings:null==a?void 0:a.shouldOpenSettings,from:r})}async function ht(e,t){const{state:n,password:o,isSignup:r,redirectURL:i,webBrowserDeviceId:a}=e,s=await De.loginWithTemporaryPasscode({environment:t,state:n,password:o,redirectURL:i,webBrowserDeviceId:a,passcodeEnterMethod:"magic_link"});s&&(oe.Z.setState({...oe.Z.state,alert:s}),r?Ke.c4({url:p._j.signup,environment:t}):Ke.c4({url:p._j.login,environment:t}))}async function vt(e,t){const{args:n}=se.getState(),{webBrowserDeviceId:o}=e;n?await De.handleLoginWithTemporaryPasscodeSuccess({environment:t,...n,webBrowserDeviceId:o}):(a.log({level:"error",from:"routerActions",type:"handleLoginSuccessRedirect",data:{message:"empty args for handleLoginSuccessRedirect"}}),Ke.c4({url:p._j.root,environment:t}))}async function bt(e,t){const{state:n,password:o}=e,r=await De.loginPasswordReset({environment:t,csrfState:n,password:o,loginStore:oe.Z});r&&(oe.Z.setState({...oe.Z.state,loginType:"email",alert:r}),Ke.c4({url:p._j.login,environment:t}))}async function yt(e,t){y.In(e);const{userId:n,spaceId:o}=e;if(o){const e=n?[n]:t.currentUser.loggedInUserIds;for(const n of e){const e=new fe.r9(t,{table:b.dx,id:n},{userId:n});await e.load();const r=e.getSpaceViewStores();if(r.length>0){await Promise.all(r.map((e=>e.load())));const e=r.find((e=>e.getSpaceId()===o));if(e)return void(await Le.ce({environment:t,spaceViewStore:e}))}}}const{currentUserRootStore:r}=V.default.state;if(r){await r.load();const e=r.getSpaceViewStores().find((e=>{var t;return Boolean(null===(t=e.getSpaceStore())||void 0===t?void 0:t.canRead())}));if(e)return void(await Le.ce({environment:t,spaceViewStore:e}))}Ke.c4({environment:t,url:p._j.login,redirect:!0})}function _t(e,t,n){if((0,j.Sr)()){const t=k.TW({publicDomainName:A.default.publicDomainName},window.location.host);Ce.qY({spaceDomain:t,environment:e})}else!e.currentUser.isLoggedIn()||null!=n&&n.doNotRedirectWhenLoggedIn?Se.Sn(e,t):Ke.c4({environment:e,url:p._j.root,redirect:!0})}async function St(e,t){var n;const r=e.currentUser.id;if(!r)return void Mt(e);const i=new fe.r9(e,{table:b.dx,id:r},{userId:r});await i.load();const a=null===(n=i.getSpaceViewStores())||void 0===n?void 0:n[0].getSpaceId();if(!a)return void Mt(e);const s=await Ie.getIdFromUniqueId(e,{spaceId:a,uniqueId:t});if("failed"===s.type||!s.data.id)return void Mt(e);const l=s.data.id,c=fe.G.createChildStore(i,{table:m.iU,id:l});await c.load(),He.r({environment:e,store:c,pageVisitSource:o.tY.Direct})}async function wt(e){const{environment:t,route:n}=e;Ke.c4({environment:t,url:p._j.root,redirect:!0});const[{favoriteImportActions:o}]=await Promise.all([T.E0.loader(),async()=>{await V.default.waitUntil((()=>void 0!==V.default.state.currentUserSettingsStore&&void 0!==V.default.state.currentSpaceStore&&void 0!==V.default.state.currentSpaceViewStore&&void 0!==V.default.state.currentUserRootStore)),await V.default.waitUntilRendered()}]);await o.importGtmFavorite({environment:t,importArgs:n})}async function kt(e,t){const n=Ve.I6({environment:e,request:{type:"invite-link",inviteLinkCode:t}}),r=(await n.next()).value;X.Z.setState({publicPageData:r});const a=()=>{_.Z.set(H.WX,t),Ke.T4(e)};if(e.currentUser.isLoggedIn()&&r.spaceId){const{id:n}=e.currentUser;if(n){const l=new fe.U6(e,{table:v.KJ,id:n});await l.load();if(!l.getFullName(N.default.getIntl())){a();const t=await(0,z.iX)({environment:e,disableRedirectUrl:!1});return void(await q.I1(e,{type:"new-user",redirectUrl:t.redirectUrl}))}const c=new fe.r9(e,{table:b.dx,id:n});await c.load();try{const n=await Le.j({environment:e,userRootStore:c,userSettingsStore:void 0,spaceId:r.spaceId,navigate:!1,analyticsFrom:"redirect",inviteCode:t});await Le.y3({environment:e,spaceViewStore:n.spaceViewStore,userSettingsStore:void 0,userRootStore:c,pageVisitSource:o.tY.SwitchSpace,navigationType:"joiningOrCreatingSpace"})}catch(s){const{currentUserRootStore:t,currentUserSettingsStore:n}=V.default.state,r=t&&n;xe.showMessage({message:(0,i.tg)(s).message,acceptLabel:r?N.default.formatMessage(Ge.backToContent):N.default.formatMessage(Ge.goBack),onAccept:()=>{_.Z.remove(H.WX),r?Le.L5({environment:e,userRootStore:t,userSettingsStore:n,pageVisitSource:o.tY.Onboarding}):Ke.op(e)}})}}}else a()}async function It(e){await De.actuallyLogoutAndDeleteMostLocalData({environment:e,logoutOrigin:s.F.LogoutRouteVisited})}async function Ct(e,t){const{mainEditorCurrentBlockStore:n}=V.default.state;if(n&&"page"===t.name&&t.scrollToBlockId&&t.discussionId){const o=fe.G.createChildStore(n,{table:m.iU,id:t.blockId}),r=(0,fe.Kv)(o,{table:f.qF,id:t.discussionId,spaceId:(0,g.C)(o.pointer.spaceId)});await r.load(),r.getKeyStore("resolved").getValue()&&($.setUpdateExpand({environment:e,isExpanded:!0,from:"resolved_comment"}),$.setUpdateSidebarCommentsMode(Y.F7.Resolved))}}async function xt(e,t){"configureOpenInDesktopApp"in t&&t.configureOpenInDesktopApp&&(await ee.default.waitUntilStatsigReady(),e.device.isDesktop&&e.device.isBrowser&&(e.device.isMac||e.device.isWindows)&&ve.Z.setState({open:!0,openedFrom:"misc",currentTab:"user_settings",defaultSubtab:void 0,highlightedSetting:ve.R.OpenInDesktopApp}))}function Tt(e){let t;try{t=k.$U((0,B.W)(window.location.href))}catch{}t&&Ke.c4({environment:e,url:t})}function Mt(e){const t={name:"notFound"};e.RouterStore.setState({id:(0,c.ZP)(),route:t,action:"push",initialRoute:e.RouterStore.state.initialRoute||t})}function Pt(e){Ke.c4({environment:e,url:p._j.root,redirect:!0})}async function At(e){const t=(0,k.Ph)(window.location.href,"pvs"),n=e.currentUser.id;if(!n||e.device.isMobileNative)return void Pt(e);const r=await Ie.getHomeEnabledSpaceViews(e,{});if("failed"===r.type)return void Pt(e);const{usersToSpaceViews:i}=r.data,a=[],s=new fe.r9(e,{table:b.dx,id:n});for(const o of Object.values(i)){const t=d.PF.create(o.recordMap);Ue.fL({environment:e,userId:n,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:t,debugSource:"handleHomeRedirect"}),a.push(...o.homeEnabledSpaceViewIds.map((e=>fe.V9.createChildStore(s,{table:h.zU,id:e}))))}const{spaceId:l}=await Ae.Ie(e),c=G.Al(function(e){let{currentUserId:t,lastVisitedSpaceId:n,homeEnabledSpaceViewStores:o}=e;const r=n&&o.find((e=>e.getSpaceId()===n&&e.getParentId()===t));if(r)return r;const i=o.find((e=>e.getParentId()===t));if(i)return i;return o[0]}({currentUserId:n,lastVisitedSpaceId:l,homeEnabledSpaceViewStores:a}));if(!c)return void Pt(e);const u=t?Number(t):o.tY.PersonalHomeLink;(0,K.$X)({environment:e,from:u===o.tY.PersonalHomeEmailLink?"email_link":"link"}),ze._({environment:e,store:c,pageVisitSource:u})}},21862:(e,t,n)=>{n.d(t,{r:()=>u});var o=n(15157),r=n(72126),i=n(63143),a=n(35683),s=n(98165),l=n(80444),c=n(75754);const d=10;function u(e){const{store:t,openInNew:n,environment:u,pageVisitSource:m,openInSidePeek:f}=e,{currentSpaceStore:g}=l.default.state;if(!t.isDefined())return;const h=t.isNavigableBlock(),{page:v,block:b}=h?{page:t,block:void 0}:{page:s.Dg(t),block:t};v&&(!b&&g&&function(e){let{currentUserId:t,spaceId:n,blockId:a}=e;const s=function(e){let{currentUserId:t,spaceId:n}=e;const r=o.Z.get({userId:t,key:p(n)});if(r){const e=(0,i.dj)(r);return Array.isArray(e)?e:[]}return[]}({currentUserId:t,spaceId:n}),l=r.jj([a,...s]).slice(0,d);o.Z.set({userId:t,key:p(n),value:JSON.stringify(l)})}({currentUserId:u.currentUser.id,spaceId:g.id,blockId:v.id}),c._({environment:u,store:v,scrollToBlockId:b&&b.id,openInNew:n,visitType:a.vu.Search,pageVisitSource:m,queryId:e.queryId,openInSidePeek:f}))}function p(e){return`recentQuickJumps:${e}`}},26999:(e,t,n)=>{n.d(t,{CH:()=>d,OW:()=>p,Qk:()=>u});var o=n(15145),r=n(84210),i=n(80444),a=n(88923),s=n(92973),l=n(99553),c=n(8055);function d(e){const{environment:t,store:n,peekMode:o,openInNew:s,showMoveTo:d,saveParent:u,resultsStore:p,collectionContextStore:m,pageVisitSource:f}=e,g=e.currentBlockStore??i.default.state.mainEditorCurrentBlockStore;if(!g)return;const h=Boolean(s)||"full_page"===o?(0,r.Hu)({store:n,fullyQualified:!1,showMoveTo:d,saveParent:u,pageVisitSource:f}):(0,r.Hu)({store:g,peekViewBlockId:n.id,peekMode:(0,a.getUrlParamFromPeekMode)(o),fullyQualified:!1,showMoveTo:d,saveParent:u,pageVisitSource:f});c.c4({environment:t,url:h,openInNew:s}),l.Af({resultsStore:p,collectionContextStore:m,pageVisitSource:f})}function u(){const{resultsStore:e}=a.default.state,t=null==e?void 0:e.getState();if(a.default.state.open&&t){const{target:e}=a.default.state,n=t.findIndex((t=>t.id===e.id)),{mainEditorCurrentBlockStore:l}=i.default.state;if(l&&n>0){const e=(0,r.Hu)({store:l,fullyQualified:!1,peekViewBlockId:t[n-1].id,peekMode:(0,a.getUrlParamFromPeekMode)(a.default.state.mode),pageVisitSource:o.tY.PeekScroll});c.c4({environment:l.environment,url:e}),s.zP(l.environment,{direction:"up"})}}}function p(){const{resultsStore:e}=a.default.state,t=null==e?void 0:e.getState();if(a.default.state.open&&t){const{target:e}=a.default.state,n=t.findIndex((t=>t.id===e.id)),{mainEditorCurrentBlockStore:l}=i.default.state;if(l&&n<t.length-1){const e=(0,r.Hu)({store:l,fullyQualified:!1,peekViewBlockId:t[n+1].id,peekMode:(0,a.getUrlParamFromPeekMode)(a.default.state.mode),pageVisitSource:o.tY.PeekScroll});c.c4({environment:l.environment,url:e}),s.zP(l.environment,{direction:"down"})}}}},69915:(e,t,n)=>{n.d(t,{tc:()=>c,yF:()=>l});n(82801);var o=n(4615),r=n(97978),i=n(12955),a=n(80444),s=n(8055);async function l(e,t){const{utmContent:n,nextRoute:o}=t,[r,i]=await Promise.all([c(e),d(e,{utmContent:n,utmSource:"public_page"})]);s.Li({environment:e,url:o,extraSearchParams:{...r,...i}})}async function c(e){const t=await i.getPartnerStackCookie(e);if(t){return{gspk:window.btoa(t)}}const n=await i.getS2STrackingCookie(e);if(n&&n.partnerKey){return{ps_partner_key:window.btoa(n.partnerKey),ps_xid:n.clickId}}return{}}async function d(e,t){const{utmContent:n,utmSource:i}=t,s={utm_source:i,utm_content:n,tid:await(0,r.cG)(e)},{mainEditorCurrentBlockStore:l}=a.default.state;return null!=l&&l.id&&(s.utm_campaign=(0,o.F9)(null==l?void 0:l.id)),s}},65729:(e,t,n)=>{n.d(t,{A:()=>a,j:()=>i});var o=n(15157);const r="queryParamsRedirect";function i(e){let{currentUserId:t,params:n}=e;o.Z.set({userId:t,key:r,value:n})}function a(e){return o.Z.get({userId:e,key:r})}},8055:(e,t,n)=>{n.d(t,{CZ:()=>$,LU:()=>X,Li:()=>j,Oj:()=>H,RX:()=>G,T4:()=>q,c4:()=>z,eH:()=>Y,iy:()=>te,j7:()=>K,op:()=>Q,up:()=>J});n(21703);var o=n(1302),r=n(27328),i=n(15145),a=n(72126),s=n(71644),l=n(99405),c=n(89101),d=n(32739),u=n(97880),p=n(64002),m=n(95477),f=n(97978),g=n(98165),h=n(18514),v=n(18245),b=n(95802),y=n(74948),_=n(24646),S=n(38676),w=n(36391),k=n(5162),I=n(80444),C=n(88923),x=n(79797),T=n(87956),M=n(32441),P=n(51787),A=n(2449),R=n(47839),D=n(47678),E=n(94273),B=n(3898),F=n(29974),O=n(75754),Z=n(12714),V=n(32953),U=n(91100),N=n(1357);const L=[`${i.tY.MentionInPage}`,`${i.tY.LinkInPage}`,`${i.tY.PeekOpen}`,`${i.tY.Expand}`,`${i.tY.Duplicate}`,`${i.tY.Move}`];function j(e){const t=function(e,t){try{const n=e.startsWith("/")?new URL(e,m.default.domainBaseUrl):new URL(e);if(t)for(const[e,o]of Object.entries(t))n.searchParams.append(e,o);return n.pathname+n.search+n.hash}catch{throw new Error(`${e} is neither a URL nor an absolute path`)}}(e.url,e.extraSearchParams);return z({...e,url:`${m.default.domainBaseUrl}${t}`})}function z(e){var t,n;const{environment:o,openInNew:r,frontPreserveScrollPosition:i,queryId:a,callback:c}=e,{RouterStore:f,currentUser:g}=o,h=g.id,{savedSidebarExpandedStoreState:b}=C.default.state;b&&S.sidebarExpandedStore.setState(!0);const k=l.Wj({url:e.url,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,isMobile:o.device.isMobile,protocol:m.default.protocol,currentUrl:window.location.href}),{redirect:x,updateMobileTabbedRouterArgs:D}=W(e,k),E=p.gy(window.location.href),B=p.gy(e.url),F=Boolean((null==B?void 0:B.hostname)&&B.hostname!==(null==E?void 0:E.hostname));if("external"===k.name||F)return void Z.D({environment:o,url:e.url,targetSelf:F});const O=d.u5({schemeUrl:e.url,baseUrl:m.default.domainBaseUrl}),N=p.T1(e.url);if("tab"===r)return void(o.device.isElectron&&"page"===k.name?R.openInNewTab({url:N,position:"after-children"}):Z.D({environment:o,url:O}));if("window"===r&&o.device.isElectron&&"page"===k.name)return void R.openInNewWindow(N);const j=f.state.route;if("quickSearch"===j.name&&o.device.isElectron)return void R.openQuickSearchResult(N);const z="page"===j.name&&"page"===k.name&&j.blockId===k.blockId,q="page"===j.name&&"page"===k.name&&j.spaceDomain!==k.spaceDomain&&(j.requestedOnPublicDomain||k.requestedOnPublicDomain),K=o.AppUpdateStore.state.appUpdate;if(!z&&!e.redirect&&A.cM(o,K))return void A.hC({environment:o,url:N,version:K.version});if(x||z||(V.Vz({historyId:f.state.id,currentUserId:h}),(0,_.Sx)(o)&&(y.setUpdateExpand({environment:o,isExpanded:!1,from:"close_for_space"}),w.ZP.update((e=>({...e,canRender:!1}))))),V.LU(o),q)return void Z.D({environment:o,url:e.url,targetSelf:!0});const G=(0,s.ZP)();x?window.history.replaceState({id:G,currentUserId:o.currentUser.id},void 0,N):window.history.pushState({id:G,currentUserId:o.currentUser.id},void 0,N);const $=V.M3({historyId:f.state.id,currentUserId:h});V.UV({historyId:G,historyIndex:x?$:$+1,currentUserId:h}),"pageVisitSource"in k&&(0,u.DE)(L,k.pageVisitSource)&&M.BR(o,j,k),!z&&"page"===j.name&&T.Z.state&&(null===(t=T.Z.state)||void 0===t?void 0:t.pageId)===j.blockId&&P.Eb(o,T.Z.state),U.e({environment:o,id:G,action:x?"replace":"push",href:N,updateMobileTabbedRouterArgs:D}).then((()=>{"page"===k.name&&!z&&a?T.Z.setState({queryId:a,pageId:k.blockId,timeEntered:new Date}):T.Z.reset()})).then((()=>{c&&c()}));(z||"nativeTab"===j.name&&"page"===k.name&&(null===(n=I.default.state.mainEditorCurrentBlockStore)||void 0===n?void 0:n.id)===k.blockId)&&H(o),!i&&window.scrollTo(0,0),v.default.markEitherOf(["navigation_page_render","navigation_database_render"]),v.default.mark("initial_page_render_after_login")}function q(e){z({environment:e,url:c._j.onboarding})}async function H(e){const{RouterStore:t}=e,n=I.default.state.mainEditorCurrentBlockStore;if(n&&"page"===t.state.route.name){if(t.state.route.scrollToBlockId){const e=[t.state.route.scrollToBlockId];0===a.oA(b.C.findSelectablesFromIds(e)).length&&(await B.Nz(n,e),await o.default.afterNextFlush())}D.Y(e)}}const W=function(e,t){const n={redirect:e.redirect,updateMobileTabbedRouterArgs:e.updateMobileTabbedRouterArgs};return h.__(e.environment)?("login"!==t.name&&"logout"!==t.name&&"onboarding"!==t.name||(n.redirect=!0,n.updateMobileTabbedRouterArgs={...n.updateMobileTabbedRouterArgs,clearNativeRootPageOverride:!0}),n):n};function K(e){var t;const{environment:n,url:o}=e;if(!h.__(n))return;const{TabbedRouterStore:i}=n,a=(0,r.w_)(i.state);if("web"!==a.type)return;const s=l.Wj({url:o,baseUrl:m.default.domainBaseUrl,publicDomainName:m.default.publicDomainName,isMobile:n.device.isMobile,protocol:m.default.protocol,currentUrl:window.location.href}),c=(null===(t=a.redirectedTo)||void 0===t?void 0:t.route)??a.route;if(s.name!==c.name)return;const d=p.T1(e.url);a.redirectedTo?(a.redirectedTo.route=s,a.redirectedTo.url=d):(a.route=s,a.url=d)}async function G(e){const{environment:t,url:n}=e,o=p.T1(n);t.device.isNative?z({url:o,environment:t}):window.location.href=p.SK(d.NV({httpUrl:o,protocol:m.default.protocol}),{di:await(0,f.cG)(t)})}async function $(e){const{environment:t,blocks:n}=e,{mainEditorCurrentBlockStore:o,currentSpaceViewStore:r,currentUserSettingsStore:a,currentUserRootStore:s}=I.default.state,l=o&&n.find((e=>e.id===o.id));if(l&&r){const e=g.Dg(l,1);(0,k.Y)("supportsNativeHome")?h.NW(t)?Q(t):N.d(t):e?O._({environment:t,store:e,pageVisitSource:i.tY.LeaveOrRemove}):await F.y3({environment:t,spaceViewStore:r,userSettingsStore:a,userRootStore:s,pageVisitSource:i.tY.LeaveOrRemove,navigationType:"switchingToOrLoadingSpace"})}Boolean(n.find((e=>{var t;return e.id===(null===(t=C.default.peekTarget.state)||void 0===t?void 0:t.id)})))&&o&&O._({environment:t,store:o,pageVisitSource:i.tY.LeaveOrRemove})}const Q=function(e){h.__(e)?ee(e):window.history.back()},Y=function(){window.history.forward()},X=function(){const e=I.default.state.mainEditorCurrentBlockStore;return!!e&&!!g.Dg(e,1)},J=function(e){const t=I.default.state.mainEditorCurrentBlockStore;if(!t)return;const n=g.Dg(t,1);n&&O._({environment:e,store:x.G.createChildStore(n,n.pointer),pageVisitSource:i.tY.Breadcrumb})},ee=function(e){const{TabbedRouterStore:t}=e,n=t.state,o=(0,r.Os)(n);if(!o)return;const i=o.type;"native"===i?t.updateWithNativePage({page:o,clearPages:!1,navigationAction:"pop",navigationSource:"mobile-back-navigation"}):"web"===i?window.history.back():(0,u.t1)(i)};function te(e){const{url:t}=E.Vr(e);z({url:t||c._j.root,environment:e})}},32219:(e,t,n)=>{n.r(t),n.d(t,{getInitialPage:()=>d,initialize:()=>c});var o=n(71644),r=n(72128),i=n(18514),a=n(5162),s=n(32953),l=n(91100);const c=async function(e){const t=window.history.state&&window.history.state.id||(0,o.ZP)();if(!window.history.state){const n=e.currentUser.id;window.history.replaceState({id:t,currentUserId:n},void 0,window.location.href),s.UV({historyId:t,historyIndex:0,currentUserId:n})}i.__(e)&&e.TabbedRouterStore.setUp({nativeInboxEnabled:(0,a.Y)("supportsNativeInbox")}),await l.e({environment:e,id:t,action:"pop",href:window.location.href,updateMobileTabbedRouterArgs:{forceUpdate:!0,silenceErrors:!0,clearNativeRootPageOverride:"/"!==window.location.pathname},enableDesktopAppRedirect:!0});const n=e.currentUser.id,c=d(n);if(!c||"undefined"===c){const e=window.location.pathname;e&&function(e){let{currentUserId:t,value:n}=e;r.Z.set({userId:t,key:"sourceInitialPage",value:n})}({currentUserId:n,value:e})}};function d(e){return r.Z.get({userId:e,key:"sourceInitialPage"})}},91100:(e,t,n)=>{n.d(t,{e:()=>O});var o=n(17673),r=n(50112),i=n(15157),a=n(29477),s=n(90850),l=n(99405),c=n(89101),d=n(7678),u=n(9852),p=n(93724),m=n(12139),f=n(64002),g=n(95477),h=n(78873),v=n(18514),b=n(77907),y=n(84437),_=n(80444),S=n(21273),w=n(77080),k=n(73796),I=n(45946),C=n(70060),x=n(88280),T=n(22500),M=n(32441),P=n(86572),A=n(35793),R=n(91376),D=n(87531),E=n(39634),B=n(31120),F=n(8055);async function O(e){const{id:t,action:n,href:O,environment:V,updateMobileTabbedRouterArgs:U}=e,{RouterStore:N,currentUser:L,TabbedRouterStore:j}=V,z=(null==U?void 0:U.restoringTab)||!1,[q,H]=l.DP({url:O,isMobile:V.device.isMobile,baseUrl:g.default.domainBaseUrl,publicDomainName:g.default.publicDomainName,protocol:g.default.protocol,currentUrl:window.location.href});m.FB(q.name),p.setRouteTags(q,H);const W=N.state.route,K=i.Z.get({userId:L.id,key:t});if(N.setState({id:t,historyState:K,action:n,route:q,initialRoute:N.state.initialRoute||q}),null!=U&&U.forceUpdate||v.__(V)&&!z){const e={type:"web",url:f.T1(O),route:q};j.updateWithWebPage({page:e,action:null!=U&&U.forceUpdate?"replace":n,updateMobileTabbedRouterArgs:U})}const G=f.Qc(O),$=G.query[d.Vt];$&&(0,s.Zj)({currentUserId:L.id,promoCode:$});const Q=G.query[r.gS];Q&&((0,u.ob)(Q),Z(r.gS)),"page"===q.name||l.KV[q.name]||M._W(V,O);const{target:Y,subtarget:X}=function(e){if(!e)return{target:void 0};const t=null==e?void 0:e.indexOf(".");if(-1===t)return{target:e};return{target:e.substring(0,t),subtarget:e.substring(t+1)}}(G.query.target);if("intercom"===Y)E.j({environment:V,from:"query_param"}),Z("target");else if(V.device.isMobileBrowser&&"plans"===Y){if(await w.default.waitUntilStatsigReady(),(0,C.bQ)()){const e=await b.deps.payments.loader();await _.default.waitUntil((()=>void 0!==_.default.state.currentSpaceStore)),await _.default.waitUntilRendered();const t=_.default.state.currentSpaceStore;e.plans.canShowPlans(t)&&e.plans.showPlans({environment:V,from:"deeplink"}),Z("target")}}else if(V.device.isMobileBrowser&&"billing"===Y){if(await w.default.waitUntilStatsigReady(),(0,C.bQ)()){const e=await b.deps.payments.loader();await _.default.waitUntil((()=>void 0!==_.default.state.currentSpaceStore)),await Promise.all([_.default.waitUntilRendered(),x.subscriptionDataStoreInstance.waitUntilLoaded()]);const t=_.default.state.currentSpaceStore,n=x.subscriptionDataStoreInstance.state;t&&n&&e.billing.canShowBilling({subscriptionData:n,spaceStore:t})&&e.billing.showBilling({environment:V,from:"deeplink"}),Z("target")}}else"billing"===Y||"plans"===Y||"members"===Y||"audit_log"===Y||"connected_apps"===Y||"identity_provisioning"===Y||"analytics"===Y||"admin_content_search"===Y||"profile"===Y||"notifications_and_settings"===Y||"user_settings"===Y||"notifications"===Y||"language_and_region"===Y||"settings"===Y||"integrations"===Y||"sites"===Y||"imports"===Y?(R.r$({currentTab:Y,subtab:X,isMobile:V.device.isMobile,openedFrom:"email"}),Z("target")):"contact_us"===Y?(k.Z.setState({open:!0}),Z("target")):"quickfind"===Y?(Promise.race([async()=>{await _.default.waitUntil((()=>void 0!==_.default.state.currentUserSettingsStore&&void 0!==_.default.state.currentSpaceStore&&void 0!==_.default.state.currentSpaceViewStore&&void 0!==_.default.state.currentUserRootStore)),await _.default.waitUntilRendered(),D.UT({environment:V,analyticsFrom:"deeplink"})},a.Vs(1500).then((()=>{D.UT({environment:V,analyticsFrom:"deeplink"})}))]),Z("target")):"qna"===Y&&(Promise.race([(async()=>{if(await _.default.waitUntil((()=>void 0!==_.default.state.currentUserSettingsStore&&void 0!==_.default.state.currentSpaceStore&&void 0!==_.default.state.currentSpaceViewStore&&void 0!==_.default.state.currentUserRootStore)),await _.default.waitUntilRendered(),!S.Z.isQnaRightSideDeeplinkEnabled()||S.Z.isQnATooltipsVisible(V.device,_.default.state.currentUserSettingsStore))return!1;const e=await b.deps.assistant.loader();return await e.assistantMenuActions.openAssistantRightHandSideMenu({environment:V,from:"deeplink"}),!0})(),(async()=>{if(!S.Z.isQnaRightSideDeeplinkEnabled())return!1;await a.Vs(1500);const e=await b.deps.assistant.loader();return await e.assistantMenuActions.openAssistantRightHandSideMenu({environment:V,from:"deeplink"}),!0})()]),Z("target"));if("googleOneTapRedirect"===q.name)return void B.ST(V,{code:q.code,frontPathName:q.frontPathName});if("samlAuthCallback"===q.name)return void B.rH(q,V);if("appleAuthCallback"===q.name)return void B.fE(q,V);if("googleAuthCallback"===q.name)return void B.E4(q,V);await w.default.waitUntil((()=>w.default.state.isLoaded));const J=f.T1(O),ee=o.parse(J.split("?")[1]||"");if("settingsConsoleDefault"===q.name)return await w.default.waitUntilStatsigReady(),w.default.checkGate("admin_console_enabled")?void F.c4({environment:V,url:c._j.settingsConsoleWorkspace,redirect:!0}):void F.c4({environment:V,url:c._j.root,redirect:!0});if("settingsConsoleOrganization"!==q.name||(await w.default.waitUntilStatsigReady(),w.default.checkGate("admin_console_enabled")))if("settingsConsoleWorkspace"!==q.name||(await w.default.waitUntilStatsigReady(),w.default.checkGate("admin_console_enabled")))if(e.enableDesktopAppRedirect&&function(e){const{route:t}=e.RouterStore.state;return l.c$[t.name]&&"always"===I.Z.state&&e.device.isDesktop&&e.device.isBrowser&&(e.device.isMac||e.device.isWindows||!1)&&(!("configureOpenInDesktopApp"in t)||!t.configureOpenInDesktopApp)}(V))B.FA(V);else{if("root"===q.name){const e={templateGalleryItem:q.templateGalleryItem,projectManagementLaunch:"true"===(Array.isArray(ee.pjm)?ee.pjm[0]:ee.pjm)};B.nN(q,V,e)}else if("onboarding"===q.name)B.uO(V);else if("modal"===q.name)if(V.currentUser.isLoggedIn()){let e="/";q.projectManagementLaunch?e+="?tg=gallery":q.templateGalleryItem&&(e+=`?tg=${q.templateGalleryItem}`),F.c4({environment:V,url:e,redirect:!0})}else F.c4({environment:V,url:c._j.login,redirect:!0});else if("googleDriveAuthCallback"===q.name)B.LW(q,V);else if("slackAuthCallback"===q.name)B.YU({route:q,environment:V});else if(q.name===l.AY.datadogAuthCallback)B.wN({route:q,environment:V});else if("externalAuthCallback"===q.name)B.xp({route:q,environment:V});else if(q.name===l.AY.authCallback)B.wN({route:q,environment:V});else if("loginWithEmailCallback"===q.name)B.kd(q,V);else if("loginSuccessCallback"===q.name)B.OO(q,V);else if("passwordResetCallback"===q.name)B.KR(q,V);else if("passwordChangeRedirect"===q.name)F.Li({environment:V,url:c._j.login}),h.E({environment:V});else if("logout"===q.name)B.hY(V);else if("login"===q.name||"signup"===q.name){B.HB(V,O),Boolean(ee.showNotionCalendarModal)&&y.N$();const e={doNotRedirectWhenLoggedIn:Boolean(ee.newSignup)};B.wo(V,q.name,e)}else if("oauthAuthorization"===q.name)B.r$(q,V);else if("page"===q.name||"space"===q.name)B.HB(V,O),B.pN(V,q.state),A.Uz({nextRoute:q,currentRoute:W,environment:V,query:J}),B.Z_(V,q),await B.JW(V,q);else if("templatesRedirect"===q.name)F.c4({environment:V,url:(0,v.UY)("templateGallery"),redirect:!0});else if("communityRedirect"===q.name)F.c4({environment:V,url:(0,v.UY)("community"),redirect:!1});else if("guideRedirect"===q.name)F.c4({environment:V,url:(0,v.UY)("guides.guides"),redirect:!0});else if("invoiceRedirect"===q.name)F.c4({environment:V,url:c._j.root,redirect:!0});else if("termsRedirect"===q.name)F.c4({environment:V,url:(0,v.UY)("terms"),redirect:!0});else if("contentPolicyRedirect"===q.name)F.c4({environment:V,url:(0,v.UY)("contentPolicy"),redirect:!0});else if("uiDoc"===q.name)F.c4({environment:V,url:c._j.root,redirect:!0});else if("exportPreview"===q.name)F.c4({environment:V,url:c._j.root,redirect:!0});else if("admin"===q.name)g.default.isAdminMode||F.c4({environment:V,url:c._j.root,redirect:!0});else if("teamInvite"===q.name)B.cQ(V,q.inviteCode);else if("teamsInvite"===q.name)V.currentUser.isLoggedIn()||F.c4({environment:V,url:c._j.signup,redirect:!0});else if("aiGtmFavoriteImport"===q.name)B.Rd({environment:V,route:q});else if("new"===q.name)B.HR(V,q);else if("myIntegrations"===q.name)B.WC(V);else if("inAppTemplateSubmission"===q.name||"inAppTemplateCreatorSubmission"===q.name)B.Mj(V);else if("studentGroupSignup"===q.name)V.currentUser.isLoggedIn()||F.c4({environment:V,url:c._j.login});else if("unknown"===q.name)F.c4({environment:V,url:c._j.root,redirect:!0});else if("nativeTab"===q.name)B.o9(V,q,W,n);else if("quickSearch"===q.name)await B.D_(V,q,W);else if("chat"===q.name)B.dH(V,q,W);else if("workspaceSetup"===q.name)B.yD(V,q,W);else if("uniqueId"===q.name)await B.AL(V,q.uniqueId);else if("signupWithTrial"===q.name){const e=q.trialUpsell;(0,T.zQ)(e,V),(0,T.O1)(e)&&P.ms(V,{source:e}),F.c4({environment:V,url:c._j.signup,redirect:!0})}else"home"===q.name&&B.Z1(V);l.kd(q)&&(B.td(V,q,J),B.OP(V,q))}else F.c4({environment:V,url:c._j.root,redirect:!0});else F.c4({environment:V,url:c._j.root,redirect:!0})}function Z(e){const t=f.T1(f.iO(window.location.href,e));window.history.replaceState(history.state,void 0,t)}},40468:(e,t,n)=>{n.d(t,{P:()=>c,T:()=>l});var o=n(33147),r=n(35683),i=n(97638),a=n(75754),s=n(21862);const l=new o.Z;function c(e){const{searchResult:t,environment:n,openInNew:o,pageVisitSource:l,queryId:c,openInSidePeek:d}=e,{store:u}=t,p=(0,i.dy)(t);void 0===p?s.r({store:u,openInNew:o,environment:n,pageVisitSource:l,queryId:c,openInSidePeek:d,peekMode:d?"s":void 0}):a._({environment:n,store:u,scrollToBlockId:p,openInNew:o,visitType:r.vu.Search,pageVisitSource:l,queryId:c,openInSidePeek:d,peekMode:d?"s":void 0})}},1357:(e,t,n)=>{n.d(t,{S:()=>b,d:()=>y});n(57658);var o=n(27328),r=n(72126),i=n(71644),a=n(99405),s=n(95477),l=n(18514),c=n(80444),d=n(3418),u=n(36610),p=n(19719),m=n(82530),f=n(39865),g=n(8055),h=n(40468);const v=function(e){return"web"===e.type&&"nativeTab"===e.route.name&&"search"===e.route.tab};function b(e){var t,n,d;const{environment:b,tab:y,navigationAction:_,navigationSource:S}=e,{TabbedRouterStore:w,currentUser:k}=b;if(!l.__(b))return;"updates"!==y&&p.nI(b);const I=w.state.activeTab,C=(0,o.w_)(w.state),x=r.Xh(w.state);x.activeTab=y,x.navigationAction=_,x.navigationSource=S,void 0!==e.nativeRootPageOverrideEnabled&&(x.tabs[x.activeTab].nativeRootPageOverrideEnabled=e.nativeRootPageOverrideEnabled);let T=!1;if(void 0!==e.pages){const t=e.pages.map((e=>{const t=(0,o.Gt)(e,!0),n=a.Wj({url:t,baseUrl:s.default.domainBaseUrl,publicDomainName:s.default.publicDomainName,isMobile:b.device.isMobile,protocol:s.default.protocol,currentUrl:window.location.href});return{...e,route:n}})),n=x.tabs[x.activeTab].pages;T=!r.Xy(n,t),x.tabs[x.activeTab].pages=t}if(v(C)&&!v((0,o.w_)(x))&&h.T.emit(Date.now()),w.setState(x),w.state.activeTab===I&&!T)return;const M=c.default.state.mainEditorCurrentBlockStore,P="web"===C.type&&(null===(t=C.redirectedTo)||void 0===t?void 0:t.route)&&"page"===(null===(n=C.redirectedTo)||void 0===n?void 0:n.route.name)&&(null===(d=C.redirectedTo)||void 0===d?void 0:d.route.showMoveTo),A=M&&(null==M?void 0:M.canEdit())&&M.isEmptyTitle()&&M.isEmptyPage();"addPage"===I&&P&&A&&k.isLoggedIn()&&m.createAndCommit({userAction:"routerActions.navigateToTab",environment:b,perform:e=>{f.y8({environment:b,blocks:[M],transaction:e}),e.postSubmitCallbacks.push((e=>{e||u.dh(b,{analyticsName:"delete",from:"mobile_navigation",block_id:M.id,block_type:"page"})}))}});const R="addPage"===y,D=w.state.tabs[y],{rootPage:E,pages:B}=D;let F=!1;switch(E.type){case"native":break;case"web":if(0===B.length||R)g.c4({environment:b,redirect:!0,url:(0,o.Gt)(E,!0,{...e.queryParams,from:"mobile_bottom_bar"}),updateMobileTabbedRouterArgs:{restoringTab:!0}});else{F=!0;const e=(0,i.ZP)();window.history.replaceState({id:e,currentUserId:b.currentUser.id},void 0,(0,o.Gt)(E))}}if(R)return;const O=!0===x.tabs[x.activeTab].nativeRootPageOverrideEnabled;B.forEach(((e,t)=>{if(!O&&t===B.length-1)return void g.c4({environment:b,redirect:!F,url:(0,o.Gt)(e),updateMobileTabbedRouterArgs:{restoringTab:!0}});const n=(0,i.ZP)(),r=(0,o.Gt)(e);F?window.history.pushState({id:n,currentUserId:b.currentUser.id},void 0,r):(F=!0,window.history.replaceState({id:n,currentUserId:b.currentUser.id},void 0,r))}))}function y(e,t){var n,o;if(l.__(e))return e.device.isMobileNative&&e.device.isAndroid&&d.Z.closeAll(),b({environment:e,tab:"home",nativeRootPageOverrideEnabled:!0}),void(t&&t());Boolean(null===(n=e.mobileNative)||void 0===n?void 0:n.supportsNativeHomeOnPhone())&&(null===(o=e.mobileNative)||void 0===o||o.showNativeHomeTab(t))}},3898:(e,t,n)=>{n.d(t,{Nz:()=>g,uE:()=>p});var o=n(72126),r=n(21202),i=n(98165),a=n(52315),s=n(35328),l=n(80444),c=n(79797),d=n(15690),u=n(29373);function p(e){const t=e.state;return"page"===t.route.name&&t.route.scrollToBlockId?[t.route.scrollToBlockId]:t.historyState?t.historyState.blockIds:[]}function m(e,t){const n=function(e,t){const n=t.map((t=>c.G.createChildStore(e,{table:r.iU,id:t}))).map((e=>i.qA(e))).filter((t=>{let n=!1;const o=t.slice(1).find((e=>{if("block"===e.table)return e.isTransclusionType()&&(n=!0),e.isNavigableBlock()}));return o&&(o.id===e.id||n)})).map((e=>{const t=e.findIndex((e=>"block"===e.table&&e.isNavigableBlock()));return e.slice(1,t).filter((e=>"block"===e.table&&(0,s.BX)(e)))}));return o.mN(o.xH(n),(e=>e.id))}(e,t);for(const o of n)u.rd({blockId:o.id,state:!0,currentUserId:o.environment.currentUser.id});return n}function f(e,t){const n=function(e,t){const n=t.map((t=>c.G.createChildStore(e,{table:r.iU,id:t,spaceId:e.pointer.spaceId}))).map((e=>i.qA(e))).filter((t=>{const n=t.slice(1).find((e=>"block"===e.table&&e.isNavigableBlock()));return n&&n.id===e.id})).map((e=>{const t=e.findIndex((e=>"block"===e.table&&e.isNavigableBlock()));return e.slice(1,t).filter((e=>{if("block"!==e.table)return!1;const t=e.getParentStore();return"block"===(null==t?void 0:t.table)&&"tab"===(null==t?void 0:t.getType())}))}));return o.mN(o.xH(n),(e=>e.id))}(e,t);for(const o of n){const e=o.getParentStore();var a;if((null==e?void 0:e.table)===r.iU&&"tab"===(null==e?void 0:e.getType()))d.x2({store:e,id:o.id,currentUserId:null===(a=l.default.state.currentUserStore)||void 0===a?void 0:a.id})}return n}async function g(e,t){await async function(e,t){const n=t.map((t=>c.G.createChildStore(e,{table:r.iU,id:t})));await Promise.all(n.map((e=>i.s(e))))}(e,t);const n=o.mN([...m(e,t),...f(e,t)],(e=>e.id));await async function(e){await Promise.all(e.map((e=>a.r(e))))}(n)}},61045:(e,t,n)=>{n.d(t,{NQ:()=>j,Q7:()=>Y,YC:()=>G,Zv:()=>z,_4:()=>K,aB:()=>O,bx:()=>L,hQ:()=>$,hl:()=>q});var o=n(73935),r=n(14577),i=n(72126),a=n(68056),s=n(77546),l=n(89224),c=n(47372),d=n(3994),u=n(75987),p=n(95802),m=n(55521),f=n(96198),g=n(5162),h=n(34859),v=n(80796),b=n(64233),y=n(65686),_=n(19111),S=n(69454),w=n(19671),k=n(13023),I=n(88923),C=n(79797),x=n(27724),T=n(10743),M=n(24666),P=n(36610);function A(e,t,n,o){const r=(n-t)/n,i=o/10/60,a=i+(3*o/60-i)*Math.min(r*r,1);return e.device.isIOS?Math.ceil(a):a}const R=1e3,D=i.P2((e=>{P.PL(e,{direction:"top"})}),R),E=i.P2((e=>{P.PL(e,{direction:"bottom"})}),R),B=i.P2((e=>{P.PL(e,{direction:"left"})}),R),F=i.P2((e=>{P.PL(e,{direction:"right"})}),R);function O(e){const{environment:t,scroller:n,currentMouseX:o,currentMouseY:r,verticalEdgeThreshold:i,horizontalEdgeThreshold:a,disableVerticalEdgeScroll:s,disableHorizontalEdgeScroll:l}=e,{clientRect:c,scrollTop:d,scrollHeight:u,scrollLeft:p,scrollWidth:m}=n.stores.store.state;if(c){if(n.props.type!==h.Z.X&&!s){const e=r-c.top;let o,a;S.Z.state.phase!==S.i.shown?(o=i,a=(0,g.Y)("supportsNativeBottomBarOverlappingWebView")?c.bottom-S.Z.estimatedNativeWebBottomOverlap()-r:c.bottom-r):(o=.25*S.Z.state.estimatedKeyboardWebViewOverlap,a=c.bottom-S.Z.estimatedNativeWebBottomOverlap()+o-r);const s=0===d,l=d+c.height===u;if(e<i&&!s){const o=A(t,e,i,c.height);n.scrollTo(d-o,void 0),o>0&&D(t)}if(a<o&&!l){const e=A(t,a,o,c.height);n.scrollTo(d+e,void 0),e>0&&E(t)}}if(n.props.type!==h.Z.Y&&!l){const e=o-c.left,r=c.right-o,i=0===p,s=p+c.width===m;if(e<a&&!i){const o=A(t,e,a,c.width);n.scrollTo(void 0,p-o),o>0&&B(t)}if(r<a&&!s){const e=A(t,r,a,c.width);n.scrollTo(void 0,p+e),e>0&&F(t)}}}}const Z=64,V=64,U=64,N=64;function L(e){const{element:t,scrollers:n,vertical:o,horizontal:r,animate:i}=e,a=t.getBoundingClientRect();if(o&&n.verticalScroller){const{reveal:e}=o,t=o.paddingToTopEdge||Z,r=o.paddingToBottomEdge||V,s=n.verticalScroller,l=s&&s.getClientRect();if(s&&l){const n=l.top+t,o=l.bottom-r,c=a.top>n&&a.top<o,d=a.bottom>n&&a.bottom<o,u=a.top<n&&a.bottom>o,p=a.bottom-o,m=a.top-n;"top"===e?c||s.scrollByOffset(m,0,{animate:i}):"bottom"===e?d||s.scrollByOffset(p,0,{animate:i}):c||d||u||(Math.abs(p)<Math.abs(m)?s.scrollByOffset(p,0,{animate:i}):s.scrollByOffset(m,0,{animate:i}))}}if(r&&n.horizontalScroller){const{reveal:e}=r,t=r.paddingToLeftEdge||N,o=r.paddingToRightEdge||U,s=n.horizontalScroller,l=s&&s.getClientRect();if(s&&l){const n=l.left+t,r=l.right-o,c=a.left>n&&a.left<r,d=a.right>n&&a.right<r,u=a.left<n&&a.right>r,p=a.right-r,m=a.left-n;"left"===e?c||s.scrollByOffset(0,m,{animate:i}):"right"===e?d||s.scrollByOffset(0,p,{animate:i}):c||d||u||(Math.abs(p)<Math.abs(m)?s.scrollByOffset(0,p,{animate:i}):s.scrollByOffset(0,m,{animate:i}))}}}function j(e){const{component:t,horizontal:n,vertical:r,animate:i}=e;if(!t)return;const a=o.findDOMNode(t);return a&&a instanceof Element?L({vertical:r,animate:i,horizontal:n,element:a,scrollers:{verticalScroller:t.getContextVerticalScroller?t.getContextVerticalScroller():void 0,horizontalScroller:t.getContextHorizontalScroller?t.getContextHorizontalScroller():void 0}}):void 0}function z(){if(x.default.state.pivot)q([x.default.state.pivot.id]);else{q(x.default.state.stores.map((e=>e.id)))}}function q(e,t){const n=p.C.findScrollToSelectablesFromIds(e)[0];if(n){const{disableScrollToRevealHorizontal:e}=n.props;j({component:n,vertical:{reveal:"closest"},horizontal:e?void 0:{reveal:"closest"},animate:t})}}let H=function(e){return e[e.top=0]="top",e[e.middle=1]="middle",e[e.bottom=2]="bottom",e[e.natural=3]="natural",e}({});function W(e){let{position:t}=e;const{paddingTop:n}=e;if("editing"!==M.default.state.mode)return;let o=e.paddingBottom;c.Z.find((e=>e.props.show))&&(o+=f.O);const r=l.get();if(r){const e=s.SD(r.commonAncestorContainer);if(!e)return;const i=s.hI(e).find((e=>e.scrollHeight>e.clientHeight));if(!i)return;const a=l.getRect(r);if(!a||!i)return;const c=i.getBoundingClientRect();if(!(r.startContainer instanceof Text)){const e=a;e.top+=4,e.bottom-=5,e.height-=9}const d=a.top<c.top+n,u=a.bottom>c.bottom-o;if(r.startContainer instanceof Text&&r.startOffset!==r.endOffset)return;if(t===H.natural)if(u)t=H.bottom;else{if(!d)return;t=H.top}if(t===H.top){const e=i.scrollTop+a.top,t=c.top+n;i.scrollTop=e-t}else if(t===H.bottom){const e=i.scrollTop+a.bottom,t=c.bottom-o;i.scrollTop=e-t}else if(t===H.middle){const e=i.scrollTop+a.top,t=c.top+c.height/2-10;i.scrollTop=e-t}}}function K(){return S.Z.estimatedNativeWebBottomOverlap()+20}function G(e){if(u.Z.isInlineAutocompleteOpen())return!0;const t=e.device.isMobile&&(!e.device.isNative||e.device.isTablet);return!!(!t&&_.Z.state.open||!t&&!(0,g.Y)("supportsNativeMobileDynamicActionBar")&&T.Z.state.open||!t&&function(){var e;const t="editing"===M.default.state.mode&&(null===(e=(0,a.QY)(M.default.state.multiSelection))||void 0===e?void 0:e.store);if(t){const e=t.getRecordStoreAtRootPath();if(e instanceof C.G){const t=e.getValue(),n=t&&t.type;return"link_to_page"===n||"link_to_collection"===n}}return!1}()||b.Z.state.open)}function $(e){const t=d.Z.shouldPreventMobileAutoScroll(e);G(e)?W({position:H.top,paddingTop:20,paddingBottom:K()}):t||w.Z.state.isOpen&&!I.default.state.open||k.Z.state.isOpen||W({position:H.natural,paddingTop:20,paddingBottom:K()})}const Q=i.IH((e=>{const{device:t}=e;return new r.Z((()=>t.isMobile&&v.Z.state.isDragging||t.isMobile&&m.Z.state.swiping?h.Z.All:y.Z.getPreventScrollType()),{debugName:"preventScrollTypeStore"})}));function Y(e){return Q(e).state}},87531:(e,t,n)=>{n.d(t,{IB:()=>w,Kf:()=>_,LR:()=>y,UT:()=>S,bn:()=>I,em:()=>k});var o=n(4615),r=n(89101),i=n(94804),a=n(70203),s=n(63594),l=n(81598),c=n(28344),d=n(56206),u=n(80444),p=n(21273),m=n(98180),f=n(22294),g=n(55320),h=n(29026),v=n(51787),b=n(8055);const y=6;function _(e){g.default.state.open?w(e.environment):S(e)}function S(e){const{environment:t,renderAsPage:n,isQuickSearch:a,isPublicPageSearch:s}=e,l=(0,o.ZP)(),d=Date.now();if(Boolean(a))g.default.setState({open:!1,openAsPage:!0,openedTimeMs:d,sessionId:l,isPublicPageSearch:s??!1,preferSidePeekOpen:(0,i.w8)(t.currentUser.id)});else if(Boolean(n))b.c4({environment:t,url:`${r.VP.nativeTab}/search`,redirect:!0}),g.default.setState({open:!1,openAsPage:!0,openedTimeMs:d,sessionId:l,isPublicPageSearch:s??!1,preferSidePeekOpen:(0,i.w8)(t.currentUser.id)});else{if(g.default.state.open)return;g.default.update((e=>({...e,open:!0,openAsPage:!1,isQuickSearch:!1,openedTimeMs:d,sessionId:l,isPublicPageSearch:s??!1,preferSidePeekOpen:(0,i.w8)(t.currentUser.id)})))}if(Boolean(e.doNotTrackOpenSearchEvent)||v.wF(e.environment,{from:e.analyticsFrom,searchSessionId:l}),"assistant"===h.ZP.state.mode){const t=m.Z.getActiveAssistantConfigurationState();if(t){const n=g.default.state.sessionId;c.trackQnAOpened(e.environment,{configurationState:t,from:"return_to_search",hasQuery:!1,runtimeState:m.Z.getActiveAssistantRuntimeState(),searchSessionId:n,isReminder:!1})}}}const w=e=>{if(g.default.state.open&&(g.default.reset(),f.Z.setKeyboardMode(!1),"assistant"===h.ZP.state.mode)){const t=m.Z.getActiveAssistantConfigurationState();t&&c.trackQnaClosed(e,{configurationState:t,runtimeState:m.Z.getActiveAssistantRuntimeState(),from:"search"})}};async function k(e){const{environment:t,shouldResetAssistantStore:n=!0}=e,o=u.default.state.mainEditorCurrentBlockStore??u.default.state.currentSpaceStore,r=h.ZP.state.query.text,i=g.default.state.sessionId;if(!o)return;const{assistantActions:f,assistantMenuActions:v}=await l.L6.loader();if(p.Z.isXMLAssistantEnabled(void 0)){if(r.length>y&&s.Z.state){const{sessionId:e}=await f.resetAndInitializeAssistantSession({environment:t});f.commitHumanStep({environment:t,text:(0,a.TPx)(r),sessionId:e})}else f.clearActiveAssistantSession({environment:t});w(t),v.openAssistantRightHandSideMenu({environment:t,from:void 0})}else{var b;let e=m.Z.getActiveSessionId();if(!e||n){e=(await f.resetAndInitializeAssistantSession({environment:t,primeTextInput:r.length<=y?r:void 0})).sessionId}d.d.state.open&&v.closeAssistantRightHandSideMenu(),h.ZP.update((e=>({...e,mode:"assistant"})));const o=r.length>y&&s.Z.state;o&&f.commitHumanStep({environment:t,text:(0,a.TPx)(r),sessionId:e});const l=null===(b=m.Z.getSessionContext(e))||void 0===b||null===(b=b.assistantConfigurationStore)||void 0===b?void 0:b.state;var _;if(l)c.trackQnAOpened(t,{configurationState:l,runtimeState:null===(_=m.Z.getSessionContext(e))||void 0===_||null===(_=_.assistantRuntimeStore)||void 0===_?void 0:_.state,hasQuery:o,from:"search",searchSessionId:i,isReminder:!1})}}function I(){g.default.update((e=>({...e,preferSidePeekOpen:!e.preferSidePeekOpen})))}},5851:(e,t,n)=>{n.d(t,{n:()=>f,y:()=>g});n(57658);var o=n(72126),r=n(97880),i=n(9291),a=n(33929),s=n(81918),l=n(54642),c=n(47307),d=n(9953),u=n(29974),p=n(82530);const m=(0,i.defineMessages)({saveFieldError:{id:"securitySAMLSettings.saveSettingsError.message",defaultMessage:"Something went wrong."}});function f(e,t){const{securitySettingsState:n,spaceStore:o}=t,{disablePublicAccess:r,disableGuests:i,disableMoveToSpace:a,disableExport:s,disableSpacePageEdits:l,disablePublicAccessRequests:c,disableTeamCreation:d,disableMembershipRequests:m,disableExternalMembershipRequests:f,disableGuestMembershipRequests:g,enableAiFeature:h,disableTeamGuests:v,enableGuestInviteRequests:b}=n;return p.createAndCommit({userAction:"securitySettingsActions.saveSecuritySettings",environment:e,perform:t=>{u.Xr({environment:e,transaction:t,spaceStore:o,disablePublicAccess:r,disableGuests:i,disableMoveToSpace:a,disableExport:s,disableSpacePageEdits:l,disablePublicAccessRequests:c,disableTeamCreation:d,disableMembershipRequests:m,disableExternalMembershipRequests:f,disableGuestMembershipRequests:g,enableAiFeature:Boolean(h),disableTeamGuests:v,enableGuestInviteRequests:b})}})}function g(e,t){const{securitySettingsStore:n,spaceStore:i,fields:u}=t,f={...n.state},g={...n.state,...u};n.setState(g),void 0!==u.disableGuests&&(l.updateDisableGuestsOnSpace(e,{spaceId:i.id,newDisableGuestsValue:u.disableGuests,keepExistingGuests:Boolean(u.keepExistingGuests)}).then((e=>{if("failed"===e.type)return c.showErrorMessage(a.default.formatMessage(m.saveFieldError)),void n.setState(f)})),s.o8(e,{new_value:u.disableGuests,keep_existing_guests_if_disabled:Boolean(u.keepExistingGuests)})),p.createAndCommit({userAction:"SecuritySettings.saveToggle",environment:e,perform:e=>{e.postSubmitCallbacks.push((e=>{if(e)return c.showErrorMessage(a.default.formatMessage(m.saveFieldError)),void n.setState(f)}));const t=o.GM({disable_public_access:u.disablePublicAccess,disable_move_to_space:u.disableMoveToSpace,disable_export:u.disableExport,disable_space_page_edits:u.disableSpacePageEdits,disable_public_access_requests:u.disablePublicAccessRequests},(e=>o.kK(e)));d.sW({store:i,data:t,transaction:e});const s=o.GM({enable_guest_invite_requests:u.enableGuestInviteRequests,disable_membership_requests:u.disableMembershipRequests,disable_external_membership_requests:u.disableExternalMembershipRequests,disable_guest_membership_requests:u.disableGuestMembershipRequests},(e=>!(0,r.$K)(e)));Object.keys(s).length>0&&p.applyOperation({store:i,operation:{pointer:i.pointer,path:["settings"],command:"update",args:s},transaction:e})}}),(0,r.$K)(u.enableGuestInviteRequests)&&s.tB(e,{new_value:u.enableGuestInviteRequests})}},42858:(e,t,n)=>{n.d(t,{Ah:()=>fe,Cl:()=>re,DQ:()=>ve,DV:()=>we,MD:()=>ee,Od:()=>J,QZ:()=>me,Qw:()=>oe,VJ:()=>he,WG:()=>be,YP:()=>ye,ZJ:()=>_e,aO:()=>se,at:()=>ce,bj:()=>ne,dK:()=>pe,is:()=>ie,jQ:()=>ge,mp:()=>ae,nG:()=>de,uE:()=>Se,zO:()=>te});n(57658),n(21703),n(52262),n(24506);var o=n(1302),r=n(15145),i=n(41432),a=n(72126),s=n(21202),l=n(23867),c=n(63143),d=n(9291),u=n(75754),p=n(91851),m=n(10906),f=n(33742),g=n(95477),h=n(27105),v=n(19037),b=n(28020),y=n(77181),_=n(40959),S=n(35683),w=n(33929),k=n(65598),I=n(41984),C=n(58202),x=n(95802),T=n(80444),M=n(77080),P=n(88923),A=n(79797),R=n(27724),D=n(34583),E=n(81193),B=n(54642),F=n(30188),O=n(41433),Z=n(47307),V=n(54532),U=n(54604),N=n(94419),L=n(19785),j=n(99553),z=n(8055),q=n(61045),H=n(24677),W=n(84084),K=n(64964),G=n(15690),$=n(98104),Q=n(82530),Y=(n(68422),n(1742));const X=(0,d.defineMessages)({deletePages:{id:"action.deletePages.snackBarMessage",defaultMessage:"Moved to trash"}});function J(e){var t,n;const{store:o,transaction:r}=e,i=x.C.findSelectablesFromStore(o).find((e=>Boolean(e.props.onRemove)));null==i||null===(t=(n=i.props).onRemove)||void 0===t||t.call(n,{transaction:r})}function ee(e){const{blocks:t,transaction:n}=e;if(1===t.length){const e=t[0];e&&k.PF(e)&&J({store:e,transaction:n})}}function te(e){const t=x.C.findAllSelectablesFromIds(e.map((e=>e.id)));for(const n of t)n.stores.selectableStore.setState({...n.stores.selectableStore.state,showActionIsInFlight:!0})}function ne(e){const t=x.C.findAllSelectablesFromIds(e.map((e=>e.id)));for(const n of t)n.stores.selectableStore.setState({...n.stores.selectableStore.state,showActionIsInFlight:!1})}async function oe(e){const{environment:t,blocks:n}=e;let o=!0;const r=[];for(const s of n){const e=C.R.findBlockFromStore(s);if(e&&a.mf(e.handleRemoveBlockFromComment)){if(await e.handleRemoveBlockFromComment())continue}else if(e&&a.mf(e.canRemoveBlock)){const t=await e.canRemoveBlock();if(!t.canRemove)return;o=t.canUndo}const n=await p.NN({environment:t,block:s,action:"delete"});if("user_canceled"===n)return;n.length>1?r.push(...n):r.push(s)}if(0===r.length)return;if(M.default.checkGate("collection_subitem_nested_operations")){if(!(await F.VP({environment:t,blocks:r,canUndo:o})))return}else{const{serverCommitResult:e}=Q.createAndCommit({userAction:"selectableBlockActions.removeBlocksWithMaybeConfirmation",environment:t,canUndo:o,perform:e=>{re({environment:t,blocks:r,transaction:e})}});await e}const{currentSpaceStore:i}=T.default.state;i&&r.some((e=>e.isPageBlock()))&&K.d4({item:{label:w.default.formatMessage(X.deletePages)},undoFunc:()=>{for(const e of r)B.restoreBlock(t,{pointer:{table:s.iU,id:e.id,spaceId:e.pointer.spaceId||i.id}})}}),r.some((e=>{var t;return e.id===(null===(t=P.default.peekTarget.state)||void 0===t?void 0:t.id)}))&&j.xv(t,void 0)}function re(e){const{environment:t,blocks:n,transaction:o,preventClearSelection:r}=e,s=n[0],d=function(e){const t=x.C.getMembersByDOMOrder({filter:()=>!0}),n=a.cx(t,(t=>t.props.store===e)),o=t[n];if(!o)return;const r=o.getContextSelectableContainer(),i=a.tP(t,0,n),s=a.dF(i,(e=>e.props.canSelect&&e.getContextSelectableContainer()===r));if(s)return s.props.store;const l=a.tP(t,n+1).find((e=>Boolean(e.props.canSelect&&e.getContextSelectableContainer()===r)));if(l)return l.props.store}(s);!function(e){const{environment:t,block:n,entryPointName:o}=e,r=new Y.GD({environment:t,userFlow:"user_flow_delete_block",entryPointName:o,timeoutMs:90*c.C0});if(r.isDisabled())return;const i=()=>{n.pathIsDead()&&r.succeed()};r.postFinishCallbacks.push((()=>{n.removeListener(i)})),n.addListener(i)}({environment:t,block:s,entryPointName:o.getUserActionForAnalyticsPurposesOnly()||"selectableBlockActions.removeBlocks"});for(const i of n)J({store:i,transaction:o});if(r||(H.ZH(t),H.Fp({pivot:d})),v._J({environment:t,blocks:n,publicEditMode:void 0})||v.Nn({environment:t,blocks:n,publicEditMode:void 0})||v.oY({environment:t,blocks:n,publicEditMode:void 0})||n.some((e=>{var t;return e.getType()===i.Ti.transclusionContainer||(null===(t=e.getAssociatedCollectionStore())||void 0===t?void 0:t.isPageTreeCollection())}))){o.postSubmitCallbacks.push((e=>{e||B.deleteBlocks(t,{blocks:n.map((e=>({id:e.id,spaceId:(0,l.C)(e.pointer.spaceId)}))),permanentlyDelete:!1})}));for(const e of n){const{app_id:n,app_config_uri:r}=e.getFormat();n&&r&&E.Cu(t,{block_id:e.id,app_id:n,app_config_uri:r}),L.zo({block:e,transaction:o})}z.CZ({environment:t,blocks:n})}r||$.ZH(t)}function ie(e){const{environment:t,blocks:n,selection:o,transaction:r,replaceEmptyTextBlock:i,preventSetSelection:s,insertAfterBlock:l}=e,c=b.RM();if(!c)throw new Error("No root store.");let d;if(o.length>0){const e=l||o.at(-1);let s=e;if(Boolean(n.find((e=>e.isType("column_list"))))){const t=null==e?void 0:e.findRecordStoreUIAncestor((e=>e&&e instanceof A.G&&e.isType("column_list"))).ancestor;t&&t instanceof A.G&&(s=t)}const u=x.C.find((e=>e.props.store===s&&e.props.canInsertBelow&&e.props.onInsertBelow));if(u&&u.props.onInsertBelow)d=a.oA(u.props.onInsertBelow({insertStores:n,transaction:r})),i&&e&&e.isEmptyTextBlock()&&re({environment:t,blocks:[e],transaction:r});else{d=a.d9(n).reverse().map((e=>N.Ce({parent:c.getContentStore(),prepend:e,transaction:r}).child))}}else if(c.isCollectionView()){const e=C.R.findBlockFromStoreWithMethod(c,"insertBlocks");if(!e)throw new Error("No collection view found.");d=e.insertBlocks(n,r)}else{const e=c.getContentStore();d=n.map((t=>N.R3({parent:e,append:t,transaction:r}).child))}return Boolean(s)||(d=d.flatMap((e=>e.isType("column_list")?e.getContentStores().flatMap((e=>e.getContentStores())):[e])),H.Z5({environment:t,stores:d})),d}function ae(e){const{blocks:t}=e,n=t[0];if(n){const t=x.C.findSelectableFromStore(n);t&&t.props.onEnter&&t.props.onEnter(e)}}function se(e){const{environment:t,createBlockItem:n,selection:o,transaction:r,analyticsFrom:i,preventSetSelection:a}=e,s=R.default.getCurrentRecordCache(),l=new Y.BW({environment:t,userFlow:"page"===(null==n?void 0:n.blockType)?"user_flow_create_page":"user_flow_create_block",succeedOnEnqueue:!0});let c;if(D.M_(t)&&n&&s){var d;const e=O.fC({environment:t,createBlockItem:n,transaction:r,inMemoryRecordCache:s,from:i,useCrdt:0!==o.length?o[0].useCrdt():(null===(d=b.RM())||void 0===d?void 0:d.useCrdt())??!1});l.track(e.pointer,r),c=ie({environment:t,blocks:[e],selection:o,transaction:r,replaceEmptyTextBlock:!1,preventSetSelection:a})[0]}else l.fail("invalid_state");return c}function le(e){const{environment:t,createBlockItem:n,selection:o,transaction:r,analyticsFrom:i}=e,a=R.default.getCurrentRecordCache();let s;if(D.M_(t)&&n&&a){var l;s=function(e){const{environment:t,selection:n,transaction:o}=e,{blocks:r}=e,i=b.RM();if(!i)throw new Error("No root store.");if(n.length>0){const e=n[0],i=x.C.find((t=>t.props.store===e&&t.props.canInsertAbove&&t.props.onInsertAbove));if(!i||!i.props.onInsertAbove)throw new Error("No Selectable found.");const a=i.props.onInsertAbove({insertStores:r,transaction:o});return H.Z5({environment:t,stores:a}),a}{const e=i.getContentStore(),n=r.map((t=>N.R3({parent:e,append:t,transaction:o}).child));return H.Z5({environment:t,stores:n}),n}}({environment:t,blocks:[O.fC({environment:t,createBlockItem:n,transaction:r,inMemoryRecordCache:a,from:i,useCrdt:0!==o.length?o[0].useCrdt():(null===(l=b.RM())||void 0===l?void 0:l.useCrdt())??!1})],selection:o,transaction:r})[0]}return s}function ce(e){const{environment:t,selection:n,transaction:o}=e,r=se({...e,preventSetSelection:!0});r&&we({environment:t,insertedStores:[r],isCreated:!0}),ee({transaction:o,blocks:n})}async function de(e){const{environment:t,blocks:n,duplicateOnlyCollectionSchema:r,event:i}=e;if(!D.M_(t))return;let a=n;if(1===n.length){const e=await p.NN({environment:t,block:n[0],action:"duplicate"});if("user_canceled"===e)return;a=e}const s=M.default.checkGate("collection_subitem_nested_operations"),l=a.at(0);if(!l)return;const c=(0,m.fm)(l);if(s&&(0,y.vJ)(l,c))await F.W9({blocks:a,environment:t,analyticsFrom:"subitem_duplication"});else{const e=(0,h.Sy)({event:i,contextualDefault:0!==n.length&&n[0].useCrdt()});Q.createAndCommit({userAction:"actionRegistry.duplicateToSelection",environment:t,perform:n=>{ue({environment:t,blocks:a,transaction:n,preferDuplicateLocation:"local",duplicateOnlyCollectionSchema:r,useCrdt:e})},transactionTooBigFallback:n=>{ue({environment:t,blocks:a,transaction:n,preferDuplicateLocation:"server",duplicateOnlyCollectionSchema:r,useCrdt:e})}})}o.default.afterNextFlush((()=>{q.Zv()}))}function ue(e){const{environment:t,blocks:n,transaction:o,preferDuplicateLocation:r,lastTopLevelBlock:i,preventSetSelection:s,duplicateOnlyCollectionSchema:c,useCrdt:d}=e,u=a.vM(n,(e=>e.getFormat().app_id??e.id)),p=[];return a.Ed(u,(e=>{const n=e[0],i=!n.isTransclusionType(),[a,s]=V.Qi({environment:t,stores:e,addCopyName:(0,I.Z)(n),transaction:o,deepCopyTransclusionContainers:i,resolveTemplateVariables:!(n.isInsideTemplate()||n.isInsideFactoryOrDuplicateBlocksAction()),targetSpaceId:(0,l.C)(n.pointer.spaceId),baseUrl:g.default.domainBaseUrl,publicDomainName:g.default.publicDomainName,preferDuplicateLocation:r,useCrdt:d,duplicateOnlyCollectionSchema:c});p.push(...a),s.then((e=>{e&&Z.showErrorMessage(e)}))})),ie({environment:t,blocks:p,selection:i?[i]:n,transaction:o,replaceEmptyTextBlock:!1,preventSetSelection:s}),p}function pe(e){const t=e.blocks[0],{blockLocationOfTargetBlock:n}=e,o=C.R.find((e=>e instanceof f.ZP&&e.props.store===t&&(!n||e.props.blockLocation===n)));o&&o.canRenderFullScreen()&&U.ui({environment:o.environment,renderFullScreenNode:o.renderFullScreenNode,fullScreenNodeRect:o.getFullScreenNodeRect(),block:t})}function me(e){let t;e.blocks.find((e=>{const n=C.R.findBlockFromStoreWithMethod(e,"activate");return!!n&&(t=n,!0)})),t&&t.activate&&t.activate()}function fe(e){e.blocks.forEach((t=>{const n=t.getParentStore();n&&n.table===s.iU&&n.getType()===i.Ti.tab&&G.x2({store:n,id:t.id,currentUserId:e.environment.currentUser.id})}))}function ge(e){const t=e.blocks[0],n=C.R.findBlockFromStoreWithMethod(t,"configure");n&&(n.configure(),E.PE(e.environment,{from:"block_action"}))}function he(e){const t=e.blocks[0],n=C.R.findBlockFromStoreWithMethod(t,"caption");n&&n.caption()}function ve(e,t){const n=a.oA(x.C.findSelectablesFromIds(t)).map((e=>e.props.store));H.Z5({environment:e,stores:n})}function be(e,t){const n=x.C.findScrollToSelectablesFromIds(t);n[0]&&(q.NQ({component:n[0],vertical:{reveal:"top"},horizontal:{reveal:"closest"}}),H.Z5({environment:e,stores:n.map((e=>e.props.store))}))}function ye(e){const{environment:t,blocks:n}=e,o=n[0].findRecordStoreUIAncestor((e=>e instanceof A.G&&e.isCollectionView())).ancestor;o&&u._({environment:t,store:o,visitType:S.vu.Link,pageVisitSource:r.tY.Expand})}function _e(e){const{blocks:t,transaction:n,environment:r}=e,i=se({environment:r,selection:t,createBlockItem:_.Hc.text,analyticsFrom:"text_insert_below",transaction:n});return i&&o.default.afterNextFlush((()=>{W.hb({environment:r,blockStore:i})})),i}function Se(e){const{blocks:t,transaction:n,environment:r}=e,i=le({environment:r,selection:t,createBlockItem:_.Hc.text,analyticsFrom:"text_insert_above",transaction:n});return i&&o.default.afterNextFlush((()=>{W.hb({environment:r,blockStore:i})})),i}function we(e){const{environment:t,insertedStores:n,isCreated:r}=e;r?o.default.afterNextFlush((()=>{const e=n[0];if(!e)return;const o=C.R.findBlockFromStoreWithMethod(e,"handleCreated");o?o.handleCreated():(H.Ys({environment:t,store:e}),H.Db(t))})):H.Z5({environment:t,stores:n})}},24677:(e,t,n)=>{n.d(t,{$Y:()=>B,Af:()=>F,Ch:()=>ee,DI:()=>K,Db:()=>L,FC:()=>$,Fp:()=>O,Jy:()=>J,KX:()=>M,OS:()=>R,Ys:()=>U,Z5:()=>V,ZH:()=>z,aw:()=>E,e2:()=>W,eP:()=>N,hn:()=>X,ji:()=>A,td:()=>Q,w5:()=>Y,wI:()=>Z,yu:()=>j,zJ:()=>q});n(57658);var o=n(55010),r=n(1302),i=n(72126),a=n(95371),s=n(75330),l=n(77181),c=n(28314),d=n(69645),u=n(35328),p=n(27406),m=n(16339),f=n(95802),g=n(50694),h=n(12211),v=n(50628),b=n(27724),y=n(45131),_=n(30188),S=n(89951),w=n(67060),k=n(61045),I=n(84084),C=n(98104),x=n(29373),T=n(82530);function M(){const e=b.default.getCurrentDefaultContainer();if(e){return f.C.getMembersByDOMOrder({filter:t=>t.getContextSelectableContainer()===e&&t.props.canSelect}).map((e=>e.props.store))}return[]}function P(e){const t=b.default.state.stores,n=b.default.state.pivot,o=i.oA(i.zu(t,n));let r;r=n===i.Z$(t)?t[t.length-2]:t[1],V({environment:e,stores:o,pivot:r})}function A(e){const t=c.yA();return e.device.isMac?t.shift&&t.command:t.shift&&t.option}function R(){return c.yA().shift}function D(e){e.sort(((e,t)=>(0,o.Z)(f.C.findNodeFromStore(e),f.C.findNodeFromStore(t))))}function E(e){const t=new Array(e.length);return f.C.forEach((n=>{if(n.props.canSelect){const o=e.indexOf(n.props.store);if(o>=0){const e=n.getNode();e&&(t[o]=e)}}})),e.filter(((n,o)=>{const r=t[o];return n&&!e.some(((e,n)=>{const o=t[n];return Boolean(o&&o!==r&&r&&o.contains(r))}))}))}function B(e){b.default.setState({...b.default.state,phase:e.phase}),e.phase===b.SelectionPhase.Editing||e.preventClearEditingText||C.ZH(e.environment)}function F(e){const{stores:t}=e,n=b.default.state.stores,o=i.G0(t,n);o.length===t.length&&o.length===n.length||b.default.setState({...b.default.state,stores:e.stores}),t.length>0&&(s.wG(),g.g$.blockSelectionInSimpleTable(t)||g.HM.clearSelection())}function O(e){b.default.setState({...b.default.state,pivot:e.pivot})}function Z(e){const{stores:t}=b.default.state;F({stores:t.map((t=>t===e.store?e.replace:t))})}function V(e){const{environment:t}=e,n=E(e.stores);F({stores:n}),B({environment:e.environment,phase:e.phase||b.SelectionPhase.Selected}),1===n.length&&function(e){var t;const n=e.anchor,o=null===(t=f.C.findSelectableFromStore(n))||void 0===t?void 0:t.getNode();let r;o&&(r=b.default.getDefaultContainerFromTarget(o)),b.default.setState({...b.default.state,anchor:n,anchorContainer:r})}({anchor:n[0]});const o=e.pivot||n[0];if(O({pivot:o}),r.default.afterNextFlush((()=>{D(n)})),e.phase===b.SelectionPhase.Editing&&o)if(t.device.isMobile)k.hQ(t);else if(!t.device.isMobileBrowser){const e=f.C.findScrollToSelectableFromStore(o);e&&k.NQ({component:e,vertical:{reveal:"closest"},horizontal:e.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function U(e){void 0===e.toggle&&(e.toggle=!1),void 0===e.selectBetween&&(e.selectBetween=!1);const{stores:t}=b.default.state;if(e.toggle)i.q9(t,e.store)?V({environment:e.environment,stores:i.zu(t,e.store)}):V({environment:e.environment,stores:i.G0(t,[e.store])});else if(e.selectBetween){let n=i.d9(t);const o=M(),r=o.indexOf(e.store);i.q9(n,e.store)||n.push(e.store);const a=t[0];if(a){const e=o.indexOf(a);if(e>=0){const t=i.tP(o,r,e);n=i.G0(n,t)}}const s=i.Z$(t);if(s){const e=o.indexOf(s);if(e>=0){const t=i.tP(o,e,r);n=i.G0(n,t)}}V({environment:e.environment,stores:n})}else i.q9(t,e.store)||V({environment:e.environment,stores:[e.store]});B({environment:e.environment,phase:b.SelectionPhase.Selected})}function N(e){const{environment:t,store:n}=e;if(n)if(F({stores:[n]}),O({pivot:void 0}),B({environment:t,phase:b.SelectionPhase.Editing}),t.device.isMobile)k.hQ(t);else if(!t.device.isMobileBrowser){const e=f.C.findScrollToSelectableFromStore(n);e&&k.NQ({component:e,vertical:{reveal:"closest"},horizontal:e.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function L(e){const{stores:t}=b.default.state,n=t[0];if(!n)return;const o=f.C.findSelectableFromStore(n);if(o&&o.props.onEditText){const t=o.props.onEditText;T.createAndCommit({userAction:"selectionActions.editSelection",environment:e,perform:e=>{t({isAtStartOfLine:!1,isClick:!1,transaction:e})}})}}function j(e){const{environment:t,stores:n}=e,o=i.Z$(n);if(!o)return;const r=f.C.findSelectableFromStore(o);if(r&&r.props.onEditText){const e=r.props.onEditText;T.createAndCommit({userAction:"selectionActions.editStoresAtEnd",environment:t,perform:t=>{e({isAtStartOfLine:!1,isClick:!1,transaction:t})}})}}function z(e){F({stores:[]}),B({environment:e,phase:b.SelectionPhase.Selected}),w.xv(),I.xv(),S.xv()}function q(e){const{environment:t}=e,n=b.default.state.stores;D(n);const o=b.default.state.pivot,r=n[0];if(r)if(e.shiftKey)if(o===r){const o=(0,d.Bj)({includeNonSelectableListContainer:!1}),s=(0,d.v5)(r,o.children),{prev:l,parent:c}=e.altKey?(0,a.Sr)(o,s):(0,a.YL)(o,s);if(l){const e=l.value.store;V({environment:t,stores:i.G0(n,[e]),pivot:e})}else if(c){const e=c.value.store;V({environment:t,stores:i.G0(n.filter((e=>!(0,a.Yz)(c,(t=>t.store===e)))),[e]),pivot:e})}}else P(e.environment);else{const n=(0,d.Bj)({includeNonSelectableListContainer:!1}),o=(0,d.v5)(r,n.children),{prev:i,parent:s}=e.altKey?(0,a.Sr)(n,o):(0,a.YL)(n,o);if(i){const e=i.value.store;V({environment:t,stores:[e],pivot:e})}else if(s){const e=s.value.store;V({environment:t,stores:[e],pivot:e})}else V({environment:t,stores:[r],pivot:r})}else if(o)V({environment:t,stores:[o]});else{const e=M(),n=i.Z$(e);n&&V({environment:t,stores:[n],pivot:n})}H()}function H(){const e=b.default.state.pivot||b.default.state.stores[0],t=f.C.findScrollToSelectableFromStore(e);t&&k.NQ({component:t,vertical:{reveal:"top"},horizontal:t.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}function W(e){const t=b.default.state.stores;D(t);const n=b.default.state.pivot;if(0!==t.length&&n)if((0,u.BX)(n)&&y.Z.isOpen(n.id))V({environment:e,stores:[n],pivot:n}),x.rd({blockId:n.id,state:!1,currentUserId:e.currentUser.id});else if((0,l.bX)(n))_.e2(n);else{const t=(0,d.Bj)({includeNonSelectableListContainer:!1}),o=(0,d.v5)(n,t.children),r=(0,a.ub)(o);if(r){const t=r.value.store;V({environment:e,stores:[t],pivot:t})}else V({environment:e,stores:[n],pivot:n})}else if(n)V({environment:e,stores:[n]});else{const t=M(),n=i.Z$(t);n&&V({environment:e,stores:[n],pivot:n})}H()}function K(e){const{environment:t}=e,n=b.default.state.stores;D(n);const o=b.default.state.pivot,r=i.Z$(n);if(r)if(e.shiftKey)if(o===r){const e=(0,d.Bj)({includeNonSelectableListContainer:!1}),o=(0,d.v5)(r,e.children),{next:s}=(0,a.Xf)(e,o);if(s){const e=s.value.store;V({environment:t,stores:i.G0(n,[e]),pivot:e})}}else P(t);else{const n=(0,d.Bj)({includeNonSelectableListContainer:!1}),o=(0,d.v5)(r,n.children),{next:i}=e.altKey?(0,a.Xf)(n,o):(0,a.lj)(n,o);if(i){const e=i.value.store;V({environment:t,stores:[e],pivot:e})}else V({environment:t,stores:[r],pivot:r})}else if(o)V({environment:t,stores:[o]});else{const e=M()[0];e&&V({environment:t,stores:[e],pivot:e})}G()}function G(){const e=b.default.state.pivot||i.Z$(b.default.state.stores);if(e){const t=f.C.findScrollToSelectableFromStore(e);t&&k.NQ({component:t,vertical:{reveal:"bottom"},horizontal:t.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function $(e){const t=b.default.state.stores;D(t);const n=b.default.state.pivot;if(0!==t.length&&n)if((0,u.BX)(n)&&!y.Z.isOpen(n.id))V({environment:e,stores:[n],pivot:n}),x.rd({blockId:n.id,state:!0,currentUserId:e.currentUser.id});else if((0,l.bX)(n))_.FC(n);else{const t=(0,d.Bj)({includeNonSelectableListContainer:!1}),o=(0,d.v5)(n,t.children),r=(0,a.si)(o);if(r){const t=r.value.store;V({environment:e,stores:[t],pivot:t})}else V({environment:e,stores:[n],pivot:n})}else if(n)V({environment:e,stores:[n]});else{const t=M()[0];t&&V({environment:e,stores:[t],pivot:t})}G()}function Q(e){const t=M();V({environment:e,stores:t,pivot:t[0]})}function Y(e){const t=M()[0];if(t){V({environment:e,stores:[t],pivot:t});const n=f.C.findScrollToSelectableFromStore(t);n&&k.NQ({component:n,vertical:{reveal:"top"},horizontal:n.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function X(e){const t=M(),n=t[t.length-1];if(n){V({environment:e,stores:[n],pivot:n});const t=f.C.findScrollToSelectableFromStore(n);t&&k.NQ({component:t,vertical:{reveal:"bottom"},horizontal:t.props.disableScrollToRevealHorizontal?void 0:{reveal:"closest"}})}}function J(){const e=performance.now(),t=new Map,n=new Map;f.C.forEach((e=>{const o=e.getNode();if(o&&o instanceof Element){const r=o.getBoundingClientRect();t.set(e,r),n.set(o,r)}}));const o=new Map;m.Z.forEach((e=>{const t=e.getNode();t&&t instanceof Element&&o.set(e,t.getBoundingClientRect())}));const r=new Map;p.Z.forEach((e=>{const t=e.getNode();t&&t instanceof Element&&r.set(e,t.getBoundingClientRect())})),v.Z.setState({...v.Z.state,selectableRectMap:t,selectableContainerRectMap:o,selectableElementRectMap:n,lastUpdate:e}),h.Z.setState({...h.Z.state,dropTargetRectMap:r})}const ee=i.P2(J,200)},84084:(e,t,n)=>{n.d(t,{RL:()=>I,_P:()=>w,hb:()=>k,pZ:()=>S,xv:()=>C});var o=n(13991),r=n(70203),i=n(69783),a=n(73959),s=n(89224),l=n(95802),c=n(5162),d=n(64233),u=n(19111),p=n(10743),m=n(36610),f=n(24677),g=n(993),h=n(98104);const v="/",b="；",y=new Set([v,"／"]),_={"ja-JP":new Set([b])};function S(){return"ja-JP"===o.SP?b:v}function w(e){const{environment:t,textStore:n,oldSelection:a,oldTextValue:l}=e,f=r.eeV(n.getValue()||[]),g=a.startIndex,h=f[g],v=_[o.SP]||new Set;if(!y.has(h)&&!v.has(h))return;const b=r.gPn(f,g-10,g).join("");if(/[0-9]$/.test(b[b.length-1]))return;if(b.endsWith("http:")||b.endsWith("http:/")||b.endsWith("https:")||b.endsWith("https:/"))return;if(p.Z.state.open||i.Z.state.open||u.Z.state.open||d.Z.state.open)return;if(!(0,c.Y)("supportsNativeMobileDynamicActionBar")&&t.device.isPhone)return;const S=s.get();if(!S)return;const w=s.getRect(S);w&&(p.Z.setState({open:!0,isAddMenu:!1,textStore:n,oldTextValue:l,oldSelection:a,selectionRect:w,lettersAtLastResult:0,filter:""}),m.V_(t))}function k(e){const{environment:t,blockStore:n}=e,o=p.Z.state;if(f.eP({environment:t,store:n}),h.N_({store:n.getBlockTitleStore()}),!o.open&&!t.device.isPhone){const e=n.getBlockTitleStore(),t=l.C.getRectFromStore(n);t&&p.Z.setState({open:!0,isAddMenu:!0,textStore:e,oldTextValue:e.getValue(),oldSelection:{startIndex:0,endIndex:0},selectionRect:t,lettersAtLastResult:0,filter:""})}}function I(e){const{transaction:t,environment:n}=e,o=p.Z.state;if(o.open){const{textStore:e,oldTextValue:r,oldSelection:i}=o;g.sO({environment:n,store:e,value:r,transaction:t}),C();const s=(0,a.sQ)(e);s&&f.eP({environment:n,store:s}),h.Z5({store:e,selection:i})}}function C(){p.Z.setState({open:!1,previousFilter:p.Z.state.open?p.Z.state.filter:void 0})}},64964:(e,t,n)=>{n.d(t,{C1:()=>d,d4:()=>c,oV:()=>s,rN:()=>l});n(67294);var o=n(71644),r=n(6854),i=n(1310),a=n(85893);function s(e){const t={...e,key:(0,o.ZP)()};i.ZP.setState({...i.ZP.state,currentItem:t}),"keep"!==t.durationMs&&setTimeout((()=>{i.ZP.state.currentItem===t&&"keep"!==i.ZP.state.currentItem.durationMs&&i.ZP.setState({...i.ZP.state,currentItem:void 0})}),t.durationMs??i.Ty)}function l(){i.ZP.setState({...i.ZP.state,currentItem:void 0})}function c(e){const{item:t,undoFunc:n}=e;s({...t,right:(0,a.jsx)(r.ow,{onUndo:n})})}function d(){i.ZP.state.shouldReset&&i.ZP.reset()}},29974:(e,t,n)=>{n.d(t,{$F:()=>ve,F1:()=>fe,IY:()=>Te,L5:()=>ge,LV:()=>Ne,Ns:()=>xe,O2:()=>Pe,OF:()=>Se,Xr:()=>we,Xv:()=>De,Y5:()=>Oe,Yi:()=>he,Yj:()=>Ue,_Q:()=>Ee,_u:()=>_e,bf:()=>Ce,ce:()=>pe,eX:()=>ue,j:()=>Ie,jF:()=>Re,lF:()=>Me,mo:()=>Ae,oy:()=>Be,sw:()=>Ve,u3:()=>be,wg:()=>Ze,wh:()=>de,y3:()=>me,ys:()=>ke});n(21703),n(57658),n(67294);var o=n(15145),r=n(68626),i=n(72126),a=n(91155),s=n(72141),l=n(4615),c=n(45953),d=n(21202),u=n(15047),p=n(77858),m=n(29369),f=n(66079),g=n(62965),h=n(90965),v=n(54153),b=n(97880),y=n(9291),_=n(75754),S=n(81598),w=n(95477),k=n(97978),I=n(15010),C=n(33929),x=n(46654),T=n(48779),M=n(95697),P=n(55081),A=n(10929),R=n(30806),D=n(94841),E=n(78861),B=n(80444),F=n(21273),O=n(88632),Z=n(73329),V=n(69327),U=n(81236),N=n(79797),L=n(34583),j=n(70060),z=n(33493),q=n(91536),H=n(14549),W=n(81918),K=n(54642),G=n(35253),$=n(47307),Q=n(57400),Y=n(94273),X=n(94419),J=n(92625),ee=n(29533),te=n(76464),ne=n(9953),oe=n(4408),re=n(5851),ie=n(28014),ae=n(82530),se=n(70782),le=n(85893);const ce=(0,y.defineMessages)({deletingWorkspace:{id:"spaceActions.deletingWorkspace.loadingMessage",defaultMessage:"Deleting workspace…"},goOnlineCreateSpace:{defaultMessage:"Please go online to create your workspace.",id:"spaceActions.dialogError.createWorkspaceError.goOnline.message"},createSpaceError:{defaultMessage:"Sorry! We could not create your workspace. Please try again.",id:"spaceActions.dialogError.createWorkspaceError.message"},loginToCreateSpace:{defaultMessage:"Must be logged in.",id:"spaceActions.dialogError.createWorkspaceError.notLoggedIn.message"},moveToSpaceOnlineError:{defaultMessage:"Please go online to move content to another space.",id:"spaceActions.dialogError.moveContentError.goOnline.message"},cannotMoveShardRestriction:{defaultMessage:"Cannot move these pages at once.",id:"spaceActions.dialogError.moveContentError.cannotMovePages.message"},cannotMoveContent:{defaultMessage:"Sorry! We could not move this content. Please try again.",id:"spaceActions.dialogError.couldNotMoveContentError.message"},loginToMoveContent:{defaultMessage:"Must be logged in.",id:"spaceActions.dialogError.movetoWorkspace.notLoggedIn.message"},invalidSpaceStore:{defaultMessage:"Invalid space data.",id:"spaceActions.dialogError.createTemplatesInSpace.invalidStorage.message"},invalidSpaceStoreOnNavigate:{defaultMessage:"Invalid space data.",id:"spaceActions.dialogError.navigateToWorkspace.invalidStorage.message"},noSpaceViewOnJoin:{defaultMessage:"No space view data was created.",id:"spaceActions.dialogError.joinWorkspace.invalidWorkspaceStorage.message"},noLocalDataForPermissionGroup:{defaultMessage:"No local data about this workspace.",id:"spaceActions.dialogError.createOrUpdatePermissionGroup.invalidWorkspaceStorage.message"}});async function de(e){const{environment:t,name:n,domain:o,userRootStore:a,emailDomains:s,analyticsFrom:l,icon:c,planType:d,userPersona:g,shouldCreateUserPersonaTeam:h,shouldMakeUserPersonaTeamDefault:v}=e,{id:b}=t.currentUser;if(b){const e=await K.createSpace(t,{name:n,domain:o,emailDomains:s,icon:c,planType:d,initialPersona:g,shouldCreateUserPersonaTeam:h,shouldMakeUserPersonaTeamDefault:v});if("failed"===e.type){if(e.offline)throw new Error(C.default.formatMessage(ce.goOnlineCreateSpace));throw new Error(C.default.formatMessage(ce.createSpaceError))}const{spaceId:y,teamId:_,personaTeamId:S,inviteLinkCode:w}=e.data,k=new N.H2(t,{table:u.bx,id:y}),x=_?N.zX.createChildStore(k,{table:m.e0,id:_}):void 0,T=S?N.zX.createChildStore(k,{table:m.e0,id:S}):void 0,{serverCommitResult:M,performResult:{spaceViewStore:P}}=ae.createAndCommit({userAction:"spaceActions.createSpace",environment:t,perform:e=>{const n=ne.ae({environment:t,table:p.zU,value:{space_id:k.id,notify_mobile:!0,notify_desktop:!0,notify_email:!0,parent_id:b,parent_table:f.dx,alive:!0,joined:!0,joined_teams:(x||T)&&i.oA([null==x?void 0:x.id,null==T?void 0:T.id]),settings:{notify_email_digest:!0}},inMemoryRecordCache:a.inMemoryRecordCache,transaction:e}),o=new N.V9(t,n.pointer);return X.R3({parent:a.getSpaceViewsStore(),append:n,transaction:e}),X.MK({parent:a.getSpaceViewPointersStore(),append:n,transaction:e}),t.device.isMobileNative&&r.log({level:"info",from:"spaceActions",type:"SpaceSwitchingDebug",data:{message:"spaceActions.createSpace setting space"}}),B.default.setState({...B.default.state,currentSpaceStore:k,currentSpaceViewStore:o}),W.VT(t,{from:l,planType:d,isProfessionalTeamUser:(0,I.QZ)(),domain_type:(0,I.JF)()}),{spaceViewStore:o}}});return await M,await Q.Yh(t),{spaceViewStore:P,spaceStore:k,inviteLinkCode:w,teamStore:x,personaTeamStore:T}}throw new Error(C.default.formatMessage(ce.loginToCreateSpace))}async function ue(e){const{environment:t,blockStores:n,spaceId:o,targetParent:s}=e,{id:l}=t.currentUser;if(l){if(!O.Z.state.online)return{error:C.default.formatMessage(ce.moveToSpaceOnlineError)};const e=[],m=[];for(const t of n)t.isDefined()&&(e.push({id:t.id,spaceId:t.getSpaceId()}),m.push(o));if(i.jj(m).length>1)return{error:C.default.formatMessage(ce.cannotMoveShardRestriction)};if(s&&s.spaceId!==o)return{error:C.default.formatMessage(ce.cannotMoveShardRestriction)};const f=K.moveToSpace(t,{blocks:e,targetSpaceId:o,targetParent:s,clearPermissions:(0,M.bq)()});let g;for await(const n of f){if(ee.R(n,o),n.error)return k.j(t,"move_to_space_error",{}),r.log({level:"error",from:"spaceActions",type:"moveSpaceError",error:(0,a.Ui)(n.error),data:{userId:l,blocks:e,spaceId:o}}),{error:C.default.formatMessage(ce.cannotMoveContent)};{const e=c.PF.create(n.value.recordMap).getByTable(d.iU);for(const{value:t}of e){var u,p;if("copy_indicator"===(null==t||null===(u=t.value)||void 0===u?void 0:u.type))g=null==t||null===(p=t.value)||void 0===p?void 0:p.id}}}return ee.h(o),{value:g}}return{error:C.default.formatMessage(ce.loginToMoveContent)}}async function pe(e){const{environment:t,spaceViewStore:n,openInNew:o,isNewlyCreatedSpace:i,leavingSpace:a}=e;await n.awaitNonNullValue();const s=n.getSpaceStore();if(!s)throw new Error(C.default.formatMessage(ce.invalidSpaceStoreOnNavigate));if(!o&&(G.qL({bannerStore:Z.Z,id:"SubscriptionEditingBlocker"}),t.device.isMobileNative&&r.log({level:"info",from:"spaceActions",type:"SpaceSwitchingDebug",data:{message:"spaceActions.switchToSpace",spaceId:s.id}}),B.default.setState({...B.default.state,currentSpaceStore:s,currentSpaceViewStore:n}),a)){const e=await(0,T.rg)(t,n);B.default.setState({...B.default.state,mainEditorCurrentBlockStore:e})}z.Z.reset();const l=t.currentUser.id,c=n.getUserRootParentId();if(c&&l!==c){const e=await se.x({environment:t,newCurrentUserId:c});await L.OR({environment:e,spaceId:s.id,isNewlyCreatedSpace:i});const{currentUserSettingsStore:n,currentUserRootStore:o}=B.default.state;return{switchedUser:!0,newEnvironment:e,newUserRootStore:o,newUserSettingsStore:n}}return await L.OR({environment:t,spaceId:s.id,isNewlyCreatedSpace:i}),{switchedUser:!1}}async function me(e){B.default.setState({...B.default.state,spaceTransitionStatus:e.navigationType}),await async function(e){const{spaceViewStore:t,redirectPageId:n,openInNew:i,isNewlyCreatedSpace:a,templateGalleryItem:s,projectManagementLaunch:l,leavingSpace:c,pageVisitSource:u}=e;let{environment:p,userSettingsStore:m,userRootStore:f}=e;const g=t.getSpaceStore();if(!g)throw new Error(C.default.formatMessage(ce.invalidSpaceStoreOnNavigate));const h=await pe({environment:p,spaceViewStore:t,openInNew:i,isNewlyCreatedSpace:a,leavingSpace:c});h.switchedUser&&(p=h.newEnvironment,m=h.newUserSettingsStore,f=h.newUserRootStore),F.Z.isAiEnabled()&&S.L6.loader().then((e=>{let{assistantActions:t}=e;t.clearAllAssistantSessions()}));const v=f&&f.getSpaceViewStores(),b=T.g4(p,null==t?void 0:t.getModel()),y=D.Al(t);if(n)return void _._({environment:p,store:new N.G(p,{table:d.iU,id:n}),openInNew:i,pageVisitSource:u});if(f&&await V.Z.reinitializeState(p,f.id,g.id),"last_visited_page"===b){const e=fe({environment:p,spaceId:g.id});if(e&&e.canRead()&&e.pathIsAccessibleAndAlive()&&!x.IJ(p,e))return void _._({environment:p,store:e,openInNew:i,templateGalleryItem:s,projectManagementLaunch:l,pageVisitSource:o.tY.LastVisitedPage})}if("personal_home"===b&&y&&(await y.load(),y.canRead()))return _._({environment:p,store:y,openInNew:i,templateGalleryItem:s,projectManagementLaunch:l,pageVisitSource:o.tY.DefaultHome}),void(0,R.$X)({environment:p,from:"on_app_start_page"});const w=await(0,T.rg)(p,t);if(w)_._({environment:p,store:w,openInNew:i,templateGalleryItem:s,projectManagementLaunch:l,pageVisitSource:u});else if(g.canEdit()){const{performResult:e}=ae.createAndCommit({userAction:"spaceActions.createdPage",environment:p,perform:e=>ie.KE({environment:p,spaceStore:g,spaceViewStore:t,isPrivate:!0,transaction:e,prepend:!1})});_._({environment:p,store:e,openInNew:i,pageVisitSource:u})}else{if(m&&f&&v&&v.length>0&&v[0]&&v[0].id!==t.id)return Y.vq(),p.device.isMobileNative&&r.log({level:"info",from:"spaceActions",type:"SpaceSwitchingDebug",data:{message:"navigateToFirstSpace because navigateToSpace didn't find a page"}}),void(await ge({environment:p,userRootStore:f,userSettingsStore:m,openInNew:i,pageVisitSource:u}));Y.vq(),await P.xN(p)}}(e),await Q.Yh(e.environment),B.default.setState({...B.default.state,spaceTransitionStatus:"notTransitioning"})}function fe(e){const{spaceId:t}=e,n=V.Z.getWithoutSubscribing(t);if(!Array.isArray(n))return;const o=n[0];return void 0!==(null==o?void 0:o.pageId)?o.store:void 0}async function ge(e){const{environment:t,userRootStore:n,ignoreSpaceId:o,userSettingsStore:r,openInNew:i,skipPendingTransferWorkspaces:a,leavingSpace:s,templateGalleryItem:l,projectManagementLaunch:c,pageVisitSource:d}=e;await n.load();const u=n.getSpaceViewStores();await Promise.all(u.map((e=>e.load())));const p=u.filter((e=>{var t;return!!e.isDefined()&&(o?e.getSpaceId()!==o:!a||!(0,h.DI)(null===(t=e.getSpaceStore())||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.space_request))}));let m;for(const f of p){if(!T.Cx(f.getSpaceStore())){m=f;break}{const e=await(0,T.rg)(t,f);if(e&&e.isDefined()){m=f;break}}}m?await me({environment:t,spaceViewStore:m,userSettingsStore:r,userRootStore:n,openInNew:i,leavingSpace:s,templateGalleryItem:l,projectManagementLaunch:c,pageVisitSource:d,navigationType:"switchingToOrLoadingSpace"}):(Y.vq(),await P.xN(t))}async function he(e){const{environment:t,index:n,userRootStore:r,userSettingsStore:i}=e,a=E.Z.getAllSpaceViewStores(t)[n];a&&await me({environment:t,spaceViewStore:a,userSettingsStore:i,userRootStore:r,pageVisitSource:o.tY.SwitchSpace,navigationType:"switchingToOrLoadingSpace"})}async function ve(e){const{environment:t,spaceStore:n}=e;n.isDefined()&&!(0,g.Z)(n.getEmailDomains(),e.emailDomains)&&H.xG(t,{domains:e.emailDomains||[],confirmed:!0});const o={email_domains:e.emailDomains};e.name&&(o.name=e.name);const r={};for(const a of(0,b.Yd)(o)){const e=n.getKeyStore(a).getValue(),t=o[a];i.Xy(e,t)||(r[a]=t||null)}i.xb(r)||await new Promise(((e,o)=>{ae.createAndCommit({userAction:"spaceActions.updateSpace",environment:t,perform:t=>{ne.sW({store:n,data:r,transaction:t}),t.postSubmitCallbacks.push((t=>{t?o(t):e()}))}})}))}async function be(e){const{environment:t,spaceStore:n,domain:o}=e,r=U.Z.getPublicSpaceData(t,n.id);(null==r?void 0:r.domain)!==o&&(await K.updateSpaceDomain(t,{spaceId:n.id,domain:o}),U.Z.getPublicSpaceData(t,n.id,!0))}async function ye(e){const{environment:t,spaceStore:n,publicHomePage:o}=e,r=U.Z.getPublicSpaceData(t,n.id);(null==r?void 0:r.publicHomePage)!==o&&(await K.updatePublicHomePage(t,{spaceId:n.id,publicHomePage:o}),U.Z.getPublicSpaceData(t,n.id,!0))}function _e(e){const{environment:t,spaceStore:n,domain:o}=e,{currentUserStore:r}=B.default.state;return K.checkSpaceDomain(t,{spaceId:n.id,domain:o},null==r?void 0:r.id)}async function Se(e){const{environment:t,spaceStore:n,spaceBasicSettingsStore:o,securitySettingsStore:r}=e,{name:i,domain:a,emailDomains:s,publicHomePage:l}=o.state;await Promise.all([ve({environment:t,spaceStore:n,name:i,emailDomains:s}),be({environment:t,spaceStore:n,domain:a}),ye({environment:t,spaceStore:n,publicHomePage:l}),r?re.n(t,{spaceStore:n,securitySettingsState:r.state}):Promise.resolve()])}const we=function(e){const{environment:t,transaction:n,spaceStore:o,disablePublicAccess:r,disableGuests:i,disableMoveToSpace:a,disableExport:s,disableSpacePageEdits:l,disablePublicAccessRequests:c,disableTeamCreation:d,disableMembershipRequests:u,disableExternalMembershipRequests:p,disableGuestMembershipRequests:m,enableAiFeature:f,disableTeamGuests:g,enableGuestInviteRequests:h}=e;ne.sW({store:o,data:{disable_public_access:r,disable_guests:i,disable_move_to_space:a,disable_export:s,disable_space_page_edits:l,disable_public_access_requests:c,settings:{...o.getSettings(),enable_ai_feature:f,disable_team_guests:g,enable_guest_invite_requests:h},disable_team_creation:d},transaction:n}),ae.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","disable_membership_requests"],command:"set",args:u},transaction:n}),ae.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","disable_external_membership_requests"],command:"set",args:p},transaction:n}),ae.applyOperation({store:o,operation:{pointer:o.pointer,path:["settings","disable_guest_membership_requests"],command:"set",args:m},transaction:n}),c&&q.Jp(t,{disable_public_access_requests:c})},ke=function(e){const{transaction:t,spaceStore:n,inviteLinkEnabled:o}=e;ne.sW({store:n,data:{invite_link_enabled:o},transaction:t})};async function Ie(e){const{environment:t,spaceId:n,userRootStore:i,navigate:s,analyticsFrom:l,userSettingsStore:c,redirectPageId:d,inviteCode:u}=e,p=i.getSpaceViewStores().find((e=>e.getSpaceId()===n));if(w.default.isAdminMode||K.setSpaceNotificationsAsRead(t,{timestamp:Date.now(),spaceId:n}),p)return!0!==p.getJoined()&&ae.createAndCommit({userAction:"spaceActions.joinSpace",environment:t,perform:e=>{Fe({spaceViewStore:p,transaction:e})}}),s&&await me({environment:t,spaceViewStore:p,userSettingsStore:c,redirectPageId:d,userRootStore:i,pageVisitSource:o.tY.SwitchSpace,navigationType:"switchingToOrLoadingSpace"}),{spaceViewStore:p};{const p=await K.addUsersToSpace(t,{userIds:[i.id],spaceId:e.spaceId,inviteCode:u});if("failed"===p.type)throw p.body&&p.body.clientData&&"invite_link_disabled"===p.body.clientData.type&&v.Z.remove(A.WX),r.log({level:"error",from:"spaceActions",type:"addUsersToSpace",error:(0,a.Ui)(p.error),data:{miscDataToConvertToString:{response:p}}}),p.error;const m=i.getSpaceViewStores();await Promise.all(m.map((e=>e.load())));const f=m.find((e=>e.getSpaceId()===n));if(!f)throw new Error(C.default.formatMessage(ce.noSpaceViewOnJoin));const g=f.getJoined();if(!0!==g&&ae.createAndCommit({userAction:"spaceActions.joinSpace",environment:t,perform:e=>{Fe({spaceViewStore:f,transaction:e})}}),s&&await me({environment:t,spaceViewStore:f,userSettingsStore:c,redirectPageId:d,userRootStore:i,pageVisitSource:o.tY.SwitchSpace,navigationType:"joiningOrCreatingSpace"}),L.OR({environment:t,spaceId:e.spaceId}).then((()=>{W.kj(t,{from:l})})),v.Z.remove(A.WX),t.device.isMobileNative&&r.log({level:"info",from:"spaceActions",type:"SpaceSwitchingDebug",data:{message:"spaceActions.joinSpace"}}),B.default.setState({...B.default.state,currentSpaceStore:f.getSpaceStore(),currentSpaceViewStore:f}),Q.Th({environment:t,force:!0}),await Q.Yh(t),!0!==g){const e=u?"shareable_link_join":"verified_domain_join";W.Jk(t,{invite_origin:e,domainType:(0,I.JF)(),new_workspace_member_count:1,new_workspace_member_ids:[i.id]})}return{spaceViewStore:f}}}async function Ce(e){const{environment:t,spaceId:n,userSettingsStore:r}=e,{currentUserRootStore:i,currentUserStore:a}=B.default.state;if(i&&a){const e=await K.removeUsersFromSpace(t,{userIds:[a.id],spaceId:n,removePagePermissions:!0,revokeUserTokens:!1});return"success"===e.type?(ge({environment:t,userRootStore:i,ignoreSpaceId:n,userSettingsStore:r,leavingSpace:!0,pageVisitSource:o.tY.SwitchSpace}),!0):($.showError(e),!1)}}async function xe(e){const{environment:t,spaceId:n,userSettingsStore:r}=e,{currentUserRootStore:i,currentUserStore:a}=B.default.state;if(i&&a){J.j({message:ce.deletingWorkspace});try{const{value:e}=await K.deleteSpace(t,{spaceId:n}).next();if(e.error)throw e.error;await oe.bG({environment:t,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,pointer:{table:f.dx,id:i.id},userId:t.currentUser.id}),ge({environment:t,userRootStore:i,ignoreSpaceId:n,userSettingsStore:r,pageVisitSource:o.tY.SwitchSpace})}finally{J.x()}}}function Te(e){const{environment:t,blocks:n,transaction:o}=e,r=t.currentUser.id;if(r)for(const i of n){const e=i.getPermissionItems().filter((e=>(0,s.FB)(e)));ne.sW({store:i,data:{permissions:[...e,{type:"user_permission",role:"editor",user_id:r}]},transaction:o})}}function Me(e){const{environment:t,blocks:n,transaction:o}=e;if(t.currentUser.id)for(const r of n){const e=r.getPermissionItems(),n=e.find((e=>"space_permission"===e.type)),i=e.filter((e=>(0,s.FB)(e)));n||te.ep({environment:t,store:r,permissionItems:[...i,{type:"space_permission",role:"editor"}],transaction:o})}}function Pe(e){const{blocks:t,transaction:n}=e;for(const o of t){const e=o.getPermissionItems().filter((e=>(0,s.FB)(e)));ne.sW({store:o,data:{permissions:e.length>0?e:null},transaction:n})}}function Ae(e){const{spaceStore:t,transaction:n}=e;if(!t.isDefined())throw new Error(C.default.formatMessage(ce.noLocalDataForPermissionGroup));const o=Date.now(),r={id:(0,l.ZP)(),last_edited_time:o},i=[r,...t.getPermissionGroups()];return ne.sW({store:t,data:{permission_groups:i},transaction:n}),r}function Re(e){const{spaceStore:t,group:n,transaction:o}=e;if(!t.isDefined())throw new Error(C.default.formatMessage(ce.noLocalDataForPermissionGroup));const r=t.getPermissionGroups();let i;i=r.findIndex((e=>e.id===n.id))>=0?r.map((e=>e.id===n.id?n:e)):[...r,n],ne.sW({store:t,data:{permission_groups:i},transaction:o})}async function De(e){const{environment:t,spaceStore:n,group:o,transaction:r}=e;if(!n.isDefined())throw new Error(C.default.formatMessage(ce.noLocalDataForPermissionGroup));const i=n.getPermissionGroups().filter((e=>e.id!==o.id));ne.sW({store:n,data:{permission_groups:i},transaction:r}),await K.transferPermissionGroup(t,{spaceId:n.id,groupId:o.id})}const Ee=function(e){const{userRootStore:t,spaceViewIds:n,transaction:o,spaceViewPointers:r}=e;ne.sW({store:t,data:{space_views:n,space_view_pointers:r},transaction:o})};function Be(e){const{planType:t,spaceStore:n,transaction:o}=e;ne.sW({store:n,data:{plan_type:t},transaction:o})}function Fe(e){ne.sW({store:e.spaceViewStore,data:{joined:!0},transaction:e.transaction})}function Oe(e){let{domain:t,environment:n,spaceId:o}=e;return new Promise(((e,r)=>{const i=U.Z.getPublicSpaceData(n,o);t!==(null==i?void 0:i.domain)&&null!=i&&i.hasPublicPages?$.showDialog({message:(0,le.jsxs)("div",{style:{overflowWrap:"anywhere"},children:[(0,le.jsx)(y.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.prompt",defaultMessage:"This workspace has public pages. If you proceed with changing the domain, any existing links starting with {current_domain}.notion.site will no longer work.",values:{current_domain:(null==i?void 0:i.domain)||"your_domain"}}),(0,le.jsx)("p",{}),(0,le.jsx)(y.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.areYouSure",defaultMessage:"Are you sure you want to change your domain?"})]}),showCancel:!1,keepFocus:!0,items:[{label:(0,le.jsx)(y.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.changeButton.label",defaultMessage:"Change"}),color:"red",onAccept:()=>e(!0)},{label:(0,le.jsx)(y.FormattedMessage,{id:"spaceBasicSettings.changeWorkspaceDomain.cancelButton.label",defaultMessage:"Cancel"}),color:void 0,onAccept:()=>e(!1)}]}):e(!0)}))}function Ze(e,t,n){const o=n||B.default.state.currentSpaceStore;if(!o)throw r.log({level:"error",from:"spaceActions",type:"setSpaceSurveyData",error:{message:"Couldn't find a SpaceStore."}}),new Error;ae.createAndCommit({userAction:"spaceActions.setSpaceSurveyData",environment:e,perform:e=>{Le(o,e,{space_survey_data:t})}})}function Ve(e){var t;const n=B.default.state.currentSpaceStore;n?null!==(t=n.getSettings())&&void 0!==t&&t.seen_block_limit_reduction_v2||((0,j.KC)(),ae.createAndCommit({userAction:"spaceActions.setBlockLimitIncrease",environment:e,perform:e=>{Le(n,e,{seen_block_limit_increase:!0})}})):r.log({level:"error",from:"spaceActions",type:"setBlockLimitIncrease",error:{message:"Couldn't find a SpaceStore to set block increase experiment."}})}function Ue(e){const t=B.default.state.currentSpaceStore;t?((0,j.lF)(),ae.createAndCommit({userAction:"spaceActions.setShowBlockLimitEarlier",environment:e,perform:e=>{Le(t,e,{seen_block_limit_earlier:!0})}})):r.log({level:"error",from:"spaceActions",type:"setShowBlockLimitEarlier",error:{message:"Couldn't find a SpaceStore to set show block limit earlier experiment."}})}function Ne(e){const t=e.getEditDomain();return t?`${window.location.host}/${t}`:null}function Le(e,t,n){ae.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings"],command:"update",args:{...e.getSettings(),...n}},transaction:t})}},28014:(e,t,n)=>{n.d(t,{Hj:()=>w,KE:()=>S,OQ:()=>k,cc:()=>I,sY:()=>_,ux:()=>C});n(21703);var o=n(41432),r=n(4615),i=n(21202),a=n(70203),s=n(97880),l=n(9291),c=n(33929),d=n(48779),u=n(77080),p=n(79797),m=n(81193),f=n(54532),g=n(3297),h=n(94419),v=n(9953),b=n(4408),y=n(993);const _=(0,l.defineMessages)({createAndDuplicatePageError:{defaultMessage:"Duplicated page could not be created.",id:"spaceActions.createAndDuplicatePageInSpace.copyNotCreated.error"},forkPageError:{defaultMessage:"Could not fork page.",id:"spaceActions.dialogError.forkPageError.message"}});function S(e){const{environment:t,spaceViewStore:n,spaceStore:r,isPrivate:i,prepend:a,title:s,transaction:l,loading:c,tracker:d}=e,p=Boolean(u.default.checkGate("enable_text_crdt_client")&&e.useCrdt),m=v.j4({environment:t,type:c?o.Ti.copyIndicator:o.Ti.page,inMemoryRecordCache:r.inMemoryRecordCache,transaction:l,spaceId:r.id,tracker:d,useCrdt:p});return s&&y.sO({environment:t,store:m.getBlockTitleStore(),value:[[s]],transaction:l}),w({environment:t,spaceStore:r,spaceViewStore:n,pageStore:m,isPrivate:i,location:{type:a?"prepend":"append"},transaction:l}),m}function w(e){const{environment:t,spaceStore:n,spaceViewStore:o,pageStore:r,isPrivate:i,location:a,transaction:l}=e,{id:c}=t.currentUser;let d;i?c&&(d={type:"user_permission",role:"editor",user_id:c}):d={type:"space_permission",role:"editor"},v.sW({store:r,data:{permissions:d?[d]:[]},transaction:l}),i&&k({environment:t,spaceStore:n,spaceViewStore:o,transaction:l});const u=a||{type:"append"};"prepend"===u.type?h.Ce({parent:i?o.getPrivatePagesStore():n.getPagesStore(),prepend:r,before:u.before,transaction:l}):"append"===u.type?h.R3({parent:i?o.getPrivatePagesStore():n.getPagesStore(),append:r,after:u.after,transaction:l}):(0,s.t1)(u)}function k(e){const{environment:t,spaceStore:n,spaceViewStore:o,transaction:r}=e,i=new Set(o.getPrivatePageStores().map((e=>e.id)));(0,d.XD)(t,n).filter((e=>e.isTopLevelPrivatePage({spaceStore:n,environment:t}))).forEach((e=>{i.has(e.id)||h.R3({parent:o.getPrivatePagesStore(),append:e,transaction:r})}))}function I(e){const{environment:t,spaceStore:n,spaceViewStore:o,transaction:r,copyPageId:i,recordMap:a,isPrivate:s,allowCopyExternalObjectInstances:l}=e,d=S({environment:t,spaceStore:n,spaceViewStore:o,isPrivate:s,loading:!0,transaction:r});b.fL({environment:t,inMemoryRecordCache:d.inMemoryRecordCache,recordMap:a,debugSource:"spaceActions.createAndDuplicatePageInSpace"});const u=f.K8(t,{blockId:i,inMemoryRecordCache:d.inMemoryRecordCache,allowCopyCollections:!0,requireFullSubtree:!1,skipTransclusionContainerChildren:!1,allowCopyExternalObjectInstances:l});if(!u)throw new Error(c.default.formatMessage(_.createAndDuplicatePageError));return f.E9({environment:t,sourceBlockId:i,targetBlockPointer:d.pointer,sourceBlockSubtree:u,targetInMemoryRecordCache:d.inMemoryRecordCache,transaction:r,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:d.useCrdt()}),d}async function C(e){const{environment:t,userRootStore:n,isPrivate:o,forkedPageId:s,spaceStore:l,spaceViewStore:d}=e;if(l.canEdit()){const e=p.G.createChildStore(n,{table:i.iU,id:s});g.nM({currentUserId:t.currentUser.id,blockId:void 0});const c=Date.now(),u=await g.OH({environment:t,store:e,spaceStore:l,spaceViewStore:d,isPrivate:o}),f=Date.now()-c;if(m.Xy(t,{from:"onboarding",success:!u.error,template_name:a.QaF(e.getTitleValue()),template_block_id:s,target_space_id:(0,r.F9)(l.id),context:"fork_page_into_space",template_duplication_duration_ms:f}),void 0===u.error)return u.value}throw new Error(c.default.formatMessage(_.forkPageError))}},97627:(e,t,n)=>{n.d(t,{E6:()=>p,GZ:()=>u,MA:()=>h,NY:()=>v,Q1:()=>y,TY:()=>d,ZJ:()=>m,aW:()=>_,kY:()=>f,lo:()=>l,pE:()=>c,pc:()=>b,pu:()=>g});n(21703);var o=n(68626),r=n(97978),i=n(80444),a=n(82530);function s(e,t,n){a.applyOperation({store:e,operation:{pointer:e.pointer,path:["settings"],command:"update",args:{...e.getSettings(),...n}},transaction:t})}function l(e){var t;const{currentSpaceViewStore:n}=i.default.state;n&&void 0===(null===(t=n.getSettings())||void 0===t?void 0:t.space_analytics_settings_prompt)&&a.createAndCommit({userAction:"userSettingsActions.initializeSpaceAnalyticsPromptSettings",environment:e,perform:e=>{s(n,e,{space_analytics_settings_prompt:{status:"showing",num_times_shown:0}})}})}function c(e){var t;const{currentSpaceViewStore:n}=i.default.state;if(!n)return;const o=null===(t=n.getSettings())||void 0===t?void 0:t.space_analytics_settings_prompt;if(!o||"dismissed"===o.status||"hidden"===o.status)return;const r={...o,num_times_shown:o.num_times_shown+1};r.num_times_shown>3&&(r.status="hidden"),a.createAndCommit({userAction:"spaceViewActions.incrementSpaceAnalyticsSettings",environment:e,perform:e=>{s(n,e,{space_analytics_settings_prompt:r})}})}function d(e){var t;const{currentSpaceViewStore:n}=i.default.state;if(!n)return;const o=null===(t=n.getSettings())||void 0===t?void 0:t.space_analytics_settings_prompt;o&&"dismissed"!==o.status&&a.createAndCommit({userAction:"spaceViewActions.incrementspaceAnalyticsSettings",environment:e,perform:e=>{s(n,e,{space_analytics_settings_prompt:{status:"dismissed"}})}})}function u(e){var t;const{currentSpaceViewStore:n}=i.default.state;n&&void 0===(null===(t=n.getSettings())||void 0===t?void 0:t.mfa_settings_prompt)&&a.createAndCommit({userAction:"userSettingsActions.initializeMfaPromptSettings",environment:e,perform:e=>{s(n,e,{mfa_settings_prompt:{status:"showing",num_times_shown:0}})}})}function p(e){var t;const{currentSpaceViewStore:n}=i.default.state;if(!n)return;const o=null===(t=n.getSettings())||void 0===t?void 0:t.mfa_settings_prompt;if(!o||"dismissed"===o.status||"hidden"===o.status)return;const r={...o,num_times_shown:o.num_times_shown+1};r.num_times_shown>3&&(r.status="hidden"),a.createAndCommit({userAction:"spaceViewActions.incrementOrHideMfaPrompt",environment:e,perform:e=>{s(n,e,{mfa_settings_prompt:r})}})}function m(e){var t;const{currentSpaceViewStore:n}=i.default.state;if(!n)return;const o=null===(t=n.getSettings())||void 0===t?void 0:t.mfa_settings_prompt;o&&"dismissed"!==o.status&&a.createAndCommit({userAction:"spaceViewActions.dismissMfaPromptSetting",environment:e,perform:e=>{s(n,e,{mfa_settings_prompt:{status:"dismissed"}})}})}function f(e,t){var n;const{currentSpaceViewStore:o}=i.default.state;if(!o)return;const l=(null===(n=o.getSettings())||void 0===n?void 0:n.page_analytics_opt_out_list)||[];l.includes(t)||(a.createAndCommit({userAction:"spaceViewActions.optOutOfPageAnalyticsForPage",environment:e,perform:e=>{s(o,e,{page_analytics_opt_out_list:[...l,t]})}}),r.j(e,"page_analytics_page_opt_out"))}function g(e,t){var n;const{currentSpaceViewStore:o}=i.default.state;if(!o)return;const l=(null===(n=o.getSettings())||void 0===n?void 0:n.page_analytics_opt_out_list)||[];l.includes(t)&&(a.createAndCommit({userAction:"spaceViewActions.optInToPageAnalyticsForPage",environment:e,perform:e=>{s(o,e,{page_analytics_opt_out_list:l.filter((e=>e!==t))})}}),r.j(e,"page_analytics_page_opt_in"))}function h(e,t){const{currentSpaceViewStore:n}=i.default.state;n&&a.createAndCommit({userAction:"userSettingsActions.emailDigestSetting.onToggle",environment:e,perform:e=>{s(n,e,{notify_email_digest:t})}})}function v(e){const{currentSpaceViewStore:t}=i.default.state;t&&a.createAndCommit({userAction:"spaceViewActions.confirmAdminContentSearchAcknowledgement",environment:e,perform:e=>{s(t,e,{admin_content_search_acknowledgement:!0})}})}function b(e){var t;const{currentSpaceViewStore:n}=i.default.state;n&&(null!==(t=n.getSettings())&&void 0!==t&&t.has_migrated_to_google_drive_external_integration||a.createAndCommit({userAction:"spaceViewActions.setUserMigratedToGoogleDriveExternalIntegrationInSpace",environment:e,perform:e=>{s(n,e,{has_migrated_to_google_drive_external_integration:!0})}}))}function y(e,t,n){const r=n||i.default.state.currentSpaceViewStore;if(!r)throw o.log({level:"error",from:"spaceActions",type:"setUserSurveyData",error:{message:"Couldn't find a SpaceViewStore."}}),new Error;a.createAndCommit({userAction:"spaceViewActions.setUserSurveyData",environment:e,perform:e=>{s(r,e,{user_survey_data:t})}})}function _(e,t){const{shown:n,transactionUserAction:o,spaceViewStore:r}=t;a.createAndCommit({environment:e,userAction:o,perform:e=>{s(r,e,{ai_qna_waitlist_shown:n})}})}},15690:(e,t,n)=>{n.d(t,{gG:()=>w,jL:()=>f,nz:()=>y,ls:()=>_,x2:()=>h,a:()=>g});var o=n(41432),r=n(15157),i=n(9291),a=n(33929),s=n(49085);class l extends s.default{getInitialState(){return{}}setSelected(e,t){this.setState({...this.state,[e]:t})}getSelectedTab(e){return this.state[e]}}const c=new l;var d=n(94419),u=n(9953),p=n(24677),m=n(98104);function f(e){const t=e.getContentStores(),n=e.id,o=c.getSelectedTab(n);return o?t.findIndex((e=>e.id===o)):0}function g(e){const{store:t,index:n,currentUserId:o}=e,r=t.getContentStores()[n];r&&h({store:t,id:r.id,currentUserId:o})}function h(e){const{store:t,id:n,currentUserId:o}=e;c.setSelected(t.id,n),r.Z.set({userId:o,key:b(t.id),value:n})}const v="TabBlock";function b(e){return`${v}-${e}`}function y(e){const{blockId:t,currentUserId:n}=e,o=r.Z.get({userId:n,key:b(t)});o&&c.setSelected(t,o)}function _(e){const{environment:t,store:n,transaction:r}=e,i=u.j4({environment:t,type:o.Ti.text,inMemoryRecordCache:n.inMemoryRecordCache,transaction:r,useCrdt:n.useCrdt()});d.R3({parent:n.getContentStore(),append:i,transaction:r});const a=n.getContentStores()[0];p.eP({environment:t,store:a});const s=a.getBlockTitleStore();m.N_({store:s})}const S=(0,i.defineMessages)({newTab:{id:"tabBlockActions.addTab.title",defaultMessage:"New tab"}});function w(e){const{environment:t,store:n,transaction:r}=e,i=u.j4({environment:t,type:o.Ti.text,inMemoryRecordCache:n.inMemoryRecordCache,transaction:r,properties:{title:[[a.default.formatMessage(S.newTab)]]},useCrdt:n.useCrdt()});return d.R3({parent:n.getContentStore(),append:i,transaction:r}),c.setSelected(n.id,i.id),i}},80402:(e,t,n)=>{n.d(t,{AU:()=>X,DI:()=>N,FC:()=>V,K4:()=>te,MO:()=>O,NE:()=>j,Z5:()=>F,d1:()=>J,e2:()=>Z,j0:()=>K,nA:()=>z,oz:()=>ne,qY:()=>ee,qn:()=>q,zJ:()=>U});n(57658),n(21703);var o=n(15145),r=n(68497),i=n(35011),a=n(80951),s=n(1800),l=n(53877),c=n(61075),d=n(35102),u=n(84682),p=n(42875),m=n(5773),f=n(72126),g=n(59753),h=n(82883),v=n(21202),b=n(23867),y=n(19889),_=n(70203),S=n(37524),w=n(59183),k=n(75330),I=n(95477),C=n(33929),x=n(50694),T=n(77080),M=n(8406),P=n(893),A=n(54569),R=n(96802),D=n(9953),E=n(24677),B=n(82530);function F(e){const{environment:t,selectionKey:n,selection:o}=e;w.Z.setState({isActive:!0,selectionKey:n,selection:o}),E.ZH(t)}function O(){w.Z.setState({isActive:!1})}function Z(e){const{environment:t,selectionKey:n,shiftKey:o,columnCount:r,selection:i}=e;if(o&&i.end.col>0){const e={col:i.end.col-1,row:i.end.row};F({environment:t,selectionKey:n,selection:{start:i.start,end:e}})}else if(!o&&i.start.col>0){const e={col:i.start.col-1,row:i.start.row};F({environment:t,selectionKey:n,selection:{start:e,end:e}})}else if(!o&&0===i.start.col&&i.start.row>0){const e={col:r-1,row:i.start.row-1};F({environment:t,selectionKey:n,selection:{start:e,end:e}})}}function V(e){const{environment:t,selectionKey:n,shiftKey:o,columnCount:r,rowCount:i,selection:a}=e;if(o&&a.end.col<r-1){const e={col:a.end.col+1,row:a.end.row};F({environment:t,selectionKey:n,selection:{start:a.start,end:e}})}else if(!o&&a.start.col<r-1){const e={col:a.start.col+1,row:a.start.row};F({environment:t,selectionKey:n,selection:{start:e,end:e}})}else if(!o&&a.start.col>=r-1&&a.start.row<i-1){const e={col:0,row:a.start.row+1};F({environment:t,selectionKey:n,selection:{start:e,end:e}})}}function U(e){const{environment:t,selectionKey:n,shiftKey:o,selection:r}=e;if(o&&r.end.row>0){const e={col:r.end.col,row:r.end.row-1};F({environment:t,selectionKey:n,selection:{start:r.start,end:e}})}else if(!o&&r.start.row>0){const e={col:r.start.col,row:r.start.row-1};F({environment:t,selectionKey:n,selection:{start:e,end:e}})}}function N(e){const{environment:t,selectionKey:n,shiftKey:o,rowCount:r,selection:i}=e;if(o&&i.end.row<r-1){const e={col:i.end.col,row:i.end.row+1};F({environment:t,selectionKey:n,selection:{start:i.start,end:e}})}else if(!o&&i.start.row<r-1){const e={col:i.start.col,row:i.start.row+1};F({environment:t,selectionKey:n,selection:{start:e,end:e}})}}const L=new Set(["auto_increment_id"]);function j(e){const{selection:t,schema:n,currentRows:o,currentPropertyFormats:r,transaction:i}=e,a=S.AV(t);for(let s=a.minRow;s<=a.maxRow;s++){const e=o[s];if(e)for(let t=a.minCol;t<=a.maxCol;t++){const o=r[t],a=n[o.property];null!=a&&a.type&&L.has(a.type)||D.sO({store:e.getPropertyStore(o.property),value:null,transaction:i})}}}const z=e=>{q(e),j(e)},q=e=>{const{selection:t,currentRows:n,event:r}=e;if(null===r.clipboardData)return;const i=S.AV(t);let a="";const l=[],d=n.slice(Math.max(0,i.minRow),i.maxRow+1).filter((e=>e&&e.isDefined()));for(const o of d){const t=[];l.push(t);for(let n=i.minCol;n<=i.maxCol;n++){const[r,s]="selectionKey"in e?H({row:o,x:n,collectionViewBlockStore:e.selectionKey.collectionViewBlockStore,...e}):W({row:o,x:n,...e});t.push([r,o.pointer]),s&&(a+=s),n<i.maxCol&&(a+="\t")}o!==f.Z$(d)&&(a+="\n")}if(r.preventDefault(),r.clipboardData.setData("text/plain",a),function(e,t){if(null===e.clipboardData)return;e.clipboardData.setData(S.mH,JSON.stringify(t))}(r,l),"simpleTableStore"in e){const{environment:t,simpleTableStore:n,columnOrder:a,exportJsxRenderer:l}=e;if(!l)return;const{default:u,jsxToStaticMarkup:m}=l,f=t.currentUser.id,h=t.defaultRecordCache.inMemoryRecordCache.makeGetRecordValueFn(f),y=g.om.fromGetRecordValueFn(h),_=a.slice(i.minCol,i.maxCol+1).filter((e=>void 0!==e)),S=(0,c._2)({exportArgs:{root:{table:v.iU,id:n.id,spaceId:(0,b.C)(n.pointer.spaceId)},navigableBlockId:n.id,renderParentBlockId:void 0,blockId:n.id,userTimeZone:(0,p.r)(),intl:C.default.getIntl(),getRecordValue:h,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>{let{toPageId:t}=e;return(0,s.Z)({pageId:t,pageModel:y({table:v.iU,id:t}),baseUrl:I.default.domainBaseUrl,pageVisitSource:o.tY.Export})},baseUrl:I.default.domainBaseUrl,publicDomainName:I.default.publicDomainName,table:{[n.id]:{renderRows:d.map((e=>e.id)),renderColumns:_}},katex:t.KatexStore.getKatex(),resultCache:new Map},renderers:u});if(S){const e=m(S);r.clipboardData.setData("text/html",e)}}};function H(e){const{row:t,x:n,collectionViewBlockStore:o,schema:i,currentPropertyFormats:a}=e,s=a[n],l=Y(t,i,s.property);if(!t.isDefined())return[l,void 0];return[l,(0,r.L)({property:s.property,schema:i,block:t.getModel(),getRecordModel:o.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,p.r)(),depth:0,intl:C.default.getIntl(),visitedProperties:new Set,resultCache:new Map},exportedFilePaths:!1})]}function W(e){const{row:t,x:n,columnOrder:o,simpleTableStore:r}=e,i=t.getPropertyStore(o[n]);return[i.getValue()||[],(0,h.X)({textValue:i.getValue(),getRecordModel:r.getRecordModel,userTimeZone:(0,p.r)(),intl:C.default.getIntl()})]}function K(e){const{environment:t,selection:n,currentRows:o,event:r,transaction:i,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s}=e;if(!r.clipboardData)return;let l;const c=r.clipboardData.getData(S.mH),d=r.clipboardData.getData("text/html");if(c)l=JSON.parse(c);else if(d){const e=document.createElement("div");e.innerHTML=d;const t=e.querySelector("table");if(t){const e=t.querySelectorAll("tr");l=[];for(const t of Array.from(e)){const e=[],n=t.querySelectorAll("td, th");for(const t of Array.from(n)){const n=_.TPx(t.textContent||"");e.push([n,void 0])}l.push(e)}}}if(!l){const e=function(e){const{event:t,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o}=e;if(!t.clipboardData)return;const{text:r,html:i,multiTextSelectionData:a,textSelectionData:s,blockSelectionData:l}=P.e0({clipboardData:t.clipboardData,tinyMceMicrosoftWordPasteFilter:o});if(a)return P.of({text:r,html:i,stripText:!1,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o});if(s){const{editing:e,selection:t}=s;return _.OAI(_.xrQ(e,t.startIndex,t.endIndex).tokensInsideRange)}if(i||r)return function(e){const{text:t,html:n,blockSelectionData:o,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:i}=e,a=t.includes("\n");return a||o&&o.blocks.length>0?_.TPx(t):P.of({text:t,html:n,stripText:!1,markdownLinkifyIt:r,tinyMceMicrosoftWordPasteFilter:i})}({text:r,html:i,blockSelectionData:l,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o})}({event:r,markdownLinkifyIt:a,tinyMceMicrosoftWordPasteFilter:s});e&&(l=[[[e,void 0]]])}if(l){const r=S.AV(n),a=l[0].length;let s=Math.floor((r.maxCol-r.minCol+1)/a);0===s&&(s=1);const c=l.length;let d=Math.floor((r.maxRow-r.minRow+1)/c);0===d&&(d=1);for(let t=0;t<d;t++)for(let n=0;n<s;n++){const s=r.minCol+n*a,d=r.minRow+t*c;for(let t=0;t<c;t++){let n=o[d+t];if(!n){const t="selectionKey"in e?G(e):x.HM.appendRow(e);t&&(e.currentRows.push(t),n=t)}for(let o=0;o<a;o++){const r=l[t][o];if(!r)continue;const a=s+o;"currentPropertyFormats"in e?$({row:n,x:a,serializedValue:r,currentPropertyFormats:e.currentPropertyFormats,transaction:i,schema:e.schema}):Q({row:n,x:a,serializedValue:r,columnOrder:e.columnOrder,transaction:i})}}}const u={start:{col:r.minCol,row:r.minRow},end:{col:r.minCol+a*s-1,row:r.minRow+c*d-1}};"selectionKey"in e?F({environment:t,selectionKey:e.selectionKey,selection:u}):x.HM.selectMultiCell({environment:t,start:u.start,end:u.end,simpleTableStore:e.simpleTableStore})}}function G(e){const{environment:t,currentRows:n,collectionContextStore:o,selectionKey:r,transaction:i}=e,{groupFormat:a}=r,s=A.IW({environment:t,collectionContextStore:o,groupsPointer:a?[a]:[],insertAtIndex:n.length,shouldCoerce:!0,initializeDefaultTemplate:!1,transaction:i,from:"table_paste_selection"});return null==s?void 0:s.newStore}function $(e){var t;const{row:n,x:o,serializedValue:r,currentPropertyFormats:i,transaction:s,schema:l}=e,c=i[o];if(!c)return;if("verification"===(null===(t=l[c.property])||void 0===t?void 0:t.type))return;const[d,u]=r;if(D.sO({store:n.getPropertyStore(c.property),value:d,transaction:s}),u){var p;const e=d?a.g(d):void 0,t=(0,m.jy)(e,[I.default.secureFileS3.url,I.default.secureFileS3V2.url],(null===(p=I.default.secureFileConfig)||void 0===p?void 0:p.rootPath)??"");D.nj({store:n,source:u,fileIds:t.map((e=>e.id)),transaction:s})}}function Q(e){const{row:t,x:n,serializedValue:o,transaction:r,columnOrder:i}=e,a=i[n];if(!a)return;const[s,l]=o;D.sO({store:t.getPropertyStore(a),value:_.OAI(s),transaction:r})}const Y=function(e,t,n){const o=t[n];if(!o)throw new Error("Property not found");if(!e.isDefined())return[];const r=e.getPropertyValue(n);if("formula"===o.type){if("v2"===o.version){if(!o.formula2)return[];const t=(0,i.EC)({block:e.getModel(),property:n,formulaCode:o.formula2.code,getRecordModel:e.getRecordModel,intl:C.default.getIntl(),userTimeZone:(0,p.r)(),depth:0,visitedProperties:new Set,resultCache:new Map});return t?(0,d.j4)(t):[]}{const o=(0,u.y4)({property:n,schema:t,block:e.getModel(),getRecordModel:e.getRecordModel,collectionRequestContext:{userId:void 0,userTimeZone:(0,p.r)(),depth:0,intl:C.default.getIntl(),resultCache:new Map,visitedProperties:new Set}});return _.TPx(o)}}if("created_time"===o.type&&e.getCreatedTime())return a.d7(l.CQ(e.getCreatedTime(),(0,p.r)()));if("created_by"===o.type&&e.getCreatedByPointer()){const{table:t,id:n}=e.getCreatedByPointer()??{};return n&&t===y.KJ?[_.YCD(["u",n])]:n?[_.YCD(["r",n])]:[]}if("last_edited_time"===o.type&&e.getLastEditedTime())return a.d7(l.CQ(e.getLastEditedTime(),(0,p.r)()));if("last_edited_by"===o.type&&e.getLastEditedByPointer()){const{table:t,id:n}=e.getLastEditedByPointer()??{};return n&&t===y.KJ?[_.YCD(["u",n])]:n?[_.YCD(["r",n])]:[]}return r||[]};function X(e){let{environment:t,collectionViewStore:n,currentValue:o}=e;B.createAndCommit({userAction:"tableActions.toggleTableVerticalLines",environment:t,perform:e=>{R.FH({stores:[n],update:{hide_table_vertical_lines:!o},transaction:e})}})}function J(e){let{environment:t,collectionViewStore:n,currentValue:o}=e;const r="title"===o?void 0:"title";B.createAndCommit({userAction:"tableActions.toggleTableSubitemToggleOnTitle",environment:t,perform:e=>{R.FH({stores:[n],update:{table_subitem_toggle_column:r},transaction:e})}})}function ee(e){let{environment:t,collectionViewStore:n,currentValue:o}=e;const r=n.getFormat().table_properties,i=null==r?void 0:r.map((e=>({...e,wrap:!o})));B.createAndCommit({userAction:"tableActions.toggleTableWrapCells",environment:t,perform:e=>{R.FH({stores:[n],update:{table_wrap:!o,table_properties:i},transaction:e})}})}function te(e){let{property:t,collectionViewStore:n,format:o,formatKey:r,environment:i,currentValue:a}=e;const s=!a,l=n.getFormat().table_wrap,c=o[r]||[];let d=!0;const u=c.map((e=>{let n;return n=e.property===t?s:Boolean(l||e.wrap),n||(d=!1),{...e,wrap:n}})),p={...o,[r]:u,table_wrap:d};B.createAndCommit({userAction:"tableActions.toggleWrapColumn",environment:i,perform:e=>{k.iG({collectionViewStore:n,update:{format:p},transaction:e})}})}function ne(e){let{environment:t,collectionContextStore:n,currentIndex:o,entrypoint:r,transaction:i,propertyAction:a}=e;const s=n.collectionViewStore(),l=n.normalizedFormatStore.state;if(!s||void 0===o)return;const c=n.frozoneStore.state.frozenIndex;let d;switch(a){case"toggle":c!==o?d=o:c===o&&(d=-1);break;case"delete":case"hide":if(!(void 0!==c&&o<=c))return;d=c-1;break;case"duplicate":if(!(void 0!==c&&o<=c))return;d=c+1;break;case void 0:if(c!==o)d=o;else if(c===o)return}const u={...l,table_frozen_column_index:d};n.frozoneStore.setState({...n.frozoneStore.state,frozenIndex:d}),d&&T.default.logEvent("freeze_columns","true",{from:r}),M.wd({environment:t,collectionContextStore:n,action:void 0===d?"table_unfreeze_columns":"table_freeze_column",entrypoint:r,propertyIndex:d}),D.sW({store:s.getFormatStore(),data:u,transaction:i})}},150:(e,t,n)=>{n.d(t,{Ct:()=>g,Hl:()=>h,c0:()=>b,sp:()=>y});n(57658),n(67294);var o=n(72141),r=n(29369),i=n(64684),a=n(9291),s=n(98165),l=n(79797),c=n(17224),d=n(47307),u=n(94419),p=n(9953),m=n(82530),f=n(85893);function g(e){const{environment:t,currentSpaceViewStore:n,orderedTeamIds:o,userAction:i}=e;if(m.createAndCommit({userAction:i,environment:t,perform:e=>{p.sW({store:n,data:{joined_teams:o},transaction:e})}}),e.isExplicitUserAction){const{key:o,startPosition:i,endPosition:a}=e.dropArgs,s=l.zX.createChildStore(n,{table:r.e0,id:o});c.er(t,{store:s,start_position:i,end_position:a})}}async function h(e){let{transaction:t,...n}=e;const{moveToTeam:o,permissionsUpdateItems:r}=function(e){let{moveStores:t,moveTargetStore:n}=e;const o=t.reduce(((e,t)=>(e[t.id]=(0,s.VP)(t),e)),{}),r=(0,s.VP)(n),i=[];for(const a of t){const e=v({blockStore:a,moveFromTeam:o[a.id],moveToTeam:r});e&&i.push(e)}return{moveToTeam:r,permissionsUpdateItems:i}}(n);if(0===r.length)return"not_cleared";const i=await async function(e){let{numPagesMoved:t,moveToTeam:n,permissionsUpdateItems:o}=e;if(0===o.length)return!0;if(!n)return!0;const r=n.getName(),i=o.some((e=>{let{isRemovingRestricted:t}=e;return!0===t})),s=i&&(0,f.jsx)(a.FormattedMessage,{id:"teamActions.confirmMoveToTeam.removeRestrictedDescription",defaultMessage:" {numPagesMoved, plural, one {This page} other {These pages}} will no longer have restricted access.",values:{numPagesMoved:t}});return await d.confirmUserAction({message:(0,f.jsx)(a.FormattedMessage,{defaultMessage:"Are you sure you want to move {numPagesMoved, plural, one {this page} other {these pages}} to {moveToTeamName}?",id:"teamActions.confirmMoveToTeam.title",values:{moveToTeamName:r,numPagesMoved:t}}),description:(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)(a.FormattedMessage,{id:"teamActions.confirmMoveFromTeam.description",defaultMessage:"This will transfer the permissions on {numPagesMoved, plural, one {this page} other {these pages}} to members of {moveToTeamName}. ",values:{moveToTeamName:r,numPagesMoved:t}}),s]})})}({numPagesMoved:n.moveStores.length,moveToTeam:o,permissionsUpdateItems:r});if(!i)return"user_cancelled_move";for(const{blockStore:a,permissions:s}of r)p.sW({store:a,data:{permissions:s},transaction:t});return"cleared"}function v(e){let{blockStore:t,moveFromTeam:n,moveToTeam:r}=e;if(void 0===n&&void 0===r)return;if((null==n?void 0:n.id)===(null==r?void 0:r.id))return;const a=t.getPermissionItems();let s=!1;const l=a.filter((e=>(0,o.Le)(e)?(s=!0,!1):!(0,o.ix)(e)&&(!n||!(0,i.J2)(e,n.id)&&!(0,i.jc)(e,n.id))));return a.length!==l.length?{blockStore:t,permissions:l,moveFromTeam:n,isRemovingRestricted:s}:void 0}function b(e){const{store:t,teamStore:n,transaction:o,location:r}=e,i=n.getTeamPagesStore(),a=l.G.createChildStore(i,t.pointer);"append"===r.type?u.R3({parent:i,append:a,transaction:o,after:r.after}):"prepend"===r.type&&u.Ce({parent:i,prepend:a,transaction:o,before:r.before})}function y(e){const{store:t,teamStore:n,transaction:o}=e,r=n.getTeamPagesStore(),i=l.G.createChildStore(r,t.pointer);u.Od({childToRemove:i,parent:r,transaction:o})}},993:(e,t,n)=>{n.d(t,{AE:()=>Je,Be:()=>Le,Du:()=>Ve,KM:()=>Fe,MY:()=>Be,N3:()=>Te,Nh:()=>nt,O5:()=>Xe,ON:()=>tt,Q0:()=>Qe,QT:()=>Ue,QX:()=>Oe,ST:()=>je,VO:()=>et,YV:()=>We,Zl:()=>ot,aS:()=>Ke,fs:()=>He,g2:()=>Ge,gc:()=>ze,gy:()=>st,hJ:()=>Me,i8:()=>Ze,lZ:()=>$e,mM:()=>Pe,n2:()=>qe,pe:()=>Ce,pz:()=>Ie,sO:()=>Re,vE:()=>lt,wA:()=>Ye});n(57658),n(21703),n(30541);var o=n(1302),r=n(15145),i=n(37167),a=n(97531),s=n(1800),l=n(15095),c=n(35102),d=n(68626),u=n(64572),p=n(72126),m=n(99405),f=n(21202),g=n(70279),h=n(33709),v=n(23867),b=n(70203),y=n(39721),_=n(64002),S=n(82798),w=n(54564),k=n(67133),I=n(62878),C=n(28344),x=n(17707),T=n(95477),M=n(78791),P=n(27105),A=n(14976),R=n(73744),D=n(84210),E=n(68056),B=n(45162),F=n(98165),O=n(46654),Z=n(65598),V=n(18514),U=n(69645),N=n(73959),L=n(60846),j=n(89224),z=n(89086),q=n(35328),H=n(89574),W=n(95802),K=n(98180),G=n(24229),$=n(66949),Q=n(77080),Y=n(72014),X=n(88923),J=n(81236),ee=n(79797),te=n(27724),ne=n(24666),oe=n(45131),re=n(65663),ie=n(36610),ae=n(26189),se=n(6404),le=n(893),ce=n(4727),de=n(36280),ue=n(44886),pe=n(88295),me=n(67060),fe=n(9953),ge=n(12714),he=n(8055),ve=n(61045),be=n(24677),ye=n(84084),_e=n(17269),Se=n(98104),we=n(32741),ke=n(82530);function Ie(e){const{multiSelection:t,environment:n,transaction:o}=e,r=(0,B.L5)(t);if(0===r.length)return;if(1===r.length){const{store:e,selection:t}=r[0];return Ce({environment:n,transaction:o,store:e,selection:t})}const i=t.start.store,a=P.FX(i),s=(0,B.Nj)({multiSelection:t,includeNonSelectable:!1});if(!s)return;const{treeRange:l}=s;if(a){const e=new Set,r=[];for(const t of l.iterateDeletion())if("delete"===t.operation)for(const{childToRemove:e}of(0,U.XL)({treeOperation:t,deleteFrom:"record-store-parent"}))r.push(e);else if("move"===t.operation)for(const n of t.movingChildren)n.value.store&&e.add(n.value.store);let i=0;for(const t of r)i+=1+(0,Z.MI)({blockStore:t,traverseTransclusionReferences:!1}).length;const a=Q.default.getConfigKey("text_crdt_config","delete_merge_slice_tree_block_limit");i<=a?M.Cf({environment:n,transaction:o,multiSelection:t,removedBlocks:r,movedBlocks:e}):d.log({level:"info",from:"deleteMultiSelection",type:"crdt:deleteMultiSelectionOverBlockLimit",data:{miscDataToConvertToString:{blockLimit:a,numBlocksInSelection:i}}})}const{start:c,end:u}=t;Ce({environment:n,transaction:o,selection:{startIndex:c.index,endIndex:1/0},store:c.store});const p=(0,z.x0)(c.store);if(a){const e=(0,S.TO)((0,N.sQ)(u.store),"End of selection must be in a block");Ce({environment:n,transaction:o,selection:{startIndex:0,endIndex:u.index},store:u.store}),M.tE({transaction:o,block:e,targetStore:i})}else p?ze({environment:n,transaction:o,sourceStore:u.store,sourceIndex:u.index,targetStore:c.store,targetIndex:p.endIndex}):Ce({environment:n,transaction:o,store:u.store,selection:{startIndex:u.index,endIndex:1/0}});for(const d of l.iterateDeletion())(0,U.D_)({transaction:o,treeOperation:d,deleteFrom:"record-store-parent"});Se.Z5({store:c.store,selection:p}),be.eP({environment:n,store:l.start.value.store})}function Ce(e){xe({...e,updateSelection:!0,removeInlineRecords:!0})}function xe(e){const{environment:t,store:n,selection:o,transaction:r,updateSelection:i,removeInlineRecords:a}=e,s=n.getValue(),c=b.Ulv(s,o);if(c.startIndex===c.endIndex)return void(i&&Se.Z5({store:n,selection:c}));let d;const u=n.isTable(f.iU)&&(0,N.sQ)(n)||n.getRecordStoreAtRootPath();if(u instanceof ee.G&&P.Ls({store:n,blockStore:u})){const o=(0,S.TO)(u.getTextSliceTree()),i=new l.W3(b.eeV(s)),{startIndex:p,endIndex:m}=i.getInclusiveStringRangeForSelection(c),{operations:f,invertedOperations:g}=o.getOperationsForDeleteText(p,m);re.F({transaction:r,store:u,crdtOperations:f,invertedOperations:g}),Ee(e),d=(0,S.TO)(n.getValue()),a&&at({environment:t,store:n,oldTextValue:s,newTextValue:d,transaction:r,rootStore:u})}else d=b._QS(s,o.startIndex,o.endIndex),De({environment:t,store:n,value:d,transaction:r}),it({environment:t,store:n,oldTextValue:s,newTextValue:d,transaction:r,rootStore:u,removeInlineRecords:a});i&&Se.Z5({store:n,selection:{startIndex:c.startIndex,endIndex:c.startIndex}})}function Te(e){const t=ne.default.state;if("editing"!==t.mode)return;if((0,E.iG)(t.multiSelection))return;const{start:n,end:o}=t.multiSelection,r="start"===e.direction?n:o;ne.default.setState({...t,multiSelection:{start:r,end:r}})}function Me(e){const{environment:t,disableMentions:n,disableDateMentions:o,disableDateReminderMentions:r,disableSlashCommands:i,disableEmojiCommands:a,disableFilters:s,disableTemplateVariableMentions:c,string:d,transaction:u,selectAll:p}=e;if("editing"!==ne.default.state.mode)return;const m="multiSelection"in e?e.multiSelection:(0,E.TD)(e),f=(0,E.QY)(m),g=f?{canRestore:!0,oldSelection:f,toTextValue:f.store.getValue()}:{canRestore:!1};Ie({environment:t,multiSelection:m,transaction:u});const h=b.vJ3(d),v=l.p4(h).length;if(0===v)return;const y=(0,z.bj)(),_=b.V3y(h,y.toArray());Ae({environment:t,store:m.start.store,tokens:[_],index:m.start.index,transaction:u,updateSelection:!1});const S={startIndex:p?m.start.index:m.start.index+v,endIndex:m.start.index+v};Se.Z5({store:m.start.store,selection:S}),s||_e.f({environment:t,store:m.start.store,transaction:u}),g.canRestore&&(n||me._P({environment:t,textStore:g.oldSelection.store,oldSelection:g.oldSelection.selection,oldTextValue:g.toTextValue,disableDateMentions:o,disableDateReminderMentions:o||Boolean(r),disableTemplateVariableMentions:Boolean(c)}),i||ye._P({environment:t,textStore:g.oldSelection.store,oldSelection:g.oldSelection.selection,oldTextValue:g.toTextValue}),a||ce._P({environment:t,textStore:g.oldSelection.store,oldSelection:g.oldSelection.selection,oldTextValue:g.toTextValue}))}function Pe(e){Ae({...e,updateSelection:!0})}function Ae(e){const{environment:t,store:n,index:o,transaction:r,selectAll:i,updateSelection:a}=e,s=e.tokens.map(b.Y_F);if(s.length){const i=n.getValue()||[];if(P.FX(n)){const t=(0,S.TO)((0,N.sQ)(n)),i=(0,S.TO)(t.getTextSliceTree()),a=new l.W3(b.eeV(n.getValue())).getStringStartIndex(o),{operations:c,invertedOperations:d}=i.getOperationsForInsertTextValue(a,s);re.F({transaction:r,store:t,crdtOperations:c,invertedOperations:d}),Ee(e)}else{De({environment:t,store:n,value:b.P$X(i,s,o),transaction:r});const e=n.getRecordStoreAtRootPath();if(e instanceof ee.G){const t=p.zu(b.llS(s),...b.llS(i));for(const n of t){const t=Z.x8(e);ke.applyOperation({transaction:r,store:t,operation:{pointer:t.pointer,path:t.path,command:"listAfter",args:{id:n,after:void 0}}})}}}}if(a){const e=b.eeV(s).length;Se.Z5({store:n,selection:{startIndex:i?o:o+e,endIndex:o+e}})}}function Re(e){const{environment:t,store:n,value:o,transaction:r}=e;P.FX(n)?(xe({environment:t,store:n,selection:{startIndex:0,endIndex:1/0},transaction:r,updateSelection:!1,removeInlineRecords:!0}),o&&b.VrM(o)&&Ae({environment:t,store:n,tokens:o,index:0,transaction:r,updateSelection:!1}),Ee(e)):De(e)}function De(e){const{store:t,value:n,transaction:o}=e;(0,S.T)(!P.FX(t),"setValueInTitleStore should not be used for updating the title of a CRDT block"),fe.sO({store:t,transaction:o,value:(0,a.OI)(b.Zxt(n))}),Ee(e)}function Ee(e){const{environment:t,store:n}=e;if(!n.isTable("block"))return;const o=n.getRecordStoreAtRootPath();if(!o.inMemoryRecordCache.isMockTextStore){const e=o.getValue();e&&ie.ct(t,{block_id:e.id,type:e.type,is_toggleable:(0,q._A)(e.type,e.format)})}}function Be(e){const{environment:t,multiSelection:n,annotation:o,transaction:r}=e,i=b.J7s(o),a=(0,B.L5)(n),s=!b.xw5(o)&&!b.BIG(o)&&Boolean((0,z.a6)(i,n,{}));a.forEach((e=>{let{store:n,selection:a}=e;s?je({environment:t,store:n,annotationTypeOrKey:i,selection:a,transaction:r,updateSelection:!1}):Ne({environment:t,store:n,annotation:o,selection:a,transaction:r})}))}function Fe(e){const{environment:t,multiSelection:n,annotation:o,transaction:r}=e;(0,B.L5)(n).forEach((e=>{let{store:n,selection:i}=e;Ne({environment:t,store:n,annotation:o,selection:i,transaction:r})}))}function Oe(e){const{environment:t,multiSelection:n,annotationTypeOrKey:o,transaction:r}=e;(0,B.L5)(n).forEach((e=>{let{store:n,selection:i}=e;je({environment:t,store:n,annotationTypeOrKey:o,selection:i,transaction:r,updateSelection:!1})}))}function Ze(e){const{environment:t,store:n,selection:o,annotation:r,transaction:i}=e;Be({environment:t,annotation:r,transaction:i,multiSelection:(0,E.TD)({store:n,selection:o})})}function Ve(e){const{environment:t,blocks:n,annotation:o,transaction:r}=e,i=b.J7s(o),a=p.oA(n.map((e=>{const t=e.getTitleStore();if(!t)return;const n=t.getValue();return n?{block:e,titleStore:t,titleValue:n}:void 0}))),s=a.every((e=>{let{titleValue:t}=e;return t.every((e=>b.hDy(e).some((e=>b.J7s(e)===i))))}));for(const{titleStore:l}of a)Ue({environment:t,annotation:o,textStore:l,action:s?"removeAnnotationType":"annotate",transaction:r})}function Ue(e){const{environment:t,annotation:n,transaction:o,textStore:r,action:i}=e;"annotate"===i?Ne({environment:t,store:r,annotation:n,selection:{startIndex:0,endIndex:1/0},transaction:o}):je({environment:t,store:r,annotationTypeOrKey:b.J7s(n),selection:{startIndex:0,endIndex:1/0},transaction:o,updateSelection:!1})}function Ne(e){const{environment:t,store:n,annotation:o,selection:r,transaction:i}=e,a=n.getValue();if(a)if(P.FX(n)){!function(e){const{blockStore:t,selection:n,annotation:o,transaction:r}=e;(0,S.T)(t.useCrdt());const i=t.getBlockTitleStore().getValue(),a=b.Ulv(i,n);if((0,z.wd)(a))return;const s=(0,S.TO)(t.getTextSliceTree()),c=new l.W3(b.eeV(i)),{startIndex:d,endIndex:u}=c.getInclusiveStringRangeForSelection(a),{operations:p,invertedOperations:m}=s.getOperationsForAddAnnotation(d,u,o);re.F({transaction:r,store:t,crdtOperations:p,invertedOperations:m})}({blockStore:(0,S.TO)((0,N.sQ)(n)),selection:r,annotation:o,transaction:i})}else{De({environment:t,store:n,value:b.aSf({textValue:a,selection:r,annotation:o}),transaction:i})}}function Le(e){je({...e,annotationTypeOrKey:e.type,updateSelection:!0})}function je(e){const{environment:t,store:n,selection:o,annotationTypeOrKey:r,transaction:i,updateSelection:a}=e,s=n.getValue();if(!s)return;let c;const d=n.isTable(f.iU)&&(0,N.sQ)(n)||n.getRecordStoreAtRootPath();d instanceof ee.G&&P.Ls({store:n,blockStore:d})?(!function(e){const{blockStore:t,selection:n,annotationTypeOrKey:o,transaction:r}=e;(0,S.T)(t.useCrdt());const i=t.getBlockTitleStore().getValue(),a=b.Ulv(i,n);if((0,z.wd)(a))return;const s=(0,S.TO)(t.getTextSliceTree()),c=new l.W3(b.eeV(i));if("string"==typeof o&&b.WU4(o)){const e=o,n=[],l=[],d=b.fWo({textValue:i,startIndex:a.startIndex,endIndex:a.endIndex,annotationType:e});for(const{startIndex:t,endIndex:o,annotationKey:r}of d){const{startIndex:e,endIndex:i}=c.getInclusiveStringRangeForSelection({startIndex:t,endIndex:o}),{operations:a,invertedOperations:d}=s.getOperationsForRemoveAnnotation(e,i,r);n.push(...a),l.push(...d)}n.length>0&&re.F({transaction:r,store:t,crdtOperations:n,invertedOperations:l})}else{const{startIndex:e,endIndex:n}=c.getInclusiveStringRangeForSelection(a),{operations:i,invertedOperations:l}=s.getOperationsForRemoveAnnotation(e,n,o);re.F({transaction:r,store:t,crdtOperations:i,invertedOperations:l})}}({blockStore:d,selection:o,annotationTypeOrKey:r,transaction:i}),c=(0,S.TO)(n.getValue())):(c=b.STJ({textValue:s,selection:o,annotationTypeOrKey:r}),Re({environment:t,store:n,value:c,transaction:i}),it({environment:t,store:n,oldTextValue:s,newTextValue:c,transaction:i,rootStore:d,removeInlineRecords:!0})),a&&Se.Z5({store:n,selection:o})}function ze(e){const{environment:t,sourceStore:n,sourceIndex:o,targetStore:r,targetIndex:i,transaction:a}=e,s=b.lzi(n.getValue()),l=b.QaF(s).length,{tokensInsideRange:c}=b.xrQ(s,o,l);c.length>0&&(xe({environment:t,store:n,selection:{startIndex:o,endIndex:l},transaction:a,updateSelection:!0,removeInlineRecords:!1}),Pe({environment:t,store:r,tokens:c,index:i,transaction:a}))}function qe(e){const{environment:t,closestSelectable:n,shiftKey:r,transaction:i}=e;if((0,B.Aw)(t))return void function(e){const{transaction:t}=e,n=ne.default.state;if("editing"!==n.mode)return;const{multiSelection:r}=n,i=(0,B.Nj)({multiSelection:r,includeNonSelectable:!0});if(!i)return;const{tree:a,treeRange:s}=i,l=a.value.store,c=y.o.getIndentOperationsFromTreeRange(s,e.direction);for(const o of c){const{target:e,operation:n}=o,r=(0,U.kC)({rootStore:l,root:a,target:e});if(void 0===r)throw new Error("Cannot find node to indent");let i=!1;switch(n){case"indentSelf":case"indentSelfAndSubtree":if(r.length>=2){const e=r[r.length-2],o=r[r.length-1];if(o){let r="indentSelf"===n?"self":"subtree";(0,q.BX)(o)&&!oe.Z.isOpen(o.id)&&(r="subtree");void 0!==ue.dD({block:o,parentStore:e,transaction:t,type:r})&&(i=!0)}}break;case"unindentSelfAndUpdateSiblings":if(r.length>=3){const e=r[r.length-3],n=r[r.length-2],o=r[r.length-1];if(n&&o){void 0!==ue.uv({block:o,parentStore:n,grandparentStore:e,transaction:t})&&(i=!0)}}}i&&y.F.applyMutable(a,o)}o.default.afterNextFlush((()=>{const e=(0,U.kC)({rootStore:l,root:a,target:s.start}),t=(0,U.kC)({rootStore:l,root:a,target:s.end}),n=e&&(0,N.mh)(e[e.length-1]),o=t&&(0,N.mh)(t[t.length-1]);if(n&&o){const e={start:{store:n,index:r.start.index},end:{store:o,index:r.end.index}};Se.NA({multiSelection:e})}}))}({environment:t,transaction:i,direction:e.shiftKey?"unindent":"indent"});const a=r?ue.rB({environment:t,blocks:[n],transaction:i}):ue.WY({environment:t,blocks:[n],transaction:i});if(!a)return;const s=ne.default.state;if("editing"===s.mode){var l;const e=null===(l=(0,B.xI)("textActions",s.multiSelection))||void 0===l?void 0:l.selection;if(!e)return;o.default.afterNextFlush((()=>{const o=W.C.findSelectableFromStore(a[0]);if(be.wI({store:n,replace:a[0]}),o){const n=(0,N.mh)(o.props.store);n?Se.Z5({store:n,selection:e}):be.$Y({environment:t,phase:te.SelectionPhase.Selected})}}))}}function He(e){const{transaction:t,direction:n}=e,r=ne.default.state;if("editing"!==r.mode)return;const{multiSelection:i}=r,a=(0,B.tp)({multiSelection:i,filterCommonAncestors:!0,focus:void 0});if(!a)return;const s=a.stores;("up"===n?ue.A1({transaction:t,blocks:s}):ue.vi({transaction:t,blocks:s}))&&o.default.afterNextFlush((()=>{const[e,t]=W.C.findSelectablesFromIds([i.start.store.id,i.end.store.id]),n=(null==e?void 0:e.props.store)&&(0,N.mh)(null==e?void 0:e.props.store),o=(null==t?void 0:t.props.store)&&(0,N.mh)(null==t?void 0:t.props.store);n&&o&&(Se.NA({multiSelection:{start:{store:n,index:i.start.index},end:{store:o,index:i.end.index}},forceEmit:!0}),ve.Zv())}))}function We(e){const{transaction:t,environment:n,multiSelection:o}=e;o&&!(0,E.qS)(o)&&Ie({environment:n,transaction:t,multiSelection:o}),Ke({...e,usingMultiSelection:!0})}function Ke(e){const{environment:t,store:n,newValue:o,disableMentions:r,disableDateMentions:i,disableSlashCommands:a,disableEmojiCommands:s,disableDateReminderMentions:c,disableFilters:d,disableTemplateVariableMentions:u,transaction:p,usingMultiSelection:m}=e,f=n.getValue(),g=b.QaF(f),h=L.UZ(g,o),v=ne.default.state;if("editing"!==v.mode)return;const y=v.multiSelection.start.index;let _=0;for(let b=0;b<h.length;b++){const e=h[b];if(_+l.p4(e[1]).length>y){if(e[0]===L.JZ){const t=h[b-1],n=h[b+1];let o=h[b-2],r=h[b+2];if(n&&n[0]===L.D$)for(r||(r=[L.JZ,""],h.push(r));_+l.p4(e[1]).length>y&&e[1].endsWith(n[1]);)e[1]=e[1].slice(0,e[1].length-n[1].length),r[1]=n[1]+r[1];else if(t&&t[0]===L.D$)for(o||(o=[L.JZ,""],h.unshift(o));_+l.p4(e[1]).length>y&&e[1].startsWith(t[1]);)e[1]=e[1].slice(t[1].length),o[1]=o[1]+t[1],_-=l.p4(t[1]).length}break}_+=l.p4(e[1]).length}let S=!1,w=!1,k=0;for(const[I,C]of h)if(I===L.D$)S=!0,Me({environment:t,store:n,selection:{startIndex:k,endIndex:k},string:C,disableMentions:r,disableDateMentions:i,disableDateReminderMentions:c,disableSlashCommands:a,disableEmojiCommands:s,disableFilters:d,disableTemplateVariableMentions:u,transaction:p}),k+=l.p4(C).length;else if(I===L.NL){S=!0,w=C===b.qyI;Ce({environment:t,store:n,selection:{startIndex:k,endIndex:k+l.p4(C).length},transaction:p})}else I===L.JZ&&(k+=l.p4(C).length);!S||w||t.TextSelectionCompositionStore.state.isComposing||Ge({environment:t,store:n,usingMultiSelection:m})}function Ge(e){const{environment:t,usingMultiSelection:n,store:o}=e;if(n){const e=j.get(),t=(0,B.fx)({range:e,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0});t&&Se.NA(t)}else{const e=A.Ut(t);e&&(Se.Z5({store:o,selection:e.selection}),e.forceEmitSelectionStore&&ne.default.emit())}}function $e(e){const{environment:t,store:n,selection:o,annotation:r,analyticsFrom:i,transaction:a}=e;Ce({environment:t,store:n,selection:o,transaction:a});const s=(0,z.yj)(o,n).toArray(),l=[b.YCD(r,s),b.V3y(" ",s)];if(Pe({environment:t,store:n,tokens:l,index:o.startIndex,transaction:a}),Se.Z5({store:n,selection:{startIndex:o.startIndex+l.length,endIndex:o.startIndex+l.length}}),b.IWo(r)&&(n.isTable("block")||n.isTable("comment"))){const e=t.currentUser.id,o=b.zEN(r),a=n.getRecordStoreAtRootPath();e&&ae.TI(t,{is_current_user:o===e,user_id:o,user_access_level:(0,O.rc)(o),from:i,block_type:a instanceof ee.G?a.getType():void 0})}else if(b._bk(r)&&(n.isTable("block")||n.isTable("comment"))){var c;const e=null===(c=b.kxk(r))||void 0===c?void 0:c.groupId,o=n.getRecordStoreAtRootPath();e&&ae.Z0(t,{group_id:e,from:i,block_type:o instanceof ee.G?o.getType():void 0})}else if(b.fpG(r)&&(n.isTable("block")||n.isTable("comment"))){const e=b.zyO(r),o=n.getRecordStoreAtRootPath();ae.VN(t,{date:e,from:i,block_type:o instanceof ee.G?o.getType():void 0})}else if(b.STW(r)&&(n.isTable("block")||n.isTable("comment"))){const e=b.TOT(r),o=n.getRecordStoreAtRootPath();ae.Qq(t,{page_id:e,from:i,block_type:o instanceof ee.G?o.getType():void 0})}}function Qe(e){const{environment:t,store:n,selection:o,emoji:r,transaction:i}=e;Ce({environment:t,store:n,selection:o,transaction:i});const a=[b.V3y(r)];Pe({environment:t,store:n,tokens:a,index:o.startIndex,transaction:i}),Se.Z5({store:n,selection:{startIndex:o.startIndex+a.length,endIndex:o.startIndex+a.length}})}function Ye(e){const{environment:t,shouldStripTokens:n,disableFilters:o,store:r,selection:i,transaction:a}=e,s=(0,z.fM)(r,i,n),c=n?b.Jcv(r.getValue()):b.QaF(r.getValue());let d=l.p4(c),u=0;for(const l of s)if(u++,0===l)d.unshift("\t");else{const e=l+u;d=[...p.tP(d,0,e),"\t",...p.tP(d,e)]}Ke({environment:t,store:r,newValue:b.vJ3(d.join("")),disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:o,transaction:a}),Se.Z5({store:r,selection:{startIndex:i.startIndex+1,endIndex:i.endIndex+u}})}function Xe(e){const{environment:t,shouldStripTokens:n,disableFilters:o,store:r,selection:i,transaction:a}=e,s=(0,z.fM)(r,i,n),c=n?b.Jcv(r.getValue()):b.QaF(r.getValue());let d=l.p4(c),u=0,m=0;for(const l of s){const e=l-u;0===e?"\t"===d[0]?(d=p.tP(d,1),u+=1):" "===d[0]&&" "===d[1]?(d=p.tP(d,2),u+=2):" "===d[0]&&(d=p.tP(d,1),u+=1):"\t"===d[e+1]?(d=[...p.tP(d,0,e+1),...p.tP(d,e+2)],u+=1):" "===d[e+1]&&" "===d[e+2]?(d=[...p.tP(d,0,e+1),...p.tP(d,e+3)],u+=2):" "===d[e+1]&&(d=[...p.tP(d,0,e+1),...p.tP(d,e+2)],u+=1),l<=i.startIndex&&(m=u)}Ke({environment:t,store:r,newValue:b.vJ3(d.join("")),disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:o,transaction:a}),Se.Z5({store:r,selection:{startIndex:i.startIndex-m,endIndex:i.endIndex-u}})}function Je(e){const{token:t,store:n,readOnly:o}=e;let r=0,i=0;if(t.textValue){let e=0;for(;e<t.tokenIndex;)r+=b.J1x(t.textValue[e]),e++;i=r+b.J1x(t.textValue[e])}Se.Z5({store:n,selection:{startIndex:r,endIndex:i},readOnly:o})}function et(e){const{environment:t,event:n,interactiveToken:o,store:a,parentStore:l,canEdit:c}=e,d=b.hDy(o.textToken),u=b.rlz(d),p=b.wPk(d),y=b.V8Y(d),S=b.jC0(d),x=b.zrg(d).map((e=>b.h19(e))),M=t.RouterStore.state.route,P=Boolean("chat"===M.name);if(b.YrK(o.textToken)&&!n.shiftKey&&!n.altKey){if(n.preventDefault(),!$.Z.state.open){const e=o.textToken,n=document.createRange(),r=o.node.parentNode,i=o.tokenIndex+1;if(n.setStart(r,o.tokenIndex),n.setEnd(r,i),j.set(n,t.device),Ge({environment:t,store:a,usingMultiSelection:!0}),"editing"!==ne.default.state.mode)return;const s=(0,E.QY)(ne.default.state.multiSelection);if(!s)return;return void de.qn({environment:t,selectedToken:{token:e,position:s.selection},selectionRect:o.node.getBoundingClientRect(),analyticsFrom:"click_token"})}de.Wj()}const A=x.map((e=>{const t=l||a;return ee.t1.createChildStore(t,{table:h.qF,id:e,spaceId:(0,v.C)(t.pointer.spaceId)})})),{unresolved:B}=Z.bB(A);if(B.length>0){const e=Boolean(u||y),o=G.Z.state.open||t.device.isMobile,r=(0,N.sQ)(a);if(e&&o)w.LZ();else if(r){const i=n.target&&n.target.getBoundingClientRect();if(w.Ib({environment:t,blockStore:r,analyticsFrom:"existing_comment",discussionIds:B.map((e=>e.id)),rect:i,shouldFocusDiscussion:!1,recursivelyLoadAllDiscussions:!1}),e&&!o)return void n.preventDefault()}}else{Z.dv(a)||H.Z.find((e=>e.isEditing()))||w.LZ()}let O,U;u&&(O=_.Nm({str:b.zW$(u),allowNoProtocol:!0}));let L=!1;if(y){U=b.TOT(y);const e=ee.G.createChildStore(l||a,{table:f.iU,id:U});L=e.isNavigableBlock();const o=(n.altKey||X.default.isSidePeekOpen())&&!n.metaKey;O=(0,D.ZP)({store:e,openInSidePeek:o,preferPublicLink:(0,V.Sr)(),getSpaceDomain:()=>{var n;return null===(n=J.Z.getPublicSpaceData(t,e.getSpaceId()))||void 0===n?void 0:n.domain},pageVisitSource:r.tY.LinkInPage})}if(S){const{blockId:e}=b.Vv0(S);if(e){const o=ee.G.createChildStore(l||a,{table:f.iU,id:e});L=o.isNavigableBlock(),O=P&&!n.metaKey?(0,i.t)({blockId:o.id,pageVisitSource:r.tY.AIQna}):(0,D.ZP)({store:o,openInSidePeek:!1,preferPublicLink:(0,V.Sr)(),getSpaceDomain:()=>{var e;return null===(e=J.Z.getPublicSpaceData(t,o.getSpaceId()))||void 0===e?void 0:e.domain},pageVisitSource:r.tY.AIQna})}}if(O){n.preventDefault(),Se.ZH(t),we.lY();const{device:e}=t;if(e.isIOS&&Se.sD(),n.shiftKey&&!n.altKey)return;const o=(0,m.Wj)({url:O,baseUrl:T.default.domainBaseUrl,publicDomainName:T.default.publicDomainName,isMobile:t.device.isMobile,protocol:T.default.protocol,currentUrl:window.location.href});if("page"===o.name||"chat"===o.name){const e=R.DJ(n);if(he.c4({environment:t,url:O,openInNew:e}),y&&U&&ae.SK(t,{page_visit_id:Y.$g.getCurrentPageVisitId(),mentioned_page_id:U,source_type:"inline_page_mention_token",hover_preview_enabled:Q.default.checkGate("first_party_links"),is_navigable_block:L}),a.inMemoryRecordCache.isSyntheticAssistantData){const e=K.Z.getActiveAssistantConfigurationState(),n="page"===o.name?o.blockId:o.peekViewBlockId;e&&n&&C.trackQnaResultClicked(t,{configurationState:e,clickedPageId:n,source:"chat"})}}else{if("aiGtmFavoriteImport"===o.name&&t.currentUser.isLoggedIn())return void(0,I.importGtmFavorite)({environment:t,importArgs:o});ge.D({environment:t,url:O})}}else{if(c){const{textToken:e,node:r,tokenIndex:i}=o,s=b.hDy(e);if(b.K9C(s))return we.lY(),k.b(t,{originRect:r.getBoundingClientRect(),textStore:a,tokenIndex:i,allowReminders:"comment"!==a.table}),void n.preventDefault()}if(p){const e=ee.T5.createChildStore(a,{table:g.x_,id:p[1],spaceId:p[2]}),o=e.getModel();if(!o)return;const i=F.Dg(e);if(!i)return;const l=ee.jQ.createChildStore(i,o.getParentPointer()).getModel();if(!l)return;const c=ee.G.createChildStore(i,l.getParentPointer()).getModel(),d=c&&"table_row"===c.getType()?c.getParentId():l.getParentId(),u=(0,s.Z)({pageId:i.id,scrollToBlockId:d,pageModel:i.getModel(),baseUrl:void 0,discussionId:l.id,pageVisitSource:r.tY.MentionInPage});n.preventDefault(),he.c4({environment:t,url:u})}}}function tt(e){const{environment:t,event:n,interactiveToken:o,store:r,parentStore:i}=e;if(!i)return;const a=b.hDy(o.textToken),s=b.V8Y(a);if(s){const e=b.yrl(s);if(!e)return;const o=ee.G.createChildStore(i||r,e);n.preventDefault(),se.Qn({environment:t,stores:[o],left:n.clientX,top:n.clientY,showInput:!1,actionSectionGroupKey:"page_mention",analyticsFrom:"page_mention_block_menu",pageAnnotationToken:{parentStore:i,pageAnnotation:s}})}}function nt(e){we.HM({token:e.interactiveToken,store:e.store})}function ot(e){we.lY()}function rt(e){const{blockStore:t,discussionIds:n,transaction:o}=e;if(t)for(const r of n){const e=ee.t1.createChildStore(t,{table:h.qF,id:r,spaceId:(0,v.C)(t.pointer.spaceId)});x.Gu({discussionStore:e,blockStore:t,transaction:o})}}function it(e){const{oldTextValue:t,newTextValue:n,transaction:o,rootStore:r,removeInlineRecords:i}=e;if(r instanceof ee.G){const e=new Set(p.zu(b.llS(t),...b.llS(n)));if(rt({blockStore:r,discussionIds:e,transaction:o}),r.isType("table_row")){rt({blockStore:r.getParentBlockStore(),discussionIds:e,transaction:o})}}i&&at(e)}function at(e){const{store:t,environment:n,oldTextValue:o,newTextValue:r,transaction:i,rootStore:a}=e;if(a instanceof ee.G){const e=a.getValue();if(e){const s=(0,u.m3)({parentBlock:e,oldTextValue:o,newTextValue:r,getRecordValue:t.getRecordValue,baseUrl:T.default.domainBaseUrl,publicDomainName:T.default.publicDomainName});pe.lP({environment:n,transaction:i,parentStore:a,inlinePageIds:s})}}const s=p.zu(b.zUo(o),...b.zUo(r));for(const l of s){const e=ee.G.createChildStore(a,{table:f.iU,id:l,spaceId:(0,v.C)(a.pointer.spaceId)});fe.sW({store:e,data:{alive:!1},transaction:i})}}function st(e){const{block:t,transaction:n,tokenIndex:o}=e,r=t.getBlockTitleStore();if(!t.getTitleStore()||!r.isDefined()||!r.getValue()||r.getValue().length<o)return!1;const i=r.getValue(),a=b.VrM(i.slice(0,o)),s=b.VrM(i.slice(0,o+1));return xe({environment:t.environment,store:r,selection:{startIndex:a,endIndex:s},transaction:n,updateSelection:!1,removeInlineRecords:!0}),!0}function lt(e){var t;const{store:n,transaction:o}=e,r=le.tk();if(!r)return;if(!("editing"===ne.default.state.mode&&(null===(t=(0,E.QY)(ne.default.state.multiSelection))||void 0===t?void 0:t.selection)))return;const i=n.getValue();if(!i)return;const a=(0,c.UQ)(i,r.parentCollection,n.getRecordModel);Re({environment:n.environment,store:n,value:a,transaction:o})}},98724:(e,t,n)=>{n.d(t,{QE:()=>g,aS:()=>m,bt:()=>h,mX:()=>f});var o=n(72126),r=n(70203),i=n(45162),a=n(65598),s=n(89086),l=n(24666),c=n(9953),d=n(993),u=n(98104),p=n(82530);function m(e){const{environment:t,annotation:n}=e,o=l.default.state;if("editing"!==o.mode)return;if(l.default.isEmptySelection())return void u.Km({annotation:n});const{multiSelection:r}=o;(0,i.L5)(r).length>0&&(p.createAndCommit({userAction:"textAnnotationActions.annotateSelection",environment:t,perform:e=>{d.MY({environment:t,annotation:n,multiSelection:r,transaction:e})}}),u.NA({multiSelection:r}))}function f(e){const{environment:t,annotationType:n}=e,o=l.default.state;if("editing"!==o.mode)return;if(l.default.isEmptySelection())return;const{multiSelection:r}=o,a=(0,i.L5)(r);a.length>0&&(p.createAndCommit({userAction:"textAnnotationActions.unannotateSelection",environment:t,perform:e=>{for(const{selection:o,store:r}of a)d.Be({environment:t,store:r,type:n,selection:o,transaction:e})}}),u.NA({multiSelection:r}))}function g(e){const{environment:t,annotationType:n,blocks:o,transaction:r}=e;for(const i of(0,a.Sd)({blockStores:o,traverseTransclusionReferences:!1})){const e=i.getBlockTitleStore(),o=(0,s.P2)(e);o&&d.Be({environment:t,store:e,type:n,selection:o,transaction:r})}}function h(e){const{environment:t,store:n,context:i,transaction:a}=e;if(!n.canEdit())return;const{title:s,...l}=n.getProperties(),u=Object.entries(l).reduce(((e,t)=>{let[n,a]=t;if(a){const t=r.KV2(a,i);o.Xy(a,t)||(e[n]=t)}return e}),{});o.xb(u)||c.sW({store:n.getPropertiesStore(),data:u,transaction:a});const p=n.getTitleValue();if(p){const e=r.KV2(p,i);o.Xy(p,e)||d.sO({environment:t,store:n.getBlockTitleStore(),value:e,transaction:a})}}},56971:(e,t,n)=>{n.d(t,{YV:()=>M,as:()=>T,ew:()=>x});n(67635);var o=n(1302),r=n(41432),i=n(72126),a=n(78791),s=n(27105),l=n(68056),c=n(73959),d=n(89086),u=n(35328),p=n(28685),m=n(95802),f=n(77080),g=n(24666),h=n(96802),v=n(44886),b=n(94419),y=n(42858),_=n(24677),S=n(993),w=n(98104),k=n(68422);function I(e){const{transaction:t,store:n,block:o,targetStore:r,targetBlock:i}=e;o&&(0,s.Ls)({store:n,blockStore:o})&&i&&(0,s.Ls)({store:r,blockStore:i})?a.tE({transaction:t,targetStore:r,block:o}):C(e)}function C(e){const{environment:t,transaction:n,store:o,targetStore:r}=e,i=(0,d.x0)(r);i?S.gc({environment:t,sourceStore:o,sourceIndex:0,targetStore:r,targetIndex:i.endIndex,transaction:n}):S.pe({environment:t,transaction:n,store:o,selection:{startIndex:0,endIndex:1/0}})}function x(e){const{environment:t,store:n,transaction:i}=e;i.annotateWithUserAction("textBackspaceActions.annotatedContentBlockBackspaceAtBeginning");const a=(0,c.sQ)(n);if(a){"callout"===a.getType()&&h.FH({stores:[a],update:{block_color:void 0},transaction:i});let e=a,n=r.Ti.text;if(u.fn(a)){const e=a.getType();e&&(n=e)}e=k.vs({environment:t,block:a,blockType:n,transaction:i}),o.default.afterNextFlush((()=>{const n=m.C.findEditableStoreWithin(e);n&&(w.N_({store:n}),_.eP({environment:t,store:e}))}))}return n}function T(e){const{environment:t,multiSelection:n,transaction:a,deleteForwards:s,event:k}=e,T=t.device.isApple&&k.metaKey,M=!(t.device.isIOS&&(0,l.iG)(n));w.aJ();const P=(0,l.QY)(n);if(P&&0===P.selection.startIndex&&0===P.selection.endIndex&&!s){const{store:e}=P;k.preventDefault();const n=(0,c.sQ)(e);if(n){const s=n.getModel();if(s){const n=s.isType(r.q7);n&&!T?x({environment:t,store:e,transaction:a}):s.isType(r.Q3)||n&&T?function(e){const{store:t,transaction:n,environment:r}=e;n.annotateWithUserAction("textBackspaceActions.textBackspaceAtBeginning");const a=(0,c.sQ)(t);if(!a)return;const s=(0,c.sQ)(a),l=s&&(0,c.sQ)(s);if(s&&l){const e=s.getRenderableContentIds()??[];if(!(i.Z$(e)!==a.id||s.isTransclusionType()||u.BX(s)&&i.Ps(e)===a.id||"tab"===l.getType())){const e=v.uv({block:a,parentStore:s,grandparentStore:l,transaction:n});if(e)return void o.default.afterNextFlush((()=>{if(e){const t=m.C.findEditableStoreWithin(e);t&&(_.eP({environment:r,store:e}),w.N_({store:t}))}}))}}if(f.default.checkGate("text_align")){if("center"===a.getFormat().block_alignment)return void h.hc({environment:r,store:a,alignment:"left",transaction:n});if("right"===a.getFormat().block_alignment)return void h.hc({environment:r,store:a,alignment:"center",transaction:n})}const g=p.E.getMembersByDOMOrder({filter:e=>!e.props.store.inMemoryRecordCache.isMockTextStore}),S=i.cx(g,(e=>e.props.store===t)),k=i.dF(g,((e,t)=>t<S&&e.props.canInsertText));let C;if(k&&(C=k.props.store),C&&a){const e=(0,d.x0)(C),o=(0,c.sQ)(C);if(I({environment:r,transaction:n,store:t,block:a,targetStore:C,targetBlock:o}),w.Z5({store:C,selection:e}),_.eP({environment:r,store:o}),!u.BX(a)&&s){const e=a.getContentStores();for(const r of e)b.Vt({parent:s.getContentStore(),before:a,insert:r,transaction:n});const t=a.getContentStore(),o=a.getContentStores();for(const r of o)b.Od({parent:t,childToRemove:r,transaction:n})}y.Od({store:a,transaction:n})}}({environment:t,store:e,transaction:a}):s.isType(r.oe)&&function(e){const{environment:t,store:n,transaction:o}=e;o.annotateWithUserAction("textBackspaceActions.captionBackspaceAtBeginning");const r=p.E.getMembersByDOMOrder({filter:()=>!0}),i=r.findIndex((e=>e.props.store===n)),a=r.findLast(((e,t)=>t<i&&e.props.canInsertText)),s=null==a?void 0:a.props.store;if(!s)return;if(!(0,c.sQ)(n))return;const l=(0,d.x0)(s);C({environment:t,store:n,targetStore:s,transaction:o}),w.Z5({store:s,selection:l});const u=(0,c.sQ)(s);_.eP({environment:t,store:u})}({environment:t,store:e,transaction:a})}}}else P&&(0,d.J_)(P.store,P.selection)&&s?(k.preventDefault(),function(e){const{environment:t,store:n,transaction:o}=e;o.annotateWithUserAction("textBackspaceActions.textDeleteAtEnd");const r=p.E.getMembersByDOMOrder({filter:()=>!0}),a=i.cx(r,(e=>e.props.store===n)),s=r.find(((e,t)=>Boolean(t>a&&e.props.canInsertText)));let l;s&&(l=s.props.store);const d=(0,c.sQ)(n);if(d&&l){const e="readOnly"===g.default.state.mode,r="empty"!==g.default.state.mode&&g.default.state.multiSelection,i=(0,c.sQ)(l);if(I({environment:t,transaction:o,store:l,block:i,targetStore:n,targetBlock:d}),i){const t=(0,c.sQ)(i);if(t){const e=i.getContentStore(),n=i.getContentStores();for(const r of n)b.Od({parent:e,childToRemove:r,transaction:o}),b.Vt({parent:t.getContentStore(),before:i,insert:r,transaction:o})}y.Od({store:i,transaction:o}),r&&w.NA({multiSelection:r,readOnly:e})}}}({environment:t,store:P.store,transaction:a})):M&&(k.preventDefault(),function(e){const{environment:t,multiSelection:n,transaction:o,deleteForwards:r}=e;let i;o.annotateWithUserAction("textBackspaceActions.textBackspaceWithinContent"),i=(0,l.iG)(n)?r?{start:n.start,end:{store:n.start.store,index:n.start.index+1}}:{start:{store:n.start.store,index:n.start.index-1},end:n.start}:n,S.pz({environment:t,multiSelection:i,transaction:o})}({environment:t,multiSelection:n,deleteForwards:s,transaction:a}));const A=g.default.state;"editing"===A.mode&&(0,d.ST)(A.multiSelection.start.store.getValue(),A.multiSelection.start.index-1,"c")&&w.aR({annotation:["c"],extend:!0})}function M(e){const{event:t,multiSelection:n,device:o}=e;return(o.isApple&&t.metaKey||!o.isApple&&t.ctrlKey||o.isApple&&t.altKey)&&!(0,d.dQ)(n)}},74284:(e,t,n)=>{n.d(t,{IO:()=>A,PF:()=>E});n(52262),n(24506);var o=n(1302),r=n(41432),i=n(72126),a=n(21202),s=n(70203),l=n(82798),c=n(17707),d=n(78791),u=n(68056),p=n(73959),m=n(35328),f=n(77080),g=n(79797),h=n(24666),v=n(45131),b=n(34583),y=n(952),_=n(44886),S=n(94419),w=n(9953),k=n(61045),I=n(24677),C=n(993),x=n(56971),T=n(98104),M=n(29373);function P(e){const t=(0,p.sQ)(e.store);if(t&&function(e){var t;const n=e.getType();return!!n&&(!!(0,r.he)(n)&&!(e.id!==(null===(t=e.getParentBlockStore())||void 0===t?void 0:t.getRenderableContentIds().at(-1))))}(t)){const n=_.rB({environment:e.environment,blocks:[t],transaction:e.transaction});if(n)return void o.default.afterNextFlush((()=>{const e=n[0].getTitleStore();e&&T.NA({multiSelection:{start:{store:e,index:0},end:{store:e,index:0}}})}))}x.ew(e)}function A(e){const{environment:t,transaction:n,multiSelection:a}=e;b.M_(t)&&((0,p.x7)(a.start.store)?function(e){const{environment:t,transaction:n}=e;let i=e.multiSelection;const a=(0,p.sQ)(i.start.store);if(!a||a.isCollectionView())return;C.pz({environment:t,multiSelection:i,transaction:n});const s=h.default.state;i="editing"===s.mode&&s.multiSelection||i;const l=i.start.store,c=w.j4({environment:t,type:r.Ti.text,inMemoryRecordCache:l.inMemoryRecordCache,transaction:n,spaceId:a.pointer.spaceId,useCrdt:a.useCrdt()}),d=S.Ce({parent:a.getContentStore(),prepend:c,transaction:n}).child;E({environment:t,block:a,store:l,targetBlock:d,splitAtIndex:i.start.index,transaction:n}),o.default.afterNextFlush((()=>{T.N_({store:d.getBlockTitleStore()})})),y.W(t,{from:"text_enter",type:r.Ti.text,creating_block_id:c.id})}(e):(0,u.iG)(a)&&function(e){const t=e.getRecordStoreUIParent();return t instanceof g.G&&e&&t.isType(r.q7)&&0===s.QaF(t.getTitleValue()).length}(a.start.store)?P({environment:t,transaction:n,store:a.start.store}):(0,u.ko)(a)&&R(a.start.store)&&D(a.start.store)?function(e){var t;const{environment:n,transaction:a,multiSelection:l}=e,d=l.start.store,u=(0,p.sQ)(d);if(!u)return;const f=u.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:t}=e;return t(u)})),g=(0,p.sQ)(u);if(!f||!g)return;const h=w.j4({environment:n,type:f.type,inMemoryRecordCache:d.inMemoryRecordCache,transaction:a,spaceId:g.pointer.spaceId,properties:f.properties?B(f.properties):void 0,format:f.format?F(f.format):void 0,permissions:f.permissions,useCrdt:Boolean(null===(t=f.format)||void 0===t?void 0:t.use_crdt)}),{id:b,space_id:_,properties:I,format:C,permissions:x,ignore_block_count:T,discussions:P,...A}=f,D=i.zu(P,...s.llS(d.getValue()));w.sW({store:h,data:{...A,discussions:D},transaction:a});const O=S.BE({parent:g.getContentStore(),after:u,insert:h,transaction:a}).child;if(R(d)&&u){const e=u.getContentStores(),t=u.getContentStore(),n=h.getContentStore();for(const o of e)S.Od({parent:t,childToRemove:o,transaction:a}),S.R3({parent:n,append:o,transaction:a})}(0,m.BX)(u)&&M.rd({blockId:h.id,state:v.Z.isOpen(u.id),currentUserId:n.currentUser.id}),(0,r.he)(f.type)||w.sW({store:u,transaction:a,data:{type:r.Ti.text}}),c.qf({blockStore:u,discussionIds:D,transaction:a}),E({environment:n,block:u,store:d,targetBlock:O,splitAtIndex:l.start.index,transaction:a}),y.W(n,{from:"text_enter",type:r.Ti.text,creating_block_id:h.id}),n.device.isMobile&&o.default.afterNextFlush((()=>k.hQ(n)))}(e):function(e){var t;const{environment:n,transaction:o}=e;let i=e.multiSelection;const a=(0,p.sQ)(i.start.store);if(!a)return;const s=(0,p.sQ)(a);if(!s)return;C.pz(e);const l=h.default.state;i="editing"===l.mode&&l.multiSelection||i;const c=i.start.store,d=a.getType(),u=a.getContentLength(),g=a.getModel();let b;if((0,m.BX)(a)&&v.Z.isOpen(a.id))b=r.Ti.text;else if(g&&u>0&&g.isType(r.nH)){b=r.Ti.text;const e=a.getContentStores()[0];if(e){const t=e.getType();e.isDefined()&&t&&r.kC[t]&&(b=t)}}else b=!(d&&g&&!g.isType(r.Q2)&&R(c)&&D(c)&&"code"!==d)||g.isType("ai_block")&&g.isSkillBlock()?r.Ti.text:d;const _=w.j4({environment:n,type:b,inMemoryRecordCache:c.inMemoryRecordCache,transaction:o,spaceId:s.pointer.spaceId,format:{block_alignment:f.default.checkGate("text_align")?null===(t=a.getFormat())||void 0===t?void 0:t.block_alignment:void 0},useCrdt:a.useCrdt()}),k=s.getRenderableContentIds()||[];let I,x=!1;if((0,m.BX)(a)&&v.Z.isOpen(a.id)){const e=a.getContentStore();x=!0,I=S.Ce({parent:e,prepend:_,transaction:o})}else if(g&&u&&g.isType(r.nH)){const e=a.getContentStore();x=!0,I=S.Ce({parent:e,prepend:_,transaction:o})}else if(null!=g&&g.isType("ai_block")&&g.isSkillBlock()){const e=a.getContentStore();x=!0,I=S.Ce({parent:e,prepend:_,transaction:o})}else I=k.indexOf(a.id)>=0?S.BE({parent:s.getContentStore(),after:a,insert:_,transaction:o}):S.Ce({parent:s.getContentStore(),prepend:_,transaction:o});const T=I.child;if(R(c)&&d&&!x&&!(0,m.BX)(a)){const e=a.getContentStores(),t=a.getContentStore(),n=T.getContentStore();for(const r of e)S.Od({parent:t,childToRemove:r,transaction:o}),S.R3({parent:n,append:r,transaction:o})}E({environment:n,block:a,store:i.start.store,targetBlock:T,splitAtIndex:i.start.index,transaction:o}),y.W(n,{from:"text_enter",type:b,creating_block_id:_.id,is_toggleable:(0,m._A)(b,_.getFormat())})}(e),t.device.isMobile||o.default.afterNextFlush((()=>{k.Zv()})))}function R(e){if(e.table===a.iU){const t=g.G.createChildStore(e,{table:a.iU,id:e.id}).getType();return t&&!(0,r.S9)(t)}return!1}function D(e){if(e.table===a.iU){const t=g.G.createChildStore(e,{table:a.iU,id:e.id}).getModel();return t&&!t.isType(r.oe)&&!t.isType(r.Ok)}return!1}function E(e){const{environment:t,block:n,store:o,targetBlock:r,splitAtIndex:i,transaction:a}=e,s={store:o,index:i},c={start:s,end:s};if(n.useCrdt()&&n.getBlockTitleStore()===o){(0,l.T)(r.useCrdt(),"Calling splitText() with a non-CRDT target block is not currently supported");(0,u.NV)(c)||d.Wc({sourceBlockStore:n,targetBlockStore:r,splitAtGraphemeIndex:i,transaction:a,moveIntoNewBlock:!0})}else C.gc({environment:t,sourceStore:c.end.store,sourceIndex:c.end.index,targetStore:r.getBlockTitleStore(),targetIndex:0,transaction:a});I.eP({environment:t,store:r}),T.N_({store:r.getBlockTitleStore()})}function B(e){const{title:t,...n}=e;return n}function F(e){const{text_slice_tree:t,text_clocks:n,...o}=e;return o}},17269:(e,t,n)=>{n.d(t,{G:()=>W,f:()=>K});n(97391),n(57658);var o=n(41432),r=n(15095),i=n(72126),a=n(38737),s=n(21202),l=n(70203),c=n(97880),d=n(82798),u=n(11342),p=n(40959),m=n(83631);function f(e,t){return r.p4(e.substring(0,t)).length}var g=n(68056),h=n(99445),v=n(73959),b=n(35328),y=n(79797),_=n(27724),S=n(24666),w=n(36610),k=n(47839),I=n(96802),C=n(42858),x=n(24677),T=n(993),M=n(74284),P=n(98104),A=n(82530),R=n(68422);function D(e){var t;const{environment:n,store:i,toBlockType:a,matchRegex:s,insertTextAfter:c,transaction:u,postTransformAction:m}=e,f="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!f)return;const h=r.p4(l.QaF(i.getValue())).slice(0,f.endIndex).join(""),k=s.exec(h);if(!k)return;const I=i.getRecordStoreUIParent();if(!(I&&I instanceof y.G))return;const A=I.getType();if(!A)return;if(A!==o.Ti.text&&!o.q7[A])return;const D=a(k);if(void 0===D||D===A)return;let E=D;I instanceof y.G&&("toggle"===D&&(0,o.zp)(I.getType())?E=b.m1(A):"toggle"===A&&b.JO(D)&&(E=b.m1(D)),R.vs({environment:n,block:I,blockType:E,transaction:u}));const B={startIndex:0,endIndex:k&&r.p4(k[0]).length||0};if(T.pe({environment:n,store:i,selection:B,transaction:u}),c){const e=C.aO({environment:n,selection:_.default.state.stores,createBlockItem:p.Hc[o.Ti.text],analyticsFrom:"divider"===D?"divider_block_transform":"text_filter_actions",transaction:u});e&&(M.PF({environment:n,block:(0,d.TO)((0,v.sQ)(i)),store:i,targetBlock:e,splitAtIndex:0,transaction:u}),x.eP({environment:n,store:e}),P.N_({store:e.getBlockTitleStore()}))}m&&m(k),w.g_(n,{type:D})}function E(e){var t,n;const{environment:o,store:i,transaction:a,regex:s,length:c,analyticsType:d,replace:u}=e,p="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!p)return;const m=i.getValue()||[],h=l.QaF(m),v=r.p4(h).slice(0,p.endIndex).join(""),b=s.exec(v);if(!b)return;const y=f(h,b.index),_={startIndex:y,endIndex:y+c},k=i.getValue()||[];if(l.oP(k,_.startIndex,_.endIndex,"c"))return;const I="function"==typeof u?u({match:b,matchIndex:y,textValue:m}):u;if(void 0===I)return;if(T.pe({environment:o,store:i,selection:_,transaction:a}),"editing"!==S.default.state.mode)return;const C=null===(n=(0,g.QY)(S.default.state.multiSelection))||void 0===n?void 0:n.selection;C&&(T.hJ({environment:o,store:i,selection:C,string:I,disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:a}),w.Af(o,{type:d}))}function B(e){var t;const{environment:n,store:o,delimiter:i,annotation:a,transaction:s}=e,c="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!c)return;const d=o.getValue(),u=F({delimiter:i,storeValue:d,selectionEndIndex:c.endIndex});if(!u)return;if(!O({delimiter:i,storeValue:d,...u}))return;if(l.p9b(d,u.startIndex,u.endIndex,l.GKr.Code))return;const{textValue:p,startIndex:m,endIndex:h}=u,v=f(p,m),b=p.slice(m,h),y=r.p4(b).length,_={startIndex:v,endIndex:v+i.length};T.pe({environment:n,store:o,selection:_,transaction:s});const k={startIndex:v+y-i.length-i.length,endIndex:v+y-i.length};T.pe({environment:n,store:o,selection:k,transaction:s});const I={startIndex:_.startIndex,endIndex:k.startIndex};T.i8({environment:n,store:o,selection:I,annotation:a,transaction:s});const C=I.endIndex;if(P.Z5({store:o,selection:{startIndex:C,endIndex:C}}),P.aR({annotation:a,extend:!1}),a[0]===l.GKr.Code){const e={startIndex:k.endIndex-i.length,endIndex:k.endIndex-i.length};T.hJ({environment:n,store:o,selection:e,string:" ",transaction:s,disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:!0})}w.tn(n,{type:l.J7s(a)})}function F(e){const{delimiter:t,storeValue:n,selectionEndIndex:o}=e,a=r.p4(l.QaF(n)).slice(0,o).join("");if(0===a.length||!a.endsWith(t))return;const s=a.split(t);if(s.length<=2)return;s.reverse();const[c,...d]=s.slice(1),u=i.Sm(d.map((e=>e.length+t.length)))-t.length;return{textValue:a,matchString:c,startIndex:u,endIndex:u+c.length+2*t.length}}function O(e){const{delimiter:t,matchString:n,startIndex:o,endIndex:r,textValue:i}=e;return n.length>0&&!/\s/g.test(n[0])&&!/\s/g.test(n[n.length-1])&&!n.startsWith(t)&&!n.endsWith(t)&&(!i[o-1]||/[\s(]/g.test(i[o-1]))&&(!i[r]||/[\s)]/g.test(i[r]))}function Z(e){var t;const{environment:n,delimiter:o,store:i,transaction:a}=e,s="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!s)return;const c=i.getValue(),d=F({delimiter:o,storeValue:c,selectionEndIndex:s.endIndex});if(!d)return;if(!function(e){const{storeValue:t,startIndex:n,endIndex:o,delimiter:r}=e;if(!O(e))return!1;const i={[l.GKr.User]:l.GKr.User,[l.GKr.Page]:l.GKr.Page,[l.GKr.Comment]:l.GKr.Comment,[l.GKr.Bot]:l.GKr.Bot,[l.GKr.ExternalObjectInstance]:l.GKr.ExternalObjectInstance,[l.GKr.Date]:l.GKr.Date,[l.GKr.TemporaryPage]:l.GKr.TemporaryPage,[l.GKr.TemplateVariable]:l.GKr.TemplateVariable,[l.GKr.FormulaPageProperty]:l.GKr.FormulaPageProperty,[l.GKr.FormulaContextValue]:l.GKr.FormulaContextValue,[l.GKr.Group]:l.GKr.Group,[l.GKr.Citation]:l.GKr.Citation};for(const a of Object.values(i))if(l.oP(t,n,o,a))return!1;if(l.oP(t,n,n+r.length,l.GKr.Code)&&l.oP(t,o-r.length,o,l.GKr.Code))return!1;return!0}({delimiter:o,storeValue:c,...d}))return;const{textValue:u,matchString:p,startIndex:h,endIndex:v}=d,b=f(u,h),y=u.slice(h,v);T.pe({environment:n,store:i,selection:{startIndex:b,endIndex:b+r.p4(y).length},transaction:a});const _=l.qZ6(p);T.mM({environment:n,store:i,tokens:[_],index:b,transaction:a});const k=b+r.p4(l.WiV(_)).length;P.Z5({store:i,selection:{startIndex:k,endIndex:k}}),w.tn(n,{type:l.GKr.Equation}),m.ND({environment:n,equation:p,from:{type:"create",source:"text_filter",selection:!0}})}const V=["\\.",",",";","\\?","!","\\)","\\]"," "].join("|"),U=new RegExp(` (${V})$`);function N(e){const t=l.xrQ(e.textValue,e.matchIndex-1,e.matchIndex),n=i.Z$(t.tokensInsideRange);if(n&&l.km_(n))return e.match[1]}const L=[{delimiter:"**",type:l.GKr.Bold},{delimiter:"＊＊",type:l.GKr.Bold},{delimiter:"*",type:l.GKr.Italic},{delimiter:"＊",type:l.GKr.Italic},{delimiter:"__",type:l.GKr.Bold},{delimiter:"＿＿",type:l.GKr.Bold},{delimiter:"_",type:l.GKr.Italic},{delimiter:"＿",type:l.GKr.Italic},{delimiter:"~",type:l.GKr.Strike},{delimiter:"〜",type:l.GKr.Strike},{delimiter:"～",type:l.GKr.Strike}],j=[{toBlockType:()=>o.Ti.toDo,matchRegex:/^(\[\] |\「\」　)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.subSubHeader,matchRegex:/^(### |＃＃＃)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.subHeader,matchRegex:/^(## |＃＃)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.header,matchRegex:/^(# |＃)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.toggle,matchRegex:/^(> |＞)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.quote,matchRegex:/^(\| |\" |\“ |\”)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.bulletedList,matchRegex:/^(\* |\- |\+ |\＊|\ー|\＋|\・)$/,insertTextAfter:!1},{toBlockType:()=>o.Ti.divider,matchRegex:/^—-$/,insertTextAfter:!0}],z=[{annotationDelimiter:"`",blockMatchRegex:/^```$/},{annotationDelimiter:"´",blockMatchRegex:/^´´´$/},{annotationDelimiter:"｀",blockMatchRegex:/^｀｀｀$/}],q=[{regex:/^'$/,length:1,replace:"‘",analyticsType:"sentence_start_single_quote"},{regex:/ '$/,length:2,replace:" ‘",analyticsType:"start_single_quote"},{regex:/'$/,length:1,replace:"’",analyticsType:"middle_single_quote"}],H=[{regex:/^"$/,length:1,replace:"“",analyticsType:"sentence_start_double_quote"},{regex:/ "$/,length:2,replace:" “",analyticsType:"start_double_quote"},{regex:/"$/,length:1,replace:"”",analyticsType:"end_double_quote"},{regex:/--$/,length:2,replace:"—",analyticsType:"em_dash"},{regex:/->$/,length:2,replace:"→",analyticsType:"right_arrow"},{regex:/<->$/,length:3,replace:"↔",analyticsType:"right_left_arrow"},{regex:/←>$/,length:2,replace:"↔",analyticsType:"right_left_arrow"},{regex:/=>$/,length:2,replace:"⇒",analyticsType:"right_arrow_double"},{regex:/<-$/,length:2,replace:"←",analyticsType:"left_arrow"},{regex:/>=$/,length:2,replace:"≥",analyticsType:"greater_than_or_equal_to"},{regex:/<=$/,length:2,replace:"≤",analyticsType:"less_than_or_equal_to"},{regex:/!=$/,length:2,replace:"≠",analyticsType:"not_equal"},{regex:/\.\.\.$/,length:3,replace:"…",analyticsType:"ellipsis"}];function W(e){const{environment:t,store:n,transaction:d}=e,p=n.getRecordStoreAtRootPath(),m=p instanceof y.G?p.getType():void 0;if("code"!==m||S.default.isEditingCaption()){if("callout"!==m){for(const e of j)D({environment:t,store:n,toBlockType:e.toBlockType,matchRegex:e.matchRegex,insertTextAfter:e.insertTextAfter,transaction:d});D({environment:t,store:n,matchRegex:/^(\d+|[\uff10-\uff19]+)(\. |\。|\．)$/,insertTextAfter:!1,transaction:d,toBlockType:t=>{var n;const o=t[1],r=(0,a.DA)(o);return null===(n=G(e,parseInt(r)))||void 0===n?void 0:n.type},postTransformAction:t=>{var o;const r=t[1],i=(0,a.DA)(r),l=null===(o=G(e,parseInt(i)))||void 0===o?void 0:o.number;if(n.table!==s.iU)return;const u=n.getRecordStoreAtRootPath();if(!(u instanceof y.G))return;const p=(0,c.$K)(l)&&l>-1?l:void 0;I.FH({stores:[u],update:{list_start_index:p},transaction:d})}}),D({environment:t,store:n,matchRegex:/^([a-z]+)(\. |\。|\．)$/,insertTextAfter:!1,transaction:d,toBlockType:t=>{const n=(0,h.UF)(t[1]),o=G(e,n);if(1===n||void 0===(null==o?void 0:o.number))return null==o?void 0:o.type},postTransformAction:()=>{p instanceof y.G&&I.FH({stores:[p],update:{list_format:"roman"},transaction:d})}}),D({environment:t,store:n,matchRegex:/^([a-z]+)(\. |\。|\．)$/,insertTextAfter:!1,transaction:d,toBlockType:t=>{const n=(0,h.yk)(t[1]),o=G(e,n);if(1===n||void 0===(null==o?void 0:o.number))return null==o?void 0:o.type},postTransformAction:()=>{p instanceof y.G&&I.FH({stores:[p],update:{list_format:"letters"},transaction:d})}});for(const{blockMatchRegex:e}of z)D({environment:t,store:n,toBlockType:()=>o.Ti.code,matchRegex:e,insertTextAfter:!1,transaction:d})}if(!function(e){var t;const n="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!n)return!1;const o=e.getValue()||[],r=l.xrQ(o,0,n.endIndex),a=i.qr(r.tokensInsideRange,(e=>l.hDy(e).some((e=>l.fTS(e))))),s=r.tokensInsideRange.slice(-1===a?0:a,r.tokensInsideRange.length),c=l.QaF(s);return Boolean(c.match(/(^| )`[^ ]/))}(n)){const e=k.getSubstitutions();for(const r of e)E({environment:t,store:n,transaction:d,regex:r.replace,length:r.length,replace:r.with,analyticsType:"custom_substitution"});for(const r of H)E({environment:t,store:n,transaction:d,regex:r.regex,length:r.length,replace:r.replace,analyticsType:r.analyticsType});const o=t.device.browserVersion.split(".").map((e=>parseInt(e,10)));if(!t.device.isSafari||(0,u.isGreaterThanOrEqualToVersion)(o,[16,4]))for(const r of q)E({environment:t,store:n,transaction:d,regex:r.regex,length:r.length,replace:r.replace,analyticsType:r.analyticsType});!function(e){E({environment:e.environment,store:e.store,transaction:e.transaction,regex:U,length:2,replace:N,analyticsType:"mention_punctuation"})}({environment:t,store:n,transaction:d})}for(const{annotationDelimiter:e}of z)B({environment:t,delimiter:e,annotation:[l.GKr.Code],store:n,transaction:d});for(const{delimiter:e,type:o}of L)B({environment:t,delimiter:e,annotation:[o],store:n,transaction:d});Z({environment:t,delimiter:"$$",store:n,transaction:d}),Z({environment:t,delimiter:"＄＄",store:n,transaction:d}),function(e){var t;const{environment:n,store:o,transaction:i}=e,a="editing"===S.default.state.mode&&(null===(t=(0,g.QY)(S.default.state.multiSelection))||void 0===t?void 0:t.selection);if(!a)return;const s=o.getValue(),c=r.p4(l.QaF(s)).slice(0,a.endIndex).join("");if(l.oP(s,a.startIndex,a.endIndex,"c"))return;const d=/([^ ]+) $/.exec(c);if(!d)return;const u=d[1],p=l.rOz(u);if(!p)return;const{value:m,href:h}=p,v=f(c,c.indexOf(m)),b=v+r.p4(m).length,y={startIndex:v,endIndex:b};l.oP(s,v,b,"a")||(T.i8({environment:n,store:o,annotation:["a",h],selection:y,transaction:i}),P.Z5({store:o,selection:a}),w.Hc(n,{href:h}))}({environment:t,store:n,transaction:d})}}function K(e){const{store:t,transaction:n,environment:o}=e;n.postEnqueueActions.push((()=>{A.createAndCommit({userAction:"textFilterActions.runAllFiltersAfterTransaction",environment:o,undoCheckpoint:!0,perform:e=>{W({environment:o,store:t,transaction:e})}})}))}function G(e,t){const{store:n}=e;if(n.table!==s.iU)return;const r=n.getRecordStoreAtRootPath();if(!(r instanceof y.G))return;const i=r.getType();if(i===o.Ti.header||i===o.Ti.subHeader||i===o.Ti.subSubHeader)return;const a=r.getParentBlockStore();if(!a)return;const l=a.getContentStores(),d=l.findIndex((e=>e.id===r.id));if(-1===d)return;const u=l.slice(0,d);let p=-1,m=1;for(let s=0;s<u.length;s++){const e=u[s];if(e.getType()!==o.Ti.numberedList)m=1,p=s;else{var f;const t=null===(f=e.getFormat())||void 0===f?void 0:f.list_start_index;(0,c.$K)(t)?m=t+1:m++}}return m===t?{type:o.Ti.numberedList,number:void 0}:d===p+1?{type:o.Ti.numberedList,number:t}:void 0}},98104:(e,t,n)=>{n.d(t,{AL:()=>Y,Ch:()=>N,D1:()=>J,DI:()=>Q,FC:()=>ee,FG:()=>$,J9:()=>te,Km:()=>A,LG:()=>oe,N3:()=>K,NA:()=>T,NX:()=>B,N_:()=>E,UV:()=>F,Z5:()=>P,ZH:()=>z,Zk:()=>se,aJ:()=>D,aR:()=>R,bc:()=>ie,e2:()=>X,jh:()=>ne,ls:()=>V,mT:()=>O,o9:()=>q,sD:()=>j,z9:()=>M,zJ:()=>G});n(57658);var o=n(1302),r=n(72126),i=n(70203),a=n(4827),s=n(14976),l=n(46150),c=n(28314),d=n(68056),u=n(45162),p=n(73959),m=n(89224),f=n(89086),g=n(28685),h=n(95802),v=n(50694),b=n(27724),y=n(24666),_=n(36280),S=n(45990),w=n(13084),k=n(24677),I=n(993),C=n(82530);const x=!1;function T(e){const{multiSelection:t,readOnly:n,forceEmit:o}=e,r=y.default.state,i="empty"!==r.mode&&r.savedSelectionXPosition||void 0,a="editing"===r.mode&&(0,d.e6)(r.multiSelection,t)?r.forceExtendAnnotations:{},s=n?{mode:"readOnly",multiSelection:t,savedSelectionXPosition:i}:{mode:"editing",multiSelection:t,savedSelectionXPosition:i,forceExtendAnnotations:a};if(s.mode!==r.mode||!(0,d._v)(r.multiSelection,t))return y.default.setState(s),void v.HM.updateCellSelectionFromTextSelection();o&&y.default.emit()}function M(e,t){if(!("always"===(0,u.Aw)(e)))return;const{TextSelectionCompositionStore:n}=e;n.setState({isComposing:t})}function P(e){const{store:t,selection:n,readOnly:o}=e;if(t&&n){T({multiSelection:(0,d.TD)({store:t,selection:n}),readOnly:o})}else if(t&&!n){const e={store:t,index:0},n={start:e,end:e};o?y.default.setState({mode:"readOnly",multiSelection:n,savedSelectionXPosition:0}):y.default.setState({mode:"editing",multiSelection:n,forceExtendAnnotations:{},savedSelectionXPosition:0})}else"empty"!==y.default.state.mode&&y.default.setState({mode:"empty"})}function A(e){const{annotation:t}=e;if(i.k87[i.J7s(t)])return;const n=i.J7s(t),o=(0,f.bj)().findFirstOfType(n);R(o?{annotation:o,extend:!1}:{annotation:t,extend:!0})}function R(e){const{annotation:t,extend:n}=e,o=y.default.state,r=i.J7s(t);"editing"===o.mode&&y.default.setState({...o,forceExtendAnnotations:{...o.forceExtendAnnotations,[r]:{annotation:t,extend:n}}})}function D(){const e=y.default.state;"editing"===e.mode&&y.default.setState({...e,forceExtendAnnotations:{}})}function E(e){const{store:t}=e;P({store:t,selection:{startIndex:0,endIndex:0}})}function B(e){const{store:t}=e;P({store:t,selection:(0,f.x0)(t)})}function F(e){var t;D();const{environment:n,store:o,canSelectAllBlocks:r,contentEditableContextId:i}=e,a=y.default.state;let s;s="empty"===a.mode?{start:{store:o,index:0},end:{store:o,index:0}}:a.multiSelection;const l={start:{store:s.start.store,index:0},end:{store:s.end.store,index:(null===(t=(0,f.x0)(s.end.store))||void 0===t?void 0:t.endIndex)||0}};if((0,d._v)(l,s)){if(i){const e=(0,f.Ov)(),t=e=>{var t;return(null===(t=e.contentEditableContext)||void 0===t?void 0:t.id)===i},n=e.find(t),o=e.reverse().find(t);if(n&&o){const e=n.props.store,t=o.props.store;if(e&&t){var c;return void T({multiSelection:{start:{store:e,index:0},end:{store:t,index:(null===(c=(0,f.x0)(t))||void 0===c?void 0:c.endIndex)||0}}})}}}r&&(0,p.Mn)(n.device)&&k.td(n)}else T({multiSelection:l})}function O(e){var t;D();const{environment:n,store:o,canSelectAllBlocks:r}=e,i=(0,f.x0)(o),a={startIndex:0,endIndex:i?i.endIndex:0};r&&"empty"!==y.default.state.mode&&(0,f.fu)(null===(t=(0,u.xI)("textSelectionActions",y.default.state.multiSelection))||void 0===t?void 0:t.selection,a)?k.td(n):P({store:o,selection:a})}function Z(e){const t=y.default.state;"empty"===t.mode||t.savedSelectionXPosition||y.default.setState({...t,savedSelectionXPosition:e.savedSelectionXPosition})}function V(){"empty"!==y.default.state.mode&&y.default.setState({...y.default.state,savedSelectionXPosition:void 0})}let U=[];function N(e){if(0===U.length)return!1;x&&console.log("maybeHandleExpectedBrowserSelectionUpdate",e);const t=U;U=[];for(const n of t)n();return!0}function L(e){const{store:t,contentEditableLeafRegistry:n,avoidEdgesOfContentEditableRoot:r,selection:i}=e;U.push((()=>{const e=m.get(),o=(0,u.fx)({contentEditableLeafRegistry:n,range:e,allowInvisibleEndSelection:(0,c.yA)().shift,avoidEdgesOfContentEditableRoot:r});o?T(o):P({store:t,selection:i})})),o.default.afterNextFlush((()=>N("renderQueueFlush")))}function j(){const e=document.activeElement;e instanceof HTMLElement&&e.blur()}function z(e){m.clear(e),q()}function q(){P({store:void 0,selection:void 0})}function H(e){const{currentEditableTopBottomPadding:t,targetEdge:n,targetEditable:o,selectionXPosition:i}=e,s=o.getNode();if(!(s&&s instanceof Element))return;const l=s.getBoundingClientRect(),c=Math.min(Math.max(i,l.left),l.right),d=Math.min(t,o.props.topBottomPadding),u="top"===n?l.top:l.bottom;return function(e,t,n){const o=new Map,i={visibility:"hidden"},s=Object.keys(i);let l;try{for(;l=m.rangeFromPoint(e,t);){if(n.contains(l.commonAncestorContainer))return l;const e=a.Z.getParentOverlayNode(l.commonAncestorContainer);if(!e)return;if(o.has(e))return;const t=r.ei(e.style,s);o.set(e,t),Object.assign(e.style,i)}}finally{for(const[e,t]of o)Object.assign(e.style,t)}}(c,"top"===n?u+d:u-d,s)}function W(e){const{focusContainerOffset:t,focusStore:n,edge:o,topBottomPadding:r}=e,i=g.E.findNodeFromStore(n);if(!(i&&i instanceof Element))return;const a=m.getRect(m.rangeFromContainerOffsets({start:t,end:t})),s=i.getBoundingClientRect();if(!a||!s)return;const[l,c]="top"===o?[a.top,s.top]:[a.bottom,s.bottom];return{focusIsAtEdge:Math.abs(l-c)<=r,focusSelectionRect:a,renderedNode:i,renderedNodeRect:s}}function K(e){const{environment:t,event:n,topBottomPadding:o,contentEditableLeafRegistry:r}=e,i=m.get();if(!i)return;D();const a=y.default.state;if("empty"===a.mode)return;const{multiSelection:s}=a,{focus:c,anchor:p}=(0,u.uZ)(s),h=W({focusContainerOffset:m.rangeToContainerOffsets(i).focus,focusStore:c.store,topBottomPadding:o,edge:"top"});if(!h)return;const{focusIsAtEdge:b,focusSelectionRect:_}=h,S=v.g$.getSimpleTableCellFromTextSelection(),w=S?v.g$.getPreviousEditableStoreForSimpleTable(S):(0,f.mK)(c.store),I=w&&g.E.findEditableWithStore(w);if(b&&I){var C;const e=Math.max(a.savedSelectionXPosition||0,_.left),r=H({targetEditable:I,targetEdge:"bottom",currentEditableTopBottomPadding:o,selectionXPosition:e}),s=(null===(C=(0,u.fx)({range:r,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0}))||void 0===C?void 0:C.multiSelection)||(0,d.TD)({store:I.props.store,selection:(0,f.x0)(I.props.store)});if(n.shiftKey&&!n.altKey&&s&&(0,l.D1)(I.getNode(),i.commonAncestorContainer))return n.preventDefault(),Z({savedSelectionXPosition:e}),void ie({environment:t,multiSelection:(0,u.$r)(s.start,p),focus:s.start,forceEmit:!1});if(!n.shiftKey&&!n.altKey&&s)return n.preventDefault(),Z({savedSelectionXPosition:e}),void ie({environment:t,forceEmit:!1,multiSelection:s,focus:"start"})}if(n.shiftKey&&!n.altKey&&(0,f.e7)(c,s.start.store)){if(ae(t))return void v.HM.handleUpDownKey({environment:t,direction:"up",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,u.tp)({multiSelection:s,focus:c,filterCommonAncestors:!0});if(e)return n.preventDefault(),void k.Z5({environment:t,...e})}L({store:c.store,contentEditableLeafRegistry:r,avoidEdgesOfContentEditableRoot:!0})}function G(e){const{environment:t,store:n,event:o,topBottomPadding:r}=e,i=m.get();if(!i)return;D();const a=m.getRect(i),l=g.E.findNodeFromStore(n),c=y.default.state;if(!l)return;if(!(l instanceof Element))return;if("empty"===c.mode)return;const d=(0,u.xI)("textSelectionActions",c.multiSelection);if(!d)return;const h=l.getBoundingClientRect(),b=v.g$.getSimpleTableCellFromTextSelection(),_=b?v.g$.getPreviousEditableStoreForSimpleTable(b):(0,f.mK)(n);if(a&&h){const e=Math.abs(a.top-h.top),l={startIndex:d.selection.startIndex,endIndex:d.selection.startIndex},u=(0,p.sQ)(n);if(!o.altKey&&o.shiftKey&&(0,f.Rw)(l)&&(m.selectionIsBackwards()||i.collapsed)&&u)k.Z5({environment:t,stores:[u]});else if(!o.altKey&&!o.shiftKey&&e<=r&&_){o.preventDefault();const e=Math.max(c.savedSelectionXPosition||0,a.left);Z({savedSelectionXPosition:e});const n=g.E.findNodeFromStore(_);if(n&&n instanceof Element){const o=n.getBoundingClientRect(),i=Math.min(Math.max(e,o.left),o.right),a=o.bottom-r,l=m.rangeFromPoint(i,a),c=s.Ut(t,l);c&&(re({environment:t,store:_,selection:c.selection}),c.forceEmitSelectionStore&&y.default.emit())}}else L({store:n})}}function $(e){const{environment:t,event:n,topBottomPadding:o,contentEditableLeafRegistry:r}=e,i=m.get();if(!i)return;D();const a=y.default.state;if("empty"===a.mode)return;const{multiSelection:s}=a,{focus:c,anchor:h}=(0,u.uZ)(s),b=W({focusContainerOffset:m.rangeToContainerOffsets(i).focus,focusStore:c.store,topBottomPadding:o,edge:"bottom"});if(!b)return;const{focusIsAtEdge:_,focusSelectionRect:S}=b,w=v.g$.getSimpleTableCellFromTextSelection(),I=w?v.g$.getNextEditableStoreForSimpleTable(w):(0,f.hn)(c.store),C=I&&g.E.findEditableWithStore(I);if(_&&C){var x;const e=Math.max(a.savedSelectionXPosition||0,S.left),r=H({targetEditable:C,targetEdge:"top",currentEditableTopBottomPadding:o,selectionXPosition:e}),s=(null===(x=(0,u.fx)({range:r,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0}))||void 0===x?void 0:x.multiSelection)||(0,d.TD)({store:C.props.store,selection:{startIndex:0,endIndex:0}});if(n.shiftKey&&!n.altKey&&s&&(0,l.D1)(C.getNode(),i.commonAncestorContainer))return n.preventDefault(),Z({savedSelectionXPosition:e}),void ie({environment:t,multiSelection:(0,u.$r)(s.start,h),focus:s.start,forceEmit:!1});if(!n.shiftKey&&!n.altKey&&s)return n.preventDefault(),Z({savedSelectionXPosition:e}),void ie({environment:t,forceEmit:!1,multiSelection:s,focus:"end"})}const T=(0,p.sQ)(s.start.store);if(n.shiftKey&&!n.altKey&&(0,f.iB)(c,s.end.store)&&T){if(ae(t))return void v.HM.handleUpDownKey({environment:t,direction:"down",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,u.tp)({multiSelection:s,focus:c,filterCommonAncestors:!0});if(e)return n.preventDefault(),void k.Z5({environment:t,...e})}L({store:c.store,contentEditableLeafRegistry:r,avoidEdgesOfContentEditableRoot:!0,selection:(0,f.x0)(c.store)})}function Q(e){const{environment:t,store:n,event:o,topBottomPadding:r}=e,i=m.get();if(!i)return;D();const a=m.getRect(i),l=g.E.findNodeFromStore(n),c=y.default.state;if(!l)return;if(!(l instanceof Element))return;if("empty"===c.mode)return;const d=(0,u.xI)("textSelectionActions",c.multiSelection);if(!d)return;const h=l.getBoundingClientRect();if(a&&h){const e=v.g$.getSimpleTableCellFromTextSelection(),l=e?v.g$.getNextEditableStoreForSimpleTable(e):(0,f.hn)(n),u=Math.abs(a.bottom-h.bottom),b={startIndex:d.selection.endIndex,endIndex:d.selection.endIndex},_=(0,p.sQ)(n);if(!o.altKey&&o.shiftKey&&(0,f.J_)(n,b)&&(!m.selectionIsBackwards()||i.collapsed)&&_)k.Z5({environment:t,stores:[_]});else if(!o.altKey&&!o.shiftKey&&u<=r&&l){o.preventDefault();const e=Math.max(c.savedSelectionXPosition||0,a.left);Z({savedSelectionXPosition:e});const n=g.E.findNodeFromStore(l);if(n&&n instanceof Element){const o=n.getBoundingClientRect(),i=Math.min(Math.max(e,o.left),o.right),a=o.top+r,c=m.rangeFromPoint(i,a),d=s.Ut(t,c);d&&(re({environment:t,store:l,selection:d.selection}),d.forceEmitSelectionStore&&y.default.emit())}}else L({store:n})}}function Y(e){o.default.afterNextFlush((()=>{V()})),D();const{environment:t,event:n,contentEditableLeafRegistry:r}=e,a=m.get(),s=y.default.state;if("empty"===s.mode)return;const{multiSelection:c}=s,{focus:p,anchor:h}=(0,u.uZ)(c),b=p.store&&g.E.findEditableWithStore(p.store),w=(0,f.mK)(p.store),I=w&&g.E.findEditableWithStore(w);if((0,f.e7)(p,p.store)&&I&&b&&I.props.isDiscussionInput===b.props.isDiscussionInput){const e=(0,d.TD)({store:I.props.store,selection:(0,f.x0)(I.props.store)});if(n.shiftKey&&!n.altKey&&e&&(0,l.D1)(I.getNode(),null==a?void 0:a.commonAncestorContainer))return n.preventDefault(),void ie({environment:t,multiSelection:(0,u.$r)(e.start,h),focus:e.start,forceEmit:!1});if(!n.shiftKey&&!n.altKey&&e&&(0,d.iG)(c))return n.preventDefault(),void ie({environment:t,forceEmit:!1,multiSelection:e,focus:"start"})}if(n.shiftKey&&!n.altKey&&(0,f.e7)(p,c.start.store)){if(ae(t))return void v.HM.handleLeftRightKey({environment:t,direction:"left",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,u.tp)({multiSelection:c,focus:p,filterCommonAncestors:!0});if(e)return n.preventDefault(),void k.Z5({environment:t,...e})}if(n.altKey||n.shiftKey||n.ctrlKey||n.metaKey||!a||!a.collapsed)L({store:p.store,contentEditableLeafRegistry:r});else{const e=p.index-1,r=i.b1T(c.start.store.getValue(),e);if(r&&i.tk7(r)){n.preventDefault(),T({multiSelection:{start:{...p,index:e},end:p}});const a={startIndex:e,endIndex:p.index};i.YrK(r)&&o.default.afterNextFlush((()=>{_.qn({environment:t,selectedToken:{token:r,position:a},analyticsFrom:"arrow_keys"})}))}const a=i.hpT(p.store.getValue(),e,((e,t)=>{const n=i.Hze(e);return t?Boolean(n&&i.Hze(t)===n):Boolean(n)}));a&&S.dz({type:"selectionFocus",store:p.store,focus:!1,selection:a})}}function X(e){o.default.afterNextFlush((()=>{V()})),D();const{environment:t,store:n,event:r}=e,a=m.get(),s=y.default.state;if("empty"===s.mode)return;const l=(0,u.xI)("textSelectionActions",s.multiSelection);if(!l)return;const c={startIndex:l.selection.startIndex,endIndex:l.selection.startIndex},d=(0,p.sQ)(n);if(!r.altKey&&r.shiftKey&&a&&(0,f.Rw)(c)&&(m.selectionIsBackwards()||a.collapsed)&&d)k.Z5({environment:t,stores:[d]});else if(r.altKey||r.shiftKey||l.store!==n||!(0,f.Rw)(l.selection))if(r.altKey||r.shiftKey||r.ctrlKey||r.metaKey||!a||!a.collapsed)L({store:n});else{const e=i.b1T(n.getValue(),c.startIndex-1);if(e&&i.tk7(e)){r.preventDefault();const a={startIndex:c.startIndex-1,endIndex:c.startIndex};P({store:n,selection:a}),i.YrK(e)&&o.default.afterNextFlush((()=>{_.qn({environment:t,selectedToken:{token:e,position:a},analyticsFrom:"arrow_keys"})}))}const a=i.hpT(n.getValue(),c.startIndex-1,((e,t)=>{const n=i.Hze(e);return t?Boolean(n&&i.Hze(t)===n):Boolean(n)}));a&&S.dz({type:"selectionFocus",store:n,focus:!1,selection:a})}else{r.preventDefault();const e=(0,f.mK)(n);if(e){const n=(0,f.x0)(e);n&&re({environment:t,store:e,selection:n})}}}function J(e){o.default.afterNextFlush((()=>{V()})),D();const{environment:t,event:n,contentEditableLeafRegistry:r}=e,a=m.get(),s=y.default.state;if("empty"===s.mode)return;const{multiSelection:c}=s,{focus:p,anchor:h}=(0,u.uZ)(c),b=p.store&&g.E.findEditableWithStore(p.store),w=(0,f.hn)(p.store),x=w&&g.E.findEditableWithStore(w);if((0,f.ST)(s.multiSelection.start.store.getValue(),s.multiSelection.start.index-1,i.GKr.Code)&&(0,f.iB)(p,p.store)&&(0,d.iG)(c))return n.preventDefault(),void C.createAndCommit({userAction:"textSelectionActions.arrowRightInCodeBlockAtEOL",environment:t,perform:e=>{I.hJ({environment:t,store:p.store,multiSelection:c,string:" ",transaction:e,disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:!0})}});if((0,f.iB)(p,p.store)&&x&&b&&x.props.isDiscussionInput===b.props.isDiscussionInput){const e=(0,d.TD)({store:x.props.store,selection:{startIndex:0,endIndex:0}});if(n.shiftKey&&!n.altKey&&e&&(0,l.D1)(x.getNode(),null==a?void 0:a.commonAncestorContainer))return n.preventDefault(),void ie({environment:t,multiSelection:(0,u.$r)(e.start,h),focus:e.start,forceEmit:!1});if(!n.shiftKey&&!n.altKey&&e&&(0,d.iG)(c))return n.preventDefault(),void ie({environment:t,forceEmit:!1,multiSelection:e,focus:"end"})}if(n.shiftKey&&!n.altKey&&(0,f.iB)(p,c.end.store)){if(ae(t))return void v.HM.handleLeftRightKey({environment:t,direction:"right",bypassExistingTextSelection:!1,expandSelection:!0});const e=(0,u.tp)({multiSelection:c,focus:p,filterCommonAncestors:!0});if(e)return n.preventDefault(),void k.Z5({environment:t,...e})}if(n.altKey||n.shiftKey||n.ctrlKey||n.metaKey||!a||!a.collapsed)L({store:p.store,contentEditableLeafRegistry:r});else{const e=p.index,r=p.index+1,a=i.b1T(c.start.store.getValue(),e);if(a&&i.tk7(a)){n.preventDefault(),T({multiSelection:{start:p,end:{...p,index:r}}});const s={startIndex:e,endIndex:r};i.YrK(a)&&o.default.afterNextFlush((()=>{_.qn({environment:t,selectedToken:{token:a,position:s},analyticsFrom:"arrow_keys"})}))}const s=i.hpT(p.store.getValue(),e,((e,t)=>{const n=i.Hze(e);return t?Boolean(n&&i.Hze(t)===n):Boolean(n)}));s&&S.dz({type:"selectionFocus",store:p.store,focus:!1,selection:s})}}function ee(e){o.default.afterNextFlush((()=>{V()})),D();const{environment:t,store:n,event:r}=e,a=m.get(),s=y.default.state;if("empty"===s.mode)return;const l=(0,u.xI)("textSelectionActions",s.multiSelection);if(!l)return;const c={startIndex:l.selection.endIndex,endIndex:l.selection.endIndex},d=(0,p.sQ)(n);if(!r.altKey&&r.shiftKey&&a&&(0,f.J_)(n,c)&&(!m.selectionIsBackwards()||a.collapsed)&&d)k.Z5({environment:t,stores:[d]});else if(r.altKey||r.shiftKey||l.store!==n||!(0,f.J_)(n,l.selection))if(r.altKey||r.shiftKey||r.ctrlKey||r.metaKey||!a||!a.collapsed)L({store:n});else{const e=i.b1T(n.getValue(),c.startIndex);if(e&&i.tk7(e)){r.preventDefault();const a={startIndex:c.startIndex,endIndex:c.startIndex+1};P({store:n,selection:a}),i.YrK(e)&&o.default.afterNextFlush((()=>{_.qn({environment:t,selectedToken:{token:e,position:a},analyticsFrom:"arrow_keys"})}))}const a=i.hpT(n.getValue(),c.startIndex+1,((e,t)=>{const n=i.Hze(e);return t?Boolean(n&&i.Hze(t)===n):Boolean(n)}));a&&S.dz({type:"selectionFocus",store:n,focus:!1,selection:a})}else{r.preventDefault();const e=(0,f.hn)(n);e&&re({environment:t,store:e,selection:{startIndex:0,endIndex:0}})}}function te(e,t){const{x:n,y:o,target:r}=t,i=(0,f.fx)(n,o,r);i&&i.selectable.props.onEditText&&C.createAndCommit({userAction:"textSelectionActions.editNearestBlock",environment:e,perform:e=>{i.selectable.props.onEditText&&i.selectable.props.onEditText({isAtStartOfLine:n<=i.rect.left,isClick:!0,transaction:e})}})}function ne(e,t,n){const{x:o,y:r,target:i}=t,a=i?b.default.getDefaultContainerFromTarget(i):void 0;if(a&&(0,f.Q3)(r,a)&&w.HO({environment:e,container:a,transaction:n}))return;const s=(0,f.fx)(o,r,i);if(s&&s.selectable.props.onEditText){const e=r<=s.rect.top;s.selectable.props.onEditText({isAtStartOfLine:o<=s.rect.left,isAtStartOfContainer:e,isClick:!0,transaction:n})}}function oe(e,t,n,o){const{y:r,target:i}=t,a=i?b.default.getDefaultContainerFromTarget(i):void 0,s=h.C.findSelectableFromStore(n);a&&s&&(0,f.qh)(r,s)&&w.UG({environment:e,container:a,store:n,transaction:o})}function re(e){const{environment:t,store:n,selection:o}=e;P({store:n,selection:o});const r=(0,p.sQ)(n);r&&k.eP({environment:t,store:r})}function ie(e){const{environment:t,multiSelection:n,forceEmit:o,readOnly:r,focus:i}=e;T({multiSelection:n,forceEmit:o,readOnly:"infer"===r?(0,u.L5)(n).some((e=>{let{editable:t}=e;return!t.props.store.canEdit()})):r});const a=(0,u.tp)({multiSelection:n,filterCommonAncestors:!1,focus:i});a&&k.Z5({environment:t,phase:b.SelectionPhase.Editing,...a})}function ae(e){const t=v.g$.getSimpleTableCellFromTextSelection();if(t){const{rowIndex:n,columnIndex:o,simpleTableStore:r}=t.getProps();return v.HM.selectCell({environment:e,rowIndex:n,columnIndex:o,simpleTableStore:r}),z(e),!0}return!1}function se(e){var t;if(!(0,u.Aw)(e))return;const n=m.get(),o=null===(t=(0,u.fx)({range:n,contentEditableLeafRegistry:void 0,allowInvisibleEndSelection:!0}))||void 0===t?void 0:t.multiSelection;if(o){T({readOnly:(0,u.L5)(o).some((e=>{let{editable:t}=e;return t.props.disabled})),multiSelection:o})}}},29373:(e,t,n)=>{n.d(t,{LO:()=>S,X_:()=>k,ls:()=>b,nz:()=>_,rd:()=>y});n(57658);var o=n(41432),r=n(15157),i=n(72126),a=n(23867),s=n(35328),l=n(58202),c=n(45131),d=n(54642),u=n(54569),p=n(94419),m=n(9953),f=n(24677),g=n(98104);const h="ToggleBlock";function v(e){return`${h}-${e}`}function b(e){const{environment:t,store:n,transaction:r}=e,i=m.j4({environment:t,type:o.Ti.text,inMemoryRecordCache:n.inMemoryRecordCache,transaction:r,spaceId:n.pointer.spaceId,useCrdt:n.useCrdt()});p.R3({parent:n.getContentStore(),append:i,transaction:r});const a=n.getContentStores()[0];f.eP({environment:t,store:a});const s=a.getBlockTitleStore();g.N_({store:s})}function y(e){let{blockId:t,state:n,currentUserId:o}=e;c.Z.setOpen(t,n),r.Z.set({userId:o,key:v(t),value:n})}function _(e){let{blockId:t,currentUserId:n}=e;const o=r.Z.get({userId:n,key:v(t)});c.Z.setOpen(t,o)}function S(e,t){d.loadCachedPageChunkBatched(e,{page:{id:t.id,spaceId:(0,a.C)(t.spaceId)},limit:25,chunkNumber:0,cursor:{stack:[]},verticalColumns:!1})}function w(e,t){const n=(null==t?void 0:t.toggleBlockIds)||[],r=(null==t?void 0:t.collectionBlockIds)||[],i=e.getType();if((0,s.BX)(e)&&n.push(e.id),"collection_view"!==i&&"collection_view_page"!==i||r.push(e.id),i===o.Ti.transclusionReference){const t=e.getTransclusionReferenceTargetStore();t&&w(t,{toggleBlockIds:n,collectionBlockIds:r})}else{const t=e.getContentStores();for(const e of t)e.isNavigableBlock()||w(e,{toggleBlockIds:n,collectionBlockIds:r}),"collection_view"===e.getType()&&r.push(e.id)}return{toggleBlockIds:n,collectionIds:r}}function k(e,t){const{toggleBlockIds:n,collectionIds:o}=w(t),r=t.environment.currentUser.id;n.forEach((e=>_({blockId:e,currentUserId:r})));const a=i.oA(o.map((e=>function(e){const t=l.R.findCollectionViewBlockFromId(e);if(t)return t.collectionContextStore}(e)))),s=a.flatMap((e=>e.groupsStore.getAllGroupStates())),d=n.every((e=>c.Z.isOpen(e))),p=s.every((e=>e.toggleStateStore.state)),m=!(d&&p);n.forEach((e=>y({blockId:e,state:m,currentUserId:r}))),function(e,t,n){for(const o of t)for(const t of o.groupsStore.getAllGroupStates())u.uo({environment:e,collectionContextStore:o,groupFormat:t.groupsPointer[0],toggleStateStore:t.toggleStateStore,newValue:n})}(e,a,m)}},32741:(e,t,n)=>{n.d(t,{lY:()=>f,qA:()=>g,HM:()=>m});var o=n(70203),r=n(44805),i=n(97880),a=n(92120);var s=n(4708),l=n(80444),c=n(62740),d=n(77080),u=n(96049),p=n(48588);function m(e){var t;if(u.Z.state)return;const n=d.default.checkGate("first_party_links"),m=(0,s.En)(),{token:g,store:h}=e,v=o.hDy(g.textToken),b=null===(t=l.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.getSpaceId(),y=b?o.zrg(v).filter((e=>!(0,r.vz)({annotation:e,spaceId:b,getRecordModel:h.getRecordModel}))):[],_=o.eQP(v),S=[o.rlz(v),o.K9C(v),o.QGY(v),o.frE(v),o.xat(v),n&&o.V8Y(v)||void 0,m&&o.hH9(v)||void 0,...y,o.jC0(v),_].filter(i.$K);S.length>0?(p.Z.setState({token:g,store:h,annotations:S}),y.length>0&&function(e){let{source:t,discussionAnnotations:n}=e;a.Z.setState({source:t,discussionIds:n.map(o.h19)})}({discussionAnnotations:y,source:"editor"}),_&&c.Z.setState({...c.Z.state,hoveredEditId:_[1]})):f()}function f(){var e,t;p.Z.state&&p.Z.setState(void 0),e="editor",(null===(t=a.Z.state)||void 0===t?void 0:t.source)===e&&a.Z.setState(void 0),c.Z.state.hoveredEditId&&c.Z.setState({...c.Z.state,hoveredEditId:null})}function g(e){e&&p.Z.state&&p.Z.state.store===e&&f()}},82530:(e,t,n)=>{n.r(t),n.d(t,{MetadataUpdateManager:()=>be,applyCrdtTextOperation:()=>we,applyCrdtTextOperations:()=>ke,applyOperation:()=>Se,createAndCommit:()=>Pe,createAndCommitAsync:()=>Ae,updateConnectionState:()=>he,updateMetadataForTransaction:()=>ve});n(57658),n(21703);var o=n(18466),r=n(45060),i=n(63144),a=(n(97531),n(68626)),s=n(38297),l=n(5773),c=n(43593);var d=n(45681),u=n(59730),p=n(72126),m=n(91155),f=n(59753),g=n(482),h=n(77337),v=n(606),b=n(98963),y=n(21202),_=n(6287),S=n(13493),w=n(70279),k=n(15047),I=n(19889),C=n(67175),x=n(12139),T=n(97880),M=n(63143),P=n(82798),A=n(9291),R=n(95477),D=n(21830),E=n(33929),B=n(98165),F=n(3932),O=n(16861),Z=n(99341),V=n(88632),U=n(37598),N=n(53730),L=n(79797),j=n(27724),z=n(24666),q=n(34583),H=(n(67266),n(19056),n(47247),n(68955)),W=(n(4615),n(70203));function K(e){const{blockValue:t,textSliceTree:n,originalTextValue:o}=e,r=n.getTextValue();!function(e){const{blockValue:t,textSliceTree:n}=e,o=(0,P.TO)(t.format);(0,P.T)(o.use_crdt),o.text_slice_tree=H.Z.serialize(n),o.text_clocks=H.Z.serializeClocks(n),t.properties??={},t.properties.title=n.getTextValue(),t.version++}({blockValue:t,textSliceTree:n}),t.discussions=function(e){const{existingDiscussions:t,oldTextValue:n,newTextValue:o}=e,r=p.e5(W.llS(n),W.llS(o));return r.length>0?p.zu(t??[],...r):t}({existingDiscussions:t.discussions,oldTextValue:o,newTextValue:r}),t.discussions=function(e){const{existingDiscussions:t,oldTextValue:n,newTextValue:o}=e,r=p.e5(W.llS(o),W.llS(n));return r.length>0?p.G0(t??[],r):t}({existingDiscussions:t.discussions,oldTextValue:o,newTextValue:r})}var G=n(77282);function $(e){const{transaction:t,inMemoryRecordCache:n,store:o,operation:r}=e,i=r.command;switch(i){case"insertText":case"deleteText":case"addAnnotation":case"removeAnnotation":case"splitText":const e=(0,P.TO)(o.getTextSliceTree());return a=o,s=new ee(t,r),G.Z.getPageStoreForBlockStore(a)||te("source",a,s),Q({inMemoryRecordCache:n,textSliceTreeToMutate:e,store:o,operation:r});case"splitTextIntoBlock":return function(e){const{transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:r}=e;(0,P.T)(r.args.targetBlockId!==r.pointer.id,"Target block should be different from source block.");const i=(0,P.TO)(o.getTextSliceTree()),[{newValue:a,role:s}]=Q({inMemoryRecordCache:n,store:o,textSliceTreeToMutate:i,operation:{command:"splitText",pointer:r.pointer,path:[],args:r.args}}),l=new L.G(o.environment,{table:y.iU,id:r.args.targetBlockId});return ne(o,l,new ee(t,r)),X({transaction:t,inMemoryRecordCache:n,sourceValue:a,sourceRole:s,sourceRootTextSliceTree:i,targetStore:l,operation:{command:"moveTextSlice",pointer:{table:y.iU,id:r.args.targetBlockId},path:[],args:{textInstanceId:r.args.textInstanceId,textSliceStartItemId:r.args.id,targetBlockId:r.args.targetBlockId,targetTextInstanceId:r.args.targetBlockId,targetTextSliceEndItemId:"end"}}})}({transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:r});case"moveTextSlice":return Y({transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:r});case"moveTextSliceIntoBlock":return function(e){const{transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:r}=e;return(0,P.T)(r.args.targetBlockId!==r.pointer.id,"Target block should be different from source block."),Y({transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:{...r,command:"moveTextSlice",args:{...r.args,targetTextInstanceId:r.args.targetBlockId,targetTextSliceEndItemId:"end"}},debugInfo:new ee(t,r)})}({transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:r});case"replaceTextInBlock":throw new Error("replaceTextInBlock operation should not be applied on the client");default:(0,T.t1)(i)}var a,s}function Q(e){const{inMemoryRecordCache:t,store:n,operation:o,textSliceTreeToMutate:r}=e,i=r.getTextValue(),a=o.command;switch(a){case"insertText":r.applyInsertTextOperation({type:a,...o.args});break;case"deleteText":r.applyDeleteOperation({type:a,...o.args});break;case"addAnnotation":case"removeAnnotation":r.applyAnnotationOperation({type:a,...o.args});break;case"splitText":r.applySplitOperation({type:a,...o.args});break;default:(0,T.t1)(a)}const s=p.Xh((0,P.TO)(n.getValue()));return K({blockValue:s,textSliceTree:r,originalTextValue:i}),[{pointer:n.pointer,newValue:s,role:J(t,n),updatePaths:[["format","text_slice_tree"],["format","text_clocks"],["discussions"]]}]}function Y(e){const{transaction:t,inMemoryRecordCache:n,sourceStore:o,operation:r,debugInfo:i}=e,a=(0,P.TO)(o.getValue()),s=J(n,o),l=(0,P.TO)(o.getTextSliceTree()),c=r.args.targetBlockId===o.id?o:new L.G(o.environment,{table:y.iU,id:r.args.targetBlockId});return ne(o,c,i??new ee(t,r)),X({transaction:t,inMemoryRecordCache:n,sourceValue:a,sourceRole:s,sourceRootTextSliceTree:l,targetStore:c,operation:r})}function X(e){const{transaction:t,inMemoryRecordCache:n,sourceRole:o,sourceValue:r,sourceRootTextSliceTree:i,targetStore:a,operation:s}=e,l=(0,P.TO)(i.findTextSliceTreeContainingItemWithId(s.args.textInstanceId,s.args.textSliceStartItemId));(0,P.T)(l!==i,"Can not move root node of text slice tree.");const c=i.getTextValue();!function(e,t){const n=t.getRecordStoreAtRootPath().getValue(),o=t.getRecordStoreAtRootPath().getRole(),r=e.initialRecordMap.getRole(t.pointer);r||(o?e.initialRecordMap.setValueAndRole(t.pointer,n,o):e.initialRecordMap.delete(t.pointer))}(t,a);const d=s.args.targetBlockId===r.id,u=d?i:(0,P.TO)(a.getTextSliceTree()),m=(0,P.TO)(u.findTextSliceTreeContainingItemWithId(s.args.targetTextInstanceId,s.args.targetTextSliceEndItemId,{type:"end"})),f=d?c:u.getTextValue();l.detachFromParent(),m.appendChild(l);const g=p.Xh(r);K({blockValue:g,textSliceTree:i,originalTextValue:c});const h=[{pointer:{table:y.iU,id:r.id,spaceId:r.space_id},newValue:g,role:o,updatePaths:[["format","text_slice_tree"],["format","text_clocks"],["discussions"]]}];if(!d){const e=p.Xh((0,P.TO)(a.getValue()));K({blockValue:e,textSliceTree:u,originalTextValue:f}),h.push({pointer:a.pointer,newValue:e,role:J(n,a),updatePaths:[["format","text_slice_tree"],["format","text_clocks"],["discussions"]]})}return h}function J(e,t){return e.getRole({pointer:t.pointer,userId:t.userId})??"editor"}class ee{constructor(e,t){this.transaction=e,this.operation=t}get(){return{transactionName:this.transaction.getUserActionForAnalyticsPurposesOnly(),operationName:this.operation.command}}}function te(e,t,n){const{transactionName:o,operationName:i}=n.get();(0,r.XY)(`The ${e} block store for CRDT text operation "${i}" in transaction "${o}" is not on the page. Undoing the transaction may not work!`,[["block id =",t.id]])}function ne(e,t,n){const o=G.Z.getPageStoreForBlockStore(e);if(!o)return void te("source",e,n);(0,P.TO)(G.Z.getPageBlockTrackerForPage(o.pointer)).getPathToBlock(t.pointer.id)||te("target",t,n)}var oe=n(3022),re=n(35793),ie=n(36576),ae=n(74446),se=n(45953),le=n(33361);var ce=n(47307),de=n(4408),ue=n(52423);const pe=new Set;let me=0;const fe=(0,A.defineMessages)({invalidBlockOperation:{defaultMessage:"Hey there! Blocks cannot be moved inside of themselves.",id:"saveChanges.errorDialog.blocksCannotBeMovedInsideSelf.message"},saveEditsError:{id:"saveEditsError.message",defaultMessage:"There was an issue persisting your edits. Please message us for help."}}),ge=25*M.C0;function he(e){V.Z.state.online&&e.currentUser.id&&N.transactionQueue.unpause()}function ve(e){const{environment:t,transaction:n,skipUpdatingEditedMetadata:o}=e,r=t.currentUser.adminUserId?I.el.id:t.currentUser.id,a=new be({transaction:n,userId:r,skipUpdatingEditedMetadata:o,timeMs:Date.now()}),s=p.mN(n.stores,(e=>e.id));for(const l of s)if(l.table===y.iU){const e=L.G.createChildStore(l,l.pointer);if(e.canEdit()&&a.addStore(e),!e.isNavigableBlock()){const t=B.Dg(e);t&&t.canEdit()&&a.addStoreWithLargeSubtree(t)}}else if(l.table===w.x_){if(l.path.length)continue;const e=l.pointer,t=n.initialRecordMap.getValue(e),o=l.getValue();(void 0===t||i.P(f.kk.fromValue(w.x_,t),f.kk.fromValue(w.x_,o)))&&a.addStore(L.T5.createChildStore(l,l.pointer))}else if(l.table===k.bx)a.addStoreWithLargeSubtree(L.H2.createChildStore(l,l.pointer));else if(l.table===_.v){const e=L.NW.createChildStore(l,l.pointer).getParentBlockStore();e&&e.canEdit()&&a.addStore(e)}else if(l.table===S.n){const e=L.Xr.createChildStore(l,l.pointer).getParentBlockStore();e&&e.canEdit()&&a.addStoreWithLargeSubtree(e)}else if(l.table===b.cv&&l.canEdit()){const e=L.Mz.createChildStore(l,l.pointer);a.addStore(e);const t=e.getParentBlockStore();t&&t.canEdit()&&a.addStore(t)}a.getAllOperations().forEach((e=>{let[t,o]=e;return Se({transaction:n,store:t,operation:o})}))}class be{constructor(e){this.transaction=void 0,this.timeMs=void 0,this.userId=void 0,this.skipUpdatingEditedMetadata=void 0,this.seenStoreIds=void 0,this.operations=void 0,this.transaction=e.transaction,this.timeMs=e.timeMs,this.userId=e.userId,this.skipUpdatingEditedMetadata=e.skipUpdatingEditedMetadata,this.seenStoreIds=new Set,this.operations=new Map}addStoreWithLargeSubtree(e){this.addStoreInternal(e,{shouldDebounceEditedTime:!0})}addStore(e){this.addStoreInternal(e,{shouldDebounceEditedTime:!1})}getAllOperations(){return Array.from(this.operations.entries())}addStoreInternal(e,t){if(e.inMemoryRecordCache.recordHasOverride({pointer:e.pointer,userId:this.transaction.userId}))return;if(this.seenStoreIds.has(e.id))return;this.seenStoreIds.add(e.id);const n={};p.TS(n,this.collectCreationMetadata(e),this.skipUpdatingEditedMetadata?{}:this.collectEditionMetadata(e,t.shouldDebounceEditedTime)),Object.keys(n).length>0&&this.operations.set(e,{pointer:e.pointer,path:[],command:"update",args:n})}collectCreationMetadata(e){const t={};(e.isDefined()?e.getCreatedById():void 0)||(t.created_by_id=this.userId,t.created_by_table=I.KJ);return(e.isDefined()?e.getCreatedTime():void 0)||(t.created_time=this.timeMs),t}collectEditionMetadata(e,t){const n={},o=e.isDefined()?e.getLastEditedTime():-1;if((t?this.hasDebounceEnded(o,this.timeMs):o!==this.timeMs)&&(n.last_edited_time=this.timeMs),e instanceof L.G||e instanceof L.H2||e instanceof L.Mz){const t=n;(e.isDefined()?e.getLastEditedById():void 0)!==this.userId&&(t.last_edited_by_id=this.userId,t.last_edited_by_table=I.KJ)}return n}hasDebounceEnded(e,t){return M.ud(e)!==M.ud(t)}}const ye=function(e){p.mN(e.stores,(e=>e.id)).forEach((t=>{if(!t.inMemoryRecordCache.recordHasOverride({pointer:t.pointer,userId:e.userId}))if(t.table===y.iU){const n=L.G.fromRecordStore(t),o=n.getProperties(),r=n.getFormat();if(n.isDefined()){const t=(0,l.xN)({properties:o,format:r},R.default.secureFileS3.url,R.default.secureFileS3V2.url,R.default.secureFileConfig.rootPath,R.default.secureFileConfig.hostname,n.pointer),i=t.files,a=t.operations,s=n.getFileIds();for(const o of i)s.indexOf(o.id)<0&&Se({transaction:e,store:n,operation:{pointer:n.pointer,path:["file_ids"],command:"listAfter",args:{id:o.id}}});for(const o of a)Se({transaction:e,store:n,operation:o})}}else if(t.table===_.v){const n=L.NW.fromRecordStore(t),o=n.getFileIds(),r=n.getIconStore().getValue(),i=n.getCoverStore().getValue();if(n.isDefined()){const t=function(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"";if(n&&!e.file_ids)return[];const i=[],{cover:a,icon:s}=e;if(a){const e=(0,c.mV)(a,t,o,r);e&&i.push(e)}if(s){const e=(0,c.mV)(s,t,o,r);e&&i.push(e)}return i}({cover:i,icon:r,file_ids:o},[R.default.secureFileS3.url,R.default.secureFileS3V2.url],!1,R.default.secureFileConfig.rootPath,R.default.secureFileConfig.hostname),a=o;for(const o of t)a.indexOf(o.id)<0&&Se({transaction:e,store:n,operation:{pointer:n.pointer,path:["file_ids"],command:"listAfter",args:{id:o.id}}})}}}))};const _e=function(e){var t;const{environment:n,userId:o,userAction:i}=e,s=re.Bs(),l=new Error("Potential transaction deadlock"),c=new F.Y({spaceId:s,userId:o||n.currentUser.id,deadlockTimeoutMs:ge,onDeadlockWarning:()=>{pe.delete(c);const e=c.getUserActionForAnalyticsPurposesOnly();(0,r.XY)(`A ${e} transaction hasn't been committed in ${ge} ms.`,[["stack =",l.stack]]),x.IE(l,{extra:{operations_count:c.operations.length},tags:{userAction:e}}),oe.y9(n,{operations_count:c.operations.length,user_action:e});const t=c.operations.map((e=>({command:e.command,stringifiedArgs:(0,m.LK)({path:e.path,pointer:e.pointer})})));a.log({level:"warning",from:"transactionActions",type:"transactionDeadlockWarning",data:{userAction:e,operations:t}})}});return c.beforeSelection=j.default.cloneState(),c.beforeTextSelection=z.default.cloneState(),c.annotateWithUserAction(i),pe.add(c),null===(t=O.Z.provider)||void 0===t||t.onTransactionEvent("create",c),c};function Se(e){const{store:t,operation:n,transaction:o}=e,{inMemoryRecordCache:i}=t;if((0,C.Qf)(n)&&(0,r.XY)(`In ${o.getUserActionForAnalyticsPurposesOnly()}, use applyCrdtTextOperations() for text operations!`),(0,g.S)(n)){const r=(0,d.rb)(n,i.makeGetRecordValueFn(o.userId)),a=(0,d.T1)(n,i.makeGetRecordValueFn(o.userId));for(const o of a)n.additionalUpdatedPointers||(n.additionalUpdatedPointers=[]),n.additionalUpdatedPointers.push(o.pointer),Ie({...e,operation:o,isInvertible:!1,store:(0,L.Kv)(t,o.pointer)});return o.operations.push(n),void o.invertedOperations.push(...r)}Ie({store:t,operation:n,transaction:o,isInvertible:!0})}function we(e){const{store:t,operation:n,invertedOperation:o,transaction:r}=e;ke({store:t,operations:[n],invertedOperations:o?[o]:[],transaction:r})}function ke(e){var t;const{store:n,operations:o,transaction:r}=e;r.invertedOperations.push(...e.invertedOperations),null===(t=O.Z.provider)||void 0===t||t.rememberStackTrace(e.invertedOperations);for(const i of o)Ie({store:n,operation:i,transaction:r,isInvertible:!0})}function Ie(e){var t;const{store:n,operation:o,transaction:r}=e,{inMemoryRecordCache:i,environment:a,pointer:l,userId:c}=n;if(null===(t=O.Z.provider)||void 0===t||t.onApplyOperation(e),r.committed)throw new Error("Transaction has already been committed.");const d=n.getRecordStoreAtRootPath().getValue(),u=n.getRecordStoreAtRootPath().getRole(),p=(0,C.Qf)(o)?[]:e.isInvertible?[h.bv(o,d)].filter(T.$K):[];let m;if(r.initialRecordMap.getRole(l)||(u?r.initialRecordMap.setValueAndRole(l,d,u):r.initialRecordMap.delete(l)),(0,C.Qf)(o))m=$({transaction:r,inMemoryRecordCache:i,store:(0,P.R9)(n,L.G),operation:o});else{m=[{pointer:l,newValue:h.lK(o,d),role:i.getRole({pointer:l,userId:c})??"editor",updatePaths:"update"===o.command?Object.keys(o.args).map((e=>o.path.concat([e]))):[o.path]}]}for(const g of m){const{pointer:e,newValue:t,role:o,updatePaths:l}=g;if(de.Wl({environment:a,inMemoryRecordCache:i,pointer:e,userId:c,force:!0,model:f.kk.fromValue(n.pointer.table,t),role:o,updatePaths:l,debugSource:r.getUserActionForAnalyticsPurposesOnly()??"applyOperation"}),"block"===n.table){const e=t;if(e){const t=(0,s.ky)({block:e,getRecordValue:i.makeGetRecordValueFn(r.userId)});t&&U.Z.setEditedBlock(t.id,e.id)}0}}r.isLocal=!n.shouldCacheSaveTransactions(),e.isInvertible&&(r.operations.push(o),r.invertedOperations.push(...p)),r.stores.push(n),i.appliedTransaction=!0}const Ce=[{type:"userAction",allowedUserAction:"revisionActions.undoRevision"},{type:"userAction",allowedUserAction:"revisionActions.redoRevision"}];function xe(e){var t;null===(t=O.Z.provider)||void 0===t||t.onTransactionEvent("cancel",e),e.cancelDeadlockWarning(),pe.delete(e);const n=p.mN(e.stores,(e=>e.id));for(const o of n){de.uo({inMemoryRecordCache:o.inMemoryRecordCache,persistedRecordCache:o.environment.defaultRecordCache.persistedRecordCache,pointer:o.pointer,userId:o.userId,environment:o.environment});const t=e.initialRecordMap.getValue(o.pointer),n=e.initialRecordMap.getRole(o.pointer);n&&de.Wl({environment:o.environment,inMemoryRecordCache:o.inMemoryRecordCache,pointer:o.pointer,userId:o.userId,updatePaths:[[]],model:f.kk.fromValue(o.pointer.table,t),role:n,debugSource:"cancelTransaction"})}for(const o of e.postCancelCallbacks)o()}const Te=p.P2(((e,t)=>{oe.Y_(e,{errorType:t.type||t.name}),t.type===D.vZ?ce.showThrottledErrorMessage(t.message):ce.showThrottledErrorMessage(E.default.formatMessage(fe.saveEditsError))}),3e4);function Me(e){return new Promise(((t,n)=>{var o;pe.delete(e.transaction);const r=Array.from(pe).filter((e=>e.operations.length>0));var i,s;if(r.length>0&&oe.iB(e.environment,{committed_transaction_user_action:e.transaction.getUserActionForAnalyticsPurposesOnly(),first_uncommitted_transaction_user_action:r[0].getUserActionForAnalyticsPurposesOnly(),uncommitted_transaction_count:r.length}),0===e.transaction.operations.length)return null===(i=N.transactionQueue.logEmptyTaskForDebugging)||void 0===i||i.call(N.transactionQueue,e.transaction.getUserActionForAnalyticsPurposesOnly()),e.transaction.committed=!0,e.transaction.done(),null===(s=O.Z.provider)||void 0===s||s.onTransactionEvent("commitEmpty",e.transaction),t();void 0===e.canUndo&&(e.canUndo=!0);const{transaction:l,canUndo:c}=e,d=function(e){for(const t of e.stores)if("block"===t.table){const e=B.Om(t);if(e&&B.qA(e).find((e=>e.table===t.table&&e.id===t.id)))return E.default.formatMessage(fe.invalidBlockOperation)}}(l);if(d)return xe(l),ce.showErrorMessage(d),void t();l.cancelDeadlockWarning();for(const e of l.preEnqueueActions)e();if(ve({environment:e.environment,transaction:l,skipUpdatingEditedMetadata:e.skipUpdatingEditedMetadata}),ye(l),function(e,t){const n=t.operations.filter((e=>e.pointer.table===S.n));n.length>0&&v.dr.uniq(n.map((e=>e.pointer))).map((e=>t.initialRecordMap.getRole(e))).includes(void 0)&&t.postSubmitCallbacks.push((()=>{q.bi(e)}))}(e.environment,l),l.afterSelection=j.default.cloneState(),l.afterTextSelection=z.default.cloneState(),c&&ue.K9({transaction:l,undoCheckpoint:e.undoCheckpoint}),null===(o=O.Z.provider)||void 0===o||o.onTransactionEvent("commit",l),l.isLocal){for(const e of l.postEnqueueActions)e();l.done(),t()}else{const o=e=>{l.done(e),e?n(e):t()},{LocalBacklinkStore:r,currentUser:i}=e.environment;r&&async function(e,t){const{LocalBacklinkStore:n,currentUser:o}=e;if(0===t.stores.length)return;const r=t.stores[0].inMemoryRecordCache,i=[],a=se.Ak.create(),s=new Set;for(const p of t.stores)s.has(p.id)||(s.add(p.id),i.push(p.pointer),a.setValue(p.pointer,p.getRecordStoreAtRootPath().getValue()));const l=le.DI(t.initialRecordMap),{createdBacklinks:c,deletedBacklinks:d}=await(0,ie.xU)({loadRecordValue:ae.zF.fromGetRecordValueFn(r.makeGetRecordValueFn(o.id)),operationPointers:i,getInitialRecordModel:f.om.fromRecordMap(l),getFinalRecordModel:f.om.fromRecordMap(a)}),u=n.updateBacklinks({createdBacklinks:c,deletedBacklinks:d,currentUserId:o.id});t.postSubmitCallbacks.push((e=>{e&&n.resetBacklinkState({blockIds:u,currentUserId:o.id})}))}({LocalBacklinkStore:r,currentUser:i},l);const s=Date.now();s<me&&oe.vt(e.environment,{regression_amount:me-s}),me=s,N.transactionQueue.enqueueTask((0,Z.JG)({transaction:l,timestamp:s,callback:o})).catch((t=>{a.log({level:"error",from:"transactionActions",type:"enqueueTask",error:(0,m.Ui)(t)}),e.environment.device.isMobileNative&&"SqliteOutOfSpace"===t.name||Te(e.environment,t),xe(l),o(t)}));for(const e of l.postEnqueueActions)e()}l.committed=!0}))}function Pe(e){const{userAction:t,environment:n,userId:r,perform:i,canUndo:s,undoCheckpoint:l,transactionTooBigFallback:c,skipUpdatingEditedMetadata:d,useSudoMode:p}=e;return o.Z.withListenerIgnored((()=>{const o=_e({environment:n,userId:r,userAction:t});let f;p&&(o.useSudoMode=!0);try{f=i(o),function(e){if(e.isLocal)return;for(const t of e.stores){const n=t.inMemoryRecordCache.checkRecordForTemporaryData(t);if(n)throw new u.p8(`Transaction "${e.getUserActionForAnalyticsPurposesOnly()}" is manipulating a store with temporary local changes from an in-memory record cache named "${n.name}"!`)}}(o);for(const e of o.postPerformAssertions)e()}catch(g){xe(o);const e=o.getUserActionForAnalyticsPurposesOnly(),t=o.getUserFlowForAnalyticsPurposesOnly();throw x.IE(g,{tags:{userAction:e,userFlow:t}}),a.log({level:"error",from:"transactionActions",type:"createAndCommit",error:(0,m.Ui)(g),data:{userAction:e,userFlow:t,spaceId:o.spaceId}}),g}finally{0}if(c&&(0,Z.jQ)(o))return xe(o),Pe({...e,perform:c,transactionTooBigFallback:void 0,userAction:`${t} transactionTooBigFallback`});return{performResult:f,serverCommitResult:Me({environment:n,transaction:o,canUndo:s,undoCheckpoint:l,skipUpdatingEditedMetadata:d})}}))}async function Ae(e){const{environment:t,perform:n,waitForServerCommit:o,userAction:r,userId:i,canUndo:s,undoCheckpoint:l,skipUpdatingEditedMetadata:c,useSudoMode:d}=e,u=_e({environment:t,userId:i,userAction:r});let p;d&&(u.useSudoMode=!0);try{p=await n(u);for(const e of u.postPerformAssertions)e()}catch(g){const t=u.getUserActionForAnalyticsPurposesOnly();pe.delete(u);const n=u.operations.length>0;throw n&&oe.kY(e.environment,{user_action:t,operation_count:u.operations.length}),x.IE(g,{tags:{userAction:t,transactionOperationCount:u.operations.length}}),a.log({level:"error",from:"transactionActions",type:"createAndCommitAsync",error:(0,m.Ui)(g),data:{message:n?`POSSIBLE DATA LOSS: asynchronous transaction had ${u.operations.length} operations`:void 0,userAction:t}}),g}const f=Me({environment:t,transaction:u,canUndo:s,undoCheckpoint:l,skipUpdatingEditedMetadata:c});return o&&await f,{performResult:p,serverCommitResult:f}}},68422:(e,t,n)=>{n.d(t,{_w:()=>R,vs:()=>M,Cj:()=>P});var o=n(1302),r=n(41432),i=n(72126),a=n(72141),s=n(4615),l=n(70203),c=n(42274),d=n(65598),u=n(35328),p=n(26664),m=n(34583),f=n(41433),g=n(94419),h=n(76464),v=n(9953),b=n(42858),y=n(24677),_=n(98104),S=n(29373),w=n(73959),k=n(55367),I=n(96802),C=n(13084);function x(e,t){const{store:n,transaction:o,disableAutoChildrenMove:r}=e;return r||function(e){const{environment:t,store:n,transaction:o}=e,r=(0,w.sQ)(n),i=(null==r?void 0:r.getContentStores())||[];let a=!1;const s=i.filter((e=>{return a?(t=e.getType(),o=n.getType(),!(!t||!o||t===o||"divider"===t||"collection_view"===t||"sub_header"===o&&"header"===t||"sub_sub_header"===o&&("header"===t||"sub_header"===t))||(a=!1,!1)):(e===n&&(a=!0),!1);var t,o}));C.LQ({environment:t,targetParentStore:n.getContentStore(),droppedDirection:k.vh.Below,droppedStores:s,duplicate:!1,transaction:o})}(e),I.FH({stores:[n],update:{toggleable:t},transaction:o})}var T=n(82530);function M(e){const{environment:t,block:n,blockType:o,transaction:s,isMultiBlockTransformation:d}=e,p=n.getType(),b=n.getFormat(),y=n.recordStoreUIParentStore;if(m.M_(t)&&p&&!function(e,t){const n=e.type,o=e.format;if(u.ih(t)){var i;return"mermaid_code_block"===t?e.type===r.Ti.code&&"Mermaid"===l.QaF(null===(i=e.properties)||void 0===i?void 0:i.language):(0,r.Fx)(t)?u.tZ(t)===e.type&&(0,r.eJ)(n,o):u.tZ(t)===e.type}return e.type===t&&!(0,r.eJ)(n,o)}({type:p,format:b,properties:n.getProperties()},o)){const e=p,l=u.ih(o)?u.tZ(o):o;if(v.sW({store:n,data:{type:l},transaction:s}),(0,r.Fx)(o)&&!u.fn(n)?function(e){x(e,!0)}({environment:t,store:n,transaction:s,disableAutoChildrenMove:Boolean(d)}):!(0,r.Fx)(o)&&u.fn(n)&&function(e){const{store:t}=e;t.recordStoreUIParentStore&&x(e,!1)}({environment:t,store:n,transaction:s,disableAutoChildrenMove:Boolean(d)}),"mermaid_code_block"===o&&c.E5({blocks:[n],language:"Mermaid",transaction:s}),r.Z7[e]&&!r.Z7[o]){n.getPermissionItems().some(a.Le)&&h.MX({environment:t,store:n,transaction:s})}u.BX(n)&&S.rd({blockId:n.id,state:!0,currentUserId:t.currentUser.id});const m=n.getType();m&&y&&p&&(0,r.Um)(p,b)&&!(0,r.Um)(m,n.getFormat())&&function(e){let{environment:t,block:n,parentStore:o}=e;const r=async()=>{const e=n.getContentStores();await Promise.all(e.map((e=>e.load()))),T.createAndCommit({userAction:"transformActions.runAsync",environment:t,perform:t=>{const r=i.d9(e).reverse();for(const e of r)g.Od({parent:n.getContentStore(),childToRemove:e,transaction:t}),g.BE({parent:o,insert:e,after:n,transaction:t})}})};r()}({environment:t,parentStore:y,block:n}),f.jf({store:n,transaction:s})}return n}function P(e){const{environment:t,blocks:n,blockType:a,transaction:l}=e;if(a!==r.Ti.transclusionContainer)if(a!==r.Ti.columnList)if((0,r.sX)(a)){const e=parseInt(a.replace("column","").replace("block","")),r=i.oA(i.DZ(e-1,(()=>b.ZJ({environment:t,blocks:n,transaction:l})))),s=[...n,...r],c=A({environment:t,blocks:s,transaction:l});o.default.afterNextFlush((()=>{_.N_({store:c[0].getBlockTitleStore()})}))}else for(const o of n)M({environment:t,block:o,blockType:a,transaction:l,isMultiBlockTransformation:n.length>1});else A({environment:t,blocks:n,transaction:l});else!function(e){const{environment:t,blocks:n,transaction:o}=e,i=n[0];if(!i)return;const a=i.getRecordStoreUIParent();if(!a||!(0,d.dz)(a))return;const l=a.getRecordStoreUIParent();if(!l||!(0,d.OY)(l))return;if(!l.isDefined())return;const c=(0,s.ZP)(),u=v.j4({environment:t,id:c,type:r.Ti.transclusionContainer,inMemoryRecordCache:a.inMemoryRecordCache,transaction:o,spaceId:l.getSpaceId(),useCrdt:l.useCrdt()});g.BE({parent:a,insert:u,after:i,transaction:o});(function(e){const{newParent:t,blocks:n,transaction:o}=e;for(const r of n){const e=r.getRecordStoreUIParent();null!=e&&e.valueIs(p.i)&&(g.Od({parent:e,childToRemove:r,transaction:o}),g.R3({parent:t,append:r,transaction:o}))}})({newParent:u.getContentStore(),blocks:n,transaction:o}),_.ZH(t),y.ZH(t),y.Z5({environment:t,stores:[u]})}({environment:t,blocks:n,transaction:l})}function A(e){const{environment:t,blocks:n,transaction:o}=e,i=n[0];if(!i)return[];const a=i.recordStoreUIParentStore;if(null==a||!a.valueIs(p.i))return[];const l=(0,s.ZP)(),c=v.j4({environment:t,id:l,type:r.Ti.columnList,inMemoryRecordCache:i.inMemoryRecordCache,transaction:o,spaceId:i.getSpaceId(),useCrdt:i.useCrdt()}),{child:d}=g.Vt({parent:a,insert:c,before:i,transaction:o});return n.map((e=>{const n=(0,s.ZP)(),l=v.j4({environment:t,id:n,type:r.Ti.column,inMemoryRecordCache:i.inMemoryRecordCache,transaction:o,spaceId:i.getSpaceId(),useCrdt:i.useCrdt()}),{child:c}=g.Od({parent:a,childToRemove:e,transaction:o}),{child:u}=g.BE({parent:d.getContentStore(),insert:l,transaction:o}),{child:p}=g.BE({parent:u.getContentStore(),insert:c,transaction:o});return p}))}function R(e){let{environment:t,blocks:n,transaction:o}=e;(function(e){return 1===e.length&&"collection_view"===e[0].getType()})(n)&&P({environment:t,blocks:n,blockType:"collection_view_page",transaction:o})}},39865:(e,t,n)=>{n.d(t,{DV:()=>w,Rn:()=>I,Tq:()=>C,y8:()=>k});n(57658);var o=n(15145),r=n(59730),i=n(21202),a=n(23867),s=n(9291),l=n(75754),c=n(97978),d=n(33929),u=n(74948),p=n(44604),m=n(80444),f=n(1310),g=n(54642),h=n(47307),v=n(19785),b=n(8055),y=n(64964),_=n(65452);const S=(0,s.defineMessages)({deletePageConfirmationMessage:{id:"trashActions.deletePagePermanentlyDialog.prompt",defaultMessage:"Are you sure you want to delete this page permanently?"},deletePageConfirmationButton:{id:"trashActions.deletePagePermanentlyDialog.confirmDeleteButton.label",defaultMessage:"Yes. Delete this page"},permanentlyDeleteFailedToast:{id:"trashActions.deletePagePermanentlyDialog.actionFailed.toast",defaultMessage:"Failed to delete, please try again later."},permanentlyDeletePermissionsFailure:{id:"trashActions.deletePagePermanentlyDialog.actionFailed.permissions",defaultMessage:"You do not have sufficient permissions to permanently delete this page."}});async function w(e){const{environment:t,block:n,spaceId:r}=e;p.Z.state.excludePages.add(n.id),p.Z.emit(),await g.restoreBlock(t,{pointer:{table:i.iU,id:n.id,spaceId:r}}),l._({environment:t,store:n,pageVisitSource:o.tY.Restore}),t.device.isMobile&&u.close(),function(e){c.j(e,"restore_trash_page")}(t)}function k(e){const{environment:t,blocks:n,transaction:o,permanentlyDelete:r=!1}=e;for(const i of n)v.zo({block:i,transaction:o});o.postSubmitCallbacks.push((async e=>{e||await g.deleteBlocks(t,{blocks:n.map((e=>({id:e.id,spaceId:(0,a.C)(e.pointer.spaceId)}))),permanentlyDelete:r})}))}function I(e){h.showDialog({message:d.default.formatMessage(S.deletePageConfirmationMessage),showCancel:!0,keepFocus:!1,items:[{label:d.default.formatMessage(S.deletePageConfirmationButton),color:"red",onAccept:()=>C(e)}]})}async function C(e){const{blocks:t,environment:n}=e,{currentSpaceStore:o}=m.default.state,i=e.environment.currentUser.id;if(o&&i){await g.deleteBlocks(e.environment,{blocks:t.map((e=>({id:e.id,spaceId:(0,a.C)(e.pointer.spaceId)}))),permanentlyDelete:!0}).then((e=>{if("failed"===e.type)throw function(e){let t=S.permanentlyDeleteFailedToast;(0,r.QW)(e)&&(t=S.permanentlyDeletePermissionsFailure);y.oV({label:d.default.formatMessage(t),durationMs:f.JY})}(e.body),e.error}));for(const e of t)p.Z.state.excludePages.add(e.id),p.Z.emit();await _.l({environment:n,spaceId:o.id,userId:i}),b.CZ({environment:e.environment,blocks:t}),function(e){c.j(e,"delete_trash_page")}(n)}}},27370:(e,t,n)=>{n.r(t),n.d(t,{dismissTutorial:()=>d,resetTutorials:()=>u,tutorialAdvanceToStep:()=>p,tutorialAdvanceToStepAfter:()=>m,tutorialGoToNextStep:()=>l,tutorialGoToPrevStep:()=>c});var o=n(9163),r=n(82530),i=n(37181),a=n(64856),s=n(80444);function l(e,t){var n;const{currentUserSettingsStore:o}=s.default.state;if(!o)return;const r=null===(n=o.getSettings())||void 0===n?void 0:n.tutorials;f({userAction:"TutorialActions.nextStep",environment:e,perform:e=>{i.d2({userSettingsStore:o,transaction:e,data:{tutorials:{...r,[t]:(0,a.ox)(o,t)}}})},userId:o.id})}function c(e,t){var n;const{currentUserSettingsStore:o}=s.default.state;if(!o)return;const r=null===(n=o.getSettings())||void 0===n?void 0:n.tutorials;f({userAction:"TutorialActions.prevStep",environment:e,perform:e=>{i.d2({userSettingsStore:o,transaction:e,data:{tutorials:{...r,[t]:(0,a.IJ)(o,t)}}})},userId:o.id})}function d(e,t){var n;const{currentUserSettingsStore:r}=s.default.state;if(!r)return;const a=null===(n=r.getSettings())||void 0===n?void 0:n.tutorials;f({userAction:"TutorialActions.dismissTutorial",environment:e,perform:e=>{i.d2({userSettingsStore:r,transaction:e,data:{tutorials:{...a,[t]:o.lR}}})},userId:r.id})}function u(e){const{currentUserSettingsStore:t}=s.default.state;t&&f({userAction:"TutorialActions.resetTutorialsDebug",environment:e,perform:e=>{i.d2({userSettingsStore:t,transaction:e,data:{tutorials:{}}})},userId:t.id})}function p(e,t,n){var r;const{currentUserSettingsStore:l}=s.default.state;if(!l||(0,a.W$)(l,t))return;const c=(0,a.wF)(l,t);o.eU[t].steps.findIndex((e=>e.id===c))>=o.eU[t].steps.findIndex((e=>e.id===n))||i.d2({userSettingsStore:l,transaction:e,data:{tutorials:{...null===(r=l.getSettings())||void 0===r?void 0:r.tutorials,[t]:n}}})}function m(e,t,n){if((0,a.AK)(n))return;const o=(0,a.Xv)(t,n);o&&p(e,t,o)}function f(e){return r.createAndCommit({...e,canUndo:!1})}},12170:(e,t,n)=>{n.d(t,{KT:()=>ye,FD:()=>we,xv:()=>_e,jh:()=>Me,pt:()=>he,os:()=>Be,dY:()=>Te,pJ:()=>be,hJ:()=>Se,UY:()=>Ce,yp:()=>Ie,sz:()=>Ze,aV:()=>Ve,qK:()=>Ue});n(21703),n(57658);var o=n(26263),r=n(1302),i=n(41432),a=n(99036),s=n(80951),l=n(95538),c=n(77657),d=n(2864),u=n(68626),p=n(20270),m=n(72126),f=n(59753),g=n(4615),h=n(45953),v=n(21202),b=n(77420),y=n(6287),_=n(13493),S=n(32161),w=n(9844),k=n(23867),I=n(90965),C=n(70203),x=n(97880),T=n(44876),M=n(64002),P=n(63143),A=n(82798),R=n(9291),D=n(893),E=n(94419),B=n(9953),F=n(24677),O=n(993),Z=n(98104),V=n(82530),U=(n(95477),n(69783)),N=n(65454),L=n(77080);var j=n(70764),z=n(41232),q=n(28415),H=n(33929),W=n(65598),K=n(73959),G=n(89224),$=n(58202),Q=n(80444),Y=n(30874),X=n(79167),J=n(19111),ee=n(79797),te=n(1634),ne=n(80064),oe=n(40671),re=n(34583),ie=n(57549),ae=n(54642),se=n(35793),le=n(5149),ce=n(47307),de=n(89475),ue=n(27153),pe=n(4408),me=n(64964);const fe=!1;const ge=(0,R.defineMessages)({browse:{id:"externalBlock.mediaPicker.browseTab.title",defaultMessage:"Browse {appName}"},somethingWentWrong:{defaultMessage:"Something went wrong.",id:"externalActions.dialogError.openFilePicker.errorMessage"},copyDebuggingInformation:{id:"externalActions.dialogItem.openFilePicker.copyDebugData",defaultMessage:"Copy debugging information"},copiedDebuggingInfo:{id:"externalActions.dialogError.copiedDebuggingInfo",defaultMessage:"Copied to clipboard."},userReAuth:{id:"externalActions.dialogError.userReAuth",defaultMessage:"Authentication Expired. Please Re-Authenticate to continue."}});async function he(e){const{environment:t,spaceId:n,force:o}=e;await Q.default.waitUntilRendered();const r=Y.Z.state,i=t.currentUser.id;if(!r.loaded&&!r.loading||r.loaded&&n!==r.spaceId||r.loaded&&i!==r.userId||o){Y.Z.setState({...Y.Z.state,loading:!0});const[e,o]=await Promise.all([ae.getExternalIntegrations(t,{spaceId:n}),ve({environment:t,spaceId:n})]);if("success"!==e.type||"success"!==o.type)throw new Error("Request failed.");const r=h.PF.create(e.data.recordMap),i=h.PF.create(o.data.recordMap);Y.Z.setState({loaded:!0,loading:!1,spaceId:n,userId:t.currentUser.id,integrations:m.MR(m.oA(e.data.integrationIds.map((e=>r.getValue({table:w.K2,id:e})))),(e=>{let{created_at:t}=e;return t})),externalAuthentications:m.MR(m.oA(o.data.externalAuthenticationIds.map((e=>i.getValue({table:S.P,id:e})))),(e=>{let{created_at:t}=e;return t})),bots:m.Xo(m.oA(o.data.botIds.map((e=>i.getValue({table:b.cZ,id:e})))),(e=>{let{last_edited_at:t,created_at:n}=e;return t||n}),"desc"),completeSlackAuthentications:m.MR(m.oA(o.data.completeSlackAuthenticationIds.map((e=>i.getValue({table:S.P,id:e})))),(e=>{let{created_at:t}=e;return t}))})}}async function ve(e){const{environment:t,spaceId:n}=e;return t.currentUser.isLoggedIn()?await ae.getUserSpaceExternalBots(t,{spaceId:n}):{type:"success",status:200,headers:{},data:{botIds:[],externalAuthenticationIds:[],recordMap:{},completeSlackAuthenticationIds:[]}}}async function be(e){const{environment:t}=e,{currentSpaceStore:n}=Q.default.state;n&&await he({environment:t,spaceId:n.id,force:!0})}function ye(e){var t;const{environment:n,blockStore:a,textStore:s,url:d,textValueBeforePaste:p,urlSelection:f}=e,h=G.get();if(!a||U.Z.state.open||J.Z.state.open||ne.Z.state.open||!h)return!1;const{currentSpaceStore:b}=Q.default.state,S=(0,l.x$)(d),w=(0,M.Qc)(S);if(!w.host)return!1;const x=n.currentUser.id;if(null==b||!b.isDefined()||!x)return!1;const P=Y.Z.integrations.state.filter((e=>e.id!==c.U9)),A=(0,T.ny)({url:S,integrations:P,currentSpaceId:b.id});if("partial"===A.type)return function(e){const{environment:t,parsedUrl:n,urlDomain:o,integrationId:r}=e;ie.pp(t,{integrationId:r,urlDomain:o}),u.log({level:"debug",from:"activateFromLinkCreation",type:"linkPreviewUrlMiss",data:{miscDataToConvertToString:{integrationId:r,urlDomain:o,path:n.path}}})}({...A,integrationId:A.integration.id,environment:n}),!1;if("failure"===A.type)return!1;const{integration:R,pattern:D}=A;if(!b.getSpaceUserStore(x).isWorkspaceOwner()&&!(0,I.hU)({spaceBotSettings:b.getBotSettingsStore().getValue(),integrationId:R.id,env:"production"}))return!1;const E=(0,j.NP)(R.id),B=function(e){var t;const{integration:n,pattern:o,blockStore:r,textValueBeforePaste:a}=e,s=r&&r.getType()===i.Ti.text&&0===(0,C.QaF)(a).trim().length,l=Boolean(null===(t=o.additional_types)||void 0===t?void 0:t.collection);return s?m.oA(["preview","mention","link",l&&"collection"]):m.oA(["mention","preview","link",l&&"collection"])}({blockStore:a,integration:R,pattern:D,textValueBeforePaste:p}),F=G.getRect(h);if(!F)return!1;const O=a.getRecordStoreUIParent();if(!O||!(0,W.dz)(O))return!1;const Z=new o.Z({name:"unfurlingActions.activateFromLinkCreation",isTemporaryData:!0});n.defaultRecordCache.inMemoryRecordCache.addCacheOverride(Z);const N=O.clone(Z),L=a.clone(Z),z=s.table===v.iU&&s===(null===(t=(0,K.sQ)(s))||void 0===t?void 0:t.getBlockTitleStore())?L.getBlockTitleStore():s.clone(Z),q=new ee.G(n,{table:v.iU,id:(0,g.ZP)(),spaceId:a.pointer.spaceId}),$=q.clone(Z),X=m.w6(T.wh).map((()=>new ee.G(n,{table:v.iU,id:(0,g.ZP)(),spaceId:(0,k.C)(a.pointer.spaceId)}))),te=X.map((e=>e.clone(Z))),oe=new ee.NW(n,{table:y.v,id:(0,g.ZP)(),spaceId:a.pointer.spaceId}),re=oe.clone(Z);let ae;ae=D.defaultViews?D.defaultViews.map((e=>new ee.Xr(n,{table:_.n,id:(0,g.ZP)(),spaceId:a.pointer.spaceId}))):[new ee.Xr(n,{table:_.n,id:(0,g.ZP)(),spaceId:a.pointer.spaceId})];const se=ae.map((e=>e.clone(Z))),le=m.w6(T.wh).map((()=>new ee.NW(n,{table:y.v,id:(0,g.ZP)(),spaceId:a.pointer.spaceId}))),ce=le.map((e=>e.clone(Z))),de=m.w6(T.wh).map((()=>new ee.Xr(n,{table:_.n,id:(0,g.ZP)(),spaceId:a.pointer.spaceId}))),ue=de.map((e=>e.clone(Z)));return ne.Z.setState({open:!0,url:S,textValueBeforePaste:p,textValueAfterPaste:s.getValue(),urlSelection:f,renderRect:F,integration:R,pattern:D,currentOption:{type:"link"},allOptionTypes:B,temporaryRecordCache:Z,stores:{blockStore:a,blockParentStore:O,textStore:s,externalObjectInstanceBlockStore:q,subExternalObjectInstanceBlockStores:X,externalCollectionStore:oe,externalCollectionViewStores:ae,subExternalCollectionStores:le,subExternalCollectionViewStores:de},temporaryStores:{blockParentStore:N,blockStore:L,textStore:z,externalObjectInstanceBlockStore:$,subExternalObjectInstanceBlockStores:te,externalCollectionStore:re,externalCollectionViewStores:se,subExternalCollectionStores:ce,subExternalCollectionViewStores:ue},unfurlResponse:void 0}),E.length>0&&ke({environment:n,url:d,botIds:E.map((e=>{let{id:t}=e;return t})),integrationId:R.id,externalObjectInstanceBlockStore:q}),ie._x(n,{integrationId:R.id,entity:D.name,domain:w.host,from:"link_paste"}),r.default.afterNextFlush((()=>{V.createAndCommit({userAction:"unfurlingActions.activateFromLinkCreation",environment:n,perform:e=>{Se({environment:n,type:B[0],useTemporaryRecordCache:!0,transaction:e,intl:H.default.getIntl()})}})})),!0}function _e(e){const{environment:t,setType:n,transaction:o}=e,{currentUserSettingsStore:r}=Q.default.state,i=ne.Z.state;if(!i.open)return;t.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(i.temporaryRecordCache);const a=(0,j.NP)(i.integration.id).length>0;if(Se({environment:t,type:n||i.currentOption.type,useTemporaryRecordCache:!1,transaction:o,intl:H.default.getIntl()}),"preview"===i.currentOption.type&&F.Z5({environment:t,stores:[i.currentOption.externalObjectInstanceBlockStore]}),i.integration&&!a){(null==r?void 0:r.hasDismissedIntegrationPopup({integrationId:i.integration.id}))||te.Z.setState({open:!0,integration:i.integration,externalObjectInstanceBlockId:i.stores.externalObjectInstanceBlockStore.id,unfurlUrl:i.url})}ne.Z.setState({open:!1})}function Se(e){const{environment:t,type:n,transaction:o,useTemporaryRecordCache:a}=e,s=ne.Z.state;if(!s.open)return;const c=t.currentUser.id;if(!c)return;const u=a?s.temporaryStores:s.stores;if(a){s.temporaryRecordCache.clearCache();for(const e in s.temporaryStores){const n=s.temporaryStores[e],o=Array.isArray(n)?n:[n];for(const e of o){const n={userId:c,pointer:e.pointer},o=t.defaultRecordCache.inMemoryRecordCache.getRecord(n);o?pe.Wl({environment:t,inMemoryRecordCache:s.temporaryRecordCache,pointer:e.pointer,model:f.kk.fromValue(e.pointer.table,o.value),role:o.role,updatePaths:[[]],userId:c,force:!0,debugSource:"setUnfurlingOptionType"}):pe.uo({environment:t,inMemoryRecordCache:s.temporaryRecordCache,persistedRecordCache:void 0,pointer:e.pointer,userId:c})}}}const p=(0,l.x$)(s.url),{host:g}=(0,M.Qc)(p);if(g){if("preview"===n||"mention"===n){const e=u.blockParentStore.getRecordStoreAtRootPath().useCrdt(),n={original_url:p,domain:g};let r;const{unfurlResponse:a}=s;if(a){const s=(0,P.m8)(m.oA(a.relations.map(((n,r)=>{if(n.external_schema)return;const a=u.subExternalObjectInstanceBlockStores[r];return a?((0,A.T)(!a.isDefined()),B.j4({environment:t,id:a.id,type:i.Ti.externalObjectInstance,spaceId:(0,k.C)(u.blockStore.pointer.spaceId),format:n,inMemoryRecordCache:a.inMemoryRecordCache,transaction:o,useCrdt:e}),B.sW({store:a,data:{parent_table:v.iU,parent_id:u.externalObjectInstanceBlockStore.id,alive:!0},transaction:o}),[n.uri,a.id]):void 0})))),{external_object_id:l,uri:c,bot_id:p}=a.root;if(l&&c&&p){let e,t;const o=(0,d.o)(a.root.attributes,(0,z.o$)());o&&(e=o.block_width,t=o.block_height),r={...n,...{...a.root,block_width:e,block_height:t,external_schema:void 0},related_external_object_uris_to_instance_ids:s,external_object_id:l,uri:c,bot_id:p}}else{var h;r={...n,attributes:a.root.attributes,error:a.root.error,auth_refresh_in_progress:439===(null===(h=a.root.error)||void 0===h?void 0:h.status_code)||null}}}else r=n;(0,A.T)(!u.externalObjectInstanceBlockStore.isDefined()),B.j4({environment:t,id:u.externalObjectInstanceBlockStore.id,type:"external_object_instance",format:r,inMemoryRecordCache:u.externalObjectInstanceBlockStore.inMemoryRecordCache,transaction:o,useCrdt:u.blockParentStore.getRecordStoreAtRootPath().useCrdt()})}else if("collection"===n){const{unfurlResponse:e}=s,t={id:u.externalObjectInstanceBlockStore.id,version:0,type:i.Ti.collectionView,format:{collection_pointer:u.externalCollectionStore.pointer},collection_id:u.externalCollectionStore.pointer.id,space_id:(0,k.C)(u.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:u.blockParentStore.id,alive:!0,view_ids:u.externalCollectionViewStores.map((e=>e.id))},n=u.externalCollectionViewStores.map(((e,t)=>{var n,o,r;return{id:e.id,version:0,space_id:(0,k.C)(u.blockStore.pointer.spaceId),type:(null===(n=s.pattern.defaultViews)||void 0===n?void 0:n[t].type)||"table",format:null===(o=s.pattern.defaultViews)||void 0===o?void 0:o[t].format,query2:null===(r=s.pattern.defaultViews)||void 0===r?void 0:r[t].query2,parent_table:v.iU,parent_id:u.externalObjectInstanceBlockStore.id,alive:!0}}));let a;if(e){const{external_object_id:n,uri:r,bot_id:i}=e.root;if(n&&r&&i)if("collectionId"in e&&e.collectionId){a={id:e.collectionId,version:0,space_id:(0,k.C)(u.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:u.externalObjectInstanceBlockStore.id,alive:!0,schema:{}},t.format=void 0,t.collection_id=e.collectionId}else{const t={};e.relations.forEach(((e,n)=>{const r=u.subExternalCollectionStores[n],i=e,a={id:r.id,version:0,space_id:(0,k.C)(u.blockStore.pointer.spaceId),parent_table:y.v,parent_id:u.externalCollectionStore.id,alive:!0,format:i,schema:{}};t[e.uri]=r.id,B.sW({store:r,data:a,transaction:o})}));a={id:u.externalCollectionStore.id,version:0,space_id:(0,k.C)(u.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:u.externalObjectInstanceBlockStore.id,alive:!0,format:{original_url:p,domain:g,...e.root,related_external_object_uris_to_instance_ids:{...t}},schema:{}}}else{a={id:u.externalCollectionStore.id,version:0,space_id:(0,k.C)(u.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:u.externalObjectInstanceBlockStore.id,alive:!0,format:{original_url:p,domain:g,error:e.root.error},schema:{}}}}else{a={id:u.externalCollectionStore.id,version:0,space_id:(0,k.C)(u.blockStore.pointer.spaceId),parent_table:v.iU,parent_id:u.externalObjectInstanceBlockStore.id,alive:!0,format:{original_url:p,domain:g},schema:{}}}B.sW({store:u.externalObjectInstanceBlockStore,data:t,transaction:o});const l=Ee();u.externalCollectionViewStores.forEach(((t,r)=>{e&&"collectionId"in e&&e.collectionId&&n[r].format&&(n[r].format={collection_pointer:{id:e.collectionId,table:y.v}}),l&&e&&"table"===n[r].type&&(n[r].format={...n[r].format,table_properties:Oe(e.root.external_schema)}),B.sW({store:t,data:n[r],transaction:o})})),B.sW({store:u.externalCollectionStore,data:a,transaction:o});const c=s.integration;r.default.afterNextFlush((()=>{const e=$.R.findCollectionViewBlockFromId(u.externalObjectInstanceBlockStore.id);if(e){const t=e.collectionContextStore.settingsStore;le.wl({collectionSettingsStore:t,item:{type:"shareSyncedView",integrationName:c.name,integrationIcon:c.info.icon}})}}))}if("preview"===n){O.sO({environment:t,store:u.textStore,value:s.textValueBeforePaste,transaction:o});const e=ee.G.createChildStore(u.blockParentStore,u.externalObjectInstanceBlockStore.pointer);if(E.BE({parent:u.blockParentStore,insert:e,after:u.blockStore,transaction:o}),0===(0,C.QaF)(s.textValueBeforePaste).trim().length){const e=ee.G.createChildStore(u.blockParentStore,s.stores.blockStore.pointer);E.Od({parent:u.blockParentStore,childToRemove:e,transaction:o})}const r=ee.G.createChildStore(s.stores.blockParentStore,s.stores.externalObjectInstanceBlockStore.pointer);F.ZH(t),ne.Z.setState({...s,currentOption:{type:n,externalObjectInstanceBlockStore:r}})}else if("mention"===n){const e=(0,C.x36)(u.externalObjectInstanceBlockStore.id),n=(0,C.YCD)(e),r=(0,C.P$X)(s.textValueBeforePaste,[n],s.urlSelection.startIndex),i={startIndex:s.urlSelection.startIndex+1,endIndex:s.urlSelection.startIndex+1};O.sO({environment:t,store:u.textStore,value:r,transaction:o}),B.sW({store:u.externalObjectInstanceBlockStore,data:{parent_id:u.textStore.id,parent_table:v.iU,alive:!0},transaction:o}),F.eP({environment:t,store:s.stores.blockStore}),Z.Z5({store:s.stores.textStore,selection:i}),ne.Z.setState({...s,currentOption:{type:"mention",mentionTokenSelection:i}})}else if("link"===n)ne.Z.setState({...s,currentOption:{type:"link"}}),F.eP({environment:t,store:s.stores.blockStore}),Z.Z5({store:s.stores.textStore,selection:{startIndex:s.urlSelection.endIndex,endIndex:s.urlSelection.endIndex}});else if("collection"===n){O.sO({environment:t,store:u.textStore,value:s.textValueBeforePaste,transaction:o});const e=ee.G.createChildStore(u.blockParentStore,u.externalObjectInstanceBlockStore.pointer);if(E.BE({parent:u.blockParentStore,insert:e,after:u.blockStore,transaction:o}),0===(0,C.QaF)(s.textValueBeforePaste).trim().length){const e=ee.G.createChildStore(u.blockParentStore,s.stores.blockStore.pointer);E.Od({parent:u.blockParentStore,childToRemove:e,transaction:o})}F.ZH(t),ne.Z.setState({...s,currentOption:{type:n}})}else(0,x.t1)(n);if(!a){const{unfurlResponse:e}=s;ie.Mp(t,{integrationId:s.integration.id,type:n,entity:s.pattern.name,domain:g,from:"unfurl_menu",...e&&{status:null!=e&&e.root.error?"failure":"success"},collection_id:"collection"===n?u.externalCollectionStore.pointer.id:void 0,collection_view_block_id:"collection"===n&&u.blockStore.isCollectionView()?u.blockStore.id:void 0})}}}async function we(e){const{environment:t,notionState:n}=e,{externalObjectInstanceBlockId:o,spaceId:r}=n;if(o){const e=new ee.G(t,{table:v.iU,id:o,spaceId:r});let n;if(await Promise.all([e.load(),Y.Z.waitUntil((()=>Y.Z.state.loaded))]),e.isExternalObjectInstanceBlockStore()||e.isExternalObjectInstancePageBlockStore())n=e.getFormat();else if(e.isCollectionView()){var i;n=null===(i=e.getCollectionViewSourceCollectionStore())||void 0===i?void 0:i.getFormat()}if(!n)throw new Error("External object instance has no value.");const a=n.original_url||n.uri;if(!a)throw new Error("External object instance has no original_url.");const s=(0,T.ny)({url:a,integrations:Y.Z.integrations.state,currentSpaceId:r});if("success"!==s.type)throw new Error("Could not find integration.");const{integration:l}=s,c=(0,j.NP)(l.id);if(0===c.length)throw new Error("Could not find bot.");if(e.isExternalObjectInstanceBlockStore()||e.isExternalObjectInstancePageBlockStore())await ke({environment:t,url:a,botIds:c.map((e=>{let{id:t}=e;return t})),integrationId:l.id,externalObjectInstanceBlockStore:e});else{if(!e.isCollectionView())throw new Error(`BlockStore is neither an ExternalObject nor a ExternalCollection. It has type: ${e.getType()}`);{const n=e.getCollectionViewSourceCollectionStore();if(!n)throw new Error("Could not find collection store.");await Ce({environment:t,url:a,botIds:c.map((e=>{let{id:t}=e;return t})),externalCollectionViewBlockStore:e,externalCollectionStore:n})}}}}async function ke(e){const{environment:t,url:n,botIds:o,integrationId:r,externalObjectInstanceBlockStore:a}=e;oe.Z.add(n);const s=await ae.unfurlUrl(t,{url:n,botIds:o,integrationId:r,spaceId:se.Bs()});oe.Z.delete(n);const c=ne.Z.state,u="success"===s.type?s.data:{root:{error:{status_code:s.status}},relations:[]};if(c.open&&c.stores.externalObjectInstanceBlockStore===a)ne.Z.setState({...c,unfurlResponse:u}),V.createAndCommit({userAction:"unfurlingActions.startUnfurlRequest",environment:t,perform:e=>{Se({environment:t,type:c.currentOption.type,useTemporaryRecordCache:!0,transaction:e,intl:H.default.getIntl()})}});else if(a.isExternalObjectInstanceBlockStore())!function(e){const{environment:t,unfurlResponse:n,url:o,externalObjectInstanceBlockStore:r}=e,a=r.pointer.spaceId,s=t.currentUser.id;if(!s)return;const c=(0,l.x$)(o),{host:u}=(0,M.Qc)(c);if(!u)return;if("collectionId"in n)return;const p=r.getFormat().related_external_object_uris_to_instance_ids,f=(0,P.m8)(Object.entries(p||{}).map((e=>{let[t,n]=e;return[t,ee.G.createChildStore(r,{id:n,table:v.iU,spaceId:r.getSpaceId()})]})));V.createAndCommit({userAction:"unfurlingActions.createExternalObjectInstanceFromInitialUnfurl",environment:t,perform:e=>{const s=(0,P.m8)(m.oA(n.relations.map((n=>{if(n.external_schema)return;let o=f[n.uri];return o?(B.sW({store:o,data:{type:i.Ti.externalObjectInstance,parent_table:v.iU,parent_id:r.id,alive:!0},transaction:e}),B.sW({store:o.getFormatStore(),data:n,transaction:e})):(o=B.j4({environment:t,type:i.Ti.externalObjectInstance,spaceId:a,format:n,inMemoryRecordCache:r.inMemoryRecordCache,transaction:e,useCrdt:r.useCrdt()}),B.sW({store:o,data:{parent_table:v.iU,parent_id:r.id,alive:!0},transaction:e})),[n.uri,o.id]})))),l=r.getFormatStore().getValue();let c,u;if(l&&(c=l.block_width,u=l.block_height),!c&&!u){const e=(0,d.o)(n.root.attributes,(0,z.o$)());e&&(c=e.block_width,u=e.block_height)}B.sW({store:r.getFormatStore(),data:{...{...n.root,block_width:c,block_height:u,external_schema:void 0,integration_id:null,original_url:o,is_placeholder:null,error:n.root.error??null},related_external_object_uris_to_instance_ids:s},transaction:e})}})}({environment:t,unfurlResponse:u,url:n,externalObjectInstanceBlockStore:a}),function(e){const{environment:t,url:n,spaceId:o,status:r}=e,i=(0,z.GQ)(n,o),a=(0,l.x$)(n),s=(0,M.Qc)(a);i&&s.host&&ie.Mp(t,{integrationId:i.integration.id,type:"preview",entity:i.pattern.name,domain:s.host,from:"link_preview_placeholder",...r&&{status:r}})}({environment:t,url:n,spaceId:a.getSpaceId(),...u&&{status:u.root.error?"failure":"success"}});else{if(!a.isCollectionView()){if(a.isExternalObjectInstancePageBlockStore())return;throw new Error(`BlockStore is neither an ExternalObject nor a ExternalCollection. It has type: ${a.getType()}`)}{const e=a.getCollectionViewSourceCollectionStore();if(!e)throw new Error("Could not find collection store.");V.createAndCommit({userAction:"unfurlingActions.startUnfurlRequest",environment:t,perform:o=>{xe({environment:t,unfurlResponse:u,url:n,externalCollectionStore:e,externalCollectionViewBlockStore:a,transaction:o})}})}}}async function Ie(e){const{environment:t,url:n,botIds:o,userDefinedExternalCollectionStore:r,relatedPageId:a}=e,s=r.getFormat();if(!s.uri||void 0!==s.external_object_id)return;oe.Z.add(n);const c=await ae.unfurlUrl(t,{url:n,botIds:o,spaceId:r.getSpaceId(),targetCollectionId:r.id,relatedPageId:a});if("failed"===c.type)return void ce.showError(c);oe.Z.delete(n);const d=c.data;let u;return"pageId"in d&&d.pageId?u=new ee.G(t,{table:v.iU,id:d.pageId,spaceId:r.getSpaceId()}):(u=new ee.G(t,{table:v.iU,id:(0,g.ZP)(),spaceId:r.getSpaceId()}),function(e){const{environment:t,unfurlResponse:n,url:o,rootUserDefinedExternalCollectionStore:r,rootExternalObjectInstancePageStore:a}=e,s=r.pointer.spaceId,c=t.currentUser.id;if(!c)return;const d=(0,l.x$)(o),{host:u}=(0,M.Qc)(d);if(!u)return;if(!n.root.external_object_id)return;const p=n.root;V.createAndCommit({userAction:"unfurlingActions.createExternalObjectInstancePageFromInitialUnfurl",environment:t,perform:e=>{const t={id:a.id,type:i.Ti.externalObjectInstancePage,space_id:s,parent_table:y.v,parent_id:r.id,alive:!0,format:p};B.sW({store:a,data:t,transaction:e})}})}({environment:t,unfurlResponse:d,url:n,rootUserDefinedExternalCollectionStore:r,rootExternalObjectInstancePageStore:u})),u}async function Ce(e){const{environment:t,url:n,botIds:o,externalCollectionStore:r,externalCollectionViewBlockStore:i}=e;oe.Z.add(n);const a=await ae.unfurlUrl(t,{url:n,botIds:o,spaceId:se.Bs()});oe.Z.delete(n);const s="success"===a.type?a.data:{root:{error:{status_code:a.status}},relations:[]};V.createAndCommit({userAction:"unfurlingActions.startUnfurlRequestForCollection",environment:t,perform:e=>{xe({environment:t,unfurlResponse:s,url:n,externalCollectionStore:r,externalCollectionViewBlockStore:i,transaction:e})}})}function xe(e){const{environment:t,unfurlResponse:n,url:o,externalCollectionStore:r,externalCollectionViewBlockStore:i,transaction:c}=e,d=(0,l.x$)(o),{host:u}=(0,M.Qc)(d);if(!u)return;const{external_object_id:p,uri:f,bot_id:h}=n.root;if(!p||!f||!h)return;const b=m.w6(T.wh).map((()=>new ee.NW(t,{table:y.v,id:(0,g.ZP)(),spaceId:i.pointer.spaceId}))),S={};n.relations.forEach(((e,t)=>{const n=b[t],o=e,a={id:n.id,version:0,space_id:(0,k.C)(i.pointer.spaceId),parent_table:y.v,parent_id:r.id,alive:!0,format:o,schema:{}};S[e.uri]=n.id,B.sW({store:n,data:a,transaction:c})}));const w={id:r.id,version:0,space_id:(0,k.C)(i.pointer.spaceId),parent_table:v.iU,parent_id:i.id,alive:!0,format:{original_url:d,domain:u,...n.root,property_visibility:(I=n.root.external_schema,I&&Object.keys(I).flatMap((e=>(0,a.HF)(e)?[]:{property:`${s.UU}${e}`,visibility:"hide_if_empty"}))),related_external_object_uris_to_instance_ids:{...S},is_placeholder:void 0,integration_id:void 0},schema:{}};var I;B.sW({store:r,data:w,transaction:c});if(Ee()&&n){const e=i.getCollectionViewIds();null==e||e.forEach((e=>{const t=ee.Xr.createChildStore(i,{table:_.n,id:e,spaceId:i.getSpaceId()});if("table"===t.getType()){const e={...t.getFormat(),table_properties:Oe(n.root.external_schema)};B.sW({store:t,data:{format:e},transaction:c})}}))}}async function Te(e){const{environment:t}=e,{externalObjectInstanceBlockPointersMap:n,externalCollectionInstancePointersMap:o}=X.Z.state;await ae.refetchExternalObjectInstanceBlocks(t,{recordPointers:[...Object.values(n),...Object.values(o)]}),X.Z.reset()}async function Me(e){const{environment:t,externalAuthenticationValue:n}=e;let o=await ae.getExternalIntegrationAccessToken(t,{botId:n.id,integrationId:n.integration_id,spaceId:n.space_id});if("failed"===o.type){const e=Y.Z.integrations.state.find((e=>e.id===n.integration_id));if(!e)return;me.oV({label:H.default.formatMessage(ge.userReAuth)}),await de.hM({environment:t,integration:e,spaceId:n.space_id,from:"integration_file_picker"});const r=Y.Z.bots.state.filter((e=>e.integration_id===n.integration_id))[0];if(!r)return;o=await ae.getExternalIntegrationAccessToken(t,{botId:r.id,integrationId:r.integration_id,spaceId:r.space_id})}return o}function Pe(e){const{integration:t}=e;return t.id===c.YM&&"on"===L.default.getEligibleGroup({experimentId:"box_file_picker",defaultGroup:"control"})?Ae({integrationType:"box",...e}):t.id===c.f3&&(0,q.qH)()?Ae({integrationType:"drive",...e}):void 0}function Ae(e){const{integrationType:t,integration:n}=e;return"box"===t?{type:t,title:H.default.formatMessage(ge.browse,{appName:n.name}),accounts:Y.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===n.id})),onSelect:Re(e)}:"drive"===t?{type:t,title:H.default.formatMessage(ge.browse,{appName:n.name}),accounts:Y.Z.externalAuthentications.state.filter((e=>{let{integration_id:t}=e;return t===n.id})),onSelect:Re(e)}:void 0}function Re(e){const{integration:t,environment:n,externalObjectTokenStore:o,externalObjectInstanceBlockStore:r}=e;return async e=>{let i=e?e.id:void 0;if(!e){const{currentSpaceStore:e}=Q.default.state,o=Y.Z.integrations.state.find((e=>{let{id:n}=e;return n===t.id}));if(o&&e){const r=Y.Z.bots.state;await de.hM({environment:n,integration:o,spaceId:e.id,from:"integration_file_picker"});const a=function(e,t){const n=Y.Z.bots.state;var o;if(e.length!==n.length)return null===(o=n.filter((e=>e.integration_id===t))[0])||void 0===o?void 0:o.id}(r,t.id);a&&(i=a)}}const a=Y.Z.externalAuthentications.state.find((e=>e.id===i));if(a){const e=await async function(e,t,n,o,r){if(!Y.Z.state.loaded)return;r.setState({error:!1,loading:!0});const i=await Me({environment:e,externalAuthenticationValue:o});if(r.setState({error:!i||"success"!==i.type,loading:!1}),i&&"failed"!==i.type)return i.data;ce.showDialog({message:H.default.formatMessage(ge.somethingWentWrong),showCancel:!0,keepFocus:!0,items:[{label:H.default.formatMessage(ge.copyDebuggingInformation),color:void 0,onAccept:()=>{const t={statusCode:null==i?void 0:i.status,integrationId:n.id,botId:o.id};D.RD({environment:e,stringValue:JSON.stringify(t,null,2),copiedMessage:ge.copiedDebuggingInfo})}}]})}(n,0,t,a,o);e&&(ue.Z(),await function(e){const{integration:t,tokenDetails:n,environment:o,externalObjectInstanceBlockStore:r,botId:i}=e;if(t.id===c.YM)return async function(e,t){const{access_token:n}=e;try{await(0,N.ZP)("https://cdn01.boxcdn.net/polyfills/core-js/2.5.3/core.min.js",{resourceType:N._g.Javascript});const e=[{url:"https://cdn01.boxcdn.net/platform/elements/15.0.0/en-US/picker.js",resourcetype:N._g.Javascript},{url:"https://cdn01.boxcdn.net/platform/elements/15.0.0/en-US/picker.css",resourcetype:N._g.Stylesheet}];await Promise.all(e.map((e=>{let{url:t,resourcetype:n}=e;return(0,N.ZP)(t,{resourceType:n})})))}catch(a){return void t(!0,"")}const o=document.createElement("div");o.setAttribute("id","box-app-container"),document.body.appendChild(o);const r=new Box.FilePicker;r.show("0",n,{size:"small",container:"#box-app-container",maxSelectable:1,logoUrl:"box"});const i=()=>{r.hide(),o.remove()};r.addListener("choose",(function(e){var n;const o=null==e||null===(n=e[0])||void 0===n?void 0:n.id;o&&t(!1,`https://app.box.com/file/${o}`),i()})),r.addListener("cancel",i)}(n,De({environment:o,externalObjectInstanceBlockStore:r,botId:i}));if(t.id===c.f3)return(0,q.vE)({environment:o,accessToken:n.access_token,callback:De({environment:o,externalObjectInstanceBlockStore:r,botId:i}),integration:t,from:"link_preview_placeholder"});return void function(){if(fe){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.warn("multiTextSelectionHelpers:",...t)}}(`no matching integration found for external file picker with integration ID ${t.id}}`)}({integration:t,environment:n,externalObjectInstanceBlockStore:r,externalObjectTokenStore:o,botId:a.id,tokenDetails:e}))}}}function De(e){const{environment:t,externalObjectInstanceBlockStore:n,botId:o}=e;return(e,r)=>{if(e)return ce.showDialog({message:H.default.formatMessage(ge.somethingWentWrong),showCancel:!0,keepFocus:!0,items:[{label:H.default.formatMessage(ge.copyDebuggingInformation),color:void 0,onAccept:()=>{const n={err:e,botId:o};D.RD({environment:t,stringValue:JSON.stringify(n,null,2),copiedMessage:ge.copiedDebuggingInfo})}}]});Fe({environment:t,externalObjectInstanceBlockStore:n,url:r,botId:o})}}function Ee(){return L.default.checkGate("is_visibility_enabled_for_db_sync")}function Be(e){const{environment:t,originRect:n,externalObjectInstanceBlockStore:o,integration:r}=e,i=[{type:"embed",onChange:n=>{Fe({environment:t,url:n,externalObjectInstanceBlockStore:o,placeholderIntegrationId:e.placeholderIntegrationId}),ue.Z()}}];if(L.default.checkGate("ai_source_picker")&&((null==r?void 0:r.id)===c.Gw||(null==r?void 0:r.id)===c.mC)){const n=(null==r?void 0:r.id)===c.Gw?"/images/external_integrations/github-icon.png":"/images/external_integrations/jira-icon.png";i.push({type:"aiSourcePicker",integration:null==r?void 0:r.id,defaultAvatar:n,onChange:n=>{Fe({environment:t,url:n,externalObjectInstanceBlockStore:o,placeholderIntegrationId:e.placeholderIntegrationId}),ue.Z()},getResults:async(e,n)=>await async function(e){const{environment:t,query:n,integrationId:o,botId:r}=e,i=r?[r]:Y.Z.bots.state.filter((e=>e.integration_id===o)).map((e=>{let{id:t}=e;return t}));if(0===i.length)return{root:{error:{status_code:500,messages:["No bot found for this integration"]}},relations:[]};return await async function(e){const{environment:t,query:n,botIds:o}=e,r=await ae.aiSourcePicker(t,{query:n,botIds:o,spaceId:se.Bs()}),i="success"===r.type?r.data:{root:{error:{status_code:r.status}},relations:[]};return"failed"===r.type&&ce.showError(r),i}({environment:t,query:n,botIds:i})}({environment:t,query:e,integrationId:n})})}if(r&&!t.device.isMobile){const n=Pe({integration:r,environment:t,externalObjectInstanceBlockStore:o,externalObjectTokenStore:e.externalObjectTokenStore});n&&i.push(n)}ue.$(t,{originGap:0,originRect:n,title:"Embed Link Preview",currentTab:"embed",tabs:i})}function Fe(e){const{environment:t,url:n,externalObjectInstanceBlockStore:o,placeholderIntegrationId:r,botId:a}=e,s=(0,T.ny)({url:n,integrations:Y.Z.integrations.state,currentSpaceId:o.getSpaceId()});if("success"===s.type){const{integration:e,pattern:r}=s,c=a?[a]:Y.Z.bots.state.filter((t=>t.integration_id===e.id)).map((e=>{let{id:t}=e;return t}));if(c.length>0){const a=o.getParentId(),s=(0,l.x$)(n),{host:d}=(0,M.Qc)(s);d&&a&&(V.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:e=>{B.sW({store:o,data:{type:i.Ti.externalObjectInstance},transaction:e}),B.sW({store:o.getFormatStore(),data:{original_url:n,domain:d},transaction:e})}}),ie._x(t,{integrationId:e.id,entity:r.name,domain:d,from:"placeholder"})),ke({environment:t,url:n,botIds:c,integrationId:e.id,externalObjectInstanceBlockStore:o})}else V.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:e=>{B.sW({store:o.getFormatStore(),data:{integration_id:null,original_url:n,is_placeholder:null},transaction:e})}})}else if("partial"===s.type){const{integration:e}=s;V.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:t=>{B.sW({store:o.getFormatStore(),data:{is_placeholder:null,integration_id:e.id,original_url:n,error:{status_code:p.Rl.UNPROCESSABLE_ENTITY}},transaction:t})}})}else"failure"===s.type?V.createAndCommit({userAction:"unfurlingActions.startUnfurlFromPlaceholder",environment:t,perform:e=>{B.sW({store:o.getFormatStore(),data:{is_placeholder:null,original_url:n,integration_id:r,error:{status_code:p.Rl.UNPROCESSABLE_ENTITY}},transaction:e})}}):(0,x.t1)(s)}function Oe(e){return e&&Object.entries(e).flatMap((e=>{let[t,n]=e;return(0,a.HF)(t)?[]:"hidden"===(null==n?void 0:n.visibility)?{property:`${s.UU}${t}`,visible:!1}:{property:`${s.UU}${t}`,visible:!0}}))}function Ze(e){const{environment:t,block:n,transaction:o}=e;if(!n.isDefined()||!re.M_(t)||!n.isType(i.Ti.externalObjectInstance))return;const r=(0,g.ZP)(),a={id:r,type:i.Ti.externalObjectInstance,parent_id:n.id,parent_table:n.table,space_id:n.getSpaceId(),alive:!0,format:n.getFormat()};B.ae({environment:t,table:v.iU,value:a,inMemoryRecordCache:n.inMemoryRecordCache,transaction:o});const s=n.getFormatStore().getKeyStore("related_external_object_uris_to_instance_ids").getValue();if(s)for(const i of Object.values(s)){const e={table:v.iU,id:i,spaceId:n.getSpaceId()};V.applyOperation({store:(0,ee.Kv)(n,e),operation:{pointer:e,path:[],command:"update",args:{parent_table:v.iU,parent_id:r}},transaction:o})}const l=[(0,C.YCD)((0,C.x36)(r))];B.sO({store:n,value:{type:i.Ti.text,properties:{title:l},format:null},transaction:o})}function Ve(e){var t;const{block:n,transaction:o,token:r,parentStore:i}=e,{tokenIndex:a}=r;if(!n.isDefined())return;const s=null===(t=i.getParentBlockStore())||void 0===t?void 0:t.getContentStore();if(!s)return;O.gy({block:i,transaction:o,tokenIndex:a})&&E.BE({parent:s,insert:n,after:i,transaction:o})}function Ue(e){const{environment:t,spaceId:n,from:o,store:r,bypassCache:i}=e,a=(0,z.y6)(r),s=(null==a?void 0:a.original_url)||(null==a?void 0:a.uri);if(!s)return;const l=(0,z.GQ)(s,n),d=(0,z.Ue)(s,n);if(!l||0===d.length)return;const u=r.getCollectionViewCollectionStore(),{integration:p,pattern:m}=l;r.isCollectionView()&&u?ae.refetchExternalObjectInstanceBlocks(t,{recordPointers:[{...u.pointer,spaceId:n}],bypassCache:i}):r.isExternalObjectInstancePageBlockStore()?c.tO.includes(p.id)?ke({environment:t,url:s,botIds:d.map((e=>{let{id:t}=e;return t})),integrationId:p.id,externalObjectInstanceBlockStore:r}):ae.refetchExternalObjectInstanceBlocks(t,{recordPointers:[{...r.pointer,spaceId:n}],bypassCache:i}):r.isExternalObjectInstanceBlockStore()&&ke({environment:t,url:s,botIds:d.map((e=>{let{id:t}=e;return t})),integrationId:p.id,externalObjectInstanceBlockStore:r}),ie.B3(t,{integrationId:p.id,entity:m.name,from:o})}},53471:(e,t,n)=>{n.d(t,{A3:()=>L,IL:()=>B,K_:()=>z,Q7:()=>F,W8:()=>j,Xo:()=>D,cR:()=>U,cT:()=>Z,dm:()=>G,nQ:()=>R,y:()=>N});n(21703),n(57658);var o=n(15095),r=n(7406),i=n(68626),a=n(72126),s=n(29477),l=n(4615),c=n(149),d=n(53770),u=n(23867),p=n(70203),m=n(63143),f=n(9291),g=n(91754),h=n(33954),v=n(33929),b=n(52533),y=n(2414),_=n(77080),S=n(73329),w=n(53730),k=n(91551),I=n(88923),C=n(88893),x=n(88280),T=n(57549),M=n(54642),P=n(35253);const A=(0,f.defineMessages)({uploadFileFailed:{defaultMessage:"Upload failed.",id:"uploadActions.uploadFailedError.message"}});function R(e){return e.filter((e=>e.getAlive())).map((e=>{const{source:t,title:n,size:o}=e.getProperties()||{};return{type:"remote",id:e.id,source:p.QaF(t),name:p.QaF(n),size:p.QaF(o),store:e}}))}function D(e){return{...E(e),id:(0,l.ZP)(),dataURL:URL.createObjectURL(e),type:"local"}}function E(e){return{file:e,name:e.name,size:`${(e.size/1024).toFixed(1)}KB`}}function B(e){var t;const n=e.files.map(E);null===(t=e.onBatchStart)||void 0===t||t.call(e,n);const o={};let i=0;s.dC(e.files,H,(t=>Promise.all(t.map((t=>{const n=(0,l.ZP)();return new Promise(((s,l)=>{const u={environment:e.environment,..."secure"===e.bucket?{bucket:e.bucket,record:e.record}:{bucket:e.bucket},file:t,onStart:t=>{var o;null===(o=e.onSingleFileStart)||void 0===o||o.call(e,t,n)},onProgress:t=>{var o,r;let{progressPercent:a,uploadedFiles:s}=t;null===(o=e.onBatchProgress)||void 0===o||o.call(e,{progressPercent:a,uploadedFiles:i}),null===(r=e.onSingleFileProgress)||void 0===r||r.call(e,{progressPercent:a,uploadedFiles:s},n)},onComplete:r=>{var a;i++,o[t.name]=r,null===(a=e.onSingleFileComplete)||void 0===a||a.call(e,r,n),s()},onError:t=>{var o;const r=new Error(t.message);null===(o=e.onSingleFileError)||void 0===o||o.call(e,r,n),l(r)},preventLimitFreeFileSize:e.preventLimitFreeFileSize};"confluence"===e.uploadType?async function(e){const{environment:t,file:n,preventLimitFreeFileSize:o}=e,i=n.type||"text/plain; charset=utf-8";if(F({preventLimitFreeFileSize:o,environment:t,file:n})){var s;null===(s=e.onStart)||void 0===s||s.call(e,E(n));const o=Math.floor(n.size/O)+1,f={bucket:e.bucket,name:n.name,contentType:i,supportExtraHeaders:!0,contentLength:n.size,numberOfFileChunks:o},g=await M.initiateMultipartUpload(t,f);var l;if("failed"===g.type)return void(null===(l=e.onError)||void 0===l||l.call(e,{message:g.error.message,offline:g.offline}));const h=await async function(e){const{file:t,signedUrlsForChunks:n}=e,o=[];let i,s,l,c=[];const u=[];for(let r=0;r<n.length;r++){i=r*O,s=(r+1)*O,l=r+1<n.length?t.slice(i,s):t.slice(i);const e=n[r],a=fetch(e,{method:"PUT",body:new Blob([l],{type:t.type})});o.push(a)}const p=a.yo(o,3);for(const[a,g]of p.entries()){var m;try{const e=await(0,d.Yb)((()=>Promise.all(g)),[100,1e3,3e3]);c=[...c,...e]}catch(f){return{error:(0,r.tg)(f)}}null===(m=e.onProgress)||void 0===m||m.call(e,{progressPercent:Math.floor(a/p.length*100),uploadedFiles:0})}return c.forEach(((e,t)=>{const n=e.headers.get("etag");n&&u.push({ETag:n,PartNumber:t+1})})),{value:u}}({file:n,signedUrlsForChunks:g.data.signedUrlsForChunks,onProgress:e.onProgress});var u;if(c.x.isFail(h))return void(null===(u=e.onError)||void 0===u||u.call(e,{message:h.error.message,offline:void 0}));const v={...f,multipartUploadEtags:h.value,fileKey:g.data.key,uploadId:g.data.uploadId},b=await M.completeMultipartUpload(t,v);var p,m;if("success"===b.type)null===(p=e.onComplete)||void 0===p||p.call(e,g.data.url);else null===(m=e.onError)||void 0===m||m.call(e,{message:b.error.message,offline:b.offline})}else L(e.environment)}(u):V(u)}))}))))).then((()=>{var t;const n=e.files.map((e=>o[e.name]));null===(t=e.onBatchComplete)||void 0===t||t.call(e,n)})).catch((t=>{var n;"confluence"===e.uploadType&&T.a1(e.environment,{import_source:"confluence",data:{import_type:"file",status:"failure",error:t,fileSize:e.files[0].size},flowId:e.flowId}),null===(n=e.onBatchError)||void 0===n||n.call(e,t)}))}function F(e){const{preventLimitFreeFileSize:t,environment:n,file:o}=e,r=x.subscriptionDataStoreInstance.state;let i=!1;if(n.device.isMobileNative){const e="personal"===C.M9(n);i=!((0,b.S$)({environment:n})&&e)}return!(!t&&r&&C.Bu(r)&&!i&&o.size>q)}const O=20971520;function Z(e){const{retryWhenOffline:t,backoffController:n=new y.h(void 0)}=e;V({...e,onComplete:t=>{var o;n.getFailures()>0&&_.default.logEvent("upload_offline_success_after_retries",n.getFailures()),null===(o=e.onComplete)||void 0===o||o.call(e,t)},onError:o=>{var r;if(t&&o.offline){if(_.default.checkGate("autoretry_file_uploads"))return void n.backOffOnFailure(10*m.C0).then((()=>{Z({...e,backoffController:n})}));_.default.logEvent("upload_offline_failure")}null===(r=e.onError)||void 0===r||r.call(e,o)}})}async function V(e){const{environment:t,file:n,preventLimitFreeFileSize:o}=e,r=n.type||"text/plain; charset=utf-8";if(F({preventLimitFreeFileSize:o,environment:t,file:n})){e.onStart&&e.onStart(E(n));const o="secure"===e.bucket?{bucket:e.bucket,name:n.name,contentType:r,record:{table:e.record.table,id:e.record.id,spaceId:(0,u.C)(e.record.spaceId)},supportExtraHeaders:!0,contentLength:n.size}:{bucket:e.bucket,name:n.name,contentType:r,supportExtraHeaders:!0,contentLength:n.size};"secure"===e.bucket&&await w.transactionQueue.awaitRecordTransaction(e.record);const a=await M.getUploadFileUrl(t,o);if("success"===a.type){const{url:t,signedPutUrl:o,putHeaders:l}=a.data,c=s.UZ(),d=new XMLHttpRequest;d.open("PUT",o),d.setRequestHeader("Content-type",r);for(const e of l)d.setRequestHeader(e.name,e.value);d.upload.addEventListener("progress",(t=>{if(t.lengthComputable){const n=Math.round(100*t.loaded/t.total);e.onProgress&&e.onProgress({progressPercent:n,uploadedFiles:0})}})),d.onreadystatechange=function(){4===d.readyState&&(200===d.status?c.resolve({value:t}):(i.log({level:"error",from:"uploadActions",type:"ClientUploadError",data:{miscDataToConvertToString:{status:d.status,responseText:d.responseText}}}),c.resolve({error:{message:v.default.formatMessage(A.uploadFileFailed),offline:0===d.status}})))},d.send(n);const u=await c.promise;u.error?e.onError&&e.onError(u.error):e.onComplete&&(e.onComplete(t),i.log({level:"info",from:"uploadActions",type:"ClientUploadSuccess",data:{miscDataToConvertToString:{url:t}}}))}else if(e.onError){const t=(0,h.wf)(v.default.getIntl(),a);e.onError({message:t,offline:a.offline})}}else L(e.environment)}function U(e){K({...e,onChange:t=>{if(!t.files||0===t.files.length)return;const n=Array.from(t.files);B({environment:e.environment,files:n,..."secure"===e.bucket?{bucket:e.bucket,record:e.record}:{bucket:e.bucket},onBatchStart:e.onStart,onBatchProgress:e.onProgress,onBatchComplete:e.onComplete,onBatchError:e.onError,preventLimitFreeFileSize:e.preventLimitFreeFileSize})}})}async function N(e){const t=s.UZ();return K({...e,onChange:e=>{const n=o.p4(e.files);t.resolve(n)}}),t.promise}function L(e){P.Bw({bannerStore:I.default.state.open?k.Z:S.Z,id:"SubscriptionEditingBlocker",styleKey:g.v.Red,contentKey:"upload_limit_exceeded"})}function j(){P.qL({bannerStore:S.Z,id:"SubscriptionEditingBlocker"}),P.qL({bannerStore:k.Z,id:"SubscriptionEditingBlocker"})}const z=5,q=1e6*z,H=5;let W;const K=function(e){W&&W.remove(),W=document.createElement("input"),W.type="file",W.style.opacity="0",W.style.pointerEvents="none",W.style.position="fixed",W.style.left="-1000px",W.style.top="-1000px",W.ariaHidden="true",document.body.appendChild(W),e.multiple?W.setAttribute("multiple",""):W.removeAttribute("multiple"),e.accept&&W.setAttribute("accept",e.accept),W.addEventListener("change",(()=>{e.onChange&&e.onChange(W)})),W.addEventListener("blur",(()=>{e.onBlur&&e.onBlur(W)})),W.addEventListener("click",(e=>{e.stopPropagation()})),W.click(),W.focus({preventScroll:!0})};function G(e){return e.filter($).map((e=>e.file))}function $(e){return"local"===e.type}},70782:(e,t,n)=>{n.d(t,{f:()=>y,x:()=>b});var o=n(87997),r=n(15145),i=n(9852),a=n(54153),s=n(75754),l=n(12955),c=n(87381),d=n(32223),u=n(55081),p=n(75538),m=n(80444),f=n(77080),g=n(79797),h=n(35793),v=n(97977);async function b(e){const{newCurrentUserId:t,loggedOutUserId:n,environment:r}=e;await v.setLocalStorageUserId(r,t),(0,i.xj)(t),await l.setCookie(r,{name:"notion_user_id",value:t});const s=r.currentUser.loggedInUserIds.filter((e=>e!==n)),m=await l.getGhostAdminUserId(r),g={...r,currentUser:new o.CurrentUser({id:t,loggedInUserIds:s,adminUserId:m})};if(r.updateCurrentUserId){const e={environment:r,currentUserId:t,userIds:s};"on"!==f.default.getGroup("await-update-user-id")?await r.updateCurrentUserId(e):r.updateCurrentUserId(e)}a.Z.set(c.currentUserIdKey,t),d.resetRecordSubscriptions(),p.default.reset();return await u.zJ(r)&&u.yH(g),await h.KJ(g,t),g}async function y(e){const{newCurrentUserId:t,environment:n,store:o}=e,{mainEditorCurrentBlockStore:i}=m.default.state,a=await b({environment:n,newCurrentUserId:t});if(i){const e=new g.G(a,o.pointer);m.default.setState({...m.default.state,mainEditorCurrentBlockStore:void 0}),s._({environment:a,store:e,pageVisitSource:r.tY.SwitchSpace})}}},12321:(e,t,n)=>{n.d(t,{j:()=>g,w:()=>h});n(21703),n(57658);var o=n(45953),r=n(21202),i=n(15047),a=n(77858),s=n(66079),l=n(45950),c=n(5659),d=n(88310),u=n(88632),p=n(29226),m=n(54642),f=n(4408);function g(e,t){!function(){v&&u.Z.removeListener(v);p.Z.reset()}(),async function(e,t){try{const n=await c.A.measure("loadUserContent","(current user)",(()=>async function(e){const{defaultRecordCache:t,currentUser:n}=e;if(!t.persistedRecordCache)throw new Error("No local database found.");const o=n.id;if(!o)throw new Error("User is not logged in.");const r=[],c=await l.yY({environment:e,recordPointers:[{table:s.dx,id:o}],recurFn:e=>{const t=[],n=e=>{e&&(e.table!==a.zU&&e.table!==s.dx||r.push(e),t.push(e))};return e.table===s.dx?(n(e.getUserPointer()),e.getSpaceViewPointers().forEach(n)):e.table===a.zU?(e.getBookmarkedPagePointers().forEach(n),e.getSharedPagePointers().forEach(n),n(e.getSpacePointer())):e.table===i.bx&&e.getPagePointers().forEach(n),t},recordIsRequired:e=>e.table===s.dx||e.table===a.zU});for(const i of r){const e=c.getModel(i);if(c.getRole(i)&&!e)throw new Error(`Not defined: ${i.table}, ${i.id}`)}return{recordMap:c.toJson({allowVersionDowngrade:!1})}}(e))),r=o.PF.create(n.recordMap);f.fL({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:r,debugSource:"fetchLocalUserContent"}),p.Z.setState({...p.Z.state,localSpaceInaccessiblePages:y(r,t)}),p.Z.state.readyPromise.resolve()}catch(n){}}(e,t),b(e);let n=u.Z.state.online;v=()=>{const t=u.Z.state.online;!t||n||p.Z.state.remoteSpaceInaccessiblePages||b(e),n=t},u.Z.addListener(v)}async function h(){await p.Z.state.readyPromise.promise}let v;async function b(e){d.$L("await_get_spaces_start");const t=await m.getSpaces(e,{},void 0,void 0,void 0,"getSpaces");d.$L("await_get_spaces_end");const n=e.currentUser.id;if("success"===t.type)for(const[r,i]of Object.entries(t.data)){const t=o.PF.create(i);f.fL({environment:e,userId:r,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:t,debugSource:"fetchAllUserSpaces"}),r===n&&(p.Z.setState({...p.Z.state,remoteSpaceInaccessiblePages:y(t,r)}),p.Z.state.readyPromise.resolve())}}function y(e,t){const n={};for(const{pointer:o}of e.getByTable(i.bx)){const a=o.id,s=e.getValue({table:i.bx,id:a});if(s){const o=new Set;if(s.pages){for(const t of s.pages){e.getValue({table:r.iU,id:t})||o.add(t)}n[t]||(n[t]={}),n[t][a]=o}}}return n}},39634:(e,t,n)=>{n.d(t,{j:()=>_,z:()=>S});var o=n(13991),r=n(24211),i=n(7250),a=n(7928),s=n(88642),l=n(97978),c=n(28020),d=n(79897),u=n(33929),p=n(58455),m=n(80444),f=n(77080),g=n(88280),h=n(25888),v=n(54642),b=n(98958),y=n(12714);function _(e){const{environment:t,from:n,prepopulatedContent:r}=e;h.Ot(t,{from:n});const a=(0,c.Fv)(),u=p.default.state;if(t.device.isMobileNative){const m=(0,c.B7)(t),g=`${t.device.os} v${t.device.mobileAppVersion}(${t.device.version})`,_="team@makenotion.com",w=`Help with my account ${null==m?void 0:m.getEmail()} on ${g}`,k=()=>{const e=encodeURIComponent(w);y.D({environment:t,url:`mailto:${_}?subject=${e}`})},I=t.mobileNative;I&&I.api.submitUserFeedback?I.submitUserFeedback({sendToEmailAddress:_,subject:w},k):k()}else if(u.isZendeskEnabled&&(0,l.Ug)()){const{userHighestPlanType:C,isSalesAssistedPlan:x}=(0,d.rf)(t);(0,s.g)({locale:o.SP,analyticsSettings:u,isForethoughtEnabled:f.default.checkGate("forethought"),forethoughtInitializeArgs:S(t),userHighestPlanType:C,isSalesAssistedPlan:x,cookieService:t.cookieService}),h.LS(t)}else if(u.isIntercomEnabled){function T(){if(a&&a.id)return v.annotateRecentIntercomConversation(t,{page:a})}let M=0;const P=3,A=60;async function R(){M++;const e=await T();e&&"success"===e.type&&"not_found"===e.data.status&&M<P&&setTimeout(R,A)}i.Nv({prepopulatedContent:r,waitForCssInsets:()=>b.waitForCssInsets(t)}),setTimeout(R,1e3*A)}}function S(e){var t,n,o;const i=u.default.getIntl(),s=null===(t=m.default.state.currentUserStore)||void 0===t?void 0:t.getValue(),l=s?(0,a.Nz)(i,s,!0):void 0,c=null===(n=g.subscriptionDataStoreInstance.state)||void 0===n?void 0:n.subscriptionTier,d=(null===(o=m.default.state.currentUserSettingsStore)||void 0===o||null===(o=o.getSettings())||void 0===o?void 0:o.preferred_locale)||r.al;return{fullName:l,email:null==s?void 0:s.email,planType:c,locale:d,cookieService:e.cookieService}}},1742:(e,t,n)=>{n.d(t,{BW:()=>g,GD:()=>f,sA:()=>h,uO:()=>b});n(57658);var o=n(68626),r=n(77897),i=n(63143),a=n(68056),s=n(77080),l=n(24666),c=n(10910);const d=!1,u=15*i.C0,p={user_flow_edit_block:.005,user_flow_edit_page_title:.01,user_flow_create_block:.01,user_flow_delete_block:.01};function m(e){if(d)return!0;const t=p[e];if(void 0!==t)return(0,r.aw)(t);const n=s.default.getConfigKey("event_trail_events",e);if("object"==typeof n&&"number"==typeof n.sampleRate)return(0,r.aw)(n.sampleRate);const o=s.default.getConfigKey("event_trail_events","defaultSampleRateUserFlows");return"number"==typeof o&&(0,r.aw)(o)}class f{constructor(e){this.stage=void 0,this.timeout=void 0,this.error=void 0,this.logDataInCaseOfFailure=void 0,this.postFinishCallbacks=[],this.environment=void 0,this.userFlow=void 0,this.entryPointName=void 0,this.handleTimeout=()=>{this.fail("timeout")};const{environment:t,userFlow:n,entryPointName:o,timeoutMs:r}=e;this.environment=t,this.userFlow=n,this.entryPointName=o;e.isEnabled??m(n)?(this.stage="inProgress",this.timeout=window.setTimeout(this.handleTimeout,r??u),this.debugLog("constructed")):this.stage="disable"}isDisabled(){return"disable"===this.stage}updateLogDataInCaseOfFailure(e){this.logDataInCaseOfFailure={...this.logDataInCaseOfFailure,...e}}succeed(){"inProgress"===this.stage&&this.finish("success")}fail(e){"inProgress"===this.stage&&(this.error=e,this.finish("fail"))}finish(e){this.stage=e,this.debugLog("finish"),"number"==typeof this.timeout&&window.clearTimeout(this.timeout),this.timeout=void 0,c.rT(this.environment,this.userFlow,{status:e,error:this.error,entryPointName:this.entryPointName}),"fail"===e&&o.log({level:"error",from:"userFlowActions",type:"userFlowFailed",data:{userFlow:this.userFlow,userFlowEntrypointName:this.entryPointName,userFlowError:this.error,...this.logDataInCaseOfFailure}});for(const t of this.postFinishCallbacks)t()}debugLog(){if(d){const o=this.entryPointName?`${this.userFlow}.${this.entryPointName}`:this.userFlow;for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.groupCollapsed(`${this.constructor.name} ${o} stage=${this.stage}`,...t),console.trace(),console.groupEnd()}}}class g extends f{constructor(e){super(e),this.pointer=void 0,this.succeedOnEnqueue=void 0,this.trackCallbacks=[];const{succeedOnEnqueue:t}=e;this.succeedOnEnqueue=t}track(e,t){if("inProgress"===this.stage&&void 0===this.pointer){this.pointer=e,v({tracker:this,transaction:t,succeedOnEnqueue:this.succeedOnEnqueue});for(const e of this.trackCallbacks)e();this.debugLog("track",e.id)}}}class h extends g{constructor(e,t){super({environment:e,userFlow:"user_flow_create_page",entryPointName:t,succeedOnEnqueue:!1}),this.handleTextSelectionChange=e=>{"inProgress"===this.stage&&this.pointer&&"editing"===e.state.mode&&(0,a.qS)(e.state.multiSelection)&&e.state.multiSelection.start.store.pointer.id===this.pointer.id&&this.succeed()},"inProgress"===this.stage&&this.trackCallbacks.push((()=>{l.default.addListener(this.handleTextSelectionChange),this.postFinishCallbacks.push((()=>{l.default.removeListener(this.handleTextSelectionChange)}))}))}}function v(e){const{tracker:t,transaction:n,succeedOnEnqueue:o}=e;"inProgress"===t.stage&&(t.updateLogDataInCaseOfFailure({transactionId:n.id,transactionUserAction:n.getUserActionForAnalyticsPurposesOnly()}),n.annotateWithUserFlow(t.userFlow),n.postCancelCallbacks.push((()=>{t.fail("cancelled_transaction")})),n.postEnqueueActions.push((()=>{n.isEmpty()?t.fail("empty_transaction"):o&&t.succeed()})))}function b(e,t,n,o){if(!m(t))return;v({tracker:new f({environment:e,userFlow:t,isEnabled:!0,entryPointName:o}),transaction:n,succeedOnEnqueue:!0})}},37181:(e,t,n)=>{n.d(t,{$n:()=>k,GK:()=>_,Kq:()=>I,Nb:()=>b,Qm:()=>w,Y:()=>C,Zf:()=>h,d2:()=>g,dM:()=>S,fG:()=>f,rx:()=>v,zq:()=>y});n(57658);var o=n(79946),r=n(42875),i=n(95477),a=n(15010),s=n(95697),l=n(80444),c=n(79797),d=n(75769),u=n(11969),p=n(9953),m=n(82530);async function f(e){if(!i.default.isAdminMode)return;const{currentUserSettingsStore:t}=l.default.state;if(!t)return;await t.load();const n=t.getSettings();if(!n)return;const{device:o}=e,a={};(0,r.r)()!==n.time_zone&&(a.time_zone=(0,r.r)()),o.isDesktopBrowser&&!n.used_desktop_web_app&&(a.used_desktop_web_app=!0),o.isMobileBrowser&&!n.used_mobile_web_app&&(a.used_mobile_web_app=!0),o.isElectron&&o.isMac&&!n.used_mac_app&&(a.used_mac_app=!0),o.isElectron&&o.isWindows&&!n.used_windows_app&&(a.used_windows_app=!0),o.isMobileNative&&o.isIOS&&!n.used_ios_app&&(a.used_ios_app=!0),o.isMobileNative&&o.isAndroid&&!n.used_android_app&&(a.used_android_app=!0),Object.keys(a).length>0&&m.createAndCommit({userAction:"userSettingsActions.updateUserSettingsOnReset",environment:e,perform:e=>{g({userSettingsStore:t,data:a,transaction:e})}})}const g=function(e){const{userSettingsStore:t,data:n,transaction:o}=e;p.sW({store:t.getSettingsStore(),data:n,transaction:o})};function h(e){m.createAndCommit({userAction:"userSettingsActions.setStartWeekToMonday",environment:e,perform:e=>{const{currentUserSettingsStore:t}=l.default.state;t&&g({userSettingsStore:t,data:{start_day_of_week:1},transaction:e})}})}function v(e){m.createAndCommit({userAction:"userSettingsActions.setStartWeekToSunday",environment:e,perform:e=>{const{currentUserSettingsStore:t}=l.default.state;t&&g({userSettingsStore:t,data:{start_day_of_week:0},transaction:e})}})}function b(e){const{transaction:t,userSettingsStore:n,spaceId:o,type:r}=e;p.sO({store:(0,c._J)(n,n.pointer,["settings","sidebar_outliner_settings",o,r,"has_pinned"]),value:!0,transaction:t})}function y(e){var t;const n=null===(t=l.default.state.currentSpaceStore)||void 0===t?void 0:t.id,o=l.default.state.currentUserSettingsStore,{collectionId:r,dbType:i,transaction:a}=e;if(n&&o){var s;const e=(null===(s=o.getSettings())||void 0===s?void 0:s.lastUsedTypedCollections)||{},t=e[n]||{},l=t[i]||[],c=[r,...l.filter((e=>e!==r))].slice(0,1);g({userSettingsStore:o,transaction:a,data:{lastUsedTypedCollections:{...e,[n]:{...t,[i]:c}}}})}}function _(e){const{transaction:t,userSettingsStore:n,integrationId:o}=e;p.sO({store:(0,c._J)(n,n.pointer,["settings","dismissed_link_preview_integration_popup",o]),value:!0,transaction:t})}function S(e,t){const n=(0,o.SY)(),r=(0,o.Q3)();if(!n||!r)return;const i={};r&&(i.fbp=r),n&&(i.click_ids=n),m.createAndCommit({userAction:"userSettingsActions.persistAdClick",environment:e,perform:e=>{e.postSubmitCallbacks.push((e=>{e||((0,o.iI)(),(0,o.HR)())})),g({userSettingsStore:t,data:i,transaction:e})}})}function w(e){const t=l.default.state.currentUserSettingsStore;if(!t)return;const n=t.getKeyStore("settings").getKeyStore("seen_share_button_tooltip_at").getValue();Boolean(n)||m.createAndCommit({userAction:"dismissShareButtonTooltip",environment:e,userId:t.id,perform:e=>{g({userSettingsStore:t,data:{seen_share_button_tooltip_at:Date.now()},transaction:e})}})}function k(e){let{environment:t,teamId:n}=e;if(!d.Z.hasShownTootlip(n))return;if((0,s.wP)(t))return;const o=(0,a.WD)(t);if(!o)return!1;m.createAndCommit({userAction:"userSettingsActions.dismissTeamAddAppTemplateTooltip",environment:t,userId:o.id,perform:e=>{g({userSettingsStore:o,data:{seen_team_add_app_template_tooltip_at:Date.now()},transaction:e})}}),u.y(t,{from:"team_add_app_template"})}function I(e,t){const{phase:n,transactionUserAction:o,userSettingsStore:r}=t;m.createAndCommit({environment:e,userAction:o,perform:e=>{g({userSettingsStore:r,transaction:e,data:{enterprise_launch_modal_phase:n}})}})}function C(e){const t=(0,a.WD)(e);t&&m.createAndCommit({environment:e,userAction:"userSettingsActions.setDismissStudentOrgPrompt",perform:e=>{g({userSettingsStore:t,transaction:e,data:{dismissed_sidebar_student_org_prompt:!0}})}})}},65452:(e,t,n)=>{n.d(t,{h:()=>g,l:()=>h});n(21703);var o=n(15157),r=n(72126),i=n(44615),a=n(29477),s=n(45953),l=n(21202),c=n(45950),d=n(5659),u=n(2688),p=n(92425),m=n(54642),f=n(4408);async function g(e){const{environment:t,userId:n,spaceId:o}=e,a=(0,i.NP)({userId:n,spaceId:o});if(!y||y!==a){let n;!function(e){b&&u.ZP.removeListener(b,e)}(t);const o=(t,o)=>{void 0!==n&&n!==o&&h(e),n=o},i=r.P2(o,5e3);b=u.ZP.addListener(a,i,void 0,t),y=a;if(!p.Z.getSharedPagesState(e))return h(e)}}async function h(e){const{environment:t,userId:n,spaceId:r}=e,i=p.Z.getSharedPagesState(e);if(i&&i.loadingDone)return i.loadingDone;const u=(0,a.UZ)();p.Z.setSharedPagesState({spaceId:r,userId:n,state:{currentPageIds:null==i?void 0:i.currentPageIds,loadingDone:u.promise}});try{const i=async function*(e,t,n){try{const n=await d.A.measure("loadUserSharedPages","(current user)",(()=>async function(e,t){const{id:n}=e.currentUser;if(!n)throw new Error("Must be logged in.");if(!e.defaultRecordCache.persistedRecordCache)throw new Error("No local database found.");const r=o.Z.get({userId:n,key:v({userId:n,spaceId:t.spaceId})})||void 0;if(!r)throw new Error("No local shared pages found.");const i=await c.yY({environment:e,recordPointers:r.map((e=>({table:l.iU,id:e}))),recurFn:()=>[],recordIsRequired:()=>!1});return{pages:r,recordMap:i.toJson({allowVersionDowngrade:!1})}}(e,{spaceId:t})));f.fL({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,recordMap:s.PF.create(n.recordMap),debugSource:"loadUserSharedPagesInSpace"}),yield n}catch(i){}const r=await m.getUserSharedPagesInSpace(e,{spaceId:t,includeDeleted:!0},n);"success"===r.type&&(e.defaultRecordCache.persistedRecordCache&&o.Z.set({userId:e.currentUser.id,key:v({userId:n,spaceId:t}),value:r.data.pages}),yield r.data)}(t,r,n);for await(const e of i)p.Z.setSharedPagesState({spaceId:r,userId:n,state:{currentPageIds:e.pages,loadingDone:u.promise}});const a=p.Z.getSharedPagesState(e);a&&a.currentPageIds?p.Z.setSharedPagesState({spaceId:r,userId:n,state:{currentPageIds:a.currentPageIds,loadingDone:void 0}}):p.Z.setSharedPagesState({spaceId:r,userId:n,state:void 0})}catch(g){p.Z.setSharedPagesState({spaceId:r,userId:n,state:void 0})}}function v(e){return`UserSharedPagesInSpace:${e.userId}:${e.spaceId}`}let b,y},9377:(e,t,n)=>{n.d(t,{E:()=>S,j:()=>w});n(97880);var o=n(74487);n(68120);const r=["2021-05-11","2021-05-13","2021-08-16","2022-02-22","2022-06-28"],i=r[r.length-1];o.literals(...r);var a=n(4615),s=n(77420),l=n(19889),c=n(35794),d=n(9291),u=n(57549),p=n(33929),m=n(80444),f=n(77080),g=n(79797),h=n(54642),v=n(47307),b=n(9953),y=n(82530);const _=(0,d.defineMessages)({webhookUrlError:{id:"webhookActions.webhookUrlError",defaultMessage:"Connection failed. Please wait and try again or try another URL."}});async function S(e){const{environment:t,integration:n,webhookUrl:o,webhookSecret:r,webhookSubscriptionId:d,onError:f,onSuccess:S=(()=>{})}=e,{currentUserRootStore:w,currentSpaceStore:k}=m.default.state;if(!w||!k)return{error:{success:!1}};if("failed"===(await h.testWebhookConnection(t,{integrationId:n.id,webhookUrl:o,webhookSecret:r||void 0})).type)return v.showErrorMessage(p.default.formatMessage(_.webhookUrlError)),{error:{success:!1}};const{serverCommitResult:I}=y.createAndCommit({userAction:"webhookActions.createWebhookSubscription",environment:t,perform:p=>{p.postSubmitCallbacks=[f];const h=Date.now(),v=k.id;if(e.webhookSubscriptionId){const e=m.default.state.currentSpaceStore,i=d&&e?g.n4.createChildStore(e,{id:d,table:c.b,spaceId:e.id}):void 0;if(i){const e=i.getWebhookUrl()!==o,a=i.getWebhookSecret()!==r;(e||a)&&(u.AS(t,{integration_id:n.id,has_updated_webhook_url:e||void 0,has_updated_webhook_secret:a||void 0}),b.sW({transaction:p,data:{webhook_url:o,webhook_secret:r,health:{status:"active"}},store:i}))}}else{const e=a.ZP();b.ae({environment:t,table:s.cZ,value:{id:e,space_id:v,parent_id:k.id,parent_table:"space",type:"external",alive:!0,name:n.getName(),icon:n.getInfo().icon,integration_id:n.id,capabilities:n.getCapabilities(),created_at:h,last_edited_at:h,last_edited_by_id:w.id,created_by_id:w.id,created_by_table:l.KJ,last_edited_by_table:l.KJ},inMemoryRecordCache:k.inMemoryRecordCache,transaction:p}),b.ae({environment:t,table:c.b,value:{id:a.ZP(),bot_id:e,space_id:v,parent_id:k.id,api_version:i,webhook_url:o,webhook_secret:r,parent_table:"space",last_edited_time:h,last_edited_by_id:w.id,created_by_id:w.id,created_time:h,created_by_table:l.KJ,last_edited_by_table:l.KJ,health:{status:"active"}},inMemoryRecordCache:k.inMemoryRecordCache,transaction:p}),u.eR(t,{integration_id:n.id,configuration_type:"manual",bot_id:e})}}});return await I,S(),{value:{success:!0}}}async function w(e){const t=f.default.checkGate("webhooks_beta"),{environment:n,spaceId:o}=e;if(!n.currentUser.isLoggedIn()||!t)return{webhookSubscriptionIds:[],recordMap:{}};const r=await h.getWebhookSubscriptions(n,{spaceId:o});if("failed"===r.type)throw v.showError(r),r;return r.data}},12304:(e,t,n)=>{n.d(t,{Cq:()=>F,Y:()=>B,Zi:()=>E});n(67294);var o=n(92996),r=n(46283),i=n(41432),a=n(72141),s=n(4615),l=n(71644),c=n(21202),d=n(6287),u=n(13493),p=n(70203),m=n(49902),f=n(9291),g=n(75330),h=n(6854),v=n(97978),b=n(28020),y=n(65183),_=n(33929),S=n(45010),w=n(77080),k=n(79797),I=n(1310),C=n(47307),x=n(9953),T=n(64964),M=n(993),P=n(82530),A=n(68422),R=n(73060),D=n(85893);const E=(0,f.defineMessages)({home:{id:"wikiActions.collectionView.home",defaultMessage:"Home"},allPages:{id:"wikiActions.collectionView.allPages",defaultMessage:"All pages"},pagesIOwn:{id:"wikiActions.collectionView.pagesIOwn",defaultMessage:"Pages I own"},pagePropertyName:{id:"wikiActions.collectionView.pagePropertyName",defaultMessage:"Page"},ownerPropertyName:{id:"wikiActions.collectionView.ownerPropertyName",defaultMessage:"Owner"},tagsPropertyName:{id:"wikiActions.collectionView.tagsPropertyName",defaultMessage:"Tags"},tagsDesignValue:{id:"wikiActions.collectionView.tagsDesignValue",defaultMessage:"Design"},tagsOnboardingValue:{id:"wikiActions.collectionView.tagsOnboardingValue",defaultMessage:"Onboarding"},verificationPropertyName:{id:"wikiActions.collectionView.verificationPropertyName",defaultMessage:"Verification"},undoToast:{id:"wikiActions.convertToWiki.undo.toastMessage",defaultMessage:"Turned {pageName} into a wiki"}});function B(e){const{blocks:t,transaction:n,environment:a,source:m}=e,f=(0,s.ZP)(),g=t[0];if(!g||!g.isPageBlock())return;const C=g.getSpaceId(),M=(0,s.ZP)(),A=g.getFormat().page_icon,B=(0,l.ZP)(),O=r.k.Owner,Z=(0,l.ZP)(),V=(0,l.ZP)(),U={title:{name:_.default.formatMessage(E.pagePropertyName),type:"title"},[O]:{name:_.default.formatMessage(E.ownerPropertyName),type:"person",default:"created_by"},[V]:{name:_.default.formatMessage(E.tagsPropertyName),type:"multi_select",options:[{id:(0,s.ZP)(),value:_.default.formatMessage(E.tagsOnboardingValue),color:"blue"},{id:(0,s.ZP)(),value:_.default.formatMessage(E.tagsDesignValue),color:"green"}]},[B]:{name:y.SO.last_edited_time,type:"last_edited_time",date_format:"relative"}},N=[{visible:!0,property:"title",width:300},{visible:!0,property:O,width:150},{visible:!0,property:Z,width:150},{visible:!0,property:V,width:150},{visible:!0,property:B,width:250}];U[Z]={name:_.default.formatMessage(E.verificationPropertyName),type:"verification",verifier_property:O};const L={table:d.v,id:M,spaceId:C};P.applyOperation({store:(0,k.Kv)(g,L),operation:{pointer:L,command:"set",path:[],args:{id:M,version:0,parent_table:c.iU,parent_id:g.id,space_id:C,name:g.getTitleValue(),schema:U,cover:g.getFormat().page_cover,format:{collection_mode:{type:"page_tree",root_page_pointer:{table:c.iU,id:g.id,spaceId:C}},app_config_uri:o.GZ,property_visibility:[{property:B,visibility:"hide"},{property:V,visibility:"show"},{property:O,visibility:"show"},{property:Z,visibility:"show"}],collection_page_properties:N,collection_cover_position:g.getFormat().page_cover_position},icon:A,alive:!0}},transaction:n});const j=(0,s.ZP)(),z=(0,s.ZP)(),q=(0,s.ZP)();x.sW({store:g,data:{type:i.Ti.collectionViewPage,collection_id:M,view_ids:[j,z,q]},transaction:n}),x.sW({store:g.getFormatStore(),data:{collection_pointer:L,app_config_uri:o.jh,app_uri_map:{[o.GZ]:M},app_id:f},transaction:n});const H={table:u.n,id:j,spaceId:C};P.applyOperation({store:(0,k.Kv)(g,H),operation:{pointer:H,command:"set",path:[],args:{id:j,version:0,type:"page",name:_.default.formatMessage(E.home),parent_id:g.id,parent_table:"block",space_id:C,format:{page_pointer:{id:(0,s.Mt)(g.id),spaceId:C,table:"block"}},alive:!0}},transaction:n});const W={table:u.n,id:z,spaceId:C};P.applyOperation({store:(0,k.Kv)(g,W),operation:{pointer:W,command:"set",path:[],args:{id:z,version:0,type:"table",name:_.default.formatMessage(E.allPages),parent_id:g.id,parent_table:"block",space_id:C,format:{table_properties:N},query2:{sort:[{property:B,direction:"descending"}]},alive:!0}},transaction:n});const K={table:u.n,id:q,spaceId:C};P.applyOperation({store:(0,k.Kv)(g,K),operation:{pointer:K,command:"set",path:[],args:{id:q,version:0,type:"table",name:_.default.formatMessage(E.pagesIOwn),parent_id:g.id,parent_table:"block",space_id:C,format:{table_properties:N,property_filters:[{id:(0,s.ZP)(),filter:{filter:{value:{type:"relative",value:"me"},operator:"person_contains"},property:O}}]},query2:{sort:[{property:B,direction:"descending"}]},alive:!0}},transaction:n});const G=S.Z.PageScroller;G&&G.scrollToTop({animate:!0}),R.rm(n),function(e,t){v.j(e,"wiki_convert",t),w.default.logEvent("wiki_convert",void 0,t)}(a,{source:m,root_page_id:g.id,collection_id:M}),function(e){const{environment:t,blocks:n}=e,o=n[0];if(!o||!o.isCollectionViewPageWithContent())return;const r=(0,p.QaF)(o.getTitleValue());I.ZP.setState({...I.ZP.state,shouldReset:!1});const i=(0,b.zj)()===o.id;T.oV({label:_.default.formatMessage(E.undoToast,{pageName:r}),durationMs:I.JY,right:(0,D.jsx)(h.wr,{blockStoreToOpen:i?void 0:o,performUndo:()=>{P.createAndCommit({userAction:"wikiActions.wikiConversionToast.undo",environment:t,perform:e=>{T.rN(),F({environment:t,blocks:n,transaction:e,source:"snackbar"})}})}})})}({environment:a,blocks:t})}function F(e){var t;const{environment:n,blocks:o,transaction:r,source:s}=e,l=o[0];if(!l||!l.isCollectionView())return void C.deprecatedShowErrorMessage("Something went wrong");const c=l.getFormat().collection_pointer;if(!c)return void C.deprecatedShowErrorMessage("Something went wrong");const d=k.NW.createChildStore(l,c),u=null===(t=l.getCover())||void 0===t?void 0:t.cover,p=d.getFormat().collection_cover_position,f=d.getName();A.vs({environment:n,block:l,blockType:i.Ti.page,transaction:r}),x.sW({store:l.getFormatStore(),data:{app_config_uri:null,app_uri_map:null,app_id:null,page_cover:u??null,page_cover_position:p??null},transaction:r}),M.sO({environment:n,store:l.getBlockTitleStore(),value:f,transaction:r});for(const i of l.getPermissionItems())if(a.C2(i)&&a.WY(i.role)&&!a.FB(i)){const e={...i,role:"read_and_write"};P.applyOperation({store:l.getPermissionItemsStore(),operation:{pointer:l.pointer,command:"setPermissionItem",path:l.getPermissionItemsStore().path,args:e},transaction:r})}g.A9({collectionViewBlockStore:l,collectionStore:d,transaction:r}),function(e,t){v.j(e,"wiki_undo_conversion",t),w.default.logEvent("wiki_undo_conversion",void 0,t),m.j({name:"wiki_undo_conversion",args:t})}(n,{source:s,root_page_id:l.id,collection_id:c.id})}},73060:(e,t,n)=>{n.d(t,{B1:()=>s,FO:()=>c,Rg:()=>l,nX:()=>u,rm:()=>d});var o=n(28182),r=n(80444),i=n(82530),a=n(37181);function s(){const{currentUserSettingsStore:e}=r.default.state;if(!e||!e.isReady())return;const t=e.getSettings();return t?t.wiki_onboarding_phase??"unseen":void 0}function l(e){const t=s();if(void 0===t)return;const n=o.dF.indexOf(t);if(-1!==n&&n<o.dF.length-1){const{currentUserSettingsStore:t}=r.default.state;if(!t)return;i.createAndCommit({userAction:"wikiOnboardingActions.advanceOnboardingStep",environment:e,perform:e=>{a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:o.dF[n+1]}})}})}}function c(e){const t=s();if(void 0===t)return;const n=o.dF.indexOf(t);if(-1!==n&&n>1){const{currentUserSettingsStore:t}=r.default.state;if(!t)return;i.createAndCommit({userAction:"wikiOnboardingActions.previousOnboardingStep",environment:e,perform:e=>{a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:o.dF[n-1]}})}})}}function d(e){const{currentUserSettingsStore:t}=r.default.state;t&&"unseen"===s()&&a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:"home"}})}function u(e){if("complete"===s())return;const{currentUserSettingsStore:t}=r.default.state;t&&i.createAndCommit({userAction:"wikiOnboardingActions.completeOnboarding",environment:e,perform:e=>{a.d2({userSettingsStore:t,transaction:e,data:{wiki_onboarding_phase:"complete"}})},userId:t.id})}},89626:(e,t,n)=>{n.d(t,{ON:()=>m,__:()=>u,h1:()=>f,lZ:()=>h,sy:()=>p,w9:()=>g});n(21703);var o=n(67294),r=n(480),i=n(49085),a=n(66673),s=n(28182),l=n(82530),c=n(37181),d=n(80444);const u=i.default.createValue(void 0);function p(){const{currentUserSettingsStore:e}=d.default.state;if(!e||!e.isReady())return;const t=e.getSettings();return t?t.ai_onboarding_phase??"space_for_ai":void 0}function m(e){"space_for_ai"===p()&&f(e)}function f(e){const t=p();if(void 0===t)throw new Error("Assertion failure, AI onboarding state is undefined!");const n=s.AQ.indexOf(t);if(-1===n)throw new Error(`Assertion failure, ${t} is not a valid AI onboarding state!`);if(n<s.AQ.length-1){const{currentUserSettingsStore:t}=d.default.state;if(!t)return;l.createAndCommit({userAction:"AiOnboardingActions.advanceAIOnboardingStage",environment:e,perform:e=>{c.d2({userSettingsStore:t,transaction:e,data:{ai_onboarding_phase:s.AQ[n+1]}})},userId:t.id})}}function g(e){const t=(0,r.O7)(),n="completionPopup"===e.type&&"results"===e.stage&&!e.loading,i=(0,a.D9)(n);(0,o.useEffect)((()=>{i&&!n&&"refine_ai_response"===p()&&f(t)}),[n,i,t])}function h(e){const t=(0,r.O7)(),n="results"===e.stage&&e.loading,i=(0,a.D9)(n);(0,o.useEffect)((()=>{n&&!i&&"ask_ai_anything"===p()&&f(t)}),[n,i,t])}},63594:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(49085).default.createValue(!0)},92022:(e,t,n)=>{n.r(t),n.d(t,{closeInitialPromptAndEndSession:()=>_,closeInitialPromptButContinueSession:()=>S,openHelpMeWriteGenericPopup:()=>I,retryInitialPrompt:()=>y,showInitialPromptForAIBlock:()=>w,toggleInitialPrompt:()=>k});var o=n(4615),r=n(10910),i=n(54642),a=n(84084),s=n(98104),l=n(78663),c=n(19124),d=n(68056),u=n(77907),p=n(80444),m=n(21273),f=n(16772),g=n(27724),h=n(24666),v=n(89626);function b(e){"completionPopup"!==e.type&&"assistantCompletionPopup"!==e.type||"initialPrompt"!==e.stage||"textSelection"!==e.context.type&&"cursor"!==e.context.type||s.NA({multiSelection:e.context.textSelection})}function y(e){f.default.invalidateLastUpdater();const{environment:t}=e,{state:n}=f.default;if("completionPopup"!==n.type||"results"!==n.stage)return;t.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(n.inMemoryRecordCache);const o={type:"completionPopup",stage:"initialPrompt",prefilledValue:"",context:n.context,sessionId:n.sessionId,from:n.from,futureRevisions:[...n.revisions,...n.futureRevisions]};f.default.setState(o)}function _(){b(f.default.state),f.default.setState({type:"closed"})}function S(){const{state:e}=f.default;b(e),"completionPopup"===e.type&&"initialPrompt"===e.stage&&f.default.setState({type:"closedWithContext",context:e.context,sessionId:e.sessionId,futureRevisions:e.futureRevisions}),setTimeout((()=>{"closedWithContext"===f.default.state.type&&f.default.reset()}),1)}function w(e){f.default.setState({...e,type:"completionPopup",stage:"initialPromptForAIBlock",from:"ai_block",prefilledValue:"",sessionId:(0,o.ZP)()}),C({environment:e.environment,promptForAnalytics:e.clientPrompt})}async function k(e){const{environment:t,from:n}=e;let{context:r,prefilledValue:a,sessionId:s}=e,c={type:"closed"};if("closed"===f.default.state.type){if(!r&&g.default.state.stores.length>0){const e=h.default.state;r="empty"===e.mode?(0,l.Xc)():(0,d.iG)(e.multiSelection)?(0,l.FD)():(0,l.Fu)()}if(r){if(a||(a=""),s||(s=(0,o.ZP)()),m.Z.isAssistantInWriterEnabled()){const{assistantActions:e}=await u.deps.assistant.loader();e.clearActiveAssistantSession({environment:t}),c={type:"assistantCompletionPopup",stage:"initialPrompt",context:r,from:n,sessionId:s,loading:!1,hasErrored:!1}}else c={type:"completionPopup",stage:"initialPrompt",context:r,from:n,prefilledValue:a,sessionId:s,futureRevisions:[]};p.default.state.currentSpaceStore&&i.publishAiSession(t,{inference_type:"writer",spaceId:p.default.state.currentSpaceStore.id,id:c.sessionId,metadata:{from:n}}),"spacebar"===n&&(0,v.ON)(t)}}f.default.setState(c),C(e)}function I(e){const{title:t,environment:n}=e,r=(0,l.FD)();if(!r)return;const i=t?(0,c.qB)({customPrompt:t,isPageEmpty:!0}):c.eL;k({environment:n,from:"page_menu",prefilledValue:(0,l.$W)(i),promptForAnalytics:i,sessionId:(0,o.ZP)(),context:r})}function C(e){const{environment:t,promptForAnalytics:n}=e,{state:o}=f.default;"completionPopup"===o.type&&"results"!==o.stage&&("initialPromptForAIBlock"!==o.stage&&s.ZH(t),r.Tl(t,{session_id:o.sessionId,prompt_key:(null==n?void 0:n.key)??(o.prefilledValue?"unknown":"alternative_ui_empty_input"),from:o.from}),a.xv())}},71184:(e,t,n)=>{n.d(t,{Gl:()=>l,JS:()=>c,QC:()=>d,gC:()=>s,kg:()=>u});n(30541);var o=n(4615),r=n(37181),i=n(30793);function a(e,t){return e.id===t.id}function s(e,t,n){const o=c(t).slice(),s=o.findIndex((t=>a(e,t)));-1===s?o.unshift(e):o.splice(s,1,e),(0,i.lG)(e.action,t,n),r.d2({userSettingsStore:t,transaction:n,data:{favorite_ai_actions:o}})}function l(e,t){for(const n of c(e))if((0,i.YK)(n.action,t))return n}function c(e){var t;return(null===(t=e.getModel())||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.favorite_ai_actions)??[]}function d(e,t,n){const o=c(t).filter((t=>!a(t,e)));r.d2({userSettingsStore:t,transaction:n,data:{favorite_ai_actions:o}})}function u(e){return{id:(0,o.ZP)(),name:e.promptTitle??"",action:{...e,promptTitle:void 0}}}},62878:(e,t,n)=>{n.r(t),n.d(t,{importGtmFavorite:()=>f});n(67294);var o=n(9291),r=n(10910),i=n(47307),a=n(64964),s=n(82530),l=n(80444),c=n(71184),d=n(24405),u=n(85893);function p(e){window.__c={n:"FavoriteImportContent"};const{favorite:t,isReplacingFavorite:n}=e,r=(0,d.yK)((e=>({title:{fontWeight:700,marginBottom:"1em"},prompt:{color:e.lightTextColor,maxHeight:"5em",overflowY:"scroll",whiteSpace:"pre-wrap"}})),[]),i=n?(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Overwrite “{favoriteName}” AI action?",id:"ai.favoriteActions.importFavorite.overwriteMessage",values:{favoriteName:t.name}}):(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Add “{favoriteName}” AI action?",id:"ai.favoriteActions.importFavorite.addMessage",values:{favoriteName:t.name}}),a=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"“{favoritePrompt}”",id:"ai.favoriteActions.importFavorite.prompt",values:{favoritePrompt:t.action.prompt}});return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{style:r.title,children:i}),(0,u.jsx)("div",{style:r.prompt,children:a})]})}var m=n(13555);async function f(e){const{environment:t}=e,n=await(0,m.cx)({environment:t,blockId:e.importArgs.blockId});"error"!==n.type?await async function(e){const{environment:t,newFavorite:n}=e,{currentUserSettingsStore:d}=l.default.state;if(!d)return;const m=(0,c.JS)(d);let f=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Add AI action",id:"ai.favoriteActions.importFavorite.addAction"}),g=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Cancel",id:"ai.favoriteActions.importFavorite.cancelAction"}),h=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"“{favoriteName}” AI action added to your Favorites.",id:"ai.favoriteActions.importFavorite.favoriteAdded",values:{favoriteName:n.name}}),v=!1;for(const r of m)if(r.name===n.name){if(r.action.type===n.action.type&&r.action.prompt===n.action.prompt)return void a.oV({label:(0,u.jsx)(o.FormattedMessage,{defaultMessage:"“{favoriteName}” AI action is already in your Favorites.",id:"ai.favoriteActions.importFavorite.alreadyInFavorites",values:{favoriteName:n.name}})});n.id=r.id,v=!0,f=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Overwrite existing AI action",id:"ai.favoriteActions.importFavorite.overwriteAction"}),g=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"Keep existing AI action",id:"ai.favoriteActions.importFavorite.keepExistingAction"}),h=(0,u.jsx)(o.FormattedMessage,{defaultMessage:"“{favoriteName}” AI action updated in your Favorites.",id:"ai.favoriteActions.importFavorite.favoriteUpdated",values:{favoriteName:n.name}});break}if(!(await i.confirmUserAction({message:(0,u.jsx)(p,{favorite:n,isReplacingFavorite:v}),acceptLabel:f,cancelLabel:g})))return;s.createAndCommit({userAction:"favoriteActions.handleFavoriteImport",environment:t,perform(e){(0,c.gC)(n,d,e)}}),a.oV({label:h}),r.Vo(t,{type:"create_from_url",session_id:void 0,gtm_favorite_id:n.gtmFavoriteId})}({environment:t,newFavorite:n.favorite}):a.oV({label:(0,u.jsx)(o.FormattedMessage,{defaultMessage:"An error occurred when loading the AI action. ({errorCode})",id:"ai.favoriteActions.importFavorite.favoriteFailedToLoad",values:{errorCode:n.code}})})}},13555:(e,t,n)=>{n.d(t,{OF:()=>f,cx:()=>v});var o=n(4615),r=n(45953),i=n(70203),a=n(54642),s=(n(95477),n(77080));let l=function(e){return e[e.NoConfig=100]="NoConfig",e[e.LoadPageChunkFailed=101]="LoadPageChunkFailed",e[e.MissingPageRecord=103]="MissingPageRecord",e[e.InvalidPageParent=104]="InvalidPageParent",e[e.MissingTitle=105]="MissingTitle",e[e.MissingPromptText=106]="MissingPromptText",e[e.MissingCollectionSchema=107]="MissingCollectionSchema",e[e.MissingPromptType=108]="MissingPromptType",e[e.InvalidPromptType=109]="InvalidPromptType",e[e.FavoritesDisabled=110]="FavoritesDisabled",e}({});const c="Prompt type",d="Prompt text",u="Run immediately",p="Help me write",m="Help me edit";function f(){{const e=s.default.getConfigKey("gtm_ai_favorites","space_id"),t=s.default.getConfigKey("gtm_ai_favorites","collection_id");if(e&&t)return{spaceId:e,collectionId:t}}}function g(e,t,n){const o=function(e,t,n){for(const r in e){const i=e[r];var o;if(i&&i.name===n)return null===(o=t.properties)||void 0===o?void 0:o[r]}}(e,t,n);if(o)return(0,i.Jcv)(o)}function h(e){return{type:"error",code:e}}async function v(e){var t;const{environment:n,blockId:v}=e;if(await s.default.waitUntilStatsigReady(),!s.default.checkGate("ai_favorites"))return h(l.FavoritesDisabled);const b=f();if(!b)return h(l.NoConfig);const{spaceId:y,collectionId:_}=b,S=await a.loadCachedPageChunk(n,{page:{spaceId:y,id:v},limit:0,chunkNumber:0,cursor:{stack:[]},verticalColumns:!1});if("success"!==S.type)return h(l.LoadPageChunkFailed);const w=r.PF.create(S.data.recordMap),k=w.getValue({table:"block",id:v,spaceId:y});if(!k)return h(l.MissingPageRecord);if(k.parent_id!==_)return h(l.InvalidPageParent);const I=(0,i.Jcv)(null===(t=k.properties)||void 0===t?void 0:t.title);if(!I)return h(l.MissingTitle);const C=await async function(e){const{environment:t,recordMap:n,blockId:o,spaceId:r,collectionId:i}=e,s=n.getValue({table:"collection",id:i,spaceId:r});if(null!=s&&s.schema)return s.schema;const l=await a.getPublicPageData(t,{type:"block-space",blockId:o,spaceId:r});return"failed"!==l.type?l.data.collectionSchema:void 0}({environment:n,recordMap:w,blockId:v,spaceId:y,collectionId:_});if(!C)return h(l.MissingCollectionSchema);const x=g(C,k,d);if(!x)return h(l.MissingPromptText);const T=g(C,k,c);if(!T)return h(l.MissingPromptType);const M=(P=T)===m?"helpMeEdit":P===p?"helpMeWrite":void 0;var P;if(!M)return h(l.InvalidPromptType);const A=function(e,t,n){return"Yes"===g(e,t,n)}(C,k,u);return{type:"success",favorite:{id:(0,o.ZP)(),name:I,executeImmediately:A,gtmFavoriteId:v,action:{type:M,prompt:x,promptTitle:void 0}}}}},57819:(e,t,n)=>{n.d(t,{$b:()=>I,Dj:()=>x,RR:()=>_,Tq:()=>k,VZ:()=>S,bJ:()=>y,jq:()=>C,rR:()=>w,yR:()=>T});var o=n(67294),r=n(480),i=n(86628),a=n(24405),s=n(42875),l=n(66673),c=n(82883),d=n(97880),u=n(893),p=n(56518),m=n(43455),f=n(33929),g=n(89224),h=n(80444),v=n(17903),b=n(42057);function y(){const e=(0,r.O7)(),t=(0,i.VK)((()=>e.device.isPhone),[e]);return(0,a.yK)((e=>{const n="dark"===e.mode?e.accentColors.purple[900]:e.accentColors.purple[400];return{purpleButton:{padding:4,fontWeight:600,color:n},keyboardShortcut:{textTransform:"uppercase",fontWeight:500,fontSize:11,marginLeft:6,color:e.lightTextColor,display:t?"none":void 0},lightweightButton:{display:"flex",alignItems:"baseline",justifyContent:"center",fontSize:14,padding:"5px 8px",borderRadius:4,color:e.mediumTextColor,height:32,marginTop:2},returnIndicatorIconStyles:{width:14,height:14,paddingLeft:4,fill:e.lightIconColor},keyboardShortcutInverted:{color:e.mediumInvertedTextColor,paddingLeft:4},writingLabel:{flex:1,color:n,fontWeight:500,flexDirection:"row",gap:6,display:"flex",alignItems:"center"},inputActions:{height:36,display:"flex",alignSelf:"flex-end",alignItems:"center"},loadingDots:{backgroundColor:n}}}),[t])}function _(e){if("completionPopup"===e.type||"assistantCompletionPopup"===e.type)return e}function S(e){return"initialPromptForAIBlock"===e.stage?"aiBlock":e.context.type}function w(e){return"initialPromptForAIBlock"===e.stage?"write":function(e){switch(e.type){case"cursor":return"write";case"blockSelection":case"textSelection":return"edit"}}(e.context)}function k(e){g.clear(e)}function I(e){if("initialPromptForAIBlock"===e.stage){const t=e.originRef.current;if(!t)return;return{origin:t.getBoundingClientRect(),scrollerStore:x(e.store.getRecordStoreUIRoot())}}return e.context}function C(e){const{areWeLoading:t,scrollerStore:n,resetWhenScrolledToBottom:r}=e,a=(0,l.D9)(t);(0,o.useEffect)((()=>{t!==a&&c(!1)}),[t,a]);const[s,c]=(0,o.useState)(!1),d=(0,i.VK)((()=>null==n?void 0:n.state.scrollTop),[n]),u=(0,l.D9)(d),p=(0,i.VK)((()=>{const e=null==n?void 0:n.state.clientRect;if(e)return n.state.scrollHeight-e.height}),[n]);return(0,o.useEffect)((()=>{void 0!==u&&void 0!==d&&u-d>1&&c(!0)}),[d,u]),(0,o.useEffect)((()=>{r&&void 0!==d&&void 0!==p&&Math.abs(d-p)<1&&c(!1)}),[p,d,r]),s}function x(e){return e===h.default.state.mainEditorCurrentBlockStore?v.Z:b.Z}function T(e,t){const n=f.default.getIntl(),o=(0,c.X)({intl:n,textValue:t.getBlockTitleStore().getValue(),getRecordModel:t.getRecordModel,userTimeZone:(0,s.r)()}),r=t.getRenderableContentStores().map((e=>e.getValue())).filter(d.$K);return{title:o,content:[u.jm({rootBlock:{...t.pointer,spaceId:t.getSpaceId()},getRecordValue:t.getRecordValue}),(0,p.X4)({rootBlock:{...t.pointer,spaceId:t.getSpaceId()},getRecordValue:t.getRecordValue,blockValues:r,isWindows:e.device.isWindows,markdownSerializationOptions:(0,m.KF)(),markdownLinkifyIt:void 0}).markdown].filter(d.$K).join("\n\n")}}},72899:(e,t,n)=>{n.d(t,{E0:()=>r,GC:()=>i,oF:()=>a});var o=n(77907);const r=o.deps.ai,i=(0,o.lazyComponent)(r,(e=>e.CompletionPopup)),a=(0,o.lazyComponent)(r,(e=>e.AiEligibilityUpdater))},30793:(e,t,n)=>{n.d(t,{BG:()=>c,Nv:()=>a,TE:()=>u,YK:()=>i,lG:()=>l,pz:()=>s});var o=n(37181);const r=100;function i(e,t){return e.prompt===t.prompt&&e.type===t.type}function a(e,t,n){const a=s(t).filter((t=>!i(t,e)));o.d2({userSettingsStore:t,transaction:n,data:{recent_ai_actions:[e,...a].slice(0,r)}})}function s(e){var t;return(null===(t=e.getModel())||void 0===t||null===(t=t.getSettings())||void 0===t?void 0:t.recent_ai_actions)??[]}function l(e,t,n){const r=s(t),a=r.filter((t=>!i(t,e)));r.length!==a.length&&o.d2({userSettingsStore:t,transaction:n,data:{recent_ai_actions:a}})}function c(e){const{clientPrompt:t,additionalContext:n,promptTitle:o}=e,r=null==n?void 0:n.prompt;if(("helpMeWrite"===t.key||"helpMeEdit"===t.key||"helpMeDraft"===t.key)&&r)return{type:"helpMeDraft"===t.key?"helpMeWrite":t.key,prompt:r,promptTitle:o};const i=function(e,t){if(!u(e.key))return;return null==t?void 0:t.topic}(t,n);return i?{type:"helpMeWrite",prompt:i,promptTitle:o}:void 0}const d={brainstormIdeas:!0,blogPost:!0,outline:!0,socialMediaPost:!0,pressRelease:!0,creativeStory:!0,essay:!0,poem:!0,todoList:!0,meetingAgenda:!0,prosConsList:!0,jobDescription:!0,salesEmail:!0,recruitingEmail:!0};function u(e){return d[e]}},24502:(e,t,n)=>{n.d(t,{M:()=>c,Z:()=>l});var o=n(67294),r=n(15095),i=n(72126),a=n(24990),s=n(77907);function l(){(0,o.useEffect)((()=>{c()}),[])}const c=i.IH((async function(){const e=await s.deps.emojiData.loader();a.Z.setState((0,r.Lq)(e))}))},4993:(e,t,n)=>{n.d(t,{M:()=>i,Z:()=>s});var o=n(67294),r=n(480);const i=new Set;function a(){for(const e of i)e()}function s(){const e=(0,r.Fy)();(0,o.useEffect)((()=>{if(e.isMobile)return document.addEventListener("scroll",a,!0),()=>{document.removeEventListener("scroll",a,!0)}}),[e.isMobile])}},30583:(e,t,n)=>{n.d(t,{IL:()=>s,ZP:()=>l});var o=n(67294),r=n(480),i=n(25898),a=n(39500);let s={x:0,y:0,moved:!1,device:"mouse"};function l(){const e=(0,r.O7)();(0,o.useEffect)((()=>(e.device.isMobile?(window.addEventListener("touchstart",c),window.addEventListener("touchmove",d),window.addEventListener("mousedown",u),window.addEventListener("mousemove",p)):(window.addEventListener("mousedown",u),window.addEventListener("mousemove",p)),()=>{e.device.isMobile?(window.removeEventListener("touchstart",c),window.removeEventListener("touchmove",d),window.removeEventListener("mousedown",u),window.removeEventListener("mousemove",p)):(window.removeEventListener("mousedown",u),window.removeEventListener("mousemove",p))})),[e.device.isMobile])}function c(e){const t=e.touches[0];s={moved:!1,x:t.clientX,y:t.clientY,device:(0,a.Nf)(t)}}function d(e){const{x:t,y:n}=s,o=e.touches[0];(0,i.Z)(t,n,o.clientX,o.clientY)>a.Vc[(0,a.Nf)(o)]&&(s={...s,moved:!0})}function u(e){s={moved:!1,x:e.clientX,y:e.clientY,device:"mouse"}}function p(e){const{x:t,y:n}=s;(0,i.Z)(t,n,e.clientX,e.clientY)>a.Vc.mouse&&(s={...s,moved:!0})}},91851:(e,t,n)=>{n.d(t,{NN:()=>G,vD:()=>H,Xi:()=>q,w0:()=>$,RQ:()=>W,uR:()=>Q});n(21703),n(57658);var o=n(67294),r=n(92996),i=n(41892),a=n(8848),s=n(12396),l=n(33907),c=n(88437),d=n(37612),u=n(72126),p=n(4615),m=n(89101),f=n(21202),g=n(15047),h=n(29369),v=n(97880),b=n(82990),y=n(64002),_=n(9291),S=n(8406),w=n(54642),k=n(16956),I=n(47307),C=n(96802),x=n(8055),T=n(82530),M=n(37181),P=n(86628),A=n(24405),R=n(20616),D=n(40235),E=n(85893);function B(e){window.__c={n:"AppTemplateRelatedDependenciesDelete"};const{relatedDependencies:t}=e,n=(0,A.Fg)(),r=(0,P.VK)((()=>{const e=null==t?void 0:t.viewDeps;return e?e.map((e=>({name:e.getName(),icon:e.getFormat().collection_view_icon,type:e.getType()}))):[]}),[t.viewDeps]),i=o.useCallback((e=>(0,E.jsxs)("span",{style:{marginRight:10,display:"inline-block"},children:[(0,E.jsx)(R.F,{color:"light",viewIcon:e.icon,viewType:e.type,style:{display:"inline-block",verticalAlign:"middle",marginRight:2,marginBottom:2},size:13}),e.name]},e.name)),[]),a=[{key:"entity_type",header:void 0},{key:"entities",header:void 0}];return(0,E.jsx)(D.Z,{columns:a,rows:(()=>{const e=[],o=null==t?void 0:t.propertyDeps;if(o.length>0){const t=o.map((e=>(0,E.jsxs)("span",{style:{marginRight:10,display:"inline-block"},children:[(0,E.jsx)(s.ZP,{icon:e.icon,type:e.type,size:13,style:{display:"inline-block",verticalAlign:"middle",marginRight:2,marginBottom:2},theme:n}),e.name]},e.name))),r=(0,E.jsx)(_.FormattedMessage,{id:"appTemplates.featureBundleDelete.properties",defaultMessage:"{count, plural, one {1 property} other {{count} properties}}",values:{count:t.length}});e.push({key:"bundledProperties",columns:[[r],t]})}if(r.length>0){const t=r.map((e=>i(e))),n=(0,E.jsx)(_.FormattedMessage,{id:"appTemplates.featureBundleDelete.views",defaultMessage:"{count, plural, one {1 view} other {{count} views}}",values:{count:t.length}});e.push({key:"bundledViews",columns:[[n],t]})}return e})(),hideHeader:!0,cellStyle:{width:"40%"}})}var F=n(76798),O=n(27383),Z=n(33929),V=n(77907),U=n(95802),N=n(80444),L=n(79797),j=n(40663);const z=(0,_.defineMessages)({multiDBNameConnector:{id:"appTemplateHelpers.multiDBNameConnector",defaultMessage:"and"}});function q(e,t){const{spaceViewStore:n}=t,o=n.getSpaceId();if(!o)return;const r=y.bf({url:m._j.workspaceSetup,query:{spaceId:p.cj(o)}});N.default.setState({...N.default.state,mainEditorCurrentBlockStore:void 0}),x.c4({environment:e,url:r})}function H(e){const{environment:t,collectionViewBlockStore:n,collectionStore:o,databaseType:i,propertyMapping:a,typedPropertySchemas:s,transaction:l}=e;if(o.isTypedCollection())throw new Error("Collection is already typed");const c=r.LI[i].blockUri,d=i,u={};Object.entries(a).forEach((e=>{let[n,i]=e;if(!i||i===r.bK)return;const a=s[n],c=o.getSchema()[i];if(!c)throw new Error("Mapped property does not exist");a&&a.type!==c.type&&(k.LC({environment:t,collectionStore:o,property:i,type:a.type,transaction:l}),u[i]=c.type)}));const m=Object.entries(a).filter((e=>{let[t,n]=e;return n===r.bK})).map((e=>{let[t,n]=e;return t})),f={};m.forEach((e=>{const t=s[e];t&&(f[e]=t)})),Object.entries(f).forEach((e=>{let[n,r]=e;const i=k.G3({environment:t,collectionStore:o,collectionViewArgs:void 0,propertyName:r.name,propertyType:r.type,transaction:l});a[n]=i})),C.FH({stores:[n],update:{app_id:(0,p.ZP)(),app_config_uri:c,app_uri_map:{[c]:n.id,[d]:o.id}},transaction:l}),C.FH({stores:[o],update:{app_config_uri:d,app_uri_map:a,mapped_property_types:u},transaction:l})}function W(e){var t;const{environment:n,collectionContextStore:o,transaction:r}=e,i=o.collectionStore(),a=o.collectionViewBlockStore();if(!i||!a)return;const s=(null===(t=i.getFormat())||void 0===t?void 0:t.mapped_property_types)??{};Object.entries(s).forEach((e=>{let[t,o]=e;k.LC({environment:n,collectionStore:i,property:t,type:o,transaction:r})})),C.FH({stores:[a],update:{app_id:void 0,app_config_uri:void 0,app_uri_map:void 0},transaction:r}),C.FH({stores:[i],update:{app_config_uri:void 0,app_uri_map:void 0,mapped_property_types:void 0},transaction:r}),S.g2({environment:n,database_type:void 0,collectionContextStore:o})}async function K(e){const{environment:t,blockStore:n}=e,o=n.getFormat().app_id;if(!o)return[n];const r=await w.getCollectionViewBlocksByAppId(t,{spaceId:n.getSpaceId(),appId:o}),i=n.getParentStore();return"success"!==r.type||void 0===i?[n]:r.data.result.map((e=>L.G.createChildStore(i,{table:f.iU,id:e.blockId,spaceId:n.getSpaceId()})))}async function G(e){const{environment:t,block:n,action:o}=e,s=n.getFormat().app_config_uri||"";if(s===r.NB&&(O.y.locallyMutatedTasksDatabase=!0),j.rC.includes(s)){const e=await async function(e){const{environment:t,blockStore:n}=e,o=n.getParentStore();if(!o)return[n];const r=await K({environment:t,blockStore:n}),i=o.id;return r.filter((e=>{var t;return(null===(t=e.getParentStore())||void 0===t?void 0:t.id)===i}))}({environment:t,blockStore:n});if(e.length<=1)return[n];const r=function(e,t,n){if("delete"===e)return{message:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.message",defaultMessage:"Are you sure you want to delete {dbName}?",values:{dbName:t.getTitleValue()}}),description:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.description",defaultMessage:"{appName} work closely together. You can delete them together, or you might encounter issues after deletion.",values:{appName:n}}),allLabel:(0,E.jsx)("div",{style:{maxWidth:"300",textOverflow:"ellipsis",overflowX:"hidden"},children:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.allLabel",defaultMessage:"Delete {appName}",values:{appName:n}})}),cancelLabel:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.cancelLabel",defaultMessage:"Cancel"}),oneLabel:(0,E.jsx)("div",{style:{maxWidth:"300",textOverflow:"ellipsis",overflowX:"hidden"},children:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDeleteAlert.oneLabel",defaultMessage:"Delete {dbName} only",values:{dbName:t.getTitleValue()}})}),actionIcon:d.y};if("move"===e)return{message:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.message",defaultMessage:"Are you sure you want to move {dbName}?",values:{dbName:t.getTitleValue()}}),description:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.description",defaultMessage:"{appName} work closely together. You can move them together, or you might encounter issues after separating.",values:{appName:n}}),allLabel:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.allLabel",defaultMessage:"Move together"}),cancelLabel:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.cancelLabel",defaultMessage:"Cancel"}),oneLabel:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBMoveAlert.oneLabel",defaultMessage:"Only move {dbName}",values:{dbName:t.getTitleValue()}}),actionIcon:l.n};if("duplicate"===e)return{message:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.message",defaultMessage:"Are you sure you want to duplicate {dbName}?",values:{dbName:t.getTitleValue()}}),description:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.description",defaultMessage:"{appName} work closely together. You can duplicate them together, or you might encounter issues after separating.",values:{appName:n}}),allLabel:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.allLabel",defaultMessage:"Duplicate together"}),cancelLabel:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.cancelLabel",defaultMessage:"Cancel"}),oneLabel:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.multiDBDuplicateAlert.oneLabel",defaultMessage:"Only duplicate {dbName}",values:{dbName:t.getTitleValue()}}),actionIcon:c.a};throw(0,v.t1)(e)}(o,n,function(e){if(1===e.length)return e[0].getTitleValue().toString();let t="";for(let n=0;n<e.length-1;n++)t+=e[n].getTitleValue(),e.length>2?t+=", ":t+=" ";return t+=`${Z.default.formatMessage(z.multiDBNameConnector)} ${e[e.length-1].getTitleValue()}`,t}(e)),s=await function(e,t){const{message:n,description:o,allLabel:r,cancelLabel:s,oneLabel:l,actionIcon:c}=e;return new Promise((e=>{I.showDialog({showCancel:!1,keepFocus:!1,message:(0,E.jsxs)("div",{style:{textAlign:"center"},children:[(0,E.jsxs)("span",{style:{display:"inline-block",verticalAlign:"-0.15em",position:"relative"},children:[(0,E.jsx)("img",{src:i.Z.images.appPackages.projectsIconSvg,style:{width:"1.4em",height:"1.4em"}}),c({width:"0.9em",height:"0.9em",position:"absolute",fill:a.O9.red,right:"-0.3em",bottom:"0.05em"})]}),(0,E.jsx)("div",{style:{fontWeight:b.Z.fontWeight.semibold,margin:"0.7em"},children:n}),(0,E.jsx)("div",{style:{fontSize:14},children:o})]}),items:"delete"===t?[{label:l,color:"red",onAccept:()=>{e("one")}},{label:r,onAccept:()=>{e("all")}},{label:s,onAccept:()=>{e("cancel")}}]:[{label:r,color:"blue",onAccept:()=>{e("all")}},{label:l,onAccept:()=>{e("one")}},{label:s,onAccept:()=>{e("cancel")}}],handleCancel:()=>{e("cancel")}})}))}(r,o);if("cancel"===s)return"user_canceled";const u=[n];if("all"===s)for(const t of e)if(t.id!==n.id){const e=U.C.findSelectablesFromIds([t.id]);e.length>0?u.push(e[0].props.store):u.push(t)}return u}return[n]}async function $(e){var t;let{environment:n,property:o,collectionContextStore:r,theme:i,from:a}=e;const{appTemplatesSetupActions:l,appConfigs:c}=await V.deps.AppTemplates.loader(),d=r.collectionStore(),p=r.collectionViewBlockStore(),m=null==p?void 0:p.getCollectionViewStores();if(!(d&&p&&m&&p.getFormat().app_config_uri))return!1;const v=d.getSchema()[o],y=d.getFormat().app_config_uri;if(!v||!y)return!1;const S=(0,j.YB)(c(),y);if(!S)return!1;const k=u.oA([...Object.keys(d.getPropertyMapping()||{}),...Object.keys((null===(t=p.getFormat())||void 0===t?void 0:t.app_uri_map)||{})]),C=(0,j.TD)(k,S),x=u.oA([C.find((e=>e.uri===o))]),T=(0,j.K8)({validDependencies:x,dependencies:C,collectionStore:d,collectionViewBlockStore:p,viewStores:m}),{validDependencies:M}=T;if(0===M.length)return!1;const P=null==p?void 0:p.getParentStore();if(!d||!p||!P||P.table!==g.bx&&P.table!==f.iU&&P.table!==h.e0)return!1;const A=p.getFormat().app_id,R=A?await w.getCollectionViewBlocksByAppId(n,{spaceId:p.getSpaceId(),appId:A}):void 0,D="success"===(null==R?void 0:R.type)?R.data.result.map((e=>L.G.createChildStore(P,{table:f.iU,id:e.blockId,spaceId:p.getSpaceId()}))):[p],O=[{label:(0,E.jsx)(_.FormattedMessage,{id:"appTemplatesHelpers.bundledPropertyDelete.deleteMessage",defaultMessage:"{count, plural, one {Delete} other {Delete all}}",values:{count:M.length}}),color:"red",onAccept:()=>l.removeDependencies({environment:n,dependencies:M,appCollectionViewBlockStores:D,from:a})}],Z=M.length>1&&(0,E.jsx)(B,{relatedDependencies:T,collectionContextStore:r});return I.showDialog({message:(0,E.jsxs)("div",{style:{textAlign:"center"},children:[(0,E.jsx)("span",{style:{fontWeight:b.Z.fontWeight.medium},children:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.bundledPropertyDelete.message",defaultMessage:"Delete {property} property for everyone on {databaseName}?",values:{databaseName:(0,E.jsx)(F.Z,{style:{display:"inline",fontWeight:b.Z.fontWeight.medium},shouldWrap:!0,store:d}),property:(0,E.jsxs)("span",{children:[(0,E.jsx)(s.ZP,{icon:v.icon,type:v.type,size:18,style:{verticalAlign:"middle",display:"inline-block",marginRight:3,marginBottom:2},theme:i}),v.name]})}})}),M.length>1&&(0,E.jsx)("div",{style:{margin:"0.17em"},children:(0,E.jsx)("span",{style:{fontSize:13,fontWeight:b.Z.fontWeight.light},children:(0,E.jsx)(_.FormattedMessage,{id:"appTemplateHelpers.bundledPropertyDelete.description",defaultMessage:"These related entities will also be deleted since they work together."})})})]}),description:Z,showCancel:!0,keepFocus:!0,innerStyle:{width:480},items:O}),!0}function Q(e){const{environment:t,requiredCurrPhase:n,nextPhase:o,currentUserSettingsStore:r,currentSpaceStore:i}=e,a=(0,j.jH)(r,i);n&&n!==a||T.createAndCommit({userAction:"ProjManagementIntroModal.updateProjManagementTooltipTourPhase",environment:t,perform:e=>{var t;M.d2({userSettingsStore:r,transaction:e,data:{proj_management_tooltip_tour_v1_phase_per_space:{...(null===(t=r.getSettings())||void 0===t?void 0:t.proj_management_tooltip_tour_v1_phase_per_space)??{},[i.id]:o}}})},userId:r.id})}},40663:(e,t,n)=>{n.d(t,{$Q:()=>j,$j:()=>ne,AG:()=>F,Au:()=>B,EE:()=>N,FQ:()=>G,FW:()=>C,Hw:()=>U,K8:()=>Y,KC:()=>I,Mi:()=>A,RN:()=>H,TD:()=>O,Th:()=>ee,VL:()=>y,Wo:()=>_,YB:()=>k,YC:()=>oe,Z0:()=>J,Zu:()=>R,_3:()=>P,cR:()=>V,ck:()=>M,fm:()=>E,h7:()=>Z,hZ:()=>$,iX:()=>S,jH:()=>te,kY:()=>w,oX:()=>x,rC:()=>Q,rm:()=>X,xB:()=>L});n(57658),n(21703);var o=n(92996),r=n(46283),i=n(76205),a=n(35011),s=n(10070),l=n(53877),c=n(77657),d=n(42875),u=n(72126),p=n(96367),m=n(9844),f=n(97880),g=n(26991),h=n(80444),v=n(77080),b=n(30874);const y=16803324e5;function _(e,t){return e.find((e=>e.uri===t))}function S(e,t){return e.find((e=>e.presets.some((e=>e.uri===t))))}function w(e,t){return e.flatMap((e=>e.presets)).find((e=>e.uri===t))}function k(e,t){if(!t)return;return e.find((e=>e.allFeatures.find((e=>{if(x(e))for(const n of e.dependencies)if("collection"===n.type&&n.uri===t)return!0}))))}function I(e,t){const n=S(e,t.uri);if(!n)return[];return[...t.requiredFeatures,...t.defaultOnFeatures].filter((e=>{const t=n.allFeatures.find((t=>t.uri===e.featureUri));if(!t)return!1;const{type:o}=e;return"simple"===o?"dependencies"in t:"with_variant"===o?"variants"in t:void(0,f.t1)(o)}))}function C(e){return"variants"in e}function x(e){return"dependencies"in e}const T=[r.k.Owner];function M(e,t){const n=k(e,t);if(n)for(const o of n.allFeatures)if(x(o)){const e=o.dependencies.find((e=>"collection"===e.type&&e.uri===t));if(e)return e.value.schema??{}}}function P(e){let{featurePointers:t,appConfig:n}=e;const o=u.oA(t.map((e=>{const{type:t}=e;return"simple"===t?e.featureUri:"with_variant"===t?e.defaultVariantUri:void(0,f.t1)(t)}))),r={};for(const s of n.allFeatures)r[s.uri]=s;const i=o.map((e=>r[e])),a={};for(const s of i)for(const e of s.dependencies)a[e.uri]=e;return Object.values(a)}function A(e){return e.endsWith(o.WN)}function R(e,t){return e.presets.find((e=>e.uri===`${t}${o.WN}`))}const D={[o.Es.Status]:["status","checkbox","select"]};function E(e,t,n){const o=t.type,r=e in D?D[e]:[o];return Object.entries(n).filter((e=>{let[t,n]=e;if(n)return r.includes(n.type)}))}function B(e,t){const n={};for(const[o,r]of Object.entries(e)){if(!o.startsWith("notion://"))continue;if(null==r?void 0:r.type){const e=E(o,r,t);1===e.length&&(n[o]=e[0][0])}}return n}function F(e,t,n){const r=e.allFeatures.filter((e=>(e=>{var r,a,l,c,d,u,p,m;if(!x(e)||1!==e.dependencies.length||"collection_view"!==e.dependencies[0].type)return!1;const h=e.dependencies[0],v=n.getFormat().app_config_uri,b=t.getFormat().app_config_uri,y=(null===(r=n.getFormat())||void 0===r?void 0:r.app_uri_map)??{};if(!v||!b)return!1;if(h.blockUri!==v||h.collectionUri!==b)return!1;if(h.uri in y)return!1;const _=s.aQ.deriveTypeUris((null==t?void 0:t.getSchema())??{},null==t?void 0:t.getPropertyMapping()),S=h.value;switch(S.type){case"table":case"list":case"gallery":case"timeline":if(null!==(a=S.format)&&void 0!==a&&a.collection_group_by){const e=S.format.collection_group_by.property;if(!(0,o.jP)(e)||!_.has(e))return!1}if(null!==(l=S.query2)&&void 0!==l&&l.timeline_by){const e=S.query2.timeline_by;if(!(0,o.jP)(e)||!_.has(e))return!1}break;case"board":if(null!==(c=S.format)&&void 0!==c&&c.board_columns_by){const e=S.format.board_columns_by.property;if(!(0,o.jP)(e)||!_.has(e))return!1}if(null!==(d=S.format)&&void 0!==d&&d.collection_group_by){const e=S.format.collection_group_by.property;if(!(0,o.jP)(e)||!_.has(e))return!1}break;case"calendar":if(null!==(u=S.query2)&&void 0!==u&&u.calendar_by){const e=S.query2.calendar_by;if(!(0,o.jP)(e)||!_.has(e))return!1}break;case"page":case"chart":return!1;default:(0,f.t1)(S.type)}const w=e=>!!(0,i.Oo)(e)||(0,o.jP)(e.property)&&_.has(e.property);if(null!==(p=S.format)&&void 0!==p&&p.property_filters)for(const n of S.format.property_filters){if(!z(n.filter,w))return!1;if(!(0,g.qf)(n.filter,t))return!1}if(null!==(m=S.query2)&&void 0!==m&&m.filter){const e=S.query2.filter;if(e.filters)for(const t of e.filters)if(!q(t,w))return!1}return!0})(e)));return u.mN(r,"uri")}function O(e,t){const n=u.xH(u.oA(t.allFeatures.map((e=>{if(x(e))return e.dependencies}))));return u.mN(n.filter((t=>e.includes(t.uri))),(e=>e.uri))}function Z(e){return"app_container"===e.getFormatStore().getKeyStore("collection_view_sub_type").getValue()}function V(e,t,n,i){if(t===o.GZ&&n===r.k.Owner)return!0;const a=s.aQ.deriveTypeUri(n,i.getPropertyMapping());if(!a)return!1;const l=function(e,t){if(t===o.GZ)return T;const n=M(e,t);return n?Object.keys(n):void 0}(e,t);return!!l&&l.includes(a)}function U(e,t,n){return(0,p.un)(e,t,n)}function N(e){return e===o.Kk||e===o.tD}function L(e){return e===o.g3}function j(e,t){const n=[];for(const r of t)"property"===r.type||"database_template"===r.type?e.has(r.collectionUri)&&n.push(r):"block"===r.type?e.has(r.parentUri)&&n.push(r):"blockUri"in r&&e.has(r.blockUri)&&n.push(r);let o=[];return n.length>0&&(o=j(new Set(n.map((e=>e.uri))),t)),[...n,...o]}function z(e,t){return!!t(e)}function q(e,t){if((0,i.aN)(e)){if(!z(e,t))return!1}else{if((0,i.Mm)(e))return!0;if(e.filters)for(const n of e.filters){if(!q(n,t))return!1}}return!0}function H(e,t){const n=[];if(e.filters)for(const o of e.filters){const e=W(o,t);if(!e)throw new Error("Invalid filter");n.push(e)}return{...e,filters:n}}function W(e,t){if((0,i.aN)(e))return null!=t&&t[e.property]?{...e,property:t[e.property]}:e;if((0,i.Mm)(e))return e;if((0,i.vA)(e)){if(e.filters){const n=[];for(const o of e.filters){const e=W(o,t);if(!e)throw new Error("Invalid filter");n.push(e)}return{operator:e.operator,filters:n}}}else(0,f.t1)(e)}function K(e,t,n){const o=t.getQuery(n.getSchema()),r=t.getFormat(),a=null==o?void 0:o.sort;if(a){if(a.some((t=>e.uri===t.property)))return!0}const s=t.getFormat().property_filters;if(s){const t=t=>!(0,i.Oo)(t)&&t.property===e.uri;if(s.some((e=>z(e.filter,t))))return!0}const l=null==o?void 0:o.filter;if(void 0!==l&&l.filters){const t=t=>!!(0,i.Oo)(t)||t.property!==e.uri;for(const e of l.filters){if(!q(e,t))return!0}}switch(t.getType()){case"table":case"list":case"gallery":case"timeline":if(r.collection_group_by){if(r.collection_group_by.property===e.uri)return!0}if(null!=o&&o.timeline_by){if(o.timeline_by===e.uri)return!0}break;case"board":if(r.board_columns_by){if(r.board_columns_by.property===e.uri)return!0}if(r.collection_group_by){if(r.collection_group_by.property===e.uri)return!0}break;case"calendar":if(null!=o&&o.calendar_by){if(o.calendar_by===e.uri)return!0}}return!1}function G(e,t){const n=(0,d.r)(),o=(0,l.em)(e,1,n);return(0,l.fZ)(o.valueOf(),o.plus({weeks:t}).minus({days:1}).valueOf(),n)}function $(e,t){const n=(0,l.DF)(e,(0,d.r)()).plus({days:t});return(0,l.ME)(n)}const Q=[o.NB,o.Aw,o.J1];function Y(e){var t;const{dependencies:n,collectionStore:o,collectionViewBlockStore:r,viewStores:i,validDependencies:l}=e,c=n.filter((e=>"property"===e.type)),d=[...c.filter((e=>"rollup"===e.propertySchema.type)),...c.filter((e=>"formula"===e.propertySchema.type))],u=n.filter((e=>"collection_view"===e.type)),p=s.aQ.deriveTypeUris(o.getSchema(),o.getPropertyMapping()),m=null===(t=r.getFormat())||void 0===t?void 0:t.app_uri_map,f={validDependencies:l,propertyDeps:[],viewDeps:[]};if(!p||!m)return f;for(const s of d){if(!p.has(s.uri))continue;const e=o.getSchema()[s.uri];if(e){if("rollup"===e.type){const t=l.some((t=>t.uri===e.relation_property));t&&(l.push(s),f.propertyDeps.push(e))}if("formula"===e.type){const t=(0,a.pV)(e).some((e=>{for(const t of l)if(t.uri===e)return!0}));t&&(l.push(s),f.propertyDeps.push(e))}}}for(const a of u){if(!m[a.uri])continue;const e=i.find((e=>e.id===m[a.uri]));if(!e)continue;const t=l.some((t=>"property"===t.type&&K(t,e,o)));t&&(l.push(a),f.viewDeps.push(e))}return f.validDependencies=l,f}function X(){return v.default.checkGate("typed_db_migration")}function J(){const{currentSpaceStore:e}=h.default.state;return!Boolean(e&&!e.canEdit())}function ee(){return b.Z.getIntegrationsAsRecordMap().getModel({table:m.K2,id:c.Dv})&&v.default.checkGate("cron_connected_relation")}function te(e,t){var n;if(t&&e)return null===(n=e.getSettings())||void 0===n||null===(n=n.proj_management_tooltip_tour_v1_phase_per_space)||void 0===n?void 0:n[t.id]}function ne(e,t){return{create_a_task:"assign_to_someone",assign_to_someone:"change_task_status",change_task_status:t?"select_a_project":"click_view_settings",select_a_project:"complete",click_view_settings:"complete"}[e]}function oe(e,t){const n=w(e,t);if(!n)throw new Error(`Preset not found for URI: ${t}`);const{name:o,icon:r}=n;return{name:o,icon:r}}},51592:(e,t,n)=>{n.d(t,{A7:()=>S,Mn:()=>h,Q_:()=>b,sN:()=>v,tV:()=>_,x1:()=>y});n(67294);var o=n(92996),r=n(54855),i=n(86793),a=n(59960),s=n(97880),l=n(9291),c=n(33929),d=n(98165),u=n(46654),p=n(80444),m=n(79797),f=n(85893);r.a,a.w,i.D;const g=(0,l.defineMessages)({page:{defaultMessage:"Page",id:"dbTypesHelpers.singlePage.displayName"},tasks:{defaultMessage:"Task",id:"dbTypesHelpers.singleTask.displayName"},projects:{defaultMessage:"Project",id:"dbTypesHelpers.singleProject.displayName"}});g.page,g.tasks,g.projects;function h(e){return c.default.formatMessage((0,o.J2)(e))}function v(e,t){return c.default.formatMessage((0,o.tq)(e,t))}function b(e,t){return c.default.formatMessage((0,o.Xj)(e,t))}function y(e){var t;let{typedCollections:n,spaceStore:o,environment:r}=e;const i={},a={},l={},c={},f={},g=null===(t=p.default.state.currentUserStore)||void 0===t?void 0:t.id;for(const p of n){if(g){if("none"===(0,u.Dt)({userId:g,store:p}).role){a[p.id]=p;continue}}const e=(0,d.u3)(p);if(!e)continue;const t=_({environment:r,spaceStore:o,collectionStore:p});switch(t){case"team":c[e.id]=[...c[e.id]||[],p],e instanceof m.zX&&(f[e.id]=e);break;case"private":i[p.id]=p;break;case"shared":l[p.id]=p;break;default:(0,s.t1)(t)}}return{privateDatabases:i,restrictedDatabases:a,sharedDatabases:l,teamDatabases:c,teamStores:f}}function _(e){let{environment:t,spaceStore:n,collectionStore:o}=e;const r=(0,d.u3)(o);return r&&r.canRead()?r instanceof m.zX?"team":r.isTopLevelPrivatePage({spaceStore:n,environment:t})?"private":"shared":"shared"}function S(e,t){return(0,f.jsx)(l.FormattedMessage,{...t,defaultMessage:"This property is required for {databaseType}.",id:"database.requiredPropertyExplanation",description:"Educate the users on why this property cannot be deleted.",values:{databaseType:h(e)}})}},23924:(e,t,n)=>{n.d(t,{gD:()=>d,mL:()=>l,qJ:()=>c});n(57658);var o=n(10070),r=n(21202),i=n(44499),a=n(98165),s=n(51592);function l(e){let{environment:t,typedDatabases:n,spaceStore:o,joinedTeamIds:r,blocksToFilterParents:i}=e;const l=function(e){let{environment:t,typedDatabases:n,spaceStore:o,joinedTeamIds:r}=e;const{sharedDatabases:i,privateDatabases:a,restrictedDatabases:l,teamDatabases:c}=(0,s.x1)({environment:t,typedCollections:n,spaceStore:o}),d=Object.values(l),u=Object.values(a),p=Object.values(i),m=function(e){let{teamDatabases:t,joinedTeamIds:n}=e;const o=[];for(const[s,l]of Object.entries(t))for(const e of l)o.push([s,e]);if(0===o.length)return[];const r=Object.keys(t).filter((e=>!n.includes(e))),i=[...n,...r],a=o.sort(((e,t)=>{let[n,o]=e,[r,a]=t;return i.indexOf(n)-i.indexOf(r)||String(o.getName()).localeCompare(String(a.getName()))})).map((e=>{let[t,n]=e;return n}));return a}({teamDatabases:c,joinedTeamIds:r});return[...m,...p,...u,...d]}({environment:t,spaceStore:o,typedDatabases:n.filter((e=>{const t=(0,a.VP)(e);return!t||!t.isArchived()})),joinedTeamIds:r});return c({typedDatabases:l,blocksToFilterParents:i})}function c(e){let{typedDatabases:t,blocksToFilterParents:n}=e;const o=n?new Set((0,i.qB)(n)):void 0;return t.filter((e=>{if(!e.canEdit())return!1;if(!o)return!0;const t=e.getParentPointer();return!t||t.table!==r.iU||!o.has(t.id)}))}function d(e){const t=e.getPropertyMapping(),n=e.getSchema();return o.aQ.toViewSchema(n,t)}},28344:(e,t,n)=>{n.r(t),n.d(t,{trackAIChatTranscriptHistoryItemRestored:()=>A,trackAIChatTranscriptHistoryNewChatCreated:()=>R,trackAiChatTranscriptHistoryOpenHistoryButtonSelected:()=>D,trackQnACopyClick:()=>h,trackQnAOpened:()=>a,trackQnaBackToSearch:()=>m,trackQnaCitationsSeeMoreClick:()=>g,trackQnaCitationsToggle:()=>f,trackQnaClear:()=>p,trackQnaClosed:()=>s,trackQnaFeedbackGiven:()=>d,trackQnaInferenceEnd:()=>c,trackQnaInferenceStart:()=>l,trackQnaIntroModalClose:()=>v,trackQnaIntroModalContinue:()=>w,trackQnaIntroModalImportClick:()=>S,trackQnaIntroModalOpen:()=>b,trackQnaIntroModalShowImportRecommendation:()=>y,trackQnaIntroModalSkipImportClick:()=>_,trackQnaReminderShown:()=>P,trackQnaResultClicked:()=>u,trackQnaUpsellNudgeClick:()=>x,trackQnaUpsellNudgeShown:()=>C,trackQnaWaitlistModalClose:()=>k,trackQnaWaitlistModalOpen:()=>I,trackQnaWaitlistModalRequestAccess:()=>T,trackQnaWaitlistModalSkip:()=>M,trackScopeSearchMenuClose:()=>F,trackScopeSearchMenuOpen:()=>E,trackScopeSearchToggle:()=>B});var o=n(49902),r=n(97880),i=n(97978);function a(e,t){const{configurationState:n,runtimeState:r,hasQuery:a,searchSessionId:s,from:l,isReminder:c}=t;i.j(e,"qna_open",{qna_session_id:n.sessionId,has_query:a,search_session_id:s,from:l,is_reminder:c}),o.j({name:"qna_open",args:{qna_session_id:n.sessionId,from:l,duration:Date.now()-n.startTimestamp,questions_asked_in_session:(null==r?void 0:r.evaluator.getTranscript().filter((e=>"human"===e.type)).length)??0,is_reminder:c}})}function s(e,t){const{configurationState:n,runtimeState:r,from:a}=t;i.j(e,"qna_close",{qna_session_id:n.sessionId,qna_session_length:Date.now()-n.startTimestamp,from:a}),o.j({name:"qna_close",args:{qna_session_id:n.sessionId,from:a,duration:Date.now()-n.startTimestamp,questions_asked_in_session:(null==r?void 0:r.evaluator.getTranscript().filter((e=>"human"===e.type)).length)??0}})}function l(e){const{environment:t,configurationState:n,inferenceId:o,isRetry:a,source:s,scope:l}=e;if(!n)return;let c;if("everything"===l.type);else if("workspace"===l.type);else if("teamspace"===l.type)c=l.teamId;else if("page"===l.type)c=l.pageId;else{if("collection"!==l.type)return(0,r.t1)(l);c=l.collectionId}i.j(t,"qna_inference_start",{qna_session_id:n.sessionId,qna_inference_id:o,is_retry:a,is_suggested_question:"suggested_question"===s,is_reminder_suggested_question:"reminder_suggested_question"===s,search_scope_type:l.type,search_scope_id:c})}function c(e,t){const{configurationState:n,inferenceId:o,timeTook:r,numCitationsShown:a,numSearchResults:s,topCitationIndex:l,avgCitationIndex:c}=t;n&&i.j(e,"qna_inference_end",{qna_session_id:n.sessionId,qna_inference_id:o,time_took:r,num_citations_shown:a,num_search_results:s,top_citation_index:l,avg_citation_index:c})}function d(e,t,n,o){t&&i.j(e,"qna_feedback_given",{qna_session_id:t.sessionId,qna_inference_id:n,feedback:o})}function u(e,t){const{configurationState:n,clickedPageId:o,source:r}=t;n&&i.j(e,"qna_result_clicked",{qna_session_id:n.sessionId,clicked_page_id:o,source:r})}function p(e,t,n){t&&(i.j(e,"qna_clear",{qna_session_id:t.sessionId}),o.j({name:"qna_clear",args:{qna_session_id:t.sessionId,duration:Date.now()-t.startTimestamp,questions_asked_in_session:(null==n?void 0:n.evaluator.getTranscript().filter((e=>"human"===e.type)).length)??0}}))}function m(e,t){i.j(e,"qna_back_to_search",{qna_session_id:t.sessionId})}function f(e,t){i.j(e,"qna_citations_toggle",{qna_session_id:t.sessionId,shown:t.shown})}function g(e,t){i.j(e,"qna_citations_see_more_click",{qna_session_id:t.sessionId})}function h(e,t){i.j(e,"qna_copy_click",{qna_session_id:t.sessionId})}function v(e,t){i.j(e,"qna_intro_modal_close",t)}function b(e){i.j(e,"qna_intro_modal_open")}function y(e){i.j(e,"qna_intro_modal_show_import_recommendation")}function _(e){i.j(e,"qna_intro_modal_skip_import_click")}function S(e){i.j(e,"qna_intro_modal_import_click")}function w(e){i.j(e,"qna_intro_modal_continue")}function k(e){i.j(e,"qna_waitlist_modal_close")}function I(e){i.j(e,"qna_waitlist_modal_open")}function C(e){i.j(e,"qna_add_on_upsell_nudge_displayed")}function x(e){i.j(e,"qna_add_on_upsell_nudge_clicked")}function T(e,t){i.j(e,"qna_waitlist_modal_request_access",{is_space_admin:t.isSpaceAdmin,is_sales_assisted:t.isSalesAssisted})}function M(e){i.j(e,"qna_waitlist_modal_skip")}function P(e,t){i.j(e,"qna_reminder_shown",{number:t.number})}function A(e,t){i.j(e,"ai_chat_transcript_history.restored",t)}function R(e){i.j(e,"ai_chat_transcript_history.new_chat_created")}function D(e,t){i.j(e,"ai_chat_transcript_history.open_history_button_selected",t)}function E(e,t){i.j(e,"ai_scoped_search_menu_open",t)}function B(e,t){const{from:n,scope:o}=t;let a;if("everything"===o.type);else if("workspace"===o.type);else if("teamspace"===o.type)a=o.teamId;else if("page"===o.type)a=o.pageId;else{if("collection"!==o.type)return(0,r.t1)(o);a=o.collectionId}i.j(e,"ai_scoped_search_toggle",{from:n,search_scope_type:o.type,search_scope_id:a})}function F(e,t){i.j(e,"ai_scoped_search_menu_close",t)}},81598:(e,t,n)=>{n.d(t,{F$:()=>u,GL:()=>a,L6:()=>r,PS:()=>s,Q:()=>l,Sv:()=>i,ZN:()=>p,eC:()=>c,yX:()=>d});var o=n(77907);const r=o.deps.assistant,i=(0,o.lazyComponent)(r,(e=>e.AssistantWriterPopupRenderer)),a=(0,o.lazyComponent)(r,(e=>e.AssistantWriterInProgressContent)),s=(0,o.lazyComponent)(r,(e=>e.AssistantFullPageChat)),l=(0,o.lazyComponent)(r,(e=>e.AssistantOriginElement)),c=(0,o.lazyComponent)(r,(e=>e.AssistantMenuPopup)),d=(0,o.lazyComponent)(r,(e=>e.SearchAssistantPane)),u=(0,o.lazyComponent)(r,(e=>e.AssistantUpsellElement)),p=(0,o.lazyComponent)(r,(e=>e.AssistantRichTextInput))},56206:(e,t,n)=>{n.d(t,{d:()=>a});var o=n(49085),r=n(92595);class i extends o.default{getInitialState(){return{open:!1,currentView:"chat"}}}const a=new i;(0,r.exposeDebugValue)("AssistantMenuStore",a)},47043:(e,t,n)=>{n.d(t,{zY:()=>fe,Hj:()=>me,HF:()=>ge,AN:()=>he,oS:()=>_e,Nj:()=>Se,sl:()=>be,kM:()=>ve});n(21703),n(57658),n(67294);var o=n(1302),r=n(15145),i=n(63362),a=n(28751),s=n(81730);async function l(e){const{action:t,values:n,context:o}=e,r=(0,a.z)(t.getType());return await r.execute({...o,values:n},t)}var c=n(97880);var d=n(94412),u=n(10450),p=n(41432),m=n(76837),f=n(73110),g=n(35102),h=n(76218),v=n(68626),b=n(42875),y=n(72126),_=n(4615),S=n(149),w=n(98963),k=n(18844),I=n(21202),C=n(23867),x=n(70203),T=n(9291),M=n(36610),P=n(952),A=n(98834),R=n(54532),D=n(94419),E=n(13084),B=n(19785),F=n(68305),O=n(9953),Z=n(52423),V=n(8055),U=n(24677),N=n(64964),L=n(98104),j=n(82530),z=n(6854),q=n(95477),H=n(97978),W=n(49117),K=n(84210),G=n(33929),$=n(73959),Q=n(77907),Y=n(95802),X=n(80444),J=n(58454),ee=n(77080),te=n(88923),ne=n(79797),oe=n(35057),re=n(92996);const ie=(0,T.defineMessages)({genericSuccessMessage:{id:"automations.buttonTrigger.genericSuccessMessage",defaultMessage:"Button automation ran successfully"},createdBlocks:{defaultMessage:"Created {numBlocksDuplicated, plural, one {1 block} other {{numBlocksDuplicated} blocks}} on page",id:"automations.buttonTrigger.createdBlocks"},createdSprintsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprints"},updatedSprintsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprints"},createdSprintsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.createdSprintsLowercase"},updatedSprintsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 sprint} other {{numPagesModified} sprints}}",id:"automations.buttonTrigger.updatedSprintsLowercase"},createdTasksUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasks"},updatedTasksUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasks"},createdTasksLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.createdTasksLowercase"},updatedTasksLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 task} other {{numPagesModified} tasks}}",id:"automations.buttonTrigger.updatedTasksLowercase"},createdProjectsUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjects"},updatedProjectsUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjects"},createdProjectsLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.createdProjectsLowercase"},updatedProjectsLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 project} other {{numPagesModified} projects}}",id:"automations.buttonTrigger.updatedProjectsLowercase"},createdPagesUppercase:{defaultMessage:"Created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPages"},updatedPagesUppercase:{defaultMessage:"Edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPages"},createdPagesLowercase:{defaultMessage:"created {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.createdPagesLowercase"},updatedPagesLowercase:{defaultMessage:"edited {numPagesModified, plural, one {1 page} other {{numPagesModified} pages}}",id:"automations.buttonTrigger.updatedPagesLowercase"}}),ae=["sprint","task","project","page"],se={[re.wW]:"project",[re.iS]:"task",[re.zU]:"page",[re.Fi]:"page",[re.p$]:"sprint",[re.GZ]:"page",[re.nG]:"page",[re.Be]:"page"};function le(e){const{typedAutomationExecutionSummary:t,numBlocksDuplicated:n,intl:o}=e,r=function(e){const{typedAutomationExecutionSummary:t,intl:n}=e,o=[];for(const i of ae){const e=t[i];if(e){const{numPagesCreated:t,numPagesEdited:n}=e;t>0&&o.push({pageType:i,modificationType:"created",numPagesModified:t}),n>0&&o.push({pageType:i,modificationType:"updated",numPagesModified:n})}}const r=o.slice(0,ce).map(((e,t)=>{let{pageType:o,modificationType:r,numPagesModified:i}=e;const a=de[o][r],s=0===t?a.start:a.append;return n.formatMessage(s,{numPagesModified:i})}));if(r.length>0)return n.formatList(r,{type:"conjunction",style:"long"})}({typedAutomationExecutionSummary:t,intl:o});return r||(n>0?o.formatMessage(ie.createdBlocks,{numBlocksDuplicated:n}):o.formatMessage(ie.genericSuccessMessage))}const ce=3;const de={sprint:{created:{start:ie.createdSprintsUppercase,append:ie.createdSprintsLowercase},updated:{start:ie.updatedSprintsUppercase,append:ie.updatedSprintsLowercase}},task:{created:{start:ie.createdTasksUppercase,append:ie.createdTasksLowercase},updated:{start:ie.updatedTasksUppercase,append:ie.updatedTasksLowercase}},project:{created:{start:ie.createdProjectsUppercase,append:ie.createdProjectsLowercase},updated:{start:ie.updatedProjectsUppercase,append:ie.updatedProjectsLowercase}},page:{created:{start:ie.createdPagesUppercase,append:ie.createdPagesLowercase},updated:{start:ie.updatedPagesUppercase,append:ie.updatedPagesLowercase}}};var ue=n(85893);const pe=(0,T.defineMessages)({genericErrorMessage:{id:"automations.buttonTrigger.genericErrorMessage",defaultMessage:"Button failed to execute"},open:{defaultMessage:"Open",id:"automations.buttonTrigger.open"},undo:{defaultMessage:"Undo",id:"automations.buttonTrigger.undo"},defaultConfirmationWorkflowText:{defaultMessage:"Are you sure you want to continue?",id:"automations.buttonTrigger.defaultConfirmationWorkflowText"},defaultContinueWorkflowMessage:{defaultMessage:"Continue",id:"automations.buttonTrigger.defaultContinueWorkflowMessage"},defaultStopWorkflowMessage:{defaultMessage:"Cancel",id:"automations.buttonTrigger.defaultStopWorkflowMessage"},errorQueryCollectionTooManyPages:{defaultMessage:"Button impacts too many pages",id:"automations.buttonTrigger.errorQueryCollectionTooManyPages"},errorUserCancelled:{defaultMessage:"Button was cancelled",id:"automations.buttonTrigger.errorUserCancelled"}});function me(e){const{environment:t,collectionStore:n,property:o,transaction:r}=e,i=(0,_.ZP)(),a=n.getSchema()[o];a&&"button"===a.type&&(O.ae({environment:t,table:w.cv,inMemoryRecordCache:n.inMemoryRecordCache,value:{id:i,parent_id:n.id,parent_table:n.table,alive:!0,space_id:n.getSpaceId(),status:"active",trigger:{id:(0,_.ZP)(),type:"button"}},transaction:r}),O.sW({store:n.getSchemaStore(),data:{[o]:{...a,automation_id:i}},transaction:r}))}function fe(e){const{actionId:t,environment:n,intl:o,automationStore:r,actionType:i,transaction:a,insertionPoint:s,config:l,createDuplicateBlocksContainer:d=!0}=e,u=r.getSpaceId();if(!u)return;let p;"duplicate_blocks"===i&&d&&(p=O.j4({environment:n,inMemoryRecordCache:r.inMemoryRecordCache,transaction:a,type:"text",useCrdt:!1}));const m=l??function(e){const{actionType:t,intl:n}=e;if("modal_confirmation"===t)return{continue_button:{text:n.formatMessage(pe.defaultContinueWorkflowMessage)},cancel_button:{text:n.formatMessage(pe.defaultStopWorkflowMessage)},text:{type:"simple",value:(0,x.TPx)(n.formatMessage(pe.defaultConfirmationWorkflowText))}};if("assistant"===t)return{type:"prompt"}}({actionType:i,intl:o})??{},f=O.ae({environment:n,inMemoryRecordCache:r.inMemoryRecordCache,table:k.Xj,transaction:a,value:{id:t,type:i,parent_id:r.id,parent_table:w.cv,alive:!0,space_id:u,config:m,blocks:p?[p.id]:[]}});return p&&D.R3({transaction:a,parent:f.getKeyStore("blocks"),append:p}),!s||"afterActionId"in s?D.R3({transaction:a,parent:r.getActionIdsStore(),append:f,after:null==s?void 0:s.afterActionId}):"beforeActionId"in s?D.Ce({transaction:a,parent:r.getActionIdsStore(),prepend:f,before:s.beforeActionId}):(0,c.t1)(s),f}function ge(e){const{actorPointer:t,environment:n,includeParenting:o,sourceAutomationStore:r,targetAutomationId:i,transaction:a}=e,s=r.getParentStore();if(!s||!s.isReady())throw new Error("Automation parent store not ready");const l=r.getValue(),d=r.getSpaceId();if(!(0,c.$K)(l)||!(0,c.$K)(d))throw new Error("Undefined automation value or space id");const u={},p={...(0,y.Xh)(l),id:i??(0,_.ZP)()};u[r.id]=p.id,(0,c.$K)(p.action_ids)&&(0,c.Of)(p.action_ids)&&p.action_ids.forEach((e=>u[e]=(0,_.ZP)()));const f=e=>{let{requested:t}=e;const n=u[t.id];return(0,c.$K)(n)?{...t,id:n}:t};(0,m.J_)({actor:t,duplicateRecord:p,options:{},mapper:f,originalRecord:l});const g=O.ae({environment:n,inMemoryRecordCache:r.inMemoryRecordCache,table:w.cv,transaction:a,value:p});o&&B.jG({childStore:g,parentStore:s,transaction:a});const h=r.getActionStores().map((e=>{const t=u[e.id],{automationActionStore:o,onComplete:r}=he({environment:n,includeParenting:!1,mapper:f,sourceActionStore:e,targetAutomationActionId:t,transaction:a});return B.jG({childStore:o,parentStore:g,transaction:a}),r})),v=Promise.all(h).then((e=>e.flat()));return{automationStore:g,onComplete:v}}function he(e){const{environment:t,includeParenting:n,insertionPoint:o,mapper:r,sourceActionStore:i,targetAutomationActionId:a,transaction:s}=e,l=i.getParentStore();if(!l||!l.isReady())throw new Error("Automation store is not ready");const d=i.getValue(),u=i.getSpaceId();if(!(0,c.$K)(d)||!(0,c.$K)(u))throw new Error("Undefined action value or space id");const p={...(0,y.Xh)(d),id:a??(0,_.ZP)()},f=t.currentUser.id,g=i.inMemoryRecordCache.makeGetRecordRoleFn(f);(0,m.XJ)({duplicateRecord:p,getRecordRole:g,originalRecord:d,mapper:e=>(null==r?void 0:r(e))??e.requested,options:{},originOptions:{baseUrl:q.default.domainBaseUrl,publicDomainName:q.default.publicDomainName}});const h=O.ae({environment:t,inMemoryRecordCache:i.inMemoryRecordCache,table:k.Xj,transaction:s,value:p});n&&(!o||"afterActionId"in o?B.jG({after:null==o?void 0:o.afterActionId,childStore:h,parentStore:l,transaction:s}):"beforeActionId"in o?B.SH({before:null==o?void 0:o.beforeActionId,childStore:h,parentStore:l,transaction:s}):(0,c.t1)(o));const v=i.getBlockStores().map((e=>{const[n,o]=R.Qi({addCopyName:!1,baseUrl:q.default.domainBaseUrl,deepCopyTransclusionContainers:!1,environment:t,preferDuplicateLocation:"local",publicDomainName:q.default.publicDomainName,resolveTemplateVariables:!1,stores:[e],targetSpaceId:(0,C.C)(e.pointer.spaceId),transaction:s,useCrdt:!1}),r=n[0];return B.jG({childStore:r,parentStore:h,transaction:s}),o})),b=Promise.all(v);return{automationActionStore:h,onComplete:b}}function ve(e){const{clientContext:t,transaction:n,newActionIds:o}=e,{automationStore:r}=t,i=r.getValue();if(!i)return;O.sW({store:r,transaction:n,data:{action_ids:o}});ye({clientContext:t,transaction:n,automationValue:{...i,action_ids:o}})}function be(e){var t;const{clientContext:n,actionStore:o,transaction:r}=e,i=n.automationStore.getValue();if(!i)return;B.hr({parentStore:n.automationStore,childStore:o,transaction:r});ye({clientContext:n,transaction:r,automationValue:{...i,action_ids:null===(t=i.action_ids)||void 0===t?void 0:t.filter((e=>e!==o.id))}})}function ye(e){const{clientContext:t,automationValue:n,transaction:o}=e,r=t.automationStore.getSpaceId();if(!r)return;const i=(0,W.pt)({context:t,automationValue:n});if(!S.x.isFail(i))for(const s of n.action_ids??[]){const e=t.automationStore.getRecordStore(t.automationStore,{table:k.Xj,id:s,spaceId:r});if(!e.isDefined())continue;const n=e.getModel(),l=new Set(i.value.actionInputValueTypes[s].map((e=>{if(e.kind===f.yp.Binding||e.kind===f.yp.ContextValue)return e.id;e.kind!==f.yp.ThisRow&&(0,c.t1)(e)})).filter(c.$K)),d=(0,a.z)(n.getType()).acceptFormulaVisitor({action:n,visitor:{visitVariableOutsideOfFormula:e=>l.has(e)?{type:"keep"}:{type:"replace",value:void 0},visitFormula:e=>e.value&&(0,h.UB)(e).some((e=>!l.has(e)))?{type:"replace",value:void 0}:{type:"keep"}}});for(const t of d)j.applyOperation({store:e,operation:t,transaction:o})}}async function _e(e){const{clientContext:t,environment:n,onUndo:o,store:r}=e;let a,s;const p=await Q.deps.formulas.loader();if(t.persisted){await t.automationStore.load();const e=t.automationStore.getModel();if(!e)return;a=e,s=t.automationStore.getActionStores().map((e=>e.getModel())).filter(c.$K)}else a=new d.X({triggerType:"button",actions:t.actions,parentPointer:t.parentPointer,spaceId:t.parentPointer.spaceId}),s=t.actions.map((e=>new d.e(e,t.parentPointer.spaceId)));const m=a.getTriggerType();if("event"===m)return;const f=(0,H.mc)(n),h=(0,oe.zt)();(0,i.rg)(f,{actions:s.map((e=>e.getType())),automation_id:a.id,block_id:r.id,context_type:t.type,space_id:a.getSpaceId(),subscription_tier:h,trigger:m});const y=new we({automationModel:a,clientContext:t,environment:n}),_=(0,g.yf)(t.parentRecordStore.getRecordModel,t.parentRecordStore.loadRecordModel),S=n.currentUser.id;let w;"button_property"===t.type?w=(0,u.dG)({blockPointer:r.getSpaceShardedPointer(),currentUserId:S,userTimeZone:(0,b.r)()}):"button_block"===t.type?w=(0,u.io)({currentUserId:S,userTimeZone:(0,b.r)(),pagePointer:t.pageStore.pointer}):"structured_automation"===t.type?w=(0,u.rj)():"event"===t.type?w=(0,u.R4)({blockPointer:r.getSpaceShardedPointer(),currentUserId:S,userTimeZone:(0,b.r)()}):"recurrence"===t.type?"completeSprint"===t.recurrence.type?w=(0,u.NG)({completeSprintActionType:t.recurrence.completeSprintActionType,nextSprintDateRange:t.recurrence.nextSprintDateRange}):"default"===t.recurrence.type?w=(0,u.W7)():(0,c.t1)(t.recurrence):"assistant"===t.type?w={values:[]}:(0,c.t1)(t);const k={automationModel:a,actionModels:s,values:w.values,executeEffectMap:y,executeContextualFormula:async(e,n)=>{if(!n)return{value:{type:"undefined"}};return await p.executeFormulaAsync(n,{values:e.values,handleDataRequest:_,userTimeZone:(0,b.r)(),intl:t.intl,depth:0,visitedProperties:new Set,resultCache:new Map})},handleDataRequest:_,loadRecordModel:t.parentRecordStore.loadRecordModel,userTimeZone:(0,b.r)(),intl:t.intl,depth:0,visitedProperties:new Set,resultCache:new Map,eventTracker:(0,H.mc)(n)},C=performance.now(),x=await async function(e){const{context:t,executeAutomationActionFn:n}=e,{actionModels:o}=t;let r=t.values;const i=n??l;for(const a of o){const e=await i({action:a,values:r,context:t});if(e.error)return e.error;r=r.concat(e.value.values)}}({context:k}),T=Math.trunc(performance.now()-C);if(x){0;const e=function(e){const{executionDuration:t,saveTransactionInfos:n}=e,[o,r]=n.reduce(((e,t)=>{let[n,o]=e;return"create_page"===t.type?[n+1,o]:"update_pages"===t.type?[n,o+t.pageIds.length]:void(0,c.t1)(t)}),[0,0]);return{executionDuration:t,createdPageCount:o,updatedPageCount:r,createdOrUpdatedPageCount:o+r}}({executionDuration:T,saveTransactionInfos:k.executeEffectMap.saveTransactionInfos}),o={...e,automationContextType:t.type,automationId:a.id,spaceId:a.getSpaceId()};v.log({actor:n.currentUser.id?{id:n.currentUser.id,table:"notion_user"}:void 0,data:o,error:x,from:"automationActions",level:"error",type:"AutomationExecutionError"}),(0,i.By)(f,{automation_id:a.id,block_id:r.id,context_type:t.type,error_type:x.type,execution_duration_ms:T,subscription_tier:h,trigger:m});const s=function(e){if("user_cancelled"===e.type)return pe.errorUserCancelled;if("query_collection_too_many_items"===e.type)return pe.errorQueryCollectionTooManyPages;return pe.genericErrorMessage}(x),l=G.default.formatMessage(s);N.oV({label:l})}else(0,i.Cz)(f,{automation_id:a.id,block_id:r.id,context_type:t.type,execution_duration_ms:T,subscription_tier:h,trigger:m}),await async function(e){const{environment:t,saveTransactionInfos:n,clientContext:o,undoCheckpointName:r,numBlocksDuplicated:i,onUndo:a}=e,s=function(e){const{saveTransactionInfos:t,parentRecordStore:n}=e,o={};for(const l of t)if("create_page"===l.type){var r,i;const e=ne.NW.createChildStore(n,l.collection).getDatabaseType(),t=(e&&se[e])??"page",a=(null===(r=o[t])||void 0===r?void 0:r.numPagesEdited)??0,s=(null===(i=o[t])||void 0===i?void 0:i.numPagesCreated)??0;o[t]={numPagesCreated:s+1,numPagesEdited:a}}else if("update_pages"===l.type){var a,s;const e=ne.NW.createChildStore(n,l.collection).getDatabaseType(),t=(e&&se[e])??"page",r=(null===(a=o[t])||void 0===a?void 0:a.numPagesEdited)??0,i=(null===(s=o[t])||void 0===s?void 0:s.numPagesCreated)??0;o[t]={numPagesCreated:i,numPagesEdited:r+l.pageIds.length}}else(0,c.t1)(l);return o}({saveTransactionInfos:n,parentRecordStore:o.parentRecordStore});let l;for(const g of n.slice().reverse()){if("create_page"===g.type){var d;l=ne.G.createChildStore(o.parentRecordStore,{table:I.iU,id:g.pageId,spaceId:null===(d=g.collection)||void 0===d?void 0:d.spaceId});break}if("update_pages"===g.type){if(1===g.pageIds.length){var u;l=ne.G.createChildStore(o.parentRecordStore,{table:I.iU,id:g.pageIds[0],spaceId:null===(u=g.collection)||void 0===u?void 0:u.spaceId})}else{const e=ne.NW.createChildStore(o.parentRecordStore,g.collection);await e.load();const t=e.getParentBlockStore();if(!t)continue;l=t}break}(0,c.t1)(g)}const p=le({typedAutomationExecutionSummary:s,numBlocksDuplicated:i,intl:o.intl}),m=()=>{Z.qB({environment:t,namedRevisionId:r}),N.rN(),a&&a(r)},f=Z.hv(r);N.oV({label:p,right:(0,ue.jsx)(z.wr,{blockStoreToOpen:l,...f?{performUndo:m}:{}})})}({environment:n,saveTransactionInfos:y.saveTransactionInfos,clientContext:t,undoCheckpointName:y.undoCheckpointName,numBlocksDuplicated:y.getNumBlocksDuplicated(),onUndo:o})}function Se(e){var t;const{environment:n,parentStore:o,transaction:r}=e,i=O.j4({environment:n,type:"text",inMemoryRecordCache:o.inMemoryRecordCache,transaction:r,spaceId:o.pointer.spaceId,useCrdt:(null===(t=(0,$.sQ)(o))||void 0===t?void 0:t.useCrdt())??!1}),a=D.R3({parent:o,append:i,transaction:r}).child;U.eP({environment:n,store:a});const s=a.getBlockTitleStore();L.N_({store:s})}class we{constructor(e){this.environment=void 0,this.clientContext=void 0,this.automationModel=void 0,this.numBlocksDuplicated=0,this.saveTransactionInfos=[],this.undoCheckpointName=void 0,this.getCollectionSchema=async e=>{const t=await this.clientContext.parentRecordStore.loadRecordModel(e.pointer);return t?{value:{collectionSchema:t.getNormalizedSchema()}}:{error:new s.Do({actionId:e.actionId,pointer:e.pointer})}},this.queryCollection=async e=>{const t=await F.tA(this.environment,{source:"automation",parentRecordStore:this.clientContext.parentRecordStore,collectionPointer:e.collection,filter:e.filter,sort:e.sort,limit:e.limit});return S.x.isFail(t)?{error:new s.Pn({actionId:e.actionId,type:t.error.type,message:t.error.message,cause:t.error})}:{value:{blockIds:t.value.blockIds}}},this.saveTransaction=e=>{const t=ee.default.getConfigKey("automation_update_pages","max_operations_per_transaction"),n=ee.default.checkGate("update_pages_action_batching")&&void 0!==t&&"structured_automation"===this.clientContext.type&&this.clientContext.shouldBatch?y.yo(e.operations,t):[e.operations];for(const o of n)this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.saveTransaction",environment:this.environment,perform:e=>{for(const t of o){const n=(0,ne.Kv)(this.clientContext.parentRecordStore,t.pointer);j.applyOperation({store:n,operation:t,transaction:e})}}});if(this.saveTransactionInfos.push(e.info),"create_page"===e.info.type)P.W(this.environment,{type:"page",automation_id:this.automationModel.id,from:"button_automation",new_page_id:e.info.pageId,creating_block_id:e.info.pageId});else if("update_pages"===e.info.type){const{editedProperties:t,pageIds:n}=e.info;for(const e of n)for(const{id:n,type:o}of t)M.rv(this.environment,{block_id:e,property:n,property_type:o,from:"button_automation",automation_id:this.automationModel.id},!1)}else(0,c.t1)(e.info);return{value:{}}},this.navigateToPage=e=>{const t=X.default.state.mainEditorCurrentBlockStore;if(!t)return;const n=ne.G.createChildStore(t,e.page),o="full_page"===e.openIn?(0,K.ZP)({store:n,fullyQualified:!1,pageVisitSource:r.tY.ButtonAutomation}):(0,K.ZP)({store:t,peekViewBlockId:n.id,peekMode:(0,te.getUrlParamFromPeekMode)(e.openIn),fullyQualified:!1,pageVisitSource:r.tY.ButtonAutomation});V.c4({environment:this.environment,url:o})},this.duplicateBlockChildren=async e=>{if("button_block"!==this.clientContext.type)return{error:new s.iR({contextType:this.clientContext.type})};const t=this.clientContext.blockStore,n=t.getRecordStoreUIParent();if(!n)return{value:{}};let r;"before"===e.insertionPoint?r=!0:"after"===e.insertionPoint?r=!1:(0,c.t1)(e.insertionPoint);const i=ne.G.createChildStore(n,e.blockPointer);await i.load();const a=i.getContentStores();r||a.reverse();const l=Y.C.findSelectableFromStore(t),d=[],u=this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.duplicateBlockChildren",environment:this.environment,perform:e=>a.map((n=>{const[o,i]=R.Qi({environment:this.environment,stores:[n],transaction:e,addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:!0,targetSpaceId:(0,C.C)(n.pointer.spaceId),baseUrl:q.default.domainBaseUrl,publicDomainName:q.default.publicDomainName,preferDuplicateLocation:"local",analyticsFrom:"button_automation",useCrdt:t.useCrdt()}),a=o[0];return l&&(r?l.props.onInsertAbove&&d.push(l.props.onInsertAbove({insertStores:[a],transaction:e})[0]):l.props.onInsertBelow&&d.push(l.props.onInsertBelow({insertStores:[a],transaction:e})[0])),{copy:a,onComplete:i}}))}).performResult;return r||d.reverse(),U.Z5({environment:this.environment,stores:d}),await Promise.all(u.map((e=>e.onComplete))),o.default.afterNextFlush((()=>{for(const e of d){if(E.dM({environment:this.environment,isAtStartOfLine:!1,store:e}))break}})),this.numBlocksDuplicated+=d.length,{value:{}}},this.displayModal=async e=>{J.Z.setState({open:!0,format:e.format,recordStore:this.clientContext.parentRecordStore}),await J.Z.waitUntil((()=>!J.Z.state.open));const t=J.Z.state;let n;return t.open||(n=t.result),n=n??"continue",n},this.initializeTemplateInDatabase=async e=>{const t=(0,_.ZP)(),n=this.clientContext.parentRecordStore,o=ne.G.createChildStore(n,{table:I.iU,id:e.templateId});await o.load();const r=ne.NW.createChildStore(n,e.collection);return this.createAndCommitForEffect({userAction:"ClientExecuteEffectMap.initializeTemplateInDatabase",environment:this.environment,perform:i=>{const a=O.j4({environment:this.environment,transaction:i,inMemoryRecordCache:n.inMemoryRecordCache,type:p.Ti.page,id:t,useCrdt:!1});B.zw({parentStore:r,childStore:a,transaction:i}),A.ob({environment:this.environment,store:a,transaction:i,templateStore:o,title:"template",isCreateIn:!1,isKeyboard:!1,from:"automation_actions"}),O.sW({transaction:i,store:a.getPropertiesStore(),data:e.propertyUpdates})}}),this.saveTransactionInfos.push({type:"create_page",pageId:t,collection:e.collection}),{value:{pageId:t}}},this.environment=e.environment,this.clientContext=e.clientContext,this.automationModel=e.automationModel,this.undoCheckpointName=`execute-client-automation-${(0,_.ZP)()}`}getNumBlocksDuplicated(){return this.numBlocksDuplicated}createAndCommitForEffect(e){return j.createAndCommit({...e,undoCheckpoint:this.undoCheckpointName})}}},41301:(e,t,n)=>{n.d(t,{Fp:()=>d,Mm:()=>c,So:()=>p,TU:()=>u});n(67294);var o=n(86628),r=n(24405),i=n(72126),a=n(97880),s=n(9291),l=n(85893);const c=(0,s.defineMessages)({missingTargetDatabase:{id:"clientAutomationHelpers.errorMessages.missingTargetDatabase",defaultMessage:"Missing a target database"},missingTargetPage:{id:"clientAutomationHelpers.errorMessages.missingTargetPage",defaultMessage:"Missing a target page"},invalidTemplatePage:{id:"clientAutomationHelpers.errorMessages.invalidTemplatePage",defaultMessage:"Invalid template."},noActions:{id:"clientAutomationHelpers.errorMessages.noActions",defaultMessage:"This button has no actions"},createPageButtonError:{id:"clientAutomationHelpers.errorMessages.createPageButtonError",defaultMessage:"Add page is missing a target database"},createPageButtonTemplateError:{id:"clientAutomationHelpers.errorMessages.createPageWithTemplateError",defaultMessage:"Add page has an invalid template"},openPageButtonError:{id:"clientAutomationHelpers.errorMessages.openPageButtonError",defaultMessage:"Open page is missing a target page"},updatePagesButtonError:{id:"clientAutomationHelpers.errorMessages.editPagesButtonError",defaultMessage:"Edit pages is missing a target database"},slackNotificationAuthenticationError:{id:"clientAutomationHelpers.errorMessages.slackNotificationError",defaultMessage:"Slack notification is missing an authentication."},slackNotificationTargetError:{id:"clientAutomationHelpers.errorMessages.slackNotificationTargetError",defaultMessage:"Slack notification is missing a target channel."}});function d(e){if("create_page"===e.actionType)if("missing_required_config"===e.type){if("collection"===e.key)return{forAction:c.missingTargetDatabase,forButtonTooltip:c.createPageButtonError};(0,a.t1)(e)}else{if("invalid_optional_config"===e.type)return{forAction:c.invalidTemplatePage,forButtonTooltip:c.createPageButtonTemplateError};(0,a.t1)(e)}else if("update_pages"===e.actionType)if("missing_required_config"===e.type){if("target"===e.key)return{forAction:c.missingTargetDatabase,forButtonTooltip:c.updatePagesButtonError};(0,a.t1)(e)}else(0,a.t1)(e);else if("open_page"===e.actionType)if("missing_required_config"===e.type){if("target"===e.key)return{forAction:c.missingTargetPage,forButtonTooltip:c.openPageButtonError};(0,a.t1)(e)}else(0,a.t1)(e);else if("slack_notification"===e.actionType)if("missing_required_config"===e.type){if("external_bot_id"===e.key)return{forAction:c.slackNotificationAuthenticationError,forButtonTooltip:c.slackNotificationAuthenticationError};if("target"===e.key)return{forAction:c.slackNotificationTargetError,forButtonTooltip:c.slackNotificationTargetError};(0,a.t1)(e)}else if("missing_required_value"===e.type){if("external_bot_id"===e.key)return{forAction:c.slackNotificationAuthenticationError,forButtonTooltip:c.slackNotificationAuthenticationError};(0,a.t1)(e)}else(0,a.t1)(e);else(0,a.t1)(e)}function u(e){const{contextStore:t,actionId:n,shouldShow:r,errorKey:a}=e;return(0,o.VK)((()=>{if(!r||!t)return;let e=t.getValidationErrorsForAction(n);a&&(e=e.filter((e=>e.key===a)));const o=(0,i.Ps)(e);if(!o)return;const c=d(o);return(0,l.jsx)(p,{content:(0,l.jsx)(s.FormattedMessage,{...c.forAction})})}),[r,t,n,a])}function p(e){window.__c={n:"TooltipWithSubtitle"};const{content:t,subtitle:n}=e,o=(0,r.yK)((e=>({wrap:{display:"flex",flexDirection:"column",alignItems:"center"},subtitle:{color:e.mediumInvertedTextColor}})),[]);return(0,l.jsxs)("div",{style:o.wrap,children:[(0,l.jsx)("div",{children:t}),n&&(0,l.jsx)("div",{style:o.subtitle,children:n})]})}},93174:(e,t,n)=>{n.d(t,{C:()=>o.LazyAutomationButtonActionList,O:()=>o.LazyPlacedButtonBlockEditor});var o=n(77907)},87686:(e,t,n)=>{n.d(t,{f:()=>i});n(67294);var o=n(24405),r=n(85893);function i(){window.__c={n:"BreadcrumbDivider"};const e=(0,o.yK)((e=>({span:{marginLeft:2,marginRight:2,color:e.lightTextColor}})),[]);return(0,r.jsx)("span",{style:e.span,children:"/"})}},25238:(e,t,n)=>{n.d(t,{Z:()=>p});n(67294);var o=n(480),r=n(86628),i=n(24405),a=n(82990),s=n(31278),l=n(76798),c=n(79797),d=n(74016),u=n(85893);function p(e){window.__c={n:"BreadcrumbIconTitle"};const{store:t,ignoreMaxLength:n,maxWidth:p,iconSize:m,emojiSize:f,titleStyle:g,iconStyle:h,highlighter:v}=e,{device:b}=(0,o.O7)(),y=m??(b.isMobile?24:20),_=f??y,{hasIcon:S,pageIcon:w,isEmptyPage:k}=(0,r.VK)((()=>({hasIcon:t.hasIcon(),pageIcon:t.getIcon(),isEmptyPage:t instanceof c.G&&t.isEmptyPage()})),[t]),I=(0,i.yK)((()=>({containerStyle:{display:"flex",alignItems:"center",minWidth:0},teamRecordTitle:{maxWidth:p,...g},pageRecordTitle:{maxWidth:n?"none":p,...g},recordIconStyle:{marginRight:6,fontWeight:a.Z.fontWeight.medium,...h}})),[n,p,g,h]);return t instanceof c.zX?(0,u.jsxs)("div",{style:I.containerStyle,children:[(0,u.jsx)(d.p,{disabled:!0,store:t,size:y,style:I.recordIconStyle}),(0,u.jsx)(l.Z,{store:t,style:I.teamRecordTitle,highlighter:v,enableHover:!0})]}):(0,u.jsxs)("div",{style:I.containerStyle,children:[S&&(0,u.jsx)(s.Z,{disabled:!0,icon:w,isEmptyPage:k,size:y,emojiSize:_,style:I.recordIconStyle,largeIcon:!0}),(0,u.jsx)(l.Z,{store:t,style:I.pageRecordTitle,highlighter:v,enableHover:!0})]},`breadcrumb-recordtitle-${t.id}`)}},7692:(e,t,n)=>{n.d(t,{Z:()=>v});var o=n(67294),r=n(480),i=n(86628),a=n(24405),s=n(15145),l=n(13084),c=n(82530),d=n(31945),u=n(89728),p=n(79954),m=n(84210),f=n(87686),g=n(25238),h=n(85893);function v(e){window.__c={n:"BreadcrumbPageButton"};const t=(0,r.O7)(),{device:n}=t,{store:v,showDivider:b,maxWidth:y,popupRenderer:_,iconSize:S,emojiSize:w,titleStyle:k,iconStyle:I,highlighter:C,onClick:x}=e,T=(0,a.yK)((()=>({selectable:{display:"flex",alignItems:"center",minWidth:0},button:{display:"flex",minWidth:0,fontSize:"inherit",paddingTop:2,paddingBottom:2,paddingLeft:6,paddingRight:6}})),[]),{url:M,canEdit:P}=(0,i.VK)((()=>({url:(0,m.ZP)({store:v,fullyQualified:!1,pageVisitSource:s.tY.Breadcrumb}),canEdit:v.canEdit()})),[v]),A=(0,o.useCallback)((e=>{const{droppedDirection:n,droppedStores:o,duplicate:r}=e;c.createAndCommit({userAction:"SearchPathBreadcrumb.onDrop",environment:t,perform:e=>l.LQ({environment:t,targetParentStore:v.getContentStore(),targetStore:v,droppedDirection:n,droppedStores:o,duplicate:r,transaction:e})})}),[t,v]),R=(0,h.jsx)(g.Z,{store:v,maxWidth:y,iconSize:S,emojiSize:w,titleStyle:k,iconStyle:I,highlighter:C});return(0,h.jsxs)(o.Fragment,{children:[(0,h.jsx)(p.Z,{store:v,canDropOnto:P,onSelectableDrop:A,style:T.selectable,analyticsName:"breadcrumb",shouldShowDropZone:!0,children:_?(0,h.jsx)(d.ZP,{originGap:4,popupType:n.isMobile?d.Z4.SlideUp:d.Z4.Popup,render:_,renderOrigin:e=>(0,h.jsx)(u.Z,{...e,style:T.button,isSmall:!0,shouldShrink:!0,mobileFeedback:n.isMobile,children:R})}):(0,h.jsx)(u.Z,{href:M,external:!1,style:T.button,isSmall:!0,shouldShrink:!0,mobileFeedback:n.isMobile,onClick:x,children:R})}),b&&(0,h.jsx)(f.f,{})]},v.id)}},24946:(e,t,n)=>{n.d(t,{Z:()=>g});var o=n(67294),r=n(480),i=n(86628),a=n(24405),s=n(31945),l=n(68785),c=n(89728),d=n(95697),u=n(77907),p=n(87686),m=n(25238),f=n(85893);function g(e){window.__c={n:"BreadcrumbTeamButton"};const{device:t}=(0,r.O7)(),{store:n,showDivider:g,popupRenderer:h,iconSize:v,iconStyle:b,highlighter:y}=e,_=(0,a.yK)((()=>({button:{fontSize:"inherit",padding:2},loadingPopupBackground:{width:280,paddingTop:8,paddingBottom:8,display:"flex",justifyContent:"center"}})),[]),{teamsEnabled:S,storeIsDefined:w}=(0,i.VK)((()=>({teamsEnabled:(0,d.bq)(),storeIsDefined:n.isDefined()})),[n]);if(!w||!S)return null;return(0,f.jsxs)(o.Fragment,{children:[(0,f.jsx)(s.ZP,{originGap:4,popupType:t.isMobile?s.Z4.SlideUp:s.Z4.Popup,render:h??(e=>(0,f.jsx)(u.LazyTeamBreadcrumbPopup,{renderLoading:e=>(0,f.jsx)("div",{style:_.loadingPopupBackground,children:e&&(0,f.jsx)(l.Z,{})}),teamStore:n,parent:e})),renderOrigin:o=>(0,f.jsx)(c.Z,{style:_.button,isSmall:!0,shouldShrink:!0,mobileFeedback:t.isMobile,...o,children:(0,f.jsx)(m.Z,{store:n,maxWidth:e.maxWidth,iconSize:v,titleStyle:e.titleStyle,iconStyle:b,highlighter:y})})}),g&&(0,f.jsx)(p.f,{})]},n.id)}},3043:(e,t,n)=>{n.d(t,{Qe:()=>i.Z,Yo:()=>r.Z,fY:()=>o.f,l2:()=>s});var o=n(87686),r=n(24946),i=n(7692),a=n(77907);const s=(0,a.lazyComponent)(a.deps.Breadcrumb,(e=>e.Breadcrumb))},37524:(e,t,n)=>{n.d(t,{AV:()=>m,Xx:()=>h,bp:()=>u,bu:()=>g,f2:()=>v,iZ:()=>w,lO:()=>y,lZ:()=>b,mH:()=>p,oc:()=>S,tA:()=>f,vf:()=>k,vg:()=>_});var o=n(8848),r=n(51454),i=n(10906),a=n(92650),s=n(28020),l=n(77181),c=n(24646),d=n(27724);function u(e,t){return e.col===t.col&&e.row===t.row}const p="text/_notion-table",m=function(e){return{minCol:Math.min(e.start.col,e.end.col),maxCol:Math.max(e.start.col,e.end.col),minRow:Math.min(e.start.row,e.end.row),maxRow:Math.max(e.start.row,e.end.row)}},f=14,g=32,h=g+0,v=e=>{let{columnIndex:t,titleColumnIndex:n,indentLevel:o,shouldShowBulkActionsToolbar:r,isSubitemToggleOnTitleColumn:i}=e;const a=0===t&&r?h:0;return b({columnIndex:t,titleColumnIndex:n,indentLevel:o,isSubitemToggleOnTitleColumn:i})+a},b=e=>{let{columnIndex:t,titleColumnIndex:n,indentLevel:o,isSubitemToggleOnTitleColumn:r}=e;return y({columnIndex:t,titleColumnIndex:n,isSubitemToggleOnTitleColumn:r})&&o>0?l.Hw*o:0},y=e=>{let{columnIndex:t,titleColumnIndex:n,isSubitemToggleOnTitleColumn:o}=e;return o?t===n:0===t},_=e=>{let{collectionViewBlockId:t}=e;const n=d.default.state.stores;return 0!==n.length&&!(0,i.v_)(n,t)};function S(e){const{environment:t,collectionContextStore:n,isPhone:i,stickyLeft:a,theme:s}=e;if(i)return{};const l=n.collectionViewBlockStore(),d=null==l?void 0:l.getParentBlockStore();let u;const p=n.isInPeekRenderer.state;if("dark"===s.mode&&p&&(u=s.peekModalBackground),d&&!n.isFullScreen.state&&(null==l||!l.isRootOrDirectChild())){var m;const e=null===(m=d.getModel())||void 0===m?void 0:m.getFormat().block_color;e&&(u=(0,o.fi)(e,s).background)}const f=n.frozoneStore.state.scrollerLeftOffset??0,g=(0,c.Wk)(t),h=Math.max(g-f,0),v=w(t,n)?h:0;return{background:u||s.contentBackground,position:"sticky",left:(a||0)+v,zIndex:r.I5}}function w(e,t){const n=t.collectionViewBlockStore();return!!n&&(n.isRootOrDirectChild()&&(0,a.fg)(e,n)&&!(0,i._5)(n)&&!n.isCollectionViewPageWithContent())}function k(e){const{environment:t,propertyFormat:n}=e,o=n.width;if(!t.device.isPhone)return o;const r=t.WindowSizeStore.getSafePaddingLeftPx((0,s.ui)(t)),i=t.WindowSizeStore.getSafePaddingRightPx((0,s.ui)(t)),a=t.WindowSizeStore.state.width-r-i;return o?Math.min(o,a):a}},59183:(e,t,n)=>{n.d(t,{N:()=>i,Z:()=>s});var o=n(49085),r=n(72126);function i(e,t){return e.collectionViewBlockStore===t.collectionViewBlockStore&&r.Xy(e.groupFormat,t.groupFormat)}class a extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return r.d9(this.state)}}const s=new a},75330:(e,t,n)=>{n.d(t,{zz:()=>gt,TM:()=>ft,wG:()=>Tt,MO:()=>Pt,pi:()=>wt,ME:()=>tt,NZ:()=>Vt,HW:()=>vt,dp:()=>nt,ob:()=>Qe,IH:()=>At,tG:()=>et,dj:()=>_t,lG:()=>Dt,oh:()=>kt,rm:()=>Zt,C_:()=>bt,mS:()=>yt,fI:()=>Rt,A9:()=>ht,Wu:()=>ot,mc:()=>$e,Ip:()=>ut,n1:()=>pt,W1:()=>xt,bu:()=>Bt,f8:()=>Ct,t5:()=>Ye,Z5:()=>Mt,Rm:()=>at,$N:()=>lt,$D:()=>It,xO:()=>st,iG:()=>rt,Uy:()=>dt,Es:()=>it,yc:()=>mt,z2:()=>ct,Ug:()=>Xe});n(57658),n(21703),n(52262),n(24506);var o=n(30120),r=n(1302),i=n(15145),a=n(92996),s=n(21202),l=n(97880);function c(e){switch(e){case"trending":case"similarUsers":return{title:{name:"Name",type:"title"}};case"myTasks":return{};default:(0,l.t1)(e)}}function d(e){let{source:t,collectionId:n}=e;const{type:o}=t;return{id:n,parent_table:s.iU,parent_id:o,version:1,alive:!0,space_id:t.spaceId,format:{},schema:c(o)}}var u=n(41432),p=n(50475),m=n(47025),f=n(14248),g=n(76205),h=n(14714),v=n(99036),b=n(43690),y=n(10070),_=n(28155),S=n(53877),w=n(93824),k=n(76837),I=n(6695),C=n(68626),x=n(42875),T=n(60310),M=n(15157),P=n(72126),A=n(77897),R=n(59753),D=n(29477),E=n(4615),B=n(71644),F=n(45953),O=n(96367),Z=n(6287),V=n(13493),U=n(23867),N=n(54153),L=n(70203),j=n(63143),z=n(9291),q=n(952),H=n(54642),W=n(54569),K=n(5149),G=n(41433),$=n(47307),Q=n(96802),Y=n(94419),X=n(92625),J=n(19785),ee=n(9953),te=n(4408),ne=n(75754),oe=n(32953),re=n(26999),ie=n(80402),ae=n(98104),se=n(82530),le=n(12170),ce=n(53471),de=n(47043),ue=n(28020),pe=n(42),me=n(97004),fe=n(75079),ge=n(92918),he=n(65183),ve=n(26991),be=n(77181),ye=n(27383),_e=n(33929),Se=n(45950),we=n(89796),ke=n(77546),Ie=n(18245),Ce=n(14654),xe=n(94841),Te=n(58202),Me=n(74948),Pe=n(80444),Ae=n(17746),Re=n(77556),De=n(6776),Ee=n(19511),Be=n(88632),Fe=n(77080),Oe=n(79167),Ze=n(37598),Ve=n(53730),Ue=n(79797),Ne=n(27724),Le=n(34583),je=n(10906);const ze=(0,z.defineMessages)({importingCSV:{id:"databaseViewActions.importingCSV.loadingMessage",defaultMessage:"Importing"},uploadingCSV:{id:"databaseViewActions.uploadingCSV.loadingMessage",defaultMessage:"Uploading"},importFailed:{id:"databaseViewActions.importFailedError.message",defaultMessage:"Import failed."}}),qe=(0,z.defineMessages)({renameButtonTitle:{defaultMessage:"Rename",id:"database.collectionEditViewButtonPopup.renameButtonTitle"},statusName:{defaultMessage:"Status",id:"database.collectionEditViewButtonPopup.statusNameProperty"},dateName:{defaultMessage:"Date",id:"database.collectionEditViewButtonPopup.dateNameProperty"}}),He=(0,z.defineMessages)({currentSprintViewDefaultName:{defaultMessage:"Current Sprint",id:"collectionViewActions.typedView.currentSprintViewName"}}),We=10;function Ke(e,t){if(e||t){if(!e)return"add_filter";if(!t)return"remove_filter";if(!P.Xy(e,t)){if((0,g.aN)(e)&&(0,g.aN)(t))return e.property!==t.property?"change_filter":e.filter.operator!==t.filter.operator?"change_filter_operator":P.Xy(e.filter,t.filter)?void 0:"change_filter_value";if((0,g.Mm)(e)&&(0,g.Mm)(t))return e.timestamp!==t.timestamp?"change_filter":e.filter.operator!==t.filter.operator?"change_filter_operator":P.Xy(e.filter,t.filter)?void 0:"change_filter_value";if(!(0,g.vA)(e)||!(0,g.vA)(t))return"change_filter";{if(e.operator!==t.operator)return"change_filter_operator";function n(e){return(0,g.aN)(e)?`property/${e.property}`:(0,g.Mm)(e)?`property/${e.timestamp}`:(0,g.vA)(e)?`combinator/${e.operator}`:void(0,l.t1)(e)}const o=P.MR(e.filters??[],n),r=P.MR(t.filters??[],n),i=o.length,a=r.length;if(i<a)return"add_filter";if(a<i)return"remove_filter";for(let s=0;s<a;s++){const c=Ke(o[s],r[s]);if(c)return c}}}}}function Ge(e,t){if(void 0===t)return;if(void 0===e)return"initial_load";if(!P.Xy(e.collectionView,t.collectionView))return"change_view";if(!P.Xy(e.loader.searchQuery,t.loader.searchQuery))return"change_search";if(!P.Xy(e.loader.sort,t.loader.sort))return"change_sort";const n=Ke(e.loader.filter,t.loader.filter);if(n)return n;const o=e.loader.reducers??{},r=t.loader.reducers??{};if(Object.keys(r).find((e=>{const t=o[e],n=r[e];return n&&(!t||!P.Xy(t,n))})))return"change_group";const i={reducers:void 0,filter:void 0,sort:void 0,reducerDependencies:void 0},a={...null==e?void 0:e.loader,...i},s={...null==t?void 0:t.loader,...i};return P.Xy(a,s)?void 0:"change_loader"}function $e(e){const{environment:t,collectionViewBlockStore:n,collectionViewStore:a,collectionStore:s,collectionContextStore:c,isFullScreen:d,isRootChild:u,isInPeekRenderer:m}=e;Qe({collectionContextStore:c}),d&&(oe.Pg(t),oe.rM(t));const{remoteRequestStore:f,localResultStore:h}=c;if(a){var v;const e=Boolean(!c.isViewSpecificClientModeEnabled.state&&c.isClientModeEnabled.state&&s&&s.id===(null===(v=c.collectionStore())||void 0===v?void 0:v.id)),b=o.ou.fromMillis(Ae.Z.getLocalDateRangeStart({collectionViewId:a.id,currentUserId:t.currentUser.id}));let y;const w=()=>{r.default.afterNextFlush((()=>{const e=f.state;c.isViewSpecificClientModeEnabled.state&&y&&e&&!P.Xy(y.loader.filter,e.loader.filter)&&(c.isClientModeEnabled.setState(!1),c.isViewSpecificClientModeEnabled.setState(!1));const o=Ge(y,e);void 0===o||c.isClientModeEnabled.state&&!function(e,t,n,o){if(!n)return!1;if(null!=t&&t.loader.filter&&(0,g.SH)(null==t?void 0:t.loader.filter,(e=>(0,g.aN)(e)&&(0,O.zy)(e,n.getSchema()))))return!0;return(0,ve.ki)(null==t?void 0:t.loader.reducers,n.getSchema(),o)}(0,e,s,n)||_t(t,c,{src:o}),y=e}))};f.addListener(w);const k=()=>{if((0,A.lB)(1)){const e=Ie.default.mark("database_update_lag");Ie.default.measureAfterNextFlush(e,{environment:t})}};h.addListener(k);const I=(0,ue.qG)(n.id);c.remoteResult.setState(void 0),c.remoteCollectionIds.setState([]),c.isLoaded.setState(!1),c.searchQuery.setState(""),c.searchOpen.setState(!1),c.calendarByMenuOpen.setState(!1),c.timelineByMenuOpen.setState(!1),c.isFullScreen.setState(d),c.isRootChild.setState(u),c.reducers.setState({}),c.groupsStore.reset(),c.groupsLimit.setState(ge.XD),c.boardColumnsLimitStore.setState(ge.XD),c.filtersBarOpen.setState(!!I||void 0),c.isInPeekRenderer.setState(m),c.subitemExpandedStore.setState(new Map),c.isClientModeEnabled.setState(e),c.isViewSpecificClientModeEnabled.setState(!1),c.asyncAggregationStatus.reset(),c.dateRangeStart.setState((0,S.IS)(b.startOf("month").valueOf(),ue.AK.state).valueOf()),c.dateRangeEnd.setState(d&&!t.device.isMobile?(0,S.V7)(b.endOf("month").plus({month:1}).valueOf(),ue.AK.state).valueOf():(0,S.V7)(b.endOf("month").valueOf(),ue.AK.state).valueOf());const C=null==a?void 0:a.getFormat(),x=null==C?void 0:C.collection_view_source;"typed"===(null==x?void 0:x.type)?c.setContext({type:"collectionTypedView",collectionViewBlockStore:n,databaseType:x.databaseType,collectionViewStore:a,pageVisitSourceOverride:(0,Ce.ib)({blockOrCollectionId:n.id})}):(0,_.nx)(x)?s&&c.setContext({type:"collectionVirtualView",collectionViewBlockStore:n,collectionViewStore:a,collectionStore:s,pageVisitSourceOverride:(0,Ce.ib)({blockOrCollectionId:a.id})}):x&&"collection"!==x.type?(0,l.t1)(x):c.setContext({type:"collectionView",collectionViewBlockStore:n,collectionStore:s,collectionViewStore:a}),c.remoteRequestStoreCallback=w,c.localResultStoreCallback=k;const T=Ot(a),R=ye.y.get(T);if(R){const e=0===R.resultSet.blockIds.size,t=c.getPageVisitSourceOverride();(t===i.tY.PersonalHomeTileTasks||t===i.tY.PersonalHomePageTasks)&&(e||ye.y.locallyMutatedTasksDatabase)?ye.y.locallyMutatedTasksDatabase=!1:(c.resetLoadingState(),c.resultSet.setState(P.Xh(R.resultSet)),c.remoteCollectionIds.setState(P.Xh(R.collectionIds)),c.remoteResult.setState(P.Xh(R.remoteResult)),c.isLoaded.setState(!0))}const D=Ve.transactionQueue.isPendingTransactionForRecord(a.pointer);c.wasCreatedThisSession.setState(D);const B=function(e){let{currentUserId:t,collectionViewId:n}=e;const o=M.Z.get({userId:t,key:Ft(n)});if(o)return(0,j.dj)(o)}({currentUserId:t.currentUser.id,collectionViewId:a.id});c.temporaryState.setState(B||{});const{currentSpaceStore:F}=Pe.default.state;if(s&&F&&s.getSpaceId()===F.id&&s.isDefaultRecordCache()&&!(0,p.EW)(n.getSystemBlockTypeStore().getValue())){!function(e){let{currentUserId:t,spaceId:n,collectionId:o}=e;const r=Dt({currentUserId:t,spaceId:n}),i=P.jj([o,...r]).slice(0,We);M.Z.set({userId:t,key:Et(n),value:JSON.stringify(i)})}({currentUserId:t.currentUser.id,spaceId:F.id,collectionId:s.id})}d&&(s&&n.getCollectionViewSourceCollectionStore()&&!s.getName()?xt({environment:t,collectionContextStore:c}):!s&&c.hasSingleCollection()&&K.r$({collectionContextStore:c,collectionSettingsStore:c.settingsStore})),c.frozoneStore.setState({isScrolled:!1,scrollerWidth:void 0,scrollerLeftOffset:void 0,frozenIndex:void 0,tryShowHiddenFrozenColumn:!1}),c.visitSessionId=(0,E.ZP)()}}function Qe(e){const{collectionContextStore:t}=e,{localResultStore:n,remoteRequestStore:o,remoteRequestStoreCallback:r,localResultStoreCallback:i}=t;r&&o.removeListener(r),i&&n.removeListener(i),t.infiniteScrollLongTaskObserver.disconnect()}function Ye(e){const{dateRangeStart:t,dateRangeEnd:n,collectionContextStore:o}=e;o.dateRangeStart.setState(t),o.dateRangeEnd.setState(n)}function Xe(e){const{searchQuery:t,collectionContextStore:n}=e;n.collectionViewStore()&&(n.searchQuery.setState(t||""),n.groupsStore.resetAllLimits())}function Je(e){const{environment:t,collectionViewBlockStore:n,collectionView:o,transaction:r}=e,i=ee.ae({environment:t,table:V.n,value:o,inMemoryRecordCache:n.inMemoryRecordCache,transaction:r}),a=Ue.Xr.createChildStore(n,{table:V.n,id:i.id,spaceId:n.getSpaceId()});return Y.R3({parent:n.getCollectionViewsStore(),append:a,transaction:r}),a}function et(e){var t;const{environment:n,collectionContextStore:o,collectionViewStore:r,intl:i,transaction:s}=e,l=o.collectionViewBlockStore();if(!l)return;const c=r.computeWithRecordValues((e=>{let{getRecordValueAndSubscribe:t}=e;return t(r)}));if(!c)return;const d=(null===(t=c.format)||void 0===t?void 0:t.app_config_uri)===a.g3?_e.default.formatMessage(He.currentSprintViewDefaultName):(0,k.nM)(c.name||i.formatMessage(je.b1[c.type]));return Je({environment:n,collectionViewBlockStore:l,collectionView:{...c,id:(0,E.ZP)(),name:d},transaction:s})}function tt(e){var t,n;const{environment:o,collectionContextStore:i,transaction:a}=e,l=i.collectionViewBlockStore(),c=i.collectionViewStore(),d=i.settingsStore;if(!l)return;const u=null===(t=i.collectionStore())||void 0===t||null===(t=t.getFormat())||void 0===t?void 0:t.collection_default_arrows_by,p=Je({environment:o,collectionViewBlockStore:l,collectionView:{type:"table",parent_id:l.id,parent_table:s.iU,alive:!0,space_id:l.getSpaceId(),format:{table_properties:null==c||null===(n=c.getFormat())||void 0===n?void 0:n.table_properties,timeline_arrows_by:u?{property:u}:void 0,table_subitem_toggle_column:"title",...c&&"collectionTypedView"===i.contextType?{collection_view_source:c.getFormat().collection_view_source,property_filters:c.getFormat().property_filters}:{}}},transaction:a});Ct({environment:o,collectionContextStore:i,collectionViewId:p.id,isFullScreen:i.isFullScreen.state,isRootChild:i.isRootChild.state,isInPeekRenderer:i.isInPeekRenderer.state}),r.default.afterNextFlush((()=>{l.getCollectionViewSourceCollectionStore()?(K.r$({collectionContextStore:i,collectionSettingsStore:d}),K.wl({collectionSettingsStore:d,item:{type:"createView"}})):K.r$({collectionContextStore:i,collectionSettingsStore:d})}))}function nt(e){const{collectionViewBlockStore:t,collectionViewStore:n,transaction:o}=e,r=Ue.Xr.createChildStore(t,{table:V.n,id:n.id,spaceId:t.getSpaceId()}),i=n.getFormat().app_config_uri;if(i){var a;const e=null===(a=t.getFormat())||void 0===a?void 0:a.app_uri_map;e&&delete e[i],Q.FH({stores:[t],update:{app_uri_map:e},transaction:o})}Y.Od({parent:t.getCollectionViewsStore(),childToRemove:r,transaction:o})}function ot(e){const{collectionViewBlockStore:t,newViewIds:n,transaction:o}=e,r=t.getCollectionViewStores(),{beforeOps:i}=(0,w.q)(r.map((e=>e.id)).slice(0,n.length),n);P.Ed(i,((e,r)=>{const i=Ue.Xr.createChildStore(t,{table:V.n,id:r,spaceId:t.getSpaceId()});if(e)Y.Vt({parent:t.getCollectionViewsStore(),insert:i,before:Ue.Xr.createChildStore(t,{table:V.n,id:e,spaceId:t.getSpaceId()}),transaction:o});else{const e=P.Z$(n.filter((e=>e!==r)));Y.BE({parent:t.getCollectionViewsStore(),insert:i,after:e?Ue.Xr.createChildStore(t,{table:V.n,id:e,spaceId:t.getSpaceId()}):void 0,transaction:o})}}))}function rt(e){const{collectionViewStore:t,update:n,transaction:o}=e;ee.sW({store:t,data:n,transaction:o})}function it(e){const{collectionViewStore:t,update:n,transaction:o}=e;ee.sW({store:t.getQueryStore(),data:n,transaction:o})}function at(e){const{environment:t,collectionStore:n,update:o,transaction:r}=e,i=n.getSchema();o.schema&&(o.schema=v.Fn(o.schema)),o.deleted_schema&&(o.deleted_schema=v.Fn(o.deleted_schema));const a={...o};if(o.deleted_schema){const e=n.getDeletedSchema(),t=(0,y.jf)({schemas:[e,o.deleted_schema],prioritizeLooserLimitRule:!0});t.error?C.log({level:"error",from:"collectionViewActions",type:"updateCollection",error:t.error}):a.deleted_schema=t.value}ee.sW({store:n,data:a,transaction:r}),o.schema&&bt({environment:t,collectionStore:n,oldSchema:i,newSchema:o.schema,transaction:r})}function st(e){const{environment:t,collectionStore:n,update:o,transaction:r}=e,i=n.getSchema(),a=v.Fn(o);ee.sW({store:n.getSchemaStore(),data:a,transaction:r}),bt({environment:t,collectionStore:n,oldSchema:i,newSchema:n.getSchema(),transaction:r})}function lt(e){const{collectionStore:t,update:n,transaction:o}=e;ee.sW({store:(0,Ue._J)(t,t.pointer,["deleted_schema"]),data:n,transaction:o})}function ct(e){const{environment:t,collectionContextStore:n,newViewType:o,transaction:r,intl:i}=e,a=n.collectionViewStore(),s=n.collectionViewBlockStore(),l=n.collectionStore(),c=n.normalizedFormatStore.state;if(!a||!s)return;const d=n.normalizedSchemaStore.state;if(o===a.getType())return;const u=n.permissionScopes.state,p=a.getType();if(ee.sW({store:a,data:{type:o},transaction:r}),"board"===p&&Q.FH({stores:[a],update:{collection_group_by:a.getFormat().board_columns_by},transaction:r}),"table"===o)ee.sW({store:a.getQueryStore(),data:{aggregations:[]},transaction:r});else if("board"===o){var f;const e=a.getFormat().board_columns_by;let o=(null===(f=a.getFormat().collection_group_by)||void 0===f?void 0:f.property)??je.Se(d);if(l&&!o){o=(0,B.ZP)();const e={name:i.formatMessage(qe.statusName),type:"select",options:[]};u.canConfigureCollection&&st({environment:t,collectionStore:l,update:{[o]:e},transaction:r})}const s=n.normalizedSchemaStore.state,c=o&&s[o];if(!o||!c||!(0,h.LG)(c))return;Q.FH({stores:[a],update:{board_columns_by:{...(0,h.fw)(o,c,"collectionTypedView"===n.contextType),...e},collection_group_by:void 0},transaction:r})}else if("calendar"===o){let e=je.PD(d);if(l&&!e){e=(0,B.ZP)();const n={name:i.formatMessage(qe.dateName),type:"date"};u.canConfigureCollection&&st({environment:t,collectionStore:l,update:{[e]:n},transaction:r})}ee.sW({store:a.getQueryStore(),data:{aggregations:[],calendar_by:e},transaction:r})}else if("gallery"===o)Q.FH({stores:[a],update:{gallery_cover:{type:"page_content"}},transaction:r}),ee.sW({store:a.getQueryStore(),data:{aggregations:[]},transaction:r});else if("list"===o){if(void 0===c.list_properties){const e=[{property:"title",visible:!0}],t=Object.keys(d).find((e=>{const t=d[e];return Boolean(t&&(0,he.Rb)(t))}));void 0!==t&&e.push({property:t,visible:!0}),Q.FH({stores:[a],update:{list_properties:e},transaction:r})}ee.sW({store:a.getQueryStore(),data:{aggregations:[]},transaction:r})}else if("timeline"===o){let e=je.HI(d);if(l&&!e){e=(0,B.ZP)();const n={name:i.formatMessage(qe.dateName),type:"date"};u.canConfigureCollection&&st({environment:t,collectionStore:l,update:{[e]:n},transaction:r})}ee.sW({store:a.getQueryStore(),data:{aggregations:[],timeline_by:e},transaction:r})}else if("chart"===o){if(!a.getFormat().chart_config&&l){const e=(0,m.Gy)({collectionSchema:n.normalizedSchemaStore.state,collectionPointer:l.pointer});Q.FH({stores:[a],update:{chart_config:e},transaction:r})}}const g=null==l?void 0:l.getFormat().subitem_property;if(g&&!(0,be.Av)(o)){const e=p&&!(0,be.Av)(o)?(0,I.oz)(p):void 0,t=(e?a.getFormat()[e]??[]:[]).find((e=>e.property===g))??{property:g,visible:!0},n=(0,I.oz)(o);if(n){const e=a.getFormat()[n]??[];Q.FH({stores:[a],update:{[n]:[...e,t]},transaction:r})}}ut({collectionContextStore:n})}function dt(e){const{icon:t,collectionViewBlockStore:n,transaction:o}=e;Q.FH({stores:[n],update:{collection_view_icon:t},transaction:o})}function ut(e){const{collectionContextStore:t}=e,n=t.collectionViewBlockStore();if(!n)return;const o=Te.R.findCollectionViewBlockFromStore(n);null!=o&&o.resetLeftScrollAfterFlush&&o.resetLeftScrollAfterFlush()}function pt(e){const{collectionContextStore:t}=e,n=t.collectionViewBlockStore();if(n){const e=Te.R.findCollectionViewBlockFromStore(n);if(e){const t=e.getNode();t&&(0,ke.Wr)(t,{edgeDist:0,animate:!1})}}}function mt(e){var t,n,o;const{collectionContextStore:r,collectionStore:i,transaction:a}=e,s=r.collectionViewStore();if(!s||!i.isDefined())return;const l=je.Vv(i),c=null===(t=i.getFormat())||void 0===t?void 0:t.collection_default_arrows_by,d={table_properties:null==l||null===(n=l.getFormat())||void 0===n?void 0:n.table_properties,collection_pointer:{table:Z.v,id:i.id,spaceId:i.getSpaceId()},timeline_arrows_by:c?{property:c}:void 0,table_subitem_toggle_column:"title"},u=null==r?void 0:r.normalizedSchemaStore.state;ee.sW({store:s,data:(0,j.Q2)({format:d,query2:{sort:null==l||null===(o=l.getQuery(u))||void 0===o?void 0:o.sort}}),transaction:a})}function ft(e){var t;const{environment:n,name:o,collectionViewStore:r,collectionViewBlockStore:i,transaction:a}=e,s=r.getType();if(!s||!i.isDefined())return;const l=i.getCollectionPointer(),c=i.getFormat(),d=(0,L.QaF)(null===(t=i.getTitleStore())||void 0===t?void 0:t.getValue()),p=l||o||!d?o:d,m=(0,pe.Yu)({environment:n,isInline:i.getType()===u.Ti.collectionView,name:p,viewType:s}),f=F.Ao.create();f.set({table:V.n,id:"collection_view"},r.pointer),G.ZI({environment:n,sourceBlockId:"root",targetBlockPointer:i.pointer,sourceBlockSubtree:m?(0,F.R3)(m):F.Ak.create(),targetRecordCache:i.inMemoryRecordCache,transaction:a,recordPointerMap:f,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!0,useCrdt:i.useCrdt()});const g=f.get({table:Z.v,id:"collection"});if(!g)return;Q.FH({stores:[i],update:{collection_pointer:g},transaction:a});const h=i.getCollectionStore();h&&(at({collectionStore:h,update:{icon:null==c?void 0:c.page_icon,cover:null==c?void 0:c.page_cover},environment:n,transaction:a}),Q.FH({stores:[h],update:{collection_cover_position:null==c?void 0:c.page_cover_position},transaction:a}))}function gt(e){const{collectionViewBlockStore:t,collectionStore:n,transaction:o}=e;if(!t.isDefined()||!n.isDefined())return;if(t.getCollectionPointer())throw new Error("CollectionViewBlock already has a collection");Q.FH({stores:[t],update:{collection_pointer:n.pointer},transaction:o})}function ht(e){const{collectionViewBlockStore:t,collectionStore:n,transaction:o}=e;if(!t.isDefined()||!n.isDefined())return;[t].forEach((e=>{var t;e.getCollectionViewStores().filter((e=>{var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.id)===n.id})).forEach((t=>nt({collectionViewBlockStore:e,collectionViewStore:t,transaction:o}))),(null===(t=e.getFormat().collection_pointer)||void 0===t?void 0:t.id)===n.id&&(ee.sW({store:e,data:{collection_id:null},transaction:o}),ee.sW({store:e.getFormatStore(),data:{collection_pointer:null},transaction:o}))})),J.hh({childStore:n,transaction:o})}function vt(e){const{environment:t,collectionStore:n,performTransaction:o}=e;return se.createAndCommit({userAction:"collectionViewActions.createSchemaUpdateTransaction",environment:t,perform:e=>{const r=n.getSchema(),i=o(e),a=n.getSchema();return bt({environment:t,collectionStore:n,oldSchema:r,newSchema:a,transaction:e}),i}}).performResult}function bt(e){const{environment:t,collectionStore:n,oldSchema:o,newSchema:r,transaction:i}=e,a=v.Fn(o),s=v.Fn(r),l=Object.keys(s);for(const d of l){const e=a[d],o=s[d];if(o){if("status"===o.type&&"status"!==(null==e?void 0:e.type)){let r;r="select"===(null==e?void 0:e.type)||"multi_select"===(null==e?void 0:e.type)?(0,f.r9)(o.name,e.options??[],_e.default.getIntl()):o.groups&&o.options&&o.defaultOption?o:v.I4(o.name,_e.default.getIntl());const a={...s,[d]:r};if(ee.sW({store:n,data:{schema:a},transaction:i}),"checkbox"===(null==e?void 0:e.type)&&"status"===o.type){const e=r.groups??[],o=e[e.length-1];o&&W.hz({environment:t,collectionStore:n,property:d,oldValue:{type:"checkbox",value:!0},newValue:{type:"status",value:{type:"by_group",group:o.name}},transaction:i})}}if("status"===(null==e?void 0:e.type)&&"checkbox"===o.type){const o=e.groups??[],r=e.options??[],a=o[o.length-1],s=r.filter((e=>{var t;return null==a||null===(t=a.optionIds)||void 0===t?void 0:t.includes(e.id)}));for(const e of s)W.hz({environment:t,collectionStore:n,property:d,newValue:{type:"checkbox",value:!0},oldValue:{type:"status",value:{type:"by_option",option:e.value}},transaction:i})}}}for(const d of l){const e=a[d],o=s[d];!o||e&&v.cu(e)||!v.cu(o)||H.getSelectPropertyValues(t,{collection:{id:n.id,spaceId:(0,U.C)(n.pointer.spaceId)},property:d}).then((e=>{if("failed"===e.type)throw e.error;const{results:r}=e.data,i=o.options||[],a=v.Fn(n.getSchema()),s=P.mN([...i,...r.map((e=>({id:(0,B.ZP)(),value:e})))],(e=>e.value)),l={...o,options:s},c={...a,[d]:l};se.createAndCommit({userAction:"collectionViewActions.handleCollectionSchemaUpdated",environment:t,perform:e=>{ee.sW({store:n,data:{schema:c},transaction:e})}})})).catch((()=>{}))}const c=P.jj([...Object.keys(a),...Object.keys(s)]);for(const d of c){const e=a[d],o=s[d],r=e&&v.cu(e)||"status"===(null==e?void 0:e.type),l=o&&v.cu(o)||"status"===(null==o?void 0:o.type);if(r&&l&&e.type===o.type){const r=o,a=e.options||[],s=r.options||[],l=P.jj([...a.map((e=>e.id)),...s.map((e=>e.id))]);for(const c of l){const r=a.find((e=>e.id===c)),l=s.find((e=>e.id===c));if(r&&l&&r.value!==l.value){const a="status"===e.type?{type:"status",value:{type:"by_option",option:r.value}}:{type:e.type,value:r.value},s="status"===o.type?{type:"status",value:{type:"by_option",option:l.value}}:{type:o.type,value:l.value};W.hz({environment:t,collectionStore:n,property:d,oldValue:a,newValue:s,transaction:i})}}}}for(const d of c){const e=s[d];"button"!==(null==e?void 0:e.type)||e.automation_id||de.Hj({environment:t,collectionStore:n,property:d,transaction:i})}}function yt(e){const{store:t,environment:n}=e;let o;ce.cR({environment:n,bucket:"temporary",onStart:e=>{o=e,X.j({message:ze.uploadingCSV})},onComplete:e=>{(async(e,o)=>{X.j({message:ze.importingCSV});const r=t.getCollectionViewCollectionStore();if(!r)return;if(!Te.R.findCollectionViewBlockFromStore(t))return;const{value:i}=await H.importFile(n,{importType:"MergeIntoCollection",fileURL:e,fileName:o,collection:{id:r.id,spaceId:(0,U.C)(r.pointer.spaceId)}}).next();i.error&&$.showErrorMessage(_e.default.formatMessage(ze.importFailed)),X.x()})(e[0],o[0].name)},onError:e=>{X.x(),$.showErrorMessage(_e.default.formatMessage(ze.importFailed))}})}async function _t(e,t,n){const o=t.collectionViewStore(),{remoteRequestStore:r}=t;if(!r||!o)return;const i=r.state;if(!i)return;const l=t.createUpdateCounter(),c=t.remoteResult.state;Be.Z.state.online&&c&&await Ve.transactionQueue.drain();const d=o.inMemoryRecordCache;if(!t.shouldUpdate(l))return;t.isLoading.setState(!0);const u=Ie.default.mark("collections.remote_query_collection_latency");let p;if(d===e.defaultRecordCache.inMemoryRecordCache&&Be.Z.state.online){const o="initial_load"===n.src?(0,he.Cg)(i):i,r=Fe.default.getEligibleGroup({experimentId:"collection_querying",defaultGroup:"unassigned"});"unassigned"!==r&&(o.requestBackend=r);const a=[];if(Fe.default.checkGate("collection_split_aggregation_v2")&&"msg"!==n.src&&!Object.values(o.loader.reducers||{}).some((e=>"groups"===e.type))){let r=!1;const s={};Object.entries(o.loader.reducers||{}).forEach((e=>{let[t,n]=e;"aggregation"!==n.type?s[t]=n:r=!0}));const c={...o,loader:{...o.loader,reducers:s},aggregationStatus:r?"stripped":void 0};if(p=H.queryCollection(e,c,void 0,n,void 0,"queryCollection").then((o=>{const a=fe.vS(t,n.src);if(Ie.default.measure(u,{environment:e,data:a}),"success"===o.type)return"initial_load"===n.src&&N.Z.set((0,we.Z)(i.collectionView.id),c),St({environment:e,remoteRequest:i,collectionContextStore:t,response:o.data,updateCounter:l,keepAggregationResults:r})})),a.push(p),r){t.asyncAggregationStatus.setState({...t.asyncAggregationStatus.state,calculating:!0});const o=p.then((()=>H.queryCollection(e,{...i,aggregationStatus:"full"},void 0,n,void 0,"queryCollection").then((n=>{if("success"===n.type)return St({environment:e,remoteRequest:i,collectionContextStore:t,response:n.data,updateCounter:l})})).finally((()=>{t.asyncAggregationStatus.setState({calculating:!1})}))));a.push(o)}}else p=H.queryCollection(e,o,void 0,n,void 0,"queryCollection").then((o=>{const r=fe.vS(t,n.src);if(Ie.default.measure(u,{environment:e,data:r}),"success"===o.type)return"initial_load"===n.src&&N.Z.set((0,we.Z)(i.collectionView.id),i),t.asyncAggregationStatus.setState({calculating:!1}),St({environment:e,remoteRequest:i,collectionContextStore:t,response:o.data,updateCounter:l})})),a.push(p);if(!(await(0,D.OI)(1e4,a)).timeout)return}else try{const n=await async function(e,t,n){const{source:o,collectionView:r,loader:i}=t,l=e.currentUser.id;let c;if("collection"!==o.type)throw new Error("TODO: support typed source");c={table:Z.v,id:o.id};const d=Date.now(),u=await Se.Ye({environment:e,pointer:c,inMemoryRecordCache:n});if(null==u||!u.model)throw new Error("Collection not found.");const p=u.model,m=await Se.Ye({environment:e,pointer:{table:V.n,id:r.id},inMemoryRecordCache:n});if(null==m||!m.model)throw new Error("Collection view not found.");const f=R.s8.fromMonomorphicFunctionUnsafe((async t=>{const n=await Se.Ye({environment:e,pointer:t});return null==n?void 0:n.model})),g=m.model,h=F.Ak.create(),v=R.om.fromRecordMap(h),y=p.getNormalizedSchema(),{groupsReducerIds:_,reducerIdsWithNoGroupDependencies:S}=b.x3(i.reducers,i.reducerDependencies),w=Fe.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs"),k=Fe.default.checkGate("better_database_text_sorts"),I={schema:y,pageSort:(null==g?void 0:g.getPageSort())||[],collectionViewId:r.id,loader:i,userId:l,userStartOfWeek:ue.AK.state,currentTime:d,getRecordModel:v,intl:_e.default.getIntl(),isSorted:!1,relativeVariableResult:void 0,isSprintPlanningView:(null==g?void 0:g.getAppConfigUri())===a.sV,collectionSourceType:o.type,groupsReducerIds:_,reducerIdsWithNoGroupDependencies:S,formulaTimeoutMs:w,resultCache:new Map,useImprovedSort:k},C=p.__IM_SORRY__getValue(),x=b.fk(I),T=(await Se.ne({environment:e,collection:p,inMemoryRecordCache:n})).filter((e=>{let{model:t}=e;return null==t?void 0:t.alive})),M=P.oA(T.map((e=>{let{model:t}=e;return null==t?void 0:t.__IM_SORRY__getValue()}))),A=(i.reducers?Object.values(i.reducers):[]).some((e=>Boolean("results"===e.type&&e.loadContentCover))),D=new Map,E={};M.forEach((e=>E[e.id]=p));const B=g.getFormat(),O=g.getType(),U=B&&O&&b.ps(B,O,y),N=await b.Ct({collectionValue:C,loader:i,loadAllProperties:!1,recordMap:h,loadRecordModel:f,dependencyCache:D,searchProperties:U});await b.c_({blocks:M,dependencies:N,blockIdToAssociatedCollectionModelCache:E,recordMap:h,loadRecordModel:f,dependencyCache:D,resultCache:I.resultCache}),A&&await b.jF({blocks:M,loadRecordModel:f,recordMap:h});for(const a of M)b.BW(a,C,I,x);const{result:L}=b.kk(I,x),j=F.PF.create(),z=b.aW({result:L});return await Promise.all(z.map((async t=>{const o=await Se.Ye({environment:e,pointer:{table:s.iU,id:t},inMemoryRecordCache:n});o&&j.setModelAndRole({table:s.iU,id:t},o.model,o.role)}))),j.setModelAndRole(c,u.model,u.role),j.setModelAndRole({table:V.n,id:r.id},m.model,m.role),{result:L,recordMap:j.toJson({allowVersionDowngrade:!1}),relativeVariableResult:void 0,collectionIds:void 0,shouldUseClientMode:!1,isViewSpecificClientMode:!1,allBlockIds:void 0}}(e,i,d),o=F.PF.create(n.recordMap);te.fL({environment:e,inMemoryRecordCache:d,recordMap:o,debugSource:"collectionViewActions.fetchRemoteResult (localResponse)"}),St({environment:e,collectionContextStore:t,remoteRequest:void 0,response:n,updateCounter:l})}catch(m){}finally{t.resetLoadingState()}p&&p.catch((e=>{}))}function St(e){const{environment:t,remoteRequest:n,collectionContextStore:o,response:r,updateCounter:i,keepAggregationResults:a}=e,s=o.collectionViewStore();if(!o.shouldUpdate(i))return;const l=o.remoteResult.state;if(!l||!P.Xy(l,r.result)){const e=r.result;if("reducer"===r.result.type){if(a){const t=Object.entries((null==l?void 0:l.reducerResults)||{}).filter((e=>{let[t,n]=e;return"aggregation"===n.type})).reduce(((e,t)=>{let[n,o]=t;return e[n]=o,e}),{});e.reducerResults={...t,...e.reducerResults}}o.remoteResult.setState(e)}if(r.shouldUseClientMode)o.isClientModeEnabled.setState(!0),o.isViewSpecificClientModeEnabled.setState(Boolean(r.isViewSpecificClientMode)),o.resultSet.resetWithRemote(r.allBlockIds);else{const e=new Set(b.aW({result:r.result,onlyTypes:["results"]}));o.resultSet.resetWithRemote(e)}}const c=o.remoteCollectionIds.state,d=r.collectionIds||[];P.Xy(c,d)||o.remoteCollectionIds.setState(d),Oe.Z.addFromRecordMapWithRoleJson(r.recordMap),Oe.Z.isEmpty()||le.dY({environment:t}),o.relativeVariables.setState({...o.relativeVariables.state,...r.relativeVariableResult});if(o.remoteResult.state&&(o.resetLoadingState(),o.isLoaded.setState(!0),a||o.lastRemoteRequest.setState(n),s)){const e=Ot(s);ye.y.set(e,{remoteResult:o.remoteResult.state,resultSet:o.resultSet.state,collectionIds:o.remoteCollectionIds.state})}}function wt(e,t){const{blockIds:n,hasLocalUpdates:o}=t.resultSet.state,r=t.collectionViewStore(),i=e.currentUser.id,c=t.remoteRequestStore.state,u=t.remoteResult.state;if(!r||!r.isDefined()||!c)return;const p=Date.now(),m=_e.default.getIntl(),f=r.getRecordModel,g=r.getFormat(),h=r.getType(),v=r.getCollectionSource();if(!v)return;const S=t.collectionStoresStore.state,w=[];for(const a of S){const e=f(a);e&&w.push(e)}if(0===w.length)return;t.isLoaded.setState(!1);const k=w.some((e=>Ze.Z.getEditedBlocksForCollection(e.id).size>0)),I=P.Xy(t.lastRemoteRequest.state,c);if(!k&&u&&!o&&I)return t.isLoaded.setState(!0),u;const C=Ie.default.mark("collections.compute_local_result_latency");let x={};switch(t.contextType){case"collectionTypedView":const e=(t.databaseType&&(0,a.uV)(m))??{},n=(0,y.jf)({schemas:[...w.map((e=>{var t;const n=null==e||null===(t=e.getFormat())||void 0===t?void 0:t.app_uri_map,o=e.getNormalizedSchema();return y.aQ.toViewSchema(o,n)})),e],onlyPropertyIds:Object.keys(e),prioritizeLooserLimitRule:!0});if(n.error)throw n.error;x=n.value;break;case"collectionVirtualView":case"collectionView":case"collectionViewBlock":case"collectionPage":case void 0:x=w[0].getNormalizedSchema();break;default:(0,l.t1)(t.contextType)}const M=b.ps(g,h,x),A=t.relativeVariableStore.state,{groupsReducerIds:D,reducerIdsWithNoGroupDependencies:E}=b.x3(c.loader.reducers,c.loader.reducerDependencies),B=Fe.default.getConfigKey("collection_request_settings","clientFormulaTimeoutMs"),F=Fe.default.checkGate("better_database_text_sorts"),O={pageSort:r.getPageSort(),schema:x,loader:c.loader,userId:i,userStartOfWeek:ue.AK.state,currentTime:p,getRecordModel:Pe.default.getCurrentBlockModelFn(),intl:_e.default.getIntl(),isSorted:!1,visibleProperties:M,relativeVariableResult:A,isSprintPlanningView:g.app_config_uri===a.sV,collectionSourceType:v.type,groupsReducerIds:D,reducerIdsWithNoGroupDependencies:E,formulaTimeoutMs:B,resultCache:new Map,useImprovedSort:F},Z={...O,loader:{...c.loader,filter:void 0}},V=u?new Set(b.aW({result:u,onlyTypes:["results"]})):new Set,U=b.fk(O);for(const a of n){const e=Ue.G.createChildStore(r,{table:s.iU,id:a}),n=e.getAssociatedCollectionStore();if(_.Sl.hasCollections(v)&&(!n||!S.find((e=>{let{id:t}=e;return n.id===t}))))continue;const o=f(e);let i;switch(t.contextType){case"collectionVirtualView":if((0,_.nx)(v)){const e=(0,xe.Ep)((0,T.Eq)(v));i=e&&R.kk.fromCollection(d({source:v,collectionId:e}))}break;case"collectionTypedView":case"collectionView":case"collectionPage":case"collectionViewBlock":case void 0:i=n&&f(n);break;default:(0,l.t1)(t.contextType)}if(!i||!o)continue;const u={...c.loader.upwardTraversalRelation&&V.has(a)&&(0,be.uU)({block:R.kk.fromBlock(o),collectionContextStore:t})&&!t.isClientModeEnabled.state?Z:O,schema:(0,y.Hs)(v.type,x,i)};b.BW(o,i,u,U)}for(const a of w){const e=Ze.Z.getEditedBlocksForCollection(a.id),t=(0,y.Hs)(v.type,x,a);for(const o of e){if(n.has(o))continue;const e=f(Ue.G.createChildStore(r,{table:s.iU,id:o}));e&&b.BW(e,a,{...O,schema:t},U)}}const{result:N}=b.kk(O,U);if(t.isLoaded.setState(!0),"reducer"!==N.type)return;const L=fe.vS(t);return Ie.default.measure(C,{environment:e,data:L}),N}function kt(e,t){const n=t.collectionViewStore(),o=t.searchQuery.state;if(!n)return;const r=t.currentSubitemFormatStoreForUiDisplay.state,i=null==n?void 0:n.getType(),a=(0,me.ze)(t,!0),s=t.currentSortsStore.state,l=function(e){const t=e.reducers.state,n={};return P.Ed(t,((e,t)=>{e&&(n[t]=e.reducer)})),n}(t);if(P.xb(l))return;let c;if(t.reducerDependencies.size>0){c={};for(const[e,n]of t.reducerDependencies)c[e]=[...n]}const d=(0,U.C)(n.pointer.spaceId),u=n.getCollectionSource();if(!u)return;const p=t.normalizedSchemaStore.state,m=(null==r?void 0:r.property)&&p[r.property];return{source:u,collectionView:{id:n.id,spaceId:d},loader:{reducers:l,filter:a,sort:s,searchQuery:o,userId:e.currentUser.id,userTimeZone:(0,x.r)(),...m&&(0,v.p_)(m)&&i&&(0,be.Av)(i)&&{upwardTraversalRelation:m},reducerDependencies:c}}}function It(e){const{reducerId:t,instanceId:n,reducer:o,collectionContextStore:r,groupsPointer:i}=e,a=r.reducers.state,s=a[t];let l,c;if(i&&i.length>0&&(l=(0,h.KW)(i)),o){if(c={instanceIds:n?P.jj([...(null==s?void 0:s.instanceIds)||[],n]):(null==s?void 0:s.instanceIds)||[],reducer:o},l){r.reducerDependencies.has(l)||r.reducerDependencies.set(l,new Set);const e=r.reducerDependencies.get(l);null==e||e.add(t)}}else{if(l){const e=r.reducerDependencies.get(l);e&&(e.delete(t),0===e.size&&r.reducerDependencies.delete(l))}const e=n?P.zu((null==s?void 0:s.instanceIds)||[],n):(null==s?void 0:s.instanceIds)||[];c=s&&e.length>0?{instanceIds:e,reducer:s.reducer}:void 0}P.Xy(s,c)||r.reducers.setState({...a,[t]:c})}function Ct(e){const{environment:t,collectionViewId:n,openInNew:o,collectionContextStore:r,isFullScreen:a,isRootChild:s,isInPeekRenderer:l}=e,c=r.collectionViewBlockStore();if(c){if(c===Pe.default.state.mainEditorCurrentBlockStore||o)ne._({environment:t,store:c,openInNew:o,collectionViewId:n,pageVisitSource:i.tY.ChangeCollectionView});else{const e=new Ue.Xr(t,{table:V.n,id:n},{inMemoryRecordCache:c.inMemoryRecordCache}),o=e.getCollectionStore();$e({environment:t,collectionViewBlockStore:c,collectionViewStore:e,collectionStore:o,collectionContextStore:r,isFullScreen:a,isRootChild:s,isInPeekRenderer:l}),M.Z.set({userId:t.currentUser.id,key:Re.Z.getLocalViewPreferenceKey(c.id),value:n})}ut({collectionContextStore:r})}}function xt(e){const{environment:t,collectionContextStore:n}=e;let o=n.collectionStore();const r=n.collectionViewBlockStore();if(!o||!r)return;const{mainEditorCurrentBlockStore:i}=Pe.default.state;i&&n.isFullScreen.state&&(o=Ue.NW.createChildStore(i,o.pointer)),ae.mT({environment:t,store:o.getNameStore(),canSelectAllBlocks:!1})}function Tt(){ie.MO(),function(){const e=Ee.Z.state,t=Ne.default.state;if(e.isActive&&1===t.stores.length&&t.stores[0].id===e.store.id)return;Pt()}()}function Mt(e){const{store:t,transient:n}=e;Ee.Z.setState({isActive:!0,store:t,transient:Boolean(n)})}function Pt(){Ee.Z.setState({...Ee.Z.state,isActive:!1})}function At(e){const{store:t}=e;"new"===De.Z.state.editMode&&De.Z.state.store.id===t.id&&De.Z.reset()}async function Rt(e){const{environment:t,collectionContextStore:n,blockIdToMinimumVersion:o}=e;await async function(e,t){return await Promise.all((0,l.qP)(t).map((async t=>{let[n,o]=t;return te.bG({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:{table:s.iU,id:n},userId:e.currentUser.id,minimumVersion:o})})))}(t,o),n.resultSet.addLocalChange(Object.keys(o))}function Dt(e){let{currentUserId:t,spaceId:n}=e;const o=M.Z.get({userId:t,key:Et(n)});if(o){const e=(0,j.dj)(o);return Array.isArray(e)?e:[]}return[]}function Et(e){return`getRecentlyNavigatedCollections:${e}`}function Bt(e){let{currentUserId:t,collectionViewId:n,temporaryState:o}=e;const r=Ft(n);o?M.Z.set({userId:t,key:r,value:JSON.stringify(o)}):M.Z.remove({userId:t,key:r})}function Ft(e){return`collectionViewTemporaryState2:${e}`}function Ot(e){const t=e.id,n=e.getCollectionSource();return"trending"===(null==n?void 0:n.type)?{collectionViewId:t,teamId:n.teamId}:{collectionViewId:t}}function Zt(e){var t;const{store:n,typedDatabases:o,environment:r}=e,i=je.fm(n);if(!(0,Le.M_)(r))return;r.device.isMobile&&Me.close();const a=null===(t=n.getCollectionViewStores().at(0))||void 0===t?void 0:t.id;if(!i&&!a)return;const s=i??new Re.Z(r);if(!i&&a){const e=Ue.Xr.createChildStore(n,{table:V.n,id:a});$e({environment:r,collectionViewBlockStore:n,collectionViewStore:e,collectionStore:void 0,collectionContextStore:s,isFullScreen:!0,isRootChild:!0,isInPeekRenderer:!1}),s.remoteCollectionIds.setState(o.map((e=>e.id)))}else 0===s.collectionStoresStore.state.length&&s.remoteCollectionIds.setState(o.map((e=>e.id)));se.createAndCommit({userAction:"collectionViewActions.handleAddMultiSourceViewPageButtonClick",environment:r,perform:e=>{Vt({transaction:e,store:n,collectionContextStore:s,environment:r,shouldCoerce:!0,showMoveTo:!0,peekModeOverride:"center_peek",from:"sidebar_new_page_button",useCrdt:!1})}})}function Vt(e){const{transaction:t,store:n,collectionContextStore:o,environment:r,shouldCoerce:a,showMoveTo:s,peekModeOverride:l,from:c,useCrdt:d}=e,u=W.IW({environment:r,collectionContextStore:o,groupsPointer:[],insertAtIndex:0,shouldCoerce:a,initializeDefaultTemplate:a,transaction:t,from:c,useCrdt:d});if(!u)return;let p=je.kr(o.collectionViewStore());l&&(p=l);const m=(0,ue.qG)(n.id),f="collectionTypedView"===o.contextType,g=o.isCompactView.state;re.CH({environment:r,store:u.newStore,peekMode:p,showMoveTo:s,resultsStore:void 0,collectionContextStore:o,pageVisitSource:m?g?i.tY.PersonalHomeTileTasksCreate:i.tY.PersonalHomeTasksCreate:i.tY.Create});const h=f?u.newStore.getAssociatedCollectionId():void 0;return q.W(r,{from:c,type:"page",new_page_id:u.newStore.id,creating_block_id:u.newStore.id,...fe.Pn(o,h)}),u.newStore}},20616:(e,t,n)=>{n.d(t,{F:()=>d});n(67294);var o=n(480),r=n(24405),i=n(62760),a=n(79362),s=n(65183),l=n(85893);const c=e=>({regular:e.regularTextColor,light:e.mediumTextColor,gray:a.Lr[e.mode].gray,lightGray:a.Lr[e.mode].lightgray});function d(e){window.__c={n:"CollectionViewIcon"};const{device:t}=(0,o.O7)(),n=(0,r.Fg)(),{color:a,viewIcon:d,viewType:u,size:p,style:m}=e,f=c(n)[a];return u?d?(0,l.jsx)(i.Z,{style:{fill:f,backfaceVisibility:void 0,...m},size:p??(t.isMobile?18:16),theme:n,icon:d}):s.aW[u]({width:p??(t.isMobile?18:16),height:p??(t.isMobile?18:16),backfaceVisibility:void 0,fill:f,...m}):null}},54851:(e,t,n)=>{n.d(t,{Z:()=>x});var o=n(67294),r=n(73935),i=n(480),a=n(86628),s=n(15145),l=n(62965),c=n(26189),d=n(75754),u=n(993),p=n(32741),m=n(68709),f=n(24813),g=n(66213),h=n(14976),v=n(35683),b=n(84210),y=n(73819),_=n(77080),S=n(46735),w=n(22294),k=n(72014),I=n(85893);function C(e,t){window.__c={n:"CollectionViewPageBlock"};const n=(0,i.O7)(),l=(0,o.useContext)(g.ZO),C=(0,o.useRef)(null),x=(0,o.useRef)(null),T=(0,y.PE)(e.store,e.disabled),M=(0,y.rv)(e.store),P=(0,o.useCallback)((()=>{S.Z.recordVisit({id:e.store.id,systemBlockType:e.store.getSystemBlockTypeStore().getValue(),type:v.vu.Link,currentUserId:n.currentUser.id}),c.SK(n,{page_visit_id:k.$g.getCurrentPageVisitId(),mentioned_page_id:e.store.id,source_type:"collection_view_page_block",hover_preview_enabled:_.default.checkGate("first_party_links"),is_navigable_block:e.store.isNavigableBlock()})}),[n,e.store]),A=(0,o.useCallback)((()=>{if(!x||!x.current)return;const t=r.findDOMNode(x.current);return(0,h.We)(e.store,t)}),[e.store]),R=(0,o.useCallback)((t=>{const o=A(),r=e.store.getTitleStore();r&&o&&u.Nh({environment:n,event:t,interactiveToken:o,store:r,canEdit:T})}),[T,n,A,e.store]),D=(0,o.useCallback)((t=>{const o=A(),r=e.store.getTitleStore();r&&o&&u.Zl({environment:n,event:t,interactiveToken:o,store:r,canEdit:T})}),[T,n,A,e.store]),E=(0,o.useCallback)((()=>{if(l){const t=(0,b.ZP)({store:e.store,pageVisitSource:s.tY.Create});l(t)}else d._({environment:n,store:e.store,visitType:v.vu.Link,pageVisitSource:s.tY.Create})}),[n,l,e.store]);(0,o.useEffect)((()=>()=>{p.qA(e.store.getTitleStore())}),[e.store]);const B=(0,a.VK)((()=>{const t=e.store.getCollectionViewSourceCollectionStore();return null==t?void 0:t.isSyncedCollection()}),[e.store]),F=(0,a.VK)((()=>e.store.isCollectionViewAlias()||e.store.recordStoreParentDiffersFromPersistedParent()),[e.store]);return(0,y.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"collection_view_page",getNode:()=>C.current,getBlockStore:()=>e.store,activate:E,handleCreated(){E(),w.Z.setKeyboardMode(!1)}})),[E,e.store]),(0,I.jsx)(m.p,{allowSelectionWithin:!1,onMouseOver:R,onMouseOut:D,children:(0,I.jsx)(f.Z,{ref:x,store:e.store,style:{...M,...e.style},isAlias:F,disabled:Boolean(e.disabled||B),onClick:P})}))}const x=o.memo(o.forwardRef(C),l.Z)},10906:(e,t,n)=>{n.d(t,{Bm:()=>Fe,Bs:()=>ue,Cc:()=>me,Ch:()=>ye,D:()=>he,D2:()=>ae,D8:()=>Q,HI:()=>G,Ks:()=>ce,L5:()=>be,Mq:()=>j,NG:()=>oe,NU:()=>te,PD:()=>K,PI:()=>H,Ql:()=>De,SY:()=>Te,Sc:()=>Ie,Se:()=>W,VM:()=>ie,Vv:()=>fe,XO:()=>_e,YG:()=>we,YL:()=>ve,_5:()=>de,az:()=>re,b1:()=>Be,bW:()=>Ee,bd:()=>ne,bu:()=>z,eD:()=>ge,en:()=>le,fk:()=>Ae,fm:()=>Pe,kr:()=>ke,mb:()=>xe,p1:()=>se,pB:()=>Ce,rD:()=>pe,v_:()=>Re,w0:()=>Se,wK:()=>ee,xy:()=>Y,zm:()=>$});n(57658),n(21703);var o=n(15145),r=n(41892),i=n(41432),a=n(99036),s=n(80951),l=n(43690),c=n(8848),d=n(93824),u=n(76837),p=n(95538),m=n(6695),f=n(72126),g=n(4615),h=n(71644),v=n(98963),b=n(21202),y=n(6287),_=n(13493),S=n(70203),w=n(9291),k=n(51592),I=n(35541),C=n(28020),x=n(4708),T=n(48543),M=n(84210),P=n(33929),A=n(50627),R=n(85957),D=n(17311),E=n(35328),B=n(58202),F=n(49427),O=n(24646),Z=n(80444),V=n(88923),U=n(79797),N=n(27724),L=n(51247);const j={showDelay:500,showHold:100},z=new Set(["gallery","list","calendar"]),q=(0,w.defineMessages)({addTypedItemTitle:{id:"collectionViewBlock.action.newItem.typedDatabaseTitle",defaultMessage:"New {singleItemName}"},addItemTitle:{id:"collectionViewBlock.action.newItem.nonTypedDatabaseTitle",defaultMessage:"New"}});function H(e){return"collectionTypedView"===e.contextType?P.default.formatMessage(q.addTypedItemTitle,{singleItemName:(0,k.sN)(e.databaseType)}):P.default.formatMessage(q.addItemTitle)}function W(e){const t=Object.keys(e);return t.find((t=>{const n=e[t];return Boolean(n&&"status"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"select"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"person"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"multi_select"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"relation"===n.type)}))}function K(e){const t=Object.keys(e);return t.find((t=>{const n=e[t];return Boolean(n&&"date"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"created_time"===n.type)}))||t.find((t=>{const n=e[t];return Boolean(n&&"last_edited_time"===n.type)}))}function G(e){return Object.keys(e).find((t=>{const n=e[t];return Boolean(n&&"date"===n.type)}))}function $(e){const{collectionId:t,schema:n,property:o,targetCollectionStore:r}=e,i=n[o];if(!i)return;const l={newSchema:{...n,[o]:void 0},deletedSchema:{[o]:n[o]}};if("relation"===i.type&&a.F0(i)&&i.property&&!(0,s.Kp)(i))if(a.F0(i)===t&&i.property!==o){const e={...l.newSchema,[i.property]:void 0},t={...l.deletedSchema,[i.property]:n[i.property]};l.newSchema=e,l.deletedSchema=t}else if(a.F0(i)!==t&&null!=r&&r.canEditCollection()&&r.isDefined()){const e=a.oC({id:r.id,schema:r.getSchema(),format:r.getFormat(),space_id:r.getSpaceId()}),t={...e,[i.property]:void 0},n={[i.property]:e[i.property]};l.otherCollectionId=r.id,l.otherCollectionSchema=t,l.otherCollectionDeletedSchema=n}return l}function Q(e){const{deletedSchema:t,property:n}=e;if(t[n])return{updateSchema:{[n]:t[n]},updateDeletedSchema:{[n]:null}}}async function Y(e){const{schema:t,properties:n,property:o,parentStore:r,spaceId:i}=e,s=t[o];if(!s)return;if(a.dx(s))return;const l=(0,h.ZP)(),c={...s,name:(0,u.nM)(s.name)},d=n.findIndex((e=>e.property===o)),p=n[d],m={property:l,visible:!0,width:p&&p.width},f=[...n];let b;if(f.splice(d+1,0,m),"button"===c.type&&c.automation_id){const e=U.Mz.createChildStore(r,{id:c.automation_id,spaceId:i,table:v.cv});await e.load();const t=e.getActionStores();await Promise.all(t.map((e=>e.load())));const n=(0,g.ZP)();c.automation_id=n,b={sourceAutomationStore:e,targetAutomationId:n}}return{newProperty:l,newPropertySchema:c,newProperties:f,automationUpdate:b}}function*X(e){const{rootStore:t,depth:n=0}=e;if(t.getType()===i.Ti.transclusionReference){const e=t.getTransclusionReferenceTargetStore();e&&(yield*X({rootStore:e,depth:n}))}else{const e=t.getContentStores();for(const t of e)yield{blockStore:t,depth:n},t.isNavigableBlock()||(0,E.BX)(t)||(yield*X({rootStore:t,depth:t.getType()===i.Ti.columnList||t.getType()===i.Ti.column||t.getType()===i.Ti.transclusionContainer||t.getType()===i.Ti.transclusionReference?n:n+1}))}}function J(e,t){const n={image:void 0,blocks:[],isDefined:!0},o=X({rootStore:e});let r=0,a=0;for(const{blockStore:s,depth:c}of o){if(r++,r>l.C7)return n;s.isDefined()||(n.isDefined=!1);const e=s.getType(),o=s.getModel();if(!e||!o)continue;const d=s.getProperties();if(o.isType(i.Ok)&&!n.image&&d){const t=(0,S.QaF)(d.source);if(t&&((0,p.SR)({url:t})||e===i.Ti.image))return n.image={pointer:{table:"block",id:s.id},url:t},n}const u=(0,i.nq)(e),m=o.isType(i.MV)&&(!s.isEmptyTitle()||u),f=t&&void 0!==(0,I.u)(s);(m||f)&&a<l.Uo&&(n.blocks.push({blockStore:s,depth:c}),u||a++)}return n}function ee(e,t){const{image:n,blocks:o,isDefined:r}=J(e,t);return n?{image:n,blockIds:[],isDefined:r}:{image:void 0,blockIds:o.map((e=>e.blockStore.id)),isDefined:r}}function te(e){const{rootStore:t,renderAdditionalBlocks:n,theme:o}=e;if(n&&t.isCollectionView())return{image:{url:"dark"===o?r.Z.images.blockRendererCovers.collectionTableDarkPng:r.Z.images.blockRendererCovers.collectionTableLightPng,pointer:{id:t.id,table:t.table,spaceId:t.getSpaceId()}},blockIds:[],isDefined:!0};const{image:a,blocks:s,isDefined:l}=J(t,n);if(a)return{image:a,blockIds:[],isDefined:l};return{image:void 0,blockIds:s.filter((e=>{const{blockStore:t,depth:n}=e;return 0===n&&t.getType()!==i.Ti.transclusionReference&&t.getType()!==i.Ti.transclusionContainer})).map((e=>e.blockStore.id)),isDefined:l}}function ne(e){const t=e.isFullScreen.state,n=e.collectionViewStore();if(!n)throw new Error("Collection view store not defined.");const o=e.normalizedFormatStore.state,r=n.isDefined()&&"board"===n.getType(),i=o.collection_group_by;if(!t||i){const e=m.rx(o.inline_collection_first_load_limit,Boolean(i));if("load_limit"===e.type)return e.limit}return r?20:t?50:20}function oe(e){const{collectionViewStore:t,isFullScreen:n,currentResultCount:o}=e;return t.isDefined()&&"board"===t.getType()?20:n||o<=50?50:100}function re(e,t){const n=e.collectionViewStore();if(!n)return!1;if("collectionVirtualView"===e.contextType)return!1;const o=n.getFormat();return!t||Boolean(o.collection_group_by)}function ie(e){const{collectionContextStore:t,isFullScreen:n,reducerResult:o}=e;return o&&o.blockIds.length>0&&!((r=o)&&!r.hasMore)&&re(t,n);var r}function ae(e){const{query:t,schema:n}=e,{timeline_by:o,timeline_by_end:r}=t;if(o){const e=n[o];if(e&&"date"!==e.type)return!1}if(r){const e=n[r];if(e&&"date"!==e.type)return!1}return!0}function se(e){const t=e.getParentBlockStore();return Boolean(t&&t.isLocked())}function le(e){return(0,R.wq)(e)}function ce(e){return V.default.isSidePeekOpen()&&!le(e)&&!e.isImmediateColumnChild()&&(e.isRootOrDirectChild()||"page"===e.getType())}function de(e){const t=e.getRecordStoreUIRoot();return!!(t&&t instanceof U.G)&&t.isFullWidth()}function ue(e){const{environment:t,isFullScreen:n,store:o,sizeObserver:r,viewType:i}=e,{device:a,WindowSizeStore:s}=t,l=o.isRootOrDirectChild(),c=!n&&!l,d=F.Z.isBlockInTemplate(o);if(c&&"gallery"===i)return{paddingLeft:1,paddingRight:1};if(l){if(le(o))return{paddingLeft:V.PeekModePadding.horizontal[V.default.state.mode],paddingRight:V.PeekModePadding.horizontal[V.default.state.mode]};if(a.isPhone)return{paddingLeft:s.getSafePaddingLeftPx((0,C.ui)(t)),paddingRight:s.getSafePaddingRightPx((0,C.ui)(t))};if(n)return{paddingLeft:96,paddingRight:96};if(!d&&!F.Z.isBlockInPageSnapshot(o)||F.Z.isBlockInWiki(o)){if(de(o)||function(e,t){const{WindowSizeStore:n}=e;return n.state.width-((0,O.Wk)(e)+(0,O.ll)(e,t)-(0,O.vJ)(e))<A.zL}(t,le(o))||ce(o)&&!V.default.isSidePeekClosing.state){const e=(0,C.ui)(t);return{paddingLeft:e,paddingRight:e}}{const e=r.rect.state.width;if(0===e)return;const n=(e-(A.zL-2*(0,C.ui)(t)))/2;return{paddingLeft:n,paddingRight:n}}}{const e=r.rect.state.width;if(0===e)return;const t=de(o)&&d?20+L.wN:20,n=Math.max((e-A.zL)/2,t);return{paddingLeft:n,paddingRight:n}}}return{paddingLeft:0,paddingRight:0}}function pe(e){switch(e){case"large":return D.Z.card.desktop.large.width;case"small":return D.Z.card.desktop.small.width;default:return D.Z.card.desktop.medium.width}}function me(e){let{collectionViewName:t,collectionViewType:n}=e;return t||P.default.formatMessage(Be[n])}function fe(e){var t;return((null===(t=e.getParentBlockStore())||void 0===t?void 0:t.getCollectionViewsStore().getValue())||[]).map((t=>U.Xr.createChildStore(e,{table:_.n,id:t}))).find((e=>"table"===e.getType()))}function ge(e){const{collectionStore:t,collectionViewBlockStore:n,checkNavigableAncestorLocked:o}=e;if(!n)return!1;if(o&&n.isNavigableAncestorLocked())return!1;const r=null==t?void 0:t.canEditCollection(),i=null==t?void 0:t.getParentBlockStore(),a=null==i?void 0:i.isLocked();return Boolean(r&&!a)}function he(e,t){const n=e.getType();if(!n)return!1;if(""===t)return!0;return-1!==me({collectionViewName:e.getName(),collectionViewType:n}).toUpperCase().indexOf(t.toUpperCase())}function ve(e){const{newOptions:t,collectionId:n,property:o,schema:r}=e,i=r[o];if(!i)return;if(!a.cu(i)&&"status"!==i.type)return;const s=i.options||[],l=[],c=f.xH(t),u=s.map((e=>e.value)),{beforeOps:p}=(0,d.q)(u,c);for(const[a,d]of Object.entries(p)){const e=s.find((e=>e.value===a));if(e)if(d){const t=s.find((e=>e.value===d));if(t){const r={pointer:{table:y.v,id:n},command:"keyedObjectListBefore",path:["schema",o,"options"],args:{value:e,before:{id:t.id}}};l.push(r)}}else{const t={pointer:{table:y.v,id:n},command:"keyedObjectListAfter",path:["schema",o,"options"],args:{value:e}};l.push(t)}}if("status"===i.type){const e=i.groups??[];for(const[r]of e.entries()){const e=t[r];if(!Array.isArray(e))return;const i=s.filter((t=>e.includes(t.value))).map((e=>e.id)),a={pointer:{table:y.v,id:n},command:"set",path:["schema",o,"groups",r,"optionIds"],args:i};l.push(a)}}return l.length>0?l:void 0}function be(e){const{collectionId:t,property:n,propertySchema:o,schema:r,isAscending:i}=e;return ve({newOptions:[...o.options||[]].map((e=>e.value)).sort(((e,t)=>e.localeCompare(t,void 0,{sensitivity:"base"})*(i?1:-1))),collectionId:t,property:n,schema:r})}function ye(e){const{collectionId:t,property:n,propertySchema:o,newOption:r,isAscending:i}=e,a=o.options||[],s=f.cx(a,(e=>e.value.localeCompare(r.value,void 0,{sensitivity:"base"})*(i?1:-1)>=0));return-1!==s?{pointer:{table:y.v,id:t},command:"keyedObjectListBefore",path:["schema",n,"options"],args:{value:r,before:a[s]}}:{pointer:{table:y.v,id:t},command:"keyedObjectListAfter",path:["schema",n,"options"],args:{value:r}}}function _e(e){const{viewType:t,format:n}=e;return"board"===t?m.Lw(n.board_cover):"gallery"===t?m.Lw(n.gallery_cover):"timeline"===t&&m.vP(Boolean(n.timeline_show_table),n.timeline_table_properties||[])}function Se(e){const{viewType:t}=e;return"table"===t||("board"===t||("gallery"===t||void 0))}function we(e){const t=null==e?void 0:e.getType();if(!e||!t)return!1;return"full_page"===(e.getFormat().collection_peek_mode||T.Ls[t])}function ke(e){const t=null==e?void 0:e.getType();return(null==e?void 0:e.getFormat().collection_peek_mode)??(t?T.Ls[t]:"side_peek")}function Ie(e){const{stores:t,phase:n}=N.default.state;return!(n===N.SelectionPhase.Selected&&t.indexOf(e)>=0)&&(V.default.state.open&&V.default.isSidePeekOpen()&&V.default.state.target.id===e.id)}function Ce(e,t){return e?{background:c.ZP.blueWithAlpha(.025),boxShadow:t.outlineUltraThinBlueInputBoxShadow,borderRadius:4}:{}}function xe(e){const{store:t,mainEditorCurrentBlockStore:n,collectionContextStore:r,fullyQualified:i,overridePeekMode:a,showMoveTo:s}=e,l=null==r?void 0:r.collectionViewStore();if(!a&&we(l))return(0,M.ZP)({store:t,fullyQualified:i,pageVisitSource:(null==r?void 0:r.getPageVisitSourceOverride())??o.tY.Expand,showMoveTo:s});if(n){const e=null==r?void 0:r.getViewType(),c=(null==r?void 0:r.normalizedFormatStore.state.collection_peek_mode)??(e?T.Ls[e]:void 0),d=a??(0,V.getPeekModeFromCollectionPeekModeFormat)(c);return(0,M.ZP)({store:n,collectionViewId:null!=r&&r.isFullScreen.state?null==l?void 0:l.id:void 0,fullyQualified:i,peekViewBlockId:t.id,peekMode:(0,V.getUrlParamFromPeekMode)(d),pageVisitSource:(null==r?void 0:r.getPageVisitSourceOverride())??o.tY.PeekOpen,showMoveTo:s})}}function Te(e){var t;const n=null===(t=e.getCollectionViewStores().find((e=>"page"===e.getType())))||void 0===t?void 0:t.getFormat().page_pointer;if(n)return U.G.createChildStore(e,{table:b.iU,id:null==n?void 0:n.id,spaceId:e.getSpaceId()})}function Me(e){const t=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return null==e?void 0:e.findRecordStoreUIAncestor((n=>n instanceof U.G&&n.isCollectionView()&&(t||n.id!==e.id))).ancestor}(e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]);if(t)return B.R.findCollectionViewBlockFromId(t.id)}function Pe(e){const t=Me(e,!(arguments.length>1&&void 0!==arguments[1])||arguments[1]);if(null!=t&&t.collectionContextStore)return t.collectionContextStore}function Ae(e){var t,n;let{environment:o,collectionContextStore:r}=e;const i=(0,x.zq)(o),{currentUserStore:a}=Z.default.state,s=Boolean(r.permissionScopes.state.canEditContent||"collectionTypedView"===r.contextType&&(null===(t=r.collectionViewBlockStore())||void 0===t?void 0:t.canEdit()));return!!a&&i&&s&&"table"===(null===(n=r.collectionViewStore())||void 0===n?void 0:n.getType())&&!r.isCompactView.state}function Re(e,t){let n=t;return e.every((e=>{if(e.getType()===i.Ti.page||e.getType()===i.Ti.collectionViewPage){var t;const o=null===(t=Me(e,!1))||void 0===t?void 0:t.props.store.id;return!!o&&(void 0===n&&(n=o),o===n)}return!1}))}function De(e){return void 0!==e&&e>=0}function Ee(e){return void 0!==e?e+1:0}const Be=(0,w.defineMessages)({board:{id:"database.collectionView.untitledName.board",defaultMessage:"Board"},gallery:{id:"database.collectionView.untitledName.gallery",defaultMessage:"Gallery"},timeline:{id:"database.collectionView.untitledName.timeline",defaultMessage:"Timeline"},calendar:{id:"database.collectionView.untitledName.calendar",defaultMessage:"Calendar"},list:{id:"database.collectionView.untitledName.list",defaultMessage:"List"},table:{id:"database.collectionView.untitledName.table",defaultMessage:"Table"},page:{id:"database.collectionView.untitledName.page",defaultMessage:"Page"},chart:{id:"database.collectionView.untitledName.chart",defaultMessage:"Chart"}});function Fe(e){let{store:t,collectionContextStore:n}=e;return"collectionVirtualView"===n.contextType?n.collectionStore():t.getAssociatedCollectionStore()}},17707:(e,t,n)=>{n.d(t,{AM:()=>K,DF:()=>R,DX:()=>F,Gu:()=>E,Ri:()=>H,T4:()=>V,Xi:()=>Z,Y0:()=>W,YF:()=>D,Zo:()=>j,bh:()=>O,cj:()=>N,qf:()=>B,tR:()=>U});n(57658);var o=n(1302),r=n(22491),i=n(72126),a=n(4615),s=n(70279),l=n(23867),c=n(70203),d=n(63143),u=n(85344),p=n(54564),m=n(31781),f=n(94419),g=n(9953),h=n(61045),v=n(3898),b=n(993),y=n(82530),_=n(53471),S=n(28020),w=n(65598),k=n(77546),I=n(89224),C=n(46351),x=n(95802),T=n(24229),M=n(56681),P=n(79797),A=n(92120);function R(e){var t;const{environment:n,store:o,text:r,files:i,transaction:a,discussionLocation:s}=e,{filesToCreate:l,fileStoresToDelete:c}=function(e,t){const n=[],o=new Set;t.forEach((e=>{"local"===e.type?n.push(e.file):o.add(e.id)}));const r=w.le(e),i=r.filter((e=>e.getAlive()&&!o.has(e.id)));return{filesToCreate:n,fileStoresToDelete:i}}(o,i);j({commentStore:o,fileBlocks:c,transaction:a}),q({commentStore:o,files:l,environment:n,transaction:a});const d=w.zP(o);g.sO({store:d,value:r,transaction:a}),z(o,a),u.zd(n,{from:s,comment_id:o.id,discussion_id:o.getParentId(),parent_block_id:null===(t=o.getParentStore())||void 0===t?void 0:t.getParentId()})}function D(e){const{environment:t,commentStore:n,transaction:o}=e,r=w.GP(n);if(!r)return;const i=w.ak(r),a=i.getValue();if(!a)return;j({commentStore:n,fileBlocks:w.le(n),transaction:o}),g.sW({store:n,transaction:o,data:{alive:!1}}),y.applyOperation({store:i,operation:{pointer:i.pointer,path:i.path,command:"listRemove",args:{id:n.id}},transaction:o}),(0===a.length||1===a.length&&a[0]===n.id)&&function(e){const{discussionStore:t,transaction:n}=e,o=w.HK(t);o&&E({discussionStore:t,transaction:n,blockStore:o});const r=S.RM();if(r){const e=w.MI({blockStore:r,traverseTransclusionReferences:!0});for(const r of e){if(o&&r.table===o.table&&r.id===o.id)continue;const e=w.x8(r).getValue();null!=e&&e.includes(t.id)&&E({discussionStore:t,transaction:n,blockStore:r})}}}({discussionStore:r,transaction:o}),z(n,o),u.k$(t,{from:e.discussionLocation,discussion_id:r.id,comment_id:n.id,parent_block_id:r.getParentId()})}function E(e){const{discussionStore:t,blockStore:n,transaction:o}=e;B({blockStore:n,discussionIds:[t.id],transaction:o}),function(e){const{store:t,transaction:n,discussionId:o}=e,r=["m",o],i=c.c14(r);b.ST({environment:t.environment,store:t.getBlockTitleStore(),selection:{startIndex:0,endIndex:1/0},annotationTypeOrKey:i,transaction:n,updateSelection:!1});for(const a of Object.keys(t.getProperties())){if("tite"===a)continue;const e=t.getPropertyStore(a);b.ST({environment:t.environment,store:e,selection:{startIndex:0,endIndex:1/0},annotationTypeOrKey:i,transaction:n,updateSelection:!1})}}({store:n,discussionId:t.id,transaction:o})}function B(e){const{blockStore:t,discussionIds:n,transaction:o}=e,r=w.x8(t);for(const i of n)y.applyOperation({store:r,operation:{pointer:r.pointer,path:r.path,command:"listRemove",args:{id:i}},transaction:o})}function F(e){var t;const{environment:n,commentStore:o,discussionStore:r,transaction:i}=e;if(T.Z.state.open){var a;const e=null===(a=T.Z.state.discussionIds)||void 0===a?void 0:a.filter((e=>e!==r.id));T.Z.setState({...T.Z.state,discussionIds:e,open:((null==e?void 0:e.length)||0)>0})}g.sW({store:r,data:{resolved:!0},transaction:i}),A.Z.setState({...A.Z.state,discussionIds:(null===(t=A.Z.state)||void 0===t||null===(t=t.discussionIds)||void 0===t?void 0:t.filter((e=>e!==r.id)))||[]}),u.hJ(n,{comment_id:o.id,discussion_id:r.id,parent_block_id:r.getParentId(),from:e.discussionLocation})}function O(e){const{environment:t,commentStore:n,discussionStore:o,transaction:r}=e;g.sW({store:o,data:{resolved:!1},transaction:r}),u.SU(t,{comment_id:n.id,discussion_id:o.id,from:e.discussionLocation,parent_block_id:o.getParentId()})}function Z(e){const{environment:t,discussionStore:n,textValue:o,transaction:r,files:a}=e,{id:s}=t.currentUser;if(!s)return;const l=_.dm(a);if(i.Xy(o,[])&&0===l.length)return;const c=L({discussionStore:n,text:o,files:l,environment:t,transaction:r});u.d2(t,{from:e.discussionLocation,comment_id:c.id,discussion_id:n.id,parent_block_id:n.getParentId()})}function V(e){const t=C.Z.find((t=>t.getStore().id===e&&!t.isSidebarFormat()&&!t.isMarginFormat()));if(t){const e=t.getNode();if(e&&e.parentElement){const t=Array.from(e.parentElement.children).indexOf(e);k.Wr(e,{edgeDist:0===t?0:-1,animate:!1})}}}function U(e){const{transaction:t,blockStore:n,discussionId:o}=e,r=w.x8(n);y.applyOperation({store:r,operation:{pointer:r.pointer,path:r.path,command:"listAfter",args:{id:o}},transaction:t})}function N(e){const{context:t,blockStore:n,environment:o,transaction:r,commentTextValue:i,files:s,discussionId:c=(0,a.ZP)()}=e,d=g.ae({environment:o,table:"discussion",value:{id:c,type:"default",parent_id:n.id,parent_table:n.table,resolved:!1,context:t,space_id:(0,l.C)(n.pointer.spaceId)},inMemoryRecordCache:n.inMemoryRecordCache,transaction:r});U({transaction:r,blockStore:n,discussionId:d.id});return{discussionStore:d,commentStore:L({discussionStore:d,text:i,files:s,environment:o,transaction:r})}}function L(e){const{discussionStore:t,files:n,text:o,environment:r,transaction:i}=e,a=g.Ue({environment:r,table:s.x_,args:{parent:t.pointer},inMemoryRecordCache:t.inMemoryRecordCache,transaction:i}),l=w.ak(t);f.R3({parent:l,append:a,transaction:i});const c=w.zP(a);return g.sO({store:c,value:o,transaction:i}),q({commentStore:a,files:n,environment:r,transaction:i}),z(a,i),a}function j(e){const{commentStore:t,fileBlocks:n,transaction:o}=e,r=w.ig(t);n.forEach((e=>{g.sW({store:e,data:{alive:!1},transaction:o}),f.Od({parent:r,childToRemove:e,transaction:o})}))}function z(e,t){const n=w.bQ(e);g.sO({store:n,value:(0,d.ud)(Date.now()),transaction:t})}function q(e){const{environment:t,files:n,commentStore:o,transaction:r}=e,i=S.qQ(t),a=w.ig(o);m.z({files:n,environment:t,inMemoryRecordCache:o.inMemoryRecordCache,transaction:r,pageWidth:i,ignoreOversizedFiles:!0,spaceId:a.pointer.spaceId,useCrdt:!1}).forEach((e=>{f.R3({parent:a,append:e,transaction:r})}))}async function H(e){var t;let{discussionStore:n,currentBlockStore:i,environment:a,analyticsFrom:s,currentEl:l}=e;if(!i)return null;if(!n.isDefined())return;function c(e){const t=function(e){var t;let n,{discussionId:o,blockId:i}=e;const a=null===(t=document.getElementsByClassName(`${(0,r.dk)({discussionId:o})}`))||void 0===t?void 0:t[0];a&&(n=x.C.findSelectableFromChildNode(a)),n||(n=x.C.findScrollToSelectablesFromIds([i])[0]);return n}({discussionId:n.id,blockId:e});if(!t)return;const o=document.getElementsByClassName(`discussion-id-${n.id}`)[0];return o?h.bx({element:o,scrollers:{verticalScroller:t.getContextVerticalScroller(),horizontalScroller:t.getContextHorizontalScroller()},vertical:{reveal:"top"},horizontal:{reveal:"closest"},animate:!0}):h.NQ({component:t,vertical:{reveal:"top"},horizontal:{reveal:"closest"},animate:!0}),t.displaySelectionHalo(750),t}const d=(null===(t=n.getRecordStoreUIParent())||void 0===t?void 0:t.id)??n.getParentId();c(d)||(await v.Nz(i,[d]),await o.default.afterNextFlush(),c(d));const u=P.G.createChildStore(i,n.getParentPointer()),m=I.get(),f=null==m?void 0:m.commonAncestorContainer,g=!(null!=m&&m.collapsed)&&f&&(l===f||(null==l?void 0:l.contains(f)));p.Ib({environment:a,blockStore:u||i,analyticsFrom:s,discussionIds:[n.id],shouldFocusDiscussion:!g,recursivelyLoadAllDiscussions:!1})}function W(e){e!==M.Z.state.pageId&&M.Z.reset()}function K(e){const t={};e.forEach((e=>{t[e]=Date.now()})),M.Z.setState({...M.Z.state,lastInteractionTimes:t})}},18821:(e,t,n)=>{n.d(t,{Cd:()=>A,WD:()=>M,ZL:()=>D,i8:()=>R,uK:()=>B,yw:()=>P});n(57658);var o=n(1302),r=n(41432),i=n(4615),a=n(21202),s=n(23867),l=n(70203),c=n(9291),d=n(85344),u=n(47307),p=n(56863),m=n(24677),f=n(993),g=n(98104),h=n(82530),v=n(53471),b=n(33929),y=n(45162),_=n(89224),S=n(58202),w=n(79797),k=n(34047),I=n(82994),C=n(48514),x=n(17707);const T=(0,c.defineMessages)({discardCommentConfirmationPrompt:{id:"newDiscussionMenu.discardCommentConfirmationDialog.prompt",defaultMessage:"Do you want to discard the comment?"},discardCommentButtonLabel:{id:"newDiscussionMenu.discardCommentConfirmationDialog.discardButton.label",defaultMessage:"Discard"}});async function M(e){const{environment:t,blockStore:n,multiSelection:o,rect:r}=e;let i=r;if(!i){const e=_.get();if(!e)return;i=_.getRect(e)}if(!i)return;const a=i.width,l=i.height,c=i.right-a,u=new I.Z(t,(0,s.C)(n.pointer.spaceId));C.Z.setState({open:!0,rect:new DOMRect(c,i.top,a,l),type:"inline",blockStore:n,multiSelection:o,discussionInputStore:u}),p.w(),await E(u,t),d.$5(t)}async function P(e){const{environment:t,blockStore:n}=e,o=S.R.getRect(n);if(!o)return;const r=new I.Z(t,(0,s.C)(n.pointer.spaceId)),i=o.width,a=o.height,l=o.right-i;C.Z.setState({open:!0,rect:new DOMRect(l,o.top,i,a),type:"block",blockStore:n,discussionInputStore:r}),await E(r,t),d.yr(t)}function A(e){const t=C.Z.state;t.open&&C.Z.setState({open:!1,rect:t.rect})}function R(e){const{environment:t,blockStore:n,commentTextValue:o,transaction:i,files:a}=e,{id:s}=t.currentUser;if(!s)return;let c;const u=n.getType();if(u&&(0,r.XD)(u)&&!(0,r.S9)(u)){const e=n.getTitleValue();c=l.O1u(l.OAI(e))}const{discussionStore:p,commentStore:m}=x.cj({context:c,blockStore:n,environment:t,transaction:i,commentTextValue:o,files:v.dm(a)});return d.bR(t,{discussion_id:p.id,comment_id:m.id,parent_block_id:p.getParentId()}),p}function D(e){const t=C.Z.state;if(t.open){const n=t.discussionInputStore.state.textStore.getValue(),o=t.discussionInputStore.state.files;(n&&n.length>0||o.length>0)&&("inline"===t.type?h.createAndCommit({userAction:"newDiscussionMenuActions.submitNewDiscussion",environment:e,perform:s=>{!function(e){const{environment:t,multiSelection:n,commentTextValue:o,transaction:s,files:c}=e,{id:u}=t.currentUser;if(!u)return;const p=(0,i.ZP)(),m=(0,y.L5)(n).filter((e=>{let{store:t}=e;return t.table===a.iU}));if(0===m.length)return;const g=m[0].store.getRecordStoreAtRootPath(),h=[],b=new Set;m.forEach(((e,n)=>{let{store:o,selection:i}=e;b.add(o.id);const a=o.getRecordStoreAtRootPath();if(!(a instanceof w.G))return;const c=a.getType(),d=a.getFormat();if(c&&(0,r._T)(c,d))return;let u=o.getValue();const m=l.Ulv(u,i);f.i8({environment:t,store:o,selection:m,annotation:[l.GKr.Discussion,p],transaction:s}),u=o.getValue();const g=l.KU1(u,m.startIndex,m.endIndex),v=0===n?[]:[l.V3y("\n")];h.push(...v,...g),n>0&&x.tR({blockStore:a,discussionId:p,transaction:s})}));const _=(0,y.tp)({multiSelection:n,filterCommonAncestors:!1,focus:void 0});if(_)for(const i of _.stores){if(b.has(i.id))continue;const e=i.getType(),t=i.getFormat();e&&(0,r._T)(e,t)||x.tR({blockStore:i,discussionId:p,transaction:s})}const{discussionStore:S,commentStore:k}=x.cj({context:h,blockStore:g,environment:t,transaction:s,commentTextValue:o,files:v.dm(c),discussionId:p});d.x6(t,{discussion_id:S.id,comment_id:k.id,parent_block_id:S.getParentId()})}({environment:e,multiSelection:t.multiSelection,commentTextValue:n||[],files:o,transaction:s})},skipUpdatingEditedMetadata:!0}):"block"===t.type&&h.createAndCommit({userAction:"newDiscussionMenuActions.submitNewDiscussion",environment:e,perform:r=>{R({environment:e,blockStore:t.blockStore,commentTextValue:n||[],files:o,transaction:r})},skipUpdatingEditedMetadata:!0})),A()}}async function E(e,t){await o.default.afterNextFlush(),m.ZH(t),g.N_({store:e.state.textStore})}function B(e,t){(0,k.hu)(e)?(d.lL(t),u.showDialog({message:b.default.formatMessage(T.discardCommentConfirmationPrompt),showCancel:!0,handleCancel:()=>d.jX(t),keepFocus:!0,items:[{label:b.default.formatMessage(T.discardCommentButtonLabel),color:"red",onAccept:()=>{d.Yz(t),A()}}]})):A()}},95306:(e,t,n)=>{n.d(t,{Cd:()=>m,UZ:()=>p,oK:()=>u});var o=n(1302),r=n(29477),i=n(23867),a=n(85344),s=n(24677),l=n(98104),c=n(82994),d=n(9080);async function u(e){const{environment:t,discussionStore:n,rect:u,blockStore:p,discussionLocation:m,activityId:f,notificationId:g}=e,h=new c.Z(t,(0,i.C)(p.pointer.spaceId));d.Z.setState({open:!0,rect:u,discussionStore:n,discussionInputStore:h,blockStore:p,discussionLocation:m,activityId:f,notificationId:g}),s.ZH(t),await o.default.afterNextFlush(),await(0,r.Vs)(10),l.NX({store:h.state.textStore}),a.Je({environment:t,from:m,activityId:f,notificationId:g})}function p(e){const t=d.Z.state;if(t.open){const{discussionLocation:n,activityId:o,notificationId:r}=t;d.Z.setState({open:!1,rect:t.rect}),s.ZH(e),a.Rn({environment:e,from:n,activityId:o,notificationId:r})}}function m(e){const t=d.Z.state;if(t.open){0===t.discussionStore.getComments().length&&p(e)}}},25487:(e,t,n)=>{n.r(t),n.d(t,{DiscussionIndicatorFormat:()=>b,default:()=>_});n(67294);var o=n(60177),r=n(64338),i=n(480),a=n(86628),s=n(24405),l=n(95855),c=n(82990),d=n(54564),u=n(24677),p=n(68709),m=n(73063),f=n(28020),g=n(65598),h=n(24229),v=n(85893);let b=function(e){return e[e.PushContent=0]="PushContent",e[e.FloatRight=1]="FloatRight",e}({});function y(e){return e.format===b.FloatRight?(0,v.jsx)(p.p,{allowSelectionWithin:!1,style:{width:0,height:0},children:e.children}):(0,v.jsx)(v.Fragment,{children:e.children})}const _=function(e){window.__c={n:"DiscussionIndicator"};const t=(0,i.O7)(),n=(0,o.Dl)();(0,r.q7)(null==n?void 0:n.domLock);const{store:p,recursivelyLoadAllDiscussions:b,onlyCountBlockLevelDiscussions:_}=e,S=(0,a.VK)((()=>{const e=g.vV(p,{recursivelyLoadAllDiscussions:b,onlyIncludeBlockLevelDiscussions:_});if(0===e.length)return{numberOfComments:0,discussionIsSelected:!1};const t=new Set(e.map((e=>e.id))),n=h.Z.getFramePageFirstSelectedDiscussionId(),o=n&&t.has(n),r=f.RM();if(r){const e=g.MI({blockStore:r,traverseTransclusionReferences:!0}),n=e.indexOf(p),o=new Set(t);for(let r=n-1;r>=0;r--){const n=e[r],i=g.vV(n,{recursivelyLoadAllDiscussions:!1,excludeSelf:!1,onlyIncludeBlockLevelDiscussions:!1,includeLoadingDiscussions:!0}).map((e=>e.id));for(const e of o)i.includes(e)?t.delete(e):o.delete(e);if(0===t.size)return{numberOfComments:0,discussionIsSelected:!1};if(0===o.size)break}}return{numberOfComments:g.Xp(p,{recursivelyLoadAllDiscussions:b,onlyIncludeBlockLevelDiscussions:_}),discussionIsSelected:o}}),[_,b,p]),{numberOfComments:w,discussionIsSelected:k}=S,I=(0,s.yK)((e=>({speechBubble:{position:"relative",alignSelf:"flex-start",marginLeft:4,marginTop:3,background:k?e.selectLightGray[100]:void 0},commentCount:{marginLeft:2,color:e.lightTextColor,fontWeight:c.Z.fontWeight.semibold}})),[k]);return 0===w?null:(0,v.jsx)(y,{format:e.getFormat(),children:(0,v.jsx)(m.Z,{icon:l.z,style:I.speechBubble,onClick:()=>{u.ZH(t),d.Ib({environment:t,blockStore:e.store,analyticsFrom:"discussion_indicator",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:e.recursivelyLoadAllDiscussions})},caption:(0,v.jsx)("span",{style:I.commentCount,children:w>9?"9+":w})})})}},34047:(e,t,n)=>{n.d(t,{DF:()=>g,De:()=>v,Je:()=>P,KL:()=>x,NI:()=>y,O2:()=>d,QT:()=>f,Qg:()=>u,W5:()=>C,ad:()=>T,hu:()=>I,n9:()=>k,p9:()=>M,sS:()=>A,uC:()=>w});var o=n(72126),r=n(70279),i=n(70203),a=n(97880),s=n(65598),l=n(79797);const c=n(60809);let d=function(e){return e[e.Menu=0]="Menu",e[e.Page=1]="Page",e[e.Sidebar=2]="Sidebar",e[e.Margin=3]="Margin",e[e.Unfurl=4]="Unfurl",e}({});function u(e){let{recordStore:t,currentUserId:n}=e;return S({recordStore:t,currentUserId:n})||y(t)[0]}const p=6,m=3;function f(e){return e>1?m:p}function g(e){let{blockStore:t,ignoreAfterTime:n,currentUserId:o}=e;if(!t)return[];return s.al(t,{recursivelyLoadAllDiscussions:!0,includeLoadingDiscussions:!0}).sort(((e,t)=>{const n=u({recordStore:e,currentUserId:o}),r=u({recordStore:t,currentUserId:o});return null!=n&&n.isDefined()?null!=r&&r.isDefined()?-(n.getCreatedTime()-r.getCreatedTime()):1:-1}))}const h=e=>0===i.llS(e).length;function v(e){if(!e.isDefined())return!1;const t=e.getContext();if(!t)return!0;const n=i.VP_(t,(t=>!i.xw5(t)||i.h19(t)===e.id));return h(n)}function b(e,t){return e&&e.isDefined()?t&&t.isDefined()?e.getCreatedTime()-t.getCreatedTime():1:-1}function y(e){return s.D4(e).sort(((e,t)=>b(e,t)))}function _(e){return S({recordStore:e,currentUserId:void 0})}function S(e){let{recordStore:t,currentUserId:n}=e;const o=s.D4(t).filter((e=>e.isDefined()&&e.getCreatedById()!==n)).sort(((e,t)=>b(e,t)));return o[o.length-1]}function w(e){return e.sort(((e,t)=>b(_(e),_(t))))}function k(e){const t=e.state.textStore.getValue(),n=(e.state.files??[]).length>0,o=t&&t.length>0;return!n&&!o}function I(e,t){const n=e.state.textStore.getValue(),r=e.state.files;if(!t)return n&&0!==n.length||r&&r.length>0;const i=s.zP(t).getValue();return!o.Xy(i,n)||function(e,t){const n=e.state.files,o=s.le(t);if(o.length!==n.length)return!0;return o.some(((e,t)=>e.id!==n[t].id))}(e,t)}function C(e){if(e.some((e=>!e.isReady())))return!0;return!!e.map((e=>s.D4(e))).flat().some((e=>!e.isReady()||!e.getCreatedTime()))}function x(e){const t=s.ak(e),n=t.getValue()||[];if(0===n.length)return;const o=n[0];return l.t1.createChildStore(t,{table:r.x_,id:o,spaceId:t.pointer.spaceId}).getCreatedTime()}function T(e){switch(e){case"block_menu":case"reply_menu_mentions_comments":case"reply_menu_all_updates":case"reply_menu_archive":case"reply_menu_updates_sidebar":case"updates_menu_mentions_comments":case"updates_menu_all_updates":case"updates_menu_archive":return d.Menu;case"page_discussion":return d.Page;case"updates_sidebar":return d.Sidebar;case"margin_comments":return d.Margin;case"comment_unfurl":return d.Unfurl;default:(0,a.t1)(e)}}function M(e){var t;if(e.length>1)return!1;const n=e[0];if(!n.length)return!1;const o=n[0].trim(),r=c();return(null===(t=o.match(r))||void 0===t?void 0:t.join(""))===o}const P={updates_menu_all_updates:28,updates_menu_mentions_comments:28,updates_menu_archive:28,block_menu:20,reply_menu_all_updates:20,reply_menu_mentions_comments:20,reply_menu_archive:20,reply_menu_updates_sidebar:20,page_discussion:20,updates_sidebar:23,margin_comments:20,comment_unfurl:32};function A(e){return((null==e?void 0:e.match(/[0-9.]+|[a-z]+/gi))??[]).join(" ")}},92650:(e,t,n)=>{n.d(t,{fS:()=>U,QB:()=>Z,Z:()=>L,Vs:()=>B,wo:()=>R,az:()=>G,oS:()=>W,H0:()=>Y,ui:()=>H,gC:()=>q,fg:()=>$,EM:()=>K});n(57658);var o=n(18466),r=n(14577),i=n(41432),a=n(22491),s=n(72126),l=n(21202),c=n(97880),d=n(10906),u=n(43250),p=n(11599),m=n(65598),f=n(41549),g=n(58202),h=n(49427),v=n(95802),b=n(24646),y=n(15723),_=n(80444),S=n(17903),w=n(88923),k=n(79797),I=n(49085),C=n(92595);class x extends I.default{getInitialState(){return{visible:!0}}}const T=new x;(0,C.exposeDebugValue)("MarginCommentsStore",T);const M=T;var P=n(48514),A=n(34047);const R=10,D=10,E="temp-margin-comment-discussion",B=50,F=`.${u.x9t} .notion-collection_view-block`,O=`.${u.OE$}`,Z=372,V=10,U=16,N=1150,L=Z-4*U,j=1500,z=1600;function q(e,t,n){const o=H(e,t);return o>=j||n&&!w.default.isSidePeekClosing.state||t?0:(j-o)/2}function H(e,t){return t&&w.default.isSidePeekOpen()?(0,b.vJ)(e):e.WindowSizeStore.state.width-(0,b.Wk)(e)-(0,b.vJ)(e)-f.VV()}function W(e,t,n){return(H(e,t)-z)/2+2*U+q(e,t,n)}const K=new r.Z((()=>{var e;let t=_.default.state.mainEditorCurrentBlockStore;return null!==(e=t)&&void 0!==e&&e.isCollectionView()&&(t=(0,d.SY)(t)||t),t?(0,m.vV)(t,{recursivelyLoadAllDiscussions:!0,excludeSelf:!0}):[]}),{debugName:"mainEditorBlockUnresolvedDiscussionStore"});function G(e,t){const n=M.state.visible;return Boolean(!e.device.isMobile&&H(e,(0,d.en)(t))>=N&&n&&!(0,b.Sx)(e)&&!w.default.isSidePeekOpen()&&h.Z.isBlockInFrame(t)&&(0,p.A$)("margin_comments","inline"))}function $(e,t){const n=K.state.length>0,o=P.Z.state.open&&P.Z.state.rect;return Boolean(G(e,t)&&(n||o))}function Q(e,t){return e.offsetTop!==t.offsetTop?e.offsetTop<t.offsetTop?-1:1:e.createdTimeMs&&t.createdTimeMs&&e.createdTimeMs!==t.createdTimeMs?e.createdTimeMs<t.createdTimeMs?-1:1:e.id<t.id?-1:1}const Y=(0,s.Ds)((function(e){let{discussionStores:t,pageContentStores:n,marginDiscussionItemRefs:r,selectedDiscussionId:s,newMarginDiscussionArgs:d,marginContainerElement:p,pageViewBlockElement:m,onComputeComplete:f,computedOnce:h,prevSelectedDiscussionId:b,isFullWidth:_,topbarHeight:w,windowHeight:I,previousDiscussionElements:C}=e;const x=new Map;let T=0,M=0;if(!p||!m)return;if(0===t.length&&!d)return;const P=o.Z.withListenerIgnored((()=>S.Z.state.scrollTop)),R=p.getBoundingClientRect(),B=X({currentScrollTop:P,rect:R});let Z=function(e){const t=new Map,n=[];return e.forEach((e=>{if(e.shouldGroup){const n=t.get(e.parentBlockStore.id)||[];n.push(e),t.set(e.parentBlockStore.id,n)}else n.push(e)})),t.forEach((e=>{n.push({offsetTop:e[0].offsetTop,groupedDiscussionsData:e,parentBlockStore:e[0].parentBlockStore,type:"grouped",id:e[0].id,createdTimeMs:e[0].createdTimeMs})})),n}(t.map((e=>function(e){let{discussionStore:t,currentScrollTop:n,topbarHeight:o,windowHeight:r,pageViewBlockElement:i,previousDiscussionElements:s,currentDiscussionElements:c,selectedDiscussionId:d}=e;const u=t.id,p=function(e){const{topbarHeight:t,windowHeight:n,pageViewBlockElement:o,discussionId:r,previousDiscussionElements:i,currentDiscussionElements:s,selectedDiscussionId:l}=e,c=o.getElementsByClassName((0,a.dk)({discussionId:r})),d=e=>(s.set(r,e),e);if(c.length>0){if(l===r){let e;for(let o=0;o<c.length;o++){const r=c[o];if(r instanceof HTMLElement){const o=r.getBoundingClientRect();if(o.bottom<t||o.top>n){if(e)return d(e)}else{if(o.top>t)return d(r);e=r}}}}const e=i.get(r);return e&&Array.from(c).includes(e)?d(e):d(c[0])}}({topbarHeight:o,windowHeight:r,pageViewBlockElement:i,discussionId:u,previousDiscussionElements:s,currentDiscussionElements:c,selectedDiscussionId:d}),m=t.recordStoreUIParentStore;if(!(m&&m.id&&m.table===l.iU&&m instanceof k.G))return;if(!m.isReady())return;const f={offsetTop:0,discussionStore:t,parentBlockStore:m,type:"existing",id:t.id,createdTimeMs:(0,A.KL)(t)};if(p instanceof HTMLElement)return f.offsetTop=X({rect:p.getBoundingClientRect(),currentScrollTop:n}),f;const g=v.C.findNodeFromStore(m);if(g instanceof HTMLElement)return f.offsetTop=X({rect:g.getBoundingClientRect(),currentScrollTop:n}),f;const{node:h,blockStore:b}=function(e){let t=e.getParentBlockStore();for(;t;){const e=t.getParentBlockStore();if(!e)return{};const n=v.C.findNodeFromBlockId(t.id);if(n)return{node:n,blockStore:t};t=e}return{}}(m);if(h instanceof HTMLElement&&b)return f.offsetTop=X({rect:h.getBoundingClientRect(),currentScrollTop:n})+V,f.parentBlockStore=b,f.shouldGroup=!0,f.closestVisibleParentId=b.id,f}({discussionStore:e,currentScrollTop:P,topbarHeight:w,windowHeight:I,pageViewBlockElement:m,previousDiscussionElements:C,currentDiscussionElements:x,selectedDiscussionId:s}))).filter(c.$K));const U=d&&function(e){var t;let n,{blockStore:o,discussionInputStore:r,currentScrollTop:i,pageViewBlockElement:a}=e;const s=null===(t=a.getElementsByClassName(u.dXl))||void 0===t?void 0:t[0];n=s instanceof HTMLElement?s.getBoundingClientRect():g.R.getRect(o);if(!n)return;return{offsetTop:X({rect:n,currentScrollTop:i}),parentBlockStore:o,discussionInputStore:r,type:"new",id:E,createdTimeMs:Date.now()}}({...d,currentScrollTop:P,pageViewBlockElement:m}),N=U?U.id:s;let L;U&&Z.push(U);const j=N||b?void 0:function(e){let{pageContentStores:t,currentScrollTop:n,marginContainerRect:o,isFullWidth:r}=e;return t.map((e=>{const t=e.getType();if(!t)return;let n;var a;if((0,c.qg)(i.Ok,t)||"column_list"===t)n=null===(a=v.C.findSelectableFromStore(e))||void 0===a||null===(a=a.getNode())||void 0===a?void 0:a.getBoundingClientRect();else if(t===i.Ti.table){var s,l;const t=null===(s=v.C.findSelectableFromStore(e))||void 0===s?void 0:s.getNode(),o=null==t?void 0:t.getBoundingClientRect(),i=null==t||null===(l=t.querySelector(O))||void 0===l?void 0:l.getBoundingClientRect();n=r?o:o&&i?o.width<i.width?o:i:o||i}else if(e.isInlineCollectionView()){var d,u;const t=null===(d=v.C.findSelectableFromStore(e))||void 0===d?void 0:d.getNode();n=r?null==t?void 0:t.getBoundingClientRect():null==t||null===(u=t.querySelector(F))||void 0===u?void 0:u.getBoundingClientRect()}return n&&n.right>o.left?n:void 0})).filter(c.$K).map((e=>{const t=X({rect:e,currentScrollTop:n});return new DOMRect(e.left,t,e.width,e.height)}))}({pageContentStores:n,currentScrollTop:P,marginContainerRect:R,isFullWidth:_}).sort((e=>-e.top));Z=Z.sort(Q).map(((e,t)=>{e.offsetTop-B>=18&&(e.offsetTop-=18);const n=e.id,o=r.get(e.id);if(!o)return"new"===e.type||h||(e.offsetTop=-9999,e.hide=!0),e;const i=o.getBoundingClientRect(),a=i.height;let s=e.offsetTop;return s<=T&&(s=T),j&&(s=function(e,t){const n={x:e.x,y:e.y,width:e.width,height:e.height,top:e.top,left:e.left,bottom:e.bottom,right:e.right};let o=t[t.length-1];for(;o;)if((0,y.dQ)(n,o))n.top=o.bottom+D,n.bottom=n.top+n.height,t.pop(),o=t[t.length-1];else{if(n.bottom<o.top)return n.top;t.pop(),o=t[t.length-1]}return n.top}(new DOMRect(i.left,s,i.width,i.height),j)),n===N&&0===M&&(M+=s-e.offsetTop,e.selected=!0,L=t),e.offsetTop=s,e.height=a,T=e.offsetTop+a,e}));const z=Z.map((e=>(e.offsetTop=e.offsetTop-B,e)));let q;if(M>0&&void 0!==L)for(let o=L;o>=0;o--){const e=z[o];if(e.height){if(e.id===N)e.offsetTop-=M;else{if(!(q&&q.offsetTop<=e.offsetTop+e.height))break;e.offsetTop-=M}q=e}}f({data:z,hasNewDiscussion:Boolean(U),selectedDiscussion:s},x)}),100);function X(e){let{rect:t,currentScrollTop:n}=e;return t.top+n}},92120:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),r=n(92595);class i extends o.default{getInitialState(){}getFirstSelectedDiscussionId(){var e;return null===(e=this.state)||void 0===e||null===(e=e.discussionIds)||void 0===e?void 0:e[0]}}const a=new i;(0,r.exposeDebugValue)("DiscussionHoverStore",a);const s=a},82994:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(26263),r=n(49085),i=n(4615),a=n(70279),s=n(79797);class l extends r.default{constructor(e,t){super(),this.environment=void 0,this.spaceId=void 0,this.environment=e,this.spaceId=t,this.reset()}getInitialState(){if(!this.environment)return;const e=new o.Z({name:"DiscussionInputStore"});return{textStore:new s.ST({environment:this.environment,pointer:{table:a.x_,id:(0,i.ZP)(),spaceId:this.spaceId},path:["text"],inMemoryRecordCache:e}),localRecordCache:e,files:[],showAttachFileIntro:!1,renderFileAttachIntro:!1}}isEmpty(){const e=this.state.textStore.getValue();return!e||0===e.length}}const c=l},48514:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(49085),r=n(92595),i=n(15723);class a extends o.default{getInitialState(){return{open:!1,rect:i.bM}}}const s=new a;(0,r.exposeDebugValue)("NewDiscussionMenuStore",s);const l=s},9080:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),r=n(15723);class i extends o.default{getInitialState(){return{open:!1,rect:r.bM}}}const a=new i},24736:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(24405),r=n(56666),i=n(64921),a=n(85893);function s(e){let{onClick:t,className:n,isMobile:s,style:l,onFocus:c,onBlur:d,onMouseDown:u,onMouseEnter:p,onMouseLeave:m}=e;window.__c={n:"ActionMenuButton"};const{buttonStyle:f,iconStyle:g}=(0,o.yK)((e=>({buttonStyle:{display:"inline-flex",alignItems:"center",justifyContent:"center",flexShrink:0,borderRadius:4,width:s?45:24,height:s?45:24,marginRight:s?-8:-6,...l},iconStyle:{width:s?18:14,height:s?18:14,fill:e.mediumIconColor}})),[s,l]);return(0,a.jsx)(i.Z,{onClick:t,style:f,className:n,mobileFeedback:s,onFocus:c,onBlur:d,onMouseDown:u,onMouseEnter:p,onMouseLeave:m,children:(0,r.o)(g)})}},21914:(e,t,n)=>{n.d(t,{Z:()=>j});var o=n(67294),r=n(73935),i=n(83355),a=n(24405),s=n(15145),l=n(45238),c=n(85893);const d=(0,l.I)("commentAlert",{viewBox:"0 0 34 28",svg:(0,c.jsx)("path",{d:"M8.99023 25.3516C9.55957 25.3516 9.94629 25.1582 10.6338 24.5566L14.2324 21.3232C15.0059 22.1719 16.1768 22.6338 17.6699 22.6338H21.376L24.9639 25.7061C25.6191 26.2646 25.9736 26.5547 26.4893 26.5547C27.2305 26.5547 27.6494 26.0283 27.6494 25.2119V22.6338H28.1006C30.7969 22.6338 32.5908 21.001 32.5908 18.1973V11.8486C32.5908 9.03418 30.7969 7.40137 28.1006 7.40137H26.4141V6.58496C26.4141 3.67383 24.6846 1.97656 21.7627 1.97656H6.39062C3.58691 1.97656 1.73926 3.67383 1.73926 6.58496V16.4785C1.73926 19.4004 3.58691 21.0869 6.39062 21.0869H7.80859V24.0303C7.80859 24.8574 8.22754 25.3516 8.99023 25.3516ZM9.43066 20.3672C9.43066 19.7549 9.06543 19.4756 8.59277 19.4756H6.49805C4.59668 19.4756 3.46875 18.4336 3.46875 16.4355V6.64941C3.46875 4.65137 4.59668 3.59863 6.49805 3.59863H21.6553C23.5566 3.59863 24.6846 4.65137 24.6846 6.64941V7.40137H17.6699C14.8555 7.40137 13.1904 9.03418 13.1904 11.8486V18.1973C13.1904 18.7773 13.2549 19.3037 13.3945 19.7764L9.43066 23.4395V20.3672ZM26.0381 24.6104L22.5898 21.5166C22.1602 21.1406 21.9023 21.0117 21.3115 21.0117H17.7773C15.9834 21.0117 14.9092 20.0449 14.9092 18.1436L14.9199 11.9023C14.9199 10.0117 15.9834 9.02344 17.7773 9.02344H28.0039C29.7871 9.02344 30.8613 10.0117 30.8613 11.9023V18.1436C30.8613 20.0449 29.7871 21.0117 28.0039 21.0117H26.8652C26.4033 21.0117 26.0381 21.291 26.0381 21.8926V24.6104ZM22.9014 16.3389C23.3955 16.3389 23.6641 16.0596 23.6855 15.5225L23.8359 11.7734C23.8574 11.2148 23.4277 10.8174 22.8906 10.8174C22.3428 10.8174 21.9346 11.2041 21.9561 11.7627L22.0957 15.5225C22.1172 16.0488 22.3857 16.3389 22.9014 16.3389ZM22.8906 19.6045C23.4814 19.6045 23.9971 19.1318 23.9971 18.541C23.9971 17.9395 23.4922 17.4775 22.8906 17.4775C22.2891 17.4775 21.7842 17.9502 21.7842 18.541C21.7842 19.1318 22.2998 19.6045 22.8906 19.6045Z"})});var u=n(21202),p=n(33709),m=n(23867),f=n(82990),g=n(9291),h=n(26189),v=n(66324),b=n(75754),y=n(993),_=n(32741),S=n(95477),w=n(66213),k=n(95645),I=n(14976),C=n(35683),x=n(84210),T=n(98165),M=n(77907),P=n(77080),A=n(46735),R=n(72014),D=n(60709),E=n(79797),B=n(24736),F=n(68709),O=n(31945),Z=n(84076),V=n(31278),U=n(76798),N=n(24813);class L extends k.Z{constructor(){super(...arguments),this.nodeRef=o.createRef(),this.state={isHovered:!1},this.origin=o.createRef(),this.handlePageMouseOver=e=>{const t=this.getInteractiveToken(),n=this.props.store.getTitleStore();n&&t&&y.Nh({environment:this.environment,event:e,interactiveToken:t,store:n,canEdit:this.canEdit()})},this.handlePageMouseOut=e=>{const t=this.getInteractiveToken(),n=this.props.store.getTitleStore();n&&t&&y.Zl({environment:this.environment,event:e,interactiveToken:t,store:n,canEdit:this.canEdit()})},this.handleMouseEnter=()=>{this.setState({isHovered:!0})},this.handleMouseLeave=()=>{this.setState({isHovered:!1})}}activate(){const{store:e}=this.props;!function(e,t,n){if(n){n((0,x.ZP)({store:e,pageVisitSource:s.tY.LinkInPage}))}else b._({environment:t,store:e,visitType:C.vu.Link,pageVisitSource:s.tY.LinkInPage})}(e,this.environment,this.context.overrideLinkClick)}willUnmount(){super.willUnmount(),_.qA(this.props.store.getTitleStore())}renderPersisted(){const{disabled:e,store:t}=this.props,n=t.getAliasTargetStore();if(!n)return;if(n instanceof E.G)return(0,c.jsx)(F.p,{allowSelectionWithin:!1,onMouseOver:this.handlePageMouseOver,onMouseOut:this.handlePageMouseOut,children:(0,c.jsx)(N.Z,{ref:this.nodeRef,store:n,style:{...this.getBlockColorStyle(),...this.props.style},isAlias:!0,aliasStore:t,disabled:e,onClick:()=>function(e,t){v.Se(t),A.Z.recordVisit({id:e.id,systemBlockType:e.getSystemBlockTypeStore().getValue(),type:C.vu.Link,currentUserId:t.currentUser.id}),h.SK(t,{page_visit_id:R.$g.getCurrentPageVisitId(),mentioned_page_id:e.id,source_type:"alias_block",hover_preview_enabled:P.default.checkGate("first_party_links"),is_navigable_block:e.isNavigableBlock()})}(this.props.store,this.environment)})});const o=T.Dg(n);if("none"===n.getRole())return(0,c.jsx)(F.p,{allowSelectionWithin:!1,children:(0,c.jsx)("div",{style:{border:`1px solid ${this.theme.darkDividerColor}`,borderRadius:4},children:(0,c.jsx)(Z.Z,{ref:this.origin,style:{width:"100%"},onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:(0,c.jsxs)("div",{style:{display:"flex",padding:9},children:[d({width:30,height:30,marginRight:10,marginLeft:5}),(0,c.jsxs)("div",{style:{fontSize:14},children:[(0,c.jsx)("div",{style:{fontWeight:f.Z.fontWeight.medium},children:(0,c.jsx)(g.FormattedMessage,{defaultMessage:"No access to page comments",id:"aliasBlock.comment.noAccess.title"})}),(0,c.jsx)(g.FormattedMessage,{defaultMessage:"You don't have permission to view this page and its comments",id:"aliasBlock.comment.noAccess.subtitle"})]})]})})})});if(!o||!n.isDefined())return(0,c.jsx)(q,{});const r=E.t1.createChildStore(o,{table:p.qF,id:n.getParentId(),spaceId:(0,m.C)(o.pointer.spaceId)});if(null==r||!r.isDefined())return;const i=r.getModel(),a=E.G.createChildStore(o,i.getParentPointer()).getModel(),l=a&&"table_row"===a.getType()?a.getParentId():i.getParentId(),b=E.t1.createChildStore(o,{table:u.iU,id:l,spaceId:(0,m.C)(o.pointer.spaceId)});if(!b.isDefined())return;const y=o.isDefined()?b.getModel().getRenderUrl({getRecordModel:t.getRecordModel,baseUrl:S.default.domainBaseUrl,discussionId:r.id,pageVisitSource:s.tY.LinkInPage}):void 0,{isMobile:_}=this.environment.device,w=P.default.checkGate("comments_density_image_handling");return(0,c.jsx)(F.p,{allowSelectionWithin:!1,children:(0,c.jsx)("div",{style:{border:`1px solid ${this.theme.darkDividerColor}`,cursor:"pointer",borderRadius:4},children:(0,c.jsxs)(Z.Z,{ref:this.origin,style:{display:"flex",flexDirection:"column"},href:y,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,children:[(0,c.jsxs)("div",{style:{display:"flex",pointerEvents:"none"},children:[(0,c.jsx)(M.LazyComment,{store:n,discussionStore:r,showResolveButtonByDefaultIfPossible:!1,blockStore:t,hoveringDiscussion:!1,discussionLocation:"comment_unfurl",collapsed:!0,maxLines:2,shouldShowThreadLine:!1},n.id),(0,c.jsx)(O.ZP,{popupType:_?O.Z4.SlideUp:O.Z4.Popup,renderOrigin:e=>(0,c.jsx)(B.Z,{...e,isMobile:_,style:{margin:8,opacity:_||this.state.isHovered?1:0}}),placementToOrigin:D.Iw.Top,render:e=>(0,c.jsx)(M.LazyAliasBlockPopupMenu,{onAccept:e.close,block:t})})]}),o&&(0,c.jsxs)("div",{style:{display:"flex",alignItems:"center",paddingLeft:w?"42px":"50px",marginBottom:"10px"},children:[(0,c.jsx)(V.Z,{disabled:!0,icon:o.getIcon(),isEmptyPage:o.isEmptyPage(),size:14,style:{marginLeft:2,marginRight:2}}),(0,c.jsx)(U.Z,{store:o,style:{color:"gray",fontSize:"smaller"}})]})]})})})}getInteractiveToken(){const e=this.props.store.getAliasTargetStore();if(!(this.nodeRef&&this.nodeRef.current&&e instanceof E.G))return;const t=r.findDOMNode(this.nodeRef.current);return(0,I.We)(e,t)}}L.contextTypes={...w.wK,...i.w};const j=L;function z(e){let{style:t}=e;window.__c={n:"ShimmerboxComponent"};const n=(0,a.Fg)();return(0,c.jsx)("div",{style:{overflow:"hidden",position:"relative",background:n.selectLightGray[30],...t},children:(0,c.jsx)("div",{style:{position:"absolute",height:"100%",width:"100%",zIndex:1,animation:"shimmer 1s infinite",background:`linear-gradient(to right, ${n.selectLightGray[30]} 0%, ${n.selectLightGray[50]} 20%, ${n.selectLightGray[30]} 40%, ${n.selectLightGray[30]} 100%)`}})})}function q(){return(0,c.jsxs)(Z.Z,{external:!0,style:{flexGrow:1,minWidth:0},children:[(0,c.jsx)(z,{style:{width:38,height:38}}),(0,c.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexGrow:1},children:[(0,c.jsx)(z,{style:{width:"50%",height:14,margin:4}}),(0,c.jsx)(z,{style:{width:"40%",height:12,margin:4}})]})]})}},77933:(e,t,n)=>{n.d(t,{Z:()=>V});var o=n(67294),r=n(480),i=n(86628),a=n(49085),s=n(56666),l=n(9291),c=n(80365),d=n(24405),u=n(15145),p=n(9999),m=n(82990),f=n(84210),g=n(46654),h=n(18514),v=n(80444),b=n(81236),y=n(84076),_=n(31278),S=n(76798),w=n(94096),k=n(78454),I=n(32469),C=n(85893);const x=function(e){let{currentBlockStore:t,backlinkStore:n,scrollToBlockId:o,discussionId:a,showOriginalToken:s,disableCurrentPageToken:c,disableArrow:p}=e;window.__c={n:"Backlink"};const m=(0,d.Fg)(),_=(0,r.O7)(),I=(0,i.VK)((()=>!(0,g.yi)(_,t)&&(0,g.yi)(_,n)),[_,t,n]),{mainEditorCurrentBlockStore:x}=(0,i.VK)((()=>v.default.state),[]),D=x&&x.id===n.id,E=(0,i.VK)((()=>(0,f.ZP)({store:n,scrollToBlockId:o,discussionId:a,fullyQualified:!0,preferPublicLink:(0,h.Sr)(),getSpaceDomain:()=>{var e;return null===(e=b.Z.getPublicSpaceData(_,n.getSpaceId()))||void 0===e?void 0:e.domain},pageVisitSource:u.tY.LinkInPage})),[n,o,a,_]);return(0,C.jsx)(y.Z,{href:E,external:!1,innerStyle:{paddingLeft:8,paddingRight:16},children:(0,C.jsx)(k.ZP,{childrenStyle:{padding:"4px 2px"},alignment:k.v2.Center,style:{marginBottom:2,marginRight:4},right:(0,C.jsxs)(C.Fragment,{children:[s&&(0,C.jsx)("div",{style:P(_,m),children:(0,C.jsx)(l.FormattedMessage,{defaultMessage:"Original",id:"backlink.originalTokenLabel"})}),D&&!c&&(0,C.jsx)("div",{style:P(_,m),children:(0,C.jsx)(l.FormattedMessage,{defaultMessage:"This page",id:"backlink.currentPageTokenLabel"})})]}),children:(0,C.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[!p&&(0,C.jsx)(A,{}),(0,C.jsx)(T,{backlinkStore:n}),(0,C.jsx)(S.Z,{store:n,style:M(m)}),(0,C.jsxs)("div",{style:{marginTop:-2,minWidth:0,display:"flex",alignItems:"baseline",flex:"2 0 40%",paddingTop:"0.1em"},children:[(0,C.jsx)(w.Z,{store:n,style:{paddingLeft:8}}),(0,C.jsx)(R,{isPrivate:I})]})]})})})};function T(e){let{backlinkStore:t}=e;window.__c={n:"Icon"};const n=(0,i.VK)((()=>t.getIcon()),[t]),o=(0,i.VK)((()=>t.isEmptyPage()),[t]);return(0,C.jsx)(_.Z,{disabled:!0,icon:n,isEmptyPage:o,size:20,style:{marginLeft:4,marginRight:4}})}function M(e){return{fontWeight:m.Z.fontWeight.medium,fontSize:m.Z.fontSize.UIRegular.desktop,lineHeight:1.3,borderBottom:`1px solid ${e.darkDividerColor}`,flexShrink:1}}function P(e,t){const{device:n}=e;return{padding:"2px 6px",borderRadius:4,color:t.mediumTextColor,background:t.legacyDefaultSelectColor,fontSize:n.isMobile?11:9,lineHeight:n.isAndroid?1.5:1,textTransform:"uppercase",letterSpacing:"0.04em",whiteSpace:"nowrap",marginLeft:4}}function A(){window.__c={n:"ArrowIconComponent"};const e=(0,d.Fg)();return(0,C.jsx)("div",{style:{marginLeft:4,transform:"rotate(180deg)",fill:e.regularIconColor},children:(0,p.J)({width:15,height:15})})}function R(e){let{isPrivate:t}=e;return t?(0,C.jsx)(I.Z,{style:{paddingRight:4,marginLeft:12}}):null}var D=n(89728),E=n(26388),B=n(64369);const F=10,O=a.default.createClass(F),Z=a.default.createClass(!1);const V=function(e){let{store:t,originalTransclusionStore:n,disableInaccessiblePages:a,headerText:d,disableArrow:u,disableCurrentPageToken:p}=e;window.__c={n:"Backlinks"};const m=(0,r.O7)(),f=(0,i.qz)(void 0,Z),g=(0,i.qz)(void 0,O),h=(0,i.VK)((()=>(0,c.L)(t,m)),[t,m]),v=(0,o.useCallback)((()=>function(e){e.setState(e.state+F)}(g)),[g]),b=(0,o.useCallback)((()=>function(e){e.setState(!1)}(f)),[f]),y=(0,o.useCallback)((()=>function(e){e.setState(!0)}(f)),[f]),_=(0,i.VK)((()=>g.state),[g]),S=(0,i.VK)((()=>n?n.getNavigableBlockStore():void 0),[n]);if(0===h.backlinks.length&&!n)return null;const w=h.backlinks.length>_,k=h.inaccessibleBacklinkCount>0&&!a;return(0,C.jsxs)("div",{onMouseMove:y,onMouseLeave:b,children:[d&&(0,C.jsx)(U,{headerText:d}),n&&S&&(0,C.jsx)(x,{currentBlockStore:t,disableArrow:u,disableCurrentPageToken:p,backlinkStore:S,scrollToBlockId:n.id,showOriginalToken:!0}),h.backlinks.slice(0,_).map((e=>(0,C.jsx)(x,{currentBlockStore:t,disableArrow:u,disableCurrentPageToken:p,...e},e.backlinkStore.id))),(w||k)&&(0,C.jsx)(E.ZP,{disableTooltip:w,renderTooltip:()=>(0,C.jsx)(l.FormattedMessage,{defaultMessage:"Synced in pages that you don't have access to.",id:"page.backlinks.privatePagesTooltip"}),render:e=>(0,C.jsx)(D.Z,{icon:s.o,isGray:!0,onClick:v,style:{padding:`2px ${u?17:14}px`,width:"100%"},disabled:!w,...e,children:w?(0,C.jsx)(l.FormattedMessage,{defaultMessage:"{count} more",id:"page.backlinks.more",values:{count:h.backlinks.length-_}}):(0,C.jsx)(l.FormattedMessage,{id:"page.backlinks.privatePages",defaultMessage:"{count, plural, one {{count} private page} other {{count} private pages}}",values:{count:h.inaccessibleBacklinkCount}})})})]})};function U(e){let{headerText:t}=e;return(0,C.jsx)("div",{style:{display:"flex"},children:(0,C.jsx)(B.Z,{isSmall:!0,style:{marginTop:12,marginBottom:8,marginLeft:4,flex:1,paddingLeft:8},children:t})})}},13966:(e,t,n)=>{n.d(t,{Z:()=>f});n(67294);var o=n(480),r=n(24405),i=n(56666),a=n(6404),s=n(24677),l=n(43250),c=n(98742),d=n(27724),u=n(64921),p=n(26388),m=n(85893);const f=function(e){let{tooltipContent:t,fadeIn:n,style:o,hoveredStyle:r,store:i,onClick:a,extraAnalyticsData:s,hideFilterActionsInput:l,actionSectionGroupKey:c,onFocus:d,onBlur:u,iconStyle:f}=e;return t?(0,m.jsx)(p.ZP,{renderTooltip:()=>t,delayThreshold:300,render:e=>(0,m.jsx)(h,{tooltipEvents:e,fadeIn:n,style:o,hoveredStyle:r,store:i,onClick:a,extraAnalyticsData:s,hideFilterActionsInput:l,actionSectionGroupKey:c,onFocus:d,onBlur:u,iconStyle:f})}):(0,m.jsx)(h,{fadeIn:n,style:o,hoveredStyle:r,store:i,onClick:a,extraAnalyticsData:s,hideFilterActionsInput:l,actionSectionGroupKey:c,onFocus:d,onBlur:u,iconStyle:f,tooltipEvents:{}})};function g(e,t,n){const{device:o}=e;return{display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:24,height:24,borderRadius:4,fill:o.isMobile?t.lightIconColor:t.mediumIconColor,transition:"opacity 200ms ease-in",...n}}function h(e){let{tooltipEvents:t,fadeIn:n,style:p,hoveredStyle:f,store:h,onClick:v,extraAnalyticsData:b,hideFilterActionsInput:y,actionSectionGroupKey:_,onFocus:S,onBlur:w,iconStyle:k}=e;window.__c={n:"ButtonComponent"};const I=(0,r.Fg)(),C=(0,o.O7)();return(0,m.jsx)(u.Z,{className:n?l.JiD:void 0,style:g(C,I,p),hoveredStyle:f,onClick:e=>function(e,t,n,o,r,i,l){s.Ys({environment:n,store:t}),a.Qn({environment:n,stores:d.default.state.stores,left:e.clientX,top:e.clientY,showInput:!i,actionSectionGroupKey:l||"default",analyticsFrom:"block_more_menu",optionalAnalyticsProperties:{isFromBulkActionsToolbar:r?r.isFromBulkActionsToolbar:void 0}}),null==o||o()}(e,h,C,v,b,y,_),...(0,c.Z)(t,{onFocus:S,onBlur:w}),children:(0,i.o)({width:14,height:14,...k})})}},91893:(e,t,n)=>{n.d(t,{Z:()=>g});n(67294);var o=n(480),r=n(86628),i=n(24405),a=n(49271),s=n(9291),l=n(92650),c=n(68056),d=n(24646),u=n(24666),p=n(21407),m=n(85893);const f=(0,s.defineMessages)({imageCaption:{defaultMessage:"Write a caption…",id:"block.imageCaption.placeholder"}});function g(e){let{captionAriaId:t,disabled:n,store:g}=e;window.__c={n:"BlockCaption"};const h=(0,o.O7)(),v=(0,o.Fy)(),b=(0,s.useIntl)(),y=(0,r.VK)((()=>g.getPropertyStore("caption")),[g]),_=(0,r.VK)((()=>{var e;const t=y.getValue(),n=!t||0===t.length,o="editing"===u.default.state.mode&&(null===(e=(0,c.QY)(u.default.state.multiSelection))||void 0===e?void 0:e.store)===y;return!n||o}),[y]),S=(0,r.VK)((()=>{const{block_full_width:e,block_width:t,block_page_width:n}=g.getFormat();if(v.isMobile)return!1;if(n)return!1;if(e)return!0;const o=(0,l.fg)(h,g);return(t||0)>=h.WindowSizeStore.state.width-(0,d.Wk)(h)-(o&&g.isFullWidth()?l.QB:0)}),[v.isMobile,h,g]),w=(0,i.yK)((e=>({root:{fontSize:14,lineHeight:1.4,color:e.mediumTextColor,paddingTop:6,paddingBottom:6,paddingLeft:a.ZD.paddingLeft,...S&&{paddingLeft:26,paddingRight:26}}})),[S]);return _?(0,m.jsx)(p.Z,{id:t,disabled:n,style:w.root,placeholderStyle:w.root,placeholder:b.formatMessage(f.imageCaption),disableSlashCommands:!0,disableEmbedMenu:!0,store:y,pasteBehavior:"block"}):null}},23864:(e,t,n)=>{n.d(t,{Z:()=>v});var o=n(67294),r=n(480),i=n(86628),a=n(24405),s=n(41432),l=n(25487),c=n(92650),d=n(78175),u=n(98165),p=n(77907),m=n(24646),f=n(79797),g=n(4029),h=n(85893);function v(e){let{disableCommentMenu:t,hideContent:n,hideIfSidebarOrMarginCommentsVisible:v,recursivelyLoadAllDiscussions:b,store:y}=e;window.__c={n:"BlockDiscussionIndicator"};const _=(0,r.O7)(),S=(0,r.Fy)(),w=(0,i.VK)((()=>{const e=y.getModel();return Boolean(null==e?void 0:e.isType(s.eh))}),[y]),k=(0,i.VK)((()=>{const e=(0,u.qA)(y);let t,n,o,r;for(const i of e){if(i instanceof f.G&&t){const e=i.getType();if(e&&(0,s.S9)(e)&&i.id!==y.id)break;if("column_list"===e){const e=i.getContentStore().getValue()||[];n=e.indexOf(t.id),o=e.length,r=(0,d.Po)(i,_)}}t=i}return{columnListIndex:n,columnListColumnCount:o,columnListResizable:r}}),[_,y]),I=(0,o.useCallback)((()=>{if(!S.isMobile){if(void 0===k.columnListIndex)return l.DiscussionIndicatorFormat.FloatRight;if(!k.columnListResizable&&k.columnListColumnCount&&k.columnListIndex===k.columnListColumnCount-1)return l.DiscussionIndicatorFormat.FloatRight}return l.DiscussionIndicatorFormat.PushContent}),[k.columnListColumnCount,k.columnListIndex,k.columnListResizable,S.isMobile]),C=(0,i.VK)((()=>(0,m.Sx)(_)),[_]),x=(0,i.VK)((()=>(0,c.fg)(_,y)),[_,y]),{blockInsetRight:T}=(0,o.useContext)(g.a),M=(0,a.yK)((e=>({wrapper:I()===l.DiscussionIndicatorFormat.FloatRight?{position:"relative",left:T}:{}})),[I,T]);return t||n||(w||v)&&(C||x)?null:(0,h.jsx)("div",{style:M.wrapper,children:(0,h.jsx)(p.LazyDiscussionIndicator,{store:y,getFormat:I,recursivelyLoadAllDiscussions:Boolean(b),onlyCountBlockLevelDiscussions:C},"DiscussionIndicator")})}},4029:(e,t,n)=>{n.d(t,{a:()=>o});const o=(0,n(67294).createContext)({blockInsetRight:0})},70518:(e,t,n)=>{n.d(t,{IS:()=>x,ZP:()=>P,bZ:()=>T});n(21703),n(67294);var o=n(73935),r=n(83355),i=n(41432),a=n(95538),s=n(72126),l=n(88864),c=n(96802),d=n(24677),u=n(82530),p=n(28020),m=n(43250),f=n(77546),g=n(58202),h=n(49427),v=n(68859),b=n(79797),y=n(91681),_=n(27724),S=n(6685),w=n(85893);const k={[i.Ti.image]:36,[i.Ti.audio]:24,[i.Ti.video]:96,[i.Ti.embed]:96,[i.Ti.drive]:96,[i.Ti.tweet]:96,[i.Ti.framer]:96,[i.Ti.maps]:96,[i.Ti.gist]:96,[i.Ti.invision]:96,[i.Ti.pdf]:96,[i.Ti.drawing]:200},I={[i.Ti.image]:36,[i.Ti.video]:96,[i.Ti.embed]:246,[i.Ti.maps]:96,[i.Ti.framer]:96,[i.Ti.tweet]:250,[i.Ti.gist]:96,[i.Ti.audio]:96,[i.Ti.drive]:300,[i.Ti.invision]:96,[i.Ti.pdf]:96,[i.Ti.columnList]:"page_width",[i.Ti.drawing]:300},C={display:"contents"};let x=function(e){return e[e.Horizontal=0]="Horizontal",e[e.Vertical=1]="Vertical",e[e.Corner=2]="Corner",e}({}),T=function(e){return e[e.Left=0]="Left",e[e.Right=1]="Right",e}({});class M extends r.Z{constructor(){super(...arguments),this.dragState=void 0,this.domElm=null,this.storeTypes={blockResizerStore:v.Z},this.handleRef=e=>{this.domElm=e},this.handleDragStart=e=>{e.preventDefault();const t=o.findDOMNode(this.props.resizeComponent);if(!(t&&t instanceof Element))return;let n=0;if(this.domElm){const e=(0,f.VW)(this.domElm);e&&(n=e.getBoundingClientRect().width)}let r=0;const a=this.props.store.getRecordStoreUIParent(),l=a&&a.findRecordStoreUIAncestor((e=>e instanceof b.G)).ancestor;if(l){const e=g.R.getRect(l);e&&(r=e.width);const t=l.getRecordStoreUIParent(),n=t&&t.findRecordStoreUIAncestor((e=>e instanceof b.G)).ancestor;if("tab"===(null==n?void 0:n.getType())){const e=g.R.getRect(n);e&&(r=e.width)}}const c=function(e){const t=e.getRecordStoreUIRoot(),n=h.Z.find((e=>e.props.store===t));if(n)return n.getContentInnerWidth()}(this.props.store)||0,u=_.default.state.stores.filter((e=>function(e){const t=e&&e.getType();return t&&i.Ok[t]}(e)));let p;p=s.q9(u,this.props.store)?u:[this.props.store];const{block_width:m,block_height:v,block_full_width:S,block_page_width:w}=this.props.store.getFormat();this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,dragging:!0,temporaryHeight:v,temporaryWidth:m,temporaryFullWidth:S,temporaryPageWidth:w}),y.Z.setState({...y.Z.state,isResizing:!0}),d.ZH(this.environment);const k=t.getBoundingClientRect();this.dragState={resizingBlocks:p,startWidth:k.width,startHeight:k.height,parentWidth:r,pageWidth:c,isRootChild:this.props.store.isChildOfRecordStoreUIRoot(),startScrollerWidth:n,didDragMove:!1}},this.handleHorizontalDragMove=e=>{let{diffX:t}=e;if(!this.dragState)return;this.dragState.didDragMove=!0;const{temporaryHeight:n}=this.stores.blockResizerStore.state,{width:o,isFullWidth:r,isPageWidth:i}=this.getNewWidthStyleValue(t);if(this.props.preserveScale){const e=r?n||a.QA:n;this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,temporaryWidth:o,temporaryFullWidth:r,temporaryPageWidth:i,temporaryHeight:e})}else this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,temporaryWidth:o,temporaryFullWidth:r,temporaryPageWidth:i})},this.handleVerticalDragMove=e=>{let{diffY:t}=e;if(!this.dragState)return;this.dragState.didDragMove=!0;const{height:n}=this.getNewHeightStyleValue(t);this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,temporaryHeight:n})},this.handleCornerDragMove=e=>{let{diffX:t,diffY:n}=e;if(!this.dragState)return;this.dragState.didDragMove=!0;const{width:o,isFullWidth:r,isPageWidth:i}=this.getNewWidthStyleValue(t),{height:a}=this.getNewHeightStyleValue(n);this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,temporaryWidth:o,temporaryHeight:a,temporaryFullWidth:r,temporaryPageWidth:i})},this.handleDragMove=e=>this.props.resizerType===x.Horizontal?this.handleHorizontalDragMove(e):this.props.resizerType===x.Vertical?this.handleVerticalDragMove(e):this.props.resizerType===x.Corner?this.handleCornerDragMove(e):void 0,this.handleDragEnd=e=>{if(!this.dragState)return;const t=this.stores.blockResizerStore.state;if(this.dragState.didDragMove&&t.dragging){const{temporaryPageWidth:e,temporaryFullWidth:t,temporaryWidth:n,temporaryHeight:o}=this.stores.blockResizerStore.state;u.createAndCommit({userAction:"BlockResizer.handleDragEnd",environment:this.environment,perform:r=>{this.dragState&&c.FH({stores:this.dragState.resizingBlocks,update:{block_height:o,block_width:n,block_full_width:t,block_page_width:e},transaction:r})}});const r=this.props.store.getType();r&&l.Wl(this.environment,{block_type:r,block_height:o,block_width:n,block_full_width:t,block_page_width:e})}this.endDrag()},this.handleDragCancel=e=>this.endDrag()}renderComponent(){return(0,w.jsx)(S.Z,{onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:this.handleDragCancel,preventSidebar:!0,render:e=>(0,w.jsx)("div",{ref:this.handleRef,style:C,className:m.Ep8,...e,children:this.props.children})})}endDrag(){this.stores.blockResizerStore.setState({...this.stores.blockResizerStore.state,dragging:!1,temporaryPageWidth:void 0,temporaryFullWidth:void 0,temporaryWidth:void 0,temporaryHeight:void 0}),d.ZH(this.environment),y.Z.setState({...y.Z.state,isResizing:!1}),this.dragState=void 0}getNewHeightStyleValue(e){const t=this.getNewPixelHeight(e);return{height:Math.min(t,a.Kz)}}getNewPixelHeight(e){if(this.dragState){if(this.props.resizeVertically){const t=this.props.store.getType(),n=t&&k[t]||96;return Math.max(this.dragState.startHeight+e,n)}return this.dragState.startHeight}return 0}getNewWidthStyleValue(e){const t=this.getNewPixelWidth(e),n=t<144?12:48;const o=Math.round(t/n)*n,r=this.isPageWidth(t,n);return{width:o,isFullWidth:this.isFullWidth(t,n)&&!r,isPageWidth:r}}isPageWidth(e,t){return!!this.dragState&&(this.dragState.isRootChild?this.dragState.pageWidth<e+t&&this.dragState.pageWidth>e-t:this.dragState.parentWidth<e+t)}isFullWidth(e,t){if(this.dragState&&this.dragState.isRootChild){let n=this.dragState.startScrollerWidth;const o=this.props.store.getModel();return o&&!o.isType(i.GP)&&(n-=2*(0,p.ui)(this.environment)),n<e+t}return!1}getNewPixelWidth(e){if(!this.dragState)throw new Error("No start rect.");(function(e){const t=e.getModel();return e.isChildOfRecordStoreUIRoot()&&(null==t?void 0:t.isType(i.ib))})(this.props.store)&&(e*=2);let t=this.dragState.startWidth;this.props.resizeHorizontally&&(this.props.resizerAlignment===T.Left?t-=e:this.props.resizerAlignment===T.Right&&(t+=e));const n=this.props.store.getType(),o=n&&I[n]||96,r="page_width"===o?Math.min(this.dragState.parentWidth,this.dragState.pageWidth):o;return r&&t<r&&(t=r),t}}M.displayName="BlockResizer";const P=M},7825:(e,t,n)=>{n.d(t,{Z:()=>y});var o=n(67294),r=n(86628),i=n(24405),a=n(49271),s=n(22491),l=n(62965),c=n(9291),d=n(33929),u=n(73819),p=n(23864),m=n(55217),f=n(78454),g=n(21407),h=n(85893);const v=(0,c.defineMessages)({listPlaceholder:{defaultMessage:"List",id:"bulletedListBlock.placeholder.label"}});function b(e,t){window.__c={n:"BulletedListBlock"};const n=(0,o.useRef)(null),l=(0,r.VK)((()=>{var t;const n=null===(t=e.bulletedListFormatStore)||void 0===t?void 0:t.getState();return function(e,t){switch(e){case"disc":return'"•"';case"circle":return'"◦"';case"square":return'"▪"';default:return t%3==0?'"•"':t%3==1?'"◦"':'"▪"'}}(null==n?void 0:n.blockIdFormats.get(e.store.id),(null==n?void 0:n.depth)||0)}),[e.bulletedListFormatStore,e.store.id]),c=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),b=(0,r.VK)((()=>e.store.getContentStore()),[e.store]),y=(0,u.rv)(e.store),_=(0,i.yK)((()=>({root:{...{paddingLeft:a.ZD.paddingLeft},...y,...e.style}})),[y,e.style]),S=(0,h.jsxs)(f.ZP,{style:_.root,left:(0,h.jsx)("div",{...(0,s.iv)({fontSize:"1.5em",lineHeight:1,marginBottom:0,pseudoBefore:{fontFamily:"Arial",content:l}})}),childrenStyle:{display:"flex",flexDirection:"column"},ref:n,children:[(0,h.jsxs)("div",{style:{display:"flex"},children:[(0,h.jsx)(g.Z,{style:f.R8,disabled:e.disabled,store:c,placeholder:d.default.formatMessage(v.listPlaceholder),pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent}),(0,h.jsx)(p.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}),!e.hideContent&&(0,h.jsx)(m.Z,{disabled:e.disabled,store:b,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,bulletedListFormatStore:e.bulletedListFormatStore})]});return(0,u.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"bulleted_list",getNode:()=>n.current,getBlockStore:()=>e.store})),[e.store]),S)}const y=o.memo(o.forwardRef(b),l.Z)},27755:(e,t,n)=>{n.d(t,{y:()=>H,Z:()=>G});n(57658);var o=n(67294),r=n(1302),i=n(480),a=n(86628),s=n(24405),l=n(63362),c=n(8848),d=n(18442),u=n(54497),p=n(72126),m=n(97880),f=n(82990),g=n(9291),h=n(24677),v=n(98104),b=n(93174),y=n(47043),_=n(41301),S=n(95645),w=n(28651),k=n(49117),I=n(33929),C=n(98742),x=n(52315),T=n(63474),M=n(49085);class P extends M.default{getInitialState(){return{editing:!1,suppressErrorsForActionIds:[]}}startEditing(e){this.setState({editing:!0,suppressErrorsForActionIds:[],placement:e.placement})}stopEditing(){this.setState({editing:!1,suppressErrorsForActionIds:[]})}suppressErrorsForAction(e){this.setState({...this.state,suppressErrorsForActionIds:p.jj([...this.state.suppressErrorsForActionIds,e])})}}const A=P;var R=n(79797),D=n(77794),E=n(13966),B=n(23864),F=n(68709),O=n(73063),Z=n(68785),V=n(63296),U=n(31278),N=n(26388),L=n(59557),j=n(33831),z=n(85893);const q=function(){window.__c={n:"SettingsIconWithNotificationBadge"};const e=(0,s.yK)((e=>({settingsIcon:{fill:e.mediumIconColor},notificationBadge:{fill:e.blueColor,stroke:e.buttonBackground}})),[]);return(0,z.jsxs)(j.Z,{className:"settingsIconWithNotificationBadge",viewBox:"0 0 16 16",style:{width:16,height:16},children:[(0,z.jsx)("path",{d:"M6.406 15.36c-.492 0-.867-.299-.978-.762l-.24-1.037-.159-.059-.902.557c-.404.258-.885.193-1.23-.152l-.82-.82c-.347-.346-.411-.827-.153-1.231l.562-.896-.058-.147-1.032-.24a.981.981 0 01-.761-.979V8.44c0-.48.293-.861.761-.979l1.02-.246.064-.152-.562-.897c-.258-.404-.193-.878.152-1.236l.82-.82a.972.972 0 011.231-.153l.902.551.165-.064.24-1.037c.111-.463.486-.762.978-.762H7.59c.486 0 .867.299.978.762l.24 1.037.165.064.902-.55c.404-.252.885-.188 1.225.152l.82.82c.346.358.41.832.152 1.236l-.556.897.058.152 1.026.246a.981.981 0 01.761.979v1.154c0 .48-.304.862-.761.979l-1.037.24-.053.146.556.897c.258.404.2.885-.152 1.23l-.82.82c-.34.346-.82.41-1.23.153l-.903-.557-.152.059-.24 1.037a.972.972 0 01-.98.762H6.407zm.14-1.06h.903c.1 0 .147-.042.158-.136l.352-1.44c.387-.089.72-.235 1.008-.417l1.265.78c.07.046.141.04.217-.03l.621-.627c.065-.058.065-.129.018-.205l-.773-1.265a3.85 3.85 0 00.404-.997l1.447-.345c.088-.018.135-.065.135-.164v-.88c0-.105-.041-.146-.135-.17l-1.441-.34a3.878 3.878 0 00-.405-1.007l.774-1.26c.053-.082.053-.152-.018-.216l-.627-.616c-.07-.07-.129-.076-.217-.029l-1.26.768a3.782 3.782 0 00-1.013-.41L7.607 3.84c-.011-.093-.058-.134-.158-.134h-.902c-.1 0-.147.046-.164.134l-.346 1.442a4.07 4.07 0 00-1.02.416l-1.26-.768c-.087-.047-.146-.035-.222.03l-.62.615c-.071.07-.071.14-.019.222l.774 1.26a3.94 3.94 0 00-.399 1.008l-1.447.34c-.088.023-.129.064-.129.17v.879c0 .1.041.146.13.164l1.446.345c.088.37.247.721.41.997l-.779 1.265c-.052.076-.047.147.018.211l.621.621c.076.07.147.076.217.03l1.265-.78a3.35 3.35 0 001.014.416l.346 1.441c.017.088.064.135.164.135zm.452-3.071a2.233 2.233 0 01-2.227-2.227c0-1.212 1.008-2.214 2.227-2.214a2.23 2.23 0 012.22 2.214 2.232 2.232 0 01-2.22 2.227zm0-1.002c.656 0 1.201-.557 1.201-1.225 0-.662-.545-1.207-1.2-1.207a1.22 1.22 0 00-1.22 1.207c0 .674.551 1.225 1.22 1.225z",...e.settingsIcon}),(0,z.jsx)("circle",{cx:"12",cy:"4",r:"3.5",...e.notificationBadge})]})},H=(0,g.defineMessages)({addIconButtonAriaLabel:{defaultMessage:"Add icon",id:"buttonBlock.button.addIconButtonAriaLabel"},editButtonAriaLabel:{defaultMessage:"Edit button",id:"buttonBlock.button.editButtonAriaLabel"},buttonPlaceholder:{defaultMessage:"New button",id:"buttonBlock.button.placeholder"},buttonInsufficientPermissions:{defaultMessage:"You don’t have permission to run this button",id:"buttonBlock.button.insufficientPermissions"},clickToEdit:{defaultMessage:"Click to edit button",id:"buttonBlock.button.clickToEdit"}});class W extends S.Z{constructor(){super(...arguments),this.sizeObserver=new D.E,this.buttonRef=o.createRef(),this.storeTypes={mouseStore:w.Z,buttonBlockStore:A},this.handleContainerMount=e=>{e&&this.sizeObserver.observe(e)},this.configureButtonBlock=e=>{const{buttonBlockStore:t}=this.stores;v.ZH(this.environment),h.ZH(this.environment);this.sizeObserver.rect.state.width<300&&!this.environment.device.isPhone&&e?t.startEditing({placement:{type:"popup",originRect:e}}):t.startEditing({placement:{type:"inline"}})},this.allActionDependenciesLoaded=this.createComputedStore((()=>{var e;const t=(null===(e=this.props.store.getAutomationStore())||void 0===e?void 0:e.getActionStores())??[];for(const n of t){const e=n.getBlockStores();for(const t of e)x.b(t)}}))}handleCreated(){r.default.afterNextFlush((()=>{var e;this.configureButtonBlock(null===(e=this.buttonRef.current)||void 0===e?void 0:e.getBoundingClientRect())}))}willUnmount(){this.sizeObserver.destroy()}UNSAFE_willMountOrUpdate(e){super.UNSAFE_willMountOrUpdate(e),this.allActionDependenciesLoaded.state}activate(){var e;null===(e=this.buttonRef.current)||void 0===e||e.activate()}renderPersisted(){const{store:e}=this.props,{mouseStore:t,buttonBlockStore:n}=this.stores,o=!(e.canEdit()&&!this.props.disabled);return(0,z.jsxs)(F.p,{allowSelectionWithin:!0,style:{display:"flex"},ref:this.handleContainerMount,children:[(0,z.jsxs)("div",{style:{flexGrow:1,flexShrink:1,minWidth:0},children:[(0,z.jsx)(K,{store:e,mouseStore:t,buttonBlockStore:n,onConfigure:this.configureButtonBlock,ref:this.buttonRef,disabledFromEditing:o}),(0,z.jsx)(b.O,{store:e,disabled:o,buttonBlockStore:n})]}),(0,z.jsx)(B.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store,recursivelyLoadAllDiscussions:!0})]})}}const K=o.forwardRef(((e,t)=>{window.__c={n:"ButtonBlockButton"};const{store:n,mouseStore:r,buttonBlockStore:b,onConfigure:S,disabledFromEditing:w}=e,x=(0,g.useIntl)(),M=(0,i.O7)(),{isMobile:P}=(0,i.Fy)(),[A,D]=(0,o.useState)(!1),B=(0,a.VK)((()=>r.state.mouseEntered),[r]),F=(0,a.VK)((()=>n.getAutomationStore()),[n]),j=(0,a.VK)((()=>(null==F?void 0:F.getNameStore().getValue())??""),[F]),W=(0,a.VK)((()=>n.getFormat().block_color||"default"),[n]),K=(0,c.p6)(W,(0,s.Fg)()),G=K.background,$=K.color,Q=K.hoveredBackground,Y=K.pressedBackground,X=(0,a.VK)((()=>null==F?void 0:F.getIconStore().getValue()),[F]),J=function(e){const{store:t,automationStore:n,buttonBlockStore:o}=e,r=function(e){const{store:t,automationStore:n}=e,o=(0,i.O7)(),r=o.currentUser.id;return(0,a.VK)((()=>{const e=t.getRecordStoreUIRoot();if(n&&e instanceof R.G)return(0,k.Gb)({type:"button_block",persisted:!0,automationStore:n,blockStore:t,pageStore:e,intl:I.default.getIntl(),parentRecordStore:n,currentUserId:r})}),[n,t,r])}({store:t,automationStore:n});return(0,a.VK)((()=>{const e=null==r?void 0:r.state;if(!e)return{type:"disabled"};if("insufficient"===e.executionPermissionStatus||"unknown"===e.executionPermissionStatus)return{type:"disabled",tooltip:H.buttonInsufficientPermissions};if("sufficient"===e.executionPermissionStatus){if(0===((null==n?void 0:n.getActionIds())??[]).length)return{type:"error",tooltip:_.Mm.noActions,hideErrorIconWhenEditorIsOpen:!0};const t=e.typecheckResult.value.actionValidationFailures,r=Object.entries(t).filter((e=>{let[t]=e;return!o.state.suppressErrorsForActionIds.includes(t)})).flatMap((e=>{let[,t]=e;return t})),i=p.Ps(r);return i?{type:"error",tooltip:(0,_.Fp)(i).forButtonTooltip}:{type:"enabled"}}(0,m.t1)(e)}),[r,n,o])}({store:n,automationStore:F,buttonBlockStore:b}),ee="disabled"===J.type||A||"error"===J.type&&w,te=(0,a.VK)((()=>"error"===J.type&&!(J.hideErrorIconWhenEditorIsOpen&&b.state.editing)),[J,b]),{showFactoryButtonDeprecationBadge:ne,setHasSeenFactoryButtonDeprecationBadge:oe}=(0,L.N)({blockStore:n}),re=(0,s.yK)((e=>{const t=P?"52px":"28px";return{wrap:{display:"flex",alignItems:"center",padding:"2px 0"},configureWrap:{display:"flex",alignItems:"center",marginLeft:4},label:{pointerEvents:"none",color:$,...f.Z.textOverflowStyle},button:{display:"flex",gap:6,minWidth:50,maxWidth:`calc(100% - ${t})`,padding:"8px 12px",fontWeight:500,...ee?{cursor:"not-allowed"}:{}},labelPlaceholder:{color:e.lightTextColor},warningIcon:{width:16,height:16,fill:e.errorText,color:e.errorText},spinnerWrap:{width:20,height:20,display:"flex",alignItems:"center",justifyContent:"center",marginLeft:-4}}}),[ee,P,$]),ie=(0,T.D)(),ae=(0,o.useRef)(null),se=(0,o.useCallback)((()=>{r.setState({...r.state,mouseEntered:!0})}),[r]),le=(0,o.useCallback)((()=>{r.setState({...r.state,mouseEntered:!1})}),[r]),ce=(0,o.useCallback)((()=>{var e;S(null===(e=ae.current)||void 0===e?void 0:e.getBoundingClientRect())}),[S,ae]),de=(0,o.useCallback)((()=>{b.state.editing?(b.stopEditing(),(0,l.lN)(ie,{block_id:n.id,automation_id:null==F?void 0:F.id})):(ce(),oe(),(0,l.yK)(ie,{block_id:n.id,automation_id:null==F?void 0:F.id}))}),[b,ie,n.id,null==F?void 0:F.id,ce,oe]),ue=(0,o.useCallback)((async()=>{const e=n.getRecordStoreUIRoot();if(F&&e instanceof R.G)if(v.ZH(M),h.ZH(M),"error"===J.type)w||ce();else if("enabled"===J.type)try{D(!0),await y.oS({environment:M,store:n,clientContext:{type:"button_block",persisted:!0,automationStore:F,blockStore:n,pageStore:e,intl:I.default.getIntl(),parentRecordStore:F,currentUserId:M.currentUser.id}})}finally{D(!1)}else"disabled"===J.type||(0,m.t1)(J)}),[n,F,M,J,w,ce]);(0,o.useImperativeHandle)(t,(()=>({activate:()=>{ue()},getBoundingClientRect:()=>{var e;return null===(e=ae.current)||void 0===e?void 0:e.getBoundingClientRect()}})),[ue]);const pe=()=>(0,z.jsx)("div",{style:re.spinnerWrap,children:(0,z.jsx)(Z.Z,{})}),me=[];var fe;X&&(A?me.push({key:"left",comp:pe()}):me.push({key:"left",comp:(fe=X,(0,z.jsx)(U.Z,{largeIcon:!0,disabled:!0,isEmptyPage:!1,size:20,icon:{icon:fe,pointer:n.pointer},style:{marginLeft:j?-4:0}}))})),j?me.push({key:"name",comp:(0,z.jsx)("div",{style:re.label,children:j})}):X||me.push({key:"placeholder",comp:(0,z.jsx)("div",{style:re.labelPlaceholder,children:(0,z.jsx)(g.FormattedMessage,{...H.buttonPlaceholder})})}),!X&&A&&me.push({key:"right",comp:pe()}),te&&me.push({key:"error",comp:(0,z.jsx)("div",{children:(0,u.t)(re.warningIcon)})});const ge=e=>(0,z.jsx)(V.Z,{disabled:ee,disabledFeedback:!0,style:re.button,ref:ae,...(0,C.Z)(e??{},{onClick:ue}),backgroundColor:G,hoveredBackgroundColor:Q,pressedBackgroundColor:Y,children:me.map((e=>{let{key:t,comp:n}=e;return(0,z.jsx)(o.Fragment,{children:n},t)}))});return(0,z.jsxs)("div",{style:re.wrap,onMouseMove:se,onMouseLeave:le,children:[J.tooltip?(0,z.jsx)(N.ZP,{renderTooltip:()=>(0,z.jsx)(_.So,{content:(0,z.jsx)(g.FormattedMessage,{...J.tooltip}),subtitle:"error"!==J.type||w?null:(0,z.jsx)(g.FormattedMessage,{...H.clickToEdit})}),delayThreshold:0,render:ge,placement:N.ug.Bottom}):ge(),!w&&(M.device.isMobile||B)&&(0,z.jsxs)("div",{style:re.configureWrap,children:[(0,z.jsx)(N.ZP,{renderTooltip:()=>(0,z.jsx)(g.FormattedMessage,{defaultMessage:"Edit button",id:"buttonBlock.configureTemplate.button.label"}),delayThreshold:300,render:e=>(0,z.jsx)(O.Z,{ariaLabel:x.formatMessage(H.editButtonAriaLabel),icon:ne?()=>(0,z.jsx)(q,{}):d.H,onClick:de,...e})}),M.device.isMobile&&(0,z.jsx)(E.Z,{tooltipContent:(0,z.jsx)(g.FormattedMessage,{defaultMessage:"More actions…",id:"buttonBlock.moreActions.button.label"}),store:n,fadeIn:!1})]})]})}));const G=W},38376:(e,t,n)=>{n.d(t,{Z:()=>I});var o=n(67294),r=n(480),i=n(86628),a=n(24405),s=n(49271),l=n(8848),c=n(15157),d=n(62965),u=n(9291),p=n(41433),m=n(9953),f=n(82530),g=n(73819),h=n(23864),v=n(4029),b=n(31278),y=n(55217),_=n(21407),S=n(85893);const w=(0,u.defineMessages)({inputPlaceholder:{defaultMessage:"Type something…",id:"calloutBlock.inputPlaceholder"},changeIconLabel:{defaultMessage:"Change callout icon",id:"calloutBlock.changeIconLabel"},disabledIconLabel:{defaultMessage:"Callout icon",id:"calloutBlock.disabledIconLabel"}});function k(e,t){window.__c={n:"CalloutBlock"};const n=(0,r.O7)(),d=(0,u.useIntl)(),k=(0,o.useRef)(null),I=(0,g.PE)(e.store,e.disabled),C=(0,i.VK)((()=>e.store.getBlockTitleStore()),[e.store]),x=(0,i.VK)((()=>e.store.getContentStore()),[e.store]),T=(0,i.VK)((()=>e.store.getFormat().block_color||"default"),[e.store]),M=(0,i.VK)((()=>e.store.getIcon()),[e.store]),P=(0,o.useCallback)((async t=>{const o=e.store.getIconStore();if(o){const{serverCommitResult:e}=f.createAndCommit({userAction:"CalloutBlock.handleEmojiChange",environment:n,perform:e=>{m.sO({store:o,value:t,transaction:e}),c.Z.set({userId:n.currentUser.id,key:p.nF,value:t})}});await e}}),[n,e.store]),A=(0,a.yK)((e=>({root:{display:"flex",width:"100%",borderRadius:4,border:(0,l.jS)(T)?void 0:`1px solid ${e.darkDividerColor}`,backgroundColor:"transparent",paddingLeft:12,paddingTop:16,paddingBottom:16,paddingRight:16,...(0,l.x7)(T,e)}})),[T]),{blockInsetRight:R}=(0,o.useContext)(v.a),D=(0,S.jsxs)("div",{role:"note",style:{display:"flex"},ref:k,children:[(0,S.jsxs)("div",{style:{...e.style,...A.root},children:[(0,S.jsx)("div",{children:I?(0,S.jsx)(b.Z,{bucket:"secure",store:e.store,isEmptyPage:!1,onChange:P,disableRemoveIcon:!0,isCallout:!0,icon:M,size:24,disabled:!1,label:d.formatMessage(w.changeIconLabel)}):(0,S.jsx)(b.Z,{icon:M,isEmptyPage:!1,size:24,disabled:!0,label:d.formatMessage(w.disabledIconLabel)})}),(0,S.jsxs)("div",{style:{display:"flex",flexDirection:"column",minWidth:0,marginLeft:8,width:"100%"},children:[(0,S.jsx)(_.Z,{style:{paddingLeft:s.ZD.paddingLeft,paddingRight:s.ZD.paddingRight},disabled:e.disabled,store:C,placeholder:d.formatMessage(w.inputPlaceholder),pasteBehavior:"block"}),!e.hideContent&&(0,S.jsx)(v.a.Provider,{value:{blockInsetRight:R+16},children:(0,S.jsx)(y.Z,{disabled:e.disabled,store:x,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag})})]})]}),(0,S.jsx)(h.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]});return(0,g.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"callout",getNode:()=>k.current,getBlockStore:()=>e.store})),[e.store]),D)}const I=o.memo(o.forwardRef(k),d.Z)},28385:(e,t,n)=>{n.d(t,{Z:()=>Z});var o=n(67294),r=n(83355),i=n(1302),a=n(13991),s=n(15095),l=n(72126),c=n(62193),d=n(20852),u=n(6746),p=n(70203),m=n(44805),f=n(82990),g=n(893),h=n(993),v=n(98724),b=n(56971),y=n(74284),_=n(82530),S=n(48514),w=n(14976),k=n(62619),I=n(68056),C=n(46654),x=n(55227),T=n(89086),M=n(66638),P=n(77907),A=n(69316),R=n(52689),D=n(24666),E=n(29595),B=n(93262),F=n(85893);class O extends r.Z{constructor(){super(...arguments),this.editor=null,this.mergeEditorRefs=(0,c.sH)(),this.renderContentContainer=(e,t,n)=>{let{leafRef:o,wrapperRef:r,...i}=e;return(0,F.jsx)("div",{ref:r,style:{display:"flex",...!this.props.codeWrap&&{overflowX:"auto",WebkitOverflowScrolling:"touch"},...this.props.wrapStyle},className:"line-numbers notion-code-block",...i,children:(0,F.jsx)(E.Z,{ref:this.mergeEditorRefs(this.editorRef,o),style:{...(s=this.theme,l=this.props.style,{flexGrow:1,flexShrink:1,textAlign:"left",fontFamily:f.Z.getCompositeFontFamily(a.SP).githubMono,fontSize:"85%",tabSize:2,padding:"34px 16px 32px 32px",minHeight:"1em",color:s.regularTextColor,...l}),...this.props.isQuickFind&&{paddingTop:12},...this.props.codeWrap?{whiteSpace:"pre-wrap",wordBreak:"break-all",minWidth:0}:{whiteSpace:"pre"}},getDisabled:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_getDisabled,getHtml:this.getHtml,getSelection:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_getContainerSelection,onMutation:e=>function(e,t,n,o){const{newValue:r}=e;U("typing_lag",t,n,o),_.createAndCommit({userAction:"CodeBlockValue.handleMutation",environment:o,perform:e=>{h.aS({environment:o,store:n,newValue:r,disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,disableFilters:!0,transaction:e})}})}(e,this.props.blockStore,this.props.store,this.environment),spellCheck:!1,autoCorrect:"off",autoCapitalize:"off",onSelect:t,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,suppressNewlineEvents:!1,placeholder:" ",disableContentEditableWhenNotEditingTextOnMobile:!0})});var s,l},this.handleClick=e=>{w.SD({environment:this.environment,event:e,textValue:L(this.props.store,this.props.blockStore,this.inPageFindQueryStore,this.isNewDiscussionMenuTarget),editorNode:this.getEditorNode(),store:this.props.store,canEdit:j(this.props.disabled,this.props.store,this.pageContext)})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDelete=e=>function(e,t,n,o,r,i){if(!j(n,o,i))return;U("typing_delete",r,o,t);const a=D.default.state;"editing"===a.mode&&a.multiSelection.start.store===o&&_.createAndCommit({userAction:"CodeBlockValue.handleDelete",environment:t,perform:n=>{b.as({environment:t,multiSelection:a.multiSelection,deleteForwards:!0,transaction:n,event:e})}})}(e,this.environment,this.props.disabled,this.props.store,this.props.blockStore,this.pageContext),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBackspace=e=>function(e,t,n,o,r,i){if(!j(n,o,i))return;U("typing_backspace",r,o,t);const a=D.default.state;if("editing"===a.mode&&a.multiSelection.start.store===o){if(b.YV({device:t.device,event:e,multiSelection:a.multiSelection}))return;_.createAndCommit({userAction:"CodeBlockValue.handleBackspace",environment:t,perform:n=>{b.as({environment:t,multiSelection:a.multiSelection,deleteForwards:!1,transaction:n,event:e})}})}}(e,this.environment,this.props.disabled,this.props.store,this.props.blockStore,this.pageContext),this.handleEnter=e=>{var t;if(!j(this.props.disabled,this.props.store,this.pageContext))return;if(U("typing_enter",this.props.blockStore,this.props.store,this.environment),null===(t=e.preventDefault)||void 0===t||t.call(e),this.editor&&this.editor.isComposing)return;const n=D.default.state,o="editing"===n.mode&&(0,I.QY)(n.multiSelection);o&&_.createAndCommit({userAction:"CodeBlockValue.handleEnter",environment:this.environment,perform:e=>{h.hJ({environment:this.environment,store:this.props.store,string:"\n",selection:o.selection,disableMentions:!0,disableDateMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleShiftEnter=e=>function(e,t,n,o,r,i){var a;if(!j(n,o,i))return;U("typing_enter",r,o,t),null===(a=e.preventDefault)||void 0===a||a.call(e);const s=D.default.state;"editing"===s.mode&&(_.createAndCommit({userAction:"CodeBlockValue.handleShiftEnter",environment:t,perform:e=>{y.IO({environment:t,multiSelection:s.multiSelection,transaction:e})}}),V())}(e,this.environment,this.props.disabled,this.props.store,this.props.blockStore,this.pageContext),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleTab=e=>function(e,t,n,o,r,i){if(!j(n,o,i))return;U("typing_tab",r,o,t),e.preventDefault();const a=D.default.state,s="editing"===a.mode&&(0,I.QY)(a.multiSelection);s&&_.createAndCommit({userAction:"CodeBlockValue.handleTab",environment:t,perform:e=>{h.wA({environment:t,store:o,selection:s.selection,transaction:e,shouldStripTokens:!0})}})}(e,this.environment,this.props.disabled,this.props.store,this.props.blockStore,this.pageContext),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUntab=e=>function(e,t,n,o,r,i){if(!j(n,o,i))return;U("typing_untab",r,o,t),e.preventDefault();const a=D.default.state,s="editing"===a.mode&&(0,I.QY)(a.multiSelection);s&&_.createAndCommit({userAction:"CodeBlockValue.handleUntab",environment:t,perform:e=>{h.O5({environment:t,store:o,selection:s.selection,transaction:e,shouldStripTokens:!0})}})}(e,this.environment,this.props.disabled,this.props.store,this.props.blockStore,this.pageContext),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleCut=e=>function(e,t,n,o,r,i){if(!j(o,r,i))return void e.preventDefault();g.by({environment:t,event:e,markdownLinkifyIt:n})}(e,this.environment,this.props.markdownLinkifyIt,this.props.disabled,this.props.store,this.pageContext),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handlePaste=e=>function(e,t,n,o,r,i,a){if(!j(r,i,a))return void e.preventDefault();_.createAndCommit({userAction:"CodeBlockValue.handlePaste",environment:t,perform:r=>{g.v({environment:t,event:e,disableEmbedMenu:!0,transaction:r,onPasteFiles:g.AL,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o})}})}(e,this.environment,this.props.markdownLinkifyIt,this.props.tinyMceMicrosoftWordPasteFilter,this.props.disabled,this.props.store,this.pageContext),this.handleMouseOver=e=>{w.vO({environment:this.environment,event:e,textValue:L(this.props.store,this.props.blockStore,this.inPageFindQueryStore,this.isNewDiscussionMenuTarget),editorNode:this.getEditorNode(),store:this.props.store,canEdit:j(this.props.disabled,this.props.store,this.pageContext)})},this.handleMouseOut=e=>{w.kV({environment:this.environment,event:e,textValue:L(this.props.store,this.props.blockStore,this.inPageFindQueryStore,this.isNewDiscussionMenuTarget),editorNode:this.getEditorNode(),store:this.props.store,canEdit:j(this.props.disabled,this.props.store,this.pageContext)})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_getDisabled=()=>{return e=this.props.disabled,t=this.props.store,n=this.pageContext,!j(e,t,n);var e,t,n},this.getHtml=()=>{const{store:e,Prism:t}=this.props,n=L(this.props.store,this.props.blockStore,this.inPageFindQueryStore,this.isNewDiscussionMenuTarget),r=p.QaF(n),i=t.languages[this.props.language];if(this.props.language!==d.PrismLanguages.html&&this.props.language!==d.PrismLanguages.markup||(t.languages.markup.tag.addInlined("style","css"),t.languages.markup.tag.addInlined("script","javascript")),r&&i&&r.length<1e4){const a=document.createElement("div"),s=t.highlight(r,i,this.props.language);a.innerHTML=x.g7(s);const c=Array.from(a.childNodes).map(N),d=function(e){let{syntaxTokens:t,textValue:n,parentSpaceId:o,store:r,theme:i}=e;const a=m.Mw(n&&{value:n,spaceId:o},r.getRecordModel),s=x.kF(a,t),l=a.map(p.hDy).map((e=>m.fn({annotations:e,theme:i,spaceId:o,getRecordModel:r.getRecordModel})));return s.map(((e,t)=>(0,F.jsx)("span",{className:[e.classNames||"",...l[e.textTokenIndex].classNames].join(" "),style:l[e.textTokenIndex].style,"data-token-index":e.textTokenIndex,children:e.value},t)))}({parentSpaceId:this.props.parentSpaceId,store:e,syntaxTokens:l.oA(c),textValue:n,theme:this.theme}),f=(0,F.jsxs)(o.Fragment,{children:[d,(0,F.jsx)("span",{children:"\n"})]});return u.Z.renderToStaticMarkup(f)}{const t=w.IY({environment:this.environment,textValue:n&&{value:n,spaceId:this.props.parentSpaceId},parentStore:e,disableHover:!1,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!0,disabled:!j(this.props.disabled,this.props.store,this.pageContext),theme:this.theme,emojiType:"raw",katex:void 0,formulaValueTypes:[]});return u.Z.renderToStaticMarkup((0,F.jsx)(F.Fragment,{children:t}))}},this.clearBrowserSelection=()=>{var e;null===(e=this.getEditorNode())||void 0===e||e.blur()},this.inPageFindQueryStore=this.createComputedStore((()=>{const e=A.Z.state;return e.open&&e.findQuery.length>0?e.findQuery:void 0})),this.isEditing=this.createComputedStore((()=>{var e;const t=D.default.state;return"editing"===t.mode&&(null===(e=(0,I.QY)(t.multiSelection))||void 0===e?void 0:e.store)===this.props.store})),this.isNewDiscussionMenuTarget=this.createComputedStore((()=>{var e;const t=S.Z.state;return t.open&&"inline"===t.type&&(null===(e=(0,I.QY)(t.multiSelection))||void 0===e?void 0:e.store)===this.props.store})),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_getContainerSelection=()=>function(e,t){if(t.state)return(0,T.HE)(e)}(this.props.store,this.isEditing),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_getEndSelection=()=>function(e,t,n,o){const r=s.p4(p.QaF(L(e,t,n,o)));return{startIndex:r.length,endIndex:r.length}}(this.props.store,this.props.blockStore,this.inPageFindQueryStore,this.isNewDiscussionMenuTarget),this.editorRef=e=>{this.editor=e}}renderComponent(){const{disabled:e}=this.props;return(0,F.jsx)(B.Z,{store:this.props.store,disabled:e,clearBrowserSelection:this.clearBrowserSelection,getEndSelection:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_getEndSelection,onClick:this.handleClick,onDelete:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDelete,onBackspace:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBackspace,onEnter:this.handleEnter,onShiftEnter:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleShiftEnter,onCommandEnter:l.yR,onCommandShiftEnter:l.yR,onTab:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleTab,onUntab:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleUntab,onToggleHighlight:e=>z(["h",R.Z.state.color],e,this.environment,this.props.disabled,this.props.store,this.pageContext),onToggleBold:e=>z(["b"],e,this.environment,this.props.disabled,this.props.store,this.pageContext),onToggleItalics:e=>z(["i"],e,this.environment,this.props.disabled,this.props.store,this.pageContext),onToggleUnderline:e=>z(["_"],e,this.environment,this.props.disabled,this.props.store,this.pageContext),onToggleStrike:e=>z(["s"],e,this.environment,this.props.disabled,this.props.store,this.pageContext),onToggleCode:l.yR,onCopy:e=>function(e,t,n){g.JG({environment:n,event:e,markdownLinkifyIt:t})}(e,this.props.markdownLinkifyIt,this.environment),onCut:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleCut,onPaste:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handlePaste,onMoveUp:e=>{return t=this.environment,void _.createAndCommit({userAction:"CodeBlockValue.handleMoveUp",environment:t,perform:e=>{h.fs({environment:t,transaction:e,direction:"up"})}});var t},onMoveDown:e=>{return t=this.environment,void _.createAndCommit({userAction:"CodeBlockValue.handleMoveDown",environment:t,perform:e=>{h.fs({environment:t,transaction:e,direction:"down"})}});var t},render:this.renderContentContainer,disableMentions:!0,disableSlashCommands:!0,canSelectAllBlocks:!0,canInsertText:!0,canSelectionDrag:!0,topBottomPadding:40,pasteBehavior:"inline"})}getEditorNode(){var e;return(null===(e=this.editor)||void 0===e?void 0:e.getNode())||void 0}}function Z(e){window.__c={n:"CodeBlockValueWithDeps"};const{value:t}=(0,P.useDependency)(P.deps.prismjs),{value:n}=(0,P.useDependency)(P.deps.markdownLinkifyIt),{value:o}=(0,P.useDependency)(P.deps.tinyMceMicrosoftWordPasteFilter);return t?(0,F.jsx)(O,{...e,Prism:t,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o}):null}function V(){i.default.flush()}function U(e,t,n,o){(0,M.u)({type:e,environment:o,blockStore:t,store:n,isInCollectionView:!1})}function N(e){return k.Gs(e)?[e.data]:k.kK(e)?[e.textContent||"",e.className]:void 0}function L(e,t,n,o){let r=e.getValue();const i=n.state;return i&&(r=w.cD({textValue:r,find:i,blockId:null==t?void 0:t.id})),o.state?w.Gj({store:e}):r}function j(e,t,n){const o=n&&n.publicEditModeStore.state;return!(0,C.YF)(o)&&Boolean(!e&&t.canEdit())}function z(e,t,n,o,r,i){j(o,r,i)&&(t.preventDefault(),v.aS({environment:n,annotation:e}),V())}O.displayName="CodeBlockValue"},53223:(e,t,n)=>{n.d(t,{DZ:()=>o.LazyCollectionViewBlock,wA:()=>r});var o=n(77907);function r(e){return"isCollectionViewBlock"in e&&"boolean"==typeof e.isCollectionViewBlock&&e.isCollectionViewBlock}},69015:(e,t,n)=>{n.d(t,{b:()=>c,Z:()=>w});n(67294);var o=n(73935),r=n(83355),i=n(1302),a=n(72126),s=n(14976),l=n(97880);let c=function(e){return e.Inline="Inline",e.InlineWrap="InlineWrap",e.Textarea="Textarea",e}({}),d=function(e){return e.Submit="Submit",e.Newline="Newline",e}({});function u(e){const{device:t,e:n,action:o,onSubmit:r}=e;if(o===d.Submit)r&&r(n);else if(o===d.Newline){if(!t.isIOS)return;n.preventDefault&&n.preventDefault(),document.execCommand("insertLineBreak")}else(0,l.t1)(o)}var p=n(73744),m=n(89224),f=n(49085);class g extends f.default{getInitialState(){return{}}}const h=g;var v=n(24666),b=n(29595),y=n(3386),_=n(85893);class S extends r.Z{constructor(){super(...arguments),this.storeTypes={store:h},this.handleWindowMouseDown=e=>{const t=o.findDOMNode(this);t&&!t.contains(e.target)&&this.props.onBlur&&this.props.onBlur()},this.handleEsc=e=>{this.handleKeyEvent(),this.props.onCancel&&this.props.onCancel(e)},this.handleShiftEnter=e=>{const{device:t}=this.environment;t.isIOS&&!("shiftKey"in e)?u({device:t,e,action:d.Newline}):this.handleEnter(e)},this.handleEnter=e=>{const{type:t,onSubmit:n}=this.props,{device:o}=this.environment;if(this.getDisabled())return;const r=function(e){const{device:t,type:n,e:o}=e;return n===c.Inline?d.Submit:n===c.InlineWrap?t.isPhone?d.Submit:"altKey"in o&&o.altKey||"shiftKey"in o&&o.shiftKey?d.Newline:d.Submit:n===c.Textarea?d.Newline:void(0,l.t1)(n)}({device:o,type:t,e});u({device:o,e,action:r,onSubmit:n})},this.handleLeft=e=>{this.getDisabled()||(this.handleKeyEvent(),this.props.onLeft&&this.props.onLeft(e))},this.handleRight=e=>{this.getDisabled()||(this.handleKeyEvent(),this.props.onRight&&this.props.onRight(e))},this.handleKeyEvent=()=>{i.default.afterNextFlush((()=>{this.saveSerializedTextSelection()}))},this.getDisabled=()=>!!this.props.disabled||!this.props.focus,this.getHtml=()=>{const e=a.YU(this.props.value+(this.props.value.length>0?"\n":""));return this.props.getHtml?this.props.getHtml(e):e},this.getSelection=()=>{const e=this.stores.store.state.selection;return e&&{type:"contain",selection:e}},this.handleMutation=e=>{let{newValue:t}=e;this.saveSerializedTextSelection(),this.props.onChange(t)},this.saveSerializedTextSelection=()=>{const{store:e}=this.stores,t=s.Ut(this.environment,m.get());t&&(a.Xy(t.selection,e.state.selection)||this.stores.store.setState({selection:t.selection}),t.forceEmitSelectionStore&&v.default.emit())}}UNSAFE_willMount(e){super.UNSAFE_willMount(e),p.lj(window,"mousedown",this.handleWindowMouseDown)}UNSAFE_willMountOrUpdate(e){super.UNSAFE_willMountOrUpdate(e);const{store:t}=this.stores;e.focus&&!t.state.selection&&(e.selectAll?t.setState({selection:{startIndex:0,endIndex:e.value.length}}):t.setState({selection:{startIndex:e.value.length,endIndex:e.value.length}}))}willUnmount(){super.willUnmount(),p.ZV(window,"mousedown",this.handleWindowMouseDown)}renderComponent(){const{type:e}=this.props;return(0,_.jsx)(y.Z,{debugName:"ContentEditableInput",capture:!this.getDisabled(),onDelete:this.handleKeyEvent,onBackspace:this.handleKeyEvent,onEnter:this.handleEnter,onShiftEnter:this.handleShiftEnter,onCommandEnter:this.handleKeyEvent,onCommandShiftEnter:this.handleKeyEvent,onUp:this.handleKeyEvent,onDown:this.handleKeyEvent,onLeft:this.handleLeft,onRight:this.handleRight,onTab:this.handleKeyEvent,onUntab:this.handleKeyEvent,onSelectAll:this.handleKeyEvent,onToggleBold:this.handleKeyEvent,onToggleItalics:this.handleKeyEvent,onToggleStrike:this.handleKeyEvent,onToggleCode:this.handleKeyEvent,onUndo:this.handleKeyEvent,onRedo:this.handleKeyEvent,onEsc:this.handleEsc,onCut:this.handleKeyEvent,onCopy:this.handleKeyEvent,onPaste:this.handleKeyEvent,onKeypress:this.handleKeyEvent,onHome:this.handleKeyEvent,onEnd:this.handleKeyEvent,onGoToBeginningOfLine:this.handleKeyEvent,onGoToEndOfLine:this.handleKeyEvent,onGoForwardOneChar:this.handleKeyEvent,onGoBackwardOneChar:this.handleKeyEvent,children:(0,_.jsx)(b.Z,{style:{...this.props.style,whiteSpace:"pre-wrap"},placeholder:this.props.placeholder,placeholderStyle:this.props.placeholderStyle,spellCheck:!1,autoCorrect:this.props.autoCorrect,autoCapitalize:this.props.autoCapitalize,getDisabled:this.getDisabled,getHtml:this.getHtml,getSelection:this.getSelection,onMutation:this.handleMutation,suppressNewlineEvents:e===c.Inline})})}}S.displayName="ContentEditableInput";const w=S},29595:(e,t,n)=>{n.d(t,{Z:()=>v});n(21703),n(67294);var o=n(83355),r=n(18466),i=n(1302),a=n(22491),s=n(97880),l=n(14976),c=n(46150),d=n(62619),u=n(45162),p=(n(60846),n(89224)),m=n(24666),f=n(85893);let g=!1;class h extends o.Z{constructor(e){super(e),this.root=null,this.ownNodeIsComposing=!1,this.testDiv=document.createElement("div"),this.shouldDisableContentEditableForMobile=!1,this.handleRootMount=e=>{this.root=e},this.handleTextSelectionEditingStoreForMobile=()=>{this.shouldDisableContentEditableForMobile=!m.default.isEditingStore.state,this.root&&this.updateContentEditableAttribute(this.root)},this.handleCompositionStart=()=>{const{device:e}=this.environment;e.isAndroid||(this.ownNodeIsComposing=!0,this.props.onCompositionStart&&this.props.onCompositionStart())},this.handleCompositionEnd=()=>{const{device:e}=this.environment;e.isAndroid||(this.ownNodeIsComposing=!1,this.handleInput(),this.props.onCompositionEnd&&this.props.onCompositionEnd())},this.handleBeforeInput=e=>{const{suppressNewlineEvents:t}=this.props;if(!d.kA(e))throw new Error("Invalid event");var n;if(t&&("insertLineBreak"!==e.inputType&&"insertParagraph"!==e.inputType||e.preventDefault(),this.environment.device.isAndroid&&"insertCompositionText"===e.inputType&&null!==(n=e.data)&&void 0!==n&&n.endsWith("\n")&&e.target===this.root)){var o;g;const e=()=>{var t;this.delegateMutation({insertedLine:!0,deletedLine:!1,newValue:this.getText(),multiSelection:void 0,isComposing:this.isComposing}),null===(t=this.root)||void 0===t||t.removeEventListener("input",e)};null===(o=this.root)||void 0===o||o.addEventListener("input",e)}},this.handleSelect=e=>{this.delegateSelection("contain")},this.handleClick=e=>{var t,n;3===e.nativeEvent.detail&&(l.TQ(this.environment.device),this.delegateSelection("contain")),null===(t=(n=this.props).onClick)||void 0===t||t.call(n,e)},this.handleInput=this.handleInput.bind(this)}get isComposing(){var e;return Boolean(this.ownNodeIsComposing||(null===(e=this.contentEditableContext)||void 0===e?void 0:e.isComposing()))}get registries(){var e;return[null===(e=this.contentEditableContext)||void 0===e?void 0:e.contentEditableLeafRegistry]}getText(){return l.n$(this.environment,this.root)}delegateSelection(e){var t,n;this.isComposing||(null===(t=(n=this.props).onSelect)||void 0===t||t.call(n,{endpoint:e,component:this}))}delegateMutation(e){this.handleMutation(e)}delegateBeforeInput(e){this.handleBeforeInput(e)}delegateKeyDown(e){var t,n;null===(t=(n=this.props).onKeyDown)||void 0===t||t.call(n,e)}delegateCompositionEnd(e){var t,n;null===(t=(n=this.props).onCompositionEnd)||void 0===t||t.call(n)}getNode(){return this.root}UNSAFE_willMount(){this.environment.device.isMobile&&this.props.disableContentEditableWhenNotEditingTextOnMobile&&(this.shouldDisableContentEditableForMobile=r.Z.withListenerIgnored((()=>!m.default.isEditingStore.state)),m.default.isEditingStore.addListener(this.handleTextSelectionEditingStoreForMobile))}UNSAFE_willMountOrUpdate(e){this.selection=e.getSelection(),this.disabled=e.getDisabled(),this.html=e.getHtml()}didMount(){this.updateContainer(!0),this.root&&d.OW&&this.root.addEventListener("beforeinput",this.handleBeforeInput)}didUpdate(){this.updateContainer(!1)}willUnmount(){this.environment.device.isMobile&&this.props.disableContentEditableWhenNotEditingTextOnMobile&&m.default.isEditingStore.removeListener(this.handleTextSelectionEditingStoreForMobile),this.root&&d.OW&&this.root.removeEventListener("beforeinput",this.handleBeforeInput)}updateContentEditableAttribute(e){const t=e.getAttribute("contenteditable");this.disabled||this.shouldDisableContentEditableForMobile?"false"!==t&&this.mutateDOM((function(){e.contentEditable="false"})):"true"!==t&&this.mutateDOM((function(){e.contentEditable="true"}))}updateContainer(e){var t;const{device:n}=this.environment;if(null===(t=this.contentEditableContext)||void 0===t||t.contentEditableLeafRegistry.register(this),this.root&&(this.updateContentEditableAttribute(this.root),!this.isComposing)){if(e)this.root.innerHTML=this.html;else{this.previousHtml!==this.html&&(this.previousHtml=this.html,this.testDiv.innerHTML=this.html);const e=this.root.innerHTML,t=this.testDiv.innerHTML;e!==t&&(this.root.innerHTML=this.html)}if(this.disabled)return;if(p.isMouseSelecting())return;if(p.isMouseRightClicking())return void p.resetMouseRightClicking();if(this.selection)switch(this.selection.type){case"start":case"end":{var o;null===(o=this.contentEditableContext)||void 0===o||o.tryEnableMultiSelection();const e=l.bD(this.root,this.selection.index),t={endpoint:this.selection.type,onlyIfEqual:this.contentEditableContext,position:e};p.setDOMEndpoint(t,this.environment.device),this.updateSelectionEndpoint(t);break}case"contain":{const e=l.lw(this.root,this.selection.selection.startIndex,this.selection.selection.endIndex),t=p.get();l.Dn(t,e)||(n.isAndroid&&document.activeElement!==this.root&&this.root.focus(),p.set(e,n));break}default:(0,s.t1)(this.selection)}else if(!e){const e=p.get(),t=!n.isAndroid||r.Z.withListenerIgnored((()=>"empty"===m.default.state.mode));e&&e.commonAncestorContainer&&d.UG(e.commonAncestorContainer)&&this.root.contains(e.commonAncestorContainer)&&t&&p.clear(this.environment)}}}updateSelectionEndpoint(e){const t=p.get(),n=p.getIncompleteDOMEndpoint();if(t&&n===e)switch(e.endpoint){case"start":return void p.setDOMEndpoint({endpoint:"end",onlyIfEqual:this.contentEditableContext,position:{container:t.endContainer,offset:t.endOffset}},this.environment.device);case"end":return void p.setDOMEndpoint({endpoint:"start",onlyIfEqual:this.contentEditableContext,position:{container:t.startContainer,offset:t.startOffset}},this.environment.device);default:(0,s.t1)(e.endpoint)}}renderComponent(){const{onContextMenu:e,onKeyDown:t,onDoubleClick:n,onMouseDown:o,onTouchStart:r,placeholder:i,onBlur:s,onFocus:l,onMouseOver:d,onMouseOut:p}=this.props,m=Boolean(!this.html),g=(!(0,u.ri)(this.environment.device)||!(0,u.Aw)(this.environment))&&this.props.spellCheck,h=this.props.tagName??"div";return(0,f.jsx)(h,{id:this.props.id,ref:this.handleRootMount,...(0,a.iv)(this.props.className,m&&this.props.placeholderStyle?this.props.placeholderStyle:this.props.style,!this.disabled&&"notranslate"),onCompositionStart:this.handleCompositionStart,onCompositionEnd:this.handleCompositionEnd,onInput:this.handleInput,spellCheck:g,autoCorrect:this.props.autoCorrect,autoCapitalize:this.props.autoCapitalize,onSelect:this.handleSelect,onClick:this.handleClick,onBlur:s,onFocus:l,onContextMenu:e,onKeyDown:t,onDoubleClick:n,onMouseDown:o,onTouchStart:r,onMouseOver:d,onMouseOut:p,placeholder:i,...c.GF})}handleMutation(e){this.props.onMutation&&this.props.onMutation(e),i.default.flush()}handleInput(){this.handleMutation({newValue:this.getText(),insertedLine:!1,isComposing:this.isComposing})}}h.displayName="ContentEditableLeaf";const v=h},15201:(e,t,n)=>{n.d(t,{O:()=>z});n(57658),n(21703);var o=n(27537),r=n.n(o),i=n(67294),a=n(60177),s=n(64338),l=n(480),c=n(86628),d=n(24405),u=n(41432),p=n(22491),m=n(72126),f=n(44805),g=n(97880),h=n(62134),v=n(98104),b=n(95477),y=n(14976),_=n(46150),S=n(62619),w=n(89224);const k=["initial","keyDown","compositionStart","beforeInput","compositionUpdate","domMutations","input","compositionEnd","keyUp"],I={keyDown:"keyUp",beforeInput:"input",input:"domMutations",domMutations:"input",compositionStart:"compositionEnd"},C={compositionUpdate:"beforeInput"};class x{constructor(){this.flowData=new Map,this.nextFlow=new T,this.currentFlow=void 0,this.previousFlow=void 0,this.listeners=new Set,this.handleSelectionChange=()=>{this.nextFlow.beforeRange=w.toStaticRange(w.get())},this.handleKeyDown=e=>{this.advanceToPhase("keyDown").keyDown=e,this.emitUpdate(),this.endIfComplete()},this.handleCompositionStart=e=>{this.advanceToPhase("compositionStart").compositionStart=e,this.emitUpdate(),this.endIfComplete()},this.handleBeforeInput=e=>{var t;if(!(0,S.kA)(e))return;const n=(null===(t=e.getTargetRanges)||void 0===t?void 0:t.call(e))||[];this.advanceToPhase("beforeInput").beforeInput={event:e,targetRanges:n},this.emitUpdate(),this.endIfComplete()},this.handleCompositionUpdate=e=>{this.advanceToPhase("compositionUpdate").compositionUpdate=e,this.emitUpdate()},this.handleInput=e=>{this.advanceToPhase("input").input=e,this.emitUpdate(),this.endIfComplete()},this.handleCompositionEnd=e=>{this.advanceToPhase("compositionEnd").compositionEnd=e,this.emitUpdate(),this.endIfComplete()},this.handleKeyUp=e=>{this.advanceToPhase("keyUp").keyUp=e,this.emitUpdate(),this.endFlow()},this.handleMutations=e=>{let{currentFlow:t}=this;t&&!t.domMutations||(t=this.advanceToPhase("initial")),t.domMutations={afterPhase:t.phase,mutations:e},this.emitUpdate(),this.endIfComplete()}}attachEventListeners(e){const{div:t,document:n}=e;return n.addEventListener("selectionchange",this.handleSelectionChange),t.addEventListener("input",this.handleInput),t.addEventListener("keydown",this.handleKeyDown),t.addEventListener("keyup",this.handleKeyUp),t.addEventListener("beforeinput",this.handleBeforeInput),t.addEventListener("compositionstart",this.handleCompositionStart),t.addEventListener("compositionupdate",this.handleCompositionUpdate),t.addEventListener("compositionend",this.handleCompositionEnd),()=>{n.removeEventListener("selectionchange",this.handleSelectionChange),t.removeEventListener("input",this.handleInput),t.removeEventListener("keydown",this.handleKeyDown),t.removeEventListener("keyup",this.handleKeyUp),t.removeEventListener("beforeinput",this.handleBeforeInput),t.removeEventListener("compositionstart",this.handleCompositionStart),t.removeEventListener("compositionupdate",this.handleCompositionUpdate),t.removeEventListener("compositionend",this.handleCompositionEnd)}}onInputFlowChange(e){return this.listeners.add(e),()=>this.listeners.delete(e)}isComposing(){var e;return this.currentFlow&&!this.currentFlow.isPhase("initial")?this.currentFlow.isComposing():(null===(e=this.previousFlow)||void 0===e?void 0:e.isComposing())||!1}reset(){this.nextFlow=new T,this.currentFlow=void 0,this.previousFlow=void 0,this.flowData=new Map}getCurrentFlow(){const e=this.currentFlow;if(!e)return;return{flow:e,data:this.getData(e)}}getData(e){const t=this.flowData.get(e);if(t)return t;const n={};return this.flowData.set(e,n),n}endIfComplete(){const{currentFlow:e}=this;e&&e.isComplete()&&this.endFlow()}emitUpdate(){const{currentFlow:e}=this;if(e){const t={type:"update",flow:e,data:this.getData(e)};this.listeners.forEach((e=>e(t)))}}endFlow(){const{currentFlow:e}=this;if(e){const t=this.previousFlow;this.previousFlow=e,this.currentFlow=void 0;const n={type:"end",flow:e,data:this.getData(e)};this.listeners.forEach((e=>e(n))),t&&this.flowData.delete(t)}}advanceToPhase(e){return this.currentFlow&&this.currentFlow.canTransitionToPhase(e)||(this.endFlow(),this.currentFlow=this.nextFlow,this.nextFlow=new T),this.currentFlow.phase=e,this.currentFlow}}class T{constructor(){this.phase="initial",this.beforeRange=w.toStaticRange(w.get()),this.initial=void 0,this.keyDown=void 0,this.compositionStart=void 0,this.beforeInput=void 0,this.compositionUpdate=void 0,this.input=void 0,this.compositionEnd=void 0,this.domMutations=void 0,this.keyUp=void 0}isPhase(e){return this.phase===e}hasEvents(){return Boolean(this.compositionStart||this.compositionEnd||this.compositionUpdate||this.keyDown||this.keyUp||this.beforeInput||this.input)}isComposing(){var e,t;switch(this.phase){case"compositionStart":case"compositionUpdate":return!0;case"compositionEnd":case"initial":return!1;case"beforeInput":return Boolean(null===(e=this.beforeInput)||void 0===e?void 0:e.event.isComposing);case"input":case"keyDown":case"keyUp":return Boolean(null===(t=this[this.phase])||void 0===t?void 0:t.isComposing);default:(0,g.t1)(this.phase)}}transitionToPhase(e,t){return!!this.canTransitionToPhase(e)&&(this.phase=e,this[e]=t,!0)}canTransitionToPhase(e){return!this[e]&&(C[this.phase]===e||1===function(e,t){const n=k.indexOf(e),o=k.indexOf(t),r=n-o;if(r<0)return-1;if(r>0)return 1;return 0}(e,this.phase))}isComplete(){for(const[e,t]of(0,g.qP)(I))if(this[e]&&!this[t])return!1;return!0}getTargetRanges(){var e;const t=null===(e=this.beforeInput)||void 0===e?void 0:e.targetRanges;return null!=t&&t.length?t:this.beforeRange?[this.beforeRange]:[]}}var M=n(68056),P=n(45162),A=n(55010),R=n(35431),D=n(59730);let E,B;E=Symbol.iterator;class F{constructor(e){if(this.leftToRight=new Map,this.rightToLeft=new Map,e)for(const[t,n]of e)this.assoc(t,n)}assoc(e,t){const n=[];if(this.leftToRight.has(e)){const t=this.leftToRight.get(e);n.push((()=>this.rightToLeft.delete(t)))}if(this.rightToLeft.has(t)){const e=this.rightToLeft.get(t);n.push((()=>this.leftToRight.delete(e)))}for(const o of n)o();return this.leftToRight.set(e,t),this.rightToLeft.set(t,e),this}getLeft(e){return this.leftToRight.get(e)}getRight(e){return this.rightToLeft.get(e)}hasLeft(e){return this.leftToRight.has(e)}hasRight(e){return this.rightToLeft.has(e)}deleteLeft(e){if(this.leftToRight.has(e)){const t=this.leftToRight.get(e);return this.leftToRight.delete(e),this.rightToLeft.delete(t),!0}return!1}deleteRight(e){if(this.rightToLeft.has(e)){const t=this.rightToLeft.get(e);return this.leftToRight.delete(t),this.rightToLeft.delete(e),!0}return!1}*[E](){for(const[e,t]of this.leftToRight)yield[e,t]}}B=Symbol.iterator;class O{constructor(e,t,n){if(this.leftName=void 0,this.rightName=void 0,this.biMap=void 0,e===t)throw new D.D3("NamedBiMap left and right names are equal",{data:{name:e}});if(this.leftName=e,this.rightName=t,this.biMap=new F,n)for(const[o,r]of n)this.biMap.assoc(o,r)}assoc(e){const t=e[this.leftName],n=e[this.rightName];return this.biMap.assoc(t,n),this}get(e){if(this.leftName in e){const t=e[this.leftName];return this.biMap.getLeft(t)}if(this.rightName in e){const t=e[this.rightName];return this.biMap.getRight(t)}throw new D.D3("NamedBiMap.get fallthrough should never occur",{data:e})}delete(e){if(this.leftName in e){const t=e[this.leftName];return this.biMap.deleteLeft(t)}if(this.rightName in e){const t=e[this.rightName];return this.biMap.deleteRight(t)}throw new D.D3("NamedBiMap.delete fallthrough should never occur",{data:e})}has(e){if(this.leftName in e){const t=e[this.leftName];return this.biMap.hasLeft(t)}if(this.rightName in e){const t=e[this.rightName];return this.biMap.hasRight(t)}throw new D.D3("NamedBiMap.has fallthrough should never occur",{data:e})}[B](){return this.biMap[Symbol.iterator]()}}class Z extends R.Z{constructor(){super(...arguments),this.nodeMap=new O("node","component",new F)}register(e){const t=super.register(e),n=e.getNode();return n?this.nodeMap.assoc({node:n,component:e}):this.nodeMap.delete({component:e}),t}unregister(e){super.unregister(e),this.nodeMap.delete({component:e})}getByDOMOrder(){const e=Array.from(this.nodeMap.biMap.rightToLeft.entries());return e.sort(((e,t)=>{const n=e[1],o=t[1];return(0,A.Z)(n,o)})),e.map((e=>{let[t,n]=e;return{node:n,leaf:t}}))}getParentContentEditableLeaf(e){const t=(0,_.X1)(e),n=t&&this.nodeMap.get({node:t});if(t&&n)return{node:t,leaf:n}}}var V=n(79797),U=n(24666),N=n(85893);const L=!1,j=500;function z(e){window.__c={n:"ContentEditableRoot"};const{children:t,style:n,displayName:o,shouldSelectOnEnter:S}=e,k=!e.disabled,I=(0,i.useRef)(null),C=(0,i.useRef)(0),[T,A]=(0,i.useState)(null),R=(0,i.useRef)(!1),D=(0,i.useRef)(!1),[E]=(0,i.useState)((()=>function(e){return`${e}-${K++}`}(o))),B=(0,i.useRef)(void 0),F=(0,i.useRef)({displayName:E}),[O]=(0,i.useState)((()=>new x)),[z]=(0,i.useState)((()=>new Z)),[G]=(0,i.useState)((()=>new s.T7({onMutations(e){O.handleMutations(e)},enableLogging:!1}))),$=(0,i.useRef)(!1),Q=(0,i.useCallback)((e=>{$.current!==e&&($.current=e,G.mutate((()=>{var t,n;e?null===(t=I.current)||void 0===t||t.setAttribute(_.HM,"true"):null===(n=I.current)||void 0===n||n.removeAttribute(_.HM)})))}),[G]),Y=(0,i.useRef)(!1),X=(0,i.useCallback)((e=>{Y.current!==e&&(Y.current=e,G.mutate((()=>{var t,n;e?null===(t=I.current)||void 0===t||t.setAttribute(_._F,"true"):null===(n=I.current)||void 0===n||n.removeAttribute(_._F)})))}),[G]),J=(0,i.useCallback)((e=>{I.current=e,G.setNode(e),A(e)}),[G]),ee=(0,l.O7)(),te=(0,c.VK)((()=>(0,P.Aw)(ee)),[ee]);(0,i.useEffect)((()=>{if(T&&te)return O.attachEventListeners({div:T,document:window.document})}),[O,te,T]);const{isFirefox:ne,isAndroid:oe}=ee.device;(0,i.useEffect)((()=>{const e=e=>{var t;const n=w.get(),o=(0,P.Zb)({range:n,contentEditableLeafRegistry:z,allowInvisibleEndSelection:!0,constraintToContentEditableRootNode:I.current||void 0}),r=U.default.state,i="editing"===r.mode?r.multiSelection:void 0;return{leafs:o,multiSelection:oe&&e.isPhase("beforeInput")&&(!i||(0,M.iG)(i))&&w.isExpanded(n)?null===(t=(0,P.fx)({range:n,contentEditableLeafRegistry:z,allowInvisibleEndSelection:!0}))||void 0===t?void 0:t.multiSelection:i,range:w.toStaticRange(n)}};return O.onInputFlowChange((t=>{X(O.isComposing());const{flow:n,type:o,data:i}=t;if("end"!==o){if(L){const t=i.log||=[],o={phase:n.phase,hasMutations:Boolean(n.domMutations),target:e(n),isComposing:n.isComposing()};t.push(o),H("flow updated",n.phase,o)}if("update"!==o||!n.isPhase("beforeInput")&&i.target||(i.target=e(n)),"update"===o&&n.domMutations&&!i.handledMutations){var a,l;i.handledMutations=!0;const t=n.domMutations.mutations,o=i.target||e(n),m=!ne||o.multiSelection&&(0,M.iG)(o.multiSelection)?null===(a=o.leafs)||void 0===a?void 0:a.start:q(z,I.current),f=null===(l=o.leafs)||void 0===l?void 0:l.start,h=null==m?void 0:m.leaf.getText();H("onMutations",i,h,n,m);const v=n.hasEvents(),y=L||b.default.isLocalhost||!v;let S=!1,w=!1,k=!1;for(let e=t.length-1;e>=0;e--){const n=t[e];W(n,m);const o=(0,_.xp)(n.target),r=(0,_.X1)(n.target);if(o===I.current){if((v||"attributes"!==n.type||"style"!==n.attributeName)&&("attributes"!==n.type||"dir"!==n.attributeName))if(m){if("childList"===n.type){const e=Array.from(n.removedNodes);w||=e.some(_.eD)||e.some(_.C7);const t=Array.from(n.addedNodes);k||=t.some(_.eD)}if(r&&r===m.node){switch(n.type){case"attributes":(0,s.AJ)(n,y);continue;case"characterData":case"childList":break;default:(0,g.t1)(n.type)}S=!0}else(0,s.AJ)(n,y)}else(0,s.AJ)(n,y)}else H("allowed mutation on interior region",o,n)}if(f&&(S||w)){var c,d,u,p;if("string"!=typeof h)throw new Error("focusedLeafText must be string");const e=null===(c=n.beforeInput)||void 0===c?void 0:c.event,t=null===(d=n.keyDown)||void 0===d?void 0:d.keyCode,o="enter"!==(void 0!==t&&r()(t))&&("insertLineBreak"===(null==e?void 0:e.inputType)||"insertParagraph"===(null==e?void 0:e.inputType)||"insertCompositionText"===(null==e?void 0:e.inputType)&&(null==e||null===(u=e.data)||void 0===u?void 0:u.endsWith("\n"))||k),a={multiSelection:null===(p=i.target)||void 0===p?void 0:p.multiSelection,newValue:h,deletedLine:w,insertedLine:o,isComposing:O.isComposing()};H("delegateMutation",a),f.leaf.delegateMutation(a)}}}else H("flow ended",i,n)}))}),[z,O,oe,ne,X]),(0,i.useEffect)((()=>{const e=I.current;e&&te&&R.current&&G.mutate((()=>{k?e.contentEditable="true":e.removeAttribute("contentEditable")}))}),[k,te,G]);const re=(0,i.useCallback)((()=>{const e=I.current;return!(!e||!te)&&(R.current?("always"===te&&Q(!0),!1):(G.mutate((()=>{k?e.contentEditable="true":e.removeAttribute("contentEditable"),(0,P.ri)(ee.device)&&(e.spellcheck=!1)})),G.lock(F.current),R.current=!0,Q("gesture"===te),H("enableMultiSelection"),!0))}),[G,te,Q,ee.device,k]),ie=(0,i.useCallback)((()=>{const e=I.current;return!(!R.current||!e)&&("always"===te?(Q(!1),!1):!O.isComposing()&&(G.unlock(F.current),e.removeAttribute("contenteditable"),Q(!1),H("disableMultiSelection"),R.current=!1,!0))}),[G,te,Q,O]);(0,i.useEffect)((()=>{let e=w.get();function t(){var t;const n=null===(t=w.get())||void 0===t?void 0:t.cloneRange(),o=e;e=n;const r=I.current;r&&w.isExpanded(n)&&!w.isExpanded(o)&&(0,_.xp)(n.commonAncestorContainer)===r&&(0,_.X1)(n.commonAncestorContainer)&&re()&&(r.focus(),w.isExpanded(w.get())||w.set(n,ee.device))}return document.addEventListener("selectionchange",t),()=>document.removeEventListener("selectionchange",t)}),[re,ee.device]);const ae=(0,i.useCallback)((function(){const e=w.get();if(!w.isExpanded(e)&&ie()&&e){const t=q(z,I.current,e);t&&t.node&&t.node instanceof HTMLElement&&t.node.focus(),w.set(e,ee.device)}}),[z,ie,ee.device]),se=(0,i.useMemo)((()=>m.Ds(ae,50)),[ae]),{KeyboardShortcutStackStore:le}=ee,ce=(0,i.useRef)(),de=(0,i.useCallback)((function(e){const t=I.current;if(!t)return;if(!R.current)return;if(v.Ch("reactSelectionChange"))return void H("maybeHandleExpectedBrowserSelectionUpdate() returned true");const n=w.get();if(H("onSelect (react selection)",w.toStaticRange(n)),!ce.current&&n&&be.current&&n.commonAncestorContainer===be.current)w.clear(ee);else if(!(ce.current&&n&&w.areRangesEqual(n,ce.current))){if(ce.current=w.toStaticRange(n),n){const o=n.startContainer===t&&0===n.startOffset&&n.endContainer===t&&0===n.endOffset,r=be.current&&n.startContainer===be.current&&_e.current&&n.endContainer===_e.current,i=ee.device.isIOS&&ee.device.isMobileNative&&e.timeStamp-C.current>j&&function(e,t,n){if(!e.collapsed||0!==e.startOffset)return!1;const o=(0,P.Zb)({range:e,contentEditableLeafRegistry:t,allowInvisibleEndSelection:!0,constraintToContentEditableRootNode:n}),r=t.getByDOMOrder()[0];return Boolean(r&&o&&o.start.leaf===r.leaf)}(n,z,t);if(o||r||i)return H("onSelect: propagateShortcut selectAll"),void h.dJ({KeyboardShortcutStackStore:le},new KeyboardEvent("keydown"),"selectAll")}if("contextmenu"!==e.nativeEvent.type){if(n&&(w.isExpanded(n)||"always"===te)&&(0,_.xp)(n.commonAncestorContainer)===t){if(D.current)return void(B.current=e);const t=q(z,I.current,n);t&&(H("onSelect: delegateSelection",t),t.leaf.delegateSelection("start"))}w.isExpanded(n)||se()}}}),[te,z,se,le,ee]);(0,i.useEffect)((()=>{if(te&&!k){function e(){const e=w.get(),t=I.current;if(!t||!e)return;const n=(0,P.fx)({contentEditableLeafRegistry:z,range:e,allowInvisibleEndSelection:!0});n&&(0,_.xp)(e.commonAncestorContainer)===t&&v.bc({...n,environment:ee,focus:"start",readOnly:!0})}return document.addEventListener("selectionchange",e),()=>document.removeEventListener("selectionchange",e)}}),[ee,te,k,z]);const ue=(0,i.useCallback)((()=>{D.current=!0,B.current=void 0}),[]),pe=(0,i.useCallback)((e=>{const t=B.current;if(D.current=!1,B.current=void 0,C.current=e.timeStamp,t){const e=q(z,I.current);H("handleTouchEnd: delegateSelection",e),null==e||e.leaf.delegateSelection("start")}}),[z]),me=(0,i.useCallback)((e=>{if(C.current=e.timeStamp,!R.current)return;e.target!==I.current||"Enter"!==e.key||!1!==e.ctrlKey||!1!==e.metaKey||!1!==e.altKey||!1!==e.shiftKey||S&&!S()||void 0!==w.get()||!be.current||w.setOnNode(be.current,ee.device);const t=q(z,I.current);H("handleKeyDown: delegateKeyDown",t),null==t||t.leaf.delegateKeyDown(e)}),[z,ee.device,S]);(0,i.useEffect)((()=>{const e=I.current;if(e)return e.addEventListener("beforeinput",t),()=>e.removeEventListener("beforeinput",t);function t(e){if(!R.current)return;const t=q(z,I.current);null==t||t.leaf.delegateBeforeInput(e)}}),[z]);const fe=(0,i.useCallback)((()=>{const e=I.current;if(!e)return;const t=function(){document.removeEventListener("selectionchange",t);const n=w.get();if(null!=n&&n.collapsed&&(0,_.xp)(n.commonAncestorContainer)===e){const e=(0,_.X1)(n.commonAncestorContainer),t=n.startContainer,o=n.startOffset;if(e&&t&&(0,y.x9)(e,t,o)){const r=e.getElementsByClassName(f.$A)[0];r&&(H("Move collapsed selection before EOL marker",{parentLeafNode:e,caretContainer:t,caretOffset:o}),n.setStartBefore(r),n.setEndBefore(r),w.set(n,ee.device))}}};document.addEventListener("selectionchange",t)}),[ee.device]);(0,i.useEffect)((()=>{"always"!==te||R.current||re()}),[re,te]);const ge=(0,i.useCallback)((()=>{const e=w.get();return!w.isExpanded(e)&&ie()}),[ie]),he=(0,i.useCallback)((()=>!oe&&Boolean(O.isComposing())),[O,oe]),ve=(0,d.yK)((e=>({div:{caretColor:e.regularTextColor,...n},whenContentEditable:{WebkitUserModify:"read-write-plaintext-only"},selectionTrap:{height:"1px",width:"1px",caretColor:"transparent"}})),[n]),be=(0,i.useRef)(null),ye=(0,N.jsx)("span",{style:ve.selectionTrap,ref:be,..._.d_}),_e=(0,i.useRef)(null),Se=(0,N.jsx)("span",{style:ve.selectionTrap,ref:_e,..._.d_}),we=(0,i.useCallback)((()=>{if(!w.get()&&"editing"===U.default.state.mode){const e=U.default.state.multiSelection.start.store;if(e instanceof V.G){const t=e.getType();if(t===u.Ti.linkToPage||t===u.Ti.linkToCollection)return}v.ZH(ee)}}),[ee]),ke=(0,i.useCallback)((()=>{!I.current||w.get()&&"empty"!==U.default.state.mode||I.current.blur()}),[]);return(0,N.jsx)("div",{onBlur:ee.device.isIOS?we:void 0,onFocus:ee.device.isIOS?ke:void 0,onTouchStart:te?ue:void 0,onTouchEnd:te?pe:void 0,onTouchCancel:te?pe:void 0,onKeyDown:te?me:void 0,onCompositionEnd:te?function(e){if(!R.current)return;const t=q(z,I.current);null==t||t.leaf.delegateCompositionEnd(e)}:void 0,ref:J,...(0,p.iv)(ve.div,{whenContentEditable:ve.whenContentEditable}),onMouseDown:fe,onSelect:de,..._.GZ,children:(0,N.jsxs)(a.c1,{id:E,tryEnableMultiSelection:re,tryDisableMultiSelection:ge,isComposing:he,domLock:G,contentEditableLeafRegistry:z,children:[ye,t,Se]})})}function q(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:w.get();const o=(0,P.Zb)({range:n,contentEditableLeafRegistry:e,allowInvisibleEndSelection:!0,constraintToContentEditableRootNode:t||void 0});if(o)return o.start}function H(){if(L){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.warn("ContentEditableRoot:",...t)}}function W(e){const t={};if(t.type=e.type,t.target=e.target,t.targetIsText=e.target.nodeType===Node.TEXT_NODE,t.targetIsLeaf=(0,_.eD)(e.target),e.addedNodes.length){const n=Array.from(e.addedNodes);t.added=n,t.addedALeaf=n.some(_.eD),t.addedAText=n.some((e=>e.nodeType===Node.TEXT_NODE))}if(e.removedNodes.length){const n=Array.from(e.removedNodes);t.removed=n,t.removedALeaf=n.some(_.eD),t.removedAText=n.some((e=>e.nodeType===Node.TEXT_NODE))}"characterData"===e.type&&(t.newChars=e.target.textContent,t.oldChars=e.oldValue),t.mutation=e;for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];H("mutation: ",t,...o)}let K=0},68709:(e,t,n)=>{n.d(t,{p:()=>c});var o=n(67294),r=n(60177),i=n(22491),a=n(46150),s=n(85893);const l={WebkitUserSelect:"none",userSelect:"none",pseudoSelection:{background:"transparent"}},c=o.forwardRef(((e,t)=>{window.__c={n:"ContentEditableVoid"};const{allowSelectionWithin:n,style:o,className:c,...d}=e,u=(0,r.Dl)(),p=(0,s.jsx)("div",{ref:t,contentEditable:!1,...(0,i.iv)(c,!n&&l,o),...a.G0,...d});return u?(0,s.jsx)(r.c1,{void:!0,children:p}):p}));c.displayName="ContentEditableVoid"},10182:(e,t,n)=>{n.d(t,{Z:()=>x});var o=n(67294),r=n(480),i=n(86628),a=n(24405),s=n(86658),l=n(53028),c=n(9291),d=n(50950),u=n(43250),p=n(87279),m=n(61893),f=n(60709),g=n(52275),h=n(31945),v=n(78140),b=n(32163),y=n(89728),_=n(72495),S=n(24006),w=n(64369),k=n(85893);function I(e){let{hasDismissButton:t,onDismiss:n}=e;window.__c={n:"CookieConsentMenu"};const i=(0,r.O7)(),f=(0,a.Fg)(),g=(0,c.useIntl)(),[h,S]=(0,o.useState)(!1);(0,o.useEffect)((()=>()=>{t||h&&d.qo()}),[g,h,t]);const I=[{key:"trackingTypes",render:e=>(0,k.jsx)(_.Z,{...e,topBorder:0!==e.index}),items:l.m4.map((e=>({key:e,render:t=>(0,k.jsx)(C,{menuListItemProps:t,trackingType:e,setShowReloadOnMenuClose:S,isNativeiOSApp:i.device.isMobileNative&&i.device.isIOS}),action:()=>d.Nh(i,e)})))}];return(0,k.jsxs)(v.Z,{className:u.N7t,menuType:p.og.Popup,width:260,children:[(0,k.jsx)("div",{style:{display:"flex",alignItems:"center",paddingTop:t?4:0},children:t&&(0,k.jsxs)(k.Fragment,{children:[(0,k.jsx)(w.Z,{isSmall:!0,isMultiline:!0,style:{width:"80%",paddingLeft:14},children:(0,k.jsx)("b",{children:(0,k.jsx)(c.FormattedMessage,{...s.ze.customizeCookiesHeader})})}),(0,k.jsx)(y.Z,{style:{float:"right",marginLeft:-8,paddingLeft:8,paddingRight:8,color:f.blueColor},onClick:()=>{d.OM(i,m.Z.getPermission()),n&&n()},children:(0,k.jsx)(c.FormattedMessage,{...s.ze.cookieDismissButtonLabel})})]})}),(0,k.jsx)(b.Z,{type:b.i.Vertical,initialFocus:void 0,sections:I})]})}function C(e){window.__c={n:"TrackingTypeToggle"};const{menuListItemProps:t,trackingType:n,setShowReloadOnMenuClose:o,isNativeiOSApp:l}=e,{title:u,caption:p,subtitle:f}=(0,s.G_)(n,l),[{permission:h}]=(0,i.AF)(m.Z),v=(0,a.Fg)(),b=(0,r.O7)();return(0,k.jsx)(g.Z,{...t,title:(0,k.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,k.jsx)("div",{style:{marginRight:0},children:(0,k.jsx)(c.FormattedMessage,{...u})})}),caption:(0,k.jsxs)("div",{children:[f&&(0,k.jsx)("div",{children:(0,k.jsx)("span",{style:{color:v.errorText},children:(0,k.jsx)(c.FormattedMessage,{...f})})}),(0,k.jsx)("div",{children:(0,k.jsx)("span",{style:{color:v.mediumTextColor},children:(0,k.jsx)(c.FormattedMessage,{...p})})})]}),shouldWrapCaption:!0,right:(0,k.jsx)("div",{style:{display:"flex",width:"100%",alignItems:"center",cursor:"pointer"},children:(0,k.jsx)(S.Z,{on:h[n],disabled:"necessary"===n,onClick:()=>{o(!0),d.Nh(b,n)}})})})}const x=function(e){let{renderOrigin:t,hasDismissButton:n,onDismiss:o}=e;return(0,k.jsx)(h.ZP,{popupType:h.Z4.Popup,placementToOrigin:f.Iw.Bottom,alignmentToOrigin:f.lU.Start,renderOrigin:t,render:()=>(0,k.jsx)(I,{hasDismissButton:n,onDismiss:o})})}},93262:(e,t,n)=>{n.d(t,{Z:()=>Z});var o=n(67294),r=n(83355),i=n(1302),a=n(72126),s=n(70203),l=n(97880),c=n(42239),d=n(99553),u=n(52989),p=n(52423),m=n(24677),f=n(98104),g=n(84064),h=n(14976),v=n(12534),b=n(28314),y=n(98742),_=n(39500),S=n(45162),w=n(89224),k=n(89086),I=n(28685),C=n(95802),x=n(15723),T=n(55367),M=n(22294),P=n(88923),A=n(69784),R=n(27724),D=n(24666),E=n(6685),B=n(3386),F=n(85893);class O extends r.Z{constructor(){super(...arguments),this.isSelected=!1,this.shouldEditOnClick=!0,this.shouldDisableMultiSelectionOnDragEnd=!1,this.contentEditableLeafRef=o.createRef(),this.wrapperRef=o.createRef(),this.handleDragStart=e=>{const t=this.getContextClosestSelectableStore();e.shiftKey&&!this.isEditing.state&&t?(e.preventDefault(),m.Ys({environment:this.environment,store:t,toggle:m.ji(this.environment),selectBetween:m.OS()}),this.shouldEditOnClick=!1):this.shouldEditOnClick=!0},this.handleDragMove=e=>{if(T.ZP.state.isDragging)c.td(this.environment,{currentX:e.currentX,currentY:e.currentY});else if(e.shiftKey)_.X9()&&c.f$(this.environment,{startX:e.startX,startY:e.startY,stores:R.default.state.stores,isNativeDrag:!1,getGhostElement:void 0});else if(!A.default.state.isActive){if(!this.props.canSelectionDrag)return;const n=this.getNode();if(!n)return;const o=x.jn(n.getBoundingClientRect(),20);if(x.uh(o,e.currentX,e.currentY))return;var t;if((0,S.Aw)(this.environment))return void("mouse"===e.device&&null!==(t=this.contentEditableContext)&&void 0!==t&&t.tryEnableMultiSelection()&&(this.shouldDisableMultiSelectionOnDragEnd=!0));this.shouldEditOnClick=!1,u.AI({environment:this.environment,target:e.target,startX:e.startX,startY:e.startY,showSelectionRect:!1,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!1})}},this.handleDragEnd=e=>{var t;this.shouldDisableMultiSelectionOnDragEnd&&(null===(t=this.contentEditableContext)||void 0===t||t.tryDisableMultiSelection(),this.shouldDisableMultiSelectionOnDragEnd=!1);T.ZP.state.isDragging?c.fX({environment:this.environment,shiftKey:e.shiftKey,optionKey:e.optionKey,commandKey:e.commandKey,analyticsFrom:"page_content"}):f.aJ()},this.handleClick=e=>{const{device:t}=this.environment;(0,v.ZP)({event:e,context:v.Af.EditorClick,callback:()=>{if(this.props.onClick&&this.props.onClick(e),e.defaultPrevented)return;const n=R.default.getDefaultContainerFromTarget(e.target);if(!P.default.isSidePeekOpen()||null!=n&&n.isPeekRenderer()||d.E5(this.environment),this.shouldEditOnClick){const n=this.getContextClosestSelectableStore();if(n?m.eP({environment:this.environment,store:n}):(m.Af({stores:[]}),m.$Y({environment:this.environment,phase:R.SelectionPhase.Selected,preventClearEditingText:!0})),t.isMobile&&!this.isEditing.state&&!this.isPartOfSelection.state){const t=this.getNode();if(t){let n;if(this.mutateDOM((()=>{t.classList.add("editor-force-select"),n=w.rangeFromPoint(e.clientX,e.clientY),t.classList.remove("editor-force-select")})),n){const e=V(n,this.environment);e&&(f.Z5({store:this.props.store,selection:e.selection}),e.forceEmitSelectionStore&&D.default.emit())}}}this.saveSerializedTextSelectionAfterFlush()}else this.shouldEditOnClick=!0}})},this.handleContextMenu=e=>{this.props.onContextMenu&&(0,v.ZP)({event:e,context:v.Af.EditorContextMenu,callback:()=>{var t,n;if(null===(t=(n=this.props).onContextMenu)||void 0===t||t.call(n,e),!e.defaultPrevented)return"unhandled"}}),this.isEditing.state&&(0,v.ZP)({event:e,context:v.Af.EditorContextMenu,callback:()=>{this.saveSerializedTextSelectionAfterFlush()}})},this.handleSelect=e=>{const{device:t}=this.environment;t.isMobile?this.handleMobileSelect(e):this.handleDesktopSelect(e)},this.handleMobileSelect=e=>{if(!this.props.disabled){if(!w.get())return;const t=this.getContextClosestSelectableStore();this.isEditing.state||m.eP({environment:this.environment,store:t}),this.saveSerializedTextSelection(e),i.default.flush()}},this.handleDesktopSelect=e=>{this.props.disabled||!this.isEditing.state&&"contain"===e.endpoint||this.saveSerializedTextSelection(e)},this.defaultShortcutHandlers={onEsc:e=>{if(this.props.disabled)return;if(e.preventDefault(),(0,S.Aw)(this.environment)){const e="empty"!==D.default.state.mode&&D.default.state.multiSelection,t=e&&(0,S.tp)({multiSelection:e,filterCommonAncestors:!0,focus:void 0});if(t)return void m.Z5({environment:this.environment,...t})}const t=this.getContextClosestSelectableStore();if(t){const e=C.C.findSelectableFromStore(t);e&&e.props.canSelect&&m.Z5({environment:this.environment,stores:[t]})}},onUp:e=>{var t;this.props.disabled||((0,S.Aw)(this.environment)?f.N3({environment:this.environment,topBottomPadding:this.props.topBottomPadding,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry}):f.zJ({environment:this.environment,store:this.props.store,topBottomPadding:this.props.topBottomPadding,event:e}))},onDown:e=>{var t;this.props.disabled||((0,S.Aw)(this.environment)?f.FG({environment:this.environment,topBottomPadding:this.props.topBottomPadding,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry}):f.DI({environment:this.environment,store:this.props.store,topBottomPadding:this.props.topBottomPadding,event:e}))},onLeft:e=>{if(!this.props.disabled){var t;if((0,S.Aw)(this.environment))return f.AL({environment:this.environment,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry});f.e2({environment:this.environment,store:this.props.store,event:e})}},onRight:e=>{if(!this.props.disabled){var t;if((0,S.Aw)(this.environment))return f.D1({environment:this.environment,event:e,contentEditableLeafRegistry:null===(t=this.contentEditableContext)||void 0===t?void 0:t.contentEditableLeafRegistry});f.FC({environment:this.environment,store:this.props.store,event:e})}},onSelectAll:e=>{if(!this.props.disabled){var t;if(e.preventDefault(),(0,S.Aw)(this.environment))return f.UV({environment:this.environment,store:this.props.store,canSelectAllBlocks:this.props.canSelectAllBlocks,contentEditableContextId:null===(t=this.contentEditableContext)||void 0===t?void 0:t.id});f.mT({environment:this.environment,store:this.props.store,canSelectAllBlocks:this.props.canSelectAllBlocks})}},onUndo:e=>{e.preventDefault(),p.Yw(this.environment)},onRedo:e=>{e.preventDefault(),p.KX(this.environment)},onGoToBeginningOfLine:e=>{U("start",e.shiftKey)},onGoToEndOfLine:e=>{U("end",e.shiftKey)}},this.saveSerializedTextSelectionAfterFlush=()=>{i.default.afterNextFlush((()=>{this.saveSerializedTextSelection()}))},this.isPartOfSelection=this.createComputedStore((()=>(0,k.ZZ)(this.props.store)),!1,"isPartOfSelection"),this.isEditing=this.createComputedStore((()=>(0,k.J5)(this.props.store)),!1,"isEditing")}get registries(){return[I.E]}getContentEditableLeaf(){return this.contentEditableLeafRef.current||void 0}getNode(){return this.wrapperRef.current?this.wrapperRef.current:this.contentEditableLeafRef.current?this.contentEditableLeafRef.current.getNode():super.getNode()}didMountOrUpdate(){this.isEditing.state?this.isSelected||(this.isSelected=!0,this.props.onSelected&&this.props.onSelected()):this.isSelected&&(this.isSelected=!1,function(e){e()}(this.props.clearBrowserSelection),this.props.onDeselected&&this.props.onDeselected())}willUnmount(){if(this.isSelected){this.isSelected=!1,this.props.onDeselected&&this.props.onDeselected();const e=this.isEditing.state;i.default.afterNextFlush((()=>{const t=I.E.findEditableWithStore(this.props.store),n=this.isEditing.state;e&&n&&!this.componentIsMounted&&!t&&f.ZH(this.environment)}))}}shouldComponentUpdate(e){return!0}getContextClosestSelectable(){var e;return null===(e=this.context.selectable)||void 0===e?void 0:e.closestSelectable}getContextClosestSelectableStore(){var e;return null===(e=this.context.selectable)||void 0===e||null===(e=e.closestSelectable)||void 0===e||null===(e=e.props)||void 0===e?void 0:e.store}renderComponent(){const{disabled:e,disableUpDownArrows:t,disableEnter:n}=this.props,o=this.isEditing.state;return(0,F.jsx)(B.Z,{debugName:"Editable",capture:o&&!e,onDelete:this.getShortcutHandler("onDelete"),onDeleteToEndOfLine:this.getShortcutHandler("onDeleteToEndOfLine"),onDeleteNextWord:this.getShortcutHandler("onDeleteNextWord"),onBackspace:this.getShortcutHandler("onBackspace"),onEnter:n?void 0:this.getShortcutHandler("onEnter"),onShiftEnter:this.getShortcutHandler("onShiftEnter"),onCommandEnter:this.getShortcutHandler("onCommandEnter"),onCommandShiftEnter:this.getShortcutHandler("onCommandShiftEnter"),onUp:t?void 0:this.getShortcutHandler("onUp"),onDown:t?void 0:this.getShortcutHandler("onDown"),onLeft:this.getShortcutHandler("onLeft"),onRight:this.getShortcutHandler("onRight"),onCommandLeft:this.getShortcutHandler("onCommandLeft"),onCommandRight:this.getShortcutHandler("onCommandRight"),onTab:this.getShortcutHandler("onTab"),onUntab:this.getShortcutHandler("onUntab"),onSelectAll:this.getShortcutHandler("onSelectAll"),onToggleUnderline:this.getShortcutHandler("onToggleUnderline"),onToggleHighlight:this.getShortcutHandler("onToggleHighlight"),onToggleBold:this.getShortcutHandler("onToggleBold"),onToggleItalics:this.getShortcutHandler("onToggleItalics"),onToggleStrike:this.getShortcutHandler("onToggleStrike"),onToggleCode:this.getShortcutHandler("onToggleCode"),onUndo:this.getShortcutHandler("onUndo"),onRedo:this.getShortcutHandler("onRedo"),onEsc:this.getShortcutHandler("onEsc"),onCut:this.getShortcutHandler("onCut"),onCopy:this.getShortcutHandler("onCopy"),onPaste:this.getShortcutHandler("onPaste"),onKeypress:this.getShortcutHandler("onKeyPress"),onMoveUp:this.getShortcutHandler("onMoveUp"),onMoveDown:this.getShortcutHandler("onMoveDown"),onHome:this.saveSerializedTextSelectionAfterFlush,onEnd:this.saveSerializedTextSelectionAfterFlush,onGoToBeginningOfLine:this.getShortcutHandler("onGoToBeginningOfLine"),onGoToEndOfLine:this.getShortcutHandler("onGoToEndOfLine"),onGoForwardOneChar:this.saveSerializedTextSelectionAfterFlush,onGoBackwardOneChar:this.saveSerializedTextSelectionAfterFlush,children:this.renderDraggable()})}renderDraggable(){const e=this.isEditing.state;return(0,F.jsx)(E.Z,{disabled:this.props.disableDrag,onDraggableDragStart:this.handleDragStart,onDraggableDragMove:this.handleDragMove,onDraggableDragEnd:this.handleDragEnd,onDraggableDragCancel:e=>{return t=this.environment,void(T.ZP.state.isDragging&&(c.cQ(t),m.ZH(t)));var t},cursor:"text",render:t=>this.props.render((0,y.Z)(t,{leafRef:this.contentEditableLeafRef,wrapperRef:this.wrapperRef,onClick:this.handleClick,onContextMenu:this.handleContextMenu,onKeyDown:N,onDoubleClick:L}),this.handleSelect,Boolean(e)),enableAndroidContextMenu:this.props.disabled,disableHorizontalEdgeScroll:this.props.disableHorizontalEdgeScroll})}getShortcutHandler(e){const t=this.props[e],n=this.defaultShortcutHandlers[e];return t??n}saveSerializedTextSelection(e){const t=w.get();if((0,S.Aw)(this.environment)){var n;const e=(0,S.fx)({contentEditableLeafRegistry:null===(n=this.contentEditableContext)||void 0===n?void 0:n.contentEditableLeafRegistry,range:t,allowInvisibleEndSelection:(0,b.yA)().shift});return e?void f.bc({environment:this.environment,...e,readOnly:"infer",focus:void 0}):void 0}const o=V(t,this.environment);if(o){const e="empty"!==D.default.state.mode&&(0,S.xI)("Editable",D.default.state.multiSelection);if(e&&e.store===this.props.store&&a.Xy(e.selection,o.selection)&&!o.forceEmitSelectionStore)return;f.Z5({store:this.props.store,selection:o.selection,readOnly:this.props.disabled}),o.forceEmitSelectionStore&&D.default.emit()}}}O.displayName="Editable",O.contextTypes={...g.Tf,...r.w};const Z=O;function V(e,t){return(0,h.Ut)(t,e)}function U(e,t){const n=D.default.state;"empty"!==n.mode&&i.default.afterNextFlush((()=>{const{start:o,end:r}=n.multiSelection;switch(e){case"start":{const e=o.store.getValue();if(!e)return;const n=s.Oqk({textValue:e,substring:"\n",ignoreCase:!1}).reverse().find((e=>{let{endIndex:t}=e;return t<=o.index})),i=(null==n?void 0:n.endIndex)??0,a={store:o.store,index:i};f.NA({multiSelection:{start:a,end:t?r:a}});break}case"end":{const e=(0,k.x0)(r.store);if(!e)return;const n=o.store.getValue();if(!n)return;const i=s.Oqk({textValue:n,substring:"\n",ignoreCase:!1}).find((e=>{let{startIndex:t}=e;return t>=r.index})),a=(null==i?void 0:i.startIndex)??e.endIndex,l={store:r.store,index:a};f.NA({multiSelection:{start:t?o:l,end:l}});break}default:(0,l.t1)(e)}}))}function N(e){e.metaKey||e.ctrlKey||e.altKey||M.Z.setKeyboardMode(!0)}function L(e){(0,v.ZP)({event:e,context:v.Af.EditorDoubleClick,callback:()=>{}})}},33742:(e,t,n)=>{n.d(t,{P9:()=>Cn,M1:()=>Dn,ZP:()=>Rn,ar:()=>In});var o=n(67294),r=n(73935),i=n(18466),a=n(13991),s=n(480),l=n(53150),c=n(6740),d=n(24405),u=n(49085),p=n(41432),m=n(8848),f=n(95538),g=n(9999),h=n(82477),v=n(70622),b=n(53376),y=n(49089),_=n(42853),S=n(45238),w=n(85893);const k=(0,S.I)("compass",{viewBox:"0 0 30 30",svg:(0,w.jsx)("path",{d:"M18,4.361V3c0-1.657-1.343-3-3-3s-3,1.343-3,3v1.361C6.27,5.718,2,10.854,2,17c0,7.18,5.82,13,13,13s13-5.82,13-13 C28,10.854,23.73,5.718,18,4.361z M14,3c0-0.552,0.448-1,1-1s1,0.448,1,1v1.051C15.669,4.025,15.338,4,15,4s-0.669,0.025-1,0.051V3z M16,27.949V26h-2v1.949C8.724,27.474,4.526,23.276,4.051,18H6v-2H4.051C4.526,10.724,8.724,6.526,14,6.051V8h2V6.051 c5.276,0.476,9.474,4.673,9.949,9.949H24v2h1.949C25.474,23.276,21.276,27.474,16,27.949z M8,24l10-4l4-10l-10,4L8,24z M18.41,13.59 l-1.949,4.871L11.59,20.41l1.949-4.871L18.41,13.59z"})});var I=n(64330),C=n(37240),x=n(95855),T=n(30845),M=n(72126),P=n(23210),A=n(70203),R=n(82990),D=n(9291),E=n(88864),B=n(57549),F=n(54564),O=n(47307),Z=n(31781),V=n(96802),U=n(27153),N=n(42858),L=n(24677),j=n(98104),z=n(82530),q=n(18821),H=n(95477),W=n(95645),K=n(28020),G=n(43250),$=n(41232),Q=n(33929),Y=n(98742),X=n(17504),J=n(65598),ee=n(18245),te=n(68859),ne=n(61766),oe=n(88632),re=n(80796);class ie extends u.default{getInitialState(){return{hovered:!1,focused:!1,isInFrame:!1}}}const ae=ie;var se=n(77080),le=n(27411),ce=n(69784),de=n(86628),ue=n(12534),pe=n(96049),me=n(83355),fe=n(43593),ge=n(80750);const he=(0,S.I)("imageError",{viewBox:"0 0 32 32",svg:(0,w.jsxs)(o.Fragment,{children:[(0,w.jsx)("path",{d:"M6.39515 31.0485c3.44161 0 6.29115-2.8495 6.29115-6.2911 0-3.4355-2.8557-6.2912-6.29732-6.2912-3.43544 0-6.28495 2.8557-6.28495 6.2912 0 3.4416 2.85568 6.2911 6.29112 6.2911zm-.00617-5.366c-.32689 0-.50575-.1912-.51809-.5181l-.08635-3.0468c-.01233-.3393.24671-.5798.59828-.5798.34539 0 .61677.2467.60444.5859l-.09252 3.0407c-.01233.3331-.1912.5181-.50576.5181zm0 2.2698c-.35773 0-.69078-.2838-.69078-.6662s.32689-.6661.69078-.6661c.3639 0 .69079.2776.69079.6661 0 .3886-.33305.6662-.69079.6662z"}),(0,w.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M4 17.5539V3h26v26H12.6862c.4113-.6095.7364-1.282.9578-2H28v-4H13.7749c-.1687-.7106-.4373-1.3825-.7902-2H28V5H6v12.1798c-.69548.0352-1.36626.164-2 .3741zM11.3329 19c-.6875-.5905-1.48192-1.0601-2.35027-1.3757L13 12l2 1 5-5 6 11H11.3329zM12 9c0 1.104-.896 2-2 2s-2-.896-2-2 .896-2 2-2 2 .896 2 2zm3.395 6.434l-1.76-.881L11.887 17h10.744l-3.107-5.695-4.129 4.129z"})]})}),ve=(0,S.I)("playbackError",{viewBox:"0 0 32 32",svg:(0,w.jsxs)(o.Fragment,{children:[(0,w.jsx)("path",{d:"M6.39515 29.0485c3.44161 0 6.29115-2.8495 6.29115-6.2911 0-3.4355-2.8557-6.2912-6.29732-6.2912-3.43544 0-6.28495 2.8557-6.28495 6.2912 0 3.4416 2.85568 6.2911 6.29112 6.2911zm-.00617-5.366c-.32689 0-.50575-.1912-.51809-.5181l-.08635-3.0468c-.01233-.3393.24671-.5798.59828-.5798.34539 0 .61677.2467.60444.5859l-.09252 3.0407c-.01233.3331-.1912.5181-.50576.5181zm0 2.2698c-.35773 0-.69078-.2838-.69078-.6662s.32689-.6661.69078-.6661c.3639 0 .69079.2776.69079.6661 0 .3886-.33306.6662-.69079.6662z"}),(0,w.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M29.1373 16.1987c0 6.7017-5.542 12.2437-12.2436 12.2437-1.622 0-3.1761-.3246-4.6001-.9118.3323-.4107.6226-.8567.8644-1.3316 1.1612.4325 2.4197.6687 3.7357.6687 5.9082 0 10.6689-4.7608 10.6689-10.669-.0122-5.9082-4.7729-10.65671-10.6812-10.65671-5.5497 0-10.08288 4.20726-10.5961 9.62871-.55173.0075-1.08925.0738-1.60656.193.4362-6.32082 5.78156-11.40862 12.20266-11.40862 6.7139 0 12.2559 5.54199 12.2559 12.24362zm-15.4585 4.4372a7.628 7.628 0 00-.0797-.2566.65573.65573 0 01-.0013-.0424v-8.2764c0-.5004.5859-.7202 1.0498-.4516l6.7016 4.0161c.4395.2686.4517.8911 0 1.1597l-6.7016 3.9917c-.3763.2257-.796.1398-.9688-.1405z"})]})});var be=n(97880),ye=n(64002),_e=n(25888),Se=n(24608),we=n(18514),ke=n(16354),Ie=n(64369);function Ce(e){switch(e){case"image":return he;case"audio":case"video":return ve;default:return ge.l}}function xe(e,t){if(e&&e instanceof Se.Gg){let n=t||e.data.url;return ye.j3(n)&&(n=ye.O_({relativeUrl:n,baseUrl:H.default.domainBaseUrl})),e.data.offline?ye.j3(e.data.url)||e.data.url.startsWith(H.default.domainBaseUrl)?{type:"offline"}:{type:"unknown",source:n}:{type:"http",source:n,statusCode:e.data.status}}}function Te(e,t){const n=e.error,o=t||e.src;if(n)return n.code===n.MEDIA_ERR_DECODE||n.code===n.MEDIA_ERR_SRC_NOT_SUPPORTED?{type:"unsupported_content_type",extension:o&&(0,fe.mD)(o)}:n.code===n.MEDIA_ERR_NETWORK?{type:"offline"}:void 0}function Me(){return(0,w.jsx)(D.FormattedMessage,{id:"embedError.extension.unknown",defaultMessage:"unknown"})}function Pe(e){const{source:t,statusCode:n}=e,o=ye.Qc(t).hostname;return(0,w.jsx)(D.FormattedMessage,{defaultMessage:"{hostname} (Error {statusCode})",id:"embedError.hostnameAndStatusCode",values:{hostname:o,statusCode:n}})}function Ae(e){switch(e){case"audio":return(0,we.UY)("guides.audioFaqs");case"video":return(0,we.UY)("guides.videosFaqs");case"image":return(0,we.UY)("guides.imagesFaqs");default:return(0,we.UY)("guides.embedsFaqs")}}class Re extends me.Z{didMount(){E.QU(this.environment,{embedType:this.props.family,embedErrorType:this.props.error.type})}renderComponent(){const{style:e,error:t,family:n,isSmall:o}=this.props,r={background:this.theme.embedPlaceholderBackground,cursor:"default",...e||{},position:"absolute",top:0,bottom:0,left:0,right:0,display:"flex",alignContent:"center",alignItems:"center",justifyContent:o?"flex-start":"center",padding:o?"7px 14px":"0.5em 1em",textAlign:"center",flexDirection:o?"row":"column",overflow:"hidden"},i=o?25:48,a=o?"0px 14px 0 0":"0 0 14px 0",s=function(e,t){return"image"===t?"unsupported_content_type"===e.type?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This image format ({extension}) can't be played on this device.",id:"embedError.image.unsupportedContentType",values:{extension:e.extension||Me()}}):"offline"===e.type?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"Go online to view this image",id:"embedError.image.offline"}):"unknown"===e.type||"invalid_protocol"===e.type||"invalid_url"===e.type?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This image couldn't be loaded.",id:"embedError.image.unknown"}):404===e.statusCode?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This image couldn't be found.",id:"embedError.image.notFound"}):401===e.statusCode||403===e.statusCode?(0,w.jsx)(D.FormattedMessage,{id:"embedError.image.permissionDenied",defaultMessage:"Permission denied."}):(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This image couldn't be loaded.",id:"embedError.image.serverError"}):"audio"===t?"unsupported_content_type"===e.type?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This audio format ({extension}) can't be played on this device.",id:"embedError.audio.unsupportedContentType",values:{extension:e.extension||Me()}}):"offline"===e.type?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"Go online to view this audio",id:"embedError.audio.offline"}):"unknown"===e.type||"invalid_protocol"===e.type||"invalid_url"===e.type?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This audio couldn't be loaded.",id:"embedError.audio.unknown"}):404===e.statusCode?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This audio couldn't be found.",id:"embedError.audio.notFound"}):401===e.statusCode||403===e.statusCode?(0,w.jsx)(D.FormattedMessage,{id:"embedError.audio.permissionDenied",defaultMessage:"Permission denied."}):(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This audio couldn't be loaded.",id:"embedError.audio.serverError"}):"video"===t?"unsupported_content_type"===e.type?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This video format ({extension}) can't be played on this device.",id:"embedError.video.unsupportedContentType",values:{extension:e.extension||Me()}}):"offline"===e.type?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"Go online to view this video",id:"embedError.video.offline"}):"unknown"===e.type||"invalid_protocol"===e.type||"invalid_url"===e.type?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This video couldn't be loaded.",id:"embedError.video.unknown"}):404===e.statusCode?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This video couldn't be found.",id:"embedError.video.notFound"}):401===e.statusCode||403===e.statusCode?(0,w.jsx)(D.FormattedMessage,{id:"embedError.video.permissionDenied",defaultMessage:"Permission denied."}):(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This video couldn't be loaded.",id:"embedError.video.serverError"}):"file"===t?"unsupported_content_type"===e.type?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This file format ({extension}) can't be played on this device.",id:"embedError.file.unsupportedContentType",values:{extension:e.extension||Me()}}):"offline"===e.type?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"Go online to view this file",id:"embedError.file.offline"}):"unknown"===e.type||"invalid_protocol"===e.type||"invalid_url"===e.type?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This file couldn't be loaded.",id:"embedError.file.unknown"}):404===e.statusCode?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This file couldn't be found.",id:"embedError.file.notFound"}):401===e.statusCode||403===e.statusCode?(0,w.jsx)(D.FormattedMessage,{id:"embedError.file.permissionDenied",defaultMessage:"Permission denied."}):(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This file couldn't be loaded.",id:"embedError.file.serverError"}):"embed"===t?"unsupported_content_type"===e.type?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This embed format ({extension}) can't be played on this device.",id:"embedError.embed.unsupportedContentType",values:{extension:e.extension||Me()}}):"offline"===e.type?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"Go online to view this embed",id:"embedError.embed.offline"}):"unknown"===e.type||"invalid_protocol"===e.type||"invalid_url"===e.type?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This embed couldn't be loaded.",id:"embedError.embed.unknown"}):404===e.statusCode?(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This embed couldn't be found.",id:"embedError.embed.notFound"}):401===e.statusCode||403===e.statusCode?(0,w.jsx)(D.FormattedMessage,{id:"embedError.embed.permissionDenied",defaultMessage:"Permission denied."}):(0,w.jsx)(D.FormattedMessage,{defaultMessage:"This embed couldn't be loaded.",id:"embedError.embed.serverError"}):void(0,be.t1)(t)}(t,n);return(0,w.jsxs)("div",{style:r,children:[Ce(n)({fill:this.theme.lightTextColor,width:i,height:i,margin:a}),(0,w.jsxs)(Ie.Z,{isSecondaryColor:!0,isMultiline:!o,style:{margin:a},children:[(0,w.jsx)("div",{style:{display:o?"inline-block":"block",marginRight:o?"14px":void 0},children:s}),"offline"!==t.type&&(0,w.jsx)(ke.Z,{style:{display:"inline",pointerEvents:"auto",cursor:"auto",borderBottom:`1px solid ${this.theme.lightTextColor}`},href:Ae(n),external:!0,onClick:()=>{_e.Fs(this.environment,{from:"embed_error"})},children:(0,w.jsx)(D.FormattedMessage,{defaultMessage:"Learn more",id:"embedError.learnMore"})})]}),!o&&"http"===t.type&&(0,w.jsx)(Ie.Z,{isSmall:!0,isSecondaryColor:!0,children:Pe(t)}),!o&&"unknown"===t.type&&t.source&&(0,w.jsx)(Ie.Z,{isSmall:!0,isSecondaryColor:!0,children:ye.Qc(t.source).hostname})]})}}Re.displayName="EmbedErrorBox";const De=Re;var Ee=n(35021);let Be=null;const Fe=u.default.createClass(void 0);function Oe(e){let{source:t,contentWrapStyle:n,handleEmbedComp:r,contentStyle:i}=e;window.__c={n:"AudioBox"};const a=(0,de.qz)(void 0,Fe),s=(0,o.useCallback)((e=>function(e,t,n){const o=Te(e.currentTarget,t);o&&n.setState(o)}(e,t,a)),[t,a]),l=(0,de.VK)((()=>function(e){return{...e,pointerEvents:pe.Z.state?"none":"auto",position:"relative"}}(i)),[i]);return(0,w.jsx)("div",{style:n,onMouseDown:ue.$0,onTouchStart:ue.$0,children:(0,w.jsxs)("div",{style:l,children:[(0,w.jsx)("audio",{ref:e=>r(e),style:l,controls:!0,preload:"none",onError:s,onPlay:Ve,onPause:Ue,src:t}),(0,w.jsx)(Ne,{errorStore:a})]})})}const Ze={render:function(e){const{contentStyle:t,contentWrapStyle:n,handleEmbedComp:o}=e;return(0,w.jsx)(Ee.Z,{url:e.source,permissionRecord:e.store.pointer,useS3Url:e.useS3Url,render:(e,r,i)=>i?r?(0,w.jsx)(Oe,{contentStyle:t,contentWrapStyle:n,source:r,handleEmbedComp:o}):void 0:(0,w.jsx)("div",{})})},resizable:!1,hideActions:!0,rendererType:"audio"};function Ve(e){Be&&Be.pause(),Be=e.currentTarget}function Ue(e){Be===e.currentTarget&&(Be=null)}function Ne(e){let{errorStore:t}=e;window.__c={n:"ErrorComponent"};const n=(0,de.VK)((()=>t.state),[t]);return n?(0,w.jsx)(De,{family:"audio",error:n,isSmall:!0}):null}var Le=n(13966),je=n(91893),ze=n(23864),qe=n(70518),He=n(68709),We=n(64921),Ke=n(31945),Ge=n(89728),$e=n(26388),Qe=n(24098),Ye=n(73959),Xe=n(77907),Je=n(27724),et=n(1743);function tt(e){window.__c={n:"DrawingBox"};const t=(0,s.O7)(),n=(0,de.VK)((()=>(0,Ye.iZ)(e.store)),[e.store]),r=(0,d.yK)((t=>({sizer:{height:e.height,display:"flex",borderRadius:3,paddingTop:2,paddingLeft:10,paddingRight:10,paddingBottom:10},border:{display:"flex",flex:1,margin:2,padding:3,boxShadow:n?t.outlineBlueInputBoxShadow:void 0,outline:`1px solid ${t.regularDividerColor}`,transition:"box-shadow 0.1s ease-in-out",willChange:"box-shadow",borderRadius:3},ignoreClickArea:{flex:1,position:"relative"}})),[n,e.height]),i=(0,o.useCallback)((()=>{j.ZH({device:t.device}),L.Z5({environment:t,stores:[e.store],phase:Je.SelectionPhase.Editing})}),[t,e.store]),a=(0,o.useCallback)((t=>(0,w.jsx)("div",{...t,style:r.ignoreClickArea,className:"notion-disable-webkit-user-select",children:(0,w.jsx)(Xe.LazyTldrawAdapter,{...e,isEditing:n})})),[r.ignoreClickArea,e,n]);return(0,w.jsx)("div",{style:r.sizer,onPointerDown:i,children:(0,w.jsx)("div",{style:r.border,children:(0,w.jsx)(et.Z,{debugName:"DrawingBox",capture:n,allowEsc:!0,children:(0,w.jsx)(Qe.Z,{capture:!0,render:a})})})})}const nt={render:e=>(0,w.jsx)(tt,{...e}),resizable:!0,hideActions:!0,rendererType:"drawing"};var ot=n(84939);const rt=(0,S.I)("cornerResize",{viewBox:"0 0 16 16",svg:(0,w.jsx)("path",{fillRule:"evenodd",strokeWidth:"1.5",d:"M 14 0C 12.8955 0 12 0.895447 12 2L 12 12L 2 12C 0.895508 12 0 12.8954 0 14C 0 15.1046 0.895508 16 2 16L 14 16C 15.1045 16 16 15.1046 16 14L 16 2C 16 0.895447 15.1045 0 14 0Z"})});function it(e){let{store:t,resizerType:n,resizerAlignment:r,resizeComponent:i,preserveScale:a,isHovered:l,blockResizerStore:c}=e;window.__c={n:"EmbedBlockResizer"};const d=(0,s.O7)(),u=(0,s.Fy)(),p=(0,de.qz)(c,te.Z),f=(0,de.VK)((()=>!u.isMobile&&l),[u.isMobile,l]),g=(0,de.VK)((()=>{const e={position:"absolute",pointerEvents:f?"auto":"none",display:"flex",alignItems:"center",justifyContent:"center"};return r===qe.bZ.Right?e.right=0:r===qe.bZ.Left&&(e.left=0),n===qe.IS.Horizontal?(e.top=0,e.zIndex=1,e.height="100%",e.width=at,e.cursor="col-resize"):n===qe.IS.Vertical?(e.bottom=0,e.zIndex=1,e.width="100%",e.height=at,e.cursor="row-resize"):n===qe.IS.Corner&&(e.zIndex=2,e.bottom=0,e.width=e.height=lt,r===qe.bZ.Left?e.cursor="nesw-resize":r===qe.bZ.Right&&(e.cursor="nwse-resize")),e}),[r,n,f]),h=(0,o.useMemo)((()=>{const e={position:"absolute"};return n===qe.IS.Vertical||n===qe.IS.Corner?e.bottom=st:n===qe.IS.Horizontal&&(e.top=st),r===qe.bZ.Left?e.left=st:r===qe.bZ.Right&&(e.right=st),{...g,style:e}}),[r,g,n]),v=(0,de.VK)((()=>{const{ThemeStore:e}=d,t=e.state.mode,o={opacity:f?1:0,transition:Cn,borderRadius:20,background:(0,ot.Fq)(m.se[t].black,.6),border:`1px solid ${m.ZP.whiteWithAlpha(.9)}`};return n===qe.IS.Horizontal?(o.width=6,o.height=48,o.maxHeight="50%"):n===qe.IS.Vertical&&(o.height=6,o.width=48,o.maxWidth="50%"),o}),[d,n,f]),b=(0,o.useMemo)((()=>n===qe.IS.Corner?rt({stroke:m.ZP.whiteWithAlpha(.5),fill:m.ZP.blackWithAlpha(.65),width:lt,height:lt,transition:`opacity ${Cn}`,opacity:f?1:0,position:"relative",bottom:3,left:r===qe.bZ.Left?3:-3,transform:r===qe.bZ.Left?"rotate(90deg)":"none"}):(0,w.jsx)("div",{style:v})),[r,v,n,f]);return(0,w.jsx)(qe.ZP,{store:t,preserveScale:a,resizerType:n,resizerAlignment:r,resizeComponent:i,blockResizerStore:p,resizeHorizontally:!0,resizeVertically:!0,disabled:!1,children:(0,w.jsx)("div",{style:h,children:b})})}const at=15,st=0,lt=20;var ct=n(86329),dt=n(12457),ut=n(29477);let pt=0;const mt="notion_jsonp_callback_";function ft(e){const t=ut.UZ(),n=document.createElement("script");n.type="text/javascript";const o=function(){const e=mt+pt;return pt++,e}();window[o]=e=>{delete window[o],n.parentNode&&n.parentNode.removeChild(n),t.resolve(e)};const r=ye.SK(e,{callback:o});return n.src=r,n.onerror=e=>{delete window[o],n.parentNode&&n.parentNode.removeChild(n),t.reject(e)},document.head&&document.head.appendChild(n),t.promise}class gt extends u.default{getInitialState(){return{loading:!0,error:!1,html:void 0}}}const ht=gt;var vt=n(68785);const bt={userSelect:"none",padding:"6px 10px",borderRadius:4,border:"1px solid #dddddd",fontSize:14,width:"100%"};class yt extends me.Z{constructor(){super(...arguments),this.storeTypes={store:ht}}async didMount(){const e=`https://gist.github.com/${function(e){const{pathname:t}=ye.Qc(e);return(t||"").split("/").pop()}(this.props.source)}.json`;try{const n=await ft(e);this.stores.store.setState({loading:!1,error:!1,html:n.div});if(!document.querySelector(`link[href="${n.stylesheet}"]`)){var t=document.createElement("link");t.type="text/css",t.rel="stylesheet",t.href=n.stylesheet,document.head&&document.head.appendChild(t)}}catch(n){this.stores.store.setState({loading:!1,error:!0,html:void 0})}}renderComponent(){return(0,w.jsx)("div",{children:(0,w.jsx)(Qe.Z,{capture:!0,render:e=>(0,w.jsx)("div",{...e,ref:this.props.handleEmbedComp,style:wt(this.stores.store),children:(0,w.jsx)(St,{store:this.stores.store})})})})}}yt.displayName="GistBox";const _t={render:function(e){const{source:t,handleEmbedComp:n}=e;return(0,w.jsx)(yt,{source:t,handleEmbedComp:n})},renderFullScreen:void 0,resizable:!0,embedGhost:!0,hideActions:!0};function St(e){let{store:t}=e;window.__c={n:"GistComponent"};const{error:n,html:o,loading:r}=(0,de.VK)((()=>t.state),[t]);return(0,w.jsx)(dt.Z,{show:r,showDelay:1e3,showHold:500,render:e=>e||r?(0,w.jsx)("div",{style:{marginBottom:"1em"},children:(0,w.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",opacity:e?1:0,...bt},children:[(0,w.jsx)(vt.Z,{}),(0,w.jsx)("div",{style:{marginLeft:8},children:(0,w.jsx)(D.FormattedMessage,{defaultMessage:"Loading gist",id:"githubGistRenderer.loading.message"})})]})}):n?(0,w.jsx)("div",{style:{marginBottom:"1em"},children:(0,w.jsx)("div",{style:bt,children:(0,w.jsx)(D.FormattedMessage,{defaultMessage:"Error loading gist",id:"githubGistRenderer.errorLoading.message"})})}):(0,w.jsx)("div",{dangerouslySetInnerHTML:{__html:o??""},className:"notion-gist-block"})})}function wt(e){return e.state.html?{width:"100%",marginBottom:"-1em",overflowY:"auto",height:"100%",pointerEvents:pe.Z.state?"none":"auto"}:{width:"100%",marginBottom:"-1em"}}var kt=n(63085),It=n(25777),Ct=n(49271),xt=n(69721);const Tt=function(e){const{signedUrl:t,dataSize:n,dataName:o,contentWrapStyle:r,disabled:i,viewOriginal:a}=e,s={paddingTop:Ct.ZD.paddingTop,paddingBottom:Ct.ZD.paddingBottom,paddingLeft:Ct.ZD.paddingLeft};return(0,w.jsx)("div",{style:r,onClick:void 0,onMouseDown:ue.$0,children:(0,w.jsx)("div",{style:{position:"relative"},children:t&&(0,w.jsx)(xt.S,{title:o,url:t,size:n,onClick:i?void 0:a,style:s})})})};var Mt=n(84456),Pt=n(23586);const At=(0,S.I)("play",{viewBox:"0 0 14 16",svg:(0,w.jsx)("path",{d:"M1.34699 16C1.73805 16 2.07697 15.8756 2.52017 15.6089L12.8703 9.47556C13.6437 9.01333 14 8.62222 14 8C14 7.37778 13.6437 6.98667 12.8703 6.52444L2.52017 0.391111C2.07697 0.133333 1.73805 0 1.34699 0C0.582247 0 0 0.595556 0 1.57333V14.4356C0 15.4044 0.582247 16 1.34699 16Z"})}),Rt=e=>{let{url:t,metadata:n}=e;window.__c={n:"IFramePreviewRenderer"};const o=(0,d.yK)((e=>({previewWrapper:{display:"flex",flexDirection:"column",border:`1px solid ${e.darkDividerColor}`,borderRadius:"3px",height:"100%"},previewImageArea:{flex:1,backgroundColor:e.embedPlaceholderBackground},previewInfoArea:{padding:"0.75em 1em",backgroundColor:e.regularInvertedTextColor,display:"flex",flexDirection:"column",gap:"0.25em"},previewTitle:{fontWeight:R.Z.fontWeight.medium,color:e.darkTextColor},previewUrl:{display:"flex",alignItems:"center",gap:"0.75em"},previewUrlText:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",color:e.lightTextColor},previewUrlFavicon:{width:"1.25em",height:"1.25em"}})),[]),r=null!=n&&n.images&&n.images.length>0?n.images[0].url:void 0;return(0,w.jsxs)("div",{style:o.previewWrapper,children:[(0,w.jsx)("div",{style:o.previewImageArea,children:r?(0,w.jsx)(Dt,{imageUrl:r}):(0,w.jsx)(Et,{})}),(0,w.jsxs)("div",{style:o.previewInfoArea,children:[(null==n?void 0:n.title)&&(0,w.jsx)("div",{style:o.previewTitle,children:n.title}),(0,w.jsxs)("div",{style:o.previewUrl,children:[(null==n?void 0:n.favicon_url)&&(0,w.jsx)("img",{style:o.previewUrlFavicon,src:n.favicon_url}),(0,w.jsx)("div",{style:o.previewUrlText,children:t})]})]})]})},Dt=e=>{let{imageUrl:t}=e;window.__c={n:"EmbedPreviewArea"};const n=(0,d.yK)((e=>({wrapper:{display:"flex",flexDirection:"column",justifyContent:"flex-end",alignItems:"flex-start",height:"100%",backgroundSize:"cover",backgroundImage:`url(${t})`},pill:{backgroundColor:e.accentColors.gray[800],color:e.accentColors.gray[50],borderRadius:"99em",padding:"0.5em 1em",margin:"1em",display:"flex",alignItems:"center",gap:"0.75em",fontWeight:R.Z.fontWeight.medium},playButton:{width:"1em",height:"1em",fill:e.accentColors.gray[50]}})),[t]);return(0,w.jsx)("div",{style:n.wrapper,children:(0,w.jsxs)("div",{style:n.pill,children:[At(n.playButton),(0,w.jsx)("span",{children:(0,w.jsx)(D.FormattedMessage,{defaultMessage:"Load embed",id:"iFramePreview.pillLabel"})})]})})},Et=()=>{window.__c={n:"ImagelessArea"};const e=(0,d.yK)((e=>({wrapper:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",color:e.mediumTextColor,height:"100%"},message:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",gap:"0.75em",fontWeight:R.Z.fontWeight.medium},playButtonWrapper:{backgroundColor:e.mediumTextColor,borderRadius:"2em",width:"2.5em",height:"2.5em",display:"flex",justifyContent:"center",alignItems:"center"},playButton:{marginLeft:"0.1em",width:"1em",height:"1em",fill:e.embedPlaceholderBackground}})),[]);return(0,w.jsx)("div",{style:e.wrapper,children:(0,w.jsxs)("div",{style:e.message,children:[(0,w.jsx)("div",{style:e.playButtonWrapper,children:At(e.playButton)}),(0,w.jsx)("span",{children:(0,w.jsx)(D.FormattedMessage,{defaultMessage:"Tap to load embed",id:"iFramePreview.imagelessAreaLabel"})})]})})};function Bt(e){let{source:t}=e;window.__c={n:"IFramePreview"};const n=(0,s.O7)(),o={request:t,performRequest:e=>async function(e,t){return(0,kt.W4)(t,e)}(e,n),render:(e,n,o)=>(0,w.jsx)(Ft,{error:e,result:n,ready:o,source:t})};return(0,w.jsx)(Pt.Z,{...o})}function Ft(e){let{error:t,result:n,ready:o,source:r}=e;return o?(0,w.jsx)(Rt,{url:r,metadata:n}):null}const Ot={position:"absolute",left:0,top:0,width:"100%",height:"100%",borderRadius:1};function Zt(e){const{render:t,style:n,errorStyle:o,...r}=e,i=(0,kt.NX)(e.url);return(0,w.jsx)(Ee.Z,{...r,render:(r,a,s)=>{let l=i;return r&&!l&&(l=(0,kt.sj)(r)??{type:"unknown",source:e.url}),(0,w.jsx)("div",{style:n,children:(0,w.jsx)(It.Z,{innerStyle:{height:"100%",width:"100%"},loaded:s,style:Ot,spinnerSize:"1em",showSpinnerTimeout:500,children:l?(0,w.jsx)("div",{style:o,children:(0,w.jsx)(De,{family:"embed",error:l})}):t(a)})})}})}function Vt(e){window.__c={n:"FullScreenIFrameRenderer"};const{height:t,source:n,contentStyle:r,dataName:i,dataSize:a,width:s}=e,[l,c]=(0,o.useState)(!1);return(0,w.jsx)(Zt,{url:n,permissionRecord:e.store.pointer,useS3Url:e.useS3Url,style:{width:"100%",height:"100%"},errorStyle:{height:t,width:s},render:n=>l&&i&&a?(0,w.jsx)(Tt,{...e,dataName:i,dataSize:a,signedUrl:n}):n&&(0,w.jsx)(Mt.Z,{source:n,isFullWidth:!0,isFullHeight:!0,height:t,style:r,background:!0,onContentLoadTimeout:()=>c(!0)})})}const Ut={render:function(e){window.__c={n:"IFrameRenderer"};const{disabled:t,contentStyle:n,contentWrapStyle:r,handleFullScreen:i,handleEmbedComp:a,height:s,preserveScale:l,isFullWidth:c,source:d,dataName:u,dataSize:p}=e,[m,f]=(0,o.useState)(!1),g=(0,kt.kl)({height:s,isFullWidth:c,preserveScale:l});return(0,w.jsx)(Zt,{url:d,permissionRecord:e.store.pointer,useS3Url:e.useS3Url,style:g,errorStyle:{position:"relative",height:s},render:o=>m&&u&&p?(0,w.jsx)(Tt,{...e,dataName:u,dataSize:p,signedUrl:o}):(0,w.jsx)("div",{style:r,onClick:t?i:void 0,onMouseDown:ue.$0,children:(0,w.jsx)("div",{style:{position:"relative"},children:o&&(0,w.jsx)(Mt.Z,{ref:e=>a(e),source:o,height:s,style:n,preserveScale:l,isFullWidth:c,background:!0,renderPreview:()=>(0,w.jsx)(Bt,{source:(0,kt.cJ)(e)}),onContentLoadTimeout:()=>f(!0)})})})})},embedGhost:!0,renderFullScreen:e=>(0,w.jsx)(Vt,{...e}),resizable:!0},Nt=Ut;var Lt=n(10517),jt=n.n(Lt),zt=n(54642),qt=n(24042),Ht=n(12981),Wt=n(32854),Kt=n(81865),Gt=n(5377);function $t(e){const{file:t,fileName:n,fileSize:o,progressPercent:r}=e;return(0,w.jsx)(ct.Z,{disabled:!0,iconSvg:Gt.y,isLoading:!0,progressPercent:r,file:t,name:n,size:o,onClick:()=>{}})}const Qt=u.default.createClass(void 0);function Yt(e){window.__c={n:"EmbedImageRenderer"};const{store:t,dataURL:n,source:r,isFullWidth:i,isRootChild:a,aspectRatio:l,height:c,dragging:u,blockWidth:p,isFullScreen:f}=e,g=(0,s.O7)(),h=(0,de.qz)(void 0,Qt),v=(0,de.VK)((()=>h.state),[h]),b=(0,de.VK)((()=>le.default.getKeyState(le.default.getBlockKey(t.id))),[t]),y=(0,o.useRef)(void 0),_=(0,o.useRef)(void 0),S=(0,o.useRef)(void 0);(0,o.useEffect)((()=>{null!=b&&b.file.type&&!Boolean(S.current)&&(S.current=null==b?void 0:b.file.type)}),[b]);const k=Boolean("image/heic"===S.current)&&(null==n?void 0:n.startsWith("blob:"))&&Boolean(!g.device.isSafari),I=(0,d.yK)((e=>{const t={};return i&&a||!l?c&&(t.height=c,t.background=m.ZP.contentGrayBackground):(t.height=0,t.paddingBottom=100*l+"%",t.background=m.ZP.contentGrayBackground),{content:{background:e.contentBackground},placeholder:t}}),[i,a,l,c]);if((0,o.useEffect)((()=>{if(n||!r||!g.mobileNative)return;if(_.current&&r===y.current)return;y.current=r;fe.E$(r,[H.default.secureFileS3.url,H.default.secureFileS3V2.url])&&zt.getSignedFileUrl(g,{url:r,download:!1,downloadName:"image",permissionRecord:t.pointer},Boolean(qt.Z.state.isNotionProtocolBugFixed)).then((e=>{_.current=e}))}),[g,y,_,r,t.pointer,n]),k&&b){const{file:e,name:t,size:n,progressPercent:o}=b;return(0,w.jsx)($t,{file:e,fileName:t,fileSize:n,progressPercent:o})}if(n)return(0,w.jsx)(Xt,{...e,proxyError:void 0,renderURL:n,embedError:v,environment:g,signedOriginalURLRef:_,onImageError:M,onImageLoad:P,styles:I});const C=i&&!u?void 0:p,x=window.innerWidth,T=C?Math.min(C,window.innerWidth):window.innerWidth;async function M(t,n){const o=fe.E$(e.source,[H.default.secureFileS3.url,H.default.secureFileS3V2.url])?n:e.source;if(n){const e=await(0,Se.ZP)({url:n,environment:g,method:"HEAD",format:"text"});if("failed"===e.type){const t=xe(e.error,o);if(t)return void h.setState(t)}}h.setState({type:"unknown",source:o})}function P(){h.setState(void 0)}return(0,w.jsx)(Kt.Z,{url:r,width:f?x:T,render:(t,n)=>(0,w.jsx)(Xt,{...e,proxyError:t,renderURL:n,embedError:v,environment:g,signedOriginalURLRef:_,onImageError:M,onImageLoad:P,styles:I}),isAuthenticated:!0,permissionRecord:t.pointer},`width-${e.contentStyle.width}`)}function Xt(e){window.__c={n:"RenderURL"};const{proxyError:t,renderURL:n,isFullScreen:r}=e,[i,a]=(0,o.useState)(n);(0,o.useEffect)((()=>{void 0!==n&&n!==i&&a(n)}),[i,n]);const s=xe(t,void 0)||(0,kt.sj)(t)||e.embedError;return r?(0,w.jsx)(en,{...e,embedError:s,renderURL:i}):(0,w.jsx)(Jt,{...e,embedError:s,renderURL:i})}function Jt(e){const{embedError:t,renderURL:n,progressPercent:o,disabled:r,isLoading:i,contentStyle:a,contentWrapStyle:s,handleFullScreen:l,handleEmbedComp:c,isFullWidth:d,isRootChild:u,height:p,inlineContentStyle:m,blockLocation:f,imageBoxRef:g,environment:h,onImageError:v,onImageLoad:b,signedOriginalURLRef:y,styles:_}=e,S=Z.qC(f),k=()=>{var e;if(E.QI(h,{from:"embedded_block_click",type:"image"}),!n)return;const t=0===n.indexOf("https:")?n:`${H.default.domainBaseUrl}${n}`;null===(e=h.mobileNative)||void 0===e||e.showLightBox({items:[{type:"image",previewUrl:jt()(t),originalUrl:jt()(y.current??t)}],startingIndex:0,from:"embedded_block_click"}),L.ZH(h),j.sD()},I=h.mobileNative&&!1===(null==n?void 0:n.startsWith("data:")),C=I?k:S?void 0:l,x=I?k:S?t=>nn(t,e.handleFullScreen):void 0,T=S?t=>nn(t,e.handleFullScreen):l;return(0,w.jsx)("div",{ref:e=>c(e),style:s,onClick:r&&!I?T:void 0,children:(0,w.jsxs)("div",{children:[(0,w.jsx)(Ht.Z,{alt:"",ref:g,src:n,loading:"lazy",isFullScreen:!1,style:{...a,...m},placeholderStyle:_.placeholder,onDoubleClick:C,onClick:x,height:d&&u?p:void 0,capMaxHeight:d&&u,onError:v,onLoad:b}),t&&(0,w.jsx)(De,{error:t,family:"image"}),i&&(0,w.jsxs)("div",{style:Ht.I,children:[(0,w.jsx)(vt.Z,{style:{width:16,height:16,marginRight:4}}),(0,w.jsx)("div",{style:{minWidth:30,textAlign:"right"},children:(0,w.jsx)(Wt.Z,{percentage:o})})]})]})})}function en(e){const{contentStyle:t,embedError:n,renderURL:o,onImageError:r,onImageLoad:i,styles:a}=e,s=Math.min(500,window.innerWidth-50);return(0,w.jsx)("div",{style:{alignSelf:"center",margin:0,position:"relative",minWidth:n?s:void 0},children:(0,w.jsxs)("div",{children:[(0,w.jsx)(Ht.Z,{src:o,isFullScreen:!0,style:{...t,background:a.content.background},placeholderStyle:a.placeholder,capMaxHeight:!1,onError:r,onLoad:i}),n&&(0,w.jsx)(De,{error:n,family:"image"})]})})}const tn={render:e=>(0,w.jsx)(Yt,{...e,isFullScreen:!1}),renderFullScreen:e=>(0,w.jsx)(Yt,{...e,isFullScreen:!0}),resizable:!0};function nn(e,t){e.stopPropagation(),t()}const on={render:function(e){const{disabled:t,contentStyle:n,contentWrapStyle:o,handleFullScreen:r,source:i,handleEmbedComp:a,height:s}=e;return(0,w.jsx)("div",{style:o,onClick:t?r:void 0,children:(0,w.jsx)("div",{style:{position:"relative"},children:(0,w.jsx)(Mt.Z,{ref:e=>a(e),source:i,height:s,style:n,background:!1,renderPreview:()=>(0,w.jsx)(Bt,{source:(0,kt.cJ)(e)})})})})},renderFullScreen:function(e){const{source:t,height:n,contentStyle:o}=e;return(0,w.jsx)(Mt.Z,{source:t,isFullWidth:!0,height:n,style:o,background:!0})},resizable:!0},rn=on;var an=n(53238),sn=n(83785);function ln(e){window.__c={n:"TweetBox"};const{handleEmbedComp:t,source:i,fullScreen:a}=e,s=(0,d.Fg)(),l=(0,d.yK)((e=>({main:{width:a?520:"100%",minWidth:"100%",pointerEvents:"auto",margin:a?"-10px auto":"-10px 0"},loading:{userSelect:"none",borderRadius:4,border:"1px solid #dddddd",fontSize:14,width:"100%",padding:"6px 10px"}})),[a]),c=(0,o.useCallback)((async e=>{if(!e)return;const{pathname:t}=ye.Qc(i),n=(t||"").split("/")[3],o={dnt:!0,lang:"en",width:"100%",theme:"dark"===s.mode?"dark":"light"};if(n&&window.twttr){e.innerHTML="";if(await window.twttr.widgets.createTweetEmbed(n,e,o))return}r.render((0,w.jsx)("div",{style:l.loading,children:"Error loading tweet"}),e)}),[i,l.loading,s.mode]);return(0,w.jsx)("div",{style:{display:"flex"},children:(0,w.jsx)("div",{style:{marginLeft:"auto",marginRight:"auto",maxWidth:420,minWidth:0,width:"100%"},children:(0,w.jsx)(Qe.Z,{capture:!0,render:e=>(0,w.jsx)("div",{...e,ref:e=>e&&t(e),style:l.main,children:(0,w.jsx)(sn.Z,{fetch:()=>n.e(898).then(n.bind(n,22062)),loading:e=>e&&(0,w.jsxs)("div",{style:{display:"inline-flex",alignItems:"center",...l.loading},children:[(0,w.jsx)(vt.Z,{}),(0,w.jsx)("div",{style:{marginLeft:8},children:(0,w.jsx)(D.FormattedMessage,{id:"tweetRenderer.loadingTweet.message",defaultMessage:"Loading Tweet"})})]}),render:()=>(0,w.jsx)("div",{ref:c})})})})})})}const cn={render:function(e){const{source:t,handleEmbedComp:n}=e;return(0,w.jsx)(ln,{source:t,handleEmbedComp:n,fullScreen:!1})},renderFullScreen:function(e){const{source:t,handleEmbedComp:n}=e;return(0,w.jsx)(ln,{source:t,handleEmbedComp:n,fullScreen:!0})},resizable:!1,embedGhost:!0,hideActions:!0},dn={position:"absolute",left:"50%",top:"50%",transform:"translate(-30%, -50%)",height:0,width:0,borderStyle:"solid",borderColor:m.ZP.uiBlack,borderRightWidth:0,borderLeftWidth:24.5,borderTopWidth:16.1,borderBottomWidth:16.1,borderTopColor:m.ZP.transparent,borderBottomColor:m.ZP.transparent},un={position:"relative",height:70,width:70,borderWidth:3,borderStyle:"solid",borderColor:m.ZP.uiBlack,borderRadius:70},pn={position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",cursor:"pointer"},mn=u.default.createClass(!1),fn=u.default.createClass(void 0);function gn(e){let{store:t,source:n,contentWrapStyle:r,handleFullScreen:i,aspectRatio:a,height:s,handleEmbedComp:l,isFullWidth:c,preserveScale:u,mediaType:p,useS3Url:m,isRootChild:g,contentStyle:h,blockLocation:v}=e;window.__c={n:"VideoRenderer"};const b=(0,d.Fg)(),y=(0,o.useRef)(null),_=(0,o.useCallback)((e=>{l(e),y.current=e}),[l]),S=(0,de.qz)(void 0,fn),k=(0,de.qz)(void 0,mn),I=(0,de.VK)((()=>wn("embed_url",b,c,g,u,s,h,v,k)),[b,c,g,u,s,h,v,k]);return(0,w.jsx)(Ee.Z,{url:n,permissionRecord:t.pointer,useS3Url:m,render:(e,t,o)=>{if(!o)return(0,w.jsx)("div",{});const d=xe(e,void 0)||S.state;return t?"video"===p||(0,f.xL)({url:n})?(0,w.jsx)("div",{style:r,onMouseDown:ue.$0,children:(0,w.jsxs)("div",{style:{position:"relative"},onDoubleClick:i,children:[(0,w.jsx)(Sn,{videoRef:y,setVideoRef:_,source:n,isFullWidth:c,isRootChild:g,preserveScale:u,height:s,contentStyle:h,blockLocation:v,playedStore:k,errorStore:S,signedUrl:t}),d&&(0,w.jsx)(bn,{error:d}),(0,w.jsx)(_n,{videoRef:y,playedStore:k,errorStore:S})]})}):(0,w.jsx)("div",{style:r,onDoubleClick:i,children:(0,w.jsx)("div",{style:{position:"relative"},children:(0,w.jsx)(Mt.Z,{ref:e=>l(e),source:t,height:s,style:I,isFullWidth:c,preserveScale:u,aspectRatio:a,background:!0})})}):void 0}})}function hn(e){return(0,w.jsx)("div",{style:{...un,...e.style},children:(0,w.jsx)("div",{style:dn})})}const vn={render:e=>(0,w.jsx)(gn,{...e}),resizable:!0,embedGhost:!0};function bn(e){let{error:t}=e;return(0,w.jsx)(De,{family:"video",error:t})}function yn(){window.__c={n:"PlayButtonWrapper"};const e=(0,s.O7)(),{device:t}=e;return t.isFirefox||t.isMobile?null:(0,w.jsx)(hn,{})}function _n(e){let{videoRef:t,playedStore:n,errorStore:r}=e;window.__c={n:"OverlayComponent"};const i=(0,o.useCallback)((e=>{const n=t.current;n&&(0,ue.ZP)({event:e,context:ue.Af.EditorClick,callback:()=>{n.play()}})}),[t]);return(0,de.VK)((()=>n.state||r.state),[n,r])?null:(0,w.jsx)("div",{onClick:i,style:pn,children:(0,w.jsx)(yn,{})})}function Sn(e){let{signedUrl:t,source:n,isFullWidth:r,isRootChild:i,preserveScale:a,height:l,contentStyle:c,blockLocation:u,playedStore:p,errorStore:m,videoRef:f,setVideoRef:g}=e;window.__c={n:"VideoComponent"};const h=(0,d.Fg)(),v=(0,s.O7)(),b=(0,o.useCallback)((e=>{const{device:t}=v;t.isMobile&&p.setState(!1)}),[v,p]),y=(0,o.useCallback)((()=>{p.setState(!0)}),[p]),_=(0,o.useCallback)((()=>{const{device:e}=v;e.isAndroid&&document.fullscreenElement&&document.exitFullscreen()}),[v]),S=(0,o.useCallback)((()=>{const{device:e}=v,t=f.current;e.isIOS&&t&&t.pause()}),[v,f]),k=(0,o.useCallback)((e=>{const t=Te(e.currentTarget,n);t&&m.setState(t)}),[n,m]),I=(0,de.VK)((()=>wn("video_file",h,r,i,a,l,c,u,p)),[h,r,i,a,l,c,u,p]);return(0,w.jsx)("video",{ref:g,style:I,autoPlay:v.device.isIOS,playsInline:!0,controls:!0,preload:"metadata",onPause:b,onPlay:y,onEnded:_,onLoadStart:S,onError:k,src:t})}function wn(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"embed_url",t=arguments.length>1?arguments[1]:void 0,n=arguments.length>5?arguments[5]:void 0,o=arguments.length>7?arguments[7]:void 0,r=arguments.length>8?arguments[8]:void 0;const i={...arguments.length>6?arguments[6]:void 0};return(arguments.length>2?arguments[2]:void 0)&&(arguments.length>3?arguments[3]:void 0)&&(arguments.length>4?arguments[4]:void 0)&&(i.height=n),"video_file"!==e||r.state||(i.pointerEvents="none"),Z.qC(o)&&(i.maxHeight=240),i.backgroundColor=t.embedPlaceholderBackground,i}const kn={background:"rgba(255, 255, 255, 0.055)"},In={display:"flex",alignItems:"center",justifyContent:"center",padding:"4px 6px",borderRight:`1px solid ${m.ZP.whiteWithAlpha(.2)}`},Cn="opacity 300ms ease-in",xn=230,Tn=(0,D.defineMessages)({embedButtonText:{defaultMessage:"Embed link",id:"embedBlock.embedButton.label"},embedCaption:{defaultMessage:"Works with links of PDFs, Google Drive, Google Maps, CodePen…",id:"embedBlock.linkPrompt.caption"},pastePrompt:{defaultMessage:"Paste in https://…",id:"embedBlock.pastePrompt"},validLink:{defaultMessage:"Please enter a valid link.",id:"embedBlock.invalidLinkError.message"},embedTitle:{defaultMessage:"Embed",id:"embedBlock.embedTab.title"},actionComment:{defaultMessage:"Comment",id:"embedBlock.actionButton.tooltip.comment"},actionDownload:{defaultMessage:"Download",id:"embedBlock.actionButton.tooltip.download"},actionOriginal:{defaultMessage:"Original",id:"embedBlock.actionButton.tooltip.original"},actionAlign:{defaultMessage:"Align",id:"embedBlock.actionButton.tooltip.align"},actionCaption:{defaultMessage:"Caption",id:"embedBlock.actionButton.tooltip.caption"},actionExpand:{defaultMessage:"Expand",id:"embedBlock.actionButton.tooltip.expand"},actionMore:{defaultMessage:"More actions",id:"embedBlock.actionButton.tooltip.blockActionMenu"}}),Mn={tweet:cn,gist:_t,video:vn,image:tn,audio:Ze,invision:rn,mixpanel:Nt,maps:Nt,drive:Nt,framer:Nt,figma:Nt,loom:Nt,typeform:Nt,codepen:Nt,embed:Nt,pdf:an.Z,whimsical:Nt,miro:Nt,abstract:Nt,sketch:Nt,excalidraw:Nt,replit:Nt,hex:Nt,deepnote:Nt,drawing:nt},Pn=new Set(["pdf","drive"]);class An extends W.Z{constructor(){super(...arguments),this.embedComp=null,this.embedContainerWidth=u.default.createValue(0),this.didHaveNonZeroWidth=u.default.createValue(!1),this.imageBoxRef=o.createRef(),this.isStoreNavigableAncestorLocked=this.createComputedStore((()=>this.props.store.isNavigableAncestorLocked())),this.captionAriaId=(0,l.Z)(),this.getImageDimensions=()=>{var e;return null===(e=this.imageBoxRef.current)||void 0===e?void 0:e.getImageDimensions()},this.openMenu=()=>{const{device:e}=this.environment;if(!this.props.disableMediaMenu&&this.canEdit()){const{popupWidth:t,maxHeight:n}=this.props,o=this.props.mediaMenuCurrentTab||"embed",i=(this.props.mediaMenuTabs||[{type:"embed"},{type:"file",fileUpload:!0,imageUpload:e.isAndroid,videoUpload:e.isAndroid}]).map((e=>function(e,t,n,o,r,i){switch(e.type){case"embed":const a=n||Q.default.formatMessage(Tn.embedButtonText);return{type:"embed",caption:o||Q.default.formatMessage(Tn.embedCaption),buttonText:a,inputPlaceholder:r||Q.default.formatMessage(Tn.pastePrompt),onChange:e=>{const n=(0,P.D)(e);T.B(n,"url")?(U.Z(),Zn(n,i,t)):O.showErrorMessage(Q.default.formatMessage(Tn.validLink))}};case"file":return{type:"file",fileUpload:Boolean(e.fileUpload),imageUpload:Boolean(e.imageUpload),videoUpload:Boolean(e.videoUpload),onUpload:e=>function(e,t,n){const o=Fn(t);if(o){const t=K.qQ(n);Z.cT({environment:n,store:o,file:e,pageWidth:t,preferredType:o.getType()})}}(e,i,t)};case"unsplash":return{type:"unsplash",onChange:e=>{let{url:n}=e;U.Z(),Zn(n,i,t)}};case"giphy":return{type:"giphy",onChange:e=>{let{url:n}=e;U.Z(),Zn(n,i,t)}}}}(e,this.environment,this.props.embedButtonText,this.props.mediaMenuEmbedCaption,this.props.urlInputPlaceholder,this.props.store))),a=r.findDOMNode(this);if(a&&a instanceof Element){const e=a.getBoundingClientRect();U.$(this.environment,{originRect:e,originGap:0,isSmallWidth:!1,showArrow:!0,currentTab:o,tabs:i,title:Q.default.formatMessage(Tn.embedTitle),...t?{popupWidth:t}:{},...n?{maxHeight:n}:{}})}}},this.replace=()=>{this.openMenu();const e=this.props.store.getType();e&&E.Fn(this.environment,{type:"replace",block_type:e,block_id:this.props.store.id})},this.caption=()=>{Nn(this.props.store,this.environment)},this.getFullScreenNodeRect=()=>{const{isFullWidth:e,aspectRatio:t}=this.getDimensions();if(this.embedComp){const n=r.findDOMNode(this.embedComp);if(n&&n instanceof Element){const o=n.getBoundingClientRect();return e&&t?{...M.Go(o),width:o.width,height:o.width*t}:o}}},this.renderFullScreenNode=()=>{const e=Bn(this.props.source,this.props.store),t=Kn(Bn(this.props.source,this.props.store),this.props.mediaType,this.props.store,this.fileUploadStore);if(!e)return;const n=this.getRenderArgs({source:e});return t&&t.renderFullScreen?t.renderFullScreen(n):void 0},this.storeTypes={embedBlockStore:ae,blockResizerStore:te.Z,alignmentPopupStore:ne.Z},this.renderAlignmentButtons=()=>(0,w.jsxs)(w.Fragment,{children:[(0,w.jsx)(We.Z,{style:{...In,...this.getAlignmentButtonStyle("left"),borderRight:"none"},hoveredStyle:{...kn,opacity:1},onClick:()=>Wn("left",this.environment,this.props.store,this.stores.alignmentPopupStore),children:En("left")}),(0,w.jsx)("span",{style:{borderRight:`1px solid ${m.ZP.whiteWithAlpha(.2)}`}}),(0,w.jsx)(We.Z,{style:{...In,...this.getAlignmentButtonStyle("center"),borderRight:"none"},hoveredStyle:{...kn,opacity:1},onClick:()=>Wn("center",this.environment,this.props.store,this.stores.alignmentPopupStore),children:En("center")}),(0,w.jsx)("span",{style:{borderRight:`1px solid ${m.ZP.whiteWithAlpha(.2)}`}}),(0,w.jsx)(We.Z,{style:{...In,...this.getAlignmentButtonStyle("right"),borderRight:"none"},hoveredStyle:{...kn,opacity:1},onClick:()=>Wn("right",this.environment,this.props.store,this.stores.alignmentPopupStore),children:En("right")})]}),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter=e=>{return t=this.stores.embedBlockStore,void(re.Z.state.isDragging||ce.default.state.isActive||t.setState({...t.state,hovered:!0}));var t},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave=e=>{return t=this.stores.embedBlockStore,void(re.Z.state.isDragging||ce.default.state.isActive||t.setState({...t.state,hovered:!1}));var t},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleFocus=e=>function(e,t){const n=e.target;n instanceof HTMLElement&&(0,c.E)(n)&&t.setState({...t.state,focused:!0})}(e,this.stores.embedBlockStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBlur=e=>{var t;(t=this.stores.embedBlockStore).setState({...t.state,focused:!1})},this.fileUploadStore=this.createComputedStore((()=>le.default.getKeyState(le.default.getBlockKey(this.props.store.id)))),this.getResizerValues=e=>{const t=this.props.store.getType();if(t&&(0,p.OY)(t)&&Pn.has(t))return{leftSide:!1,rightSide:!1,bottom:!1,rightCorner:!0,leftCorner:!0};const n=this.canEdit(),o=this.isRootOrDirectChild(),{preserveScale:r,isFullWidth:i}=this.getDimensions(),{resizable:a}=e,s=n&&a&&!this.props.disableResizers,l=s&&(!r||i&&o),c=l&&!i;return{leftSide:s&&o,rightSide:s,bottom:l,rightCorner:c,leftCorner:c&&o}}}handleCreated(){this.openMenu()}edit(){this.openMenu()}embed(e){Zn(e,this.props.store,this.environment)}async handleRemoveBlockFromComment(){return!!this.props.onRemoveBlockFromComment&&(await this.props.onRemoveBlockFromComment(this.props.store),!0)}activate(){Kn(Bn(this.props.source,this.props.store),this.props.mediaType,this.props.store,this.fileUploadStore)?Ln(this.props.store,this.props.blockLocation,this.environment):this.replace()}canRenderFullScreen(){const e=Kn(Bn(this.props.source,this.props.store),this.props.mediaType,this.props.store,this.fileUploadStore);return!(!e||!e.renderFullScreen)}renderPersisted(){const e=Bn(this.props.source,this.props.store),t=this.fileUploadStore.state;return t&&t.dataURL?this.renderSource(t.dataURL):e?this.renderSource(e):this.renderPlaceholder()}renderSource(e){const{device:t}=this.environment,{preserveScale:n,isFullWidth:o}=this.getDimensions(),r=Kn(e,this.props.mediaType,this.props.store,this.fileUploadStore);if(r){const{resizable:i}=r,{leftSide:a,rightSide:s,bottom:l,leftCorner:c,rightCorner:d}=this.getResizerValues(r);return(0,X.Z)((u=>(0,w.jsxs)(He.p,{role:"figure","aria-labelledby":this.captionAriaId,allowSelectionWithin:!0,ref:t=>{if(t){this.attachGhost(t,e);const{width:n}=t.getBoundingClientRect();this.embedContainerWidth.setState(n),this.didHaveNonZeroWidth.update((e=>e||n>0))}},...u,children:[this.didHaveNonZeroWidth?(0,w.jsxs)("div",{style:Vn(r,this.props.blockLocation),children:[(0,w.jsxs)("div",{className:G.QSt,style:{position:"relative",overflow:i?"hidden":"visible",flexGrow:1},onFocus:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleFocus,onBlur:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBlur,onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,onMouseEnter:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter,children:[this.renderEmbed(e),a&&(0,w.jsx)(it,{store:this.props.store,resizerType:qe.IS.Horizontal,resizerAlignment:qe.bZ.Left,resizeComponent:this,preserveScale:n,isHovered:this.stores.embedBlockStore.state.hovered,blockResizerStore:this.stores.blockResizerStore},"LeftResizer"),s&&(0,w.jsx)(it,{store:this.props.store,resizerType:qe.IS.Horizontal,resizerAlignment:qe.bZ.Right,resizeComponent:this,preserveScale:n,isHovered:this.stores.embedBlockStore.state.hovered,blockResizerStore:this.stores.blockResizerStore},"RightResizer"),d&&(0,w.jsx)(it,{store:this.props.store,resizerType:qe.IS.Corner,resizerAlignment:qe.bZ.Right,resizeComponent:this,preserveScale:n,isHovered:this.stores.embedBlockStore.state.hovered,blockResizerStore:this.stores.blockResizerStore},"RightCornerResizer"),c&&(0,w.jsx)(it,{store:this.props.store,resizerType:qe.IS.Corner,resizerAlignment:qe.bZ.Left,resizeComponent:this,preserveScale:n,isHovered:this.stores.embedBlockStore.state.hovered,blockResizerStore:this.stores.blockResizerStore},"LeftCornerResizer"),l&&(0,w.jsx)(it,{store:this.props.store,resizerType:qe.IS.Vertical,resizeComponent:this,preserveScale:n,isHovered:this.stores.embedBlockStore.state.hovered,blockResizerStore:this.stores.blockResizerStore},"BottomResizer"),!this.props.disableActions&&this.renderActions(e),this.props.disableActions&&this.props.showExpandButton&&r.renderFullScreen&&(0,w.jsx)(zn,{store:this.props.store,blockLocation:this.props.blockLocation}),this.props.contentBelowSource]}),!o&&!t.isMobile&&(0,w.jsx)(ze.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]}):null,(0,w.jsx)(je.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})]})))}}renderPlaceholder(){const{device:e}=this.environment,t=!oe.Z.state.online,n=e.isMobile||this.stores.embedBlockStore.state.hovered,o=this.fileUploadStore.state,r=se.default.checkGate("comments_density_image_handling"),i=Z.qC(this.props.blockLocation);return(0,w.jsxs)("div",{onMouseEnter:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter,onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,style:Un(this.props.blockLocation,this.theme,r),children:[(0,w.jsx)(ct.Z,{style:this.getContentWrapStyle(),disabled:!this.canEdit()||t,iconSvg:void 0!==this.props.iconSvg?this.props.iconSvg:k,shouldHideRight:!n,right:this.canEdit()&&(0,w.jsx)(On,{blockLocation:this.props.blockLocation,store:this.props.store,isPlaceholder:!0}),onClick:this.openMenu,isLoading:Boolean(o),progressPercent:o?o.progressPercent:0,file:o?o.file:void 0,name:o?o.name:void 0,size:o?o.size:void 0,isInComment:i,children:this.props.children||(0,w.jsx)(D.FormattedMessage,{defaultMessage:"Embed anything (PDFs, Google Docs, Google Maps, Spotify…)",id:"embedBlock.embedAnything.placeholder"})}),(0,w.jsx)(ze.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}renderEmbed(e){const t=Kn(e,this.props.mediaType,this.props.store,this.fileUploadStore);if(t){const n=this.getRenderArgs({source:e}),o=t.render;return(0,w.jsx)(o,{...n})}}renderActions(e){const{device:t}=this.environment,{blockLocation:n}=this.props,{isFullWidth:o,width:r,isPageWidth:i}=this.getDimensions(),a=this.props.store.canEdit(),s=this.props.store.canComment(),l=this.props.store.isExternalObjectInstanceBlockStore(),c=Kn(e,this.props.mediaType,this.props.store,this.fileUploadStore),d=function(e,t){const{block_width:n}=e.getFormat(),{temporaryWidth:o}=t.state;if(void 0!==o)return o<=xn;if(void 0!==n)return n<=xn;return!1}(this.props.store,this.stores.blockResizerStore),u=this.fileUploadStore.state,f=this.stores.blockResizerStore.state.dragging,h=Z.qC(n),v=!t.isMobile&&!h&&!l,b=r&&!i&&!o&&!t.isPhone&&!h,S=!t.isMobile&&(null==c?void 0:c.renderFullScreen)&&l;if(!(u||f||c&&c.hideActions)){const e=J.Xp(this.props.store,{recursivelyLoadAllDiscussions:!1});if(this.isStoreNavigableAncestorLocked.state)return(0,w.jsx)("div",{style:Hn(this.environment,this.stores.embedBlockStore),children:(0,w.jsx)(We.Z,{style:In,hoveredStyle:kn,onClick:()=>jn(this.props.store,this.environment),children:(0,w.jsx)(D.FormattedMessage,{defaultMessage:"View original",id:"embedBlock.viewOriginalLink.button.label"})})});if(d)return(0,w.jsx)("div",{style:Hn(this.environment,this.stores.embedBlockStore),children:(0,w.jsx)(On,{blockLocation:this.props.blockLocation,store:this.props.store})});{const n=300,o=$e.ug.Top;let r;const i=this.props.store.getType();return r=(0,p.VB)(i)?(0,w.jsx)($e.ZP,{renderTooltip:()=>Q.default.formatMessage(Tn.actionDownload),placement:o,delayThreshold:n,render:e=>(0,w.jsx)(We.Z,{...e,ariaLabel:Q.default.formatMessage(Tn.actionDownload),style:In,hoveredStyle:kn,onClick:()=>function(e,t){const n=Fn(e);if(n){Z.TH({environment:t,store:n});const o=n.getType();o&&E.Fn(t,{type:"download",block_type:o,block_id:e.id})}}(this.props.store,this.environment),children:(0,I.a)({width:14,height:14,marginRight:0,fill:m.ZP.white})})}):(0,w.jsx)($e.ZP,{renderTooltip:()=>Q.default.formatMessage(Tn.actionOriginal),placement:o,delayThreshold:n,render:e=>(0,w.jsx)(We.Z,{...e,ariaLabel:Q.default.formatMessage(Tn.actionOriginal),style:In,hoveredStyle:kn,onClick:()=>jn(this.props.store,this.environment),children:(0,g.J)({width:14,height:14,marginRight:0,fill:m.ZP.white})})}),(0,w.jsxs)("div",{style:Hn(this.environment,this.stores.embedBlockStore),children:[!h&&!l&&s&&(0,w.jsx)($e.ZP,{renderTooltip:()=>Q.default.formatMessage(Tn.actionComment),placement:o,delayThreshold:n,render:n=>(0,w.jsxs)(We.Z,{...n,ariaLabel:Q.default.formatMessage(Tn.actionComment),style:{...In,...t.isMobile&&{paddingLeft:8,paddingRight:8}},hoveredStyle:kn,onClick:()=>{L.ZH(this.environment),e>0?F.Ib({environment:this.environment,blockStore:this.props.store,analyticsFrom:"embed_menu",shouldFocusDiscussion:!0,recursivelyLoadAllDiscussions:!1}):q.yw({environment:this.environment,blockStore:this.props.store})},children:[(0,x.z)({width:14,height:14,marginRight:e>0?4:0,fill:m.ZP.white}),e>0&&e]})}),a&&b&&(0,w.jsx)($e.ZP,{renderTooltip:()=>Q.default.formatMessage(Tn.actionAlign),placement:o,delayThreshold:n,render:e=>(0,w.jsx)(Ke.ZP,{popupType:Ke.Z4.Popup,buttonPopupStore:this.stores.alignmentPopupStore,originGap:1,renderOrigin:t=>(0,w.jsxs)(We.Z,{ariaLabel:Q.default.formatMessage(Tn.actionAlign),style:In,hoveredStyle:kn,...(0,Y.Z)(t,e),children:[En(this.getBlockAlignment()),(0,_.i)({width:8,fill:m.ZP.white,marginLeft:4})]}),borderRadius:6,render:this.renderAlignmentButtons,popupWrapStyle:{background:Dn(this.environment),display:"flex"}})}),a&&v&&(0,w.jsx)($e.ZP,{renderTooltip:()=>Q.default.formatMessage(Tn.actionCaption),placement:o,delayThreshold:n,render:e=>(0,w.jsx)(We.Z,{...e,ariaLabel:Q.default.formatMessage(Tn.actionCaption),style:In,hoveredStyle:kn,onClick:()=>Nn(this.props.store,this.environment),children:(0,y.o)({width:14,height:14,marginRight:0,fill:m.ZP.white})})}),S&&(0,w.jsx)($e.ZP,{renderTooltip:()=>Q.default.formatMessage(Tn.actionExpand),placement:o,delayThreshold:n,render:e=>(0,w.jsx)(We.Z,{...e,ariaLabel:Q.default.formatMessage(Tn.actionExpand),style:In,hoveredStyle:kn,onClick:()=>Ln(this.props.store,this.props.blockLocation,this.environment),children:(0,C.s)({width:14,height:14,marginRight:0,fill:m.ZP.white})})}),!t.isMobile&&r,(0,w.jsx)(On,{blockLocation:this.props.blockLocation,store:this.props.store})]})}}}attachGhost(e,t){const n=Kn(t,this.props.mediaType,this.props.store,this.fileUploadStore);e&&n&&n.embedGhost&&this.mutateDOM((()=>e.setAttribute("embed-ghost","")))}getDimensions(){const{block_height:e,block_width:t,block_preserve_scale:n,block_full_width:o,block_page_width:r,block_aspect_ratio:i}=this.props.store.getFormat(),{dragging:a,temporaryHeight:s,temporaryWidth:l,temporaryFullWidth:c,temporaryPageWidth:d}=this.stores.blockResizerStore.state,u=a?l:t??this.embedContainerWidth.state,p=a?s:e,m=Boolean(a?c:o),g=Boolean(a?d:r),h=Boolean(this.props.preserveScale||n);return{blockWidth:t,blockHeight:e,width:u,height:this.props.store.isExternalObjectInstanceBlockStore()&&"image"!==this.props.mediaType?p||f.QA:p,dragging:a,preserveScale:h,isFullWidth:m,isPageWidth:g,aspectRatio:i}}static getEmbedSourceFromBlockStore(e){const t=e.getProperties(),n=null==t?void 0:t.source,o=A.QaF(n),{display_source:r}=e.getFormat();return(0,f.Z8)(r||o)}getRenderArgs(e){const{source:t}=e,n=this.props.store.getProperties(),o=A.Jcv(n&&n.title),r=A.Jcv(n&&n.size),i=this.fileUploadStore.state,{blockWidth:a,blockHeight:s,width:l,height:c,dragging:d,preserveScale:u,isFullWidth:p,isPageWidth:m,aspectRatio:f}=this.getDimensions(),g=this.isRootOrDirectChild(),{device:h}=this.environment;return{store:this.props.store,source:t,blockWidth:a,blockHeight:s,aspectRatio:f,width:l,height:c,dragging:d,preserveScale:u,isFullWidth:p,isPageWidth:m,isRootChild:g,dataURL:i?i.dataURL:void 0,dataName:o,dataSize:r,disabled:!this.canEdit(),contentStyle:qn(this.stores.blockResizerStore),contentWrapStyle:this.getContentWrapStyle(),isLoading:Boolean(i),progressPercent:i?i.progressPercent:0,handleFullScreen:()=>Ln(this.props.store,this.props.blockLocation,this.environment),handleEmbedComp:e=>this.embedComp=e,viewOriginal:()=>jn(this.props.store,this.environment),inlineContentStyle:this.props.inlineContentStyle,blockLocation:this.props.blockLocation,mediaType:this.props.mediaType,imageBoxRef:this.imageBoxRef,useS3Url:h.isIOS&&h.isMobileNative}}static hasRendererForStore(e){return i.Z.withListenerIgnored((()=>Boolean(An.getRenderer(An.getEmbedSourceFromBlockStore(e),void 0,e.getType()))))}static getRenderer(e,t,n){if(t)return Mn.image;if(e){if(e.startsWith("data:")||e.startsWith("<img"))return;const t=(0,f.Dz)({url:e,baseUrl:H.default.domainBaseUrl,publicDomainName:H.default.publicDomainName,preferredType:n});if("embed"!==t)return Mn[t]}return n&&e?Mn[n]:Nt}getContentWrapStyle(){const e={position:"relative"};return this.canEdit()&&(e.cursor="pointer"),this.props.centerWrappedContent&&(e.display="flex",e.justifyContent="center",e.alignItems="center",e.minHeight=220),e}getBlockAlignment(){const{block_alignment:e}=this.props.store.getFormat(),t=this.isRootOrDirectChild();return e||(t?"center":"left")}getAlignmentButtonStyle(e){let t=.6;return this.getBlockAlignment()===e&&(t=1),{width:26,height:26,opacity:t}}}const Rn=An;function Dn(e){const{device:t}=e;return t.isMobile?m.ZP.blackWithAlpha(.3):m.ZP.blackWithAlpha(.6)}function En(e){const t={left:v.$,center:h.L,right:b.g},n={width:14,height:14,marginRight:0,fill:m.ZP.white};return t[e](n)}function Bn(e,t){return e||An.getEmbedSourceFromBlockStore(t)}function Fn(e){if("external_object_instance"!==e.getType()||(0,$.Xg)())return e}function On(e){let{isPlaceholder:t,blockLocation:n,store:o}=e;const r=Z.qC(n),i=r?"comment_media":"default";return(0,w.jsx)(Le.Z,{store:o,fadeIn:!1,iconStyle:t?void 0:{fill:m.ZP.white},actionSectionGroupKey:i,hideFilterActionsInput:r,hoveredStyle:kn,tooltipContent:Q.default.formatMessage(Tn.actionMore)})}function Zn(e,t,n){const o=Fn(t);if(!o)return;const r=K.qQ(n);B.bO(n,{pastedText:e,source:"embed_block_menu"});const i=ee.default.mark("embed_render_complete");Z.I(n,{source:e,isDataURL:!1,store:o,pageWidth:r,preferredType:t.getType(),metric:i})}function Vn(e,t){const n={display:"flex"};return Z.qC(t)&&(n.display="inline-flex",n.maxHeight=240),"audio"===e.rendererType&&(n.display="flex"),n}function Un(e,t,n){const o={display:"flex"};return Z.qC(e)&&(o.borderWidth=1,o.borderColor=t.regularDividerColor,o.marginBottom=10,o.borderRadius=3,n&&(o.marginBottom=0,o.width=214,o.color=t.text.secondary)),o}function Nn(e,t){const n=e.getPropertyStore("caption");L.eP({environment:t,store:e}),j.NX({store:n});const o=e.getType();o&&E.Fn(t,{type:"caption",block_type:o,block_id:e.id})}function Ln(e,t,n){N.dK({blocks:[e],blockLocationOfTargetBlock:t});const o=e.getType();o&&E.Fn(n,{type:"full_screen",block_type:o,block_id:e.id})}function jn(e,t){const n=Fn(e);if(n){Z.qL(t,{store:n,from:"view_original"});const o=n.getType();o&&E.Fn(t,{type:"original",block_type:o,block_id:e.id})}}function zn(e){let{store:t,blockLocation:n}=e;window.__c={n:"ExpandButtonComponent"};const o=(0,d.Fg)(),r=(0,s.O7)();return(0,w.jsx)(Ge.Z,{style:{position:"absolute",right:12,top:12,background:o.buttonBackground},icon:e=>(0,C.s)({...e,width:16,height:16}),hoveredStyle:{background:o.buttonHoveredBackground},pressedStyle:{background:o.buttonPressedBackground},onClick:()=>Ln(t,n,r),children:(0,w.jsx)(D.FormattedMessage,{id:"embedBlock.expandFullScreen.button.label",defaultMessage:"Expand"})})}function qn(e){const{dragging:t}=e.state;return{display:"block",pointerEvents:t?"none":"auto",width:"100%"}}function Hn(e,t){const{device:n}=e,{focused:o,hovered:r}=t.state,{isMobile:i}=n;return{position:"absolute",top:4,right:4,borderRadius:4,color:m.ZP.white,fill:m.ZP.white,fontSize:11.5,background:Dn(e),display:"flex",whiteSpace:"nowrap",height:26,maxWidth:"calc(100% - 16px)",overflow:"hidden",pointerEvents:o||r||i?"auto":"none",opacity:o||r||i?1:0,transition:n.isSafari?void 0:Cn,fontFamily:R.Z.getCompositeFontFamily(a.SP).sans,zIndex:2}}function Wn(e,t,n,o){const r=Fn(n);o.reset(),r&&z.createAndCommit({userAction:"EmbedBlock.handleAlignment",environment:t,perform:n=>{V.hc({environment:t,store:r,alignment:e,transaction:n})}});const i=n.getType(),a=n.getFormat(),s=a.block_alignment,l=a.block_width,c=a.block_height,d=n.isRootOrDirectChild()?"center":"left";i&&E.Fn(t,{type:"alignment",block_type:i,block_id:n.id,block_alignment:e,block_height:c,block_width:l,previous_alignment:s,default_alignment:d}),L.Jy()}function Kn(e,t,n,o){var r,i;return An.getRenderer(e,null===(r=o.state)||void 0===r?void 0:r.dataURL,t??(null===(i=Fn(n))||void 0===i?void 0:i.getType()))}},86329:(e,t,n)=>{n.d(t,{Z:()=>f});n(67294);var o=n(86628),r=n(24405),i=n(82990),a=n(34047),s=n(77080),l=n(68709),c=n(64921),d=n(68785),u=n(32854),p=n(40148),m=n(85893);const f=function(e){let{isLoading:t,file:n,name:i,size:a,progressPercent:d,style:u,iconSvg:f,onClick:v,disabled:b,right:y,shouldHideRight:_,isInComment:S,children:w}=e;window.__c={n:"EmbedPlaceholder"};const k=(0,r.Fg)(),I=(0,o.VK)((()=>s.default.checkGate("comments_density_image_handling")),[])&&S;return t?(0,m.jsx)(g,{file:n,name:i,size:a,progressPercent:d,style:u,iconSvg:f,isInComment:S}):(0,m.jsx)(l.p,{allowSelectionWithin:!1,style:{...h(k),...I?{background:k.surface.wash,borderRadius:12,overflow:"hidden"}:{}},children:(0,m.jsx)(c.Z,{onClick:v,disabled:b,hoveredStyle:I?{background:k.surface.wash}:{},children:(0,m.jsx)(p.ZP,{style:{background:void 0,...u},iconSvg:f,right:y,shouldHideRight:_,isInComment:S,children:w})})})};function g(e){let{file:t,name:n,size:l,progressPercent:c,style:f,iconSvg:g,isInComment:h}=e;window.__c={n:"Loading"};const v=(0,r.Fg)(),b=(0,o.VK)((()=>s.default.checkGate("comments_density_image_handling")),[])&&h;let y;if(t){const e=(0,a.sS)(l);y=(0,m.jsxs)("div",{children:[(0,m.jsx)("div",{style:b?{fontWeight:i.Z.fontWeight.medium,color:v.text.primary,fontSize:14,lineHeight:"18px",overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}:{},children:n}),(0,m.jsx)("div",{style:b?{fontSize:12,lineHeight:"15px"}:p.Lw,children:(0,m.jsxs)("div",{style:{display:"flex",alignItems:"center",...b?{gap:4}:{}},children:[(0,m.jsx)("div",{style:b?{color:v.text.secondary}:{},children:e}),(0,m.jsx)("div",{style:b?{color:v.text.tertiary}:{marginLeft:3},children:b?"—":" – "}),(0,m.jsx)(d.Z,{style:b?{}:{marginLeft:3,marginRight:3}}),(0,m.jsx)(u.Z,{style:b?{color:v.text.tertiary}:{},percentage:c})]})})]},"FileLoadingSpinner")}else y=(0,m.jsx)("div",{children:(0,m.jsx)(d.Z,{style:{marginLeft:3,marginRight:3}})},"LoadingSpinner");return(0,m.jsx)(p.ZP,{style:{...f,...b?{borderRadius:12,background:v.surface.wash}:{}},iconSvg:g,isInComment:h,children:y})}function h(e){return{background:e.embedPlaceholderBackground,width:"100%",borderRadius:4}}},3702:(e,t,n)=>{n.d(t,{Z:()=>T});var o=n(67294),r=n(83355),i=n(13991),a=n(480),s=n(24405),l=n(8848),c=n(75e3),d=n(72126),u=n(20852),p=n(70203),m=n(82990),f=n(9291),g=n(25888),h=n(83631),v=n(18514),b=n(69015),y=n(42922),_=n(36488),S=n(16354),w=n(53437),k=n(22492),I=n(85893);const C={popup:{width:400,display:"flex",flexDirection:"column"},popupInputForm:{display:"flex",alignItems:"center",padding:"8px 10px",width:"100%"},mobilePreview:{padding:"4px 8px",height:80,display:"flex",alignItems:"center",justifyContent:"center"},mobilePreviewValue:{overflow:"auto"},equationInput:{fontFamily:m.Z.getCompositeFontFamily(i.SP).mono,fontSize:14,marginRight:8,flex:1,wordBreak:"break-word",maxHeight:"50vh",overflow:"auto"},equationInputBlock:{minHeight:60},equationInputSlideUp:{height:100},submitButton:{alignSelf:"flex-start"},enterIcon:{height:14,width:14,fill:"currentColor",marginLeft:6,marginTop:2},errorContainer:{color:l.ZP.redWithAlpha(.8),fontSize:12,padding:"8px 10px"},errorLabel:{fontWeight:600},learnMoreLink:{display:"inline",textDecoration:"underline"}};class x extends r.Z{constructor(){super(...arguments),this.input=o.createRef(),this.renderPopup=()=>{const{isOpen:e}=this.props,t=A(this.theme),n={...C.popupInputForm,...t.popupInputForm},r=(0,I.jsxs)("div",{style:n,children:[this.renderInput(),(0,I.jsx)(D,{error:this.props.error,disabled:this.props.disabled,isOpen:this.props.isOpen,onSubmit:this.props.onSubmit,onDismiss:this.props.onDismiss})]});return(0,I.jsx)(_.Z,{capture:e,allowEsc:!0,render:()=>P(this.environment)===w.ZP.PopupType.SlideUp?(0,I.jsxs)(o.Fragment,{children:[(0,I.jsx)(B,{equationValue:this.props.equationValue,error:this.props.error,displayMode:this.props.displayMode,isOpen:this.props.isOpen}),r]}):(0,I.jsxs)(o.Fragment,{children:[r,(0,I.jsx)(E,{isOpen:this.props.isOpen,error:this.props.error})]})})}}didMount(){this.environment.KatexStore.loadIfNeeded((()=>[(0,p.qZ6)("")]))}getSelection(){if(!this.input)return;if(!this.input.current)return;const e=this.input.current.getSelection();return"contain"===(null==e?void 0:e.type)?e.selection:void 0}renderComponent(){const{isOpen:e,onDismiss:t,origin:n,originRect:o,originGap:r,popupStyle:i}=this.props,a=P(this.environment);return(0,I.jsx)(w.ZP,{popupType:a,open:e,origin:n,originRect:o,originGap:r,keepFocus:a===w.ZP.PopupType.SlideUp,onDismiss:t,style:{...C.popup,...i},render:()=>this.renderPopup()})}renderInput(){const{disabled:e,isOpen:t,equationValue:n,onLeft:o,onRight:r,onDismiss:i,displayMode:a}=this.props,s=A(this.theme),l=P(this.environment)===w.ZP.PopupType.SlideUp,c=!e&&!l,p=l?{type:b.b.Textarea}:{type:b.b.InlineWrap,onSubmit:e=>R(e,this.props.isOpen,this.props.disabled,this.props.error,this.props.onSubmit,this.props.onDismiss)},m={...C.equationInput,..."block"===a&&C.equationInputBlock,...l&&C.equationInputSlideUp},f={...m,...s.equationInputPlaceholder};return(0,I.jsx)(b.Z,{ref:this.input,...p,disabled:e,focus:t,selectAll:c,value:n||"",placeholder:M(this.props.displayMode),getHtml:e=>function(e,t){return t.highlight(d.AK(e),t.languages[u.PrismLanguages.latex],u.PrismLanguages.latex)}(e,this.props.Prism),onChange:e=>function(e,t,n,o,r){if(!t)return;n(e,h.by({environment:r,equation:e,displayMode:o}))}(e,this.props.isOpen,this.props.onChange,this.props.displayMode,this.environment),onCancel:i,onLeft:o,onRight:r,placeholderStyle:f,style:m,autoCorrect:"off",autoCapitalize:"off"})}}x.displayName="EquationInputPopup";const T=x;function M(e){return"block"===e?"|x| = \\begin{cases}             \n  x, &\\quad x \\geq 0 \\\\           \n -x, &\\quad x < 0             \n\\end{cases}":"E = mc^2"}function P(e){const{device:t}=e,n=t.isPhone&&t.isIOS&&t.isMobileBrowser;return t.isPhone&&!n?w.ZP.PopupType.SlideUp:w.ZP.PopupType.Popup}function A(e){return{popupInputForm:{background:e.inputBackground},errorContainerDesktop:{boxShadow:`0 -1px ${e.lightDividerColor}`},equationInputPlaceholder:{color:e.lightTextColor}}}function R(e,t,n,o,r,i){e.preventDefault&&e.preventDefault(),n||t&&(o||(r(),i()))}function D(e){let{error:t,disabled:n,isOpen:o,onSubmit:r,onDismiss:i}=e;return n?null:(0,I.jsxs)(y.Z,{onClick:e=>R(e,o,n,t,r,i),disabled:n||Boolean(t),style:C.submitButton,children:[(0,I.jsx)(f.FormattedMessage,{defaultMessage:"Done",id:"equationInput.submitButton.label"}),(0,c.U)(C.enterIcon)]})}function E(e){let{isOpen:t,error:n}=e;window.__c={n:"EquationErrorComponent"};const o=(0,s.Fg)(),r=(0,a.O7)();if(!t)return null;const i=P(r)===w.ZP.PopupType.Popup;if(!n)return null;const l=n.message.replace("KaTeX parse error: ",""),c={...C.errorContainer,...i&&A(o).errorContainerDesktop};return(0,I.jsxs)("div",{role:"alert",style:c,children:[(0,I.jsx)("span",{style:C.errorLabel,children:(0,I.jsx)(f.FormattedMessage,{defaultMessage:"Invalid equation:",id:"equationInput.inputError.label"})})," ",l,". ",(0,I.jsx)(S.Z,{href:(0,v.UY)("guides.equations"),external:!0,onClick:()=>{g.Fs(r,{from:"equation_input"})},style:C.learnMoreLink,children:(0,I.jsx)(f.FormattedMessage,{defaultMessage:"Learn more",id:"equationInput.inputError.learnMore"})})]})}function B(e){let{equationValue:t,error:n,displayMode:o,isOpen:r}=e;window.__c={n:"MobilePreviewComponent"};const i=(0,s.Fg)();return t?(0,I.jsx)("div",{style:C.mobilePreview,children:n?(0,I.jsx)(E,{isOpen:r,error:n}):"block"===o?(0,I.jsx)(k.Z,{display:o,equation:t,style:C.mobilePreviewValue,theme:i}):(0,I.jsx)(k.Z,{display:o,equation:t,style:C.mobilePreviewValue,theme:i,index:0,isTemporary:!1})}):null}},22492:(e,t,n)=>{n.d(t,{Z:()=>d});n(67294);var o=n(83355),r=n(98923),i=n(9291),a=n(83631),s=n(77907),l=n(85893);class c extends o.Z{didMount(){super.didMount(),a.bc()}renderComponent(){return(0,l.jsx)(s.DependencyConsumer,{dependency:s.deps.katex,children:e=>(0,l.jsx)(r.MW,{katex:e,...this.props})})}}c.displayName="EquationValue";const d=(0,i.injectIntl)(c)},42782:(e,t,n)=>{n.d(t,{Z:()=>v});var o=n(67294),r=n(73935),i=n(480),a=n(98742),s=n(3386),l=n(53437);const c=()=>{const[e,t]=o.useState({x:0,y:0});return o.useEffect((()=>{const e=e=>{t({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),()=>{window.removeEventListener("mousemove",e)}}),[]),e};var d=n(85893);const u=e=>{let{x:t,mouseX:n}=e;return n>t?void 0:-Math.max(t-n,10)+"px"},p=e=>{let{x:t,width:n,mouseX:o}=e;return o>t?-Math.max(o-(t+n),10)+"px":void 0},m=e=>{let{x:t,width:n,mouseX:o}=e;return o>t?`${Math.max(o-(t+n),10)}px`:`${Math.max(t-o,10)}px`},f=e=>{let{x:t,y:n,height:o,mouseX:r,mouseY:i}=e;return r>t?`polygon(0% 0%, 0% 100%, 100% ${100*(i-n)/o}%)`:`polygon(100% 0%, 0% ${100*(i-n)/o}%, 100% 100%)`};function g(e){window.__c={n:"ExtensionMenuSafeArea"};const{x:t=0,y:n=0,height:o=0,width:r=0}=e.el.getBoundingClientRect()||{},{x:i,y:a}=c(),s={x:t,y:n,height:o,width:r,mouseX:i,mouseY:a},l={right:p(s),left:u(s),height:o,width:m(s),clipPath:f(s)};return(0,d.jsx)("div",{style:{cursor:"pointer",position:"absolute",top:0,...l}})}function h(e,t){let{onClick:n,renderOrigin:c,renderExtension:u,allowOptionalExtensionMenu:p,...m}=e;window.__c={n:"ExtensionMenuItem"};const{disableDefaultClick:f,onFocus:h,focused:v,openOnFocus:b}=m,y=(0,i.Fy)(),[_,S]=(0,o.useState)(!1),w=(0,o.useRef)(null),k=(0,o.useRef)(null),I=(0,o.useRef)(null),C=(0,o.useRef)(null),x=(0,o.useCallback)((()=>{I.current&&window.clearTimeout(I.current),C.current&&window.clearTimeout(C.current),I.current=null,C.current=null}),[]),T=(0,o.useCallback)((()=>{x(),_||S(!0)}),[_,x]),M=(0,o.useCallback)((()=>{x(),_&&S(!1)}),[_,x]),P=(0,o.useCallback)((e=>{x(),_||(e&&e.preventDefault&&e.preventDefault(),I.current=window.setTimeout(T,120))}),[_,x,T]),A=(0,o.useCallback)((()=>{x(),_&&(C.current=window.setTimeout(M,100))}),[_,M,x]),R=(0,o.useCallback)((e=>{h(),T(),p&&(null==n||n(e),M())}),[h,T,p,n,M]),D=(0,o.useCallback)((()=>{P()}),[P]),E=(0,o.useCallback)((()=>{h(),P()}),[h,P]),B=(0,o.useCallback)((e=>{if(y.isPhone)return;const t=r.findDOMNode(w.current);_&&t&&!t.contains(e.target)&&M()}),[_,M,y.isPhone]),F=(0,o.useCallback)((e=>{13===e.keyCode&&_&&M()}),[_,M]);(0,o.useEffect)((()=>{if(!Boolean(f))return window.addEventListener("click",B),()=>{window.removeEventListener("click",B)}}),[f,B]),(0,o.useEffect)((()=>(window.addEventListener("keydown",F),()=>{window.removeEventListener("keydown",F)})),[F]);const O=(0,o.useRef)(v);(0,o.useEffect)((()=>{b&&!O.current&&v?P():!v&&O.current&&A(),O.current=v}),[v,b,P,A,y.isMobile]);const Z={...(0,a.Z)({onMouseEnter:D,onClick:R},m),showExtensionArrow:!0};return(0,d.jsx)(s.Z,{debugName:"ExtensionMenuItem",capture:v,onEnter:_?void 0:P,onRight:P,onLeft:_?A:void 0,onEsc:_?A:void 0,children:(0,d.jsx)(l.ZP,{popupType:y.isPhone?l.ZP.PopupType.SlideUp:l.ZP.PopupType.Popup,open:_,origin:c(Z,t),placementToOrigin:l.ZP.Placement.Right,alignmentToOrigin:l.ZP.Alignment.Center,originGap:0,disableMouseCapture:!0,preventBlockRenderQueueOnEnter:!0,preventScaleTransition:!y.isPhone,preventCaptureEsc:!0,ref:w,render:()=>(0,d.jsxs)(d.Fragment,{children:[k.current&&(0,d.jsx)(g,{el:k.current}),(0,d.jsx)("div",{ref:k,children:u({onMouseEnter:E},{close:A})})]}),style:{overflow:"visible"},trapFocus:!0})})}const v=o.forwardRef(h)},19987:(e,t,n)=>{n.d(t,{Z:()=>ee});var o=n(67294),r=n(83355),i=n(480),a=n(86628),s=n(24405),l=n(84939),c=n(8848),d=n(77657),u=n(42853),p=n(56666),m=n(44495),f=n(60291),g=n(54497),h=n(90965),v=n(82990),b=n(9291),y=n(57549),_=n(89475),S=n(42858),w=n(82530),k=n(12170),I=(n(95477),n(70764)),C=n(41232),x=n(33929),T=n(77907),M=n(80444),P=n(30874),A=n(60709),R=n(1634),D=n(64921),E=n(31945),B=n(51077),F=n(89728),O=(n(57658),n(74155)),Z=n(37612),V=n(893),U=n(47307),N=n(12714),L=n(87279),j=n(18514),z=n(52275),q=n(78140),H=n(32163),W=n(72495),K=n(85893);const G=(0,b.defineMessages)({copiedDebuggingInfo:{id:"externalObjectBlock.errorDropdown.copiedDebuggingInfo",defaultMessage:"Copied to clipboard."}});function $(e){window.__c={n:"ExternalObjectInstanceErrorMenu"};const{state:t,store:n,onUpdate:o,onReplace:r,onAuthenticate:l,onRemove:u,description:p,statusCode:m,errorDescription:g,isInlineMenu:h}=e,{userHasBotForIntegration:v,pattern:_,integration:S,botIds:w,originalUrl:k}=t,I=(0,i.Fy)(),C=(0,i.O7)(),x=(0,s.yK)((e=>({menuIcon:{fill:e.regularIconColor,width:16},redThemeColor:(0,c.fi)("red",e)})),[]),T=(0,a.VK)((()=>{var e;return Boolean(null===(e=M.default.state.currentSpaceStore)||void 0===e?void 0:e.canEdit())}),[]),P=(0,a.VK)((()=>n.isExternalObjectInstanceBlockStore()),[n]),A=(0,a.VK)((()=>n.isExternalObjectInstancePageBlockStore()),[n]);let R;R=I.isMobile?{menuType:L.og.ActionSheet}:{menuType:L.og.Popup,minWidth:220};const D={key:"learn",render:e=>(0,K.jsx)(z.Z,{title:(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Learn more about this error",id:"unfurling.errorOptions.learnMore.title"}),icon:(0,O.u)(x.menuIcon),...e}),action:()=>{U.showDialog({items:[{label:(0,K.jsx)(b.FormattedMessage,{id:"externalObjectInstanceBlockErrorDropdown.dialogItem.reviewGuide",defaultMessage:"View guide"}),color:"blue",onAccept:()=>{N.D({environment:C,url:(0,j.UY)("guides.unfurling")}),y.SC(C,{integrationId:S.id,entity:null==_?void 0:_.name,statusCode:m})}},{label:(0,K.jsx)(b.FormattedMessage,{id:"externalObjectInstanceBlockErrorDropdown.dialogItem.copyDebugData",defaultMessage:"Copy debugging information"}),color:void 0,onAccept:()=>{const e={statusCode:m,integrationId:S.id,botIds:w,url:k,debugMessage:g};V.RD({environment:C,stringValue:JSON.stringify(e,null,2),copiedMessage:G.copiedDebuggingInfo})}}],showCancel:!0,keepFocus:!1,message:p})}},E={key:"remove",render:e=>(0,K.jsx)(z.Z,{title:(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Remove",id:"unfurling.errorOptions.removeAction.title"}),style:{color:x.redThemeColor.color},icon:(0,Z.y)({fill:x.redThemeColor.fill,width:16}),...e}),action:()=>{null==u||u()}},F={key:"replace",render:e=>(0,K.jsx)(z.Z,{title:(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Change URL",id:"unfurling.errorOptions.replace.title"}),icon:(0,f.b)(x.menuIcon),...e}),action:()=>{r()}},$={key:"update",render:e=>(0,K.jsx)(z.Z,{title:(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Try again",id:"unfurling.errorOptions.tryAgainAction.title"}),icon:(0,f.b)(x.menuIcon),...e}),action:()=>{null==o||o()}},Q={key:"authenticate",render:e=>(0,K.jsx)(z.Z,{title:v?401===m?(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Re-authenticate account",id:"unfurling.errorOptions.authenticateAction.reAuthenticate.title"}):h?(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Connect a different account",id:"unfurling.errorOptions.authenticateAction.alreadyAuthenticatedCompact.title"}):(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Connect a different {integration} account",id:"unfurling.errorOptions.authenticateAction.alreadyAuthenticated.title",values:{integration:S.name}}):(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Connect {integration} account",id:"unfurling.errorOptions.authenticateAction.notAuthenticated.title",values:{integration:S.name}}),icon:(0,K.jsx)(B.Z,{type:"image_url",imageURL:S.icon,size:16}),...e}),action:()=>{null==l||l()}},Y=[D];return T&&("error"===t.type?Y.push(F):("placeholder"===t.type?Y.push(F):Y.push($),(P||A&&[d.f3,d.mQ].includes(S.id))&&Y.push(Q))),u&&Y.push(E),(0,K.jsx)(q.Z,{...R,children:(0,K.jsx)(H.Z,{type:H.i.Vertical,initialFocus:h?void 0:0,sections:[{key:0,render:e=>(0,K.jsx)(W.Z,{...e,disableDesktopPadding:h,title:(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Try these options",id:"unfurling.errorOptions.menuTitle"})}),items:Y}]})})}class Q extends r.Z{constructor(){super(...arguments),this.renderComponent=()=>{var e,t;const n=this.stateStore.state;if(!n)return;const{integration:o,action:r}=n,{r:i,g:a,b:s}=o.accentColor,c=`rgba(${i},${a},${s},${te(this.environment)?.6:1})`,d=this.environment.currentUser.id?null===(e=M.default.state.currentSpaceStore)||void 0===e?void 0:e.getSpaceUserStore(this.environment.currentUser.id):void 0,u=Boolean(null==d?void 0:d.isMember()),p=Boolean(null==d?void 0:d.isWorkspaceOwner())||(0,h.hU)({spaceBotSettings:null===(t=M.default.state.currentSpaceStore)||void 0===t?void 0:t.getBotSettingsStore().getValue(),integrationId:o.id,env:"production"}),m={state:n,store:this.props.store,onUpdate:()=>{re({from:"external_object_instance_block_error_dropdown"},this.props.store,this.environment,this.props.postActionCallback)},onAuthenticate:()=>{ae({from:"external_object_instance_block_error_dropdown"},this.environment,this.props.store,this.stateStore,this.props.postActionCallback)},onReplace:()=>{var e,t;null===(e=(t=this.props).openPlaceholderMenu)||void 0===e||e.call(t)}},f={...m,onRemove:()=>{!function(e,t,n,o){w.createAndCommit({userAction:"ExternalObjectInstanceAction.handleRemove",environment:e,perform:n=>{S.Cl({environment:e,blocks:[t],transaction:n})}});const r=n.state;var i;r&&y.oQ(e,{integrationId:r.integration.id,entity:null===(i=r.pattern)||void 0===i?void 0:i.name});null==o||o()}(this.environment,this.props.store,this.stateStore,this.props.postActionCallback)}};return(0,K.jsxs)(K.Fragment,{children:["authenticate"===r&&(0,I.sw)(this.environment)&&u&&p&&(0,K.jsx)(F.Z,{icon:e=>(0,K.jsx)(B.Z,{type:"image_url",imageURL:o.accentIcon,size:20,style:{...e,width:16,height:16,marginRight:8,marginLeft:2}}),onClick:()=>ae({from:"external_object_instance_block"},this.environment,this.props.store,this.stateStore,this.props.postActionCallback),style:{...ne(this.theme,this.props.buttonStyle),background:c,fontSize:14,height:32,paddingRight:12,color:te(this.environment)?this.theme.regularTextColor:this.theme.regularInvertedTextColor},hoveredStyle:{background:(0,l._j)(c,.4)},pressedStyle:{background:(0,l._j)(c,.9)},children:(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Connect to {integration} to update",id:"unfurling.authenticateButton.title",values:{integration:n.integration.name}})}),"update"===r&&(0,K.jsx)(ie,{store:this.props.store,postActionCallback:this.props.postActionCallback,buttonStyle:this.props.buttonStyle,isHoverPreview:this.props.isHoverPreview}),"error"===r&&(this.props.isHoverPreview?(0,K.jsx)(J,{...m}):(0,K.jsx)(X,{...f,style:ne(this.theme,this.props.buttonStyle)})),!r&&this.props.renderDefaultAction?(0,K.jsx)(oe,{renderDefaultAction:this.props.renderDefaultAction,buttonStyle:this.props.buttonStyle,store:this.props.store}):null]})},this.stateStore=this.createComputedStore((()=>(0,C._l)({store:this.props.store,isInDarkMode:te(this.environment),canEdit:this.props.canEdit,currentUserId:this.environment.currentUser.id,showAction:this.props.forceActionForUIDoc})),!0)}}function Y(e){const t=(0,a.VK)((()=>{var t;return e.isCollectionView()?null===(t=e.getCollectionViewCollectionStore())||void 0===t||null===(t=t.getFormat().error)||void 0===t?void 0:t.status_code:e.getFormatStore().getKeyStore("error").getKeyStore("status_code").getValue()}),[e]),n=(0,a.VK)((()=>{let t;var n;e.isCollectionView()?t=null===(n=e.getCollectionViewCollectionStore())||void 0===n?void 0:n.getFormat().bot_id:t=e.getFormat().bot_id;const o=P.Z.bots.state.find((e=>e.id===t));if(o)return(0,d.s9)(o.integration_id)}),[e]),{message:r,description:i}=o.useMemo((()=>(0,I.xt)(t,n)),[t,n]);return{statusCode:t,message:r,description:i}}function X(e){window.__c={n:"ErrorPopupButton"};const{onAuthenticate:t,onReplace:n,onUpdate:o,state:r,store:i,onRemove:a,style:l}=e,d=(0,s.yK)((e=>({orangeThemeColor:(0,c.fi)("orange",e),dropdownIcon:{width:10,marginLeft:4,fill:e.lightIconColor}})),[]),{statusCode:p,message:m,description:f}=Y(i);return(0,K.jsx)(E.ZP,{popupType:E.Z4.Popup,originGap:4,renderOrigin:e=>(0,K.jsxs)(F.Z,{style:l,icon:e=>(0,g.t)({...e,fill:d.orangeThemeColor.fill}),...e,children:[(0,K.jsx)("span",{children:x.default.formatMessage(m)}),(0,u.i)(d.dropdownIcon)]}),render:e=>(0,K.jsx)($,{state:r,store:i,onUpdate:o?()=>{o(),e.close()}:void 0,onAuthenticate:t?()=>{t(),e.close()}:void 0,onReplace:()=>{n(),e.close()},onRemove:a?()=>{a(),e.close()}:void 0,statusCode:p,errorDescription:f.description,description:x.default.formatMessage(f,{integrationName:r.integration.name,statusCode:p})})})}function J(e){window.__c={n:"ErrorInlineMenu"};const{onAuthenticate:t,onReplace:n,onUpdate:o,state:r,store:i,onRemove:a}=e,l=(0,s.yK)((e=>({orangeThemeColor:(0,c.fi)("orange",e)})),[]),{statusCode:d,message:u,description:p}=Y(i);return(0,K.jsxs)("div",{style:{alignSelf:"stretch"},children:[(0,K.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:v.Z.fontSize.UIRegular.desktop,fontWeight:v.Z.fontWeight.medium,marginBottom:4},children:[(0,g.t)({width:18,height:18,marginRight:6,fill:l.orangeThemeColor.fill}),(0,K.jsx)("span",{children:x.default.formatMessage(u)})]}),(0,K.jsx)("div",{style:{margin:"0 -14px"},children:(0,K.jsx)($,{state:r,store:i,onUpdate:o,onAuthenticate:t,onReplace:n,onRemove:a,statusCode:d,errorDescription:p.description,description:x.default.formatMessage(p,{integrationName:r.integration.name,statusCode:d}),isInlineMenu:!0})})]})}Q.displayName="ExternalObjectInstanceAction";const ee=Q;function te(e){return"dark"===e.ThemeStore.state.mode}function ne(e,t){return{marginRight:4,color:e.mediumTextColor,...t}}function oe(e){let{renderDefaultAction:t,buttonStyle:n,store:o}=e;window.__c={n:"DefaultActionComponent"};const r=(0,s.Fg)(),a=(0,i.O7)(),{isMobile:l}=a.device;return(0,K.jsx)(E.ZP,{popupType:l?E.Z4.SlideUp:E.Z4.Popup,renderOrigin:e=>(0,K.jsx)(D.Z,{...e,mobileFeedback:l,style:{display:"flex",alignItems:"center",justifyContent:"center",width:l?36:28,height:l?36:28,borderRadius:4,flexShrink:0,opacity:"shown"===t?1:0,...ne(r,n)},children:(0,p.o)({width:l?18:14,color:r.mediumIconColor})}),placementToOrigin:A.Iw.Bottom,render:e=>(0,K.jsx)(T.LazyExternalObjectInstanceBlockMenu,{titleForReloadMenuOption:(0,K.jsx)(b.FormattedMessage,{id:"linkPreview.reload",defaultMessage:"Reload preview"}),store:o,onAccept:()=>e.close(),extraSecondaryItemKey:"preview_to_mention"})})}function re(e,t,n,o){var r;const{from:i}=e,a=null===(r=M.default.state.currentSpaceStore)||void 0===r?void 0:r.id;a&&(k.qK({environment:n,from:i,store:t,spaceId:a,bypassCache:"external_object_instance_block_error_dropdown"===i}),null==o||o())}function ie(e){let{store:t,postActionCallback:n,buttonStyle:o,isHoverPreview:r}=e;window.__c={n:"UpdateActionComponent"};const a=(0,s.Fg)(),l=(0,i.O7)(),c=(0,K.jsx)(F.Z,{onClick:()=>re({from:"external_object_instance_block"},t,l,n),style:ne(a,o),icon:e=>(0,f.b)({...e}),children:(0,K.jsx)(b.FormattedMessage,{defaultMessage:"Update",id:"unfurling.updateButton.title"})});return r?(0,K.jsxs)(K.Fragment,{children:[(0,K.jsxs)("div",{style:{display:"flex",alignItems:"center",fontSize:v.Z.fontSize.UIRegular.desktop,marginBottom:4},children:[(0,m.D)({width:18,height:18,marginRight:6}),(0,K.jsx)("span",{children:(0,K.jsx)(b.FormattedMessage,{defaultMessage:"This link preview is out-of-date.",id:"unfurling.updateButton.header"})})]}),c]}):c}function ae(e,t,n,o,r){var i,a;const{from:s}=e,l=null===(i=o.state)||void 0===i?void 0:i.originalUrl,{currentSpaceStore:c}=M.default.state;if(!c)return;const d=null===(a=(0,C.GQ)(l,c.id))||void 0===a?void 0:a.integration;d&&l&&(_.hM({environment:t,integration:d,spaceId:c.id,unfurlUrl:l,externalObjectInstanceBlockId:n.id,from:s}),R.Z.reset(),null==r||r())}},14562:(e,t,n)=>{n.d(t,{Z:()=>A});var o=n(67294),r=n(24405),i=n(8848),a=n(76725),s=n(72126),l=n(97880),c=n(82990),d=n(44876),u=n(36610),p=n(12170),m=n(95645),f=n(41232),g=n(6398),h=n(68859),v=n(49085);class b extends v.default{getInitialState(){return{error:!1,loading:!1}}}const y=b;var _=n(68709),S=n(51077),w=n(12981),k=n(84076),I=n(68785),C=n(81865),x=n(33742),T=n(19987),M=n(85893);class P extends m.Z{constructor(){super(...arguments),this.origin=o.createRef(),this.storeTypes={externalObjectTokenStore:y,blockResizerStore:h.Z},this.state={isHovered:!1},this.stateStore=this.createComputedStore((()=>{return(0,f._l)({store:this.props.store,isInDarkMode:(e=this.environment,"dark"===e.ThemeStore.state.mode),canEdit:this.canEdit(),currentUserId:this.environment.currentUser.id,showAction:this.props.forceActionForUIDoc});var e}),!0),this.handleMouseEnter=()=>{this.setState({isHovered:!0})},this.handleMouseLeave=()=>{this.setState({isHovered:!1})}}renderPersisted(){const e=this.stateStore.state;if(!e)return this.renderShimmerState();const t=(0,f.y6)(this.props.store);if("error"===e.type&&(null==t||!t.integration_id))return this.renderShimmerState();const{renderConfig:n}=e;return(0,M.jsx)(_.p,{allowSelectionWithin:!0,children:n.previewAttributes&&(0,l.Of)(n.previewAttributes)?this.renderEmbedPreview({attributes:n.previewAttributes,state:e}):this.renderLinkBox(e)})}renderLinkBox(e){var t;const{originalUrl:n,renderConfig:o,integration:r,updating:i}=e,{store:s}=this.props,p=s.getFormat(),m="placeholder"===e.type,h="error"===e.type,v=this.state.isHovered||this.environment.device.isMobile,b=n&&(0,f.pI)(n,s.pointer.spaceId);return u.K9(this.environment,{integrationName:r.name,integrationId:r.id,botId:(null==p?void 0:p.bot_id)||"",externalObjectId:(null==p?void 0:p.external_object_id)||""}),(0,M.jsxs)(k.Z,{ref:this.origin,onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,style:{flexGrow:1,minWidth:0,...(m||h)&&{background:this.theme.embedPlaceholderBackground}},innerStyle:this.getStyle({hasPreview:!(!Boolean(o.previewAttributes)||!o.previewAttributes)&&(0,l.Of)(o.previewAttributes)}),...m||h?{onClick:()=>{const e=this.getPlaceholderNode();e&&O(e,this.environment,this.props.store,this.stores.externalObjectTokenStore,this.stateStore)}}:{href:b,external:!0},children:[(0,M.jsx)("div",{style:{display:"flex",alignSelf:"start",height:32,width:32,marginRight:12,marginLeft:4,marginTop:3,marginBottom:3,position:"relative"},children:(0,M.jsx)(E,{renderConfig:o,integrationIcon:r.icon})}),(0,M.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",flexGrow:1,flexShrink:1,overflow:"hidden"},children:[(0,M.jsxs)("div",{style:{display:"flex",alignItems:"baseline",fontSize:14},children:[(0,a.Z)((null===(t=o.headerAttributes)||void 0===t?void 0:t.map(((e,t)=>{return(0,M.jsx)(g.ox,{...e,store:this.props.store,style:0===t?(n=this.theme,{fontWeight:c.Z.fontWeight.medium,...c.Z.textOverflowStyle,color:n.regularTextColor}):{}},`attribute-${t}`);var n})))||[],(e=>(0,M.jsx)("span",{style:{marginRight:6}},`spacer-${e}`))),(i||this.stores.externalObjectTokenStore.state.loading)&&(0,M.jsx)(I.Z,{style:{marginLeft:6}})]}),o.bodyAttribute&&((0,d.O0)(o.bodyAttribute)?(0,M.jsx)(g.t9,{attribute:o.bodyAttribute}):(0,M.jsx)(g.hx,{attribute:o.bodyAttribute,store:this.props.store})),(0,M.jsxs)("div",{style:{display:"flex",alignItems:"center",color:this.theme.mediumTextColor,fontSize:12},children:[o.subheaderIcon&&(0,M.jsx)(F,{attribute:o.subheaderIcon}),o.subheaderAttributes&&(0,a.Z)(o.subheaderAttributes.map((e=>(0,M.jsx)(R,{attributeConfig:e,store:this.props.store},e.attribute.id))),(e=>(0,M.jsx)("span",{style:{marginLeft:3,marginRight:3},children:"•"},e)))]})]}),(0,M.jsx)(T.Z,{canEdit:this.canEdit(),forceActionForUIDoc:this.props.forceActionForUIDoc,store:this.props.store,renderDefaultAction:v?"shown":"invisible",buttonStyle:o.bodyAttribute?{alignSelf:"flex-start",marginTop:4}:{},openPlaceholderMenu:()=>{const e=this.getPlaceholderNode();e&&O(e,this.environment,this.props.store,this.stores.externalObjectTokenStore,this.stateStore)}})]})}renderShimmerState(){var e;return(0,M.jsxs)(k.Z,{href:null===(e=this.stateStore.state)||void 0===e?void 0:e.originalUrl,external:!0,style:{flexGrow:1,minWidth:0},innerStyle:this.getStyle(),children:[(0,M.jsx)(B,{style:{width:38,height:38}}),(0,M.jsxs)("div",{style:{display:"flex",flexDirection:"column",flexGrow:1},children:[(0,M.jsx)(B,{style:{width:"50%",height:14,margin:4}}),(0,M.jsx)(B,{style:{width:"40%",height:12,margin:4}})]})]})}renderEmbedPreview(e){const{attributes:t,state:n}=e,{integration:o}=n,r=t[0],{values:i,mimeType:a}=r,s=i[0];let c;"image/*"===a?c="image":"audio/*"===a?c="audio":"video/*"===a?c="video":"application/pdf"===a?c="pdf":"text/html"===a?c="embed":(0,l.t1)(a);const d="image"===c||"pdf"===c||"embed"===c,p=this.props.store,m=p.getFormat();return u.K9(this.environment,{integrationName:o.name,integrationId:o.id,botId:(null==m?void 0:m.bot_id)||"",externalObjectId:(null==m?void 0:m.external_object_id)||""}),p.isExternalObjectInstanceBlockStore()?(0,M.jsx)("div",{style:{overflow:"hidden",borderRadius:6,border:`1px solid ${this.theme.tableDividerColor}`,borderBottom:void 0,position:"relative"},children:(0,M.jsx)(x.ZP,{store:p,source:s,showExpandButton:d,mediaType:c,...(0,f.Xg)()?{disabled:!1,preserveScale:"image"===c,blockResizerStore:this.stores.blockResizerStore}:{disabled:!0,preserveScale:!0,disableActions:!0,..."image"===c&&{centerWrappedContent:!0}},contentBelowSource:this.renderLinkBox(e.state)})}):void 0}handleCreated(){const e=this.getPlaceholderNode();e&&O(e,this.environment,this.props.store,this.stores.externalObjectTokenStore,this.stateStore)}getPlaceholderNode(){var e,t;if("placeholder"===(null===(e=this.stateStore.state)||void 0===e?void 0:e.type)||"error"===(null===(t=this.stateStore.state)||void 0===t?void 0:t.type)){const e=this.origin.current;if(e&&e instanceof Element)return e}}getStyle(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{hasPreview:t}=e;return{display:"flex",alignItems:"center",border:`1px solid ${this.theme.tableDividerColor}`,borderRadius:t?"0px 0px 4px 4px":4,borderLeft:t?"none":`1px solid ${this.theme.tableDividerColor}`,borderRight:t?"none":`1px solid ${this.theme.tableDividerColor}`,padding:"8px 12px",...this.getBlockColorStyle(),...this.props.style}}}const A=P;function R(e){let{attributeConfig:t,store:n}=e;return(0,M.jsx)(g.ox,{...t,store:n})}function D(e){return{filter:`\n            drop-shadow(0px 0px 1px ${e.contentBackground})\n            drop-shadow(0px 0px 1px ${e.contentBackground})\n            drop-shadow(0px 0px 1px ${e.contentBackground})\n        `}}function E(e){let{renderConfig:t,integrationIcon:n}=e;window.__c={n:"BlockIconComponent"};const o=(0,r.Fg)(),i=s.mN(t.icons||[],(e=>`${e.type}:${e.values[0].toString()}`));return i.length>=2?(0,M.jsxs)("div",{style:{width:32,height:32},children:[(0,M.jsx)(g.lf,{attribute:i[0],isSmall:!0}),(0,M.jsx)(g.lf,{attribute:i[1],isSmall:!0,style:{position:"absolute",bottom:0,right:2}}),(0,M.jsx)(S.Z,{type:"image_url",imageURL:n,size:16,style:{position:"absolute",bottom:-3,right:-3},imageStyle:D(o)})]}):1===i.length?(0,M.jsxs)(M.Fragment,{children:[(0,M.jsx)(g.lf,{attribute:i[0],isSmall:!1}),(0,M.jsx)(S.Z,{type:"image_url",imageURL:n,size:16,style:{position:"absolute",bottom:-2,right:-2},imageStyle:D(o)})]}):(0,M.jsx)(S.Z,{type:"image_url",imageURL:n,size:38})}function B(e){let{style:t}=e;window.__c={n:"ShimmerboxComponent"};const n=(0,r.Fg)();return(0,M.jsx)("div",{style:{overflow:"hidden",position:"relative",background:n.selectLightGray[30],...t},children:(0,M.jsx)("div",{style:{position:"absolute",height:"100%",width:"100%",zIndex:1,animation:"shimmer 1s infinite",background:`linear-gradient(to right, ${n.selectLightGray[30]} 0%, ${n.selectLightGray[50]} 20%, ${n.selectLightGray[30]} 40%, ${n.selectLightGray[30]} 100%)`}})})}function F(e){let{attribute:t}=e;window.__c={n:"SubheaderIconAttributeComponent"};const n=(0,r.Fg)();if((0,d.li)(t)){const e=t.values[0];return(0,M.jsx)(C.Z,{isAuthenticated:!1,url:e,width:32,render:(e,t)=>(0,M.jsx)(w.Z,{src:t,height:12,placeholderLoadedStyle:{width:12,height:12,marginRight:4}})})}if((0,d.hW)(t)){const e=t.values[0],o=e?`rgb(${e.r},${e.g},${e.b})`:"gray",{colorName:r,shade:a}=(0,i.lL)(o);return(0,M.jsx)("div",{style:{width:12,height:12,marginRight:4,background:n.accentColors[r][a],borderRadius:4,flexShrink:0}})}return null}function O(e,t,n,o,r){var i;const a=(0,f.y6)(n);p.os({originRect:e.getBoundingClientRect(),environment:t,externalObjectInstanceBlockStore:n,placeholderIntegrationId:null==a?void 0:a.integration_id,integration:null===(i=r.state)||void 0===i?void 0:i.integration,externalObjectTokenStore:o})}},69721:(e,t,n)=>{n.d(t,{S:()=>E,Z:()=>B});var o=n(67294),r=n(480),i=n(86628),a=n(49271),s=n(43593),l=n(50066),c=n(72126),d=n(62965),u=n(70203),p=n(82990),m=n(9291),f=n(57549),g=n(31781),h=n(62365),v=n(27153),b=n(24677),y=n(98104),_=n(82530),S=n(73819),w=n(27411),k=n(13966),I=n(91893),C=n(23864),x=n(64921),T=n(64369),M=n(86329),P=n(78454),A=n(85893);const R=(0,m.defineMessages)({fileTitle:{defaultMessage:"File",id:"fileBlock.fileTab.title"},embedButtonText:{defaultMessage:"Embed link",id:"fileBlock.embedButton.label"},embedFilePrompt:{defaultMessage:"Paste a file link…",id:"fileBlock.linkPrompt.placeholder"},embedCaption:{defaultMessage:"Works with links of PDFs, Google Drive, Google Maps, CodePen…",id:"fileBlock.linkPrompt.caption"}});function D(e,t){window.__c={n:"FileBlock"};const n=(0,m.useIntl)(),a=(0,r.O7)(),s=(0,r.Fy)(),d=(0,o.useRef)(null),p=(0,o.useId)(),[x,T]=(0,o.useState)(!1),P=(0,S.PE)(e.store,e.disabled),D=(0,S.rv)(e.store),B=(0,i.VK)((()=>{const t=e.store.getProperties(),n=t&&t.source,o=u.QaF(n),{display_source:r}=e.store.getFormat();return r||o}),[e.store]),F=(0,i.VK)((()=>w.default.getKeyState(w.default.getBlockKey(e.store.id))),[e.store.id]),O=s.isMobile||x,Z=(0,i.VK)((()=>e.store.getProperties()),[e.store]),V=(0,o.useMemo)((()=>u.Jcv(Z&&Z.title)),[Z]),U=(0,o.useMemo)((()=>u.Jcv(Z&&Z.size)),[Z]),N=O&&P&&(0,A.jsx)(k.Z,{style:{marginRight:4},store:e.store,fadeIn:!0}),L=(0,o.useCallback)((()=>{const t=e.store.getPropertyStore("caption");b.eP({environment:a,store:e.store}),y.NX({store:t})}),[a,e.store]),j=(0,o.useCallback)((t=>{_.createAndCommit({userAction:"FileBlock.handleUpload",environment:a,perform:t=>{h.v({environment:a,store:e.store,source:void 0,name:void 0,size:void 0,transaction:t})}}),f.re(a,{source:"upload",file:t.name}),h.c({environment:a,store:e.store,file:t})}),[a,e.store]),z=(0,o.useCallback)((()=>{const t=d.current;if(P&&t){const o=t.getBoundingClientRect();v.$(a,{originRect:o,originGap:0,isSmallWidth:!0,showArrow:!0,title:n.formatMessage(R.fileTitle),currentTab:"file",tabs:[{type:"file",fileUpload:!0,imageUpload:s.isAndroid,videoUpload:s.isAndroid,onUpload:j},{type:"embed",buttonText:n.formatMessage(R.embedButtonText),inputPlaceholder:n.formatMessage(R.embedFilePrompt),caption:n.formatMessage(R.embedCaption),onChange:t=>{v.Z(),_.createAndCommit({userAction:"FileBlock.handleOpenMenu",environment:a,perform:n=>{h.v({environment:a,store:e.store,source:t,name:void 0,size:void 0,transaction:n})}}),f.re(a,{file:t,source:"embed"}),f.bO(a,{pastedText:t,source:"file_block_menu"})}}]})}}),[P,s.isAndroid,a,j,n,e.store]),q=(0,o.useCallback)((()=>{g.qL(a,{store:e.store,from:"embedded_block_click"})}),[a,e.store]),H=(0,o.useMemo)((()=>({flexGrow:1,minWidth:0,borderRadius:4,...c.CE(D,["fontSize","lineHeight"])})),[D]),W=(0,A.jsxs)("div",{role:"figure","aria-labelledby":p,ref:d,children:[(0,A.jsxs)("div",{onMouseMove:()=>T(!0),onMouseLeave:()=>T(!1),style:{display:"flex"},children:[(0,A.jsx)(E,{title:V,url:B,size:U,onClick:q,right:N,style:H}),(0,A.jsx)(C.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}),(0,A.jsx)(I.Z,{store:e.store,captionAriaId:p,disabled:e.disabled})]}),K=(0,A.jsxs)("div",{onMouseMove:()=>T(!0),onMouseLeave:()=>T(!1),style:{display:"flex"},ref:d,children:[(0,A.jsx)(M.Z,{disabled:e.disabled,iconSvg:l.R,shouldHideRight:!O,right:P&&(0,A.jsx)(k.Z,{store:e.store,fadeIn:!1}),isLoading:Boolean(F),progressPercent:F?F.progressPercent:0,file:F?F.file:void 0,name:F?F.name:void 0,size:F?F.size:void 0,onClick:z,children:(0,A.jsx)(m.FormattedMessage,{defaultMessage:"Upload or embed a file",id:"fileBlock.uploadOrEmbed.placeholder"})}),(0,A.jsx)(C.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}),G=B?W:K;return(0,S.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"file",getNode:()=>d.current,getBlockStore:()=>e.store,caption:L,handleCreated:z,edit:z,activate:z,replace:z})),[L,z,e.store]),G)}function E(e){const{style:t,right:n,title:o,url:r,size:i,onClick:c}=e,d={paddingTop:a.ZD.paddingTop,paddingBottom:a.ZD.paddingBottom,paddingLeft:a.ZD.paddingLeft};return(0,A.jsx)(x.Z,{style:t,onClick:c,children:(0,A.jsx)(P.ZP,{style:d,left:(0,l.R)(),leftStyle:{width:"1.35em",height:"1.35em"},alignment:P.v2.Center,right:n,children:(0,A.jsxs)("div",{style:{display:"flex",alignItems:"baseline"},children:[(0,A.jsx)("div",{style:{...p.Z.textOverflowStyle},children:s.rF({title:o,source:r})}),i&&(0,A.jsx)(T.Z,{isSmall:!0,style:{marginLeft:6,whiteSpace:"nowrap"},children:i})]})})})}const B=o.memo(o.forwardRef(D),d.Z)},65453:(e,t,n)=>{n.d(t,{Z:()=>_});var o=n(67294),r=n(480),i=n(86628),a=n(24405),s=n(49271),l=n(76490),c=n(62965),d=n(9291),u=n(35328),p=n(73819),m=n(45131),f=n(23864),g=n(21407),h=n(17377),v=n(85893);const b=(0,d.defineMessages)({placeholder:{defaultMessage:"Heading 1",id:"header1Block.placeholder"}});function y(e,t){window.__c={n:"HeaderBlock"};const n=(0,d.useIntl)(),c=(0,r.O7)(),y=(0,r.Fy)(),_=(0,o.useRef)(null),S=(0,p.rv)(e.store),w=(0,p.Iy)(e.store),k=(0,i.VK)((()=>e.store.getBlockTitleStore()),[e.store]),I=(0,i.VK)((()=>m.Z.isOpen(e.store.id)&&!e.hideContent),[e.hideContent,e.store.id]),C=(0,a.yK)((e=>{const t=(y.isMobile?1.5:l.eV)*l.u9,n=y.isMobile?1.5:l.eV;return{root:{display:"flex",width:"100%",...S},toggle:{height:`${t}em`,marginTop:3},headerText:{...s.ZD,...(0,l.DK)({fontSizeValue:n,fontFamily:w})},headerTextPlaceholder:{WebkitTextFillColor:e.headerBlockPlaceholderTextColor}}}),[S,y.isMobile,w]);return(0,p.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"header",getNode:()=>_.current,getBlockStore:()=>e.store,activate(){u.th(c,e.store,e.hideContent)}})),[c,e.hideContent,e.store]),(0,v.jsx)("div",{ref:_,style:{...C.root,...e.style},children:(0,v.jsxs)(h.Z,{store:e.store,toggleStyle:C.toggle,childrenStyleWhenToggleable:{display:"flex"},hideContent:e.hideContent,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,children:[(0,v.jsx)(g.Z,{tagName:"h2",disabled:e.disabled,store:k,placeholder:n.formatMessage(b.placeholder),placeholderStyle:C.headerTextPlaceholder,style:C.headerText,pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent}),(0,v.jsx)(f.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store,recursivelyLoadAllDiscussions:!I})]})}))}const _=o.memo(o.forwardRef(y),c.Z)},83182:(e,t,n)=>{n.d(t,{Z:()=>u});n(67294);var o=n(480),r=n(86628),i=n(24405),a=n(84169),s=n(25888),l=n(52275),c=n(16354),d=n(85893);function u(e){window.__c={n:"HelpButtonMenu"};const t=(0,o.O7)();return(0,d.jsx)(c.Z,{href:e.href,external:!0,onClick:()=>s.Fs(t,{from:e.analyticsFrom}),children:(0,d.jsx)(l.Z,{icon:!e.left&&(0,d.jsx)(m,{left:e.left}),title:(0,d.jsx)(p,{title:e.title,left:e.left}),focused:!1})})}function p(e){window.__c={n:"Title"};const t=(0,o.O7)(),n=(0,r.VK)((()=>t.device.isPhone),[t]),a=(0,i.yK)((e=>({title:{fontSize:n?14:12,verticalAlign:1,color:e.lightTextColor}})),[n]);return e.left?(0,d.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,d.jsx)("span",{style:{...a.title,marginRight:"auto"},children:e.left}),(0,d.jsx)(m,{left:e.left}),(0,d.jsx)("span",{style:a.title,children:e.title})]}):(0,d.jsx)("span",{style:a.title,children:e.title})}function m(e){let{left:t}=e;window.__c={n:"IconComponent"};const n=(0,i.Fg)(),r=(0,o.MO)();return(0,a.m)({width:r?16:14,fill:n.lightIconColor,marginRight:t?6:0})}},74523:(e,t,n)=>{n.d(t,{Z:()=>m});var o=n(67294),r=n(480),i=n(24405),a=n(84169),s=n(25888),l=n(73063),c=n(16354),d=n(89728),u=n(85893);function p(e){let{title:t,href:n,analyticsFrom:p,shouldShrink:m,style:f,buttonStyle:g,isBlue:h,onClick:v,onFocus:b,onBlur:y,onMouseDown:_,onMouseEnter:S,onMouseLeave:w}=e;window.__c={n:"HelpButtonSettingsCaption"};const k=(0,r.O7)(),I={onFocus:b,onBlur:y,onMouseDown:_,onMouseEnter:S,onMouseLeave:w},C=(0,o.useCallback)((()=>{void 0!==v&&v(),s.Fs(k,{from:p})}),[p,k,v]),x=(0,i.yK)((()=>({link:{display:"flex",marginLeft:-6,...f}})),[f]);return(0,u.jsx)(c.Z,{style:x.link,className:"notion-print-ignore",href:n,external:!0,onClick:C,...I,children:t?(0,u.jsx)(d.Z,{icon:a.m,isSmall:!0,isBlue:h,isLightGray:!h,shouldShrink:m,style:g,children:t}):(0,u.jsx)(l.Z,{icon:a.m,isBlue:h,style:g,...I})})}const m=o.memo(p)},84456:(e,t,n)=>{n.d(t,{Z:()=>I});n(82801);var o=n(67294),r=n(83355),i=n(480),a=n(88464),s=n(86628),l=n(24405),c=n(26198),d=n(63085),u=n(12534),p=n(55367),m=n(80796),f=n(77080),g=n(49085);class h extends g.default{getInitialState(){return{disabled:!1,loaded:!1,hasPreviewBeenDismissed:!1,isVisible:!1}}}const v=h;var b=n(69784),y=n(25777),_=n(85893);const S={position:"absolute",left:0,top:0,width:"100%",height:"100%",borderRadius:1};class w extends r.Z{constructor(){super(...arguments),this.iframe=null,this.storeTypes={iframeStore:v},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove=e=>function(e,t){const n=p.ZP.state.isDragging,o=m.Z.state.isDragging,r=b.default.state.isActive,i=n||o||r;t.setState({...t.state,disabled:i})}(0,this.stores.iframeStore),this.releaseFocus=()=>{document.activeElement&&document.activeElement===this.iframe&&document.activeElement.blur()},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handlePreviewMouseDown=e=>x(e,this.stores.iframeStore)}didMountOrUpdate(){super.didMountOrUpdate(),this.releaseFocus()}renderComponent(){return(0,_.jsx)("div",{style:this.props.style,onMouseMove:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove,onMouseEnter:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove,onMouseLeave:this.releaseFocus,children:(0,_.jsx)("div",{style:(0,d.kl)(this.props),children:this.renderInnerContent()})})}renderInnerContent(){if(function(e,t){if(!window.__webViewTerminatedWhileAppActive&&"on"!==f.default.getGroup("embed-previews"))return!1;return!e.state.hasPreviewBeenDismissed&&Boolean(t)}(this.stores.iframeStore,this.props.renderPreview))return(0,_.jsx)(T,{background:this.props.background,renderPreview:this.props.renderPreview,iframeStore:this.stores.iframeStore});const e=(0,d.I$)(this.props.source),t=C(this.theme,this.props.background,this.stores.iframeStore);return(0,_.jsx)(y.Z,{innerStyle:{height:"100%",width:"100%"},loaded:this.stores.iframeStore.state.loaded,style:S,spinnerSize:"1em",showSpinnerTimeout:500,children:e&&(0,_.jsx)(k,{ref:e=>{this.iframe=e},sourceUrl:e,wrapperStyle:{...t,backgroundColor:"none"},style:C(this.theme,this.props.background,this.stores.iframeStore),allow:this.props.allow,iframeStore:this.stores.iframeStore,onContentLoadTimeout:this.props.onContentLoadTimeout})})}willUnmount(){super.willUnmount()}}w.displayName="IFrameBox";const k=o.forwardRef((function(e,t){window.__c={n:"ManagedIFrame"};const{sourceUrl:n,style:r,allow:s,iframeStore:l,onContentLoadTimeout:d,wrapperStyle:u}=e,p=(0,i.O7)(),[m,g]=(0,c.jo)(),h=(0,o.useRef)(void 0),v=(0,a.Z)(t,h),b=(0,o.useRef)(void 0),y=p.device.isElectron?"allow-scripts allow-popups allow-forms allow-same-origin":"allow-scripts allow-popups allow-top-navigation-by-user-activation allow-forms allow-same-origin allow-storage-access-by-user-activation",S=(0,o.useCallback)((()=>{if(f.default.checkGate("embed_block_fallback")){let t;try{t=Boolean(h.current&&h.current.contentWindow&&"about:blank"!==h.current.contentWindow.location.href)}catch(e){if(e instanceof DOMException)return;throw e}t||null==d||d()}}),[d]),w=(0,o.useCallback)((()=>{l.setState({...l.state,loaded:!0}),S()}),[S,l]);return(0,o.useEffect)((()=>(b.current=setTimeout(S,7e3),()=>{clearTimeout(b.current)})),[S]),(0,_.jsx)("div",{ref:m,style:u,children:g&&(0,_.jsx)("iframe",{ref:v,style:r,src:n,frameBorder:"0",onLoad:()=>{clearTimeout(b.current),w()},sandbox:y,allowFullScreen:!0,allow:s})})})),I=w;function C(e,t,n){return{...S,pointerEvents:n.state.disabled?"none":"auto",backgroundColor:t?e.contentBackground:"none"}}function x(e,t){e.preventDefault(),(0,u.ZP)({event:e,context:u.Af.EditorClick,callback:()=>{t.setState({...t.state,hasPreviewBeenDismissed:!0})}})}function T(e){let{background:t,renderPreview:n,iframeStore:r}=e;window.__c={n:"PreviewComponent"};const i=(0,l.Fg)(),a=(0,o.useCallback)((e=>x(e,r)),[r]),c=(0,s.VK)((()=>C(i,t,r)),[t,r,i]);return(0,_.jsx)("div",{style:{...c,backgroundColor:"none"},onMouseDown:a,children:null==n?void 0:n()})}},42402:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(8848),r=n(16354),i=n(85893);const a={red:"notion-link",purple:"notion-link-ai-version",blue:"notion-link-blue"};const s=function(e){let{href:t,external:n,disableHover:s,onClick:l,onMouseDown:c,onMouseEnter:d,onMouseLeave:u,disableUnderline:p,style:m,hoverColor:f="red",children:g}=e;const h={display:"inline",textDecoration:"underline",color:o.ZP.inherit},v=f?a[f]:a.red;return(0,i.jsx)(r.Z,{href:t,external:n,style:{...h,...m,...p&&{textDecoration:"none"}},onClick:l,className:s?void 0:v,onMouseDown:c,onMouseEnter:d,onMouseLeave:u,children:g})}},83785:(e,t,n)=>{n.d(t,{Z:()=>g});n(67294);var o=n(83355),r=n(68626),i=n(91155),a=n(29477),s=n(12457),l=n(88632),c=n(49085);class d extends c.default{getInitialState(){return{loaded:!1}}}const u=d;var p=n(68785),m=n(85893);class f extends o.Z{constructor(){super(...arguments),this.storeTypes={store:u}}didMount(){!async function(e,t){let n=1e3;for(;;)try{const n=await e();t.setState({loaded:!0,result:n});break}catch(o){r.log({level:"warning",from:"LazyLoader",type:"fetchError",error:(0,i.Ui)(o),data:{miscDataToConvertToString:{waitMs:n}}}),await a.Vs(n),await l.Z.waitUntil((()=>l.Z.state.online)),n=Math.min(2*n,3e4)}}(this.props.fetch,this.stores.store)}renderComponent(){return(0,m.jsx)(s.Z,{show:!this.stores.store.state.loaded,showDelay:300,showHold:0,render:e=>this.stores.store.state.loaded?(this.props.willRender&&this.props.willRender(),this.props.render(this.stores.store.state.result)):this.props.loading?this.props.loading(e):e?(0,m.jsx)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",width:"100%"},children:(0,m.jsx)(p.Z,{})}):void 0})}}f.displayName="LazyLoader";const g=f},55217:(e,t,n)=>{n.d(t,{Z:()=>ve});n(57658);var o=n(67294),r=n(83355),i=n(27531),a=n(41432),s=n(72126),l=n(4615),c=n(21202),d=n(97880),u=n(13084),p=n(82530),m=n(98165),f=n(46654),g=n(23883),h=n(79797),v=n(99757),b=n(45697),y=n.n(b),_=n(45060),S=n(95538),w=n(606),k=n(18844),I=n(15047),C=n(3022),x=n(94419),T=n(64964),M=n(1742),P=n(10906),A=n(92650),R=n(27105),D=n(19037),E=n(28020),B=n(78175),F=n(41232),O=n(78429),Z=n(50627),V=n(17504),U=n(65598),N=n(73959),L=n(35328),j=n(49427),z=n(24646),q=n(50694),H=n(68859),W=n(4926),K=n(77080),G=n(88923),$=n(26664),Q=n(27724),Y=n(45131),X=n(51247),J=n(74480),ee=n(53223),te=n(23063),ne=n(45952),oe=n(79954),re=n(5595),ie=n(85893);const ae=4,se=4,le={quote:se,code:se,header:se,bookmark:se,external_object_instance:se,file:void 0,video:se,embed:se,tweet:se,drive:se,audio:se,gist:se,maps:se,framer:se,invision:se,figma:se,loom:se,typeform:se,mixpanel:se,codepen:se,equation:se,pdf:se,image:se,sub_header:void 0,sub_sub_header:void 0,page:void 0,collection_view:void 0,collection_view_page:void 0,column_list:void 0,column:void 0,personal_home_page:void 0,breadcrumb:void 0,text:void 0,bulleted_list:void 0,numbered_list:void 0,to_do:void 0,toggle:void 0,factory:void 0,copy_indicator:void 0,divider:void 0,link_to_collection:void 0,link_to_page:void 0,alias:void 0,transclusion_container:1,transclusion_reference:1,callout:se,table_of_contents:se,whimsical:se,miro:se,abstract:se,sketch:se,excalidraw:se,replit:se,hex:se,deepnote:se,table:1,table_row:void 0,tab:se,external_object_instance_page:se,button:void 0,ai_block:1,drawing:se},ce={quote:ae,code:ae,bookmark:ae,external_object_instance:ae,file:void 0,video:ae,embed:ae,tweet:ae,audio:ae,drive:ae,gist:ae,maps:ae,framer:ae,invision:ae,figma:ae,loom:ae,typeform:ae,codepen:ae,equation:ae,pdf:ae,header:"2em",sub_header:"1.4em",sub_sub_header:"1em",image:ae,page:void 0,personal_home_page:void 0,collection_view:void 0,collection_view_page:void 0,column_list:void 0,column:void 0,breadcrumb:void 0,text:void 0,bulleted_list:void 0,numbered_list:void 0,to_do:void 0,toggle:void 0,factory:void 0,copy_indicator:void 0,divider:void 0,link_to_collection:void 0,link_to_page:void 0,alias:void 0,transclusion_container:1,transclusion_reference:1,callout:ae,table_of_contents:ae,whimsical:ae,miro:ae,abstract:ae,mixpanel:ae,sketch:ae,excalidraw:ae,replit:ae,table:1,table_row:void 0,tab:ae,hex:ae,deepnote:ae,external_object_instance_page:ae,button:void 0,ai_block:1,drawing:ae},de={left:"flex-start",center:"center",right:"flex-end"};class ue extends r.Z{constructor(){super(...arguments),this.blockRef=o.createRef(),this.storeTypes={blockResizerStore:H.Z},this.renderPreventSidebar=()=>{const{isInlineCollectionView:e}=this.renderStateStore.state;return e?this.renderSelectable():(0,V.Z)(this.renderSelectable)},this.renderSelectable=e=>{const{store:t,canEditList:n,isFirstItem:o,isLastItem:r}=this.props,{canDropOnto:i,canDropLeftRight:a,shouldShowParentHalo:s,showHoverMenu:l,canDrag:c,canSelect:d,shouldShowSelectionHalo:u,isSimpleTable:p,showCommentMenu:m,preventBackgroundDrag:f,shouldDisableHoverMenuDrag:g,disableForceTouch:h,canTriggerContextMenu:v}=this.renderStateStore.state;return(0,ie.jsx)(oe.Z,{style:this.getStyle.state,store:t,canSelect:d,canEditText:this.canEdit(),shouldShowHalo:u,shouldShowParentHalo:s,canDrag:c,canDropAbove:n&&o,canDropBelow:n,canDropLeft:a,canDropRight:a,canDropOnto:n&&i,isLastItem:r,canNativeDropAbove:n&&o,canNativeDropBelow:n,canNativeDropLeft:a,canNativeDropRight:a,onSelectableDrop:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDrop,onNativeDrop:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleNativeDrop,canTriggerContextMenu:v,onInsertBelow:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleInsertBelow,onInsertAbove:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleInsertAbove,canInsertAbove:n,canInsertBelow:n,onEditText:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleEditText,onEnter:this.handleEnter,onRemove:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleRemove,showBlockMenuInput:!0,shouldShowHoverMenu:l,shouldDisableHoverMenuDrag:g,disableForceTouch:h,shouldShowCommentMenu:m,shouldShowDropZone:!p,isListContainer:!0,preventBackgroundDrag:f,analyticsName:"page_content",...e,children:this.renderBlock()})},this.handleEnter=e=>{this.blockRef.current&&this.blockRef.current.edit?this.blockRef.current.edit():u.Bm({environment:this.environment,targetStore:this.props.store,targetParentStore:this.props.listStore,isAtStartOfLine:!1,isClick:!1,transaction:e.transaction})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDrop=e=>{!function(e,t,n,o){const{droppedDirection:r,droppedStores:i,duplicate:a}=e;if((0,R.iG)(n,i))return void T.oV({label:(0,R.s8)(n)});p.createAndCommit({userAction:"ListItemBlock.handleDrop",environment:o,perform:e=>{u.LQ({environment:o,targetParentStore:t,targetStore:n,droppedDirection:r,droppedStores:i,duplicate:a,transaction:e})}})}(e,this.props.listStore,this.props.store,this.environment)},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleNativeDrop=e=>{!function(e,t,n,o){const{files:r,droppedDirection:i}=e;p.createAndCommit({userAction:"ListItemBlock.handleNativeDrop",environment:o,perform:e=>u.uQ({environment:o,files:r,targetParentStore:t,targetStore:n,droppedDirection:i,transaction:e})})}(e,this.props.listStore,this.props.store,this.environment)},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleInsertBelow=e=>function(e,t,n){const{insertStores:o,transaction:r}=e;return s.d9(o).reverse().map((e=>x.BE({parent:t,insert:e,after:n,transaction:r}).child))}(e,this.props.listStore,this.props.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleInsertAbove=e=>function(e,t,n){const{insertStores:o,transaction:r}=e;return s.d9(o).reverse().map((e=>x.Vt({parent:t,insert:e,before:n,transaction:r}).child))}(e,this.props.listStore,this.props.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleEditText=e=>{!function(e,t,n,o){u.DC({environment:o,targetStore:t,targetParentStore:n,isAtStartOfLine:e.isAtStartOfLine,isAtStartOfContainer:e.isAtStartOfContainer,isClick:e.isClick,transaction:e.transaction})}(e,this.props.store,this.props.listStore,this.environment)},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleRemove=e=>{!function(e,t,n){const{transaction:o}=e,r=t.getRecordStoreUIParent();r&&(r.table!==c.iU&&r.table!==I.bx&&r.table!==k.Xj||!r.valueIs($.i)||(M.uO(n,"user_flow_delete_block",o,"ListItemBlock.handleRemove"),x.Od({parent:r,childToRemove:t,transaction:o})))}(e,this.props.store,this.environment)},this.legacyTransclusionParentStore=this.createComputedStore((()=>{if(!this.isLegacyTransclusionStore.state)return;const e=this.props.listStore.getRecordStoreAtRootPath();return(0,U.OY)(e)?e:void 0})),this.isPageFullWidth=this.createComputedStore((()=>{var e;return null===(e=this.pageContext)||void 0===e?void 0:e.pageStore.isFullWidth()})),this.canEditStore=this.createComputedStore((()=>{const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return!this.props.disabled&&(!(0,f.YF)(e)&&this.props.store.canEdit())})),this.isLegacyTransclusionStore=this.createComputedStore((()=>{const e=this.props.store.getParentId();return Boolean(e&&this.props.listStore.id!==e)})),this.isReadOnlyBlockInReadWritePageStore=this.createComputedStore((()=>{const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return this.props.canEditList&&!D.OO({environment:this.environment,blocks:[this.props.store],publicEditMode:e})})),this.renderStateStore=this.createComputedStore((()=>{const{device:e}=this.environment,{store:t,canEditList:n,disableSelection:o,disableHoverMenu:r,disableCommentMenu:i}=this.props,s=t.getFormat(),l=t.getType(),{dragging:d,temporaryFullWidth:u}=this.stores.blockResizerStore.state,p=(0,J.h)(this.props.store),m=d?u:s.block_full_width,g=l===a.Ti.page||l===a.Ti.collectionViewPage||s.alias_pointer&&(0,w.$O)(s.alias_pointer,c.iU)||l&&(0,L._A)(l,s)&&!Y.Z.isOpen(t.id),h=Boolean(l&&(0,a.dM)(l)),v=l===a.Ti.table,b=l===a.Ti.columnList,y=p===ee.DZ,_=y,S=me(this.props.store)&&!b&&!v&&n&&!e.isPhone,k=this.pageContext&&this.pageContext.publicEditModeStore.state,I=(0,f.BZ)(k),C=y&&t.getCollectionStore();let x=y;if(C){void 0===C.getKeyStore("version").getValue()&&(x=!1)}const T=!o&&t.canRead()&&!v&&!this.isReadOnlyBlockInReadWritePageStore.state&&!x,M=!I&&T&&!y&&!v,P=M,A=!(I||r||b||y||v||(l===a.Ti.transclusionContainer||l===a.Ti.transclusionReference||l===a.Ti.aiBlock)&&function(e){return Q.default.state.stores.some((t=>t!==e&&e.uiContains(t)))}(this.props.store)),R=!i&&("comment_only"===t.getRole()||"comment"===(null==k?void 0:k.permission))&&!n&&!b&&!h&&this.environment.currentUser.isLoggedIn()&&!v,D=v?q.g$.getNumberOfUnresolvedComments({simpleTableStore:t,environment:this.environment,includeInline:!this.marginCommentsVisible.state}):0,E=n&&!b&&!this.props.disableDrag,B=Boolean(this.props.store.findRecordStoreUIAncestor((e=>e===G.default.peekTarget.state)).ancestor),F=l&&(0,a.OY)(l)&&!t.getProperties().source,O="drawing"===l&&(0,N.iZ)(t),Z=s.block_alignment,V=n&&!b&&!t.inMemoryRecordCache.isSyntheticAssistantData;return{type:l,isFullWidth:m,canDropOnto:g,canDropLeftRight:S,shouldShowParentHalo:P,showHoverMenu:A,canDrag:E,canSelect:T,shouldShowSelectionHalo:M,showCommentMenu:R,numSimpleTableComments:D,isInlineCollectionView:y,isSimpleTable:v,isInPeekRenderer:B,isMediaWithoutSource:F,preventBackgroundDrag:_,disableForceTouch:O,shouldDisableHoverMenuDrag:this.isReadOnlyBlockInReadWritePageStore.state,alignStyle:Z,canTriggerContextMenu:V}}),!0,"renderStateStore"),this.blockRendererStore=this.createComputedStore((()=>(0,J.h)(this.props.store))),this.appRenderState=this.createComputedStore((()=>E.h1(this.environment))),this.getStyle=this.createComputedStore((()=>{const{device:e}=this.environment,{store:t}=this.props,{type:n,isInPeekRenderer:o,isFullWidth:r,isInlineCollectionView:i,isSimpleTable:s,numSimpleTableComments:l,isMediaWithoutSource:c,alignStyle:d}=this.renderStateStore.state,u={};if(this.externalObjectStateStore.state){const e=this.externalObjectStateStore.state;u.minWidth=S.B9,"image/*"!==e&&(u.width="100%")}else u.width="100%";if(u.maxWidth=this.getFullWidth(),(e.isMobile&&!r||this.isInColumnList()||!me(this.props.store))&&(u.maxWidth="100%"),d&&!r&&!e.isPhone&&de[d]?u.alignSelf=de[d]:me(this.props.store)&&n&&a.ib[n]?u.alignSelf="center":n&&a.Ok[n]&&(u.alignSelf="flex-start"),u.marginTop=this.props.isFirstItem?2:1,u.marginBottom=this.props.isLastItem?0:1,c?u.marginTop=ae:n&&ce[n]&&(u.marginTop=ce[n]),c&&!this.props.isLastItem?u.marginBottom=se:!this.props.isLastItem&&n&&le[n]&&(u.marginBottom=le[n]),(i||s&&0===l)&&(me(this.props.store)||e.isPhone)){const e=this.getFullWidth();u.maxWidth=o?`calc(100vw - ${2*G.PeekModeOuterPadding-W.Z.state}px)`:(0,P.Ks)(t)&&!this.isPageFullWidth.state?Z.zL:e,u.width=(0,P.Ks)(t)&&!this.isPageFullWidth.state?Z.zL:e,u.alignSelf="center"}return me(this.props.store)&&this.marginCommentsVisible.state&&i&&(u.zIndex=1),(0,O.H)()&&this.isLegacyTransclusionStore.state&&(u.border="3px dashed deeppink"),u})),this.externalObjectStateStore=this.createComputedStore((()=>{if((0,F.Xg)()&&this.props.store.isExternalObjectInstanceBlockStore()){var e;const t=(0,F._l)({store:this.props.store,canEdit:this.canEdit(),currentUserId:this.environment.currentUser.id,isInDarkMode:"dark"===this.environment.ThemeStore.state.mode,showAction:void 0});return(null==t?void 0:t.renderConfig.previewAttributes)&&(null===(e=t.renderConfig.previewAttributes[0])||void 0===e?void 0:e.mimeType)}}),!0),this.marginCommentsVisible=this.createComputedStore((()=>(0,A.fg)(this.environment,this.props.store))),this.sidePeekWidth=this.createComputedStore((()=>(0,z.vJ)(this.environment)))}UNSAFE_willMount(e){super.UNSAFE_willMount(e),this.isCopyIndicatorWithoutPendingTransaction=(0,E.hq)(e.store)}didMount(){this.isLegacyTransclusionStore.state&&(C.vk(this.environment,{block_type:this.props.store.getType()}),(0,_.XY)("Found a potential legacy transclusion--a block's parent is not its rendered parent!",[["block",this.props.store],["block parent id = ",this.props.store.getParentId()],["rendered parent id = ",this.props.listStore.id]]))}renderComponent(){if(!this.isCopyIndicatorWithoutPendingTransaction||this.renderStateStore.state.type!==a.Ti.copyIndicator)return function(e,t,n){const o=n.state.type;return!!o&&(Boolean(a.Ok[o])||t.isType("column_list")&&(0,B.Po)(t,e)||t.isType("external_object_instance")&&(0,F.Xg)())}(this.environment,this.props.store,this.renderStateStore)?(0,ie.jsx)(te.Z,{isVisible:!0,animationStyle:this.getResizeAnimationStyle(),render:()=>this.renderPreventSidebar()}):this.renderPreventSidebar()}renderBlock(){const{renderItem:e,disabled:t,store:n,disableHoverMenu:o,disableDrag:r,disableCommentMenu:i,numberedListCounterStore:a,bulletedListFormatStore:s}=this.props,l=this.blockRendererStore.state;return!m.Pj(n)&&K.default.checkGate("hide_orphan_blocks")?null:e?e(n):l?(0,ie.jsx)(l,{ref:this.blockRef,store:this.props.store,disabled:t,isFirstItem:this.props.isFirstItem,isLastItem:this.props.isLastItem,blockResizerStore:this.stores.blockResizerStore,disableCommentMenu:i,numberedListCounterStore:a,bulletedListFormatStore:s,disableHoverMenu:o,disableDrag:r,legacyTransclusionParent:this.legacyTransclusionParentStore.state}):void 0}isInColumnList(){return this.context.isInColumnList}canEdit(){return this.canEditStore.state}getResizeAnimationStyle(){const{type:e}=this.renderStateStore.state;if(e&&(0,ne.x)({environment:this.environment,type:e}))return{width:"100%"};const{dragging:t,temporaryWidth:n,temporaryFullWidth:o,temporaryPageWidth:r}=this.stores.blockResizerStore.state,{block_width:i,block_full_width:a,block_page_width:s}=this.props.store.getFormat(),l=t?n:i,c=t?r:s;return{width:(t?o:a)?this.getFullWidth():c?"100%":l}}getFullWidth(){const{device:e}=this.environment,{isInPeekRenderer:t}=this.renderStateStore.state,n=this.environment.WindowSizeStore.state.width,o=(0,z.ll)(this.environment,t)-this.sidePeekWidth.state,r=n-W.Z.state-o;if(i=this.props.store,Boolean(i.inMemoryRecordCache.snapshotData)&&!e.isPhone)return n*(re.rp/100)-re.mD-W.Z.state;if(j.Z.isBlockInTemplate(this.props.store))return n*(X.E2/100)-X.dm-W.Z.state;if(this.isInColumnList()||!me(this.props.store))return"100%";if(t)return G.default.getPeekModeWidth(n)-W.Z.state;if((0,z.Jr)(this.environment)){let n=r;const{state:{shouldShowSidebar:o}}=this.appRenderState;return e.isMobile&&!e.isTablet||!o||(n-=(0,z.Wk)(this.environment)),!this.renderStateStore.state.isInlineCollectionView&&this.marginCommentsVisible.state&&(this.isPageFullWidth.state?n-=A.QB:n-=2*(0,A.gC)(this.environment,t,(0,P.Ks)(this.props.store))),function(e,t,n){const o=n.state.type;return!!o&&(a.GP[o]||t.isType("column_list")&&(0,B.Po)(t,e)&&t.getFormat().block_full_width)}(this.environment,this.props.store,this.renderStateStore)||(n-=2*(0,E.ui)(this.environment)),n}return r;var i}}ue.displayName="ListItemBlock",ue.contextTypes={...r.w,isInColumnList:y().any};const pe=ue;function me(e){return e.isRootOrDirectChild()}const fe="emptyDroppableKey",ge="placeholder";class he extends r.Z{constructor(){super(...arguments),this.renderItem=(e,t,n)=>e===fe?(0,ie.jsx)(o.Fragment,{children:this.renderEmptyDroppable()},e):e===ge?(0,ie.jsx)(o.Fragment,{children:this.props.emptyPlaceholder},e):(0,ie.jsx)(o.Fragment,{children:this.renderChild(e,t,n)},e),this.bulletedListFormatStore=this.createComputedStore((()=>{var e;const t=this.itemKeysStore.state,n=null===(e=this.props.bulletedListFormatStore)||void 0===e?void 0:e.getState().depth,o="number"==typeof n?n+1:0,r=new Map;let i;for(const s of t){const e=be(s,this.props.store);i=e.getType()===a.Ti.bulletedList?e.getFormat().bullet_list_format||i:void 0,i&&r.set(s,i)}return{depth:o,blockIdFormats:r}})),this.numberedListCounterStore=this.createComputedStore((()=>{var e;const t=this.itemKeysStore.state,n=[],o=t.length?t[0]:void 0,r=o?be(o,this.props.store):void 0,i=null==r?void 0:r.getParentId(),s=null===(e=this.props.numberedListCounterStore)||void 0===e?void 0:e.state.numberedListBlockIdsWithFormat.find((e=>e.id===i)),l=null==s?void 0:s.format;let c=void 0===(null==s?void 0:s.depth)?0:(null==s?void 0:s.depth)+1,u=l,p=0;for(const m of t)if(m!==fe&&m!==ge){const e=be(m,this.props.store),t=e.getType(),o=e.getFormat();if(u=(null==o?void 0:o.list_format)??u,t===a.Ti.numberedList){let e=o.list_start_index;(0,d.$K)(e)&&0!==p&&(e=void 0),p=(0,d.$K)(e)?e:p+1,n.push({id:m,format:u,depth:c||0,index:p})}else u=void 0,n.push({id:void 0,format:u,depth:0,index:p}),c=0,p=0}return{depth:c||0,numberedListBlockIdsWithFormat:n}})),this.canEditStore=this.createComputedStore((()=>{const e=(0,m.n3)(this.props.store)&&this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,f.YF)(e)&&this.props.store.canEdit()})),this.itemKeysStore=this.createComputedStore((()=>{const e=this.props.store.getValue()||[];let t=e;const n=function(e){const{limitParents:t}=g.Z.state,n=e.id;let o;return e.findRecordStoreUIAncestor((e=>{const r=t.get(e);return!(!r||!r.hasOwnProperty(n))&&(o=r[n],!0)})),o}(this.props.store),o=this.canEdit(),r=0===e.length;return void 0!==n&&(t=s.tP(t,0,n)),o&&r&&t.push(fe),o&&r&&this.props.emptyPlaceholder&&t.push(ge),t}))}renderComponent(){if(!this.props.disableContent){var e;const t=null===(e=this.context.restrictedContentContext)||void 0===e?void 0:e.state;return t?this.itemKeysStore.state.reduce(((e,n,o,r)=>(t.indexOf(n)>=0&&e.push(this.renderItem(n,o,r)),e)),[]):this.itemKeysStore.state.map(this.renderItem)}}renderChild(e,t,n){const{disabled:o}=this.props,r=be(e,this.props.store),i=s.qr(n,(e=>(0,l.e)(e)));return(0,ie.jsx)(pe,{store:r,renderItem:this.props.renderItem,listStore:this.props.store,isFirstItem:0===t,isLastItem:t===i,disabled:o,disableLayout:this.props.disableLayout,canEditList:this.canEdit(),disableSelection:this.props.disableSelection,disableHoverMenu:this.props.disableHoverMenu,disableCommentMenu:this.props.disableCommentMenu,disableDrag:this.props.disableDrag,numberedListCounterStore:this.numberedListCounterStore,bulletedListFormatStore:this.bulletedListFormatStore})}renderEmptyDroppable(){const e=h.G.createChildStore(this.props.store,{table:c.iU,id:this.props.store.id}),t=this.canEdit();return(0,ie.jsx)(oe.Z,{store:e,canDropBelow:t,canNativeDropBelow:t,onSelectableDrop:e=>function(e,t,n){const{droppedDirection:o,droppedStores:r,duplicate:i}=e;p.createAndCommit({userAction:"List.handleEmptyDrop",environment:n,perform:e=>{u.LQ({environment:n,targetParentStore:t,targetStore:void 0,droppedDirection:o,droppedStores:r,duplicate:i,transaction:e})}})}(e,this.props.store,this.environment),onNativeDrop:e=>function(e,t,n){const{files:o,droppedDirection:r}=e;p.createAndCommit({userAction:"List.handleEmptyNativeDrop",environment:n,perform:e=>{u.uQ({environment:n,files:o,targetParentStore:t,targetStore:void 0,droppedDirection:r,transaction:e})}})}(e,this.props.store,this.environment),style:this.props.emptyDroppableStyle,analyticsName:"page_content",shouldShowDropZone:!0})}canEdit(){return!this.props.disabled&&(!v.n.state&&this.canEditStore.state)}}he.displayName="List",he.contextTypes={...i.J,...r.w};const ve=he;function be(e,t){return h.G.createChildStore(t,{table:c.iU,id:e})}},78454:(e,t,n)=>{n.d(t,{LK:()=>h,R8:()=>v,ZP:()=>I,v2:()=>c});var o=n(67294),r=n(49271),i=n(63143),a=n(89086),s=n(68709),l=n(85893);let c=function(e){return e[e.Start=0]="Start",e[e.Center=1]="Center",e[e.End=2]="End",e}({});const{Start:d,Center:u,End:p}=c,m=o.forwardRef((function(e,t){return(0,l.jsxs)("div",{onClick:e.onClick,onMouseMove:e.onMouseMove,onMouseEnter:e.onMouseEnter,onMouseLeave:e.onMouseLeave,onMouseDown:e.onMouseDown,style:y(e),ref:t,children:[e.left&&f(e),e.children&&(0,l.jsx)("div",{style:k(e),children:e.children}),e.right&&g(e)]})})),f=function(e){return(0,l.jsx)(s.p,{...(0,a.td)("start"),allowSelectionWithin:!1,style:S(e),children:e.left})},g=function(e){return(0,l.jsx)(s.p,{...(0,a.td)("end"),allowSelectionWithin:!1,style:w(e),children:e.right})},h=24,v={...r.ZD,textAlign:"left"},b={[d]:"flex-start",[u]:"center",[p]:"flex-end"},y=function(e){return{display:"flex",alignItems:i.z4(e.alignment)?b[c.Start]:b[e.alignment],width:"100%",...e.style}},_=function(e){const t={display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0};return(e.leftRightMinHeight||i.z4(e.leftRightMinHeight))&&(t.minHeight=`calc(1.5em + ${r.ZD.paddingTop}px + ${r.ZD.paddingTop}px)`),t},S=e=>({marginRight:2,width:h,..._(e),...e.leftStyle}),w=e=>({marginLeft:4,..._(e),...e.rightStyle}),k=e=>({flexGrow:1,flexShrink:1,flexBasis:0,minWidth:1,...e.childrenStyle}),I=m},40148:(e,t,n)=>{n.d(t,{Lw:()=>u,ZP:()=>p});var o=n(67294),r=n(13991),i=n(6740),a=n(86628),s=n(24405),l=n(82990),c=n(77080),d=n(85893);const u={fontSize:12,paddingTop:2,paddingBottom:2};function p(e){window.__c={n:"MediaPlaceholder"};const[t,n]=(0,o.useState)(!1),u=(0,a.VK)((()=>c.default.checkGate("comments_density_image_handling")),[])&&e.isInComment,p=(0,s.yK)((n=>({root:{width:"100%",fontSize:14,fontFamily:l.Z.getCompositeFontFamily(r.SP).sans,color:n.mediumTextColor,borderRadius:4,background:n.embedPlaceholderBackground,position:"relative",...e.style},right:{position:"absolute",top:4,right:4,transition:"opacity 200ms ease-in",opacity:e.shouldHideRight&&!t?0:1},inner:{padding:12,paddingRight:36,display:"flex",alignItems:"center",textAlign:"left",width:"100%",overflow:"hidden",...u?{padding:"8px 10px 10px 8px",paddingRight:10,gap:10}:{}},iconContainer:u?{background:n.tint.regular,height:32,width:32,borderRadius:6,display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0}:{},icon:{width:25,height:25,flexShrink:0,marginRight:12,fill:n.mediumIconColor,...e.iconStyle},children:u?{color:n.text.secondary}:{}})),[e.style,e.shouldHideRight,e.iconStyle,t,u]);return(0,d.jsxs)("div",{style:p.root,onFocus:e=>{const t=e.target;t instanceof HTMLElement&&(0,i.E)(t)&&n(!0)},onBlur:()=>n(!1),children:[(0,d.jsxs)("div",{style:p.inner,children:[(0,d.jsx)("div",{style:p.iconContainer,children:e.iconSvg(p.icon)}),(0,d.jsx)("div",{style:{...l.Z.textOverflowStyle,...p.children},children:e.children})]}),e.right&&(0,d.jsx)("div",{style:p.right,children:e.right})]})}},65085:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(67294),r=n(24405),i=n(42402),a=n(85893);function s(e){window.__c={n:"MultiLineTextOverflow"};const{children:t,maxLines:n,onMore:i,onLess:s}=e,c=(0,o.useRef)(null),d=(0,o.useRef)(null),u=(0,o.useRef)(null),[p,m]=(0,o.useState)(!1),[f,g]=(0,o.useState)(!n),[h,v]=(0,o.useState)(0),[b,y]=(0,o.useState)(0);(0,o.useEffect)((()=>{if(p){var e;const t=null===(e=d.current)||void 0===e?void 0:e.getClientRects()[0];v((null==t?void 0:t.height)??0),y((null==t?void 0:t.width)??0)}}),[p]);const _=(0,o.useCallback)((()=>{c.current&&m(c.current.scrollHeight>c.current.clientHeight)}),[]);(0,o.useEffect)((()=>{!f&&n&&_()}),[f,n,_]),(0,o.useEffect)((()=>{if(u.current){const e=new MutationObserver((()=>{f||_()})),t=new ResizeObserver((()=>{f||_()}));return t.observe(u.current),e.observe(u.current,{childList:!0,subtree:!0}),()=>{t.disconnect(),e.disconnect()}}}),[f,_]);const S=(0,o.useCallback)((e=>{i?i(e):(e.preventDefault(),e.stopPropagation(),g(!0))}),[i]),w=(0,o.useCallback)((e=>{s?s(e):(e.preventDefault(),e.stopPropagation(),g(!1))}),[s]),k=(0,o.useMemo)((()=>(0,a.jsx)(l,{style:{position:"absolute",right:0,bottom:0},onClick:S,children:(0,a.jsx)("div",{ref:d,children:e.moreElement})})),[e.moreElement,S]),I=(0,o.useMemo)((()=>(0,a.jsx)(l,{onClick:w,children:e.lessElement})),[e.lessElement,w]),C=(0,r.yK)((e=>({base:{display:"-webkit-box",WebkitBoxOrient:"vertical",WebkitLineClamp:f?void 0:n},clamped:{WebkitMaskPosition:"right bottom",WebkitMask:`linear-gradient(0deg,transparent 0,transparent ${h}px,#000 ${h}px),\n\t\t\t\t\t\t\t linear-gradient(270deg,transparent 0,transparent ${b}px,#000 ${2*b}px)`}})),[n,f,h,b]);return(0,a.jsxs)("div",{style:{position:"relative"},children:[(0,a.jsxs)("div",{ref:c,style:{...C.base,...p&&!f&&C.clamped,...e.style},children:[(0,a.jsx)("div",{ref:u,children:t}),p&&f&&I]}),p&&!f&&k]})}function l(e){let{onClick:t,style:n,children:o}=e;return(0,a.jsx)(i.Z,{disableUnderline:!0,style:n,onClick:e=>{t(e)},children:o})}},54321:(e,t,n)=>{n.d(t,{Z:()=>S});var o=n(67294),r=n(86628),i=n(24405),a=n(49271),s=n(62965),l=n(9291),c=n(73819),d=n(23864),u=n(55217),p=n(78454),m=n(22491),f=n(99445),g=n(85893);function h(e){const{rank:t,index:n,listFormat:o}=e;if("numbers"===o)return{index:n,listFormat:o};if("letters"===o)return{index:(0,f.yt)(n),listFormat:o};if("roman"===o)return{index:(0,f.bW)(n),listFormat:o};{const e=t%3;return 0===e?{index:n,listFormat:"numbers"}:1===e?{index:(0,f.yt)(n),listFormat:"letters"}:{index:(0,f.bW)(n),listFormat:"roman"}}}const v=function(e){window.__c={n:"NumberedListCounter"};const t=(0,r.VK)((()=>{if(!e.numberedListCounterStore)return h({rank:0,index:1,listFormat:void 0});const t=e.numberedListCounterStore.state.numberedListBlockIdsWithFormat.find((t=>t.id===e.store.id));return h({rank:(null==t?void 0:t.depth)||0,index:(null==t?void 0:t.index)||0,listFormat:null==t?void 0:t.format})}),[e.numberedListCounterStore,e.store.id]);if("roman"===t.listFormat){const e=t.index;return(0,g.jsx)("span",{...(0,m.iv)({pseudoBefore:{content:`"${e}."`},textAlign:"left",width:(0,f.A8)(e),whiteSpace:"nowrap"})})}{const e=t.index.toString().length;let n=24;return 3===e?n=32:4===e?n=42:e>4&&(n="unset"),(0,g.jsx)("span",{...(0,m.iv)({pseudoBefore:{content:`"${t.index}."`},width:n,textAlign:"center",whiteSpace:"nowrap"})})}};var b=n(21407);const y=(0,l.defineMessages)({listPlaceholder:{defaultMessage:"List",id:"numberedListBlock.placeholder.label"}});function _(e,t){window.__c={n:"NumberedListBlock"};const n=(0,l.useIntl)(),s=o.useRef(null),m=(0,r.VK)((()=>e.store.getBlockTitleStore()),[e.store]),f=(0,r.VK)((()=>e.store.getContentStore()),[e.store]),h=(0,c.rv)(e.store),_=(0,i.yK)((()=>({root:{paddingLeft:a.ZD.paddingLeft,...h,...e.style}})),[h,e.style]),S=(0,g.jsxs)(p.ZP,{style:_.root,left:(0,g.jsx)(v,{store:e.store,numberedListCounterStore:e.numberedListCounterStore}),leftStyle:{width:"unset"},childrenStyle:{display:"flex",flexDirection:"column"},ref:s,children:[(0,g.jsxs)("div",{style:{display:"flex"},children:[(0,g.jsx)(b.Z,{style:p.R8,disabled:e.disabled,store:m,placeholder:n.formatMessage(y.listPlaceholder),pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent}),(0,g.jsx)(d.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}),!e.hideContent&&(0,g.jsx)(u.Z,{disabled:e.disabled,store:f,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,numberedListCounterStore:e.numberedListCounterStore})]});return(0,c.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"numbered_list",getNode:()=>s.current,getBlockStore:()=>e.store})),[e.store]),S)}const S=o.memo(o.forwardRef(_),s.Z)},45952:(e,t,n)=>{n.d(t,{Z:()=>v,x:()=>g});var o=n(67294),r=n(480),i=n(86628),a=n(87292),s=n(62965),l=n(9291),c=n(73819),d=n(68859),u=n(33742),p=n(69721),m=n(85893);const f=(0,l.defineMessages)({embedButtonText:{defaultMessage:"Embed PDF",id:"pdfBlock.embeds.button.label"}});function g(e){const{type:t,environment:n}=e;return"pdf"===t&&n.device.isMobile}function h(e,t){window.__c={n:"PDFBlock"};const n=(0,r.O7)(),s=(0,l.useIntl)(),h=(0,o.useRef)(null),v=(0,i.qz)(e.blockResizerStore,d.Z),b=(0,i.VK)((()=>{const t=e.store.getType();return t&&g({environment:n,type:t})}),[n,e.store])?(0,m.jsx)(p.Z,{store:e.store,disabled:e.disabled}):(0,m.jsx)(u.ZP,{...e,blockResizerStore:v,ref:h,store:e.store,iconSvg:a.B,mediaMenuCurrentTab:"file",mediaMenuTabs:[{type:"file",fileUpload:!0},{type:"embed"}],mediaMenuEmbedCaption:(0,m.jsx)(l.FormattedMessage,{defaultMessage:"Embed a PDF file",id:"pdfBlock.embeds.caption"}),embedButtonText:s.formatMessage(f.embedButtonText),urlInputPlaceholder:"https://...",children:(0,m.jsx)(l.FormattedMessage,{defaultMessage:"Embed a PDF",id:"pdfBlock.placeholder"})});return(0,c.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"pdf",getNode:()=>{const e=h.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),b)}const v=o.memo(o.forwardRef(h),s.Z)},53238:(e,t,n)=>{n.d(t,{Z:()=>D});n(67294);var o=n(83355),r=n(480),i=n(8848),a=n(43593),s=n(17755),l=n(59054),c=n(72126),d=n(54642),u=n(31781),p=n(24677),m=n(95477),f=n(24098),g=n(98742),h=n(18514),v=n(77907),b=n(34859),y=n(4926),_=n(24042),S=n(53730),w=n(49085);class k extends w.default{getInitialState(){return{ready:!1,pages:0,renderWidth:0,showPages:0}}}const I=k;var C=n(68785),x=n(53336),T=n(43145),M=n(85893);const P={position:"absolute",top:"calc(50% - 9px)",left:"calc(50% - 9px)",width:18,height:18};class A extends o.Z{constructor(){super(...arguments),this.ReactPDF=void 0,this.storeTypes={store:I},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDocumentLoadSuccess=e=>function(e,t){e&&e._pdfInfo&&t.setState({...t.state,pages:e._pdfInfo.numPages,showPages:1})}(e,this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handlePageRenderSuccess=()=>{var e;(e=this.stores.store).setState({...e.state,ready:!0})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleScrollOffsetChange=e=>function(e,t){e<200&&t.state.ready&&function(e){const{showPages:t,pages:n}=e.state;t<n&&e.setState({...e.state,ready:!1,showPages:t+1})}(t)}(e,this.stores.store),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_updateRenderWidth=()=>{return e=this.props.width,void(t=this.stores.store).setState({...t.state,renderWidth:e});var e,t},this.updateRenderWidthDebounced=c.Ds(this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_updateRenderWidth,1e3)}async UNSAFE_willMount(e){super.UNSAFE_willMount(e),this.stores.store.setState({...this.stores.store.state,renderWidth:e.width}),this.ReactPDF=await v.deps.reactPDF.loader(),this.enqueueForceUpdate()}UNSAFE_willUpdate(e){super.UNSAFE_willUpdate(e),this.updateRenderWidthDebounced()}renderComponent(){if(!this.ReactPDF)return;const{source:e}=this.props,t=this.stores.store.state,{Document:n,Page:o}=this.ReactPDF,r=(0,a.x$)(e)&&!(0,h.Sr)();return(0,M.jsx)(f.Z,{capture:!0,render:i=>(0,M.jsxs)(x.Z,{type:b.Z.All,style:E(this.props.height,this.environment),...(0,g.Z)(i,{onMouseDown:()=>{return e=this.environment,void p.ZH(e);var e}}),children:[e&&(0,M.jsx)(n,{file:e,loading:(0,M.jsx)(C.Z,{style:P}),onLoadSuccess:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleDocumentLoadSuccess,options:{cMapUrl:"/notion-assets/cmaps/",cMapPacked:!0,withCredentials:r},children:c.w6(t.showPages).map((e=>(0,M.jsx)(o,{pageNumber:e+1,width:B(this.stores.store),loading:"",renderAnnotationLayer:!1,renderInteractiveForms:!1,onRenderSuccess:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handlePageRenderSuccess},e+1)))}),(0,M.jsx)(T.Z,{onChange:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleScrollOffsetChange})]})})}}A.displayName="PDFRenderer";function R(e){window.__c={n:"ProxiedPDFRendererWrapper"};const{contentWrapStyle:t,width:n,height:o,blockLocation:i,source:c}=e,p=e.store.pointer,f=(0,r.O7)(),[{value:g}]=(0,l.r5)((async()=>{if(await S.transactionQueue.awaitRecordTransaction(p),(0,a.E$)(c,[m.default.secureFileS3.url,m.default.secureFileS3V2.url])){const e=f.device;return await d.getSignedFileUrl(f,{url:c,permissionRecord:p,useS3Url:e.isIOS&&e.isMobileNative},Boolean(_.Z.state.isNotionProtocolBugFixed))}return(0,s.EK)({url:c,permissionRecord:p,baseUrl:m.default.domainBaseUrl,fullyQualified:!1,userId:f.currentUser.id})}),[f,p,c]);return(0,M.jsx)("div",{style:t,children:(0,M.jsx)(A,{source:g,width:n||500,height:o||(u.qC(i)?240:500)})})}const D={render:e=>(0,M.jsx)(R,{...e}),embedGhost:!0,resizable:!0};function E(e,t){const{device:n}=t;return{position:"relative",height:e,maxHeight:n.isMobile?"75vh":void 0,background:i.ZP.uiExtraLightGray,paddingTop:8,paddingBottom:8,paddingLeft:16,paddingRight:16,overflow:"visible"}}function B(e){const t=e.state;return Math.min(window.innerWidth,t.renderWidth)-32-y.Z.state}},24813:(e,t,n)=>{n.d(t,{Z:()=>E});n(67294);var o=n(83355),r=n(480),i=n(97511),a=n(86628),s=n(24405),l=n(15145),c=n(49271),d=n(39567),u=n(44805),p=n(82990),m=n(9291),f=n(3297),g=n(9953),h=n(82530),v=n(28651),b=n(84210),y=n(98165),_=n(46654),S=n(4023),w=n(77080),k=n(88923),I=n(13966),C=n(84076),x=n(31278),T=n(76798),M=n(26388),P=n(78454),A=n(85893);const R={paddingTop:c.ZD.paddingTop,paddingBottom:c.ZD.paddingBottom,paddingLeft:c.ZD.paddingLeft};class D extends o.Z{constructor(){super(...arguments),this.storeTypes={mouseStore:v.Z},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_onMouseMove=()=>{var e;(e=this.stores.mouseStore).setState({...e.state,mouseEntered:!0})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_onMouseLeave=()=>{var e;(e=this.stores.mouseStore).setState({...e.state,mouseEntered:!1})}}didMount(){const{RouterStore:e,currentUser:t}=this.environment,{route:n}=e.state;"page"===n.name&&n.shouldDuplicate&&f.nM({currentUserId:null==t?void 0:t.id,blockId:n.blockId})}renderComponent(){const{store:e,onClick:t}=this.props,n=(0,b.Hu)({store:e,fullyQualified:!1,pageVisitSource:l.tY.LinkInPage}),o=(0,b.Hu)({store:this.props.store,openInSidePeek:!0,fullyQualified:!1,pageVisitSource:l.tY.PeekOpen}),r=w.default.checkGate("enable_deleted_page_indicator"),i=y.wf(e),a=r&&i;return(0,A.jsx)(C.Z,{href:n,altHref:o,forceAltHref:k.default.isSidePeekOpen(),external:!1,onClick:t,style:{borderRadius:4,...this.props.style},children:(0,A.jsx)(P.ZP,{childrenStyle:R,alignment:S.v.Center,right:(0,A.jsx)(Z,{aliasStore:this.props.aliasStore,disabled:this.props.disabled,store:this.props.store,mouseStore:this.stores.mouseStore}),onMouseMove:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_onMouseMove,onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_onMouseLeave,children:(0,A.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,A.jsx)(U,{store:this.props.store,disabled:this.props.disabled,isAlias:this.props.isAlias,showDeletedPageIndicator:a}),(0,A.jsx)(T.Z,{store:e,style:F(this.theme,a,this.props.disableUnderline)})]})})})}}D.displayName="Page";const E=D;function B(e){let{isAlias:t}=e;return t?(0,A.jsx)("div",{children:(0,d.Y)({position:"absolute",width:"50%",height:"50%",right:0,bottom:0})}):null}function F(e,t,n){return{fontWeight:p.Z.fontWeight.medium,lineHeight:1.3,borderBottom:n?"none":`1px solid ${e.darkDividerColor}`,...t&&{color:e.mediumTextColor}}}function O(e,t,n){const o=n&&n.publicEditModeStore.state;return!(0,_.YF)(o)&&(e.canEdit()&&!t)}function Z(e){let{aliasStore:t,store:n,disabled:o,mouseStore:s}=e;window.__c={n:"ActionButtonComponent"};const l=(0,i.l)(),c=(0,r.O7)(),{device:d}=c;return(0,a.VK)((()=>O(n,o,l)&&(s.state.mouseEntered||d.isMobile)),[d.isMobile,o,s,l,n])?(0,A.jsx)(I.Z,{store:t??n,tooltipContent:(0,A.jsx)(m.FormattedMessage,{defaultMessage:"Rename, delete, and more…",id:"page.blockActionMenu.tooltip"}),style:{marginRight:4},fadeIn:!0}):(0,A.jsx)("div",{style:{width:28}})}function V(e){let{store:t,disabled:n}=e;window.__c={n:"IconComponent"};const o=(0,i.l)(),s=(0,r.O7)(),l=(0,a.VK)((()=>t.getIcon()),[t]),c=(0,a.VK)((()=>t.getRole()),[t]),d=(0,a.VK)((()=>t.isEmptyPage()),[t]),u=(0,a.VK)((()=>t.getType()),[t]),p=(0,a.VK)((()=>O(t,n,o)),[n,o,t]);return(0,A.jsx)(M.ZP,{renderTooltip:()=>(0,A.jsx)(m.FormattedMessage,{defaultMessage:"Change icon",id:"page.changeIcon.tooltip"}),placement:S.u.Top,disableTooltip:n||!p,render:e=>n||!p?(0,A.jsx)(x.Z,{disabled:!0,icon:l,isEmptyPage:d,role:c,size:22,style:{width:"100%",height:"100%"},...e,largeIcon:!0}):(0,A.jsx)(x.Z,{disabled:!1,bucket:"secure",store:t,icon:l,role:c,isEmptyPage:d,size:22,style:{width:"100%",height:"100%"},iconLoggingData:{recordTable:t.table,source:"subpage",block_type:u},onChange:e=>function(e,t,n){const o=t.getIconStore();o&&h.createAndCommit({userAction:"Page.handleRecordIconChange",environment:n,perform:t=>{g.sO({store:o,value:e,transaction:t})}})}(e,t,s),...e,largeIcon:!0})})}function U(e){let{showDeletedPageIndicator:t,store:n,disabled:o,isAlias:i}=e;window.__c={n:"IconWithArrowComponent"};const a=(0,s.Fg)(),l=(0,r.O7)();if(t){const e=l.device.isSafari||l.device.isIOS;return(0,u.tr)({isSafariOrIOS:e,theme:a})}return(0,A.jsxs)("div",{style:{position:"relative",width:24,height:24,marginRight:4},children:[(0,A.jsx)(V,{store:n,disabled:o}),(0,A.jsx)(B,{isAlias:i})]})}},4382:(e,t,n)=>{n.d(t,{Z:()=>M});var o=n(67294),r=n(73935),i=n(480),a=n(86628),s=n(15145),l=n(62965),c=n(26189),d=n(66324),u=n(75754),p=n(993),m=n(32741),f=n(66213),g=n(14976),h=n(35683),v=n(84210),b=n(73819),y=n(77080),_=n(46735),S=n(22294),w=n(72014),k=n(88923),I=n(68709),C=n(24813),x=n(85893);function T(e,t){window.__c={n:"PageBlock"};const n=(0,i.O7)(),l=(0,o.useContext)(f.ZO),T=(0,o.useRef)(null),M=(0,o.useRef)(null),P=(0,b.PE)(e.store,e.disabled),A=(0,b.rv)(e.store),R=(0,o.useCallback)((()=>{d.Se(n),c.SK(n,{page_visit_id:w.$g.getCurrentPageVisitId(),mentioned_page_id:e.store.id,source_type:"page_block",hover_preview_enabled:y.default.checkGate("first_party_links"),is_navigable_block:e.store.isNavigableBlock()}),_.Z.recordVisit({id:e.store.id,systemBlockType:e.store.getSystemBlockTypeStore().getValue(),type:h.vu.Link,currentUserId:n.currentUser.id})}),[n,e.store]),D=(0,o.useCallback)((()=>{if(!M||!M.current)return;const t=r.findDOMNode(M.current);return(0,g.We)(e.store,t)}),[e.store]),E=(0,o.useCallback)((t=>{const o=D(),r=e.store.getTitleStore();r&&o&&p.Nh({environment:n,event:t,interactiveToken:o,store:r,canEdit:P})}),[P,n,D,e.store]),B=(0,o.useCallback)((t=>{const o=D(),r=e.store.getTitleStore();r&&o&&p.Zl({environment:n,event:t,interactiveToken:o,store:r,canEdit:P})}),[P,n,D,e.store]),F=(0,o.useCallback)((()=>{if(l){const t=(0,v.ZP)({store:e.store,pageVisitSource:s.tY.Create});l(t)}else u._({environment:n,store:e.store,visitType:h.vu.Link,openInSidePeek:k.default.isSidePeekOpen(),pageVisitSource:s.tY.Create})}),[n,l,e.store]);(0,o.useEffect)((()=>()=>{m.qA(e.store.getTitleStore())}),[e.store]);const O=(0,a.VK)((()=>e.store.recordStoreParentDiffersFromPersistedParent()),[e.store]);return(0,b.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"page",getNode:()=>T.current,getBlockStore:()=>e.store,activate:F,handleCreated(){F(),S.Z.setKeyboardMode(!1)}})),[F,e.store]),(0,x.jsx)(I.p,{allowSelectionWithin:!1,onMouseOver:E,onMouseOut:B,ref:T,children:(0,x.jsx)(C.Z,{ref:M,store:e.store,style:{...A,...e.style},isAlias:O,disabled:e.disabled,onClick:R})}))}const M=o.memo(o.forwardRef(T),l.Z)},35541:(e,t,n)=>{n.d(t,{u:()=>P});n(67294);var o=n(480),r=n(86628),i=n(24405),a=n(41892),s=n(70203),l=n(97880),c=n(54851),d=n(21914),u=n(7825),p=n(38376),m=n(51077),f=n(12981),g=n(36596),h=n(65453),v=n(54321),b=n(4382),y=n(16472),_=n(99571),S=n(51704),w=n(17970),k=n(11620),I=n(4859),C=n(25157),x=n(91497),T=n(85893);let M;function P(e){const t=e.getType();if(t){if(!M){const e={text:w.Z,page:b.Z,collection_view_page:c.Z,bulleted_list:u.Z,numbered_list:v.Z,toggle:I.ZP,quote:y.ZP,to_do:k.Z,header:h.Z,sub_header:_.Z,sub_sub_header:S.Z,callout:p.Z,transclusion_container:C.Z,transclusion_reference:x.Z,alias:d.Z},t=(0,l.Yd)({abstract:!0,audio:!0,code:!0,codepen:!0,deepnote:!0,drive:!0,equation:!0,excalidraw:!0,figma:!0,file:!0,framer:!0,gist:!0,hex:!0,invision:!0,loom:!0,maps:!0,miro:!0,mixpanel:!0,pdf:!0,replit:!0,sketch:!0,tweet:!0,typeform:!0,video:!0,whimsical:!0}),n=Object.keys(t).reduce(((e,t)=>(e[t]=A,e)),{});M={...e,...n,...{collection_view:R,table:R},copy_indicator:void 0,personal_home_page:void 0,button:void 0,image:void 0,link_to_page:void 0,link_to_collection:void 0,table_row:void 0,external_object_instance_page:void 0,external_object_instance:void 0,bookmark:void 0,table_of_contents:void 0,tab:void 0,column_list:void 0,column:void 0,embed:void 0,drawing:void 0,divider:void 0,breadcrumb:void 0,factory:void 0,ai_block:void 0}}return M[t]}}const A=e=>{let{store:t}=e;window.__c={n:"MultiMediaAndIntegrationPreview"};const[n,o]=(0,r.VK)((()=>{var e;const n=t.getType(),o=null===(e=t.getTitleStore())||void 0===e?void 0:e.getValue();return[n,s.QaF(o)]}),[t]),l=(0,i.yK)((e=>({card:{display:"flex",padding:10,borderRadius:6,boxShadow:e.inputBoxShadow,marginBottom:6,gap:10},shimmer:{backgroundColor:e.largeShimmerColor,width:150,borderRadius:6}})),[]),c=function(e){const t=e&&D[e];if("string"==typeof t)return t;return a.Z.images.icons.unknownTypePng}(n);return(0,T.jsxs)("div",{style:l.card,children:[(0,T.jsx)(m.Z,{type:"image_url",imageURL:c,size:25,imageStyle:{marginLeft:4,marginRight:4}}),o.length>0?(0,T.jsx)("span",{children:o}):(0,T.jsx)(g.Z,{emphasized:!0,style:l.shimmer})]})},R=e=>{let{store:t}=e;window.__c={n:"InlineCollectionOrTable"};const n=(0,o.O7)(),s="collection_view"===(0,r.VK)((()=>t.getType()),[t]),l=(0,i.yK)((e=>({image:{width:"100%",borderRadius:4,border:`1px solid ${e.lightDividerColor}`},container:{marginBottom:6}})),[]),c=(0,r.VK)((()=>"dark"===n.ThemeStore.state.mode),[n.ThemeStore]),d=c?a.Z.images.blockRendererCovers.collectionTableDarkPng:a.Z.images.blockRendererCovers.collectionTableLightPng,u=c?a.Z.images.blockRendererCovers.plainTableDarkPng:a.Z.images.blockRendererCovers.plainTableLightPng;return(0,T.jsx)("div",{style:l.container,children:(0,T.jsx)(f.Z,{src:s?d:u,style:l.image})})};const D={equation:a.Z.images.blocks.texPng,audio:a.Z.images.blocks.audioPng,file:a.Z.images.blocks.filePng,pdf:a.Z.images.blocks.pdfPng,code:a.Z.images.blocks.codePng,video:a.Z.images.blocks.videoPng,abstract:a.Z.images.blocks.abstractPng,codepen:a.Z.images.blocks.codepenPng,deepnote:a.Z.images.blocks.deepnotePng,drive:a.Z.images.blocks.drivePng,excalidraw:a.Z.images.blocks.excalidrawPng,figma:a.Z.images.externalIntegrations.figmaIconPng,framer:a.Z.images.blocks.framerPng,gist:a.Z.images.blocks.githubPng,hex:a.Z.images.blocks.hexPng,invision:a.Z.images.blocks.invisionPng,loom:a.Z.images.blocks.loomPng,maps:a.Z.images.blocks.mapsPng,miro:a.Z.images.blocks.miroPng,mixpanel:a.Z.images.blocks.mixpanelPng,replit:a.Z.images.blocks.replitPng,sketch:a.Z.images.blocks.sketchPng,typeform:a.Z.images.blocks.typeformPng,tweet:a.Z.images.blocks.twitterPng,whimsical:a.Z.images.blocks.whimsicalPng}},32469:(e,t,n)=>{n.d(t,{Z:()=>c});n(67294);var o=n(8848),r=n(90199),i=n(82990),a=n(9291),s=n(26388),l=n(85893);const c=function(e){let{style:t}=e;return(0,l.jsx)(s.ZP,{renderTooltip:()=>(0,l.jsx)(a.FormattedMessage,{defaultMessage:"Only you can see this page",id:"privatePageBadge.tooltip"}),render:e=>(0,l.jsx)("div",{style:{display:"flex",alignItems:"flex-start",...t||{}},...e,children:(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,l.jsx)("div",{style:{flexShrink:0,marginTop:-1,marginRight:4,fill:o.ZP.red},children:(0,r.b)({width:12})}),(0,l.jsx)("span",{style:{fontSize:12,fontWeight:i.Z.fontWeight.semibold,color:o.ZP.red},children:(0,l.jsx)(a.FormattedMessage,{defaultMessage:"Private",id:"privatePageBadge.label"})})]})})})}},16472:(e,t,n)=>{n.d(t,{NE:()=>v,ZP:()=>_,nr:()=>b});var o=n(67294),r=n(86628),i=n(24405),a=n(49271),s=n(62965),l=n(9291),c=n(33929),d=n(73819),u=n(23864),p=n(4029),m=n(55217),f=n(21407),g=n(85893);const h=(0,l.defineMessages)({emptyPlaceholder:{defaultMessage:"Empty quote",id:"quoteBlock.emptyQuote.placeholder"}}),v=3,b=14;function y(e,t){let{disabled:n,disableCommentMenu:s,disableDrag:l,disableHoverMenu:y,hideContent:_,store:S,style:w}=e;window.__c={n:"QuoteBlock"};const k=(0,o.useRef)(null),I=(0,d.rv)(S),C=(0,r.VK)((()=>{var e;return null===(e=S.getFormat())||void 0===e?void 0:e.quote_size}),[S]),x=(0,r.VK)((()=>S.getBlockTitleStore()),[S]),T=(0,r.VK)((()=>S.getContentStore()),[S]),M=(0,i.yK)((()=>({root:{margin:0,fontSize:"large"===C?"1.2em":"1em",...a.ZD,...I,display:"flex",...w},padding:{paddingLeft:a.ZD.paddingLeft,paddingRight:a.ZD.paddingRight},innerStyle:{borderLeft:`${v}px solid currentColor`,paddingLeft:b,paddingRight:b,width:"100%"}})),[I,C,w]),{blockInsetRight:P}=(0,o.useContext)(p.a),A=(0,g.jsxs)("blockquote",{style:M.root,ref:k,children:[(0,g.jsxs)("div",{style:M.innerStyle,children:[(0,g.jsx)(f.Z,{style:M.padding,placeholderStyle:{left:b,width:"auto",right:b},disabled:n,store:x,placeholder:c.default.formatMessage(h.emptyPlaceholder),pasteBehavior:"block"}),!_&&(0,g.jsx)(p.a.Provider,{value:{blockInsetRight:P+b},children:(0,g.jsx)(m.Z,{disabled:n,store:T,disableCommentMenu:s,disableHoverMenu:y,disableDrag:l})})]}),(0,g.jsx)(u.Z,{disableCommentMenu:s,hideContent:_,store:S})]});return(0,d.ez)(S,t,(0,o.useMemo)((()=>({renderedType:"quote",getNode:()=>k.current,getBlockStore:()=>S})),[S]),A)}const _=o.memo(o.forwardRef(y),s.Z)},79954:(e,t,n)=>{n.d(t,{Z:()=>q});var o=n(67294),r=n(83355),i=n(480),a=n(24405),s=n(14577),l=n(8848),c=n(63143),d=n(51454),u=n(6404),p=n(42239),m=n(99553),f=n(52989),g=n(24677),h=n(82530),v=n(10906),b=n(11368),y=n(84064),_=n(43250),S=n(12534),w=n(98742),k=n(39500),I=n(45162),C=n(73959),x=n(89224),T=n(89086),M=n(95802),P=n(55367),A=n(10084),R=n(80796),D=n(20144),E=n(69784),B=n(49085);class F extends B.default{getInitialState(){return{shouldShowSelectionHalo:!1,shouldShowDropParentHalo:!1,shouldShowDropZone:!1,shouldShowDropZoneHint:!1,forceRenderSelectionHalo:!1,showActionIsInFlight:!1}}}const O=F;var Z=n(27724),V=n(24666),U=n(23063),N=n(6685),L=n(85893);const j=4;class z extends r.Z{constructor(){super(...arguments),this.lastDropZoneHintIndex=void 0,this.selectableDivRef=o.createRef(),this.storeTypes={draggableStore:A.Z,selectableStore:O},this.computedStore=this.createComputedStore((()=>{const e=function(e){const t=P.ZP.state;if(!t.isDragging)return;const{currentHintDropZones:n}=t;if(n)return n.findIndex((t=>t.type===P.Dl.Selectable&&t.store===e))}(this.props.store);!c.z4(e)&&e>=0&&(this.lastDropZoneHintIndex=e);const t=function(e,t,n){const{device:o}=t;if(!n||!(0,C.Mn)(o))return!1;if(Y.state!==Z.SelectionPhase.Selected)return!1;const{stores:r}=Z.default.state;if(r.indexOf(e)>=0&&!P.ZP.state.isDragging)return!0;return!1}(this.props.store,this.environment,this.props.shouldShowHalo),n=function(e,t){if(!t)return!1;const n=P.ZP.state;if(!n.isDragging)return!1;const{currentParentStore:o,currentHintDropZones:r,currentDropZone:i}=n;if(i&&i.type===P.Dl.DropTarget)return!1;return r.some((e=>e.direction===P.vh.Left||e.direction===P.vh.Right))?Boolean(i&&i.store===e):o===e}(this.props.store,Boolean(this.props.shouldShowHalo)),o=function(e,t){const n=P.ZP.state;if(!n.isDragging)return;const{currentDropZone:o}=n;if(o&&o.type===P.Dl.Selectable&&o.store===e&&t)return o.direction}(this.props.store,Boolean(this.props.shouldShowDropZone)),r=function(e,t){const n=P.ZP.state;if(!n.isDragging)return;const{currentHintDropZones:o}=n;if(o&&t){const t=o.find((t=>t.type===P.Dl.Selectable&&t.store===e));if(t)return t.direction}}(this.props.store,Boolean(this.props.shouldShowDropZone)),i=this.lastDropZoneHintIndex,a=this.stores.draggableStore.state.dragging,s=this.stores.draggableStore.hasDragged(),l=this.stores.draggableStore.state.initiator,d=this.stores.selectableStore.state,u=this.props.store.getType()||"unknown";return{isDragging:a,initiator:l,hasDragged:s,shouldShowSelectionHalo:t||d.forceRenderSelectionHalo||Boolean(this.props.shouldForceRenderSelectionHalo),shouldShowDropParentHalo:n,currentDropZone:o,dropZoneHint:r,dropZoneHintIndex:i,shouldRenderSelectionHalo:t||d.shouldShowSelectionHalo||d.forceRenderSelectionHalo||Boolean(this.props.shouldForceRenderSelectionHalo),shouldRenderDropParentHalo:n||d.shouldShowDropParentHalo,shouldRenderDropZoneHint:!c.z4(r)||d.shouldShowDropZoneHint,shouldRenderDropZone:!c.z4(o)||d.shouldShowDropZone,propStoreType:u,showActionIsInFlight:d.showActionIsInFlight}}))}get registries(){return[M.C]}getNode(){return this.props.nodeRef?this.props.nodeRef.current:this.selectableDivRef.current}getContextClosestSelectable(){var e;return null===(e=this.context.selectable)||void 0===e?void 0:e.closestSelectable}getContextSelectableContainer(){var e;return null===(e=this.context.selectable)||void 0===e?void 0:e.selectableContainer}getContextVerticalScroller(){var e;return null===(e=this.context.scrollerContext)||void 0===e?void 0:e.verticalScroller}getContextHorizontalScroller(){var e;return null===(e=this.context.scrollerContext)||void 0===e?void 0:e.horizontalScroller}renderComponent(){var e;const{isDragging:t,initiator:n,hasDragged:o,shouldShowDropParentHalo:r,shouldShowSelectionHalo:i,currentDropZone:a,dropZoneHint:s,dropZoneHintIndex:l,shouldRenderSelectionHalo:c,shouldRenderDropParentHalo:d,shouldRenderDropZoneHint:p,shouldRenderDropZone:f,propStoreType:b,showActionIsInFlight:M}=this.computedStore.state,P=c||d||p||f,A=`${_.euV} notion-${b}-block`,R=this.renderDraggable((e=>(0,L.jsxs)("div",{ref:this.selectableDivRef,style:X({isPositionRelative:P,isDragging:t,hasDragged:o,initiator:n,showActionIsInFlight:M},this.theme,this.props.canDrag,this.props.style),"data-block-id":this.props.store.id,className:this.props.className?`${A} ${this.props.className}`:A,...(0,w.Z)(e||{},{onDoubleClick:e=>function(e,t,n){t||(0,S.ZP)({event:e,context:S.Af.EditorDoubleClick,callback:()=>{n&&n(e)}})}(e,this.props.canSelect,this.props.onDoubleClick),onContextMenu:e=>function(e,t,n,o,r,i,a){const{device:s}=n;if(s.isAndroid){const n=V.default.state,o=(0,C.mh)(t),r=o&&"empty"!==n.mode&&(0,I.r)(n.multiSelection,o);if("editing"!==n.mode||!r)return x.isExpanded(x.get())||e.preventDefault(),e.stopPropagation(),!1}if(o){const o=(0,v.fm)(t);(0,S.ZP)({event:e,context:S.Af.EditorContextMenu,callback:()=>{e.preventDefault(),g.Ys({environment:n,store:t}),u.Qn({environment:n,stores:r||Z.default.state.stores,left:e.clientX,top:e.clientY,actionSectionGroupKey:i||"default",showInput:Boolean(a),analyticsFrom:"content_block_menu",optionalAnalyticsProperties:{collectionContextStore:o}})}})}}(e,this.props.store,this.environment,this.props.canTriggerContextMenu,this.props.contextMenuAndDragStores,this.props.actionSectionGroupKey,this.props.showBlockMenuInput),onMouseOver:e=>function(e,t,n){n&&(0,S.ZP)({event:e,context:S.Af.EditorMouseOver,callback:()=>{D.Z.setState({...D.Z.state,hoveredStore:t,lastHoveredStore:t})}})}(e,this.props.store,this.props.canSelect),onMouseOut:()=>{return e=this.props.store,void(D.Z.state.hoveredStore===e&&D.Z.setState({...D.Z.state,hoveredStore:void 0}));var e},onClick:e=>function(e,t,n,o,r,i){(0,S.ZP)({event:e,context:S.Af.EditorClick,callback:()=>{var a;if(null!==(a=Z.default.getDefaultContainerFromTarget(e.target))&&void 0!==a&&a.isPeekRenderer()||m.E5(n),(0,C.Mn)(n.device))k.X9()||!o||t.isInlineCollectionView()||g.Ys({environment:n,store:t,toggle:g.ji(n),selectBetween:g.OS()});else if(r){const t=(0,T.Rb)(e.target);t&&h.createAndCommit({userAction:"Selectable.handleClick",environment:n,perform:e=>{r({isAtStartOfLine:"start"===t,isClick:!0,transaction:e})}})}i&&i(e)}})}(e,this.props.store,this.environment,this.props.canSelect,this.props.onEditText,this.props.onClick),onMouseMove:this.props.onMouseMove,onMouseDown:this.props.onMouseDown,onMouseEnter:this.props.onMouseEnter,onMouseLeave:this.props.onMouseLeave}),children:[this.props.children,c&&(0,L.jsx)(H,{selectableStore:this.stores.selectableStore,style:this.props.haloStyle,isVisible:i}),d&&(0,L.jsx)(W,{selectableStore:this.stores.selectableStore,isVisible:r}),p&&(0,L.jsx)(Q,{selectableStore:this.stores.selectableStore,direction:s,index:l,aboveDropZoneMargin:this.props.aboveDropZoneMargin,belowDropZoneMargin:this.props.belowDropZoneMargin,dropzoneGap:this.props.dropzoneGap}),f&&(0,L.jsx)($,{selectableStore:this.stores.selectableStore,direction:a,aboveDropZoneMargin:this.props.aboveDropZoneMargin,belowDropZoneMargin:this.props.belowDropZoneMargin,dropzoneGap:this.props.dropzoneGap})]})));return(0,L.jsx)(y.ld,{value:{selectableContainer:null===(e=this.context.selectable)||void 0===e?void 0:e.selectableContainer,closestSelectable:this},children:R})}displaySelectionHalo(e){this.stores.selectableStore.state.forceRenderSelectionHalo||(this.stores.selectableStore.update((e=>({...e,forceRenderSelectionHalo:!0}))),window.setTimeout((()=>{this.stores.selectableStore.update((e=>({...e,forceRenderSelectionHalo:!1})))}),e))}renderDraggable(e){const{device:t}=this.environment;return(0,L.jsx)(N.Z,{draggableStore:this.stores.draggableStore,forceTouch:t.isMobile&&!this.props.disableForceTouch,touchDragOnly:this.props.touchDragOnly,onDraggableDragStart:e=>function(e,t,n,o){const{mobileNative:r}=t;n&&(e.preventDefault(),r&&r.buzz());o&&o(e)}(e,this.environment,this.props.canDrag,this.props.onDraggableDragStart),onDraggableDragMove:e=>function(e,t,n,o,r,i,a,s,l){const{device:c}=n;o&&!r?P.ZP.state.isDragging?p.td(n,{currentX:e.currentX,currentY:e.currentY}):k.X9()&&(g.Ys({environment:n,store:t,toggle:g.ji(n),selectBetween:g.OS()}),p.f$(n,{startX:e.startX,startY:e.startY,stores:i||Z.default.state.stores,isNativeDrag:!1,getGhostElement:a})):E.default.state.isActive||c.isPhone||f.AI({environment:n,target:e.target,startX:e.startX,startY:e.startY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!s});l&&l(e)}(e,this.props.store,this.environment,this.props.canDrag,this.props.preventBackgroundDrag,this.props.contextMenuAndDragStores,this.props.getGhostElement,this.props.disableScrollToRevealHorizontal,this.props.onDraggableDragMove),onDraggableDragEnd:e=>function(e,t,n,o,r){const{device:i}=n;i.isMobile&&R.Z.state.isDragging&&e.preventDefault();o&&P.ZP.state.isDragging&&p.fX({environment:n,shiftKey:e.shiftKey,optionKey:e.optionKey,commandKey:e.commandKey,analyticsFrom:t});r&&r(e)}(e,this.props.analyticsName,this.environment,this.props.canDrag,this.props.onDraggableDragEnd),onDraggableDragCancel:e=>function(e,t,n,o){n&&P.ZP.state.isDragging&&(p.cQ(t),g.ZH(t));o&&o(e)}(e,this.environment,this.props.canDrag,this.props.onDraggableDragCancel),disableHorizontalEdgeScroll:this.props.disableHorizontalDragEdgeScroll,render:e})}}z.displayName="Selectable",z.contextTypes={...b.I3,...y.Tf,...r.w};const q=z;function H(e){return(0,L.jsx)(U.Z,{isVisible:e.isVisible,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},onAnimationStart:()=>{e.selectableStore.setState({...e.selectableStore.state,shouldShowSelectionHalo:!0})},onAnimationEnd:()=>{e.isVisible||e.selectableStore.setState({...e.selectableStore.state,shouldShowSelectionHalo:!1})},render:()=>(0,L.jsx)("div",{className:_.No6,style:{position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,background:l.ZP.blueWithAlpha(.14),zIndex:d.py,borderRadius:4,...e.style}})},"halo")}function W(e){return(0,L.jsx)(U.Z,{isVisible:e.isVisible,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},onAnimationStart:()=>{e.selectableStore.setState({...e.selectableStore.state,shouldShowDropParentHalo:!0})},onAnimationEnd:()=>{e.isVisible||e.selectableStore.setState({...e.selectableStore.state,shouldShowDropParentHalo:!1})},render:()=>(0,L.jsx)("div",{className:_.No6,style:{position:"absolute",pointerEvents:"none",top:0,left:0,right:0,bottom:0,background:l.ZP.blueWithAlpha(.07),borderRadius:4}})},"parent")}function K(e,t,n){if(void 0===n)return{};const o=e.isMobile?3:2;return n===P.vh.Above||n===P.vh.Below?{position:"relative",left:-o,width:o,height:j,background:t.contentBackground,transform:"translateZ(100px)"}:{position:"relative",top:-o,width:j,height:o,background:t.contentBackground,transform:"translateZ(100px)"}}function G(e,t,n,o,r){const i={position:"absolute",pointerEvents:"none",background:l.ZP.blueWithAlpha(.43),zIndex:d.S1-t};if(e===P.vh.Onto)i.left=0,i.top=0,i.right=0,i.bottom=0,i.background=l.ZP.blueWithAlpha(.14);else if(e===P.vh.Above||e===P.vh.Below){const t=4;i.left=0,i.right=0,e===P.vh.Above?(i.top=-t,n&&(i.top-=n)):(i.bottom=-t,o&&(i.bottom-=o)),i.height=j}else{const t=8;i.top=0,i.bottom=0,e===P.vh.Left?i.left=r?-r:-t:i.right=r?-r:-t,i.width=j}return i}function $(e){window.__c={n:"SelectableCurrentDropZone"};const t=(0,i.Fy)(),n=(0,a.Fg)(),o=void 0!==e.direction;return(0,L.jsx)(U.Z,{isVisible:o,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},onAnimationStart:()=>{e.selectableStore.setState({...e.selectableStore.state,shouldShowDropZone:!0})},onAnimationEnd:()=>{o||e.selectableStore.setState({...e.selectableStore.state,shouldShowDropZone:!1})},render:()=>(0,L.jsx)("div",{style:G(e.direction,0,e.aboveDropZoneMargin,e.belowDropZoneMargin,e.dropzoneGap),children:e.direction!==P.vh.Onto&&(0,L.jsx)("div",{style:K(t,n,e.direction)})})},"dropZone")}function Q(e){window.__c={n:"SelectableDropZoneHint"};const t=(0,i.Fy)(),n=(0,a.Fg)(),o=!c.z4(e.direction);return(0,L.jsx)(U.Z,{isVisible:o,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},onAnimationStart:()=>{e.selectableStore.setState({...e.selectableStore.state,shouldShowDropZoneHint:!0})},onAnimationEnd:()=>{o||e.selectableStore.setState({...e.selectableStore.state,shouldShowDropZoneHint:!1})},render:()=>(0,L.jsx)("div",{style:G(e.direction,(e.index||0)+1,e.aboveDropZoneMargin,e.belowDropZoneMargin,e.dropzoneGap),children:(0,L.jsx)("div",{style:K(t,n,e.direction)})})},"hint")}const Y=new s.Z((()=>Z.default.state.phase),{debugName:"SelectionPhaseStore"});function X(e,t,n,o){const{isPositionRelative:r,isDragging:i,hasDragged:a,showActionIsInFlight:s,initiator:l}=e,c={};return"touch"===l&&(c.transition="transform 200ms ease-out",n&&i&&!a&&(c.boxShadow=t.mediumBoxShadow,c.transform="scale(1.05)",c.borderRadius=3)),r&&(c.position="relative"),s&&(c.opacity=.5),{...c,...o}}},23189:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(24405),r=n(8848),i=n(82990),a=n(85893);const s=function(e){window.__c={n:"SettingHeader"};const t=(0,o.Fg)(),{divider:n,large:s,block:l,children:c,hasMarginTop:d,small:u,style:p,smallMarginBottom:m,isCritical:f}=e,g="full"===n;return(0,a.jsx)("div",{style:{borderBottom:g?`1px solid ${t.regularDividerColor}`:0,marginBottom:g?16:m?2:8,marginTop:d?16:0,paddingBottom:g?12:0,fontSize:g?16:s?14:u?12:14,fontWeight:g?i.Z.fontWeight.medium:400,width:l?"100%":"auto",color:f?r.ZP.red:t.regularTextColor,...p},children:c})}},13490:(e,t,n)=>{n.d(t,{Z:()=>i});n(67294);var o=n(24405),r=n(85893);const i=function(e){window.__c={n:"SettingLabel"};const t=(0,o.yK)((t=>{const{hasMarginTop:n}=e,o={display:"block",marginBottom:4,fontSize:12,color:t.mediumTextColor};return n&&(o.marginTop=14),{style:o}}),[e]),{forId:n,children:i,style:a}=e;return(0,r.jsx)("label",{style:{...t.style,...a},htmlFor:n,children:i})}},35021:(e,t,n)=>{n.d(t,{Z:()=>p});var o=n(67294),r=n(480),i=n(43593),a=n(54642),s=n(95477),l=n(23586),c=n(24042),d=n(53730),u=n(85893);function p(e){window.__c={n:"SignedUrl"};const t=(0,r.O7)(),n=(0,o.useCallback)((async e=>i.E$(e.url,[s.default.secureFileS3.url,s.default.secureFileS3V2.url])?(e.permissionRecord&&await d.transactionQueue.awaitRecordTransaction(e.permissionRecord),a.getSignedFileUrl(t,e,Boolean(c.Z.state.isNotionProtocolBugFixed))):e.url),[t]);return(0,u.jsx)(l.Z,{request:{url:e.url,permissionRecord:e.permissionRecord,useS3Url:e.useS3Url},performRequest:n,render:e.render})}},6854:(e,t,n)=>{n.d(t,{Pn:()=>b,ow:()=>y,wr:()=>_});var o=n(67294),r=n(480),i=n(24405),a=n(15145),s=n(1436),l=n(55863),c=n(9291),d=n(52423),u=n(75754),p=n(64964),m=(n(84076),n(89728)),f=n(73744),g=n(35683),h=n(85893);const v=(0,c.defineMessages)({open:{defaultMessage:"Open",id:"automations.buttonTrigger.open"},undo:{defaultMessage:"Undo",id:"automations.buttonTrigger.undo"}});function b(e){window.__c={n:"SnackbarButton"};const t=(0,i.Fg)();return(0,h.jsx)(m.Z,{...e,style:{color:t.regularInvertedTextColor,fontWeight:500,height:void 0,marginLeft:0,...e.style}})}function y(e){window.__c={n:"SnackbarUndoButton"};const{onUndo:t}=e,n=(0,r.O7)();return(0,h.jsx)(b,{onClick:()=>{d.Yw(n,!0),p.rN(),null==t||t()},children:(0,h.jsx)(c.FormattedMessage,{defaultMessage:"Undo",id:"snackbar.undo.title"})})}function _(e){window.__c={n:"SuccessSnackbarButtons"};const{blockStoreToOpen:t,performUndo:n}=e,d=(0,r.O7)(),p=(0,i.yK)((e=>({icon:{fill:e.regularInvertedTextColor},wrap:{display:"flex",columnGap:8}})),[]),m=(0,o.useMemo)((()=>t?e=>{u._({environment:d,openInNew:(0,f.DJ)(e),store:t,visitType:g.vu.Link,pageVisitSource:a.tY.ButtonAutomation})}:void 0),[t,d]);return(0,h.jsxs)("div",{style:p.wrap,children:[m&&(0,h.jsx)(b,{onClick:m,icon:e=>(0,s.g)({...e,...p.icon,width:16,height:16}),style:{paddingRight:0},children:(0,h.jsx)(c.FormattedMessage,{...v.open})}),n&&(0,h.jsx)(b,{onClick:n,icon:e=>(0,l.s)({...e,...p.icon,marginTop:-2,width:16,height:16}),children:(0,h.jsx)(c.FormattedMessage,{...v.undo})})]})}},99571:(e,t,n)=>{n.d(t,{Z:()=>y});var o=n(67294),r=n(480),i=n(86628),a=n(24405),s=n(49271),l=n(76490),c=n(62965),d=n(9291),u=n(35328),p=n(73819),m=n(23864),f=n(21407),g=n(17377),h=n(85893);const v=(0,d.defineMessages)({placeholder:{defaultMessage:"Heading 2",id:"subheaderBlock.placeholder"}});function b(e,t){window.__c={n:"SubHeaderBlock"};const n=(0,d.useIntl)(),c=(0,r.O7)(),b=(0,r.Fy)(),y=(0,o.useRef)(null),_=(0,p.rv)(e.store),S=(0,p.Iy)(e.store),w=(0,i.VK)((()=>e.store.getBlockTitleStore()),[e.store]),k=(0,a.yK)((e=>{const t=(b.isMobile?1.25:l.Lh)*l.u9,n=b.isMobile?1.25:l.Lh;return{root:{display:"flex",width:"100%",..._},toggle:{height:`${t}em`,marginTop:b.isMobile?1:s.ZD.paddingTop,marginBottom:s.ZD.paddingBottom},headerText:{...s.ZD,...(0,l.HV)({fontSizeValue:n,fontFamily:S})},headerTextPlaceholder:{WebkitTextFillColor:e.headerBlockPlaceholderTextColor}}}),[_,b.isMobile,S]);return(0,p.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"sub_header",getNode:()=>y.current,getBlockStore:()=>e.store,activate(){u.th(c,e.store,e.hideContent)}})),[c,e.hideContent,e.store]),(0,h.jsx)("div",{ref:y,style:{...k.root,...e.style},children:(0,h.jsxs)(g.Z,{store:e.store,toggleStyle:k.toggle,childrenStyleWhenToggleable:{display:"flex"},hideContent:e.hideContent,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,children:[(0,h.jsx)(f.Z,{tagName:"h3",disabled:e.disabled,store:w,placeholder:n.formatMessage(v.placeholder),placeholderStyle:k.headerTextPlaceholder,style:k.headerText,pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent}),(0,h.jsx)(m.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]})}))}const y=o.memo(o.forwardRef(b),c.Z)},51704:(e,t,n)=>{n.d(t,{Z:()=>y});var o=n(67294),r=n(480),i=n(86628),a=n(24405),s=n(49271),l=n(76490),c=n(62965),d=n(9291),u=n(35328),p=n(73819),m=n(23864),f=n(21407),g=n(17377),h=n(85893);const v=(0,d.defineMessages)({placeholder:{defaultMessage:"Heading 3",id:"subsubheaderBlock.placeholder"}});function b(e,t){window.__c={n:"SubSubHeaderBlock"};const n=(0,d.useIntl)(),c=(0,r.O7)(),b=(0,r.Fy)(),y=(0,o.useRef)(null),_=(0,p.rv)(e.store),S=(0,p.Iy)(e.store),w=(0,i.VK)((()=>e.store.getBlockTitleStore()),[e.store]),k=(0,a.yK)((e=>{const t=(b.isMobile?1.17:l.C)*l.u9,n=b.isMobile?1.17:l.C;return{root:{display:"flex",width:"100%",..._},toggle:{height:`${t}em`,marginTop:b.isMobile?1:s.ZD.paddingTop,marginBottom:s.ZD.paddingBottom},headerText:{...s.ZD,...(0,l.Jr)({fontSizeValue:n,fontFamily:S})},headerTextPlaceholder:{WebkitTextFillColor:e.headerBlockPlaceholderTextColor}}}),[_,b.isMobile,S]);return(0,p.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"sub_sub_header",getNode:()=>y.current,getBlockStore:()=>e.store,activate(){u.th(c,e.store,e.hideContent)}})),[c,e.hideContent,e.store]),(0,h.jsx)("div",{ref:y,style:{...k.root,...e.style},children:(0,h.jsxs)(g.Z,{store:e.store,toggleStyle:k.toggle,childrenStyleWhenToggleable:{display:"flex"},hideContent:e.hideContent,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag,children:[(0,h.jsx)(f.Z,{tagName:"h4",disabled:e.disabled,store:w,placeholder:n.formatMessage(v.placeholder),placeholderStyle:k.headerTextPlaceholder,style:k.headerText,pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent}),(0,h.jsx)(m.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]})}))}const y=o.memo(o.forwardRef(b),c.Z)},40235:(e,t,n)=>{n.d(t,{Z:()=>d});n(67294);var o=n(24405),r=n(82990),i=n(64369),a=n(85893);const s={height:32,width:"100%"},l={paddingTop:8,paddingBottom:8},c={fontWeight:r.Z.fontWeight.regular,textAlign:"left",paddingTop:8,paddingBottom:8};const d=function(e){let{columns:t,rows:n,cellStyle:r,tableStyle:d,hideHeader:m}=e;window.__c={n:"TableBox"};const f=(0,o.Fg)();return(0,a.jsxs)("table",{style:{...u(f),...d},children:[!m&&(0,a.jsx)("thead",{children:(0,a.jsx)("tr",{style:s,children:t.map((e=>(0,a.jsx)("th",{style:{...c,...e.style},children:(0,a.jsx)(i.Z,{isSmall:!0,children:e.header})},e.key)))})}),(0,a.jsx)("tbody",{children:n.map((e=>(0,a.jsx)("tr",{style:p(f),children:e.columns.map(((e,n)=>{const o=t[n];return(0,a.jsx)("td",{style:{...l,...r},children:e},o.key)}))},e.key)))})]})};function u(e){return{width:"100%",fontSize:13,borderTop:`1px solid ${e.regularDividerColor}`,borderBottom:`1px solid ${e.regularDividerColor}`}}function p(e){return{width:"100%",borderTop:`1px solid ${e.regularDividerColor}`}}},21407:(e,t,n)=>{n.d(t,{Z:()=>Se});var o=n(67294),r=n(83355),i=n(1302),a=n(86628),s=n(41432),l=n(8848),c=n(22491),d=n(53877),u=n(42875),p=n(72126),m=n(62193),f=n(6746),g=n(21202),h=n(23867),v=n(70203),b=n(63143),y=n(9291),_=n(36610),S=n(893),w=n(65770),k=n(993),I=n(98724),C=n(56971),x=n(74284),T=n(17269),M=n(98104),P=n(32741),A=n(82530),R=n(1742),D=n(92022),E=n(48514),B=n(60682),F=n(49117),O=n(14976),Z=n(19124),V=n(62619),U=n(33929),N=n(68056),L=n(45162),j=n(73959),z=n(89086),q=n(66638),H=n(77907),W=n(21273),K=n(8949),G=n(16772),$=n(66949),Q=n(77080),Y=n(69316),X=n(52689),J=n(23178),ee=n(19111),te=n(79797),ne=n(10743),oe=n(99757),re=n(24666),ie=n(29595),ae=n(93262),se=n(42402),le=n(480),ce=n(97511),de=n(20294),ue=n(24405),pe=n(85893);const me=(0,y.defineMessages)({typeTextPlaceholder:{defaultMessage:"Press ‘/’ for commands…",id:"text.commandsMenuNotOpen.placeholder"},typeAiTextPlaceholder:{defaultMessage:"Press ‘space’ for AI, ‘/’ for commands…",id:"text.commandsMenuNotOpen.placeholder.ai"},typeTextAiPlaceholder:{defaultMessage:"Press ‘/’ for commands, ‘space’ for AI…",id:"text.commandsMenuNotOpen.placeholder.textAi"},filterPlaceholder:{defaultMessage:"Type to filter…",id:"text.commandsMenuOpen.placeholder"}});const fe=o.forwardRef((function(e,t){window.__c={n:"Text2WithDeps"};const{store:n,style:r,placeholderStyle:i,parentStore:y,disableStyleAnnotations:H,disableInsertedDeletedAnnotations:G,onEnter:se,onTab:fe,onUntab:ye,onClick:_e,onChange:Se,onBlur:we,onFocus:ke,onPasteFiles:Ie,onCut:Ce,onCopy:xe,placeholder:Te,disableSlashCommands:Me,disableEmojiCommands:Pe,disableMentions:Ae,disableDateMentions:Re,disableDateReminderMentions:De,disableEmbedMenu:Ee,disableInsertText:Be,disableSelectAllBlocks:Fe,disableSelectionDrag:Oe,disableShiftEnter:Ze,disableEquationInteraction:Ve,disableTemplateVariableMentions:Ue,disableDrag:Ne,disableFilters:Le,isDiscussionInput:je,maxChars:ze,canTruncate:qe,id:He,className:We,legacyTransclusionParent:Ke,tagName:Ge,trackEditsToUserFlow:$e,disabled:Qe,markdownLinkifyIt:Ye,tinyMceMicrosoftWordPasteFilter:Xe}=e,Je=o.useRef(!1),et=o.useRef(null),tt=(0,m.sH)(),nt=(0,le.O7)(),ot=(0,ue.Fg)(),rt=(0,ce.l)();!function(e){(0,o.useEffect)((()=>()=>{P.qA(e)}),[e])}(n);const it=e=>{if(Dt("typing_lag"),ft){if((0,L.Aw)(nt)?A.createAndCommit({userAction:"Text.handleMutation",environment:nt,perform:t=>{let o=n;const{multiSelection:r}=e;if(r&&!(0,N.qS)(r))o=r.start.store;else if(Ke&&!e.insertedLine&&!e.isComposing&&!e.deletedLine){const e=w.Z2({environment:nt,store:o,parentStore:Ke,transaction:t});e&&(o=e)}if(k.YV({transaction:t,environment:nt,store:o,newValue:e.newValue,disableMentions:Boolean(Ae),disableDateMentions:Boolean(Re),disableDateReminderMentions:Boolean(De),disableSlashCommands:Boolean(Me),disableEmojiCommands:Boolean(Pe),disableFilters:Le||e.isComposing,disableTemplateVariableMentions:Boolean(Ue),multiSelection:r}),e.insertedLine){const e="editing"===re.default.state.mode&&re.default.state.multiSelection;e&&x.IO({transaction:t,environment:nt,multiSelection:e})}$e&&!t.isEmpty()&&R.uO(nt,$e,t)}}):A.createAndCommit({userAction:"Text.handleMutation",environment:nt,perform:t=>{k.aS({environment:nt,store:n,newValue:e.newValue,disableMentions:Boolean(Ae),disableDateMentions:Boolean(Re),disableDateReminderMentions:Boolean(De),disableSlashCommands:Boolean(Me),disableEmojiCommands:Boolean(Pe),disableTemplateVariableMentions:Boolean(Ue),disableFilters:Le||e.isComposing,transaction:t})}}),yt){if(yt.getType()){const e=yt.getSchema()||{};if("properties"===n.path[0]&&n.path[1]){e[n.path[1]]&&!Je.current&&(Je.current=!0)}}}Se&&Se()}},at=()=>{M.z9(nt,!1),(0,L.Aw)(nt)&&k.g2({environment:nt,store:n,usingMultiSelection:!0}),Se&&Se(),(()=>{if(!kt)return!1;const e=v.eeV(Bt());return 1===e.length&&("　"===e[0]||" "===e[0])})()?(0,D.toggleInitialPrompt)({from:"spacebar",environment:nt}):A.createAndCommit({userAction:"Text.runAllFiltersAfterCompositionEnd",environment:nt,perform:e=>{Le||T.G({environment:nt,store:n,transaction:e})}})},st=e=>{var t;if(!ft)return;if(null!==(t=et.current)&&void 0!==t&&t.isComposing)return;Dt("typing_delete");const o=re.default.state;if("editing"===o.mode){const t=o.multiSelection;t.start.store===n&&A.createAndCommit({userAction:"Text.handleDelete",environment:nt,perform:n=>{C.as({environment:nt,multiSelection:t,deleteForwards:!0,transaction:n,event:e})}})}he(),Se&&Se()},lt=e=>{var t;if(!ft)return;if(null!==(t=et.current)&&void 0!==t&&t.isComposing)return;const o=re.default.state;if("editing"!==o.mode)return;const r=o.multiSelection;(0,N.iG)(r)&&(0,z.J_)(n,{startIndex:r.start.index,endIndex:r.end.index})&&st(e)},ct=e=>{var t;if(!ft)return;if(Dt("typing_enter"),V.IL(e),null!==(t=et.current)&&void 0!==t&&t.isComposing)return;const n=re.default.state;if("editing"===n.mode)if(se)se(e);else{const{multiSelection:e}=n;A.createAndCommit({userAction:"Text.handleEnter",environment:nt,perform:t=>{x.IO({environment:nt,multiSelection:e,transaction:t})}}),he()}Se&&Se(e)},dt=(e,t)=>{ft&&(t.preventDefault(),I.aS({environment:nt,annotation:e}),he(),Se&&Se(),_.du(nt,{type:v.J7s(e)}))},ut=e=>{O.vO({environment:nt,event:e,textValue:Bt(),editorNode:bt(),store:n,parentStore:y,canEdit:ft})},pt=e=>{O.kV({environment:nt,event:e,textValue:Bt(),editorNode:bt(),store:n,parentStore:y,canEdit:ft})},mt=(0,a.VK)((()=>"on"===Q.default.getEligibleGroup({experimentId:"prioritize_slash_menu_block_placeholder",defaultGroup:"control"})?U.default.formatMessage(me.typeTextAiPlaceholder):U.default.formatMessage(me.typeAiTextPlaceholder)),[]),ft=(0,a.VK)((()=>{if(Qe)return!1;if(oe.n.state)return!1;const e=rt&&rt.publicEditModeStore.state;return(!je||null==e||!e.hasPublicPermission||"view"!==e.permission)&&(!(!je&&null!=e&&e.hasPublicPermission&&"edit"!==e.permission)&&n.canEdit())}),[Qe,je,rt,n]),gt=(0,o.useCallback)((()=>function(e,t){return!e&&t.canComment()}(Qe,n)&&!ft),[ft,Qe,n]),ht=()=>!ft,vt=()=>{let e=Bt(),t=!1;if(qe&&void 0!==ze){v.eeV(e).length>ze&&(e=v.KU1(e,0,ze),t=!0)}const r=O.IY({environment:nt,textValue:e&&{value:e,spaceId:(0,h.C)(n.pointer.spaceId)},parentStore:y||n,disableHover:!1,disableStyleAnnotations:Boolean(H),disableInsertedDeletedAnnotations:Boolean(G),disableDateStyleAnnotations:Boolean(Re),disabled:!ft,theme:ot,emojiType:(0,B.e_)(nt),katex:nt.KatexStore.getKatex(),parentBlockId:ve(n),renderedPageBlockId:null==rt?void 0:rt.pageStore.id,formulaValueTypes:[]}),i=(0,pe.jsxs)(o.Fragment,{children:[r,t&&be(ot)]});return f.Z.renderToStaticMarkup(i)},bt=()=>{var e;return(null===(e=et.current)||void 0===e?void 0:e.getNode())||void 0},yt=(0,a.VK)((()=>{if(n.pointer.table===g.iU)return te.G.createChildStore(n,n.pointer)}),[n]),_t=(0,a.VK)((()=>(0,z.J5)(n)),[n]),St=(0,a.VK)((()=>(0,z.Gq)(n)),[n]),wt=(0,a.VK)((()=>{const e=null==rt?void 0:rt.publicEditModeStore.state;return(0,Z.GD)(e)}),[null==rt?void 0:rt.publicEditModeStore]),kt=(0,a.VK)((()=>{if(nt.device.isMobile||nt.device.isMobileNative)return!1;if(Qe)return!1;if(!wt)return!1;const e=null==yt?void 0:yt.getType();return Boolean(e&&(0,s.hD)(e))&&"contains-selection"===_t&&!(yt&&(0,F.td)(yt))}),[Qe,nt.device.isMobile,nt.device.isMobileNative,wt,_t,yt]),It=(0,a.VK)((()=>{const e=E.Z.state;return e.open&&"inline"===e.type&&Boolean((0,L.r)(e.multiSelection,n))}),[n]),Ct=(0,a.VK)((()=>{const e=ge();return!!e&&(!W.Z.isAssistantInWriterEnabled()&&Boolean((0,L.r)(e,n)))}),[n]),xt=(0,a.VK)((()=>{var e;return $.Z.isOpen()&&(null===(e=(0,N.QY)($.Z.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store)===n}),[n]),Tt=(0,a.VK)((()=>{const e=ee.Z.state;return!!e.open&&(e.textStore===n&&e)}),[n]),Mt=(0,a.VK)((()=>{const e=J.Z.state;if(!e.open)return!1;if(!e.focusLinkInput&&!e.focusTitleInput)return!1;if(!_t)return!1;const t=(0,N.QY)(e.savedTextSelectionState.multiSelection);return!!t&&t.selection}),[_t]),Pt=(0,a.VK)((()=>{const e=Y.Z.state;return e.open&&e.findQuery.length>0?e:void 0}),[]),At=(0,a.VK)((()=>{const e=K.Z.state;if(!e.isActive)return;const{clickedPageAnnotation:t}=e;if(!t)return;const{parentStore:o,pageAnnotation:r}=t;if(o!==yt)return;const i=n.getValue();return i?null==i?void 0:i.map((e=>v.km_(e)?[e[0],e[1].flatMap((e=>v.STW(e)&&e===r?[r,v.EPB()]:[e]))]:e)):void 0}),[yt,n]),Rt=()=>{const e=Boolean(Mt);if((0,L.Aw)(nt)&&St){if(e)return;return(0,z.HE)(n)}if(_t&&!e){const e=re.default.state;if("editing"===e.mode){const t=(0,L.xI)("Text",e.multiSelection);if(t){const{selection:e}=t,o=n.getValue(),r=v.eeV(o).length;return{type:"contain",selection:{startIndex:Math.min(e.startIndex,r),endIndex:Math.min(e.endIndex,r)}}}}}},Dt=t=>{const o=!Qe&&"inline"===e.pasteBehavior;(0,q.u)({type:t,environment:nt,blockStore:yt,store:n,isInCollectionView:o})},Et=(0,o.useCallback)((()=>{if(It)return O.Gj({store:n});if(xt)return O.PY({store:n,equationStore:$.Z});if(Tt)return O.Ob({store:n,mentionMenuState:Tt});if(Mt)return O.So({store:n,selection:Mt});if(null!=Pt&&Pt.open){return O.cD({textValue:n.getValue(),find:Pt.findQuery,blockId:n.id})}if(Ct)return O.fm({store:n,temporaryAnnotation:v.GKr.TemporarySelection,multiSelection:ge()});if(At)return At;if(_t){const e=re.default.state;if("editing"===e.mode){const t=(0,N.QY)(e.multiSelection);if(t)return O.xX({store:n,selection:t.selection})}}return n.getValue()}),[Pt,Ct,_t,xt,Tt,It,Mt,At,n]),Bt=(0,o.useCallback)((()=>O.Rl({store:n,textValue:Et()})),[Et,n]),Ft=(0,o.useCallback)((()=>0===v.lzi(Bt()).length),[Bt]);!function(e){const t=(0,o.useRef)({}),n=(0,de.k)();(0,o.useEffect)((()=>{const o=e(),r=v.nai(o),i=p.oA(r.map((e=>{const t=(0,d.KR)(e,(0,u.r)());return null==t?void 0:t.toMillis()}))),a=Date.now();for(const e of i){const o=e-a;o>0&&o<b.A0&&(e in t.current||(t.current[e]=setTimeout(n,o)))}for(const e in t.current)i.includes(parseInt(e))||(clearTimeout(t.current[e]),delete t.current[e]);const s=t.current;return()=>{for(const e in s)clearTimeout(s[e]),delete s[e]}}),[e,n])}(Bt),function(e){const t=(0,le.O7)();(0,o.useEffect)((()=>{t.KatexStore.loadIfNeeded(e)}),[t,e])}(Bt),(0,o.useImperativeHandle)(t,(()=>({focus:()=>{_t||M.NX({store:n})},isComposing:()=>{var e;return Boolean(null===(e=et.current)||void 0===e?void 0:e.isComposing)},props:e})));const Ot=(0,o.useCallback)((()=>{const{device:e}=nt;let t={maxWidth:"100%",width:"100%",whiteSpace:"pre-wrap",wordBreak:"break-word",caretColor:gt()?l.ZP.transparent:ot.regularTextColor,...r};return Ft()&&(t.minHeight="1em",t={...t,color:ot.regularTextColor,WebkitTextFillColor:ot.lightTextColor,...i}),e.isMobile&&ft&&(_t?t.WebkitUserModify="read-write-plaintext-only":(t.userSelect="none",t.WebkitUserSelect="none",t.whenFocusedEditable={userSelect:"text",WebkitUserSelect:"text",WebkitUserModify:"read-write-plaintext-only"})),t}),[ft,gt,nt,_t,Ft,i,r,ot.lightTextColor,ot.regularTextColor]),Zt=(0,a.VK)((()=>(0,c.iv)(Ot(),We)),[We,Ot]),Vt=()=>{const{device:e}=nt;if(kt)return mt;if(Te)return Te;if(!Qe){if(!Me&&"contains-selection"===_t&&ft){if(ne.Z.state.open)return U.default.formatMessage(me.filterPlaceholder);if(!e.isMobile)return U.default.formatMessage(me.typeTextPlaceholder)}return" "}};return(0,pe.jsx)(ae.Z,{...e,clearBrowserSelection:()=>{var e;null===(e=bt())||void 0===e||e.blur()},getEndSelection:()=>{const e=v.eeV(Bt());return{startIndex:e.length,endIndex:e.length}},canInsertText:!Qe&&!Be,onClick:e=>{var t;t=e,O.SD({environment:nt,event:t,textValue:Bt(),editorNode:bt(),store:n,parentStore:y,canEdit:ft,disableEquationInteraction:Ve}),_e&&_e(e)},onContextMenu:e=>{yt&&O.li({environment:nt,event:e,textValue:Bt(),editorNode:bt(),store:n,parentStore:yt,canEdit:ft})},onDelete:st,onDeleteToEndOfLine:lt,onDeleteNextWord:lt,onBackspace:e=>{var t;if(!ft)return;if(null!==(t=et.current)&&void 0!==t&&t.isComposing)return;Dt("typing_backspace");const o=re.default.state;if("editing"===o.mode){const t=o.multiSelection;if(t.start.store===n){if(C.YV({device:nt.device,event:e,multiSelection:t}))return;A.createAndCommit({userAction:"Text.handleBackspace",environment:nt,perform:n=>{C.as({environment:nt,multiSelection:t,deleteForwards:!1,transaction:n,event:e})}})}}he(),Se&&Se(e)},onEnter:ct,onShiftEnter:e=>{var t;if(!ft)return;if(null!==(t=et.current)&&void 0!==t&&t.isComposing)return;const n=re.default.state;if("editing"===n.mode){const{device:t}=nt;if(!("shiftKey"in e)||e.shiftKey&&!t.isIOS){if(Ze)return;A.createAndCommit({userAction:"Text.handleShiftEnter",environment:nt,perform:e=>{k.hJ({environment:nt,string:"\n",multiSelection:n.multiSelection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}}),Se&&Se(e)}else ct(e)}},onTab:e=>{if(ft){if(Dt("typing_tab"),fe){fe(e)||e.preventDefault()}else{e.preventDefault();const t=(0,j.sQ)(n);t&&(A.createAndCommit({userAction:"Text.handleTab",environment:nt,perform:e=>{k.n2({environment:nt,closestSelectable:t,shiftKey:!1,transaction:e})}}),he())}Se&&Se()}},onUntab:e=>{if(ft){if(Dt("typing_untab"),ye){ye(e)||e.preventDefault()}else{e.preventDefault();const t=(0,j.sQ)(n);t&&(A.createAndCommit({userAction:"Text.handleUntab",environment:nt,perform:e=>{k.n2({environment:nt,closestSelectable:t,shiftKey:!0,transaction:e})}}),he())}Se&&Se()}},onToggleHighlight:e=>dt(["h",X.Z.state.color],e),onToggleBold:e=>dt(["b"],e),onToggleItalics:e=>dt(["i"],e),onToggleStrike:e=>dt(["s"],e),onToggleUnderline:e=>dt(["_"],e),onToggleCode:e=>dt(["c"],e),onCopy:e=>{!function(e,t,n,o){if(t)return void t(e);S.JG({environment:o,event:e,markdownLinkifyIt:n})}(e,xe,Ye,nt)},onCut:e=>{if(ft){if(Ce)return Ce(e),void he();S.by({environment:nt,event:e,markdownLinkifyIt:Ye}),he(),Se&&Se()}else e.preventDefault()},onPaste:e=>{ft&&(A.createAndCommit({userAction:"Text.handlePaste",environment:nt,perform:t=>{S.v({environment:nt,event:e,disableEmbedMenu:Boolean(Ee),transaction:t,onPasteFiles:Ie||S.AL,markdownLinkifyIt:Ye,tinyMceMicrosoftWordPasteFilter:Xe})}}),he(),Se&&Se())},onKeyPress:e=>{if(" "===e.key&&!e.shiftKey&&!e.ctrlKey&&!e.altKey&&Ft()&&kt)return e.preventDefault(),void(0,D.toggleInitialPrompt)({from:"spacebar",environment:nt});ft||e.metaKey&&"c"===e.key||e.preventDefault()},onMoveUp:e=>{!function(e,t){e.preventDefault(),A.createAndCommit({userAction:"Text.handleMoveUp",environment:t,perform:e=>{k.fs({environment:t,transaction:e,direction:"up"})}})}(e,nt)},onMoveDown:e=>{!function(e,t){A.createAndCommit({userAction:"Text.handleMoveDown",environment:t,perform:e=>{k.fs({environment:t,transaction:e,direction:"down"})}})}(0,nt)},render:(e,t)=>(0,pe.jsx)(ie.Z,{...Zt,onBlur:we,onFocus:ke,getDisabled:ht,spellCheck:!gt(),getHtml:vt,getSelection:Rt,onMutation:it,onCompositionStart:()=>function(e,t){M.z9(t,!0),e&&e()}(Se,nt),onCompositionEnd:at,onSelect:t,placeholder:Vt(),onMouseOver:ut,onMouseOut:pt,suppressNewlineEvents:!0,disableContentEditableWhenNotEditingTextOnMobile:!0,id:He,tagName:Ge,...e,ref:tt(et,e.leafRef)}),disableStyleAnnotations:H,canSelectAllBlocks:!Fe,canSelectionDrag:!Oe,disableDrag:Ne,topBottomPadding:9})}));function ge(){const e=G.default.state;return("closedWithContext"===e.type||"completionPopup"===e.type&&"initialPromptForAIBlock"!==e.stage)&&"textSelection"===e.context.type?e.context.textSelection:void 0}function he(){i.default.flush()}function ve(e){if(e.table===g.iU)return e.id;const{ancestor:t}=e.findRecordStoreUIAncestor((e=>{let{table:t}=e;return t===g.iU}));return t?t.id:void 0}function be(e){return(0,pe.jsxs)(se.Z,{disableUnderline:!0,style:{color:e.mediumTextColor},onClick:e=>{e.preventDefault(),e.stopPropagation()},children:["…",(0,pe.jsx)("span",{children:(0,pe.jsx)(y.FormattedMessage,{id:"text.truncated.showMoreLabel",defaultMessage:"more"})})]})}const ye=(0,y.defineMessages)({typeTextPlaceholder:{defaultMessage:"Press ‘/’ for commands…",id:"text.commandsMenuNotOpen.placeholder"},typeAiTextPlaceholder:{defaultMessage:"Press ‘space’ for AI, ‘/’ for commands…",id:"text.commandsMenuNotOpen.placeholder.ai"},typeTextAiPlaceholder:{defaultMessage:"Press ‘/’ for commands, ‘space’ for AI…",id:"text.commandsMenuNotOpen.placeholder.textAi"},filterPlaceholder:{defaultMessage:"Type to filter…",id:"text.commandsMenuOpen.placeholder"}});class _e extends r.Z{constructor(e){super(e),this.editor=null,this.mergeEditorRefs=(0,m.sH)(),this.triggeredAnalytics=!1,this.reminderTimers={},this.renderContentContainer=(e,t)=>(0,pe.jsx)(ie.Z,{...this.classNameAndStyleStore.state,onBlur:this.props.onBlur,onFocus:this.props.onFocus,getDisabled:this.getDisabled,spellCheck:!this.canExclusivelyComment(),getHtml:this.getHtml,getSelection:this.getContainerSelection,onMutation:this.handleMutation,onCompositionStart:()=>{return e=this.props.onChange,t=this.environment,M.z9(t,!0),void(e&&e());var e,t},onCompositionEnd:this.handleCompositionEnd,onSelect:t,placeholder:this.getCurrentPlaceholder(),onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,suppressNewlineEvents:!0,disableContentEditableWhenNotEditingTextOnMobile:!0,id:this.props.id,tagName:this.props.tagName,...e,ref:this.mergeEditorRefs(this.handleEditorRef,e.leafRef)}),this.handleEditorRef=e=>{this.editor=e},this.isSpaceComposition=()=>{if(!this.shouldRenderInteractiveAiPlaceholder.state)return!1;const e=v.eeV(this.getTextValue());return 1===e.length&&("　"===e[0]||" "===e[0])},this.handleCompositionEnd=()=>{M.z9(this.environment,!1),(0,L.Aw)(this.environment)&&k.g2({environment:this.environment,store:this.props.store,usingMultiSelection:!0}),this.props.onChange&&this.props.onChange(),this.isSpaceComposition()?(0,D.toggleInitialPrompt)({from:"spacebar",environment:this.environment}):A.createAndCommit({userAction:"Text.runAllFiltersAfterCompositionEnd",environment:this.environment,perform:e=>{this.props.disableFilters||T.G({environment:this.environment,store:this.props.store,transaction:e})}})},this.handleDelete=e=>{if(!this.canEditStore.state)return;if(this.editor&&this.editor.isComposing)return;this.logTypingLag("typing_delete");const{store:t}=this.props,n=re.default.state;if("editing"===n.mode){const o=n.multiSelection;o.start.store===t&&A.createAndCommit({userAction:"Text.handleDelete",environment:this.environment,perform:t=>{C.as({environment:this.environment,multiSelection:o,deleteForwards:!0,transaction:t,event:e})}})}ke(),this.props.onChange&&this.props.onChange()},this.handleForwardDeleteAtEndOfLine=e=>{if(!this.canEditStore.state)return;if(this.editor&&this.editor.isComposing)return;const{store:t}=this.props,n=re.default.state;if("editing"!==n.mode)return;const o=n.multiSelection;(0,N.iG)(o)&&(0,z.J_)(t,{startIndex:o.start.index,endIndex:o.end.index})&&this.handleDelete(e)},this.handleBackspace=e=>{if(!this.canEditStore.state||this.editor&&this.editor.isComposing)return;this.logTypingLag("typing_backspace");const{store:t}=this.props,n=re.default.state;if("editing"===n.mode){const o=n.multiSelection;if(o.start.store===t){if(C.YV({device:this.environment.device,event:e,multiSelection:o}))return;A.createAndCommit({userAction:"Text.handleBackspace",environment:this.environment,perform:t=>{C.as({environment:this.environment,multiSelection:o,deleteForwards:!1,transaction:t,event:e})}})}}ke(),this.props.onChange&&this.props.onChange(e)},this.handleEnter=e=>{if(!this.canEditStore.state)return;if(this.logTypingLag("typing_enter"),V.IL(e),this.editor&&this.editor.isComposing)return;const t=re.default.state;if("editing"===t.mode)if(this.props.onEnter)this.props.onEnter(e);else{const{multiSelection:e}=t;A.createAndCommit({userAction:"Text.handleEnter",environment:this.environment,perform:t=>{x.IO({environment:this.environment,multiSelection:e,transaction:t})}}),ke()}this.props.onChange&&this.props.onChange(e)},this.handleShiftEnter=e=>{if(!this.canEditStore.state)return;if(this.editor&&this.editor.isComposing)return;const t=re.default.state;if("editing"===t.mode){const{device:n}=this.environment;if(!("shiftKey"in e)||e.shiftKey&&!n.isIOS){if(this.props.disableShiftEnter)return;A.createAndCommit({userAction:"Text.handleShiftEnter",environment:this.environment,perform:e=>{k.hJ({environment:this.environment,string:"\n",multiSelection:t.multiSelection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}}),this.props.onChange&&this.props.onChange(e)}else this.handleEnter(e)}},this.handleTab=e=>{if(this.canEditStore.state){if(this.logTypingLag("typing_tab"),this.props.onTab){this.props.onTab(e)||e.preventDefault()}else{e.preventDefault();const t=(0,j.sQ)(this.props.store);t&&(A.createAndCommit({userAction:"Text.handleTab",environment:this.environment,perform:e=>{k.n2({environment:this.environment,closestSelectable:t,shiftKey:!1,transaction:e})}}),ke())}this.props.onChange&&this.props.onChange()}},this.handleUntab=e=>{if(this.canEditStore.state){if(this.logTypingLag("typing_untab"),this.props.onUntab){this.props.onUntab(e)||e.preventDefault()}else{e.preventDefault();const t=(0,j.sQ)(this.props.store);t&&(A.createAndCommit({userAction:"Text.handleUntab",environment:this.environment,perform:e=>{k.n2({environment:this.environment,closestSelectable:t,shiftKey:!0,transaction:e})}}),ke())}this.props.onChange&&this.props.onChange()}},this.handleAnnotation=(e,t)=>{this.canEditStore.state&&(t.preventDefault(),I.aS({environment:this.environment,annotation:e}),ke(),this.props.onChange&&this.props.onChange(),_.du(this.environment,{type:v.J7s(e)}))},this.handleToggleHighlight=e=>this.handleAnnotation(["h",X.Z.state.color],e),this.handleToggleBold=e=>this.handleAnnotation(["b"],e),this.handleToggleItalics=e=>this.handleAnnotation(["i"],e),this.handleToggleStrike=e=>this.handleAnnotation(["s"],e),this.handleToggleUnderline=e=>this.handleAnnotation(["_"],e),this.handleToggleCode=e=>this.handleAnnotation(["c"],e),this.handleClick=e=>{this.handleClickActions(e),this.props.onClick&&this.props.onClick(e)},this.handleContextMenu=e=>{const t=this.parentBlockStore.state;t&&O.li({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:t,canEdit:this.canEditStore.state})},this.handleMouseOver=e=>{O.vO({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:this.props.parentStore,canEdit:this.canEditStore.state})},this.handleMouseOut=e=>{O.kV({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:this.props.parentStore,canEdit:this.canEditStore.state})},this.handleCut=e=>{if(this.canEditStore.state){if(this.props.onCut)return this.props.onCut(e),void ke();S.by({environment:this.environment,event:e,markdownLinkifyIt:this.props.markdownLinkifyIt}),ke(),this.props.onChange&&this.props.onChange()}else e.preventDefault()},this.handlePaste=e=>{this.canEditStore.state&&(A.createAndCommit({userAction:"Text.handlePaste",environment:this.environment,perform:t=>{S.v({environment:this.environment,event:e,disableEmbedMenu:Boolean(this.props.disableEmbedMenu),transaction:t,onPasteFiles:this.props.onPasteFiles||S.AL,markdownLinkifyIt:this.props.markdownLinkifyIt,tinyMceMicrosoftWordPasteFilter:this.props.tinyMceMicrosoftWordPasteFilter})}}),ke(),this.props.onChange&&this.props.onChange())},this.handleKeyPress=e=>{if(" "===e.key&&!e.shiftKey&&!e.ctrlKey&&!e.altKey&&this.isEmpty()&&this.shouldRenderInteractiveAiPlaceholder.state)return e.preventDefault(),void(0,D.toggleInitialPrompt)({from:"spacebar",environment:this.environment});this.canEditStore.state||e.metaKey&&"c"===e.key||e.preventDefault()},this.handleCopy=e=>{!function(e,t,n,o){if(t)return void t(e);S.JG({environment:o,event:e,markdownLinkifyIt:n})}(e,this.props.onCopy,this.props.markdownLinkifyIt,this.environment)},this.handleMoveUp=e=>{!function(e,t){e.preventDefault(),A.createAndCommit({userAction:"Text.handleMoveUp",environment:t,perform:e=>{k.fs({environment:t,transaction:e,direction:"up"})}})}(e,this.environment)},this.handleMoveDown=e=>{var t;t=this.environment,A.createAndCommit({userAction:"Text.handleMoveDown",environment:t,perform:e=>{k.fs({environment:t,transaction:e,direction:"down"})}})},this.aiTextPlaceholderMessage=this.createComputedStore((()=>"on"===Q.default.getEligibleGroup({experimentId:"prioritize_slash_menu_block_placeholder",defaultGroup:"control"})?U.default.formatMessage(ye.typeTextAiPlaceholder):U.default.formatMessage(ye.typeAiTextPlaceholder)),!1,"aiTextPlaceholderMessageStore"),this.canEditStore=this.createComputedStore((()=>{if(this.props.disabled)return!1;if(oe.n.state)return!1;const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return(!this.props.isDiscussionInput||null==e||!e.hasPublicPermission||"view"!==e.permission)&&(!(!this.props.isDiscussionInput&&null!=e&&e.hasPublicPermission&&"edit"!==e.permission)&&this.props.store.canEdit())}),!1,"canEditStore"),this.getDisabled=()=>!this.canEditStore.state,this.getHtml=()=>{var e;let t=this.getTextValue(),n=!1;if(this.props.canTruncate&&void 0!==this.props.maxChars){v.eeV(t).length>this.props.maxChars&&(t=v.KU1(this.getTextValue(),0,this.props.maxChars),n=!0)}const r=O.IY({environment:this.environment,textValue:t&&{value:t,spaceId:(0,h.C)(this.props.store.pointer.spaceId)},parentStore:this.props.parentStore||this.props.store,disableHover:!1,disableStyleAnnotations:Boolean(this.props.disableStyleAnnotations),disableInsertedDeletedAnnotations:Boolean(this.props.disableInsertedDeletedAnnotations),disableDateStyleAnnotations:Boolean(this.props.disableDateMentions),disabled:!this.canEditStore.state,theme:this.theme,emojiType:(0,B.e_)(this.environment),katex:this.environment.KatexStore.getKatex(),parentBlockId:Ie(this.props.store),renderedPageBlockId:null===(e=this.pageContext)||void 0===e?void 0:e.pageStore.id,formulaValueTypes:[]}),i=(0,pe.jsxs)(o.Fragment,{children:[r,n&&(a=this.theme,(0,pe.jsxs)(se.Z,{disableUnderline:!0,style:{color:a.mediumTextColor},onClick:e=>{e.preventDefault(),e.stopPropagation()},children:["…",(0,pe.jsx)("span",{children:(0,pe.jsx)(y.FormattedMessage,{id:"text.truncated.showMoreLabel",defaultMessage:"more"})})]}))]});var a;return f.Z.renderToStaticMarkup(i)},this.clearBrowserSelection=()=>{var e;null===(e=this.getEditorNode())||void 0===e||e.blur()},this.getTextValue=()=>O.Rl({store:this.props.store,textValue:this.getTextValueHelper()}),this.getTextValueHelper=()=>{var e;if(this.isNewDiscussionMenuTarget.state)return O.Gj({store:this.props.store});if(this.isInlineEquationOverlayTarget.state)return O.PY({store:this.props.store,equationStore:$.Z});if(this.isMentionMenuTarget.state)return O.Ob({store:this.props.store,mentionMenuState:this.isMentionMenuTarget.state});if(this.linkingMenuSelectionStore.state)return O.So({store:this.props.store,selection:this.linkingMenuSelectionStore.state});if(null!==(e=this.findAndReplaceStore.state)&&void 0!==e&&e.open){return O.cD({textValue:this.props.store.getValue(),find:this.findAndReplaceStore.state.findQuery,blockId:this.props.store.id})}if(this.isCompletionPopupTarget.state)return O.fm({store:this.props.store,temporaryAnnotation:v.GKr.TemporarySelection,multiSelection:we()});const t=this.pageAnnotationBlockMenuStore.state;if(t)return t;if(this.isEditing.state){const e=re.default.state;if("editing"===e.mode){const t=(0,N.QY)(e.multiSelection);if(t)return O.xX({store:this.props.store,selection:t.selection})}}return this.props.store.getValue()},this.parentBlockStore=this.createComputedStore((()=>{const{store:e}=this.props;if(e.pointer.table===g.iU)return te.G.createChildStore(e,e.pointer)}),!1,"parentBlockStore"),this.isEditing=this.createComputedStore((()=>(0,z.J5)(this.props.store)),!1,"isEditing"),this.isSelectionEndpoint=this.createComputedStore((()=>(0,z.Gq)(this.props.store)),!1,"isSelectionEndpoint"),this.isCompletionsEnabledStore=this.createComputedStore((()=>{var e;const t=null===(e=this.pageContext)||void 0===e?void 0:e.publicEditModeStore.state;return(0,Z.GD)(t)}),!1,"isCompletionsEnabledStore"),this.shouldRenderInteractiveAiPlaceholder=this.createComputedStore((()=>{if(this.environment.device.isMobile||this.environment.device.isMobileNative)return!1;if(this.props.disabled)return!1;if(!this.isCompletionsEnabledStore.state)return!1;const e=this.parentBlockStore.state,t=e&&e.getType();return Boolean(t&&(0,s.hD)(t))&&"contains-selection"===this.isEditing.state&&!(e&&(0,F.td)(e))}),!1,"shouldRenderInteractiveAiPlaceholder"),this.isNewDiscussionMenuTarget=this.createComputedStore((()=>{const e=E.Z.state;return e.open&&"inline"===e.type&&Boolean((0,L.r)(e.multiSelection,this.props.store))}),!1,"isNewDiscussionMenuTarget"),this.isCompletionPopupTarget=this.createComputedStore((()=>{const e=we();return!!e&&(!W.Z.isAssistantInWriterEnabled()&&Boolean((0,L.r)(e,this.props.store)))}),!1,"isCompletionPopupTarget"),this.isInlineEquationOverlayTarget=this.createComputedStore((()=>{var e;return $.Z.isOpen()&&(null===(e=(0,N.QY)($.Z.state.savedTextSelectionState.multiSelection))||void 0===e?void 0:e.store)===this.props.store}),!1,"isInlineEquationOverlayTarget"),this.isMentionMenuTarget=this.createComputedStore((()=>{const e=ee.Z.state;return!!e.open&&(e.textStore===this.props.store&&e)}),!1,"isMentionMenuTarget"),this.linkingMenuSelectionStore=this.createComputedStore((()=>{const e=J.Z.state;if(!e.open)return!1;if(!e.focusLinkInput&&!e.focusTitleInput)return!1;if(!this.isEditing.state)return!1;const t=(0,N.QY)(e.savedTextSelectionState.multiSelection);return!!t&&t.selection}),!1,"linkingMenuSelectionStore"),this.findAndReplaceStore=this.createComputedStore((()=>{const e=Y.Z.state;return e.open&&e.findQuery.length>0?e:void 0})),this.pageAnnotationBlockMenuStore=this.createComputedStore((()=>{const e=K.Z.state;if(!e.isActive)return;const{clickedPageAnnotation:t}=e;if(!t)return;const{parentStore:n,pageAnnotation:o}=t;if(n!==this.parentBlockStore.state)return;const r=this.props.store.getValue();return r?null==r?void 0:r.map((e=>v.km_(e)?[e[0],e[1].flatMap((e=>v.STW(e)&&e===o?[o,v.EPB()]:[e]))]:e)):void 0}),!1,"pageAnnotationBlockMenuStore"),this.getContainerSelection=()=>{const e=Boolean(this.linkingMenuSelectionStore.state);if((0,L.Aw)(this.environment)&&this.isSelectionEndpoint.state){if(e)return;return(0,z.HE)(this.props.store)}if(this.isEditing.state&&!e){const{store:e}=this.props,t=re.default.state;if("editing"===t.mode){const n=(0,L.xI)("Text",t.multiSelection);if(n){const{selection:t}=n,o=e.getValue(),r=v.eeV(o).length;return{type:"contain",selection:{startIndex:Math.min(t.startIndex,r),endIndex:Math.min(t.endIndex,r)}}}}}},this.getEndSelection=()=>{const e=v.eeV(this.getTextValue());return{startIndex:e.length,endIndex:e.length}},this.classNameAndStyleStore=this.createComputedStore((()=>(0,c.iv)(this.getStyle(),this.props.className)),!1,"classNameAndStyleStore"),this.handleMutation=this.handleMutation.bind(this)}UNSAFE_willMountOrUpdate(){this.createReminderTimers(),this.environment.KatexStore.loadIfNeeded(this.getTextValue)}willUnmount(){this.clearReminderTimers(),P.qA(this.props.store)}isComposing(){return Boolean(this.editor&&this.editor.isComposing)}createReminderTimers(){const e=this.getTextValue(),t=v.nai(e),n=p.oA(t.map((e=>{const t=(0,d.KR)(e,(0,u.r)());return null==t?void 0:t.toMillis()}))),o=Date.now();for(const r of n){const e=r-o;e>0&&e<b.A0&&(r in this.reminderTimers||(this.reminderTimers[r]=setTimeout(this.enqueueForceUpdate,e)))}for(const r in this.reminderTimers)n.includes(parseInt(r))||(clearTimeout(this.reminderTimers[r]),delete this.reminderTimers[r])}clearReminderTimers(){for(const e in this.reminderTimers)clearTimeout(this.reminderTimers[e]),delete this.reminderTimers[e]}renderComponent(){const{disableInsertText:e,disableStyleAnnotations:t,disableSelectAllBlocks:n,disableSelectionDrag:o,disableDrag:r,disabled:i}=this.props;return(0,pe.jsx)(ae.Z,{...this.props,clearBrowserSelection:this.clearBrowserSelection,getEndSelection:this.getEndSelection,canInsertText:!i&&!e,onClick:this.handleClick,onContextMenu:this.handleContextMenu,onDelete:this.handleDelete,onDeleteToEndOfLine:this.handleForwardDeleteAtEndOfLine,onDeleteNextWord:this.handleForwardDeleteAtEndOfLine,onBackspace:this.handleBackspace,onEnter:this.handleEnter,onShiftEnter:this.handleShiftEnter,onTab:this.handleTab,onUntab:this.handleUntab,onToggleHighlight:this.handleToggleHighlight,onToggleBold:this.handleToggleBold,onToggleItalics:this.handleToggleItalics,onToggleStrike:this.handleToggleStrike,onToggleUnderline:this.handleToggleUnderline,onToggleCode:this.handleToggleCode,onCopy:this.handleCopy,onCut:this.handleCut,onPaste:this.handlePaste,onKeyPress:this.handleKeyPress,onMoveUp:this.handleMoveUp,onMoveDown:this.handleMoveDown,render:this.renderContentContainer,disableStyleAnnotations:t,canSelectAllBlocks:!n,canSelectionDrag:!o,disableDrag:r,topBottomPadding:9})}getCurrentPlaceholder(){const{device:e}=this.environment;if(this.shouldRenderInteractiveAiPlaceholder.state)return this.aiTextPlaceholderMessage.state;if(this.props.placeholder)return this.props.placeholder;if(!this.props.disabled){if(!this.props.disableSlashCommands&&"contains-selection"===this.isEditing.state&&this.canEditStore.state){if(ne.Z.state.open)return U.default.formatMessage(ye.filterPlaceholder);if(!e.isMobile)return U.default.formatMessage(ye.typeTextPlaceholder)}return" "}}handleMutation(e){if(this.logTypingLag("typing_lag"),!this.canEditStore.state)return;(0,L.Aw)(this.environment)?A.createAndCommit({userAction:"Text.handleMutation",environment:this.environment,perform:t=>{let n=this.props.store;const{multiSelection:o}=e;if(o&&!(0,N.qS)(o))n=o.start.store;else if(this.props.legacyTransclusionParent&&!e.insertedLine&&!e.isComposing&&!e.deletedLine){const e=w.Z2({environment:this.environment,store:n,parentStore:this.props.legacyTransclusionParent,transaction:t});e&&(n=e)}if(k.YV({environment:this.environment,store:n,newValue:e.newValue,disableMentions:Boolean(this.props.disableMentions),disableDateMentions:Boolean(this.props.disableDateMentions),disableDateReminderMentions:Boolean(this.props.disableDateReminderMentions),disableSlashCommands:Boolean(this.props.disableSlashCommands),disableEmojiCommands:Boolean(this.props.disableEmojiCommands),disableFilters:this.props.disableFilters||e.isComposing,disableTemplateVariableMentions:Boolean(this.props.disableTemplateVariableMentions),transaction:t,multiSelection:o}),e.insertedLine){const e="editing"===re.default.state.mode&&re.default.state.multiSelection;e&&x.IO({environment:this.environment,multiSelection:e,transaction:t})}this.props.trackEditsToUserFlow&&!t.isEmpty()&&R.uO(this.environment,this.props.trackEditsToUserFlow,t)}}):A.createAndCommit({userAction:"Text.handleMutation",environment:this.environment,perform:t=>{k.aS({environment:this.environment,store:this.props.store,newValue:e.newValue,disableMentions:Boolean(this.props.disableMentions),disableDateMentions:Boolean(this.props.disableDateMentions),disableDateReminderMentions:Boolean(this.props.disableDateReminderMentions),disableSlashCommands:Boolean(this.props.disableSlashCommands),disableEmojiCommands:Boolean(this.props.disableEmojiCommands),disableTemplateVariableMentions:Boolean(this.props.disableTemplateVariableMentions),disableFilters:this.props.disableFilters||e.isComposing,transaction:t})}});const{store:t}=this.props,n=this.parentBlockStore.state;if(n){if(n.getType()){const e=n.getSchema()||{};if("properties"===t.path[0]&&t.path[1]){e[t.path[1]]&&!this.triggeredAnalytics&&(this.triggeredAnalytics=!0)}}}this.props.onChange&&this.props.onChange()}handleClickActions(e){O.SD({environment:this.environment,event:e,textValue:this.getTextValue(),editorNode:this.getEditorNode(),store:this.props.store,parentStore:this.props.parentStore,canEdit:this.canEditStore.state,disableEquationInteraction:this.props.disableEquationInteraction})}canExclusivelyComment(){return e=this.props.disabled,t=this.props.store,!e&&t.canComment()&&!this.canEditStore.state;var e,t}focus(){this.isEditing.state||M.NX({store:this.props.store})}getEditorNode(){var e;return(null===(e=this.editor)||void 0===e?void 0:e.getNode())||void 0}isEmpty(){return 0===v.lzi(this.getTextValue()).length}logTypingLag(e){const t=!this.props.disabled&&"inline"===this.props.pasteBehavior;(0,q.u)({type:e,environment:this.environment,blockStore:this.parentBlockStore.state,store:this.props.store,isInCollectionView:t})}getStyle(){const{device:e}=this.environment;let t={maxWidth:"100%",width:"100%",whiteSpace:"pre-wrap",wordBreak:"break-word",caretColor:this.canExclusivelyComment()?l.ZP.transparent:this.theme.regularTextColor,...this.props.style};return this.isEmpty()&&(t.minHeight="1em",t={...t,color:this.theme.regularTextColor,WebkitTextFillColor:this.theme.lightTextColor,...this.props.placeholderStyle}),e.isMobile&&this.canEditStore.state&&(this.isEditing.state?t.WebkitUserModify="read-write-plaintext-only":(t.userSelect="none",t.WebkitUserSelect="none",t.whenFocusedEditable={userSelect:"text",WebkitUserSelect:"text",WebkitUserModify:"read-write-plaintext-only"})),t}}_e.displayName="Text";const Se=o.forwardRef((function(e,t){const{value:n}=(0,H.useDependency)(H.deps.markdownLinkifyIt),{value:o}=(0,H.useDependency)(H.deps.tinyMceMicrosoftWordPasteFilter);return(0,a.VK)((()=>Q.default.checkGate("functional_text_component")),[])?(0,pe.jsx)(fe,{...e,ref:t,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o}):(0,pe.jsx)(_e,{...e,ref:t,markdownLinkifyIt:n,tinyMceMicrosoftWordPasteFilter:o})}));function we(){const e=G.default.state;return("closedWithContext"===e.type||"completionPopup"===e.type&&"initialPromptForAIBlock"!==e.stage)&&"textSelection"===e.context.type?e.context.textSelection:void 0}function ke(){i.default.flush()}function Ie(e){if(e.table===g.iU)return e.id;const{ancestor:t}=e.findRecordStoreUIAncestor((e=>{let{table:t}=e;return t===g.iU}));return t?t.id:void 0}},17970:(e,t,n)=>{n.d(t,{Z:()=>g});var o=n(67294),r=n(86628),i=n(24405),a=n(49271),s=n(62965),l=n(73819),c=n(77080),d=n(23864),u=n(55217),p=n(21407),m=n(85893);function f(e,t){let{disabled:n,disableCommentMenu:s,disableHoverMenu:f,disableDrag:g,hideContent:v,legacyTransclusionParent:b,store:y,style:_}=e;window.__c={n:"TextBlock"};const S=(0,r.VK)((()=>y.getBlockTitleStore()),[y]),w=(0,r.VK)((()=>y.getContentStore()),[y]),k=(0,o.useRef)(null),I=(0,r.VK)((()=>w.getValue()||[]),[w]),C=(0,r.VK)((()=>{if(!c.default.checkGate("text_align"))return{};const{block_alignment:e}=y.getFormat();switch(e){case"right":case"center":return{textAlign:y.getFormat().block_alignment};default:return{textAlign:"left"}}}),[y]),x=(0,r.VK)((()=>{if(!c.default.checkGate("text_align"))return{};const{block_alignment:e}=y.getFormat();switch(e){case"center":return{textAlign:"left",paddingLeft:"50%"};case"right":return{textAlign:"right"};default:return{textAlign:"left"}}}),[y]),T=(0,l.rv)(y),M=(0,i.yK)((()=>({root:{...C,...T,..._}})),[C,T,_]),P=I.length>0?(0,m.jsx)("div",{style:h,children:(0,m.jsx)(u.Z,{disabled:n,store:w,disableCommentMenu:s,disableHoverMenu:f,disableDrag:g})}):(0,m.jsx)(u.Z,{disabled:!0,store:w}),A=(0,m.jsxs)("div",{style:M.root,ref:k,children:[(0,m.jsxs)("div",{style:{display:"flex"},children:[(0,m.jsx)(p.Z,{style:a.ZD,placeholderStyle:x,disabled:n,store:S,pasteBehavior:"block",legacyTransclusionParent:b,trackEditsToUserFlow:"user_flow_edit_block"}),(0,m.jsx)(d.Z,{disableCommentMenu:s,hideContent:v,store:y})]}),!v&&P]});return(0,l.ez)(y,t,(0,o.useMemo)((()=>({renderedType:"text",getBlockStore:()=>y,getNode:()=>k.current})),[y]),A)}const g=o.memo(o.forwardRef(f),s.Z),h={paddingLeft:"1.5em",display:"flex",flexDirection:"column"}},11620:(e,t,n)=>{n.d(t,{Z:()=>C});var o=n(67294),r=n(480),i=n(86628),a=n(24405),s=n(49271),l=n(80951),c=n(72126),d=n(62965),u=n(9291),p=n(36610),m=n(9953);var f=n(82530),g=n(73819),h=n(27724),v=n(23864),b=n(60458),y=n(55217),_=n(78454),S=n(21407),w=n(85893);const k=(0,u.defineMessages)({placeholder:{defaultMessage:"To-do",id:"todoBlock.placeholder"}});function I(e,t){window.__c={n:"TodoBlock"};const n=(0,u.useIntl)(),d=(0,r.Fy)(),I=(0,r.O7)(),C=(0,o.useRef)(null),x=(0,o.useId)(),T=(0,g.PE)(e.store,e.disabled),M=(0,g.rv)(e.store),P=(0,i.VK)((()=>e.store.getBlockTitleStore()),[e.store]),A=(0,i.VK)((()=>e.store.getContentStore()),[e.store]),R=(0,i.VK)((()=>{const t=e.store.getProperties();return!!t&&l.Ml(t.checked)}),[e.store]),D=(0,o.useCallback)((()=>{if(T){let t;t=c.q9(h.default.state.stores,e.store)?h.default.state.stores:[e.store],I.mobileNative&&I.mobileNative.buzz(),R?f.createAndCommit({userAction:"TodoBlock.toggleChecked",environment:I,perform:e=>{!function(e){const{environment:t,blocks:n,transaction:o}=e;for(const r of n)m.sW({store:r.getPropertiesStore(),data:{checked:l._I(!1)},transaction:o});p.Jr(t,{is_checked:!1})}({environment:I,blocks:t,transaction:e})}}):f.createAndCommit({userAction:"TodoBlock.toggleChecked",environment:I,perform:e=>{!function(e){const{blocks:t,transaction:n,environment:o}=e;for(const r of t)m.sW({store:r.getPropertiesStore(),data:{checked:l._I(!0)},transaction:n});p.Jr(o,{is_checked:!0})}({environment:I,blocks:t,transaction:e})}})}}),[T,I,R,e.store]),E=(0,a.yK)((e=>({root:{paddingLeft:s.ZD.paddingLeft,...M},title:{..._.R8,width:void 0,flexGrow:1,...R&&{textDecoration:"line-through",textDecorationColor:e.strikethroughLineColor,opacity:1,color:e.mediumTextColor}}})),[M,R]),B=(0,w.jsxs)(_.ZP,{style:{...E.root,...e.style},left:(0,w.jsx)(b.Z,{"aria-labelledby":x,checked:R,onClick:D,disabled:!T,size:16,fill:M.color,tapArea:d.isMobile?{size:30}:void 0}),childrenStyle:{display:"flex",flexDirection:"column"},ref:C,children:[(0,w.jsxs)("div",{style:{display:"flex"},children:[(0,w.jsx)(S.Z,{id:x,style:E.title,disabled:e.disabled,store:P,placeholder:n.formatMessage(k.placeholder),pasteBehavior:"block",legacyTransclusionParent:e.legacyTransclusionParent}),(0,w.jsx)(v.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}),!e.hideContent&&(0,w.jsx)(y.Z,{disabled:e.disabled,store:A,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag})]});return(0,g.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"to_do",getNode:()=>C.current,getBlockStore:()=>e.store,activate:D})),[e.store,D]),B)}const C=o.memo(o.forwardRef(I),d.Z)},4859:(e,t,n)=>{n.d(t,{J9:()=>A,ZP:()=>P,kA:()=>R});var o=n(67294),r=n(480),i=n(86628),a=n(24405),s=n(49271),l=n(72126),c=n(62965),d=n(9291),u=n(36610),p=n(29373),m=n(82530),f=n(28020),g=n(52315),h=n(73819),v=n(27724),b=n(45131),y=n(23864),_=n(64921),S=n(25777),w=n(55217),k=n(78454),I=n(21407),C=n(5210),x=n(85893);const T=(0,d.defineMessages)({placeholder:{defaultMessage:"Toggle",id:"toggleBlock.placeholder"}});function M(e,t){window.__c={n:"ToggleBlock"};const n=(0,r.O7)(),c=(0,d.useIntl)(),M=(0,o.useRef)(!0);(0,o.useLayoutEffect)((()=>{M.current&&(M.current=!1,p.nz({blockId:e.store.id,currentUserId:n.currentUser.id}),e.store.isDefaultRecordCache()&&p.LO(n,e.store.pointer))}));const P=(0,o.useRef)(null),A=(0,i.VK)((()=>e.store.getBlockTitleStore()),[e.store]),R=(0,i.VK)((()=>e.store.getContentStore()),[e.store]),D=(0,i.VK)((()=>b.Z.isOpen(e.store.id)&&!e.hideContent),[e.hideContent,e.store.id]),E=(0,i.VK)((()=>!e.store.hasContent()),[e.store]),B=(0,o.useId)(),F=(0,o.useId)(),O=(0,i.VK)((()=>g.b(e.store)||!e.store.isDefaultRecordCache()),[e.store]),Z=(0,o.useCallback)((()=>{let t;t=l.q9(v.default.state.stores,e.store)?v.default.state.stores:[e.store];const o=!D;for(const e of t)p.rd({blockId:e.id,state:o,currentUserId:n.currentUser.id});u.jR(n,{is_toggled:o})}),[n,D,e.store]),V=(0,o.useCallback)((()=>{m.createAndCommit({userAction:"ToggleBlock.handlePlaceholderClick",environment:n,perform:t=>{p.ls({environment:n,store:e.store,transaction:t})}})}),[n,e.store]),U=(0,o.useCallback)((e=>{if(e.shiftKey){const e=f.np();e&&p.X_(n,e)}else Z()}),[n,Z]),N=(0,h.rv)(e.store),L=(0,a.yK)((t=>({root:{paddingLeft:s.ZD.paddingLeft,...N,...e.style},placeholderButton:{fontSize:"inherit",width:"100%",borderRadius:4,caretColor:t.lightTextColor,...s.ZD,marginTop:2},placeholderText:{color:t.lightTextColor}})),[N,e.style]),j=(0,x.jsx)(_.Z,{style:L.placeholderButton,onClick:V,disabled:e.disabled,children:(0,x.jsx)("span",{style:L.placeholderText,children:(0,x.jsx)(d.FormattedMessage,{defaultMessage:"Empty toggle. Click or drop blocks inside.",id:"toggleBlock.emptyBlock.placeholderText"})})}),z=(0,x.jsxs)(k.ZP,{style:L.root,left:(0,x.jsx)(C.Z,{"aria-describedby":B,"aria-controls":F,isSidebar:!1,open:D,fill:!E,onClick:U,tapArea:n.device.isMobile?{size:30}:void 0}),leftStyle:{paddingRight:2},ref:P,children:[(0,x.jsxs)("div",{style:{display:"flex"},children:[(0,x.jsx)(I.Z,{id:B,style:k.R8,disabled:e.disabled,store:A,placeholder:c.formatMessage(T.placeholder),pasteBehavior:"block"}),(0,x.jsx)(y.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store,recursivelyLoadAllDiscussions:!D})]}),D?(0,x.jsx)(S.Z,{id:F,loaded:O,spinnerSize:"1em",showSpinnerTimeout:500,innerStyle:{display:"flex",flexDirection:"column",width:"100%"},style:{display:"flex"},children:(0,x.jsx)(w.Z,{store:R,emptyPlaceholder:j,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag})}):(0,x.jsx)(w.Z,{store:R,disabled:e.disabled,disableContent:!0})]});return(0,h.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"toggle",getNode:()=>P.current,getBlockStore:()=>e.store,activate(){Z()}})),[e.store,Z]),z)}const P=o.memo(o.forwardRef(M),c.Z);function A(){return{display:"flex"}}function R(){return{display:"flex",flexDirection:"column",width:"100%"}}},5210:(e,t,n)=>{n.d(t,{Z:()=>m,q:()=>u});var o=n(67294),r=n(480),i=n(24405),a=n(17693),s=n(91),l=n(9291),c=n(64921),d=n(85893);function u(e){let{isSidebar:t,isMobile:n}=e;return t&&!n?20:24}const p=(0,l.defineMessages)({open:{defaultMessage:"Open",id:"toggleButton.open"},close:{defaultMessage:"Close",id:"toggleButton.close"}});function m(e){window.__c={n:"ToggleButton"};const t=(0,r.Fy)(),n=(0,l.useIntl)(),m=(0,o.useMemo)((()=>u({isSidebar:e.isSidebar,isMobile:t.isMobile})),[t.isMobile,e.isSidebar]),f=(0,i.yK)((()=>{const n=e.color||"inherit",o="chevron"===e.icon?`rotateZ(${e.open?0:-90}deg)`:`rotateZ(${e.open?180:90}deg)`,r="chevron"===e.icon,i=r&&t.isMobile;return{button:{position:"relative",display:"flex",alignItems:"center",justifyContent:"center",width:m,height:m,borderRadius:4,...e.style},arrow:{width:i?14:r?12:"0.6875em",height:i?14:r?12:"0.6875em",transition:"transform 200ms ease-out",transform:o,fill:n,opacity:e.fill?1:.5}}}),[t.isMobile,e.color,e.fill,e.icon,e.open,e.style,m]),g=(0,o.useMemo)((()=>"chevron"===e.icon?(0,a.A)(f.arrow):(0,s.L)(f.arrow)),[e.icon,f.arrow]);return(0,d.jsxs)(c.Z,{ariaLabel:e.open?n.formatMessage(p.close):n.formatMessage(p.open),"aria-describedby":e["aria-describedby"],"aria-expanded":e.open,"aria-controls":e.open?e["aria-controls"]:void 0,style:f.button,onClick:e.onClick,onMouseDown:e.onMouseDown,disabled:e.disabled,allowShiftClick:!0,children:[e.tapArea&&(0,d.jsx)("div",{style:{position:"absolute",opacity:0,width:e.tapArea.size,height:e.tapArea.size,top:-(e.tapArea.size-m)/2,left:-(e.tapArea.size-m)/2}}),g]})}},85567:(e,t,n)=>{n.d(t,{Z:()=>v});var o=n(67294),r=n(83355),i=n(24405),a=n(84939),s=n(8848),l=n(84619),c=n(19525),d=n(82990),u=n(43224),p=n(4023),m=n(64921),f=n(26388),g=n(85893);class h extends r.Z{constructor(){super(...arguments),this.tokenTextRef=o.createRef(),this.shouldShowFullValueTooltip=()=>Boolean(this.props.showFullValueTooltip&&this.tokenTextRef.current&&this.tokenTextRef.current.offsetWidth<this.tokenTextRef.current.scrollWidth)}renderComponent(){const e=this.theme;if(this.props.showFullValueTooltip||void 0!==this.props.tooltip)return(0,g.jsx)(f.ZP,{placement:this.props.tooltipPlacement??p.u.Right,renderTooltip:t=>(0,g.jsxs)("div",{...t,style:u.F6,children:[this.props.showFullValueTooltip&&(0,g.jsx)("div",{children:this.props.value}),void 0!==this.props.tooltip&&(0,g.jsx)("div",{style:{color:this.props.showFullValueTooltip?e.mediumInvertedTextColor:void 0},children:this.props.tooltip})]}),originGap:20,textWrap:!0,render:e=>(0,g.jsx)("div",{style:y(this.props.format,this.props.isSingle,this.props.shouldShrink,this.props.isRound,this.props.showRemoveButton,this.props.disabled,this.props.disabledFeedback,this.props.color,this.props.backgroundColor,this.props.style,this.environment,this.theme,this.props.shouldWrap),...e,onMouseEnter:t=>{(this.shouldShowFullValueTooltip()||void 0!==this.props.tooltip)&&e.onMouseEnter&&e.onMouseEnter(t)},children:this.renderTokenContent()})});if(this.props.onClick){const e=this.props.backgroundColor?{background:(0,a._j)(this.props.backgroundColor,1)}:void 0,t=this.props.backgroundColor?{background:(0,a._j)(this.props.backgroundColor,2)}:void 0;return(0,g.jsx)(m.Z,{style:y(this.props.format,this.props.isSingle,this.props.shouldShrink,this.props.isRound,this.props.showRemoveButton,this.props.disabled,this.props.disabledFeedback,this.props.color,this.props.backgroundColor,this.props.style,this.environment,this.theme,this.props.shouldWrap),hoveredStyle:e,pressedStyle:t,onClick:this.props.onClick,children:this.renderTokenContent()})}return(0,g.jsx)("div",{style:y(this.props.format,this.props.isSingle,this.props.shouldShrink,this.props.isRound,this.props.showRemoveButton,this.props.disabled,this.props.disabledFeedback,this.props.color,this.props.backgroundColor,this.props.style,this.environment,this.theme,this.props.shouldWrap),children:this.renderTokenContent()})}renderTokenContent(){const{height:e}=(0,l.e1)(this.props.format);return(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("div",{style:{...this.props.shouldWrap?{overflowWrap:"anywhere"}:d.Z.textOverflowStyle,textDecoration:this.props.isStrikedThrough?"line-through":void 0,display:"inline-flex",alignItems:"center",height:e,lineHeight:`${e}px`},children:[(0,g.jsx)(S,{showColoredDot:this.props.showColoredDot,format:this.props.format}),(0,g.jsx)("span",{style:{...d.Z.textOverflowStyle},ref:this.tokenTextRef,children:this.props.value})]}),(0,g.jsx)(b,{format:this.props.format,showRemoveButton:this.props.showRemoveButton,onClickRemove:this.props.onClickRemove,disabled:this.props.disabled})]})}}h.displayName="Token";const v=h;function b(e){let{format:t,showRemoveButton:n,onClickRemove:o,disabled:r}=e;const i=function(e){switch(e){case l.lo.Large:return 10;case l.lo.ExtraSmall:case l.lo.Small:case l.lo.Medium:case l.lo.Inline:default:return 8}}(t),{height:a}=(0,l.e1)(t),s={display:"flex",alignItems:"center",justifyContent:"center",flexGrow:0,flexShrink:0,marginLeft:2,marginRight:2};return n?(0,g.jsx)(m.Z,{onClick:o,style:{...s,width:a,height:a},disabled:r,disabledFeedback:!1,mobileFeedback:!0,className:"notion-token-remove-button",children:(0,c.b)({width:i,height:i,opacity:.5})}):null}function y(e,t,n,o,r,i,a,c,d,u,p,m,f){const{height:g,fontSize:h,paddingLeft:v,margin:b}=(0,l.e1)(e),{ThemeStore:y}=p,_=o?v+1:v;return{display:t?"inline-flex":"flex",alignItems:"center",flexShrink:t||n?1:0,minWidth:0,maxWidth:"100%",height:g,borderRadius:o?g/2:3,paddingLeft:_,paddingRight:r?0:o?_+2:_,fontSize:h,lineHeight:"120%",opacity:i&&a?.4:void 0,color:c||("light"===y.state.mode?m.regularTextColor:s.ZP.whiteWithAlpha(.7)),background:d||m.legacyDefaultSelectColor,margin:t?0:b,...f&&{height:void 0,paddingTop:4,paddingBottom:4},...u}}function _(e,t,n){const o=(0,l.Nv)(t),r="default"===e?"gray":e;return void 0===r?{}:{marginRight:5,borderRadius:99,height:o,width:o,backgroundColor:"light"===n.mode?n.accentColors[r][400]:n.accentColors[r][700],display:"inline-flex",flexShrink:0}}function S(e){let{showColoredDot:t,format:n}=e;window.__c={n:"ColoredDotComponent"};const o=(0,i.Fg)();return t?(0,g.jsx)("div",{style:{display:"flex",alignItems:"center"},children:(0,g.jsx)("div",{style:_(t,n,o)})}):null}},25157:(e,t,n)=>{n.d(t,{Z:()=>he});var o=n(67294),r=n(13991),i=n(86628),a=n(24405),s=n(49085),l=n(15145),c=n(41432),d=n(8848),u=n(9999),p=n(42853),m=n(61061),f=n(44495),g=n(54497),h=n(87479),v=n(72141),b=n(82990),y=n(51454),_=n(9291),S=n(893),w=n(47307),k=n(24677),I=n(64964),C=n(98104),x=n(29373),T=n(82530),M=n(95477),P=n(95645),A=n(97978),R=n(80365),D=n(84210),E=n(12534),B=n(87290),F=n(33929),O=n(87279),Z=n(39500),V=n(46654),U=n(18514),N=n(89224),L=n(61766),j=n(88632),z=n(55367),q=n(80796),H=n(22294),W=n(88923),K=n(79797),G=n(69784),$=n(49557),Q=n(77933),Y=n(480),X=n(23867),J=n(80444);const ee=function(e){window.__c={n:"BacklinksListener"};const t=(0,Y.O7)(),n=(0,i.VK)(te,[]);return(0,o.useEffect)((()=>{if(!n)return t.LocalBacklinkStore.initializeBacklinks({block:{id:e.store.pointer.id,spaceId:(0,X.C)(e.store.pointer.spaceId)},currentUserId:t.currentUser.id,environment:t}),()=>{t.LocalBacklinkStore.destroyBacklinks(e.store.id,t)}}),[t,n,e.store.id,e.store.pointer.id,e.store.pointer.spaceId]),null};function te(){const{mainEditorCurrentBlockStore:e}=J.default.state;return Boolean(e&&"15776535-3f2c-4705-bd45-474e5ba8b46c"===e.id)}var ne=n(13966),oe=n(23063),re=n(64921),ie=n(31945),ae=n(84076),se=n(78140),le=n(76798),ce=n(72495),de=n(83182),ue=n(29551),pe=n(55217),me=n(85893);const fe=(0,_.defineMessages)({copySuccessMessage:{defaultMessage:"Copied! Now paste in any page to sync content.",id:"transclusionContainerBlock.actions.copySuccessMessage"}});class ge extends P.Z{constructor(){super(...arguments),this.storeTypes={hoveredStore:s.default.createClass(!1),haloShouldBeVisibleStore:s.default.createClass(!1),actionBarShouldBeVisibleStore:s.default.createClass(!1),backlinksIndicatorButtonPopupStore:L.Z},this.fakeSelectionTrapRef=o.createRef(),this.renderActionBarContent=()=>{const e=this.numberOfBacklinks.state,t=j.Z.state.online,n=this.hasDifferingReadPermissionsFromSource.state,{isDesktop:o}=this.environment.device;return(0,me.jsxs)("div",{style:(i=this.theme,{position:"absolute",zIndex:y.t8,top:-40,right:-2,borderRadius:6,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:b.Z.getCompositeFontFamily(r.SP).sans,background:i.popoverBackground,boxShadow:i.mediumBoxShadow}),children:[t&&(0,me.jsx)(ie.ZP,{popupType:ie.Z4.Popup,onClick:()=>{return e=this.props.store,t=this.environment,n=this.props.referenceStore,k.Z5({environment:t,stores:[_e(e,n)]}),void function(e,t){A.j(e,"transclusion_container_open_backlinks",t)}(t,{from:"action_bar"});var e,t,n},originGap:4,renderOrigin:t=>(0,me.jsxs)(re.Z,{style:Se(this.theme),...t,children:[e>0?(0,me.jsx)(_.FormattedMessage,{defaultMessage:"Editing in {icon} {numberOfBacklinks, plural, one {{numberOfBacklinks} other page} other {{numberOfBacklinks} other pages}}",id:"transclusionContainerBlock.editingMultiple",values:{icon:(0,u.J)({width:14,transform:"rotate(180deg)",marginLeft:4,marginRight:4}),numberOfBacklinks:e}}):(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.editingOriginal",defaultMessage:"Editing original"}),n&&(0,g.t)({width:14,fill:(0,d.fi)("orange",this.theme).fill,marginLeft:6}),(0,p.i)({width:10,fill:this.theme.mediumIconColor,marginLeft:4})]}),render:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderBacklinksMenu}),o&&(0,me.jsx)(re.Z,{style:Se(this.theme),onClick:this.handleCopyClick,children:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.copy",defaultMessage:"Copy and sync"})}),(0,me.jsx)(ne.Z,{store:_e(this.props.store,this.props.referenceStore),fadeIn:!1,style:{width:30,height:void 0},iconStyle:{marginTop:1,fill:this.theme.regularTextColor}})]});var i},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_renderBacklinksMenu=()=>(0,me.jsx)(xe,{store:this.props.store,hasDifferingReadPermissionsFromSourceStore:this.hasDifferingReadPermissionsFromSource}),this.handleCopyClick=()=>{k.Z5({environment:this.environment,stores:[_e(this.props.store,this.props.referenceStore)]});const e=this.fakeSelectionTrapRef.current;var t;e&&this.environment.device.isSafari?(N.setOnNode(e,this.environment.device),S.f4(),N.clear(this.environment)):S.f4(),t=this.environment,A.j(t,"transclusion_container_copy_button"),I.oV({label:F.default.formatMessage(fe.copySuccessMessage),helpUrl:(0,U.UY)("guides.transclusions")})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter=()=>{return e=this.stores.hoveredStore,t=this.disableTransclusionUI,void(q.Z.state.isDragging||G.default.state.isActive||t.state||e.setState(!0));var e,t},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave=()=>{return e=this.stores.hoveredStore,t=this.disableTransclusionUI,void(q.Z.state.isDragging||G.default.state.isActive||t.state||e.setState(!1));var e,t},this.currentState=this.createComputedStore((()=>{const e=_e(this.props.store,this.props.referenceStore);return(0,B.B)(e,this.stores.hoveredStore.state)})),this.showActionBar=this.createComputedStore((()=>{const e=this.currentState.state;return!(e!==B.x.Selected&&e!==B.x.SelectedDescendant||$.Z.state.isActive||z.ZP.state.isDragging||G.default.state.isActive||H.Z.state.isKeyboardMode)})),this.numberOfBacklinks=this.createComputedStore((()=>{const e=(0,R.L)(this.props.store,this.environment);return e.backlinks.length+e.inaccessibleBacklinkCount})),this.disableTransclusionUI=this.createComputedStore((()=>{if(M.default.isAdminMode)return!1;const{disabled:e}=this.props;if(e)return!0;const t=_e(this.props.store,this.props.referenceStore);if(!t.canEdit())return!0;const n=t.findRecordStoreUIAncestor((e=>e!==t&&e instanceof K.G&&e.getType()===c.Ti.transclusionContainer));return Boolean(n.ancestor)})),this.hasDifferingReadPermissionsFromSource=this.createComputedStore((()=>{const{store:e,referenceStore:t}=this.props;if(!t||!e.canEdit()||!t.canEdit())return!1;const n=(0,V.YO)(e).map((e=>{let{permissionItem:t}=e;return t})),o=(0,V.YO)(t).map((e=>{let{permissionItem:t}=e;return t})),r=(0,h.L2)(n,o).created.find((e=>!(0,v.FB)(e)));return Boolean(r)}))}handleCreated(){this.stores.hoveredStore.setState(!1),k.ZH({device:this.environment.device});const{store:e}=this.props,t=e.getContentStores()[0];t&&t.getType()===c.Ti.text&&(k.eP({environment:this.environment,store:t}),C.N_({store:t.getBlockTitleStore()}))}async canRemoveBlock(){const e=this.numberOfBacklinks.state;if(0===e)return{canRemove:!0,canUndo:!0};const t=await ve({header:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.remove.header",defaultMessage:"Delete original?"}),text:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.remove.text",defaultMessage:"These blocks are synced in {numberOfBacklinks, plural, one {{numberOfBacklinks} other page} other {{numberOfBacklinks} other pages}}. If you delete the original, the blocks will no longer be synced.",values:{numberOfBacklinks:e}}),acceptLabel:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.remove.confirm",defaultMessage:"Delete and unsync copies"})});return{canRemove:t,canUndo:t}}async confirmUnsyncTransclusionReference(){return 0===this.numberOfBacklinks.state||ve({header:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionReference.header",defaultMessage:"Unsync this?"}),text:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionReference.text",defaultMessage:"The selected blocks will no longer be synced with the original."}),acceptLabel:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionReference.confirm",defaultMessage:"Unsync"})})}async confirmUnsyncTransclusionContainer(){const e=this.numberOfBacklinks.state;return 0===e||ve({header:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionContainer.header",defaultMessage:"Unsync all?"}),text:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionContainer.text",defaultMessage:"{numberOfBacklinks, plural, one {{numberOfBacklinks} other page} other {{numberOfBacklinks} other pages}} will no longer sync with these blocks.",values:{numberOfBacklinks:e}}),acceptLabel:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.unsyncTransclusionContainer.confirm",defaultMessage:"Unsync all"})})}renderPersisted(){const{store:e}=this.props,{device:t}=this.environment,n=this.disableTransclusionUI.state,o=Boolean(this.props.referenceStore);if(e.pathIsDead()&&o)return(0,me.jsx)(we,{store:this.props.store});if(n)return(0,me.jsx)(pe.Z,{disabled:this.props.disabled,disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,store:this.props.store.getContentStore()});{const n=this.currentState.state,o=n!==B.x.Default||this.stores.haloShouldBeVisibleStore.state||this.stores.actionBarShouldBeVisibleStore.state,r=this.showActionBar.state,i=!e.hasContent();return this.hasDifferingReadPermissionsFromSource.state,(0,me.jsxs)("div",{style:{display:"flex"},children:[(0,me.jsx)("span",{ref:this.fakeSelectionTrapRef,style:{height:"1px",width:"1px"}}),(0,me.jsxs)("div",{style:{display:"flex",flexDirection:"column",position:o?"relative":void 0,paddingTop:3,paddingBottom:3,width:"100%"},onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,onMouseEnter:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter,onClick:i?e=>function(e,t,n){(0,E.ZP)({event:e,context:E.Af.EditorClick,callback:()=>{(0,Z.uG)(e)||T.createAndCommit({userAction:"TransclusionContainerBlock.handleEmptyClick",environment:n,perform:e=>{x.ls({environment:n,store:t,transaction:e})}})}})}(e,this.props.store,this.environment):void 0,children:[(0,me.jsx)(pe.Z,{disabled:!1,store:this.props.store.getContentStore(),emptyPlaceholder:(0,me.jsx)(ke,{}),disableHoverMenu:this.props.disableHoverMenu||n!==B.x.SelectedDescendant,disableDrag:t.isMobile}),(0,me.jsx)(ee,{store:e},e.id),o&&(0,me.jsx)(Ce,{haloShouldBeVisibleStore:this.stores.haloShouldBeVisibleStore,state:n}),o&&this.renderActionBar(r)]})]})}}renderActionBar(e){return(0,me.jsx)(oe.Z,{isVisible:e,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},onAnimationStart:()=>{this.stores.actionBarShouldBeVisibleStore.setState(!0)},onAnimationEnd:()=>{e||this.stores.actionBarShouldBeVisibleStore.setState(!1)},render:this.renderActionBarContent})}}const he=ge;function ve(e){const{header:t,text:n,acceptLabel:o}=e;return new Promise((e=>{w.showDialog({showCancel:!0,keepFocus:!1,message:(0,me.jsxs)("div",{children:[(0,me.jsx)("div",{style:{fontWeight:b.Z.fontWeight.semibold},children:t}),n]}),items:[{label:o,color:"red",onAccept:()=>{e(!0)}}],handleCancel:()=>{e(!1)}})}))}function be(){return(0,me.jsx)(_.FormattedMessage,{defaultMessage:"Learn more about Synced blocks",id:"transclusionContainerBlock.learnMoreLabel"})}function ye(){return(0,me.jsx)(ce.Z,{topBorder:!0,children:(0,me.jsx)(de.Z,{title:(0,me.jsx)(be,{}),href:(0,U.UY)("guides.transclusions"),analyticsFrom:"transclusion_container_block"})})}function _e(e,t){return t||e}function Se(e){return{display:"flex",alignItems:"center",padding:"0 8px",borderRight:`1px solid ${d.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${e.regularDividerColor}`,marginRight:1}}function we(e){let{store:t}=e;window.__c={n:"DeletedContainerBannerComponent"};const n=(0,a.Fg)(),o=(0,i.VK)((()=>(0,D.ZP)({store:t,fullyQualified:!1,pageVisitSource:l.tY.LinkInPage})),[t]),r=(0,i.VK)((()=>(0,D.ZP)({store:t,openInSidePeek:!0,fullyQualified:!1,pageVisitSource:l.tY.PeekOpen})),[t]),s=(0,i.VK)((()=>W.default.isSidePeekOpen()),[]),c=(0,me.jsx)(ae.Z,{href:o,altHref:r,forceAltHref:s,external:!1,inline:!0,underline:!0,children:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.deletedContainerBanner.viewDeletedPage",defaultMessage:"View deleted page"})});return(0,me.jsxs)(ue.gq,{style:{color:n.text.secondary,background:n.accentColors.gray[30],padding:"16px 16px 16px 12px",borderRadius:4},alignItems:"center",children:[(0,f.D)({width:24,height:24,flexShrink:0,marginRight:10,padding:2}),(0,me.jsx)("div",{style:{fontSize:14},children:(0,me.jsx)(_.FormattedMessage,{id:"transclusionContainerBlock.deletedContainerBanner.syncedContentPageDeleted",defaultMessage:"The page with the original synced block has been deleted. {pageLink}",values:{pageLink:c}})})]})}function ke(){window.__c={n:"EmptyEditingPlaceholderComponent"};const e=(0,a.Fg)();return(0,me.jsx)("div",{style:{caretColor:e.lightTextColor,color:e.lightTextColor,paddingTop:4,paddingBottom:4},children:(0,me.jsx)(_.FormattedMessage,{defaultMessage:"Click or drag blocks here, then paste in another page to sync content.",id:"transclusionContainerBlock.emptyEditingPlaceholder"})})}function Ie(){window.__c={n:"HaloContentComponent"};const e=(0,a.Fg)();return(0,me.jsx)("div",{style:{position:"absolute",left:-6,right:-6,top:-3,bottom:-3,pointerEvents:"none",borderRadius:8,border:`2px solid ${e.transclusionBorderColor}`}})}function Ce(e){let{state:t,haloShouldBeVisibleStore:n}=e;const o=t!==B.x.Default;return(0,me.jsx)(oe.Z,{isVisible:o,enterAnimationStyle:{opacity:0},animationStyle:{opacity:t===B.x.Hovered?.45:1,scale:1},exitAnimationStyle:{opacity:0},onAnimationStart:()=>{n.setState(!0)},onAnimationEnd:()=>{o||n.setState(!1)},render:()=>(0,me.jsx)(Ie,{})})}function xe(e){let{store:t,hasDifferingReadPermissionsFromSourceStore:n}=e;window.__c={n:"BacklinksMenuComponent"};const o=(0,a.Fg)(),r={menuType:O.og.Popup,width:400},s=(0,i.VK)((()=>n.state),[n]),c=(0,i.VK)((()=>t.getNavigableBlockStore()),[t]),d=(0,i.VK)((()=>c&&(0,D.ZP)({store:c,fullyQualified:!1,pageVisitSource:l.tY.Breadcrumb})),[c]),u=s&&c?(0,me.jsx)(ae.Z,{underline:!0,inline:!0,href:d,style:{color:o.mediumTextColor},children:(0,me.jsx)(le.Z,{store:c,style:{display:"inline"},shouldWrap:!0,maxLength:30})}):void 0;return(0,me.jsxs)(se.Z,{...r,children:[s&&c&&(0,me.jsx)(ce.Z,{style:{background:o.sidebarSecondaryBackground},children:(0,me.jsxs)("div",{style:{display:"flex",fontSize:12,padding:"6px 16px"},children:[(0,m.B)({width:16,marginTop:6,marginRight:8,color:o.regularIconColor}),(0,me.jsx)("div",{style:{flexGrow:1,minWidth:0},children:(0,me.jsx)("span",{style:{overflowWrap:"break-word"},children:(0,me.jsx)(_.FormattedMessage,{defaultMessage:"Viewership permissions on this page are different from the original page <page></page>. Some members might not have access.",id:"transclusionContainerBlock.differingPermissionsWarning",values:{page:()=>u}})})})]})}),(0,me.jsx)(ce.Z,{topBorder:s,children:(0,me.jsx)(Q.Z,{type:"transclusion_container",store:t,originalTransclusionStore:t,disableArrow:!0})}),(0,me.jsx)(ye,{})]})}},91497:(e,t,n)=>{n.d(t,{Z:()=>u});var o=n(67294),r=n(86628),i=n(62965),a=n(9291),s=n(73819),l=n(25157),c=n(85893);function d(e,t){window.__c={n:"TransclusionReferenceBlock"};const n=(0,a.useIntl)(),i=(0,o.useRef)(null),d=(0,r.VK)((()=>e.store.getTransclusionReferenceTargetStore()),[e.store]),u=(0,r.VK)((()=>d&&d.canRead()),[d]);return(0,s.ez)(e.store,t,(0,o.useMemo)((()=>({renderedType:"transclusion_reference",getNode:()=>{const e=i.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),void 0!==d&&u?(0,c.jsx)(l.Z,{store:d,disabled:e.disabled,intl:n,referenceStore:e.store,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,ref:i}):null)}const u=o.memo(o.forwardRef(d),i.Z)},74480:(e,t,n)=>{n.d(t,{h:()=>ls});var o=n(54851),r=n(50694),i=n(67294),a=n(86628),s=n(45238),l=n(85893);const c=(0,s.I)("abstract",{viewBox:"0 0 32 32",svg:(0,l.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M0 16C0 3.199 3.199 0 16 0s16 3.199 16 16-3.199 16-16 16S0 28.801 0 16zm9.976 7.71a6.128 6.128 0 003.398 1.043 6.14 6.14 0 006.146-6.127 6.126 6.126 0 10-9.544 5.085zm11.521.79h3.004v-17H7.499v2.997h13.998V24.5zm-5-5.874a3.123 3.123 0 11-6.246 0 3.123 3.123 0 016.246 0z"})});var d=n(62965),u=n(9291),p=n(73819),m=n(68859),f=n(33742);const g=(0,u.defineMessages)({embedButtonText:{defaultMessage:"Embed Abstract",id:"abstractBlock.embeds.button.label"}});function h(e,t){window.__c={n:"AbstractBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"abstract",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:r,ref:o,store:e.store,iconSvg:c,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with Abstract links with public access enabled",id:"abstractBlock.embeds.caption"}),embedButtonText:n.formatMessage(g.embedButtonText),urlInputPlaceholder:"https://abstract.com/…",children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed Abstract",id:"abstractBlock.placeholder"})}))}const v=i.memo(i.forwardRef(h),d.Z);var b=n(13991),y=n(480),_=n(97511),S=n(24405),w=n(8848),k=n(42853),I=n(11751),C=n(82990),x=n(51454),T=n(10910),M=n(72899),P=n(43250),A=n(14976),R=n(19124),D=n(87290),E=n(33929),B=n(16402),F=n(77907),O=n(28267),Z=n(16772),V=n(55367),U=n(80796),N=n(22294),L=n(69784),j=n(49557),z=n(68709),q=n(23063),H=n(64921),W=n(73420),K=n(63296),G=n(55217),$=n(21407);const Q=(0,u.defineMessages)({summarize:{id:"aiBlock.summarize",defaultMessage:"Summarize this page with AI"},findActionItems:{id:"aiBlock.findActionItems",defaultMessage:"Find action items on this page with AI"},helpMeWrite:{id:"aiBlock.helpMeWrite",defaultMessage:"Tell the AI what to write…"},summarizeMeetingTranscript:{id:"aiBlock.summarizeMeetingTranscript",defaultMessage:"Summarize this meeting with any action items and decisions taken"}}),Y=i.forwardRef((function(e,t){window.__c={n:"AiBlock"};const{store:n,disabled:o,disableHoverMenu:r,ai:{completionActions:s,completionInitialPromptActions:c}}=e,d=(0,y.O7)(),m=(0,y.Fy)(),f=(0,p.PE)(n,o),g=(0,_.l)(),[h,v]=(0,i.useState)(!1),[M,F]=(0,i.useState)(!1),[Y,X]=(0,i.useState)(!1),[J,ee]=(0,i.useState)(!1),te=(0,i.useRef)(null),ne=(0,S.yK)((e=>({actionBar:{position:"absolute",zIndex:x.t8,top:-40,right:-2,borderRadius:6,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:C.Z.getCompositeFontFamily(b.SP).sans,background:e.popoverBackground,boxShadow:e.mediumBoxShadow},actionButton:{display:"flex",alignItems:"center",padding:"0 8px",borderRight:`1px solid ${w.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${e.regularDividerColor}`,marginRight:1},icon:{fill:e.accentColors.purple[300],width:21,height:21,position:"relative",top:5},haloContent:{position:"absolute",left:-6,right:-6,top:-3,bottom:-3,pointerEvents:"none",borderRadius:8,border:`2px solid ${e.aiBlockBorderColor}`}})),[]),oe=(0,S.Fg)(),re=(0,O.X)(te),ie=!re||re.width<400,ae=(0,a.VK)((()=>!n.hasContent()),[n]),se=(0,a.VK)((()=>ae?D.x.Hovered:(0,D.B)(n,M)),[ae,M,n]),le=se!==D.x.Default||Y||J,ce=(0,a.VK)((()=>"completionPopup"===Z.default.state.type&&"results"===Z.default.state.stage&&Z.default.state.loading),[]),de=(0,a.VK)((()=>{const e=(0,R.z1)(),t=e.summarize,o=n.getFormat().ai_prompt_key;if(!o)return t;const r=e[o];return r||t}),[n]),ue=(0,a.VK)((()=>n.getBlockTitleStore()),[n]),pe=(0,a.VK)((()=>ue.getValue()),[ue]),me=(0,a.VK)((()=>{const e=pe;if(e)return{prompt:(0,A.Xh)(e,n)}}),[pe,n]),fe=(0,a.VK)((()=>n.getFormat().ai_last_edited),[n]),ge=(0,a.VK)((()=>{const e=g&&g.publicEditModeStore.state;return!(0,R.GD)(e)||(!!h||(!(n.canEdit()&&!n.isLocked())||"helpMeWrite"===de.key&&(null==me||!me.prompt)))}),[h,n,de.key,null==me?void 0:me.prompt,g]),he=(0,a.VK)((()=>!(se!==D.x.Selected&&se!==D.x.SelectedDescendant||j.Z.state.isActive||V.ZP.state.isDragging||L.default.state.isActive||N.Z.state.isKeyboardMode)),[se]),ve=(0,i.useCallback)((()=>{U.Z.state.isDragging||L.default.state.isActive||F(!0)}),[]),be=(0,i.useCallback)((()=>{U.Z.state.isDragging||L.default.state.isActive||F(!1)}),[]),ye=(0,i.useCallback)((()=>{T.RL(d,{type:"generate",prompt_key:de.key}),v(!0),s.triggerCompletionForAiBlock({environment:d,store:n,prompt:de,additionalContext:me}).then((()=>{v(!1)}))}),[s,d,n,de,me]),_e=(0,i.useCallback)((()=>{T.RL(d,{type:"edit_prompt"}),c.showInitialPromptForAIBlock({environment:d,store:n,originRef:te,prompt:null==me?void 0:me.prompt,clientPrompt:de})}),[c,d,n,de,null==me?void 0:me.prompt]),Se=(0,i.useCallback)((()=>{c.showInitialPromptForAIBlock({environment:d,store:n,originRef:te,prompt:null==me?void 0:me.prompt,clientPrompt:de})}),[c,d,n,de,null==me?void 0:me.prompt]),we=()=>(0,l.jsx)("div",{style:ne.haloContent}),ke=()=>{const e=se!==D.x.Default;return(0,l.jsx)(q.Z,{isVisible:e,enterAnimationStyle:{opacity:0,scale:.995},animationStyle:{opacity:se===D.x.Hovered?.45:1,scale:1},exitAnimationStyle:{opacity:0,scale:.995},onAnimationStart:()=>{X(!0)},onAnimationEnd:()=>{e||X(!1)},render:we})},Ie=()=>(0,l.jsxs)("div",{style:ne.actionBar,children:[(0,l.jsxs)(H.Z,{style:{...ne.actionButton,display:"flex",gap:4},onClick:_e,disabled:ge,children:[(0,I.t)({width:16,height:16,fill:oe.accentColors.purple[400]}),(0,l.jsx)("span",{style:{color:oe.accentColors.purple[500],fontWeight:500},children:(0,l.jsx)(u.FormattedMessage,{id:"aiBlock.generated",defaultMessage:"Generated by AI"})}),fe?(0,l.jsx)("span",{style:{color:oe.accentColors.purple[300]},children:(0,B.IS)(fe,{useLowercase:!0,useCompactFormat:!0,roundDownYears:!0})}):null,ge?null:(0,k.i)({width:10,marginLeft:4,fill:oe.lightIconColor})]}),(0,l.jsx)(H.Z,{onClick:ye,disabled:ge,style:{...ne.actionButton,opacity:ge?.5:1,cursor:ge?"not-allowed":"pointer"},children:h?(0,l.jsx)(u.FormattedMessage,{id:"aiBlockBlock.update.loading",defaultMessage:"Updating…"}):(0,l.jsx)(u.FormattedMessage,{id:"aiBlockBlock.update",defaultMessage:"Update"})})]}),Ce=(0,l.jsx)("div",{className:P.zov,style:{display:"flex"},ref:te,children:(0,l.jsx)("div",{style:{position:le?"relative":void 0,paddingTop:3,paddingBottom:3,width:"100%",marginTop:4,marginBottom:4},onMouseLeave:be,onMouseEnter:ve,children:ae?(0,l.jsxs)(z.p,{allowSelectionWithin:!0,children:[(0,l.jsxs)(W.X2,{justifyContent:"space-between",padding:8,gap:8,wrap:ie?"wrap":"initial",children:[(0,l.jsxs)(W.X2,{gap:12,alignItems:"baseline",grow:1,children:[(null===(xe=de.svg)||void 0===xe?void 0:xe.call(de,ne.icon))??(0,I.t)(ne.icon),"helpMeWrite"===de.key?(0,l.jsx)($.Z,{onFocus:Se,disabled:!f,store:ue,placeholder:E.default.formatMessage(Q.helpMeWrite),pasteBehavior:"block",style:{flexGrow:1,flexBasis:0},onEnter:ye}):"helpMeWrite"===de.key?(null==me?void 0:me.prompt)||E.default.formatMessage(Q.helpMeWrite):Q[de.key]?E.default.formatMessage(Q[de.key]):void 0]}),(0,l.jsx)(K.Z,{disabled:ge,onClick:ye,style:{fontWeight:500,color:oe.accentColors.purple[500],opacity:ge?.5:1,cursor:ge?"not-allowed":"pointer"},children:h?(0,l.jsx)(u.FormattedMessage,{id:"aiBlock.generate.loading.label",defaultMessage:"Generating…"}):(0,l.jsx)(u.FormattedMessage,{id:"aiBlock.generate.label",defaultMessage:"Generate"})})]}),ke()]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(G.Z,{disabled:o,store:n.getContentStore(),disableHoverMenu:r||se!==D.x.SelectedDescendant,disableDrag:m.isMobile}),le&&ke(),!ce&&le&&(0,l.jsx)(q.Z,{isVisible:he,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},onAnimationStart:()=>{ee(!0)},onAnimationEnd:()=>{he||ee(!1)},render:Ie})]})})});var xe;return(0,p.ez)(n,t,(0,i.useMemo)((()=>({renderedType:"ai_block",getBlockStore:()=>n,getNode:()=>te.current})),[n]),Ce)}));const X=i.memo(i.forwardRef((function(e,t){const{value:n}=(0,F.useDependency)(M.E0);return n?(0,l.jsx)(Y,{...e,ai:n,ref:t}):null})),d.Z);var J=n(21914);const ee=(0,s.I)("audio",{viewBox:"0 0 23.5 24",svg:(0,l.jsx)("path",{d:"M5.258 14.008a.661.661 0 01-.485-.203.702.702 0 01-.195-.492v-2.899c0-.187.065-.351.195-.492a.65.65 0 01.485-.211.67.67 0 01.5.21.694.694 0 01.203.493v2.899a.687.687 0 01-.203.492.68.68 0 01-.5.203zm2.695 3.148a.684.684 0 01-.688-.695V7.266c0-.193.066-.357.196-.493a.66.66 0 01.492-.21c.198 0 .362.07.492.21a.67.67 0 01.203.493v9.195a.67.67 0 01-.203.492.654.654 0 01-.492.203zm2.688 3.032a.645.645 0 01-.485-.204.667.667 0 01-.195-.492V4.234c0-.198.065-.364.195-.5a.645.645 0 01.485-.203.68.68 0 01.5.203.68.68 0 01.203.5v15.258a.654.654 0 01-.203.492.68.68 0 01-.5.203zm2.695-4.047a.684.684 0 01-.492-.196.684.684 0 01-.196-.492v-7.18a.684.684 0 01.688-.695.67.67 0 01.492.203.67.67 0 01.203.492v7.18a.684.684 0 01-.695.688zm2.695 2.328a.68.68 0 01-.695-.696V5.953c0-.193.065-.357.195-.492a.667.667 0 01.5-.211c.193 0 .354.07.485.21a.67.67 0 01.203.493v11.82a.67.67 0 01-.203.493.645.645 0 01-.485.203zm2.688-3.852a.654.654 0 01-.492-.203.675.675 0 01-.196-.484V9.797c0-.188.065-.35.196-.485.13-.14.294-.21.492-.21a.66.66 0 01.492.21.661.661 0 01.203.485v4.133a.661.661 0 01-.203.484.67.67 0 01-.492.203z"})}),te=(0,u.defineMessages)({embedButtonText:{defaultMessage:"Embed audio",id:"audioBlock.embedAudio.button.label"}});function ne(e,t){window.__c={n:"AudioBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"audio",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:r,ref:o,store:e.store,iconSvg:ee,mediaMenuCurrentTab:"file",mediaMenuTabs:[{type:"file",fileUpload:!0},{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with .MP3s, .WAVs, and .OGGs",id:"audioBlock.embed.caption"}),embedButtonText:n.formatMessage(te.embedButtonText),urlInputPlaceholder:"https://…",children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Add an audio file",id:"audioBlock.placeholder"})}))}const oe=i.memo(i.forwardRef(ne),d.Z);var re=n(73935),ie=n(53150),ae=n(83096),se=n(30845),le=n(23210),ce=n(70203),de=n(64002),ue=n(63143),pe=n(57549),me=n(48948),fe=n(47307),ge=n(27153),he=n(12714),ve=n(24677),be=n(98104),ye=n(95645),_e=n(28651),Se=n(61766),we=n(13966),ke=n(91893),Ie=n(23864),Ce=n(12981),xe=n(84076),Te=n(68785),Me=n(81865),Pe=n(64369),Ae=n(86329),Re=n(35021);const De={width:16,height:16,minWidth:16,marginRight:6},Ee={flexGrow:4,flexShrink:1,flexBasis:180,padding:14,paddingTop:12,overflow:"hidden",textAlign:"left"},Be=2*ue.hM,Fe=(0,u.defineMessages)({linkPlaceholder:{defaultMessage:"Paste in https://…",id:"bookmarkBlock.editBookmark.linkPlaceholder"},bookmarkTitle:{defaultMessage:"Bookmark",id:"bookmarkBlock.bookmark.title"},errorMessage:{defaultMessage:"Please enter a valid link",id:"bookmarkBlock.invalidLinkError.message"}});class Oe extends ye.Z{constructor(){super(...arguments),this.captionAriaId=(0,ie.Z)(),this.caption=()=>{const e=this.props.store.getPropertyStore("caption");ve.eP({environment:this.environment,store:this.props.store}),be.NX({store:e})},this.storeTypes={stringInputButtonPopupStore:Se.Z,mouseStore:_e.Z},this.handleEmbedConfirm=e=>this.embed(e),this.handleOpenMenu=()=>{if(this.canEdit()){const e=re.findDOMNode(this);if(!e)return;if(!(e instanceof Element))return;const t=e.getBoundingClientRect();ge.$(this.environment,{originRect:t,originGap:0,isSmallWidth:!0,showArrow:!0,title:E.default.formatMessage(Fe.bookmarkTitle),currentTab:"embed",tabs:[{type:"embed",caption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Create a visual bookmark from a link.",id:"bookmarkBlock.visualBookmark.prompt"}),buttonText:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Create bookmark",id:"bookmarkBlock.visualBookmark.create"}),inputPlaceholder:E.default.formatMessage(Fe.linkPlaceholder),onChange:e=>{const t=le.D(e);se.B(t,"url")?(ge.Z(),this.handleEmbedConfirm(t)):fe.showErrorMessage(E.default.formatMessage(Fe.errorMessage))}}]})}},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove=()=>{return(e=this.stores.mouseStore).setState({...e.state,mouseEntered:!0});var e},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave=()=>{return(e=this.stores.mouseStore).setState({...e.state,mouseEntered:!1});var e}}handleCreated(){this.edit()}edit(){this.handleOpenMenu()}embed(e){return pe.bO(this.environment,{pastedText:e,source:"bookmark_block_menu"}),me.K({environment:this.environment,store:this.props.store,url:e})}activate(){const e=this.props.store.getProperties(),t=ce.QaF(e&&e.link||[]);t&&he.D({environment:this.environment,url:t})}didMount(){const e=this.props.store.getFormat().bookmark_loading_ttl;if(e){const t=e-Date.now()-Be;t>0&&setTimeout(this.enqueueForceUpdate,t+1e3)}}renderPersisted(){const e=this.props.store.getProperties();return e&&e.link?this.renderContent():this.renderPlaceholder()}renderContent(){const{store:e}=this.props,t=e.getProperties(),n=ce.Jcv(t&&t.link);let o=ce.Jcv(t&&t.title);if(n===o||!o){const e=de.Qc(n);e.hostname&&(o=e.hostname)}const r=ce.Jcv(t&&t.description),i=e.getFormat(),a=i.bookmark_cover,s=i.bookmark_icon,c=i.bookmark_loading_ttl,d=c&&c>Date.now()-Be;return(0,l.jsxs)(z.p,{role:"figure","aria-labelledby":this.captionAriaId,allowSelectionWithin:!0,children:[(0,l.jsxs)("div",{style:{display:"flex"},children:[(0,l.jsx)(Re.Z,{permissionRecord:e.pointer,url:n,render:(e,t)=>(0,l.jsxs)(xe.Z,{href:t,external:!0,style:{flexGrow:1,minWidth:0},innerStyle:this.getContentStyle(),onMouseMove:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove,onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,children:[(0,l.jsxs)("div",{style:Ee,children:[d?(0,l.jsxs)(Pe.Z,{style:{minHeight:24,marginBottom:2,display:"inline-flex",alignItems:"center",color:this.theme.mediumTextColor},children:[(0,l.jsx)(Te.Z,{style:{marginRight:8}})," ",(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Fetching preview",id:"bookmarkBlock.loadWhileFetching.message"})]}):(0,l.jsx)(Pe.Z,{style:{minHeight:24,marginBottom:2},children:o}),r&&(0,l.jsx)(Pe.Z,{isSmall:!0,isMultiline:!0,style:{height:32,overflow:"hidden"},children:r}),(0,l.jsxs)("div",{style:{display:"flex",marginTop:6},children:[s&&s.length>0&&(0,l.jsx)(Me.Z,{url:s,isAuthenticated:!0,permissionRecord:this.props.store.pointer,render:(e,t)=>t&&(0,l.jsx)("img",{src:t,style:De})}),(0,l.jsx)(Pe.Z,{style:{color:this.theme.regularTextColor},isSmall:!0,children:n})]})]}),a&&(0,l.jsx)(Ve,{store:this.props.store,imageURL:a}),Ue(this.environment,this.stores.mouseStore)&&this.canEdit()&&(0,l.jsx)(we.Z,{store:this.props.store,style:{position:"absolute",top:4,right:4,background:(0,f.M1)(this.environment)},iconStyle:{fill:w.ZP.white},fadeIn:!0})]})}),(0,l.jsx)(Ie.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]}),(0,l.jsx)(ke.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})]})}renderPlaceholder(){const{disabled:e}=this.props;return(0,l.jsxs)(z.p,{allowSelectionWithin:!1,onMouseEnter:e=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}),onMouseLeave:e=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1}),style:{display:"flex"},children:[(0,l.jsx)(Ae.Z,{iconSvg:ae.Q,disabled:e,shouldHideRight:!Ue(this.environment,this.stores.mouseStore),right:this.canEdit()&&(0,l.jsx)(we.Z,{store:this.props.store,fadeIn:!1}),onClick:this.handleOpenMenu,isLoading:!1,progressPercent:0,children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Add a web bookmark",id:"bookmarkBlock.addWebBookmark.placeholder"})}),(0,l.jsx)(Ie.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}getContentStyle(){return{display:"flex",flexWrap:"wrap-reverse",alignItems:"stretch",textAlign:"left",overflow:"hidden",border:`1px solid ${this.theme.darkDividerColor}`,borderRadius:4,position:"relative",...this.getBlockColorStyle()}}}const Ze=Oe;function Ve(e){let{imageURL:t,store:n}=e;const o={display:"block",width:"100%",height:"100%",objectFit:"cover"};return(0,l.jsx)("div",{style:{flexGrow:1,flexShrink:1,flexBasis:180,display:"block",position:"relative"},children:(0,l.jsx)("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0},children:(0,l.jsx)(Me.Z,{url:t,isAuthenticated:!0,permissionRecord:n.pointer,width:250,render:(e,t)=>t&&(0,l.jsx)(Ce.Z,{style:o,src:t})})})})}function Ue(e,t){const{device:n}=e;return n.isMobile||t.state.mouseEntered}var Ne=n(49271),Le=n(3043);function je(e,t){window.__c={n:"BreadcrumbBlock"};const n=(0,i.useRef)(null),o=(0,y.Fy)(),r=(0,p.PE)(e.store,e.disabled),s=(0,a.VK)((()=>e.store.getNavigableBlockStore()),[e.store]),c=s?(0,l.jsxs)(z.p,{allowSelectionWithin:!0,style:{display:"flex",paddingTop:Ne.ZD.paddingTop,paddingBottom:Ne.ZD.paddingBottom},ref:n,children:[(0,l.jsx)(Le.l2,{showCurrentPageControls:!1,ancestorMaxWidth:200,currentPageMaxWidth:300,store:s,maxAncestorCount:3,isMobile:o.isMobile,style:{flexGrow:1,minWidth:0,fontSize:"inherit"}}),o.isMobile&&r&&(0,l.jsx)(we.Z,{store:e.store,fadeIn:!0,style:{marginTop:2,marginRight:4}}),(0,l.jsx)(Ie.Z,{disableCommentMenu:e.disableCommentMenu,hideContent:e.hideContent,store:e.store})]}):null;return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"breadcrumb",getNode:()=>n.current,getBlockStore:()=>e.store})),[e.store]),c)}const ze=i.memo(i.forwardRef(je),d.Z);var qe=n(7825),He=n(27755),We=n(38376),Ke=n(6740),Ge=n(49085),$e=n(17397),Qe=n(99036),Ye=n(80951),Xe=n(19233),Je=n(23867),et=n(83960),tt=n(75553),nt=n(893),ot=n(62385);function rt(e){window.__c={n:"CodeBlockActionButtons"};const t=(0,y.O7)(),n=(0,y.Fy)(),o=(0,S.Fg)(),r=(0,p.PE)(e.store,e.disabled),a=(0,i.useCallback)((()=>{const n=ce.Jcv(e.store.getBlockTitleStore().getValue());nt.RD({environment:t,stringValue:n,copiedMessage:nt.tq.copiedCodeToClipboard})}),[t,e.store]),s={height:25,background:o.codeBlockButtonBackground,color:o.regularTextColor,fontWeight:C.Z.fontWeight.regular,padding:"4px 6px",fontSize:11.5};return(0,l.jsxs)("div",{style:{color:o.mediumTextColor,display:"flex",alignItems:"center",justifyContent:"center",fontSize:12,marginTop:4,marginRight:4},children:[!n.isMobile&&(0,l.jsxs)(ot.Z,{onClick:a,style:{...s,borderTopRightRadius:0,borderBottomRightRadius:0},children:[(0,tt.U)({height:16,width:16,paddingRight:4}),(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Copy",id:"codeBlock.copyToClipboard.button"})]}),!n.isMobile&&r&&(0,l.jsx)(ot.Z,{onClick:e.handleEditCaption,style:{...s,marginLeft:1,marginRight:1,borderRadius:0},children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Caption",id:"codeBlock.caption.button"})}),r&&(0,l.jsx)(we.Z,{style:{height:25,background:o.codeBlockButtonBackground,borderTopLeftRadius:n.isMobile?3:0,borderBottomLeftRadius:n.isMobile?3:0,paddingLeft:8,paddingRight:8},store:e.store,fadeIn:!1})]})}var it=n(97880),at=n(3124);const st=(0,s.I)("codePreviewOnly",{viewBox:"0 0 24 20",svg:(0,l.jsx)("path",{d:"M2.608 11.906h1.21v1.032c0 1.463.766 2.215 2.243 2.215h9.33c1.477 0 2.243-.758 2.243-2.215V6.444c0-1.463-.766-2.221-2.242-2.221H14.12V3.197c0-1.463-.772-2.221-2.242-2.221h-9.27C1.132.976.366 1.734.366 3.197v6.494c0 1.457.766 2.215 2.242 2.215zm.082-1.34c-.635 0-.984-.328-.984-.99v-6.27c0-.662.349-.99.984-.99h9.106c.629 0 .984.328.984.99v.917H6.06c-1.476 0-2.242.758-2.242 2.221v4.122H2.69zm3.453 3.254c-.636 0-.985-.335-.985-.998V6.561c0-.664.349-.998.985-.998h9.167c.628 0 .984.334.984.998v6.261c0 .663-.356.998-.984.998H6.143zm2.713-1.77c0 .307.335.437.595.287l3.972-2.324a.372.372 0 00-.007-.643L9.451 7.046c-.26-.15-.595-.027-.595.287v4.717z"})}),lt=(0,s.I)("splitView",{viewBox:"0 0 24 20",svg:(0,l.jsx)("path",{d:"M13.456 11.143V2.864c0-1.476-.766-2.242-2.222-2.242H2.915C1.452.622.693 1.388.693 2.864v8.278c0 1.477.76 2.243 2.222 2.243h8.32c1.462 0 2.221-.766 2.221-2.242zm-1.34-.083c0 .636-.335.985-.998.985H3.024c-.663 0-.99-.349-.99-.985V7.663h10.082v3.397zM2.033 2.946c0-.629.328-.984.991-.984h8.094c.663 0 .998.355.998.984v3.405H2.033V2.946z"})});var ct=n(42274),dt=n(72495),ut=n(62967);const pt=(0,u.defineMessages)({showCodePreviewSection:{id:"action.codePreviewSection.name",defaultMessage:"Show in block"}}),mt=(0,ut.cN)({key:"show code",displayName:ut.RE.showOnlyCodeFormat,analyticsName:ut.RE.showOnlyCodeFormat.defaultMessage,svg:at._,validators:[],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;ct.pZ({environment:n,blocks:t,previewFormat:"code"})}}),ft=(0,ut.cN)({key:"show preview on code block",displayName:ut.RE.showCodePreviewFormat,analyticsName:ut.RE.showCodePreviewFormat.defaultMessage,svg:st,validators:[],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;ct.pZ({environment:n,blocks:t,previewFormat:"preview"})}}),gt=(0,ut.cN)({key:"show code and preview",displayName:ut.RE.showSplitViewFormat,analyticsName:ut.RE.showSplitViewFormat.defaultMessage,svg:lt,validators:[],closeParentMenu:!0,action:e=>{let{blocks:t,environment:n}=e;ct.pZ({environment:n,blocks:t,previewFormat:"split_view"})}}),ht=[{key:"code preview actions block",render:e=>(0,l.jsx)(dt.Z,{isTitleUppercase:!1,...e}),title:E.default.formatMessage(pt.showCodePreviewSection),actions:[mt,ft,gt]}];var vt=n(87279),bt=n(60709),yt=n(95477),_t=n(77080),St=n(7406),wt=n(66673),kt=n(4615);const It="\n---\n";var Ct=n(42402),xt=n(29551);function Tt(e){window.__c={n:"MermaidDOMRenderer"};const{mermaidAPI:t,source:n}=e,o=(0,i.useRef)(null),r=(0,i.useRef)(`mermaid-${(0,kt.ZP)()}`),[a,s]=(0,i.useState)(),c=(0,S.yK)((e=>({diagram:(0,xt.xk)({alignContent:"center",justifyContent:"center"})})),[]),d=function(e){switch(e){case"dark":return"dark";case"light":return"neutral";default:(0,it.t1)(e)}}((0,S.Fg)().mode),u=(0,i.useMemo)((()=>function(e){const{source:t,theme:n}=e,o=`%%{init: {'theme':'${n}'}}%%\n`;return t.startsWith("---\n")&&t.includes(It)?t.replace(It,`${It}${o}`):`${o}${t}`}({source:n,theme:d})),[n,d]);return(0,i.useLayoutEffect)((()=>{if(!t)return;let e=!1;try{t.render(r.current,u).then((t=>{const n=t.svg,r=t.bindFunctions;if(e)return;if(!o.current)return;o.current.innerHTML=n;const i=o.current.firstChild;i&&i instanceof SVGSVGElement&&i.removeAttribute("height");try{r&&r(o.current),s(void 0)}catch(a){s((0,St.tg)(a))}}),(e=>{s((0,St.tg)(e))}))}catch(n){s((0,St.tg)(n))}return()=>{e=!0}}),[u,t]),(0,l.jsxs)(l.Fragment,{children:[a&&(0,l.jsx)(Mt,{error:a}),(0,l.jsx)("div",{style:c.diagram,ref:o})]})}function Mt(e){window.__c={n:"MermaidError"};const{error:t}=e,n=(0,S.yK)((e=>({label:{color:e.errorText,marginBottom:4,whiteSpace:"pre-wrap"}})),[]);return"str"in t?(0,l.jsx)("div",{children:(0,l.jsxs)(Pe.Z,{isMultiline:!0,style:n.label,children:[t.str,(0,l.jsx)("div",{children:(0,l.jsx)(Ct.Z,{external:!0,href:"https://mermaid-js.github.io/mermaid/#/examples",children:(0,l.jsx)(u.FormattedMessage,{id:"mermaidRenderer.error.seeMermaidExamples",defaultMessage:"See Mermaid examples"})})})]})}):(0,l.jsx)(Pe.Z,{isMultiline:!0,style:n.label,children:(0,l.jsx)(u.FormattedMessage,{id:"mermaidRenderer.error.unknownError",defaultMessage:"Syntax error in Mermaid diagram: {error}",values:{error:`${t.name}: ${t.message}`}})})}function Pt(e){window.__c={n:"CodeBlockCustomCodePreview"};const t=(0,a.VK)((()=>e.store.getBlockTitleStore()),[e.store]),n="code"===e.currentCodePreviewFormat,o=(0,i.useMemo)((()=>Rt(e.currentLanguage)),[e.currentLanguage]),r=(0,a.VK)((()=>t.getValue()),[t]);if(n||!r||!o)return null;const s=o.component;return(0,l.jsx)("div",{style:Et(e.currentCodePreviewFormat),children:(0,l.jsx)(s,{source:A.Xh(r,t)})})}const At={Mermaid:{component:function(e){window.__c={n:"MermaidRenderer"};const{source:t}=e,n=(0,wt.Kt)(t,300,Object.is),o=(0,F.useDependency)(F.deps.mermaidAPI);return(0,l.jsx)("div",{children:o.error?(0,l.jsx)(Mt,{error:o.error}):(0,l.jsx)(Tt,{mermaidAPI:o.value,source:n})})},gate:()=>"on"===_t.default.getGroup("mermaid")}};function Rt(e){const t=At[e];if(t&&t.gate())return t}function Dt(e){return Boolean(Rt(e))}function Et(e){switch(e){case"split_view":return{padding:16,flexGrow:1,flexShrink:0};case"preview":return{padding:16,paddingTop:40,alignSelf:"center",flexGrow:1,flexShrink:0};case"code":return{};default:(0,it.t1)(e)}}var Bt=n(48019),Ft=n(31945),Ot=n(78140);function Zt(e){window.__c={n:"CodeBlockCodePreviewSelector"};const t=(0,y.O7)(),n=(0,y.Fy)(),o=(0,S.Fg)(),r=(0,p.PE)(e.store,e.disabled),s=(0,a.qz)(void 0,Se.Z),c=(0,i.useCallback)((o=>{const r=(0,l.jsx)(Bt.Z,{context:{blocks:[e.store],environment:t,publicEditMode:void 0},sections:ht,initialFocus:["code","preview","split_view"].findIndex((t=>t===e.currentCodePreviewFormat)),onAccept:o.close});let i;return i=n.isMobile?{menuType:vt.og.ActionSheet}:{menuType:vt.og.Popup,width:167,maxHeight:"50vh"},(0,l.jsx)(Ot.Z,{...i,children:r})}),[n.isMobile,t,e.currentCodePreviewFormat,e.store]);return Dt(e.currentLanguage)?(0,l.jsx)(Ft.ZP,{popupType:n.isMobile?Ft.Z4.SlideUp:Ft.Z4.Popup,renderOrigin:t=>(0,l.jsxs)(ot.Z,{disabled:!r,style:{marginRight:5},...t,children:[Vt(e.currentCodePreviewFormat),r&&(0,k.i)({width:10,marginLeft:4,fill:o.lightIconColor})]}),buttonPopupStore:s,placementToOrigin:bt.Iw.Bottom,render:c}):null}function Vt(e){let t;switch(e){case"split_view":t=ut.RE.showSplitViewFormat;break;case"preview":t=ut.RE.showCodePreviewFormat;break;case"code":t=ut.RE.showOnlyCodeFormat;break;default:(0,it.t1)(e)}return(0,l.jsx)(u.FormattedMessage,{...t})}var Ut=n(15157),Nt=n(82530),Lt=n(52275),jt=n(68894);function zt(e){window.__c={n:"CodeBlockLanguageSelector"};const t=(0,u.useIntl)(),n=(0,y.O7)(),o=(0,y.Fy)(),r=(0,S.Fg)(),s=(0,p.PE)(e.store,e.disabled),[c,d]=(0,i.useState)(""),m=(0,a.qz)(void 0,Se.Z),f=(0,i.useCallback)((e=>{d(e.target.value)}),[]),g=(0,i.useCallback)((()=>{d("")}),[]),h=(0,i.useCallback)((t=>{Nt.createAndCommit({userAction:"CodeBlock.setPersistedLanguage",environment:n,perform:n=>{ct.E5({blocks:[e.store],language:t,transaction:n})}}),Ut.Z.set({userId:n.currentUser.id,key:et.T.localLanguagePreferenceKey,value:t})}),[n,e.store]),v=(0,i.useCallback)((r=>{const i=$e.X0.filter((e=>"Java/C/C++/C#"!==e)),a=[{key:0,render:e=>(0,l.jsx)(dt.Z,{...e}),actions:i.map((e=>{const t={key:e,displayName:e,analyticsName:e,searchName:e,render:t=>(0,l.jsx)(Lt.Z,{title:e,...t}),action:()=>{h(e),r.close()},closeParentMenu:!0};return t}))}],s=(0,l.jsx)(Bt.Z,{filter:c,context:{blocks:[],environment:n,publicEditMode:void 0},sections:a,initialFocus:c?0:i.findIndex((t=>t===e.currentLanguage))}),d=(0,l.jsx)(dt.Z,{isInput:!0,children:(0,l.jsx)(jt.ZP,{value:c,onChange:f,focus:!o.isMobile||void 0,placeholder:t.formatMessage(ut.RE.searchPlaceholder),focusAfterAnimation:!0})});let p;return p=o.isMobile?{menuType:vt.og.Modal,title:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Language",id:"codeBlock.mobileLanguageMenu.title"}),right:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Done",id:"codeBlock.mobileLanguageMenu.doneButton.label"}),onClickRight:r.close,header:d}:{menuType:vt.og.Popup,width:240,maxHeight:"50vh",header:d},(0,l.jsx)(Ot.Z,{...p,children:s})}),[e.currentLanguage,o.isMobile,n,f,t,c,h]);return(0,l.jsx)(Ft.ZP,{popupType:o.isMobile?Ft.Z4.SlideUp:Ft.Z4.Popup,renderOrigin:t=>(0,l.jsxs)(ot.Z,{disabled:!s,style:{marginRight:5},...t,children:[e.currentLanguage,s&&(0,k.i)({width:10,marginLeft:4,fill:r.lightIconColor})]}),buttonPopupStore:m,placementToOrigin:bt.Iw.Bottom,render:v,onClose:g})}var qt=n(28385);const Ht="opacity 300ms ease-in";class Wt extends ye.Z{constructor(){super(...arguments),this.captionAriaId=(0,ie.Z)(),this.storeTypes={focusStore:Ge.default.createClass(!1),mouseStore:_e.Z},this.caption=()=>{Qt(this.props.store,this.environment)},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleFocus=e=>function(e,t){const n=e.target;n instanceof HTMLElement&&(0,Ke.E)(n)&&t.setState(!0)}(e,this.stores.focusStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBlur=()=>{this.stores.focusStore.setState(!1)}}renderPersisted(){const{store:e,disabled:t}=this.props,n=function(e){const t=function(e){const t=e.getProperties()||{};return Ye.Sj(t.language,Qe.fG)}(e);if(t&&(0,$e.L9)(t))return t;return et.T.defaultLanguage}(this.props.store),o=Xe.W[n],r=function(e,t){return Dt(e)?t.getFormat().code_preview_format??"split_view":et.T.defaultCodePreviewFormat}(n,this.props.store),i=e.getFormat().code_wrap;return(0,l.jsxs)("div",{style:{display:"flex"},children:[(0,l.jsxs)(z.p,{role:"figure","aria-labelledby":this.captionAriaId,allowSelectionWithin:!0,style:(a=this.theme,s=this.props.style,{flexGrow:1,borderRadius:4,textAlign:"left",position:"relative",background:a.codeBlockBackground,minWidth:0,width:"100%",...s}),onMouseMove:()=>this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!0}),onMouseLeave:()=>{this.stores.mouseStore.setState({...this.stores.mouseStore.state,mouseEntered:!1})},children:[(0,l.jsxs)("div",{onFocus:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleFocus,onBlur:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBlur,style:Xt(this.environment,this.theme,this.stores.focusStore,this.stores.mouseStore),children:[(0,l.jsx)(zt,{disabled:this.props.disabled,store:this.props.store,currentLanguage:n}),(0,l.jsx)(Zt,{disabled:this.props.disabled,store:this.props.store,currentLanguage:n,currentCodePreviewFormat:r})]}),(0,l.jsx)("div",{onFocus:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleFocus,onBlur:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBlur,style:Yt(this.environment,this.theme,this.stores.focusStore,this.stores.mouseStore),children:(0,l.jsx)(rt,{store:this.props.store,disabled:this.props.disabled,handleEditCaption:()=>Qt(this.props.store,this.environment)})}),(0,l.jsxs)("div",{children:[Gt(n,r)&&(0,l.jsx)(qt.Z,{store:e.getBlockTitleStore(),blockStore:e,language:o,disabled:t,codeWrap:Boolean(i),isQuickFind:Boolean(this.props.isQuickFind),parentSpaceId:(0,Je.C)(e.pointer.spaceId)}),(0,l.jsx)(Pt,{store:e,disabled:t,currentCodePreviewFormat:r,currentLanguage:n})]}),(0,l.jsx)("div",{style:$t(this.theme),children:(0,l.jsx)(ke.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})})]}),(0,l.jsx)(Ie.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store}),"​"]});var a,s}}const Kt=Wt;function Gt(e,t){return!Dt(e)||"preview"!==t}function $t(e){return{background:e.contentBackground,paddingRight:105}}function Qt(e,t){const n=e.getPropertyStore("caption");ve.eP({environment:t,store:e}),be.NX({store:n})}function Yt(e,t,n,o){const{mouseEntered:r}=o.state,i=n.state,{isMobile:a}=e.device,s=N.Z.state.isKeyboardMode,l=a||i||!s&&r;return{position:"absolute",top:3,right:1,zIndex:1,color:t.mediumTextColor,display:"flex",alignItems:"center",justifyContent:"flex-end",height:25,fontSize:11.5,opacity:l?1:0,transition:Ht}}function Xt(e,t,n,o){const{mouseEntered:r}=o.state,i=n.state,{isMobile:a}=e.device,s=r||i||a;return{position:"absolute",top:8,left:8,zIndex:1,color:t.mediumTextColor,display:"flex",alignItems:"center",justifyContent:"flex-end",opacity:s?1:0,transition:Ht}}const Jt=(0,s.I)("codepen",{viewBox:"0 0 40 40",svg:(0,l.jsx)("path",{d:"M39.9834,13.7071 C39.8236,12.6665 38.6647,12.1063 37.8655,11.586 C36.4269,10.6255 35.0283,9.70502 33.5897,8.74452 C30.1931,6.46334 26.7564,4.18216 23.3598,1.90098 C22.5606,1.38071 21.7613,0.820424 20.9621,0.300155 C20.4027,-0.100052 19.6434,-0.100052 19.044,0.300155 C16.7663,1.82094 14.4485,3.38175 12.1708,4.90253 L2.10066,11.626 C1.22152,12.1863 0.0626603,12.7466 0.0226996,13.9472 C-0.0172612,15.2679 0.0226996,16.6286 0.0226996,17.9493 L0.0226996,24.3526 C0.0226996,25.5132 -0.217065,26.8739 0.861875,27.5943 C3.41936,29.3552 6.01681,31.036 8.61426,32.7569 C11.8111,34.878 15.008,37.0391 18.2048,39.1602 C19.084,39.7606 19.9631,40.4009 21.0421,39.6805 C21.9611,39.0802 22.8403,38.4799 23.7594,37.8796 C27.3159,35.5184 30.8724,33.1171 34.4289,30.7559 L38.385,28.1145 C38.6248,27.9544 38.9045,27.7944 39.1443,27.5943 C39.7037,27.1941 39.9435,26.6338 39.9435,25.9534 L39.9435,14.9477 C39.9834,14.5075 40.0234,14.1073 39.9834,13.7071 C39.9834,13.7871 39.9834,13.6671 39.9834,13.7071 Z M21.7214,4.94255 L35.1882,13.9472 L29.194,17.9893 L21.7214,12.9867 L21.7214,4.94255 Z M18.2848,4.94255 L18.2848,12.9467 L10.8521,17.9493 L4.81799,13.9472 L18.2848,4.94255 Z M3.45932,17.1489 L7.73512,20.0304 L3.45932,22.9118 L3.45932,17.1489 Z M18.2848,35.1182 L4.81799,26.1135 L10.8121,22.0714 L18.2448,27.074 L18.2448,35.1182 L18.2848,35.1182 Z M20.0031,24.1125 L13.929,20.0304 L20.0031,15.9482 L26.0771,20.0304 L20.0031,24.1125 Z M21.7214,35.1182 L21.7214,27.114 L29.1541,22.1114 L35.1482,26.1535 L21.7214,35.1182 Z M36.5468,22.9118 L32.271,20.0304 L36.5868,17.1489 L36.5468,22.9118 Z"})});function en(e,t){window.__c={n:"CodepenBlock"};const n=(0,i.useRef)(null),o=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"codepen",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:o,ref:n,store:e.store,iconSvg:Jt,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with any public CodePen link…",id:"codepenBlock.embed.caption"}),children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed CodePen",id:"codepenBlock.placeholder"})}))}const tn=i.memo(i.forwardRef(en),d.Z);var nn=n(53223),on=n(1302),rn=n(72126),an=n(13084),sn=n(52989),ln=n(78175),cn=n(12534),dn=n(39500),un=n(50628),pn=n(96049);const mn={width:46,handleWidth:4};function fn(e){window.__c={n:"ColumnDivider"};const t=(0,a.qz)(e.mouseStore,_e.Z),{showHandle:n,onMouseDown:o,onTouchStart:r,onContextMenu:s,onDoubleClick:c}=e,d=(0,y.O7)(),u=(0,a.VK)((()=>n&&(t.state.mouseEntered||d.device.isMobile&&pn.Z.state)),[n,t,d.device]),p=(0,i.useCallback)((()=>{t.setState({...t.state,mouseEntered:!1}),pn.Z.removeListener(p)}),[t]),m=(0,i.useCallback)((()=>{pn.Z.removeListener(p),pn.Z.state||t.setState({...t.state,mouseEntered:!0})}),[p,t]),f=(0,i.useCallback)((()=>{pn.Z.state?pn.Z.addListener(p):t.setState({...t.state,mouseEntered:!1})}),[p,t]),g=(0,S.yK)((e=>{const t={position:"relative",width:mn.width,flexGrow:0,flexShrink:0,transition:"opacity 200ms ease-out",opacity:0};return{base:t,hovered:{...t,opacity:1,cursor:"col-resize"},handle:{position:"absolute",top:0,bottom:0,left:mn.width/2-mn.handleWidth/2,width:mn.handleWidth,height:"100%",background:e.darkDividerColor}}}),[]),h=u?g.hovered:g.base;return(0,l.jsx)("div",{style:h,onDoubleClick:c,onMouseDown:o,onTouchStart:r,onContextMenu:s,onMouseEnter:m,onMouseLeave:f,children:n&&(0,l.jsx)("div",{style:g.handle})})}const gn=i.memo(fn);var hn=n(79954);class vn extends ye.Z{constructor(){super(...arguments),this.handleMouseDown=e=>{(0,ln.zE)(this.props.store,this.environment)&&(0,cn.ZP)({event:e,context:cn.Af.EditorMouseDown,callback:()=>{this.capturedMouseDown=!0,e.preventDefault(),sn.AI({environment:this.environment,target:e.target,startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!1})}})},this.handleMouseUp=e=>{if(this.capturedMouseDown&&!dn.uG(e)){const{clientX:t,clientY:n,target:o}=e;on.default.afterNextFlush((()=>{be.J9(this.environment,{x:t,y:n,target:o instanceof Element?o:void 0}),this.capturedMouseDown=!1}))}}}renderComponent(){const{ratio:e,store:t,isLastItem:n,disabled:o}=this.props,r=1===t.getContentLength(),i=this.canEdit();return(0,l.jsx)(q.Z,{isVisible:!0,animationStyle:Sn({ratio:e},this.props.numColumns,this.props.store,this.environment),render:()=>(0,l.jsx)("div",{style:_n(this.props.store,this.environment),onMouseDown:this.handleMouseDown,onMouseUp:this.handleMouseUp,onClick:e=>function(e,t,n){if(un.Z.hasBeenUpdatedSince(e.timeStamp))return;if(t.canEdit()){const{clientX:o,clientY:r,target:i}=e;on.default.afterNextFlush((()=>{Nt.createAndCommit({userAction:"Column.handleClick",environment:n,perform:e=>{be.LG(n,{x:o,y:r,target:i instanceof Element?i:void 0},t,e)}})}))}}(e,this.props.store,this.environment),children:(0,l.jsx)(hn.Z,{store:t,canDropLeft:i&&(0,ln.zE)(this.props.store,this.environment),canDropRight:n&&i&&(0,ln.zE)(this.props.store,this.environment),onSelectableDrop:e=>function(e,t,n,o){const{droppedDirection:r,droppedStores:i,duplicate:a}=e;Nt.createAndCommit({userAction:"Column.handleDrop",environment:o,perform:e=>{an.LQ({environment:o,droppedDirection:r,droppedStores:i,targetParentStore:t.getContentStore(),targetStore:n,duplicate:a,transaction:e})}})}(e,this.props.columnListStore,this.props.store,this.environment),analyticsName:"column",style:{display:"flex",flexDirection:"column"},shouldShowDropZone:!0,isListContainer:!0,children:(0,l.jsx)(G.Z,{store:t.getContentStore(),disabled:o,disableLayout:r,disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag})})})})}}const bn=vn,yn=12;function _n(e,t){const n={paddingTop:yn,paddingBottom:yn};return(0,ln.zE)(e,t)&&rn.f0(n,{flexGrow:0,flexShrink:0}),n}function Sn(e,t,n,o){let{ratio:r}=e;const i={width:"100%"};return t>1&&(i.width=`calc((100% - ${mn.width*(t-1)}px) * ${r})`),(0,ln.zE)(n,o)||(i.width="100%"),i}n(57658);var wn=n(45697),kn=n.n(wn),In=n(83355),Cn=n(41432),xn=n(96802);class Tn extends Ge.default{getInitialState(){return{dragging:!1}}}const Mn=Tn;var Pn=n(23883),An=n(70518),Rn=n(12137),Dn=n(58202),En=n(36610);const Bn=function(e){const{columnListStore:t}=e;t.setState({dragging:!1})},Fn=function(e){const{columnListBlockStore:t,diffX:n,columnListStore:o,leftColumn:r,rightColumn:i}=e;if(o.state.dragging){const{leftColumnStartWidth:e}=o.state,a=(0,Rn.Z)(o.state.leftColumnStartRatio,0,1),{rightColumnStartWidth:s}=o.state,l=(0,Rn.Z)(o.state.rightColumnStartRatio,0,1),c=e+s,d=a+l,u=(0,Rn.Z)(e+n,0,c),p=(0,Rn.Z)(s-n,0,c),m=d*(u/c),f=d*(p/c);if(0===u&&0===p)return o.setState({...o.state,temporaryRatios:{}}),{leftColumnNewRatio:a,rightColumnNewRatio:l};{const e=1/(8*t.getContentLength());let n=Math.round(m/e)*e,s=f+(m-n);return n<e&&(n=e,s=a+l-e),s<e&&(s=e,n=l+a-e),o.setState({...o.state,temporaryRatios:{[r.id]:n,[i.id]:s}}),{leftColumnNewRatio:n,rightColumnNewRatio:s}}}};var On=n(6685);function Zn(e){window.__c={n:"ColumnDraggableDivider"};const t=(0,a.qz)(e.mouseStore,_e.Z),{canDrag:n,columnList:o,leftColumn:r,rightColumn:s,columnListStore:c}=e,d=(0,y.O7)(),u=(0,i.useCallback)((e=>{n&&(e.preventDefault(),function(e){const{environment:t,columnListStore:n,leftColumn:o,rightColumn:r}=e,i=Dn.R.getRect(o),a=Dn.R.getRect(r);i&&a&&(n.setState({dragging:!0,temporaryRatios:{},leftColumnStartWidth:i.width,leftColumnStartRatio:o.getColumnRatio(),rightColumnStartWidth:a.width,rightColumnStartRatio:r.getColumnRatio()}),ve.ZH(t),be.ZH(t))}({environment:d,columnListStore:c,leftColumn:r,rightColumn:s}),ve.ZH(d),be.sD())}),[n,d,r,c,s]),p=(0,i.useCallback)((e=>{n&&Fn({columnListBlockStore:o,columnListStore:c,leftColumn:r,rightColumn:s,diffX:e.diffX})}),[n,o,c,r,s]),m=(0,i.useCallback)((e=>{Nt.createAndCommit({userAction:"ColumnDivider.handleDragEnd",environment:d,perform:t=>{n&&function(e){const{environment:t,columnListStore:n,transaction:o,leftColumn:r,rightColumn:i}=e,a=Fn(e);if(a){const{leftColumnNewRatio:e,rightColumnNewRatio:s}=a;xn.FH({stores:[r],update:{column_ratio:e},transaction:o}),xn.FH({stores:[i],update:{column_ratio:s},transaction:o}),n.state.dragging&&n.setState({...n.state,temporaryRatios:{}}),En.wy(t)}}({environment:d,columnListBlockStore:o,columnListStore:c,leftColumn:r,rightColumn:s,diffX:e.diffX,transaction:t})}}),Bn({columnListStore:c})}),[n,o,c,d,r,s]),f=(0,i.useCallback)((()=>{Bn({columnListStore:c})}),[c]),g=(0,i.useCallback)((()=>{Nt.createAndCommit({userAction:"ColumnDivider.handleDoubleClick",environment:d,perform:e=>{n&&function(e){const{columnListBlockStore:t,transaction:n,environment:o}=e,r=1/t.getContentLength();xn.FH({stores:t.getContentStores(),update:{column_ratio:r},transaction:n}),En.n2(o)}({environment:d,columnListBlockStore:o,transaction:e})}})}),[n,o,d]);return n?(0,l.jsx)(On.Z,{allowDragWhileTextEditing:!0,onDraggableDragStart:u,onDraggableDragMove:p,onDraggableDragEnd:m,onDraggableDragCancel:f,disableHorizontalEdgeScroll:!0,disableVerticalEdgeScroll:!0,render:e=>(0,l.jsx)(gn,{showHandle:!0,mouseStore:t,onDoubleClick:g,...e})}):(0,l.jsx)(gn,{mouseStore:t,showHandle:!1})}const Vn=i.memo(Zn),Un={display:"flex",position:"relative",flexGrow:1};class Nn extends ye.Z{constructor(){super(...arguments),this.storeTypes={columnListStore:Mn,blockResizerStore:m.Z},this.getChildrenLimit=this.createComputedStore((()=>{const{limitParents:e}=Pn.Z.state;let t;return this.props.store.findRecordStoreUIAncestor((n=>{const o=e.get(n);return!!o&&(t=o[this.props.store.id],!0)})),t})),this.isColumnListResizableStore=this.createComputedStore((()=>this.props.store.canEdit()&&(0,ln.Po)(this.props.store,this.environment)))}getChildContext(){return{...this.context,isInColumnList:!0}}renderPersisted(){const{disabled:e}=this.props,t=this.stores.columnListStore.state,n=this.getChildrenLimit.state;let o=this.props.store.getContentStores();rn.hj(n)&&(o=rn.tP(o,0,n));let r=o.map(((e,n)=>{let o;return o=t.dragging&&t.temporaryRatios.hasOwnProperty(e.id)?t.temporaryRatios[e.id]:e.getColumnRatio(),o}));const i=rn.Sm(r);r=rn.UI(r,(e=>e/i));const a=[];return o.forEach(((t,n)=>{const i=0===n,s=n===o.length-1;a.push((0,l.jsx)(bn,{store:t,isFirstItem:i,isLastItem:s,numColumns:o.length,ratio:r[n],disabled:e,columnListStore:this.props.store},t.id)),s||a.push((0,l.jsx)(Vn,{canDrag:this.canEdit(),columnList:this.props.store,leftColumn:t,rightColumn:o[n+1],columnListStore:this.stores.columnListStore},`divider${t.id}`))})),this.renderContainer(a)}renderContainer(e){return this.isColumnListResizableStore.state?(0,l.jsx)("div",{style:Hn(this.props.store,this.stores.blockResizerStore),children:(0,l.jsxs)("div",{style:Un,children:[(0,l.jsx)(An.ZP,{disabled:!this.canEdit(),blockResizerStore:this.stores.blockResizerStore,resizeComponent:this,resizerType:An.IS.Horizontal,resizerAlignment:An.bZ.Left,preserveScale:!0,resizeHorizontally:!0,resizeVertically:!1,store:this.props.store,children:(0,l.jsx)("div",{style:jn("left"),children:(0,l.jsx)(gn,{onDoubleClick:()=>qn(this.props.store,this.environment),showHandle:this.canEdit()})})},"divider-left-edge"),e,(0,l.jsx)(An.ZP,{disabled:!this.canEdit(),resizeComponent:this,resizerType:An.IS.Horizontal,resizerAlignment:An.bZ.Right,preserveScale:!0,resizeHorizontally:!0,resizeVertically:!1,store:this.props.store,blockResizerStore:this.stores.blockResizerStore,children:(0,l.jsx)("div",{style:jn("right"),children:(0,l.jsx)(gn,{onDoubleClick:()=>qn(this.props.store,this.environment),showHandle:this.canEdit()})})},"divider-right-edge")]})}):(0,l.jsx)("div",{style:zn(this.props.store,this.environment),children:e})}handleCreated(){const{store:e}=this.props,t=e.getContentStores()[0];if(t&&t.getType()===Cn.Ti.column){const e=t.getContentStores()[0];e&&e.getType()===Cn.Ti.text&&(ve.eP({environment:this.environment,store:e}),be.N_({store:e.getBlockTitleStore()}))}}}Nn.contextTypes=In.w,Nn.childContextTypes={isInColumnList:kn().any,...In.w};const Ln=Nn;function jn(e){return{display:"flex",position:"absolute",top:0,bottom:0,right:"left"===e?"100%":"auto",left:"right"===e?"100%":"auto"}}function zn(e,t){const n={display:"flex"};return(0,ln.zE)(e,t)||(n.display="block"),n}function qn(e,t){Nt.createAndCommit({userAction:"ColumnList.handleResizeDoubleClick",environment:t,perform:t=>{if(e.canEdit()){const n=!e.getFormat().block_full_width;xn.FH({stores:[e],transaction:t,update:{block_full_width:n}})}}})}function Hn(e,t){const n={position:"relative",transition:"padding 0.2s linear"},o=Boolean(e.getFormat().block_full_width);return(o&&t.state.dragging?t.state.temporaryFullWidth:o)&&(n.paddingLeft=mn.width,n.paddingRight=mn.width),n}var Wn=n(91948);function Kn(e,t){window.__c={n:"CopyIndicator"};const n=i.useRef(null),o=(0,S.yK)((()=>({root:{minHeight:"1.5em",display:"flex",alignItems:"center"},wrapper:{...Ne.ZD},progressBar:{flex:1,margin:"0 8px"}})),[]);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"copy_indicator",getNode:()=>n.current,getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(z.p,{allowSelectionWithin:!1,style:o.wrapper,ref:n,children:(0,l.jsxs)("div",{style:o.root,children:[(0,l.jsx)(Te.Z,{}),(0,l.jsx)("div",{style:o.progressBar,children:(0,l.jsx)(Wn.Z,{targetRecordId:e.store.id})})]})}))}const Gn=i.memo(i.forwardRef(Kn),d.Z),$n=(0,s.I)("deepnote",{viewBox:"0 0 92 92",svg:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("path",{fill:"#fff",d:"M0 0h92v92H0z"}),(0,l.jsx)("path",{fill:"#0265B4",fillRule:"evenodd",d:"M20 73h22.153l12.461-4.673-4.673-18.346-14.365 1.558L20 73z",clipRule:"evenodd"}),(0,l.jsx)("path",{fill:"#002868",fillRule:"evenodd",d:"M42.153 73s7.004-3.695 8.3-10.242c1.296-6.546-5.1-11.22-14.876-11.22 0-.172 8.582-12.114 8.582-12.114l20.84.605-4.622 24.407-8.628 6.74L42.153 73z",clipRule:"evenodd"}),(0,l.jsx)("path",{fill:"#3793EF",fillRule:"evenodd",d:"M20 44.615l17.307-25.614s.424.004 1.385 0c6.784-.03 34.268 1.315 34.268 25.467 0 27.57-30.807 28.53-30.807 28.53s12.865-2.463 12.865-14.687-11.619-13.696-19.095-13.696H20z",clipRule:"evenodd"})]})}),Qn=(0,u.defineMessages)({embedButtonText:{defaultMessage:"Embed Deepnote",id:"deepnoteBlock.embeds.button.label"}});function Yn(e,t){window.__c={n:"DeepnoteBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"deepnote",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:r,ref:o,store:e.store,iconSvg:$n,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with Deepnote blocks with public links",id:"deepnoteBlock.embeds.caption"}),embedButtonText:n.formatMessage(Qn.embedButtonText),urlInputPlaceholder:"https://deepnote.com/…",children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed Deepnote",id:"deepnoteBlock.placeholder"})}))}const Xn=i.memo(i.forwardRef(Yn),d.Z);var Jn=n(6404),eo=n(27724),to=n(61519);function no(e,t){let{store:n}=e;window.__c={n:"DividerBlock"};const o=(0,y.Fy)(),r=(0,y.O7)(),a=(0,i.useRef)(null),s=(0,S.yK)((e=>({root:{color:e.darkDividerColor,pointerEvents:"auto"}})),[]),c=(0,i.useCallback)((e=>{o.isMobile&&(ve.Ys({environment:r,store:n}),Jn.Qn({environment:r,stores:eo.default.state.stores,left:e.clientX,top:e.clientY,actionSectionGroupKey:"default",showInput:!0,analyticsFrom:"content_block_menu"}))}),[o.isMobile,r,n]);return(0,p.ez)(n,t,(0,i.useMemo)((()=>({renderedType:"divider",getNode:()=>a.current,getBlockStore:()=>n,handleCreated(){Nt.createAndCommit({userAction:"DividerBlock.handleCreated",environment:r,perform:e=>an.Bm({environment:r,targetStore:n,targetParentStore:n.getRecordStoreUIParent(),isAtStartOfLine:!1,isClick:!1,transaction:e})})}})),[r,n]),(0,l.jsx)(to.Z,{className:P.QSt,size:13,style:s.root,onClick:c,ref:a}))}const oo=i.memo(i.forwardRef(no),d.Z);var ro=n(4708);function io(e,t){window.__c={n:"DrawingBlock"};const n=(0,i.useRef)(null),o=(0,y.Fy)(),r=(0,y.O7)(),a=(0,ro.A3)()?{source:"https://www.notion.so/product/drawing"}:{};return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"drawing",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store,handleCreated(){be.ZH({device:o}),ve.Z5({environment:r,stores:[e.store],phase:eo.SelectionPhase.Editing})}})),[o,r,e.store]),(0,l.jsx)(f.ZP,{...e,...a,ref:n,mediaMenuTabs:[],disableMediaMenu:!0,preserveScale:!1,showURLInput:!1}))}const ao=i.memo(i.forwardRef(io),d.Z);var so=n(7057);const lo=(0,s.I)("googleDrive",{viewBox:"0 0 512 512",svg:(0,l.jsxs)("g",{children:[" ",(0,l.jsx)("path",{d:"M175.5,44.9c2.6,0,4.5,0,6.5,0c50.5,0,101,0.1,151.5-0.2c5.5,0,8.5,2,11,6.4c10.7,19,21.5,38,32.3,56.9   c13.2,23.2,26.5,46.4,39.8,69.5c14.8,25.9,29.8,51.6,44.6,77.5c11.9,20.7,23.6,41.6,35.4,62.4c1.5,2.6,5,5.2,3.5,7.8  c-0.8,1.4-5.6,0.6-8.5,0.6c-28.8-0.3-57.6-0.4-86.4-1.2c-19.7-0.6-39.3-0.3-58.9-0.8c-5.6-0.1-11.3-0.6-16.9-0.7   c-2.3,0-3.1-1.2-4-2.9c-9.7-17.9-19.4-35.7-29.2-53.6c-10.4-19.1-20.8-38.2-31.3-57.4c-11.5-21.2-23-42.4-34.5-63.5   c-11.6-21.3-23.3-42.6-34.9-64C188.7,69.7,182.3,57.6,175.5,44.9z"})," ",(0,l.jsx)("path",{d:"M97.1,474c1.6-6.5,5.5-10.8,8.3-15.6c14.5-25.3,29.3-50.3,43.9-75.5c8.6-14.9,17.1-29.8,25.5-44.8   c1.4-2.5,3.1-3.2,5.6-3.2c27.6,0.4,55.3,0.3,82.9,1.3c16.7,0.6,33.3,0.4,49.9,0.8c20.1,0.4,40.3,0.2,60.4,1.2  c13.8,0.6,27.6,0.4,41.4,0.7c29.3,0.5,58.6,0.8,87.9,1.2c1.4,0,3.2-0.7,4,1.1c0.5,1.3-0.4,2.4-1.2,3.6   c-10.4,16.3-20.8,32.7-31.2,49.1c-10.6,16.7-21.1,33.5-31.6,50.2c-5.3,8.4-10.6,16.7-15.6,25.2c-2.3,3.9-4.9,6.2-9.8,5.7   c-5.4-0.6-11-0.7-16.4-0.7c-99.3-0.1-198.6-0.2-297.9-0.3C101.3,474,99.4,474,97.1,474z"})," ",(0,l.jsx)("path",{d:"M9.8,326.3c1.1-5.3,4.5-9.5,7.1-14c14.3-25.7,28.9-51.2,43.3-76.8c9.7-17.1,19.5-34.3,29.2-51.4   c12.9-22.8,25.7-45.7,38.6-68.5c10.7-18.9,21.6-37.8,32.4-56.7c4.7-8.2,5.1-8.4,9.3-0.6c8.3,15.6,16.7,31.1,24.8,46.8  c6.1,11.9,12.6,23.7,18.9,35.5c7.2,13.6,14.5,27.2,21.7,40.7c2.2,4.2,4.3,8.6,6.8,12.7c1.3,2.1,0.9,3.4-0.3,5.4   c-16.2,27.3-32.2,54.7-48.4,81.9c-14,23.6-28.3,47-42.3,70.6c-16.4,27.5-32.6,55.1-49,82.6c-6.6,11.2-13.3,22.4-20,33.6   c-0.6,1.1-0.8,2.8-2.5,2.7c-1.6-0.1-2-1.7-2.6-2.8c-3.7-7.6-7.3-15.2-10.9-22.8c-6.9-14.7-13.9-29.3-20.9-44   c-9-18.8-18-37.5-27-56.3c-2.3-4.8-4.5-9.6-6.8-14.3C10.6,329.2,9.7,328,9.8,326.3z"})," "]})});var co=n(91584),uo=n(9953),po=n(68422),mo=n(63085),fo=n(28415);class go extends Ge.default{getInitialState(){return{error:!1,loading:!1}}}const ho=go,vo={display:"block",width:"100%",height:"100%",objectFit:"cover",objectPosition:"top"},bo={position:"absolute",top:0,left:0,right:0,bottom:0},yo={display:"block",position:"relative",width:"100%",paddingBottom:"55%"},_o=(0,u.defineMessages)({menuTitle:{defaultMessage:"Embed",id:"googleDriveBlock.mediaMenuActions.embedTab.title"}});class So extends ye.Z{constructor(){super(...arguments),this.captionAriaId=(0,ie.Z)(),this.storeTypes={mouseStore:_e.Z,driveStore:ho},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter=e=>{return t=this.stores.mouseStore,void(U.Z.state.isDragging||L.default.state.isActive||t.setState({...t.state,mouseEntered:!0}));var t},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave=e=>{return t=this.stores.mouseStore,void(U.Z.state.isDragging||L.default.state.isActive||t.setState({...t.state,mouseEntered:!1}));var t},this.openMenu=()=>{const{device:e}=this.environment;if(this.canEdit()){const t=re.findDOMNode(this);if(t&&t instanceof Element){const n=t.getBoundingClientRect();ge.$(this.environment,{originRect:n,originGap:0,isSmallWidth:!1,showArrow:!0,currentTab:e.isMobile?"embed":"drive",tabs:this.mediaPickerTabs(),title:E.default.formatMessage(_o.menuTitle),popupWidth:320,maxHeight:420})}}}}handleCreated(){this.openMenu()}didMount(){super.didMount();const e=this.props.store.getFormat();e&&e.drive_properties&&e.drive_properties.file_id&&e.drive_status&&e.drive_status.last_fetched+5*ue.hM<Date.now()&&co.WO(this.environment,{id:this.props.store.id,spaceId:(0,Je.C)(this.props.store.pointer.spaceId)})}renderPersisted(){const e=this.props.store.getProperties(),t=this.props.store.getFormat();return t&&t.drive_properties&&t.drive_status?this.renderBlock(t.drive_properties):e&&e.source?(0,l.jsx)(Do,{...this.props}):this.renderPlaceholder()}renderBlock(e){const t=e.url;return(0,l.jsxs)("div",{role:"figure","aria-labelledby":this.captionAriaId,children:[(0,l.jsxs)("div",{style:{display:"flex"},children:[(0,l.jsxs)(xe.Z,{href:t,external:!0,style:(n=this.theme,{display:"flex",flexDirection:"column",width:"100%",border:`1px solid ${n.darkDividerColor}`,borderRadius:4,position:"relative"}),onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,onMouseEnter:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter,children:[(0,l.jsx)(Ro,{store:this.props.store,driveStore:this.stores.driveStore,fileData:e}),(0,l.jsx)(Ao,{fileData:e}),Eo(this.environment,this.stores.mouseStore)&&this.canEdit()&&(0,l.jsx)(Co,{store:this.props.store})]}),(0,l.jsx)(Ie.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]}),(0,l.jsx)(ke.Z,{store:this.props.store,captionAriaId:this.captionAriaId,disabled:this.props.disabled})]});var n}renderPlaceholder(){const{disabled:e}=this.props,t=this.props.store.getFormat().drive_status,n=!(!t||!t.authed);return(0,l.jsxs)("div",{onMouseEnter:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter,onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,style:{display:"flex"},children:[(0,l.jsx)(Ae.Z,{iconSvg:lo,disabled:e,shouldHideRight:!Eo(this.environment,this.stores.mouseStore),right:this.canEdit()&&(0,l.jsx)(we.Z,{store:this.props.store,fadeIn:!1}),onClick:this.openMenu,isLoading:this.stores.driveStore.state.loading,progressPercent:0,children:n?(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Choose a file to embed from Google Drive",id:"googleDriveBlock.placeholder.authenticated"}):(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Connect Google Drive to Notion to embed a file",id:"googleDriveBlock.placeholder.notAuthenticated"})}),(0,l.jsx)(Ie.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}async initializeGoogleDriveBlockFromUrl(e){const t=mo.id(e);if(!t)return void ko(e,this.props.store,this.environment);const n=await co.Ui({environment:this.environment,store:this.props.store,fileId:t});n&&n.auth_error&&(co.cR(this.environment,{onSuccess:e=>{Bo(t,e,this.environment,this.props.store,this.stores.driveStore)},onFailure:()=>{ko(e,this.props.store,this.environment)}}),Io("url_embed",this.environment))}mediaPickerTabs(){const{device:e}=this.environment,t=[];return t.push({type:"embed",caption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with any file in your Google Drive",id:"googleDriveBlock.embedTab.caption"}),buttonText:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed Google Drive file",id:"googleDriveBlock.embedTab.embedButton.label"}),onChange:e=>{ge.Z(),this.initializeGoogleDriveBlockFromUrl(e)}}),e.isMobile||t.push({type:"drive",title:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Browse Google Drive",id:"googleDriveBlock.mediaPicker.googleDriveTab.title"}),onSelect:async e=>{if(ge.Z(),e&&e.token)Fo(e.token,this.environment,this.props.store,this.stores.driveStore),pe.uu(this.environment);else{const e=await co.qN(this.environment);e&&e.token&&Fo(e.token,this.environment,this.props.store,this.stores.driveStore),Io("drive_file_picker",this.environment)}}}),t}}const wo=So;function ko(e,t,n){Nt.createAndCommit({userAction:"DriveBlock.convertToTextBlock",environment:n,perform:o=>{uo.sW({store:t.getPropertiesStore(),data:{title:[ce.V3y(e,[ce.edl(e)])]},transaction:o}),po.Cj({environment:n,blocks:[t],blockType:"text",transaction:o})}})}function Io(e,t){pe.SO(t,{integration_name:"google",from:e})}function Co(e){let{store:t}=e;window.__c={n:"ActionMenuButton"};const n=(0,y.O7)();return(0,l.jsx)(we.Z,{store:t,style:{position:"absolute",top:4,right:4,background:(0,f.M1)(n)},iconStyle:{fill:w.ZP.white},fadeIn:!0})}function xo(e){return{...yo,paddingBottom:"20%",minHeight:80,background:e.embedPlaceholderBackground}}function To(e){return{width:"100%",minHeight:60,padding:14,paddingTop:12,overflow:"hidden",borderTop:`1px solid ${e.darkDividerColor}`}}function Mo(e){return{fontSize:12,lineHeight:1.3,color:e.mediumTextColor,maxHeight:32,overflow:"hidden"}}function Po(e){let{fileData:t}=e;window.__c={n:"DescriptionComponent"};const n=(0,S.Fg)(),o=t.user_name||t.modified_time?(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Last modified {hasUserName, select, true {by {userName}} other {}} {hasLastModifiedTime, select, true {{lastModifiedTime}} other {}}",id:"googleDriveBlock.pageDescription",values:{hasUserName:Boolean(t.user_name),userName:t.user_name,hasLastModifiedTime:Boolean(t.modified_time),lastModifiedTime:t.modified_time&&(0,so.tv)(t.modified_time,b.SP)}}):void 0;return(0,l.jsxs)("div",{style:Mo(n),children:[t.trashed&&(0,l.jsx)(u.FormattedMessage,{defaultMessage:"This file is in trash.",id:"googleDriveBlock.pageDeleted.caption"}),o]})}function Ao(e){let{fileData:t}=e;window.__c={n:"FileComponent"};const n=(0,S.Fg)(),o=t.title,r=t.url,i=de.Qc(r).hostname;return(0,l.jsxs)("div",{style:To(n),children:[o&&(0,l.jsx)(Pe.Z,{style:{marginBottom:2},children:o}),(0,l.jsx)(Po,{fileData:t}),(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center",marginTop:6},children:[t.icon&&(0,l.jsx)("div",{style:(a=t.icon,{flexShrink:0,backgroundImage:`url(${a})`,backgroundSize:"cover",width:16,height:16,marginRight:6})}),(0,l.jsx)(Pe.Z,{style:{color:n.regularTextColor},isSmall:!0,children:i})]})]});var a}function Ro(e){let{fileData:t,store:n,driveStore:o}=e;window.__c={n:"ThumbnailComponent"};const r=(0,S.Fg)(),i=(0,a.qz)(o,ho),s=t.thumbnail,c=(0,a.VK)((()=>i.state.error),[i]);return s&&!c?(0,l.jsx)("div",{style:yo,children:(0,l.jsx)("div",{style:bo,children:(0,l.jsx)(Me.Z,{url:s,width:1e3,isAuthenticated:!0,permissionRecord:n.pointer,render:(e,n)=>{if(n){const e=de.SK(n,{v:t.version});return(0,l.jsx)("img",{src:e,style:vo,onError:e=>{i.setState({error:!0,loading:!1})}})}e&&i.setState({error:!0,loading:!1})}})})}):(0,l.jsx)("div",{style:xo(r)})}function Do(e){return(0,l.jsx)(f.ZP,{...e,iconSvg:lo,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with Google Docs, Google Sheets…",id:"googleDriveBlock.legacyLinkInput.caption"}),children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed a file from Google Drive",id:"googleDriveBlock.legacy.placeholder"})})}function Eo(e,t){const{device:n}=e;return n.isMobile||t.state.mouseEntered}async function Bo(e,t,n,o,r){r.setState({loading:!0,error:!1});const i=await co.Ui({environment:n,store:o,fileId:e,token:t});r.setState({loading:!1,error:!i||!!i.auth_error})}function Fo(e,t,n,o){fo.vE({environment:t,accessToken:e.accessToken,callback:r=>{Bo(r,e,t,n,o)}})}const Oo=(0,s.I)("tex",{viewBox:"0 0 32 21",svg:(0,l.jsxs)("g",{children:[" ",(0,l.jsxs)("g",{id:"d7fc5246-3c04-467c-8f25-6c129c5642ac","data-name":"tex",children:[" ",(0,l.jsxs)("g",{id:"ec363c67-067d-4da0-8c27-f8d029e068bd","data-name":"E",children:[" ",(0,l.jsx)("path",{id:"e1948427-1829-4c96-a9f4-14a99a3d5b97","data-name":"path0 fill",d:"M497.33,497.82c-1.2,0-2.11-.06-3-0.06a0.5,0.5,0,0,0-.55.27c0,0.15.17,0.23,0.57,0.32a1.08,1.08,0,0,1,1.06,1.23c0,0.55,0,1,0,3.32s-0.08,4.43-.13,5.21c-0.08,1-.42,1.2-1.39,1.41a0.59,0.59,0,0,0-.53.32c0,0.21.23,0.25,0.59,0.25,0.7,0,1.08-.09,2.13-0.09,2.76,0,6,.13,6.21.13a0.7,0.7,0,0,0,.36-0.21,14.63,14.63,0,0,0,.68-2.07c0-.21,0-0.53-0.15-0.53a0.78,0.78,0,0,0-.48.55,2.41,2.41,0,0,1-1.54,1.41,9,9,0,0,1-1.8.15,10.57,10.57,0,0,1-1.69-.13,0.74,0.74,0,0,1-.38-0.44,7,7,0,0,1-.15-1.56c0-.78,0-2.49.06-2.93a0.26,0.26,0,0,1,.17-0.17c0.53,0,1.29,0,1.9,0,1.06,0.06,1.18.13,1.44,1a0.52,0.52,0,0,0,.32.4c0.15,0,.23-0.19.23-0.53s-0.06-.68-0.06-1.2,0-.84.06-1.35c0-.17,0-0.46-0.17-0.46a0.54,0.54,0,0,0-.36.42c-0.34.87-.38,0.93-2.09,0.93h-1.27a0.18,0.18,0,0,1-.17-0.17c0-.44,0-3.84.08-4.29a0.5,0.5,0,0,1,.27-0.55,21.09,21.09,0,0,1,2.7.1,1.4,1.4,0,0,1,1.25,1.31,0.54,0.54,0,0,0,.3.47,0.46,0.46,0,0,0,.3-0.51c0-.38,0-1.08,0-1.84a0.28,0.28,0,0,0-.17-0.23,14.12,14.12,0,0,1-1.75.08h-2.81Z",transform:"translate(-484.44 -490.06)"})," "]})," ",(0,l.jsxs)("g",{id:"8dfbf0a9-85f0-49da-99d8-6229354b9534","data-name":"T",children:[" ",(0,l.jsx)("path",{id:"8602b8e9-f5d6-42d3-88c6-0649b350ce04","data-name":"path1 fill",d:"M490.48,490.82c-2.18,0-3.91-.06-4.39-0.11a1.32,1.32,0,0,1-.68-0.34,0.85,0.85,0,0,0-.3-0.3,0.39,0.39,0,0,0-.28.32,19.85,19.85,0,0,1-.38,2.55,0.4,0.4,0,0,0,.23.42c0.08,0,.19,0,0.38-0.42a5.64,5.64,0,0,1,.61-1,1.72,1.72,0,0,1,1.35-.44c0.32,0,1.94,0,2.3.09a0.26,0.26,0,0,1,.17.25v2.26c0,1.46-.09,5.3-0.13,6.44-0.06,1.41-.11,1.71-1.41,2a0.47,0.47,0,0,0-.38.34c0,0.11.19,0.23,0.57,0.23s1.33-.13,2.22-0.13,2.13,0.1,2.28.1,0.53,0,.53-0.25a0.65,0.65,0,0,0-.49-0.34c-1.22-.25-1.31-0.53-1.39-1.33s-0.1-2.6-.1-4.81c0-1.63,0-3.61,0-4.5a0.35,0.35,0,0,1,.15-0.25c0.29-.06,2.26-0.06,2.6,0,1.12,0.06,1.37.15,1.5,1.16,0.06,0.48.15,0.61,0.28,0.61a0.43,0.43,0,0,0,.32-0.38,11.69,11.69,0,0,1,.42-2.2c0.1-.27,0-0.44-0.09-0.44a0.72,0.72,0,0,0-.28.13,2.49,2.49,0,0,1-1.33.32C494,490.8,491.49,490.82,490.48,490.82Z",transform:"translate(-484.44 -490.06)"})," "]})," ",(0,l.jsxs)("g",{id:"88168da7-a35d-4a6e-af2a-2bab78b9d062","data-name":"X",children:[" ",(0,l.jsx)("path",{id:"f33958e3-fb20-476c-b2a8-674ffe821a96","data-name":"path2 fill",d:"M504,491a0.52,0.52,0,0,0,.51.36,3,3,0,0,1,1.84,1.14,53.54,53.54,0,0,1,3,4.73,0.22,0.22,0,0,1-.06.27c-1.14,1.58-2.22,2.87-3,3.72a4.47,4.47,0,0,1-2.22,1.27c-0.51.1-.7,0.27-0.7,0.44s0.15,0.21.51,0.21,1.2-.1,2-0.1c0.61,0,1.48.06,2,.06,0.25,0,.46-0.08.46-0.27a0.53,0.53,0,0,0-.46-0.32c-0.74-.27-1-0.47-0.17-1.82,0.53-.78,1.44-2,2.05-2.72a0.15,0.15,0,0,1,.19,0c0.23,0.21,2.09,3.17,2.53,4a0.26,0.26,0,0,1-.08.34,3.18,3.18,0,0,1-.68.23c-0.32.11-.42,0.19-0.42,0.34s0.11,0.25.47,0.25,1-.08,1.58-0.08c1.12,0,2.17.11,2.79,0.11,0.42,0,.57-0.09.57-0.25a0.49,0.49,0,0,0-.44-0.36,3.37,3.37,0,0,1-2.34-1.73c-0.49-.67-2.7-4-2.83-4.31a0.45,0.45,0,0,1,0-.23c0.91-1.27,2.17-2.7,2.85-3.52a3.79,3.79,0,0,1,2.38-1.41,0.5,0.5,0,0,0,.44-0.34,0.44,0.44,0,0,0-.46-0.21c-0.44,0-1.56.06-2,.06s-1.12,0-1.69,0c-0.36,0-.53.1-0.53,0.25a0.49,0.49,0,0,0,.48.34c0.67,0.13,1,.34.72,0.89a32.86,32.86,0,0,1-2.53,3.44,0.14,0.14,0,0,1-.19,0,33.44,33.44,0,0,1-2.3-3.63c-0.21-.38,0-0.59.34-0.68s0.46-.21.46-0.36a0.43,0.43,0,0,0-.47-0.21c-0.55,0-.91,0-1.63,0s-2-.1-2.39-0.1S504,490.84,504,491Z",transform:"translate(-484.44 -490.06)"})," "]})," "]})," "]})});var Zo=n(993),Vo=n(83631),Uo=n(3702),No=n(22492),Lo=n(40148);class jo extends ye.Z{constructor(){super(...arguments),this.storeTypes={mouseStore:_e.Z,focusStore:Ge.default.createClass(!1),buttonPopupStore:Se.Z},this.renderOrigin=()=>{const{device:e}=this.environment,{store:t}=this.props,n=qo(this.props.store);let o,r={};n?o=(0,l.jsx)(No.Z,{display:"block",equation:n,style:this.getContainerStyle(!1),errorStyle:this.getContainerStyle(!0),theme:this.theme}):(o=(0,l.jsx)(Lo.ZP,{iconSvg:Oo,iconStyle:{width:28,height:28,marginRight:8},style:{background:void 0},children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Add a TeX equation",id:"equationBlock.empty.placeholder"})},"button"),r={background:this.theme.sidebarBackground});const i=e.isMobile||this.stores.mouseStore.state.mouseEntered||this.stores.focusStore.state;return(0,l.jsxs)(H.Z,{onMouseMove:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove,onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,onClick:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleOpen,style:{position:"relative",width:"100%",borderRadius:4,...r},children:[o,this.canEdit()&&(0,l.jsx)(we.Z,{onFocus:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleFocus,onBlur:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBlur,store:t,tooltipContent:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Rename, delete, and more…",id:"equationBlock.actions.tooltip"}),style:{position:"absolute",top:4,right:4,color:this.theme.mediumTextColor,opacity:i?1:0},fadeIn:!1})]})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleOpen=()=>Ho(this.stores.buttonPopupStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleClose=()=>Wo(this.environment,this.props.store,this.stores.buttonPopupStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove=e=>{var t;(t=this.stores.mouseStore).setState({...t.state,mouseEntered:!0})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave=e=>{var t;(t=this.stores.mouseStore).setState({...t.state,mouseEntered:!1})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleFocus=e=>function(e,t){const n=e.target;n instanceof HTMLElement&&(0,Ke.E)(n)&&t.setState(!0)}(e,this.stores.focusStore),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleBlur=()=>{this.stores.focusStore.setState(!1)}}handleCreated(){Ho(this.stores.buttonPopupStore)}edit(){Ho(this.stores.buttonPopupStore)}activate(){this.stores.buttonPopupStore.state.open?Wo(this.environment,this.props.store,this.stores.buttonPopupStore):Ho(this.stores.buttonPopupStore)}renderPersisted(){const e=qo(this.props.store),t=this.stores.buttonPopupStore.state.open?{isOpen:!0,equationValue:e,error:Vo.by({environment:this.environment,equation:e,displayMode:"block"})}:{isOpen:!1,equationValue:void 0,error:void 0},n=!this.canEdit(),o=this.renderOrigin();return(0,l.jsxs)(z.p,{allowSelectionWithin:!0,style:{display:"flex",position:"relative"},children:[(0,l.jsx)(F.DependencyConsumer,{dependency:F.deps.prismjs,children:e=>(0,l.jsx)(Uo.Z,{...t,Prism:e,displayMode:"block",disabled:n,origin:o,onDismiss:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleClose,onChange:e=>function(e,t,n){Nt.createAndCommit({userAction:"EquationBlock.handleChange",environment:n,perform:o=>{Zo.sO({environment:n,store:t.getBlockTitleStore(),value:ce.TPx(e),transaction:o})}})}(e,this.props.store,this.environment),onSubmit:()=>{return e=this.props.store,t=this.environment,void En.Py(t,{equation:qo(e)});var e,t}})}),(0,l.jsx)(Ie.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]})}getContainerStyle(e){const t={display:"flex",padding:"4px 8px",width:"100%"};return qo(this.props.store)?(t.flexDirection="column",t.overflow="auto"):t.color=w.ZP.contentPlaceholder,e&&(t.background=this.theme.equationErrorPlaceholderBackground),{...t,...this.getBlockColorStyle()}}}const zo=jo;function qo(e){const t=e.getBlockTitleStore().getValue();return ce.Jcv(t)}function Ho(e){e.setState({...e.state,open:!0})}function Wo(e,t,n){n.setState({...n.state,open:!1}),ve.Ys({environment:e,store:t})}const Ko=(0,s.I)("excalidraw",{viewBox:"0 0 32 32",svg:(0,l.jsxs)("g",{children:[(0,l.jsx)("path",{d:"m14.2933 1.41174c-.8308.66246-2.1108 1.78526-3.1214 2.75088l-.7972.75228.146.98807c.0786.53895.2246 1.59439.3144 2.33544.101.74105.2021 1.43719.2358 1.53825.0449.13473 0 .2021-.1235.2021-.2134 0-.2246-.05614.3593 1.79654.2133.7073.4154 1.3586.4379 1.4259.0224.0786.1122.1123.2133.0786.1011-.0449.1572-.1347.1235-.2133-.0337-.0898.0225-.1797.1123-.2133.1235-.045.1123-.1348-.0786-.4604-.3032-.5053-1.0779-4.81685-1.1228-6.20913-.0337-.98807-.0337-.9993.3817-1.5607.4043-.55018 1.3362-1.38105 2.7734-2.43649.4042-.30316.8084-.64.9207-.75228.1684-.20211.247-.14597 1.6617 1.35859.8197.86456 1.7292 1.75158 2.0211 1.97614l.5389.40422-.4154.87579c-.2246.47157-1.134 2.29052-2.0323 4.01966-1.8751 3.6379-1.4933 3.2898-3.6716 3.3235l-1.4147.0112-.4716.539c-.494.5726-.5614.7859-.3256 1.1452.0898.1235.1572.3257.1572.4492 0 .2021.0786.2358.5277.2582.2807.0112.539.0449.5726.0786.0337.0337.0786.7298.1123 1.5495l.0449 1.4821-.7522 1.6168c-1.2464 2.6948-1.74039 3.9299-1.74039 4.3341 0 .2133.04491.3929.08982.3929.11227 0 .11227-.0112 4.68207-9.5438 2.1221-4.4239 4.132-8.5895 4.4688-9.27441.3369-.68491.64-1.31369.6625-1.40351.0224-.10105-.7523-.87579-1.9874-1.96491-1.1116-.98807-2.0884-1.88632-2.1782-1.98737-.2583-.314389-.64-.213336-1.325.33684zm.3818 12.91226c-.5165.9993-.539 1.0106-1.9537 1.0779-1.2463.0674-1.2688.0562-1.2688-.1796 0-.1348-.0449-.3144-.101-.4042-.0674-.1011-.0225-.2807.1347-.5278l.247-.3817h1.1228c.6176-.0112 1.325-.0562 1.572-.1011s.4603-.0673.4828-.0561c.0224.0112-.0898.2695-.2358.5726zm-.9432 1.7965c-.0898.2358-.3256.7298-.5165 1.1004-.3143.6287-.348.6512-.4266.393-.0449-.1572-.0786-.6176-.0898-1.033-.0113-.8197-.0337-.8084.9094-.8646l.3032-.0112z"}),(0,l.jsx)("path",{d:"m14.6302 4.08401c-.2021.14597-.2583.29193-.2583.66246 0 .43789.0337.50526.3369.62877s.3817.11228.7298-.12351c.4604-.31439.4716-.39298.1348-.89824-.292-.4379-.5839-.51649-.9432-.26948zm.64.40421c.1796.31439.0674.55018-.2695.55018-.3031 0-.4379-.30316-.2695-.60632.1348-.24701.393-.22456.539.05614z"}),(0,l.jsx)("path",{d:"m21.6702 6.61034c0 .05614-.0674.11228-.146.11228-.0674 0-.2582.31439-.4042.69614-.4491 1.16772-4.9404 10.04914-4.9516 9.76844 0-.146-.0673-.247-.1796-.247-.1572 0-.1797.0898-.1123.5277.0674.5053.0224.6175-1.5719 3.7165-.8983 1.7628-1.8639 3.6042-2.1446 4.0982-.2919.5165-.5165 1.0779-.5389 1.3137-.0337.4042.0112.4604.988 1.3025.5614.494 1.28 1.1115 1.5944 1.3922 1.4147 1.2913 2.0772 1.8078 2.2569 1.7741.2694-.0449 4.435-4.4127 4.4463-4.6597 0-.1122-.2021-1.8189-.4492-3.7951-.4266-3.3684-.8308-7.3094-.7859-7.6912.0337-.2358-.1348-1.4259-.2583-1.9424-.101-.4043-.0561-.5727.7523-2.4141.4716-1.0891 1.0891-2.42524 1.3586-2.96419.2583-.53894.4828-1.01052.4828-1.04421 0-.03368-.0786-.05614-.1684-.05614s-.1684.04492-.1684.11228zm-2.5825 8.38736c.1235.786.3705 2.6723.5502 4.1881.3481 2.7845.7523 5.8723.8646 6.6582.0673.393.0224.4716-.7074 1.28-1.2688 1.426-2.6162 2.8295-3.0765 3.1888l-.4267.3368-2.1894-2.0435c-2.0211-1.8638-2.1895-2.0547-2.066-2.2793.0674-.1235.64-1.1677 1.2688-2.3129.6287-1.1453 1.4596-2.6723 1.8414-3.3909.3929-.7299.7522-1.3586.8196-1.3923.0786-.0449.1011 1.0891.0786 3.5032-.0449 3.6042-.0337 3.6154.3256 3.5368.0449 0 .0786-1.819.0786-4.0309v-4.0196l1.179-2.3579c.6512-1.3025 1.1901-2.3467 1.2126-2.3355.0225.0113.1347.6737.247 1.4709z"})]})}),Go=(0,u.defineMessages)({embedButtonText:{defaultMessage:"Embed Excalidraw",id:"excalidrawBlock.embeds.button.label"}});function $o(e,t){window.__c={n:"ExcalidrawBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"excalidraw",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:r,ref:o,store:e.store,iconSvg:Ko,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with Excalidraw whiteboards.",id:"excalidrawBlock.embeds.caption"}),embedButtonText:n.formatMessage(Go.embedButtonText),urlInputPlaceholder:"https://excalidraw.com/…",children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed Excalidraw",id:"excalidrawBlock.placeholder"})}))}const Qo=i.memo(i.forwardRef($o),d.Z);var Yo=n(14562),Xo=n(13797),Jo=n(47453),er=n(81193),tr=n(95802),nr=n(26664),or=n(54532),rr=n(42858);var ir=n(52315);class ar extends Ge.default{getInitialState(){return{open:!1}}}const sr=ar;var lr=n(79797),cr=n(34583),dr=n(42922),ur=n(23189),pr=n(13490);const mr=function(e){let{store:t,origin:n,title:o,properties:r}=e;window.__c={n:"Configurable"};const s=(0,S.Fg)(),c=(0,a.qz)(t,sr),d=(0,i.useCallback)((()=>{c.setState({...c.state,open:!1})}),[c]);return(0,a.VK)((()=>c.state.open),[c])?(0,l.jsxs)("div",{style:{flexGrow:1,minWidth:0},children:[n,(0,l.jsxs)("div",{style:{position:"relative",boxShadow:`inset 0 0 0 1px ${s.regularDividerColor}`,padding:12,borderRadius:4,overflow:"hidden"},children:[(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,l.jsx)(ur.Z,{style:{flex:1,marginRight:16,marginBottom:0},children:o}),(0,l.jsx)(dr.Z,{onClick:d,children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Close",id:"factoryBlock.configureMenu.closeButton.label"})})]}),r.map(((e,t)=>(0,l.jsx)(fr,{args:e},t)))]})]}):n};function fr(e){let{args:t}=e;window.__c={n:"PropertyComponent"};const{title:n,subtitle:o,value:r}=t,i=(0,S.Fg)();return(0,l.jsxs)("div",{children:[(0,l.jsx)(to.Z,{size:36}),(0,l.jsx)(pr.Z,{children:n}),(0,l.jsx)(Pe.Z,{isSmall:!0,children:o}),(0,l.jsx)("div",{style:{marginTop:8,padding:6,background:i.sidebarBackground,borderRadius:4},children:r})]})}var gr=n(15201),hr=n(73063),vr=n(89728),br=n(26388);const yr={pointerEvents:"none",...C.Z.textOverflowStyle},_r=(0,u.defineMessages)({addNewItem:{defaultMessage:"Add a new item",id:"factoryBlock.newItem.button.label"},buttonPlaceholder:{defaultMessage:"Add a new item",id:"factoryBlock.newItem.button.placeholder"}});class Sr extends ye.Z{constructor(){super(...arguments),this.storeTypes={configurableStore:sr,mouseStore:_e.Z},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove=()=>{var e;(e=this.stores.mouseStore).setState({...e.state,mouseEntered:!0})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave=()=>{var e;(e=this.stores.mouseStore).setState({...e.state,mouseEntered:!1})},this.handleButtonClick=()=>{this.canEdit()&&cr.M_(this.environment)&&Nt.createAndCommit({userAction:"FactoryBlock.handleButtonClick",environment:this.environment,perform:e=>{!function(e){const{store:t,transaction:n,environment:o}=e,r=t.getRecordStoreUIParent();let i=!1;r&&r.valueIs(nr.i)&&rn.YM(r.getValue())!==t.id&&rn.Z$(r.getValue())===t.id&&(i=!0);const a=t.getContentStores().filter((e=>e.isDefined()));i||a.reverse();const s=tr.C.findSelectableFromStore(t),l=[],c=Promise.all(a.map((e=>new Promise((r=>{const a=e.getModel(),c=!a||!a.isTemplateVariableContainerBlock(),[d,u]=or.Qi({environment:o,stores:[e],transaction:n,addCopyName:!1,deepCopyTransclusionContainers:!1,resolveTemplateVariables:c,targetSpaceId:(0,Je.C)(e.pointer.spaceId),baseUrl:yt.default.domainBaseUrl,publicDomainName:yt.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:t.useCrdt()}),p=d[0];u.then((e=>{e&&fe.showErrorMessage(e),r()})),s&&(i?s.props.onInsertAbove&&s.props.canInsertAbove&&l.push(s.props.onInsertAbove({insertStores:[p],transaction:n})[0]):s.props.onInsertBelow&&s.props.canInsertBelow&&l.push(s.props.onInsertBelow({insertStores:[p],transaction:n})[0]))})))));i||l.reverse(),ve.Z5({environment:o,stores:l}),c.then((()=>{on.default.afterNextFlush((()=>{rr.DV({environment:o,insertedStores:l,isCreated:!0})}))}))}({environment:this.environment,store:this.props.store,transaction:e})}})},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleToggleConfigure=()=>kr(this.environment,this.stores.configurableStore)}UNSAFE_willMountOrUpdate(e){super.UNSAFE_willMountOrUpdate(e),ir.b(e.store)}handleCreated(){this.configure()}activate(){this.handleButtonClick()}configure(){this.stores.configurableStore.setState({...this.stores.configurableStore.state,open:!0})}renderPersisted(){const e=this.getDisabled();return(0,l.jsxs)(z.p,{allowSelectionWithin:!0,style:{display:"flex"},children:[(0,l.jsx)(mr,{title:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Configure template button",id:"factoryBlock.configureButton.label"}),origin:this.renderFactory(),store:this.stores.configurableStore,properties:[{title:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Button name",id:"factoryBlock.buttonName.title"}),subtitle:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"What should this button be called?",id:"factoryBlock.buttonName.subtitle"}),value:(0,l.jsx)($.Z,{disabled:e,store:(t=this.props.store,lr.G.createChildStore(t,t.pointer).getBlockTitleStore()),placeholder:E.default.formatMessage(_r.addNewItem),onEnter:rn.yR,pasteBehavior:"inline"})},{title:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Template",id:"factoryBlock.templateArea.title"}),subtitle:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Drop blocks here that you want to duplicate whenever the button is clicked.",id:"factoryBlock.templateArea.subtitle."}),value:(0,l.jsx)(gr.O,{displayName:"FactoryBlockContent",disabled:e,children:(0,l.jsx)(G.Z,{disabled:e,store:this.props.store.getContentStore(),emptyPlaceholder:(0,l.jsx)("div",{style:{caretColor:this.theme.regularTextColor,color:this.theme.regularTextColor},children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Empty. Drop blocks here…",id:"factoryBlock.emptyTemplate.placeholder"})}),disableCommentMenu:this.props.disableCommentMenu,disableHoverMenu:this.props.disableHoverMenu,disableDrag:this.props.disableDrag})})}]}),(0,l.jsx)(Ie.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store})]});var t}renderFactory(){const{device:e}=this.environment,t=this.getDisabled();return(0,l.jsxs)(vr.Z,{icon:Jo.R,isGray:!0,isLarge:!0,style:{fontSize:"inherit",width:"100%"},shouldShrink:!0,onClick:this.handleButtonClick,onMouseMove:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove,onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,disabled:t,children:[(0,l.jsx)($.Z,{disabled:!0,store:this.props.store.getBlockTitleStore(),placeholder:E.default.formatMessage(_r.buttonPlaceholder),style:yr,placeholderStyle:(n=this.theme,{width:"100%",display:"block",caretColor:n.regularTextColor,color:n.regularTextColor,...C.Z.textOverflowStyle})}),!t&&(e.isMobile||this.stores.mouseStore.state.mouseEntered)&&(0,l.jsxs)("div",{style:{display:"flex",alignItems:"center"},className:P.JiD,children:[!e.isMobile&&(0,l.jsx)(Ir,{configurableStore:this.stores.configurableStore}),(0,l.jsx)(we.Z,{tooltipContent:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"More actions…",id:"factoryBlock.moreActions.button.label"}),store:this.props.store,fadeIn:!0})]})]});var n}getDisabled(){return this.props.disabled||!this.canEdit()}}const wr=Sr;function kr(e,t){t.state.open?t.setState({...t.state,open:!1}):(er.PE(e,{from:"gear_button"}),t.setState({...t.state,open:!0}))}function Ir(e){let{configurableStore:t}=e;window.__c={n:"ConfigureButtonComponent"};const n=(0,y.O7)(),o=(0,i.useCallback)((()=>kr(n,t)),[n,t]);return(0,l.jsx)(br.ZP,{renderTooltip:()=>(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Configure template",id:"factoryBlock.configureTemplate.button.label"}),delayThreshold:300,render:e=>(0,l.jsx)(hr.Z,{icon:Xo.F,onClick:o,...e})})}const Cr=(0,s.I)("figma",{viewBox:"0 0 36 55",svg:(0,l.jsx)("path",{d:"M19.5,27.5 C19.5,23.08142 23.08142,19.5 27.5,19.5 C31.9186,19.5 35.5,23.08142 35.5,27.5 C35.5,31.9186 31.9186,35.5 27.5,35.5 C23.08142,35.5 19.5,31.9186 19.5,27.5 Z M0.5,46.5 C0.5,42.08142 4.08142,38.5 8.5,38.5 L16.5,38.5 L16.5,46.5 C16.5,50.9186 12.9186,54.5 8.5,54.5 C4.08142,54.5 0.5,50.9186 0.5,46.5 Z M19.5,16.5 L19.5,0.5 L27.5,0.5 C31.9186,0.5 35.5,4.08142 35.5,8.5 C35.5,12.9186 31.9186,16.5 27.5,16.5 L19.5,16.5 Z M8.5,16.5 C4.08142,16.5 0.5,12.9186 0.5,8.5 C0.5,4.08142 4.08142,0.5 8.5,0.5 L16.5,0.5 L16.5,16.5 L8.5,16.5 Z M8.5,35.5 C4.08142,35.5 0.5,31.9186 0.5,27.5 C0.5,23.08142 4.08142,19.5 8.5,19.5 L16.5,19.5 L16.5,35.5 L8.5,35.5 Z"})});function xr(e,t){window.__c={n:"FigmaBlock"};const n=(0,i.useRef)(null),o=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"figma",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,ref:n,blockResizerStore:o,store:e.store,iconSvg:Cr,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with any public Figma shareable link",id:"figmaBlock.caption"}),children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed Figma",id:"figmaBlock.placeholder"})}))}const Tr=i.memo(i.forwardRef(xr),d.Z);var Mr=n(69721);const Pr=(0,s.I)("framer",{viewBox:"0 0 32 32",svg:(0,l.jsx)("g",{children:(0,l.jsx)("path",{d:"m9 6h14v7h-7zm0 7h7l7 7h-14zm0 7h7v7z"})})}),Ar=(0,u.defineMessages)({embedButtonText:{defaultMessage:"Embed Framer",id:"framerBlock.embedFramer.button.label"}});function Rr(e,t){window.__c={n:"FramerBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"framer",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:r,ref:o,store:e.store,iconSvg:Pr,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with Framer prototypes",id:"framerBlock.linkInput.caption"}),embedButtonText:n.formatMessage(Ar.embedButtonText),urlInputPlaceholder:"https://framer.com/…",children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed a Framer prototype",id:"framerBlock.placeholder"})}))}const Dr=i.memo(i.forwardRef(Rr),d.Z);var Er=n(69578);const Br=(0,u.defineMessages)({embedButtonText:{defaultMessage:"Embed Gist",id:"gistBlock.embedButton.label"}});function Fr(e,t){window.__c={n:"GistBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"gist",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:r,ref:o,store:e.store,iconSvg:Er.f,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with links to Gists on GitHub",id:"gistBlock.linkInput.caption"}),embedButtonText:n.formatMessage(Br.embedButtonText),urlInputPlaceholder:"https://gist.github.com/…",children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed a Gist",id:"gistBlock.placeholder"})}))}const Or=i.memo(i.forwardRef(Fr),d.Z);var Zr=n(65453);const Vr=(0,s.I)("hex",{viewBox:"0 0 92 92",svg:(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("path",{fill:"#fff",d:"M0 0h92v92H0z"}),(0,l.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M25.8 34v8.368h-2.4V34H15v24h8.4V46h2.4v12h8.4V34h-8.4Zm10.7995 24h19.2v-9.6h-8.4v6h-2.4V46h10.8V34h-19.2v24Zm8.4-15.6v-4.8h2.4v4.8h-2.4Zm24.0007 0V34h8.4v6l-3.6 4.2 3.6 4.2V58h-8.4V45.968h-2.4V58h-8.4v-9.6l3.6-4.2-3.6-4.2v-6h8.4v8.4h2.4Z",fill:"#473982"})]})}),Ur=(0,u.defineMessages)({embedButtonText:{defaultMessage:"Embed Hex",id:"hexBlock.embeds.button.label"}});function Nr(e,t){window.__c={n:"HexBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"hex",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:r,ref:o,store:e.store,iconSvg:Vr,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with Hex cell links with public access.",id:"hexBlock.embeds.caption"}),embedButtonText:n.formatMessage(Ur.embedButtonText),urlInputPlaceholder:"https://hex.tech/…",children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed Hex",id:"hexBlock.placeholder"})}))}const Lr=i.memo(i.forwardRef(Nr),d.Z),jr=(0,s.I)("picture",{viewBox:"0 0 30 30",svg:(0,l.jsx)("path",{d:"M1,4v22h28V4H1z M27,24H3V6h24V24z M18,10l-5,6l-2-2l-6,8h20L18,10z M11.216,17.045l1.918,1.918l4.576-5.491L21.518,20H9 L11.216,17.045z M7,12c1.104,0,2-0.896,2-2S8.104,8,7,8s-2,0.896-2,2S5.896,12,7,12z"})}),zr=(0,u.defineMessages)({urlPlaceholder:{defaultMessage:"Paste the image link…",id:"imageBlock.linkInput.placeholder"},embedButtonText:{defaultMessage:"Embed image",id:"imageBlock.embedImage.button.label"}});function qr(e,t){window.__c={n:"ImageBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z),s=(0,a.VK)((()=>{const e=[{type:"file",imageUpload:!0},{type:"embed"},{type:"unsplash"}];return _t.default.checkGate("enable_giphy_feature_gate")&&e.push({type:"giphy"}),e}),[]);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"image",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:r,ref:o,store:e.store,urlInputPlaceholder:n.formatMessage(zr.urlPlaceholder),iconSvg:jr,preserveScale:!0,mediaMenuCurrentTab:"file",mediaMenuTabs:s,mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with any image from the web",id:"imageBlock.linkInput.caption"}),embedButtonText:n.formatMessage(zr.embedButtonText),popupWidth:540,maxHeight:420,children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Add an image",id:"imageBlock.placeholder"})}))}const Hr=i.memo(i.forwardRef(qr),d.Z),Wr=(0,s.I)("invision",{viewBox:"0 0 215 182",svg:(0,l.jsxs)("g",{stroke:"none",strokeWidth:"1",children:[" ",(0,l.jsxs)("g",{transform:"translate(0.000000, -222.000000)",children:[" ",(0,l.jsxs)("g",{children:[" ",(0,l.jsx)("path",{d:"M98.9196618,401.249534 L67.23738,401.249534 C69.0283748,394.069758 70.787323,387.019973 72.4415558,380.387695 C68.8636285,384.425558 65.4170469,389.032134 61.2582199,392.866884 C50.6503674,402.647395 38.1012175,405.941417 24.0797327,402.23079 C13.9819165,399.55829 7.92421985,391.917675 6.61663119,381.562133 C5.46837247,372.464529 7.41824578,363.782628 9.57890401,355.080416 C13.7219334,338.391847 17.8017725,321.687933 21.9028255,304.989434 C22.0454551,304.409889 22.1339216,303.817254 22.2995706,302.96283 L-0.0003,302.96283 C2.30975824,294.403698 4.53721769,286.151943 6.78995327,277.806756 L60.5229552,277.806756 C60.3491817,278.642223 60.2273147,279.357627 60.0512844,280.059943 C53.0231647,308.023022 45.9535198,335.97572 39.0057421,363.95911 C38.1427426,367.435481 37.6331576,371.059899 37.479244,374.638277 C37.2535643,379.877659 40.2013936,382.783512 45.4935844,382.824134 C53.5440336,382.885068 60.4588621,379.769784 66.3955944,374.554776 C72.743064,368.979131 77.1564578,362.201967 79.1663619,353.808936 C83.0828089,337.452117 87.2971531,321.167064 91.379249,304.850416 C91.5232327,304.276286 91.5715282,303.678686 91.6933952,302.909569 L69.2513464,302.909569 C69.6155936,301.479211 69.9089773,300.269116 70.2316994,299.067145 C71.9843286,292.540938 73.758623,286.020597 75.4882328,279.488522 C75.7789084,278.389461 76.0555918,277.645621 77.5008451,277.651037 C92.8448135,277.709714 108.18833,277.692562 123.531847,277.702492 C123.75166,277.702492 123.97102,277.781931 124.411096,277.867238 C122.458966,286.803255 120.511801,295.717606 118.565087,304.631958 C118.656261,304.671226 118.747887,304.710043 118.838611,304.749311 C120.277996,302.605804 121.639297,300.404524 123.17076,298.328721 C129.752485,289.408051 137.659853,281.997178 148.043831,277.728671 C168.022811,269.515732 188.005402,280.685076 192.142563,302.283534 C193.975534,311.851454 193.064691,321.305631 190.553778,330.628914 C187.175803,343.16994 183.622249,355.664024 180.318748,368.224458 C179.661569,370.722733 179.467484,373.448493 179.624106,376.035235 C179.988804,382.073072 185.463796,384.737899 190.442292,381.268749 C192.360119,379.932273 194.120421,378.060937 195.308399,376.052387 C197.438816,372.450086 199.08989,368.563429 200.922861,364.787355 C201.278532,364.054347 201.552056,363.281168 201.937066,362.346854 C206.06836,363.936993 210.106223,365.491476 214.381049,367.137584 C210.178891,380.337594 205.268551,393.058261 192.248181,399.864312 C181.021966,405.732889 169.389528,405.395272 158.535233,398.5987 C151.013326,393.889214 148.484358,386.186312 148.027131,377.697592 C147.620005,370.133709 149.656088,362.968376 151.693976,355.800786 C154.30148,346.629159 157.031754,337.485517 159.315182,328.232646 C160.272516,324.353211 160.657977,320.20973 160.534756,316.210233 C160.26394,307.425422 153.949871,301.479211 145.147908,301.094201 C135.701404,300.681207 128.636273,304.704626 123.601357,312.562796 C119.514296,318.940958 117.721496,326.162711 115.917863,333.384916 C110.367494,355.603993 104.804488,377.819911 99.2455434,400.036731 C99.157077,400.390597 99.0564238,400.741303 98.9196618,401.249534 Z M28.7006165,241.023028 C28.6658618,230.356047 37.1446512,221.982425 47.9637399,222.000028 C58.6717942,222.017631 67.1365914,230.335285 67.169992,240.873176 C67.2033927,251.467488 58.5991253,259.984192 47.8874602,259.958916 C37.2349231,259.934091 28.7349198,251.545573 28.7006165,241.023028 Z"})," "]})," "]})," "]})}),Kr=(0,u.defineMessages)({embedButtonText:{defaultMessage:"Embed Invision",id:"invisionBlock.embeds.button.label"}});function Gr(e,t){window.__c={n:"InvisionBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"invision",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:r,ref:o,store:e.store,iconSvg:Wr,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with Invision projects",id:"invisionBlock.embeds.caption"}),embedButtonText:n.formatMessage(Kr.embedButtonText),urlInputPlaceholder:"https://invis.io/…",children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed an Invision project",id:"invisionBlock.placeholder"})}))}const $r=i.memo(i.forwardRef(Gr),d.Z);var Qr=n(23586),Yr=n(68056),Xr=n(75822),Jr=n(80444);class ei extends Ge.default{getInitialState(){return{query:""}}}const ti=ei;var ni=n(24666),oi=n(3386),ri=n(6287),ii=n(72711),ai=n(69454),si=n(32163),li=n(43765),ci=n(11470),di=n(75987),ui=n(36488),pi=n(74194),mi=n(53437);class fi extends In.Z{constructor(){super(...arguments),this.storeTypes={store:ti},this.handleQueryUpdateDebounced=void 0,this.handleInputChange=e=>{const t=e.target.value;this.stores.store.setState({...this.stores.store.state,query:t}),this.handleQueryUpdateDebounced(t)},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleQueryUpdate=e=>function(e,t,n){n&&n({query:e,autocompleteStore:t})}(e,this.stores.store,this.props.onQueryUpdate)}get registries(){return[di.Z]}UNSAFE_willMount(e){super.UNSAFE_willMount(e),this.handleQueryUpdateDebounced=rn.Ds(this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleQueryUpdate,this.props.queryUpdateDebounce)}renderComponent(){const{device:e}=this.environment;return(0,l.jsx)(mi.ZP,{popupType:e.isPhone?mi.ZP.PopupType.SlideUp:mi.ZP.PopupType.Popup,open:this.props.isOpen,origin:this.renderInput(),placementToOrigin:mi.ZP.Placement.Bottom,alignmentToOrigin:mi.ZP.Alignment.Start,originGap:4,disableDarkOverlayBackground:e.isPhone,onDismiss:this.props.onBgClick,render:this.props.renderPopup,preventCaptureEsc:this.props.preventCaptureEsc,disableMouseCapture:this.props.disableMouseCapture,style:this.props.popupStyle})}renderInput(){const e=this.props.isOpen;return(0,l.jsx)(ui.Z,{capture:e,allowMenuList:!0,render:e=>(0,l.jsx)(z.p,{allowSelectionWithin:!0,...e,children:(0,l.jsx)(pi.Z,{style:this.props.inputStyle,format:void 0!==this.props.format?this.props.format:pi.B.Transparent,value:this.stores.store.state.query,onClick:this.props.onInputClick,onFocus:this.props.onInputFocus,onBlur:this.props.onInputBlur,onChange:this.handleInputChange,placeholder:this.props.inputPlaceholder,focus:this.props.focus})})})}}fi.displayName="InlineAutocomplete";const gi=fi;const hi=(0,u.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a database…",id:"linkToCollectionBlock.input.placeholder"}});function vi(e){window.__c={n:"LinkToCollectionBlockPopup"};const t=(0,u.useIntl)(),n=(0,y.O7)(),o=(0,y.Fy)(),r=(0,i.useRef)(!1),a=(0,i.useCallback)((()=>{const t=(e.results||[]).map((t=>{const o=lr.NW.createChildStore(e.store,{table:ri.v,id:t});return{key:t,render:e=>(0,l.jsx)(ci.Z,{...e,store:o}),action:()=>{r.current||(r.current=!0,Nt.createAndCommit({userAction:"LinkToCollectionBlock.menuListItem",environment:n,perform:t=>{const r=ii.Y_({environment:n,store:e.store,collectionStore:o,collectionViewStore:void 0,transaction:t});r&&ve.Z5({environment:n,stores:[r]})}}))}}}));let i,a;return i=e.results&&0===t.length?(0,l.jsx)(dt.Z,{title:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Select a database",id:"linkToCollectionBlock.menuItem.noResults.title"}),loading:!e.ready,children:(0,l.jsx)(li.Z,{title:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"No results",id:"linkToCollectionBlock.menuItem.noResults.label"})})}):(0,l.jsx)(si.Z,{type:si.i.Vertical,initialFocus:0,sections:[{key:0,render:t=>(0,l.jsx)(dt.Z,{...t,title:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Select a database",id:"linkToCollectionBlock.menuItem.showResults.title"}),loading:!e.ready}),items:t}]}),a=o.isPhone?{menuType:vt.og.ActionSheet,disableBottomPadding:!0,maxHeight:`calc(70vh - ${ai.Z.estimatedNativeWebBottomOverlap()}px)`}:{menuType:vt.og.Popup,width:460,maxHeight:o.isPhone?"30vh":"40vh"},(0,l.jsx)(Ot.Z,{...a,children:i})}),[o.isPhone,n,e.ready,e.results,e.store]),s=(0,i.useCallback)((()=>{be.ZH(n),r.current||(r.current=!0,Nt.createAndCommit({userAction:"LinkToCollectionBlock.handleBlur",environment:n,perform:t=>{rr.Od({store:e.store,transaction:t})}}))}),[n,e.store]);return(0,l.jsx)(gi,{loading:!e.ready,isOpen:!0,store:e.autocompleteStore,queryUpdateDebounce:Xr.vp,inputPlaceholder:t.formatMessage(hi.inputPlaceholder),focus:!0,inputStyle:{...bi(),borderBottom:void 0},onBgClick:s,renderPopup:a})}function bi(){return{lineHeight:1.3}}function yi(e,t){window.__c={n:"LinkToCollectionBlock"};const n=(0,y.O7)(),o=(0,i.useRef)(null),r=(0,a.qz)(void 0,ti),{query:s}=(0,a.VK)((()=>r.state),[r]),c=(0,a.VK)((()=>{const t=ni.default.state;return Boolean("editing"===t.mode&&(0,Yr.qS)(t.multiSelection)&&t.multiSelection.start.store.id===e.store.id)}),[e.store.id]);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"link_to_collection",getNode:()=>o.current,getBlockStore:()=>e.store,handleCreated(){ve.$Y({environment:n,phase:eo.SelectionPhase.Editing}),be.Z5({store:e.store,selection:void 0})}})),[n,e.store]),c?(0,l.jsx)(Qr.Z,{request:s,performRequest:t=>async function(e,t,n){if(t.isDefaultRecordCache()){const t=await F.deps.searchActions.loader(),{currentSpaceStore:o}=Jr.default.state;return(await t.searchCollections(n,{query:e,limit:20,source:"link_to_collection_block",spaceStore:o,searchSessionId:void 0})).results}return[]}(t,e.store,n),debounce:Xr.vp,render:(t,n,o)=>(0,l.jsx)(oi.Z,{debugName:"LinkToCollectionBlock",capture:c,children:(0,l.jsx)(vi,{store:e.store,results:n,ready:o,autocompleteStore:r})})}):null)}const _i=i.memo(i.forwardRef(yi),d.Z);var Si=n(72141),wi=n(21202),ki=n(61045),Ii=n(28020),Ci=n(46654);const xi=(0,u.defineMessages)({inputPlaceholder:{defaultMessage:"Search for a page…",id:"linkToPageBlock.searchPlaceholder"}});function Ti(e){window.__c={n:"LinkToPageBlockPopup"};const t=(0,u.useIntl)(),n=(0,y.O7)(),o=(0,y.Fy)(),r=(0,a.VK)((()=>ai.Z.estimatedNativeWebBottomOverlap()),[]),s=(0,i.useRef)(!1),c=(0,i.useCallback)((()=>{const t=(e.results||[]).map((t=>{const o=lr.G.createChildStore(e.store,{table:wi.iU,id:t});return{key:t,render:e=>(0,l.jsx)(ci.Z,{...e,store:o}),action:()=>{s.current||(s.current=!0,Nt.createAndCommit({userAction:"LinkToPageBlock.menuListItem",environment:n,perform:t=>{const r=ii.hc({environment:n,store:e.store,targetStore:o,transaction:t});r&&ve.Z5({environment:n,stores:[r]})}}))}}}));let i,a;return i=e.results&&0===t.length?(0,l.jsx)(dt.Z,{title:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Select a page",id:"linkToPageBlock.selectPrompt"}),loading:!e.ready,children:(0,l.jsx)(li.Z,{title:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"No results",id:"linkToPageBlock.noSearchResults"})})}):(0,l.jsx)(si.Z,{type:si.i.Vertical,initialFocus:0,sections:[{key:0,render:t=>(0,l.jsx)(dt.Z,{...t,title:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Select a page",id:"linkToPageBlock.selectPrompt.withContents"}),loading:!e.ready}),items:t}]}),a=o.isPhone?{menuType:vt.og.ActionSheet,disableBottomPadding:!0,maxHeight:`calc(70vh - ${r}px)`}:{menuType:vt.og.Popup,width:460,maxHeight:o.isMobile?"30vh":"40vh"},(0,l.jsx)(Ot.Z,{...a,children:i})}),[o.isMobile,o.isPhone,n,r,e.ready,e.results,e.store]),d=(0,i.useCallback)((()=>{be.ZH(n),s.current||(s.current=!0,Nt.createAndCommit({userAction:"LinkToPageBlock.handleBlur",environment:n,perform:t=>{rr.Od({store:e.store,transaction:t})}}))}),[n,e.store]);return(0,l.jsx)(gi,{loading:!e.ready,isOpen:!0,store:e.autocompleteStore,queryUpdateDebounce:Xr.vp,inputPlaceholder:t.formatMessage(xi.inputPlaceholder),focus:!0,inputStyle:{...Mi(),borderBottom:void 0},onBgClick:d,renderPopup:c})}function Mi(){return{lineHeight:1.3}}function Pi(e,t){window.__c={n:"LinkToPageBlock"};const n=(0,y.Fy)(),o=(0,y.O7)(),r=(0,i.useRef)(null),s=(0,a.qz)(void 0,ti),{query:c}=(0,a.VK)((()=>s.state),[s]),d=(0,a.VK)((()=>{const t=ni.default.state;return Boolean("editing"===t.mode&&(0,Yr.qS)(t.multiSelection)&&t.multiSelection.start.store.id===e.store.id)}),[e.store]);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"link_to_page",getNode:()=>r.current,getBlockStore:()=>e.store,handleCreated(){ve.$Y({environment:o,phase:eo.SelectionPhase.Editing}),be.Z5({store:e.store,selection:void 0}),n.isMobile&&ai.Z.onShow((()=>ki.hQ(o)))}})),[n.isMobile,o,e.store]),d?(0,l.jsx)(Qr.Z,{request:c,performRequest:t=>async function(e,t,n){const{currentSpaceStore:o,mainEditorCurrentBlockStore:r}=Jr.default.state,i=(0,Ci.YO)(t).find((e=>{let{permissionItem:t}=e;return(0,Si.$D)(t)}));if(t.isDefaultRecordCache()&&(o||i)){if(!e)return i&&!o&&r?[r.id]:Ii._u(n).map((e=>e.id));{const t=await F.deps.searchActions.loader();if(o){return(await t.searchPageIds({environment:n,query:e,limit:20,spaceId:o.id,requireEditPermissions:!1,excludeTemplates:!1,source:"link_to_page_block",boostRecentlyViewedPages:!0})).results}if(i&&i.from.table===wi.iU){return(await t.searchPageIdsInAncestor({environment:n,query:e,limit:20,ancestorId:i.from.blockId,excludeTemplates:!1,source:"link_to_page_block"})).results}}}return[]}(t,e.store,o),debounce:Xr.vp,render:(t,n,o)=>(0,l.jsx)(oi.Z,{debugName:"LinkToPageBlock",capture:d,children:(0,l.jsx)(Ti,{store:e.store,results:n,ready:o,autocompleteStore:s})})}):null)}const Ai=i.memo(i.forwardRef(Pi),d.Z),Ri=(0,s.I)("loom",{viewBox:"0 0 190 190",svg:(0,l.jsx)("path",{d:"M189.611 84.2622H134.166L182.184 56.539L171.639 38.2692L123.621 65.9923L151.338 17.9781L133.068 7.42678L105.351 55.4409V0H84.2598V55.4462L56.5322 7.42678L38.2681 17.9728L65.9904 65.987L17.9723 38.2692L7.42658 56.5337L55.4447 84.2569H0V105.349H55.4394L7.42658 133.072L17.9723 151.342L65.9851 123.624L38.2628 171.638L56.5322 182.184L84.2545 134.165V189.611H105.346V134.17L133.063 182.184L151.332 171.638L123.61 123.619L171.628 151.342L182.174 133.072L134.161 105.354H189.6V84.2622H189.611ZM94.8055 123.491C78.9021 123.491 66.0116 110.601 66.0116 94.6968C66.0116 78.7929 78.9021 65.9021 94.8055 65.9021C110.709 65.9021 123.599 78.7929 123.599 94.6968C123.599 110.601 110.709 123.491 94.8055 123.491Z"})});function Di(e,t){window.__c={n:"LoomBlock"};const n=(0,i.useRef)(null),o=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"loom",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:o,ref:n,store:e.store,iconSvg:Ri,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with any Loom shareable link",id:"loomBlock.embed.caption"}),children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed Loom",id:"loomBlock.placeholder"})}))}const Ei=i.memo(i.forwardRef(Di),d.Z),Bi=(0,s.I)("maps",{viewBox:"0 0 160 164",svg:(0,l.jsxs)("g",{children:[" ",(0,l.jsx)("polyline",{points:"16 163.155 76.159 103 136.314 163.155 16 163.155"})," ",(0,l.jsx)("path",{d:"M91.1523093,12 C89.1061243,15.5558234 87.6020864,19.4206238 86.7688642,23.441 C84.8448642,33.084 86.5958642,43.241 91.3038642,51.836 C91.8382207,52.8588753 92.3925227,53.8704894 92.9644441,54.8718184 L0,147.839 L0,24.942 C0,17.799 5.796,12 12.942,12 L91.1523093,12 L91.1523093,12 Z M27.8186945,28.8787927 C20.9826945,31.9947927 15.9026945,38.8067927 15.1686945,46.3227927 C13.7376945,56.9777927 21.5856945,67.7337927 32.0706945,69.9057927 C40.5536945,71.9007927 50.5746945,68.4527927 54.8196945,60.5497927 C57.5256945,56.1347927 57.8816945,50.7917927 57.3626945,45.7587927 C50.5816945,45.0857927 43.5296945,45.6577927 36.6486945,45.4797927 C36.5946945,48.0237927 36.6096945,50.5677927 36.7256945,53.1037927 C40.8396945,53.0417927 44.9526945,53.0807927 49.0736945,53.0727927 C47.8296945,58.9497927 41.9446945,62.9007927 36.0456945,62.2127927 C27.0296945,62.0967927 20.6586945,51.4727927 24.4936945,43.3927927 C27.4236945,35.1807927 39.1766945,32.2347927 45.4326945,38.4437927 C47.4426945,36.5027927 49.4526945,34.5547927 51.4096945,32.5597927 C45.1536945,26.7907927 35.5196945,25.3527927 27.8186945,28.8787927 Z"})," ",(0,l.jsx)("path",{d:"M124.80036,20.6120969 C120.325021,21.6105482 116.569675,25.5689693 116.191987,30.2012296 C115.721991,34.5142624 118.24735,38.8911407 122.112695,40.7949674 C126.304191,43.0118678 131.806442,42.332644 135.307176,39.1288306 C138.574835,36.2380909 139.764822,31.2458343 138.057917,27.2058756 C136.037937,22.1505427 130.041845,19.2713414 124.80036,20.6120969 Z M129.322621,0 C138.754833,0.539994477 147.978584,5.14840888 153.696218,12.7298698 C157.440026,17.5182824 159.529236,23.4620677 160,29.4989291 L160,31.7396754 C159.779233,43.4418634 152.290848,53.047919 145.807068,62.1501336 C138.528681,72.435413 131.801058,83.6445291 129.937231,96.3213226 C129.438005,98.4697621 129.034302,102.445875 127.470333,102.445875 C124.80036,102.3677 123.210376,86.842958 120.185792,80.3707165 C116.755058,72.8300244 111.978183,66.0154787 107.125156,59.3463161 C104.17134,55.3471262 101.384446,51.2079378 99.0798538,46.7964445 C95.4583524,40.1849736 94.1114431,32.3719766 95.591428,24.9543602 C96.8052617,19.097497 99.8698458,13.6698602 104.112879,9.47298004 C109.830513,3.88303721 117.561972,0.499225663 125.538045,0 L129.322621,0 Z"})," ",(0,l.jsx)("path",{d:"M151.652474,72 L151.652474,148.672145 C135.535571,132.464045 127.553192,124.419378 127.705338,124.538145 C131.041338,123.277145 130.263338,119.369145 130.912338,116.576145 C133.335338,100.096145 142.081338,85.5241452 151.543338,72.1531452 C151.579693,72.102109 151.616072,72.0510607 151.652474,72 Z"})," ",(0,l.jsx)("path",{d:"M106.040648,74 L92,88.0399478 L125.952845,121.992793 C123.906994,113.374953 121.723258,103.970177 117.61803,95.9459594 C114.174293,88.3766869 110.811044,80.7912134 106.040648,74 Z"})," "]})}),Fi=(0,u.defineMessages)({embedButtonText:{defaultMessage:"Embed Map",id:"googleMapsBlock.embedButton.label"}});function Oi(e,t){window.__c={n:"MapsBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"maps",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:r,ref:o,store:e.store,iconSvg:Bi,urlInputPlaceholder:"https://www.google.com/maps…",embedButtonText:n.formatMessage(Fi.embedButtonText),mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with places on Google Maps",id:"googleMapsBlock.embed.caption"}),children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed a Google Map",id:"googleMapsBlock.placeholder"})}))}const Zi=i.memo(i.forwardRef(Oi),d.Z),Vi=(0,s.I)("miro",{viewBox:"0 0 32 32",svg:(0,l.jsx)("path",{d:"M13.75 20.895l1.761.359v-7.82l-1.76.344v7.117zm4.604-4.28v4.28l1.761.359V16.88c0-.993.56-1.441 1.432-1.607l1.015-.186v-1.835l-1.015.164c-1.935.44-3.193 1.073-3.193 3.197zm-7.446-.256c0-2.313-1.539-3.085-2.777-3.068-.984.014-1.785.423-2.265 1.047-.478-.685-1.325-1.068-2.016-1.068-.85 0-1.597.373-2.09.97v-.806L0 13.778v7.117l1.76.359v-4.895c0-.776.568-1.328 1.418-1.328.836 0 1.403.552 1.403 1.328v4.536l1.76.359v-4.895c0-.776.568-1.328 1.404-1.328.835 0 1.402.552 1.402 1.328v4.536l1.76.359v-4.895h.001zm17.176 5.059c2.356 0 3.916-1.636 3.916-4.081 0-2.446-1.56-4.067-3.916-4.067-2.446 0-4.082 1.62-4.082 4.067 0 2.445 1.636 4.08 4.082 4.08zm0-1.65c-1.366 0-2.281-.976-2.281-2.431 0-1.456.915-2.416 2.281-2.416 1.275 0 2.115.96 2.115 2.416 0 1.455-.84 2.43-2.115 2.43zm-13.416-7.552c.641 0 1.065-.445 1.065-1.11S15.31 10 14.668 10c-.665 0-1.11.44-1.11 1.106 0 .665.445 1.11 1.11 1.11"})}),Ui=(0,u.defineMessages)({embedButtonText:{defaultMessage:"Embed Miro",id:"miroBlock.embeds.button.label"}});function Ni(e,t){window.__c={n:"MiroBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"miro",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:r,ref:o,store:e.store,iconSvg:Vi,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with Miro links with public access enabled",id:"miroBlock.embeds.caption"}),embedButtonText:n.formatMessage(Ui.embedButtonText),urlInputPlaceholder:"https://miro.com/app/board/…",children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed Miro",id:"miroBlock.placeholder"})}))}const Li=i.memo(i.forwardRef(Ni),d.Z),ji=(0,s.I)("mixpanel",{viewBox:"0 0 101 106",svg:(0,l.jsx)("g",{children:(0,l.jsx)("path",{d:"M31.008 41.412h13.385c-3.342-2.09-4.593-5.021-6.272-10.454l-5.022-18.613C30.803 3.982 28.918.005 19.714.005H.484v5.022H3.21c5.639 0 6.273 2.091 7.952 8.364l4.387 16.315c2.297 7.952 5.861 11.706 15.476 11.706h-.016zm30.968 0h13.37c9.614 0 12.956-3.77 15.27-11.706l4.387-16.315c1.679-6.273 2.502-8.364 7.952-8.364h2.724V.006H86.655c-9.41 0-11.294 3.77-13.385 12.34l-5.02 18.611c-1.68 5.639-2.93 8.363-6.273 10.454zM44.393 58.963h17.584l-.001-17.55H44.393v17.55zM.484 100.369h19.23c9.204 0 11.088-3.976 13.385-12.34l5.022-18.611c1.679-5.434 2.93-8.364 6.272-10.455H31.008c-9.615 0-13.179 3.77-15.475 11.706l-4.388 16.315c-1.68 6.273-2.297 8.364-7.952 8.364H.484v5.021zm86.14 0h19.023v-5.021h-2.724c-5.433 0-6.273-2.091-7.952-8.364L90.583 70.67c-2.296-7.952-5.639-11.706-15.27-11.706H61.976c3.343 2.091 4.546 4.816 6.225 10.455l5.022 18.612c2.09 8.57 3.975 12.339 13.385 12.339h.015z"})})}),zi=(0,u.defineMessages)({embedButtonText:{defaultMessage:"Embed Mixpanel",id:"mixpanelBlock.embeds.button.label"}});function qi(e,t){window.__c={n:"MixpanelBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"mixpanel",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:r,ref:o,store:e.store,iconSvg:ji,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with Mixpanel projects",id:"mixpanelBlock.embeds.caption"}),embedButtonText:n.formatMessage(zi.embedButtonText),urlInputPlaceholder:"https://mixpanel.com/…",children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed a Mixpanel project",id:"mixpanelBlock.placeholder"})}))}const Hi=i.memo(i.forwardRef(qi),d.Z);var Wi=n(54321),Ki=n(4382),Gi=n(45952),$i=n(16472);const Qi=(0,s.I)("replit",{viewBox:"0 0 793.8 871.5",svg:(0,l.jsx)("g",{children:(0,l.jsx)("path",{d:"M396.9 356.1H227.2c-16.6 0-30-13.4-30-30v-99.8c0-16.6 13.4-30 30-30h139.7c16.6 0 30 13.4 30 30v129.8zm169.7 159.7H396.9V356.1h169.7c16.5 0 29.9 13.4 29.9 29.9v99.8c0 16.6-13.4 30-29.9 30zM366.9 675.6H227.2c-16.5 0-29.9-13.4-29.9-29.9v-99.8c0-16.5 13.4-29.9 29.9-29.9h169.7v129.8c0 16.3-13.4 29.8-30 29.8z"})})}),Yi=(0,u.defineMessages)({embedButtonText:{defaultMessage:"Embed a repl",id:"replitBlock.embeds.button.label"}});function Xi(e,t){window.__c={n:"ReplitBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"replit",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:r,ref:o,store:e.store,iconSvg:Qi,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with Replit.",id:"replitBlock.embeds.caption"}),embedButtonText:n.formatMessage(Yi.embedButtonText),urlInputPlaceholder:"https://replit.com/…",children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed a repl",id:"replitBlock.placeholder"})}))}const Ji=i.memo(i.forwardRef(Xi),d.Z),ea=(0,s.I)("sketch",{viewBox:"0 0 46 46",svg:(0,l.jsx)("g",{fillRule:"evenodd",children:(0,l.jsx)("path",{d:"M23.0831783 10.0045301l8.1450351.8960958c.2099814.0231017.4008968.1324906.5270123.3019626l6.0917147 8.1859511c.2137793.2872733.1982297.6847539-.0373384.9544486L23.4296391 36.806161c-.2072579.2372831-.5676296.2616233-.8049127.0543654l-.0543655-.0543654L8.19039805 20.3429882c-.23556813-.2696947-.25111774-.6671753-.03733843-.9544486l6.09171468-8.1859511c.1261155-.169472.3170309-.2788609.5270123-.3019626l8.1450351-.8960958a.76060447.76060447 0 01.1663566 0zm2.0141776 2.4229231c-.0693405-.0648437-.1764661-.0687976-.2504897-.0092454-.081512.0655766-.0939018.1841651-.0276733.2648747l3.8573181 4.7007387c.055083.0671271.085151.1509825.085151.2374739 0 .207984-.1702805.3765884-.3803321.3765884H17.6186701c-.0873512 0-.1720402-.0297721-.2398346-.0843129-.163024-.1311532-.1878035-.3683301-.0553465-.5297494l3.8573181-4.7007387c.0601442-.073295.0561509-.1793661-.0093373-.2480242-.0721132-.0756035-.1924706-.0790085-.2688257-.0076051l-5.750016 5.3771171c-.0774384.0724164-.1819972.1093609-.2882425.1018466-.2095178-.0148182-.3672335-.1950067-.352268-.4024622l.2753824-3.8174045c.0064096-.0888512-.0509385-.1699933-.1374402-.1944648-.1009848-.0285688-.206239.0293302-.2350918.129321L13.1553109 17.98681c-.0869135.3012032-.3194364.539875-.62031.6367138l-2.76499194.8899366c-.07834118.0252148-.13137885.0975058-.13137885.1790711 0 .1039921.08514024.1882942.19016605.1882942h2.66553224c.3250892 0 .6276464.1644528.8021788.4360184L20.3459621 31.28552c.0777639.1209976.2347663.165079.3651002.1025088.1417556-.0680534.2009545-.2370061.1322245-.3773663l-5.0526479-10.3185107c-.0376144-.0768161-.0571558-.1610746-.0571558-.2464434 0-.3119761.2554207-.5648827.5704981-.5648827h13.3920376c.0862174 0 .1713136.0193492.2488932.0565933.2835111.1361069.401909.4740123.2644491.7547328l-5.0526479 10.3185107c-.0631922.129051-.0186726.2845081.1035279.3615065.1329093.0837462.3092182.0449521.3937968-.086649l7.0494549-10.9686759c.1745324-.2715656.4770896-.4360184.8021788-.4360184h2.5849257c.0818532 0 .1545231-.0518618.1804073-.1287503.0332121-.0986555-.0206353-.2052903-.1202715-.2381755l-2.6912281-.888246c-.2977515-.0982735-.5273437-.3357047-.6135671-.6345159l-1.2609059-4.3697316c-.0247148-.0856502-.1066636-.1424338-.196398-.1360873-.1047589.0074091-.1836168.0975033-.176134.2012311l.2753824 3.8174045c.0075889.1051994-.0297228.2087291-.1028592.2854053-.1442263.1512071-.3849411.158017-.5376513.0152103z"})})}),ta=(0,u.defineMessages)({embedButtonText:{defaultMessage:"Embed Sketch",id:"sketchBlock.embeds.button.label"}});function na(e,t){window.__c={n:"SketchBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"sketch",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:r,ref:o,store:e.store,iconSvg:ea,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with Sketch links with Public Link Access enabled",id:"sketchBlock.embeds.caption"}),embedButtonText:n.formatMessage(ta.embedButtonText),urlInputPlaceholder:"https://sketch.com/…",children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed Sketch",id:"sketchBlock.placeholder"})}))}const oa=i.memo(i.forwardRef(na),d.Z);var ra=n(99571),ia=n(51704),aa=n(15690),sa=n(25777),la=n(33709),ca=n(94419),da=n(52771),ua=n(92120),pa=n(98165),ma=n(34859),fa=n(79131),ga=n(31278),ha=n(76798),va=n(53336);function ba(e){window.__c={n:"TabBlockMenu"};const t=(0,u.useIntl)(),n=(0,y.O7)(),o=(0,S.Fg)(),r=(0,S.yK)((e=>({baseStyle:{paddingLeft:0,paddingRight:0,marginTop:-6,marginBottom:14},mobileStyle:ka(e),desktopStyle:wa(e),scrollerOverlayStyle:Ia(e)})),[]),a=(0,i.useRef)(null);return(0,l.jsxs)(z.p,{allowSelectionWithin:!0,style:{...n.device.isMobile?r.mobileStyle:r.desktopStyle,...r.baseStyle},children:[(0,l.jsx)(va.Z,{role:"tablist","aria-label":t.formatMessage(Sa.tabListLabel),type:ma.Z.X,ref:a,showLeftRightOverlay:!0,rightOverlayStyle:r.scrollerOverlayStyle,children:(0,l.jsx)(fa.ZP,{disabled:e.disabled,direction:"horizontal",keys:e.tabs.map((e=>e.id)),renderKey:(t,n)=>(0,l.jsx)(ya,{index:n,...e}),onDrop:(t,o)=>function(e){const{environment:t,parentStore:n,onDropArgs:o,newTabs:r}=e;Nt.createAndCommit({userAction:"TabBlockMenu.handleTabReorder",environment:t,perform:e=>{const{key:t,endPosition:i}=o,a=n.getContentStores().find((e=>e.id===t)),s=r[i-1],l=n.getContentStores().find((e=>e.id===s));if(a){const t=n;ca.HP({parent:t.getContentStore(),after:l,current:a,transaction:e})}}})}({environment:n,newTabs:t,parentStore:e.parentStore,onDropArgs:o}),disableHorizontalEdgeScroll:!1})}),!e.disabled&&(0,l.jsx)(vr.Z,{"aria-label":t.formatMessage(Sa.addTab),style:{height:28,width:28,marginTop:6,display:"flex",justifyContent:"center"},onClick:()=>{!function(e,t,n){const{performResult:o}=Nt.createAndCommit({userAction:"TabBlockMenu.newTab",environment:e,perform:n=>aa.gG({environment:e,store:t,transaction:n})}),r=()=>{const e=t.getContentStores(),n=e[e.length-1];da.$({blockStore:o,renderDelete:!0,originRect:n?tr.C.getRectFromStore(n):void 0})};n.current?n.current.scrollToRight({animate:!0,animationCallback:()=>{r()}}):r()}(n,e.parentStore,a)},children:(0,Jo.R)({fill:o.mediumIconColor,width:16,height:16})})]})}function ya(e){window.__c={n:"TabItem"};const t=(0,y.O7)(),n=(0,u.useIntl)(),{index:o,parentStore:r,selectedIndex:i,tabs:s}=e,c=s[o],d=(0,S.yK)((e=>({selectedTab:{...{paddingTop:6,paddingBottom:12,whiteSpace:"nowrap",minWidth:0,flexShrink:0,fontWeight:500},position:"relative"},tab:{paddingTop:6,paddingBottom:12,whiteSpace:"nowrap",minWidth:0,flexShrink:0,fontWeight:500},border:Ca(e)})),[]),p=(0,a.VK)((()=>{const e=ua.Z.getFirstSelectedDiscussionId();if(!e)return!1;const t=lr.jQ.createChildStore(c,{table:la.qF,id:e,spaceId:c.getSpaceId()});return(0,pa.qA)(t).map((e=>e.id)).includes(c.id)}),[c]),{device:m}=t,f=i===o,g=o===s.length-1,h=0===o,v=s.length;return(0,l.jsx)(hn.Z,{store:c,analyticsName:"tab",canSelect:!0,canDrag:!1,canDropBelow:!1,canDropLeft:!h,canDropAbove:!1,canNativeDropBelow:!1,canNativeDropLeft:!h,canNativeDropRight:!g,canDropOnto:!0,dropzoneShouldNeverUseOrigin:!0,dropzoneMustBeWithinHorizontalBound:!0,canInsertAbove:!h,canDropRight:!g,canInsertBelow:!g,shouldShowHalo:!0,shouldShowDropZone:!0,shouldShowParentHalo:!0,dropzoneGap:10,onSelectableDrop:e=>{const{droppedDirection:n,droppedStores:o,duplicate:r}=e;Nt.createAndCommit({userAction:"TabBlockMenu.dropOntoTab",environment:t,perform:e=>{an.LQ({environment:t,targetParentStore:c.getContentStore(),targetStore:c,droppedDirection:n,droppedStores:o,duplicate:r,transaction:e})}})},onRemove:()=>{!function(e){const{environment:t,parentStore:n,tabStore:o,index:r}=e;Nt.createAndCommit({userAction:"TabBlockMenu.handleRemoveTab",environment:t,perform:e=>{const i=n.getContentStores();if(1===i.length){const t=n.getRecordStoreUIParent();"block"!==(null==t?void 0:t.table)&&"space"!==(null==t?void 0:t.table)||null==t||!t.valueIs(nr.i)||ca.Od({parent:t,childToRemove:n,transaction:e})}else{const e=r<i.length-1?i[r+1]:i[r-1];aa.x2({store:n,id:e.id,currentUserId:t.currentUser.id})}ca.Od({parent:n.getContentStore(),childToRemove:o,transaction:e})}})}({environment:t,parentStore:r,tabStore:c,index:o})},children:(0,l.jsxs)("div",{style:{...f?d.selectedTab:d.tab},children:[(0,l.jsxs)(vr.Z,{role:"tab","aria-selected":f,"aria-controls":f?e.contentAriaId:void 0,"aria-posinset":o+1,"aria-setsize":v,id:f?e.selectedTabAriaId:void 0,style:{fontSize:16},onClick:()=>function(e,t,n){if(e.onChange(t),n&&!e.disabled){const n=e.parentStore.getContentStores()[t];da.$({blockStore:n,renderDelete:!0})}}(e,o,f),disabled:e.readOnly,mobileFeedback:m.isMobile,hovered:p,isGray:!f,children:[(0,l.jsx)(_a,{store:c}),(0,l.jsx)(ha.Z,{store:c,placeholder:n.formatMessage(Sa.untitledTab)})]}),f&&(0,l.jsx)("div",{style:d.border})]},o)},o)}function _a(e){window.__c={n:"TabIcon"};const{store:t}=e,{icon:n,isEmptyPage:o}=(0,a.VK)((()=>({icon:t.hasIcon()&&t.getIcon(),isEmptyPage:t.isEmptyPage()})),[t]);return n?(0,l.jsx)(ga.Z,{disabled:!0,icon:n,isEmptyPage:o,size:20,style:{marginRight:6}}):null}const Sa=(0,u.defineMessages)({untitledTab:{id:"tabMenuBlock.title.placeholder",defaultMessage:"Untitled"},addTab:{id:"tabMenuBlock.addTab",defaultMessage:"Add tab"},tabListLabel:{defaultMessage:"Tab block",id:"tabBlockMenu.tabListLabel"}});function wa(e){return{display:"flex",fontSize:14,width:"100%",paddingLeft:8,paddingRight:8,boxShadow:`0 1px 0 ${e.regularDividerColor}`,position:"relative",zIndex:1}}function ka(e){return{display:"flex",fontSize:16,width:"100%",paddingTop:2,paddingLeft:16,paddingRight:16,boxShadow:`0 1px 0 ${e.regularDividerColor}`,position:"relative",zIndex:2,height:44,background:e.popoverBackground}}function Ia(e){return{background:e.regularDividerColor,right:28,opacity:1,marginTop:6,marginBottom:12,width:1}}function Ca(e){return{borderBottom:`2px solid ${e.regularTextColor}`,position:"absolute",bottom:0,left:0,right:0}}class xa extends ye.Z{constructor(){super(...arguments),this.contentAriaId=(0,ie.Z)(),this.selectedTabAriaId=(0,ie.Z)(),this.storeTypes={shouldShowBottomBorder:Ge.default.createClass(!1)},this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove=e=>function(e,t,n){const o=e.currentTarget.getBoundingClientRect();n.setState(Ma(o,e.clientY,t))}(e,this.props.disabled,this.stores.shouldShowBottomBorder),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter=e=>function(e,t,n){const o=e.currentTarget.getBoundingClientRect();n.setState(Ma(o,e.clientY,t))}(e,this.props.disabled,this.stores.shouldShowBottomBorder),this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave=()=>{this.stores.shouldShowBottomBorder.setState(!1)}}handleCreated(){this.stores.shouldShowBottomBorder.setState(!1)}UNSAFE_willMount(e){const t=this.environment.currentUser.id;aa.nz({blockId:this.props.store.id,currentUserId:t})}renderPersisted(){return(0,l.jsxs)("div",{style:this.getStyle(),children:[(0,l.jsxs)("div",{onMouseMove:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseMove,onMouseEnter:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseEnter,onMouseLeave:this.CLASS_COMPONENT_CONVERSION_DO_NOT_TOUCH_handleMouseLeave,children:[(0,l.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:this.renderTabs()}),this.renderCurrentTab()]}),(0,l.jsx)(Ie.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store,hideIfSidebarOrMarginCommentsVisible:!0})]})}renderCurrentTab(){const e=ir.b(this.props.store);return(0,l.jsx)("div",{role:"tabpanel",id:this.contentAriaId,"aria-labelledby":this.selectedTabAriaId,style:{position:"relative"},children:(0,l.jsx)(sa.Z,{loaded:e,spinnerSize:"1em",showSpinnerTimeout:500,innerStyle:{display:"flex",flexDirection:"column"},children:this.renderLoadedContent()})})}renderLoadedContent(){const e=function(e){const t=aa.jL(e),n=e.getContentStores();return n.length>t?n[t]:n[0]}(this.props.store);return e?(0,l.jsx)(hn.Z,{store:e,analyticsName:"page_content",canSelect:!1,canDrag:!1,isListContainer:!0,style:{display:"flex",flexDirection:"column"},children:(0,l.jsx)(G.Z,{store:e.getContentStore(),disabled:this.props.disabled,disableContent:!1,emptyPlaceholder:this.renderPlaceHolder(e)})},e.id):null}renderPlaceHolder(e){return(0,l.jsx)(H.Z,{style:(t=this.theme,{fontSize:"inherit",width:"100%",borderRadius:4,caretColor:t.lightTextColor,...Ne.ZD,marginTop:2}),onClick:()=>function(e,t){Nt.createAndCommit({userAction:"TabBlock.handlePlaceholderClick",environment:t,perform:n=>{aa.ls({environment:t,store:e,transaction:n})}})}(e,this.environment),disabled:!this.canEdit(),children:(0,l.jsx)("span",{style:{color:this.theme.lightTextColor},children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Empty tab. Click or drop blocks inside.",id:"tabBlock.emptyBlock.placeholderText"})})});var t}renderTabs(){return(0,l.jsx)(ba,{contentAriaId:this.contentAriaId,selectedTabAriaId:this.selectedTabAriaId,disabled:!this.canEdit(),parentStore:this.props.store,tabs:this.props.store.getContentStores(),selectedIndex:aa.jL(this.props.store),onChange:e=>function(e,t,n){aa.a({store:t,index:e,currentUserId:n.currentUser.id})}(e,this.props.store,this.environment)})}getStyle(){return{paddingLeft:Ne.ZD.paddingLeft,flex:1,...Pa(this.theme,this.stores.shouldShowBottomBorder),...this.getBlockColorStyle(),...this.props.style}}}const Ta=xa;function Ma(e,t,n){return!n&&(!!U.Z.state.isDragging||(!!L.default.state.isActive||t<=e.bottom+20&&t>=e.bottom-20))}function Pa(e,t){return t.state?{boxShadow:`0 1px 0 ${e.regularDividerColor}`}:{}}var Aa=n(15145),Ra=n(85031),Da=n(25888),Ea=n(84210),Ba=n(18514),Fa=n(88923),Oa=n(78454);function Za(e,t){window.__c={n:"TableOfContentsBlock"};const n=(0,y.O7)(),o=(0,y.Fy)(),r=(0,i.useRef)(null),s=(0,p.PE)(e.store,e.disabled),c=e.disabled||!s,d=(0,a.VK)((()=>{const t=e.store.getRecordStoreUIRoot(),{mainEditorCurrentBlockStore:n}=Jr.default.state;return t===n?n:Fa.default.peekTarget.state===t?Fa.default.peekTarget.state:void 0}),[e.store]),m=(0,a.VK)((()=>_t.default.checkGate("toc_nested_headings")),[]),f=(0,a.VK)((()=>d?Ra.Q(d.id,e.store.getRecordModel,m):[]),[d,e.store.getRecordModel,m]),g=(0,i.useMemo)((()=>f.map((t=>lr.G.createChildStore(e.store,{table:wi.iU,id:t})))),[f,e.store]),h=(0,S.yK)((e=>({root:{position:"relative"},placeholder:{...Na,paddingTop:Ne.ZD.paddingTop,paddingBottom:Ne.ZD.paddingBottom,color:e.lightTextColor,...!c&&o.isMobile&&{marginRight:36}},actionMenuButton:{position:"absolute",top:3,right:6}})),[o.isMobile,c]),v=(0,l.jsx)("div",{style:h.placeholder,children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Add headings to create a table of contents. <linktohelpbutton>Learn more</linktohelpbutton>.",id:"tableOfContentsBlock.placeholder",values:{linktohelpbutton:e=>(0,l.jsx)(Ct.Z,{href:(0,Ba.UY)("guides.tableOfContents"),external:!0,onClick:()=>Da.Fs(n,{from:"table_of_contents_placeholder"}),children:e})}})}),b=(0,l.jsxs)(z.p,{allowSelectionWithin:!0,style:h.root,ref:r,children:[g.map((t=>(0,l.jsx)(Ua,{headerStore:t,index:g.indexOf(t),headerStores:g,store:e.store,navigableAncestor:d,style:e.style},t.id))),0===g.length&&v,!c&&o.isMobile&&(0,l.jsx)(we.Z,{style:h.actionMenuButton,tooltipContent:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"More actions…",id:"tableOfContentsBlock.mobileActionMenu.button.label"}),store:e.store,fadeIn:!1})]});return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"table_of_contents",getNode:()=>r.current,getBlockStore:()=>e.store})),[e.store]),b)}const Va=i.memo(i.forwardRef(Za),d.Z);function Ua(e){window.__c={n:"TableOfContentsBlockHeader"};const t=(0,a.VK)((()=>{if(void 0!==e.navigableAncestor)return(0,Ea.ZP)({store:e.navigableAncestor,scrollToBlockId:e.headerStore.id,fullyQualified:!1,pageVisitSource:Aa.tY.LinkInPage})}),[e.headerStore.id,e.navigableAncestor]),n=(0,a.VK)((()=>Ra.y({headerBlockId:e.headerStore.id,headerBlockIds:e.headerStores.map((e=>e.id)),index:e.index,getRecordModel:e.store.getRecordModel})),[e.headerStore.id,e.headerStores,e.index,e.store.getRecordModel]),o=(0,p.rv)(e.store),r=(0,S.yK)((()=>({container:o,innerHeader:{...Na,display:"flex",alignItems:"center",marginLeft:Oa.LK*n,paddingTop:2*Ne.ZD.paddingTop,paddingBottom:2*Ne.ZD.paddingBottom}})),[o,n]);return e.navigableAncestor?(0,l.jsx)("div",{style:{...r.container,...e.style},children:(0,l.jsx)(xe.Z,{href:t,external:!1,children:(0,l.jsx)("div",{style:r.innerHeader,children:(0,l.jsx)(ha.Z,{store:e.headerStore,shouldWrap:!1,underline:!0})})})}):null}const Na={paddingRight:Ne.ZD.paddingRight,paddingLeft:Ne.ZD.paddingLeft,fontSize:14,lineHeight:1.3};var La=n(17970),ja=n(11620),za=n(4859),qa=n(25157),Ha=n(91497),Wa=n(77926);const Ka=(0,u.defineMessages)({embedButtonText:{defaultMessage:"Embed Tweet",id:"tweetBlock.embedTweet.button.label"}});function Ga(e,t){window.__c={n:"TweetBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"tweet",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:r,ref:o,store:e.store,iconSvg:Wa.l,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with links to Tweets",id:"tweetBlock.linkInput.caption"}),embedButtonText:n.formatMessage(Ka.embedButtonText),urlInputPlaceholder:"https://twitter.com/… or https://x.com/",children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed a Tweet from X",id:"tweetBlock.placeholder"})}))}const $a=i.memo(i.forwardRef(Ga),d.Z),Qa=(0,s.I)("typeform",{viewBox:"0 0 30 31",svg:(0,l.jsx)("path",{d:"M15.027 30.53c-4.294-.036-8.467-2.247-11.47-5.222C.553 22.333-.09 19.78.009 15.654.107 11.53 1.2 7.81 4.047 4.68 6.895 1.55 10.121.11 14.25.006c4.129-.103 7.291 1.046 10.44 4.156 3.15 3.11 5.242 7.127 5.31 11.392.067 4.266-1.978 6.94-4.972 9.936-2.994 2.995-5.706 5.077-10 5.04zm-4.891-19.66h3.818v10.304h1.903V10.87h3.818V9.071h-9.54v1.798z"})});function Ya(e,t){window.__c={n:"TypeformBlock"};const n=(0,i.useRef)(null),o=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"typeform",getNode:()=>{const e=n.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:o,ref:n,store:e.store,iconSvg:Qa,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with any public Typeform link",id:"typeformBlock.embed.caption"}),children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed Typeform",id:"typeformBlock.placeholder"})}))}const Xa=i.memo(i.forwardRef(Ya),d.Z),Ja=(0,s.I)("video",{viewBox:"0 0 30 30",svg:(0,l.jsx)("path",{d:"M2,2v26h26V2H2z M26,6h-2V4h2V6z M22,14H8V4h14V14z M6,10H4V8h2V10z M6,12v2H4v-2H6z M6,16v2H4v-2H6z M6,20v2H4v-2H6z M8,16 h14v10H8V16z M24,20h2v2h-2V20z M24,18v-2h2v2H24z M24,14v-2h2v2H24z M24,10V8h2v2H24z M6,4v2H4V4H6z M4,24h2v2H4V24z M24,26v-2h2v2 H24z"})}),es=(0,u.defineMessages)({urlPlaceholder:{defaultMessage:"Paste the video link…",id:"videoBlock.linkInput.placeholder"},embedButtonText:{defaultMessage:"Embed video",id:"videoBlock.embedVideo.button.label"}});function ts(e,t){window.__c={n:"VideoBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"video",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,blockResizerStore:r,ref:o,store:e.store,iconSvg:Ja,preserveScale:!0,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"},{type:"file",videoUpload:!0}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with YouTube, Vimeo, and more",id:"videoBlock.linkInput.caption"}),embedButtonText:n.formatMessage(es.embedButtonText),urlInputPlaceholder:n.formatMessage(es.urlPlaceholder),children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed or upload a video",id:"videoBlock.placeholder"})}))}const ns=i.memo(i.forwardRef(ts),d.Z),os=(0,s.I)("whimsical",{viewBox:"0 0 32 32",svg:(0,l.jsxs)("g",{children:[(0,l.jsx)("path",{opacity:".8",fillRule:"evenodd",clipRule:"evenodd",d:"M12.807 9.772a.497.497 0 00-.705 0L5.76 16.146a.502.502 0 000 .708l6.343 6.374c.195.195.51.195.705 0l6.343-6.374a.503.503 0 000-.708l-6.343-6.374zm.352-2.479a.993.993 0 00-1.41 0l-8.457 8.499a1.005 1.005 0 000 1.416l8.458 8.499a.993.993 0 001.41 0l8.457-8.499c.39-.391.39-1.025 0-1.416l-8.458-8.499z",fill:"#A7A6A2"}),(0,l.jsx)("mask",{id:"a",maskUnits:"userSpaceOnUse",x:"3",y:"7",width:"19",height:"19",children:(0,l.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M12.807 9.772a.497.497 0 00-.705 0L5.76 16.146a.502.502 0 000 .708l6.343 6.374c.195.195.51.195.705 0l6.343-6.374a.503.503 0 000-.708l-6.343-6.374zm.352-2.479a.993.993 0 00-1.41 0l-8.457 8.499a1.005 1.005 0 000 1.416l8.458 8.499a.993.993 0 001.41 0l8.457-8.499c.39-.391.39-1.025 0-1.416l-8.458-8.499z",fill:"#fff"})}),(0,l.jsx)("g",{filter:"url(#filter0_d)",mask:"url(#a)",children:(0,l.jsx)("path",{d:"M18.84 7.293a.993.993 0 011.41 0l8.458 8.499c.39.39.39 1.025 0 1.416l-8.458 8.499a.993.993 0 01-1.41 0l-8.457-8.499a1.005 1.005 0 010-1.416l8.457-8.499z",fill:"#000",fillOpacity:".01"})}),(0,l.jsx)("path",{d:"M18.84 7.293a.993.993 0 011.41 0l8.458 8.499c.39.39.39 1.025 0 1.416l-8.458 8.499a.993.993 0 01-1.41 0l-8.457-8.499a1.005 1.005 0 010-1.416l8.457-8.499z",fill:"#A7A6A2"}),(0,l.jsx)("defs",{children:(0,l.jsxs)("filter",{id:"filter0_d",x:"8.055",y:"4.964",width:"22.98",height:"23.071",filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB",children:[(0,l.jsx)("feFlood",{floodOpacity:"0",result:"BackgroundImageFix"}),(0,l.jsx)("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"}),(0,l.jsx)("feOffset",{}),(0,l.jsx)("feGaussianBlur",{stdDeviation:"1.018"}),(0,l.jsx)("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.6 0"}),(0,l.jsx)("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow"}),(0,l.jsx)("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow",result:"shape"})]})})]})}),rs=(0,u.defineMessages)({embedButtonText:{defaultMessage:"Embed Whimsical",id:"whimsicalBlock.embeds.button.label"}});function is(e,t){window.__c={n:"WhimsicalBlock"};const n=(0,u.useIntl)(),o=(0,i.useRef)(null),r=(0,a.qz)(e.blockResizerStore,m.Z);return(0,p.ez)(e.store,t,(0,i.useMemo)((()=>({renderedType:"whimsical",getNode:()=>{const e=o.current;return e?e.getNode():null},getBlockStore:()=>e.store})),[e.store]),(0,l.jsx)(f.ZP,{...e,ref:o,store:e.store,iconSvg:os,mediaMenuCurrentTab:"embed",mediaMenuTabs:[{type:"embed"}],mediaMenuEmbedCaption:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Works with Whimsical links with Public Link Access enabled",id:"whimsicalBlock.embeds.caption"}),embedButtonText:n.formatMessage(rs.embedButtonText),urlInputPlaceholder:"https://whimsical.com/…",blockResizerStore:r,children:(0,l.jsx)(u.FormattedMessage,{defaultMessage:"Embed Whimsical",id:"whimsicalBlock.placeholder"})}))}const as=i.memo(i.forwardRef(is),d.Z);let ss;function ls(e){const t=e.getType();if(t)return"collection_view"===t&&e.recordStoreParentDiffersFromPersistedParent()?o.Z:(ss||(ss={text:La.Z,image:Hr,video:ns,bookmark:Ze,drive:wo,audio:oe,tweet:$a,gist:Or,maps:Zi,framer:Dr,invision:$r,file:Mr.Z,page:Ki.Z,to_do:ja.Z,toggle:za.ZP,bulleted_list:qe.Z,numbered_list:Wi.Z,code:Kt,factory:wr,button:He.Z,divider:oo,column_list:Ln,copy_indicator:Gn,embed:f.ZP,breadcrumb:ze,equation:zo,header:Zr.Z,sub_header:ra.Z,sub_sub_header:ia.Z,quote:$i.ZP,collection_view:nn.DZ,collection_view_page:o.Z,link_to_page:Ai,link_to_collection:_i,figma:Tr,loom:Ei,codepen:tn,typeform:Xa,column:bn,pdf:Gi.Z,callout:We.Z,table_of_contents:Va,whimsical:as,miro:Li,abstract:v,sketch:oa,excalidraw:Qo,alias:J.Z,transclusion_container:qa.Z,transclusion_reference:Ha.Z,replit:Ji,external_object_instance:Yo.Z,table:r.Wv,table_row:r.fZ,tab:Ta,hex:Lr,deepnote:Xn,mixpanel:Hi,external_object_instance_page:Yo.Z,ai_block:X,drawing:ao,personal_home_page:void 0}),ss[t])}},59557:(e,t,n)=>{n.d(t,{N:()=>d});var o=n(67294),r=n(480),i=n(86628),a=n(97880),s=n(82530),l=n(37181),c=n(80444);function d(e){const{blockStore:t}=e,n=(0,r.O7)(),d=(0,i.VK)((()=>c.default.state.currentUserSettingsStore),[]),u=(0,i.VK)((()=>{var e;return(0,a.$K)(null===(e=t.getModel())||void 0===e?void 0:e.getProperty("title"))}),[t]),p=(0,o.useCallback)((()=>{d&&s.createAndCommit({userAction:"FactoryButtonDeprecation.updateUserSettings",environment:n,perform:e=>{l.d2({userSettingsStore:d,transaction:e,data:{dismissed_factory_button_deprecation_banner:!0}})}})}),[d,n]),m=(0,o.useCallback)((()=>{if(!d)return;d.getSettingsStore().getKeyStore("seen_factory_button_deprecation_badge").getValue()||s.createAndCommit({userAction:"FactoryButtonDeprecation.updateUserSettings",environment:n,perform:e=>{l.d2({userSettingsStore:d,transaction:e,data:{seen_factory_button_deprecation_badge:!0}})}})}),[d,n]);return{showFactoryButtonDeprecationBadge:(0,i.VK)((()=>u&&!Boolean(null==d?void 0:d.getSettingsStore().getKeyStore("seen_factory_button_deprecation_badge").getValue())),[d,u]),showFactoryButtonDeprecationBanner:(0,i.VK)((()=>u&&!Boolean(null==d?void 0:d.getSettingsStore().getKeyStore("dismissed_factory_button_deprecation_banner").getValue())),[d,u]),handleDismissFactoryButtonMigrationBanner:p,setHasSeenFactoryButtonDeprecationBadge:m}}},29551:(e,t,n)=>{n.d(t,{Ht:()=>c,Vg:()=>d,gq:()=>l,xk:()=>a});n(67294);var o=n(79797),r=n(85893);function i(e){const{style:t,row:n,column:o,reverse:r,inline:i,...a}=e,s={display:i?"inline-flex":"flex"};return o?s.flexDirection=r?"column-reverse":"column":n?s.flexDirection=r?"row-reverse":"row":r&&(s.flexDirection="row-reverse"),Object.assign(s,a,t)}function a(){return i({...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},row:!0})}function s(){return i({...arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},column:!0})}function l(e){const{children:t,className:n,...o}=e;return(0,r.jsx)("div",{className:n,style:a(o),children:t})}function c(e){const{children:t,className:n,...o}=e;return(0,r.jsx)("div",{className:n,style:s(o),children:t})}function d(e){let{environment:t,pageBlockStore:n,pathToBlockId:r}=e;const i=new o.ST({environment:t,pointer:n.pointer,path:r}).getValue();return new o.G(t,{table:"block",spaceId:n.getSpaceId(),id:i})}},5595:(e,t,n)=>{n.d(t,{_Y:()=>r,mD:()=>o,rp:()=>i});const o=240,r=80,i=80},17377:(e,t,n)=>{n.d(t,{Z:()=>S});var o=n(67294),r=n(480),i=n(86628),a=n(24405),s=n(49271),l=n(9291),c=n(29373),d=n(82530),u=n(52315),p=n(35328),m=n(45131),f=n(64921),g=n(25777),h=n(55217),v=n(78454),b=n(4859),y=n(5210),_=n(85893);function S(e){window.__c={n:"FormatToggleable"};const t=(0,r.O7)(),n=(0,a.Fg)(),S=(0,o.useRef)(!0);(0,o.useLayoutEffect)((()=>{S.current&&(S.current=!1,c.nz({blockId:e.store.id,currentUserId:t.currentUser.id}),e.store.isDefaultRecordCache()&&c.LO(t,e.store.pointer))}));const w=(0,i.VK)((()=>e.store.getContentStore()),[e.store]),k=(0,i.VK)((()=>m.Z.isOpen(e.store.id)&&!e.hideContent),[e.hideContent,e.store.id]),I=(0,i.VK)((()=>!e.store.hasContent()),[e.store]),C=(0,o.useId)(),x=(0,o.useId)(),T=(0,i.VK)((()=>u.b(e.store)||!e.store.isDefaultRecordCache()),[e.store]),M=(0,o.useCallback)((()=>{p.th(t,e.store,e.hideContent)}),[t,e.hideContent,e.store]),P=(0,i.VK)((()=>p.fn(e.store)),[e.store]),A=(0,i.VK)((()=>{var t;return null===(t=e.store.getFormat())||void 0===t?void 0:t.toggleable}),[e.store]),R=(0,o.useCallback)((()=>{d.createAndCommit({userAction:"FormatToggleable.handlePlaceholderClick",environment:t,perform:n=>{c.ls({environment:t,store:e.store,transaction:n})}})}),[t,e.store]),D=(0,_.jsx)(f.Z,{style:{fontSize:"inherit",width:"100%",borderRadius:4,caretColor:n.lightTextColor,...s.ZD,marginTop:2},onClick:R,disabled:e.disabled,children:(0,_.jsx)("span",{style:{color:n.lightTextColor},children:(0,_.jsx)(l.FormattedMessage,{defaultMessage:"Empty toggle. Click or drop blocks inside.",id:"toggleBlockFormat.emptyBlock.placeholderText"})})}),E=(0,_.jsx)(y.Z,{"aria-describedby":C,"aria-controls":x,isSidebar:!1,open:k,fill:!I,onClick:M,tapArea:t.device.isMobile?{size:30}:void 0}),B=k?(0,_.jsx)(g.Z,{id:x,loaded:T,spinnerSize:"1em",showSpinnerTimeout:500,innerStyle:(0,b.kA)(),style:(0,b.J9)(),children:(0,_.jsx)(h.Z,{store:w,emptyPlaceholder:P?D:void 0,disabled:e.disabled,disableCommentMenu:e.disableCommentMenu,disableHoverMenu:e.disableHoverMenu,disableDrag:e.disableDrag})}):(0,_.jsx)(h.Z,{store:w,disabled:e.disabled,disableContent:!0});return P?(0,_.jsxs)(v.ZP,{style:{paddingLeft:s.ZD.paddingLeft},left:E,leftStyle:{paddingRight:2,...e.toggleStyle},children:[(0,_.jsx)("div",{id:C,style:e.childrenStyleWhenToggleable,children:e.children}),B]}):A?(0,_.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,_.jsx)("div",{style:e.childrenStyleWhenToggleable,children:e.children}),B]}):(0,_.jsx)(_.Fragment,{children:e.children})}},26198:(e,t,n)=>{n.d(t,{Lr:()=>a,jo:()=>l,uf:()=>i});var o=n(67294),r=n(67381);const i={track(e,t){t(!0)},untrack(e){}},a=(0,r.Q)({modernContextDefaultValue:i,displayName:"IFrameManagerContext",legacyContextKey:"iFrameManagerContext"}),s=(a.legacyPropTypes,a.context);function l(){const e=(0,o.useContext)(s),[t,n]=(0,o.useState)(!1),r=(0,o.useRef)(null);return[(0,o.useCallback)((t=>{r.current&&(e.untrack(r.current),r.current=null),t&&(r.current=t,e.track(t,n))}),[e]),t]}},66213:(e,t,n)=>{n.d(t,{LF:()=>r,ZO:()=>a,wK:()=>i});const o=(0,n(67381).Q)({modernContextDefaultValue:void 0,displayName:"OverrideLinkClickContext",legacyContextKey:"overrideLinkClick"}),r=o.Provider,i=o.legacyPropTypes,a=o.context},11368:(e,t,n)=>{n.d(t,{I3:()=>i,Ue:()=>a,zR:()=>r});const o=(0,n(67381).Q)({displayName:"ScrollerContext",legacyContextKey:"scrollerContext",modernContextDefaultValue:void 0}),r=o.Provider,i=o.legacyPropTypes,a=o.context},84064:(e,t,n)=>{n.d(t,{Tf:()=>s,aT:()=>a,ld:()=>l});const o={selectableContainer:void 0,closestSelectable:void 0},r="selectable",i=(0,n(67381).Q)({modernContextDefaultValue:o,displayName:r,legacyContextKey:r}),a=i.context,s=i.legacyPropTypes,l=i.Provider},68350:(e,t,n)=>{n.d(t,{U:()=>r});var o=n(82798);class r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;this.value=e,this.textInstanceId=t;const n=r.overrides.get(t);n&&e>n&&this.updateOverride()}get(){return r.overrides.get(this.textInstanceId)??this.value}set(e){const t=this.get();(0,o.T)(e>=t),this.value=e,this.updateOverride()}updateOverride(){r.overrides.set(this.textInstanceId,this.value)}static TEST_ONLY__clearOverrides(){this.overrides.clear()}}r.overrides=new Map},78791:(e,t,n)=>{n.d(t,{Cf:()=>f,Wc:()=>g,tE:()=>m});var o=n(41432),r=n(15095),i=n(59730),a=n(70203),s=n(82798),l=n(993),c=n(82530),d=n(65598),u=n(73959),p=n(27105);function m(e){const{transaction:t,targetStore:n,block:o}=e,r=(0,s.TO)(o.getTextSliceTree()),a=(0,u.sQ)(n);if(!a||!p.Ls({store:n,blockStore:a}))throw new i.p8("Previous block should exist and use CRDT");const l=(0,s.TO)(a.getTextSliceTree()).getLastTextSliceTreeInPreOrderTraversal(),d=r.getOperationsForSplitForMerge();(0,s.T)(0===d.textSliceTreesToMove.length,"Root nodes should have no siblings to move"),c.applyCrdtTextOperation({transaction:t,store:o,operation:{command:"splitText",pointer:o.pointer,path:[],args:d.splitOp},invertedOperation:void 0});const m=d.splitOp.textInstanceId,f=d.splitOp.id;c.applyCrdtTextOperation({transaction:t,store:o,operation:{command:"moveTextSlice",pointer:o.pointer,path:[],args:{textInstanceId:m,textSliceStartItemId:f,targetBlockId:a.id,targetTextInstanceId:l.getTextSlice().textInstanceId,targetTextSliceEndItemId:l.getTextSlice().getEndItem().id,isMerge:!0}},invertedOperation:{command:"invertedMoveTextSlice",pointer:o.pointer,path:[],args:{textInstanceId:m,textSliceStartItemId:f,targetTextInstanceId:m,targetTextSliceEndItemId:d.splitOp.id}}})}function f(e){const{environment:t,transaction:n,multiSelection:r,removedBlocks:i,movedBlocks:a}=e,c=r.start.store;function u(e){if(a.has(e))return;const i=e.getModel();if(null==i||!i.isType(o.wL))return;const d=e.getBlockTitleStore();(0,s.T)(p.FX(d)),d!==r.end.store&&(l.pe({environment:t,transaction:n,selection:{startIndex:0,endIndex:1/0},store:d}),m({transaction:n,block:e,targetStore:c}))}(0,s.T)(p.FX(c));for(const o of i){u(o);for(const e of(0,d.MI)({blockStore:o,traverseTransclusionReferences:!1}))u(e)}}function g(e){const{sourceBlockStore:t,targetBlockStore:n,splitAtGraphemeIndex:o,transaction:i,moveIntoNewBlock:l}=e;(0,s.T)(t.useCrdt()&&n.useCrdt());const d=t.getBlockTitleStore().getValue(),u=new r.W3(a.eeV(d)).getStringStartIndex(o),p=(0,s.TO)(t.getTextSliceTree()).getOperationsForSplitAtIndex(u);!function(e){const{blockStore:t,splitInfo:n,transaction:o}=e,r=n.textSliceTreesToMove,i="splitWithinNode"===n.type?n.textSliceTreeToSplit:n.newTextSliceTree;for(const a of r){const e=t.id,n=i.getTextSlice().textInstanceId,r=i.getTextSlice().getEndItem().id;c.applyCrdtTextOperation({transaction:o,store:t,operation:{command:"moveTextSlice",pointer:t.pointer,path:[],args:{textInstanceId:a.getTextSlice().textInstanceId,textSliceStartItemId:a.getTextSlice().getStartItem().id,targetBlockId:e,targetTextInstanceId:n,targetTextSliceEndItemId:r}},invertedOperation:void 0})}}({blockStore:t,splitInfo:p,transaction:i}),l?function(e){const{sourceBlockStore:t,targetBlockStore:n,splitInfo:o,transaction:r}=e;if("splitNodeEnd"===o.type){const e=o.newTextSliceTree,i=e.getTextSlice().textInstanceId,a=e.getTextSlice().getStartItem().id,s=o.previousTextSliceTree.getTextSlice();c.applyCrdtTextOperation({transaction:r,store:t,operation:{command:"moveTextSliceIntoBlock",path:[],pointer:t.pointer,args:{textInstanceId:i,textSliceStartItemId:a,targetBlockId:n.id}},invertedOperation:{command:"invertedMoveTextSlice",path:[],pointer:t.pointer,args:{textInstanceId:i,textSliceStartItemId:a,targetTextInstanceId:s.textInstanceId,targetTextSliceEndItemId:s.getEndItem().id}}})}else{const e=o.splitOp,{textInstanceId:i}=e;c.applyCrdtTextOperation({transaction:r,store:t,operation:{command:"splitTextIntoBlock",pointer:t.pointer,path:[],args:{...e,targetBlockId:n.id}},invertedOperation:{command:"invertedMoveTextSlice",pointer:t.pointer,path:[],args:{textInstanceId:i,textSliceStartItemId:e.id,targetTextInstanceId:i,targetTextSliceEndItemId:e.id}}})}}({sourceBlockStore:t,targetBlockStore:n,splitInfo:p,transaction:i}):function(e){const{sourceBlockStore:t,targetBlockStore:n,splitInfo:o,transaction:r}=e;let i,a,l,d;if("splitNodeEnd"===o.type){const e=o.newTextSliceTree;i=e.getTextSlice().textInstanceId,a=e.getTextSlice().getStartItem().id;const t=o.previousTextSliceTree.getTextSlice();l=t.textInstanceId,d=t.getEndItem().id}else c.applyCrdtTextOperation({transaction:r,store:t,operation:{command:"splitText",pointer:t.pointer,path:[],args:o.splitOp},invertedOperation:void 0}),i=o.splitOp.textInstanceId,a=o.splitOp.id,l=o.splitOp.textInstanceId,d=o.splitOp.id;const u=(0,s.TO)(n.getTextSliceTree()).getLastTextSliceTreeInPreOrderTraversal();c.applyCrdtTextOperation({transaction:r,store:t,operation:{command:"moveTextSlice",path:[],pointer:t.pointer,args:{textInstanceId:i,textSliceStartItemId:a,targetBlockId:n.id,targetTextInstanceId:u.getTextSlice().textInstanceId,targetTextSliceEndItemId:u.getTextSlice().getEndItem().id}},invertedOperation:{command:"invertedMoveTextSlice",path:[],pointer:t.pointer,args:{textInstanceId:i,textSliceStartItemId:a,targetTextInstanceId:l,targetTextSliceEndItemId:d}}})}({sourceBlockStore:t,targetBlockStore:n,splitInfo:p,transaction:i})}},27105:(e,t,n)=>{n.d(t,{FX:()=>l,Ls:()=>c,SL:()=>g,Sy:()=>f,be:()=>p,dy:()=>m,iG:()=>d,s8:()=>u});n(19056);var o=n(59730),r=n(21202),i=n(73959),a=n(77080),s=n(79797);n(68350);function l(e){if(!e.isTable(r.iU))return!1;const t=(0,i.sQ)(e);return!!t&&(t.useCrdt()&&t.getBlockTitleStore()===e)}function c(e){const{store:t,blockStore:n}=e;return n.useCrdt()&&n.getBlockTitleStore()===t}function d(e,t){const n=e.useCrdt(),o=t.some((e=>e.useCrdt()));return n&&!o||!n&&o}function u(e){return e.useCrdt()?"Cannot move a non-CRDT block into a CRDT parent":"Cannot move a CRDT block into a non-CRDT parent"}function p(e){const{parentStore:t,childStore:n}=e,r=t.getRecordStoreAtRootPath(),i=n.getRecordStoreAtRootPath();if(r instanceof s.G&&i instanceof s.G&&d(r,[i]))throw new o.p8("A CRDT block cannot be parented to a non-CRDT block or vice versa!")}function m(e){return h({invertDefault:!1,...e})}function f(e){const{event:t,...n}=e;return h({invertDefault:"click"===(null==t?void 0:t.type)&&"altKey"in t&&t.altKey,...n})}function g(e){const{event:t,...n}=e;return h({invertDefault:"click"===(null==t?void 0:t.type)&&t.altKey,...n})}function h(e){const{invertDefault:t,contextualDefault:n}=e;if(!a.default.checkGate("enable_text_crdt_client"))return!1;const o="source"in e&&(a.default.checkGate("enable_default_create_crdt_page")&&a.default.getConfigKey("default_create_crdt_page_config",e.source))||n;return o&&!t||!o&&t}},95645:(e,t,n)=>{n.d(t,{Z:()=>f});var o=n(83355),r=n(13991),i=n(8848),a=n(82990),s=n(92650),l=n(46654),c=n(65598),d=n(58202),u=n(79797),p=n(99757);class m extends o.Z{constructor(){super(...arguments),this.renderedType="block",this.getBlockStore=()=>this.props.store,this.canEditComputedStore=this.createComputedStore((()=>{if(this.props.disabled)return!1;if(p.n.state)return!1;const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,l.YF)(e)&&this.props.store.canEdit()})),this.marginCommentsVisible=this.createComputedStore((()=>(0,s.fg)(this.environment,this.props.store))),this.rootStorePageFont=this.createComputedStore((()=>{const e=this.props.store.getRecordStoreUIRoot();if(!(e instanceof u.G))return;const t=e.getFormatStore().getKeyStore("page_font").getValue();return a.Z.getHeaderFontFamily({pageFont:t,locale:r.SP})}))}get registries(){return[d.R]}canEdit(){return this.canEditComputedStore.state}canEditCollection(){if(this.props.disabled)return!1;if(p.n.state)return!1;const e=this.pageContext&&this.pageContext.publicEditModeStore.state;return!(0,l.YF)(e)&&this.props.store.canEditCollection()}canComment(){return!this.props.disabled&&(!p.n.state&&this.props.store.canComment())}canAdmin(){return!this.props.disabled&&(!p.n.state&&this.props.store.canAdmin())}canView(){const{store:e}=this.props;return e.canRead()}isRootOrDirectChild(){return this.props.store.isRootOrDirectChild()}renderComponent(){const{store:e}=this.props;if(e)return e?(0,c.SJ)(e)?void 0:this.renderPersisted():void 0}renderPersisted(){}getBlockColorStyle(){const e=this.props.store.getFormat().block_color||"default";return(0,i.fi)(e,this.theme)}}m.displayName="Block";const f=m},24098:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(86628),r=n(26344);function i(e){let{capture:t,render:n}=e;window.__c={n:"IgnoreClickArea"};const i=(0,r.Z)(t);return(0,o.VK)((()=>n(i)),[i,n])}},24039:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(67294),r=n(1302),i=n(65686);function a(e){let{children:t,...n}=e;return window.__c={n:"IgnoreContentScrollArea"},function(e){let{capture:t,preventType:n}=e;(0,o.useEffect)((()=>{if(t){const e={preventType:n};return r.default.afterNextFlush((()=>{i.Z.state.capturingAreas.add(e),i.Z.emit()})),()=>{r.default.afterNextFlush((()=>{i.Z.state.capturingAreas.delete(e),i.Z.emit()}))}}}),[t,n])}(n),t}},75179:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(86628),r=n(67294);function i(e){return e instanceof HTMLElement&&("true"===e.contentEditable||"input"===e.tagName.toLowerCase())}function a(e){let{capture:t,render:n}=e;window.__c={n:"KeepFocusArea"};const a=function(e){return(0,r.useMemo)((()=>({onMouseDown:t=>{if(e){if(i(t.target))return;i(document.activeElement)&&t.preventDefault()}}})),[e])}(t);return(0,o.VK)((()=>n(a)),[a,n])}},23586:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(83355),r=n(72126),i=n(85844),a=n(72087);class s extends o.Z{constructor(){super(...arguments),this.debounce=void 0,this.throttle=void 0,this.interval=void 0,this.browserInterval=void 0,this.requestCounter=0,this.storeTypes={requestStore:a.Z},this.handlePageVisibilityChange=()=>{i.Z.state.isVisible?this.interval||this.setRequestInterval():this.clearRequestInterval()},this.performRequest=async()=>new Promise(((e,t)=>{const{requestStore:n}=this.stores,{performRequest:o}=this.props,{request:r}=n.state;this.requestCounter++;const i=this.requestCounter;this.stores.requestStore.setState({...this.stores.requestStore.state,ready:!1,loading:!0}),o(r).then((t=>{this.requestCounter===i&&n.setState({...n.state,error:void 0,result:t,ready:!0,loading:!1}),e()})).catch((e=>{console.error(e),this.requestCounter===i&&n.setState({...n.state,error:e,result:void 0,ready:!0,loading:!1}),t(e)}))})),this.performRequestDebouncedWrapped=()=>{this.stores.requestStore.setState({...this.stores.requestStore.state,ready:!1,loading:!0}),this.performRequestDebounced()},this.performRequestDebounced=this.performRequest}async fetch(){return this.performRequest()}UNSAFE_willMount(e){super.UNSAFE_willMount(e),i.Z.addListener(this.handlePageVisibilityChange)}UNSAFE_willMountOrUpdate(e){super.UNSAFE_willMountOrUpdate(e);const{requestStore:t}=this.stores,{request:n,debounce:o,throttle:i,interval:a}=e;o!==this.debounce&&(this.debounce=o,this.performRequestDebounced=o?r.Ds(this.performRequest,o):this.performRequest),i!==this.throttle&&(this.throttle=i,this.performRequestDebounced=i?r.P2(this.performRequest,i):this.performRequest),a!==this.interval&&(this.interval=a,this.clearRequestInterval(),this.setRequestInterval()),r.Xy(n,t.state.request)||(t.setState({...t.state,request:n}),0!==this.requestCounter||e.performFirstRequestAsync?this.performRequestDebouncedWrapped():this.performRequest()),t.refresh=this.performRequest}willUnmount(){super.willUnmount(),i.Z.removeListener(this.handlePageVisibilityChange),this.clearRequestInterval()}shouldComponentUpdate(e){return!0}renderComponent(){const{requestStore:e}=this.stores,{render:t}=this.props,{error:n,result:o,ready:r}=e.state;return this.handlePageVisibilityChange(),t(n,o,r)}clearRequestInterval(){this.browserInterval&&(clearInterval(this.browserInterval),this.browserInterval=null)}setRequestInterval(){this.props.interval&&(this.browserInterval=setInterval(this.performRequest,this.props.interval))}}s.displayName="Request";const l=s},12457:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(83355),r=n(49085);class i extends o.Z{constructor(){super(...arguments),this.storeTypes={shown:r.default.createClass(!1)},this.showTimerId=void 0,this.hideTimerId=void 0}didMountOrUpdate(){this.props.show?(this.hideTimerId&&clearTimeout(this.hideTimerId),this.hideTimerId=void 0):(this.showTimerId&&clearTimeout(this.showTimerId),this.showTimerId=void 0),!this.props.show||this.stores.shown.state||this.showTimerId?this.props.show||!this.stores.shown.state||this.hideTimerId||(0===this.props.showHold?this.stores.shown.setState(!1):this.setupHideTimer()):0===this.props.showDelay?(this.stores.shown.setState(!0),0!==this.props.showHold&&this.setupHideTimer()):this.showTimerId=window.setTimeout((()=>{this.showTimerId=void 0,this.stores.shown.setState(!0),0!==this.props.showHold&&this.setupHideTimer()}),this.props.showDelay)}renderComponent(){return this.props.render(this.stores.shown.state)}setupHideTimer(){this.hideTimerId=window.setTimeout((()=>{this.hideTimerId=void 0,!this.props.show&&this.stores.shown.state&&this.stores.shown.setState(!1)}),this.props.showHold)}}i.displayName="Throttled";const a=i},28651:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{mouseEntered:!1,mousePressed:!1}}enter(){this.setState({...this.state,mouseEntered:!0})}exit(){this.setState({...this.state,mouseEntered:!1})}}const i=r},11059:(e,t,n)=>{n.d(t,{Z:()=>c});n(67294);var o=n(480),r=n(86628),i=n(22377),a=n(60682),s=n(24990),l=n(85893);const c=function(e){let{char:t,size:n,sprite:c}=e;window.__c={n:"Emoji"};const d=(0,o.O7)(),u=(0,r.VK)((()=>c||(0,a.e_)(d)),[d,c]),p=(0,r.VK)((()=>s.Z.state),[]);return(0,l.jsx)(i.Z,{char:t,size:n,type:u,emojiData:p})}},72187:(e,t,n)=>{n.d(t,{$P:()=>b,FZ:()=>f,II:()=>a,IQ:()=>o,Nm:()=>i,PS:()=>m,T8:()=>l,VJ:()=>v,WB:()=>c,fG:()=>h,jo:()=>u,kX:()=>p,mz:()=>d,pq:()=>s,qJ:()=>y,tg:()=>r,vP:()=>g});const o=12,r=9,i=2,a=12,s=16,l=32,c=24,d=44,u=32,p=356,m=12,f=l*o+2*m,g=9,h=f,v=270,b=10,y=2},60682:(e,t,n)=>{n.d(t,{e_:()=>a,kw:()=>s,sg:()=>l});var o=n(480),r=n(86628),i=n(80444);function a(e){const{device:t}=e;return t.isAndroid&&t.browserVersion.startsWith("73.")&&t.browserName.startsWith("Chrome")||t.isAndroid?"google":t.isWindows||t.isLinux?"twitter":"raw"}function s(){const e=(0,o.O7)();return(0,r.VK)((()=>a(e)),[e])}function l(){var e;return null===(e=i.default.state)||void 0===e||null===(e=e.currentUserSettingsStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.emoji_picker_skin_tone}},24990:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),r=n(24502);class i extends o.default{getInitialState(){return{positionalEmojiData:{},emojiByName:{},emojiByCategory:{},emojiByColorRaw:{},emojiByColorProcessed:{}}}async waitUntilLoaded(){await(0,r.M)()}}const a=new i},69783:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},21830:(e,t,n)=>{n.d(t,{XH:()=>y,pz:()=>h,qv:()=>g,vZ:()=>p,zp:()=>f});n(21703);var o=n(37599),r=n(92595),i=n(7406),a=n(68626),s=n(91155),l=n(29477),c=n(63143),d=n(9291),u=n(33929);const p="NotionTransactionTimeout",m=(0,d.defineMessages)({ReloadAllTabs:{defaultMessage:"Try closing and re-opening all Notion tabs or windows. Contact support if that doesn’t fix the issue.",id:"localDatabase.errorFixes.reloadAllTabs"},ReloadThisTab:{defaultMessage:"Try reloading Notion. Contact support if that doesn’t fix the issue.",id:"localDatabase.errorFixes.reloadThisTab"},AppProfileCorrupted:{defaultMessage:"Notion's local storage may be damaged. See (?) > Help & documentation > Reset Notion. Contact support if that doesn’t fix the issue.",id:"localDatabase.errorFixes.helpAndSupportPrompt"},FirefoxProfileCorrupted:{defaultMessage:"Your Firefox profile may be damaged. Visit https://firefox-storage-test.glitch.me/ to diagnose. Contact support if that doesn’t fix the issue.",id:"localDatabase.errorFixes.firefoxSettingsDamaged"},ChromeProfileCorrupted:{defaultMessage:"Your Chrome profile may be damaged. If you changed any chrome://flags then please reset them, then restart your browser. If issues persist, try making a new Chrome user. Contact support if that doesn’t fix the issue.",id:"localDatabase.errorFixes.chromeSettingsDamaged"},ChromeIndexedDBBucketError:{defaultMessage:"Your Chrome profile may be damaged. For a more consistent experience download the Notion desktop app: https://notion.so/desktop",id:"localDatabase.errorFixes.chromeUpgradeCorruptedSettings"},noDiskSpace:{defaultMessage:"No disk space remaining. Contact support if that doesn’t fix the issue.",id:"localDatabase.erroMessages.noDiskSpaceRemaining"},noDiskSpaceBrowserLimit:{defaultMessage:"No disk space remaining. Your browser settings may restrict the storage Notion can use. Contact support if that doesn’t fix the issue.",id:"localDatabase.erroMessages.noDiskSpaceRemainingBrowserLimit"}});function f(e){return e}function g(e){return Promise.all(e)}class h{constructor(e,t,n,o){this.databaseName=void 0,this.databaseVersion=void 0,this.debugLogger=new a.BatchedLogger({from:"IndexedDBWrapper",type:"BulkDebug",level:"info",maxLength:100,logToConsole:false}),this.latestTransactionId=0,this.openDbCallbacks=void 0,this.db=void 0,this.getDBPromise=void 0,this.environment=e,this.databaseName=t,this.databaseVersion=n,this.openDbCallbacks=o}async reset(){try{return await(0,o.Lj)(this.databaseName),{value:void 0}}catch(e){return{error:v({environment:this.environment,error:(0,i.tg)(e),details:`Failed to reset database ${this.databaseName}`,closed:!1,aborted:!1})}}finally{this.teardown()}}async startTransaction(e,t){const n="startTransaction";let o,r=0;const i=`${e.name}.${this.latestTransactionId++}`;do{try{const s=`${i} attempt #${r+1}`;if(this.debugLogInfo(n,`${s} starting`),o=await this.startTransactionAttempt({...e,name:i},t),!o.error){this.debugLogInfo(n,`${s} succeeded`);break}const c=`${s} errored, type=${o.error.type}`;if(!o.error.closed){this.debugLogInfo(n,`${c}, closed=false`);break}if(this.debugLogInfo(n,`${c}, closed=true`),this.db)try{this.db.close()}catch(a){this.debugLogInfo(n,`db.close() threw ${a}`)}if(this.teardown(),4===r)break;await l.Vs(250)}catch(a){return{error:a}}r++}while(r<5);return o}async startTransactionAttempt(e,t){const{storeNames:n,name:o,mode:r,timeoutMs:l}=e,c=`${o} failed`,d="startTransactionAttempt",u=await this.getDB();if(u.error)return u;const p=u.value,m=[];let f;try{f=p.transaction(n,r);const e=Date.now(),t=window.setTimeout((()=>{const t=Date.now()-e,n=`${o} has not completed after ${t} ms, which may prevent other transactions from running.`;this.debugLogInfo(d,n),a.log({from:"IndexedDBWrapper",type:"LongRunningTransactionWarning",level:"warning",data:{message:n,miscDataToConvertToString:{transactionLog:m}}})}),h.longRunningTimeoutMs);f.addEventListener("complete",(function(){window.clearTimeout(t)}));const i=e=>{e.stopPropagation(),window.clearTimeout(t)};f.addEventListener("error",i),f.addEventListener("abort",i)}catch(b){const e=(0,i.tg)(b);return{error:v({environment:this.environment,details:`Failed to create ${r} transaction on ${this.databaseName}.${n}`,error:e,aborted:!0,closed:"InvalidStateError"===e.name})}}const g=await this.runTransaction(f,t,o,l,(e=>{a.pushWithMaxLength(m,e,100)}));if("error"in g||g.abort){this.debugLogInfo(d,`${o} command returned failed/aborted status`);try{f.abort()}catch(y){this.debugLogInfo(d,`transaction.abort() threw ${y}`)}return f.done.catch((e=>{e&&a.log({from:"IndexedDBWrapper",type:"TransactionFailure",level:"error",error:(0,s.Ui)(v({environment:this.environment,details:c,error:e,aborted:!0,closed:!1}))})})),g}if(this.debugLogInfo(d,`${o} command returned successful status`),"readwrite"===r)try{await f.done}catch(y){return{error:v({environment:this.environment,error:(0,i.tg)(y),details:`In await transaction.done: ${c}`,aborted:null===y,closed:!1})}}else f.done.catch((e=>{a.log({from:"IndexedDBWrapper",type:"ReadOnlyTransactonFailureIgnored",level:"error",error:(0,s.Ui)(v({environment:this.environment,error:e,details:c,aborted:null===e,closed:!1}))})}));return{value:g.value}}freezeListener(){Boolean(this.db)&&(this.debugLogInfo("freezeListener"),a.log({level:"warning",from:"IndexedDBWrapper",type:"document.freeze",data:{dbName:this.databaseName,dbVersion:this.databaseVersion}}))}teardown(){this.debugLogInfo("teardown"),this.db=void 0,this.getDBPromise=void 0,document.removeEventListener("freeze",this.freezeListener)}debugLogInfo(e,t){this.debugLogger.log({from:"IndexedDBWrapper",level:"info",type:e,data:{message:t}})}async initDB(){try{this.debugLogInfo("initDB","Starting openDB()");const e=await(0,o.X3)(this.databaseName,this.databaseVersion,this.openDbCallbacks);return this.debugLogInfo("initDB","Completed openDB()"),document.addEventListener("freeze",this.freezeListener),e.addEventListener("close",(e=>{a.log({level:"warning",from:"IndexedDBWrapper",type:"db.onclose",data:{dbName:this.databaseName,dbVersion:this.databaseVersion},error:(0,s.Ui)(b(e))}),this.teardown()})),e.addEventListener("abort",(e=>{a.log({level:"warning",from:"IndexedDBWrapper",type:"db.onabort",data:{dbName:this.databaseName,dbVersion:this.databaseVersion}})})),e.addEventListener("error",(e=>{a.log({level:"error",from:"IndexedDBWrapper",type:"db.onerror",data:{dbName:this.databaseName,dbVersion:this.databaseVersion},error:(0,s.Ui)(b(e))})})),e.addEventListener("versionchange",(()=>{a.log({level:"warning",from:"IndexedDBWrapper",type:"db.onversionchange",data:{dbName:this.databaseName,dbVersion:this.databaseVersion}}),e.close(),this.teardown()})),{value:e}}catch(e){return{error:v({environment:this.environment,details:"Unable to initialize database",error:(0,i.tg)(e),aborted:!1,closed:!1})}}}async getDB(){let e=this.db;if(!e){this.getDBPromise||(this.getDBPromise=this.initDB().then((e=>(e.error?this.teardown():(this.db=e.value,this.getDBPromise=void 0),e)),(e=>(this.teardown(),{error:{type:"InitDBException",message:"An unexpected error occurred trying to create the database.",details:"Exception in initDB",error:e,closed:!1,aborted:!1}}))));const t=await this.getDBPromise;if(t&&t.error)return t;e=t.value}return{value:e}}async runTransaction(e,t,n,o,r){try{const i=Date.now(),a=t(e,(e=>{this.debugLogInfo("runTransaction",`${n} command: ${e}`),r(e)}));if(void 0!==o&&o>=0){const e=await l.aM(a,o);if(e.timeout){const e=Date.now()-i,t=new Error(`Timeout after ${e}ms: exceeded limit ${o}ms by ${e-o}ms`);throw t.name=p,this.debugLogInfo("runTransaction",`${n} ${t.name}: ${t.message}`),this.debugLogger.flush(),t}return e.result}r("Awaiting commandResultPromise.");const s=await a;return r("Done awaiting commandResultPromise."),s}catch(a){return{error:v({environment:this.environment,error:(0,i.tg)(a),details:`In runTransaction catch: ${n} failed`,closed:!1,aborted:!1})}}}}function v(e){const{environment:t,error:n,details:o,closed:r,aborted:i}=e;if(n){if(n.name===p)return{type:p,details:o,message:`Storage operation did not complete. ${u.default.formatMessage(m.ReloadAllTabs)}`,error:n,closed:!1,aborted:!1};if("TimeoutError"===n.name&&"Transaction timed out due to inactivity."===n.message)return{type:"TransactionTimeout",details:o,message:`IndexedDB access attempt timed out. ${u.default.formatMessage(m.ReloadThisTab)}`,error:n,closed:r,aborted:i};if("VersionError"===n.name)return{type:"OutdatedSchemaVersion",details:o,message:`This tab is running an outdated version of Notion. ${u.default.formatMessage(m.ReloadThisTab)}`,error:n,closed:r,aborted:i};if("UnknownError"===n.name&&"Internal error opening backing store for indexedDB.open."===n.message)return{type:"ChromeUnknownInternalError",details:o,message:`Cannot open IndexedDB. ${t.device.isNative?u.default.formatMessage(m.AppProfileCorrupted):u.default.formatMessage(m.ChromeProfileCorrupted)}`,error:n,closed:r,aborted:i};if(t.device.isBrowser&&"UnknownError"===n.name&&"Internal error retrieving bucket data directory."===n.message)return{type:"ChromeUnknownInternalError",details:o,message:u.default.formatMessage(m.ChromeIndexedDBBucketError),error:n,closed:r,aborted:i};if("SecurityError"===n.name&&"IDBFactory.open() called in an invalid security context"===n.message)return{type:"SafariIframeSecurityError",details:o,message:"Cannot access IndexedDB in an iframe in your browser. Try opening Notion in a new window or use a different browser.",error:n,closed:r,aborted:i};if("UnknownError"===n.name&&"Connection to Indexed Database server lost. Refresh the page to try again"===n.message)return{type:"SafariIndexedDatabaseServerLost",details:o,message:`Cannot access IndexedDB due to a bug in Safari/WebKit. ${u.default.formatMessage(m.ReloadThisTab)}`,error:n,closed:r,aborted:i};if("InvalidStateError"===n.name&&"A mutation operation was attempted on a database that did not allow mutations."===n.message)return{type:"FirefoxPrivateBrowsing",details:o,message:"Firefox does not allow IndexedDB in Private Browsing. Try opening Notion in a normal window.",error:n,closed:r,aborted:i};if("NotFoundError"===n.name&&"The operation failed because the requested database object could not be found. For example, an object store did not exist but was being opened."===n.message)return{type:"FirefoxObjectStoreNotFound",details:o,message:`An IndexedDB object store does not exist. ${u.default.formatMessage(m.ReloadAllTabs)} ${u.default.formatMessage(m.FirefoxProfileCorrupted)}`,error:n,closed:!0,aborted:i};if("QuotaExceededError"===n.name){let e=u.default.formatMessage(m.noDiskSpace);return t.device.isBrowser&&(e=u.default.formatMessage(m.noDiskSpaceBrowserLimit)),{type:"QuotaFull",details:o,message:e,error:n,closed:r,aborted:i}}if(window.navigator.userAgent.includes("WindowsWechat")&&"AbortError"===n.name&&"Version change transaction was aborted in upgradeneeded event handler."===n.message)return{type:"UnsupportedWechat",details:o,message:"This device or application is unsupported.",error:n,closed:r,aborted:i}}return{type:"UnknownIndexedDBError",details:o,message:`An unknown IndexedDB error occurred. ${u.default.formatMessage(m.ReloadThisTab)}`,error:n||new Error("createIndexedDBError: error was falsy"),closed:r,aborted:i}}function b(e){if(e&&e.target&&"error"in e.target){const t=e.target.error;if(!t)return;return`${t.name}: ${t.message}`}}function y(e,t){if(e.stack)return e;try{const n=new Error(`${e.message} (${t})`);throw n.name=e.name,n}catch(n){return e.stack=(0,i.tg)(n).stack,e}}h.longRunningTimeoutMs=5*c.hM,(0,r.exposeDebugValue)("idbUnwrap",o.Wg)},3932:(e,t,n)=>{n.d(t,{Y:()=>i});var o=n(4615),r=n(45953);class i{constructor(e){this.id=(0,o.ZP)(),this.spaceId=void 0,this.userId=void 0,this.committed=!1,this.isLocal=!1,this.useSudoMode=void 0,this.deadlockWarningTimeout=void 0,this.operations=[],this.stores=[],this.initialRecordMap=r.PF.create(),this.invertedOperations=[],this.postPerformAssertions=[],this.preEnqueueActions=[],this.postEnqueueActions=[],this.postSubmitCallbacks=[],this.postCancelCallbacks=[],this.userAction=void 0,this.userFlow=void 0;const{spaceId:t,userId:n,deadlockTimeoutMs:i,onDeadlockWarning:a}=e;t&&n&&(this.spaceId=t,this.userId=n),a&&(this.deadlockWarningTimeout=window.setTimeout(a,i))}isEmpty(){return 0===this.operations.length}annotateWithUserAction(e){this.userAction=e}getUserActionForAnalyticsPurposesOnly(){return this.userAction}annotateWithUserFlow(e){this.userFlow=e}getUserFlowForAnalyticsPurposesOnly(){return this.userFlow}cancelDeadlockWarning(){void 0!==this.deadlockWarningTimeout&&(window.clearTimeout(this.deadlockWarningTimeout),this.deadlockWarningTimeout=void 0)}done(e){this.cancelDeadlockWarning();for(const t of this.postSubmitCallbacks)t(e)}}},2414:(e,t,n)=>{n.d(t,{h:()=>r});var o=n(29477);class r{constructor(e){this.SCALE=1.5,this.MAX=15,this.waitable=new o.a6,this.failures=0,this.observer=e}getDelay(e){return Math.min(this.MAX,Math.pow(this.SCALE,e))}reset(){var e;this.waitable.trigger(),this.waitable=new o.a6,this.failures=0,null===(e=this.observer)||void 0===e||e.onReset()}async backOffOnFailure(e,t){var n;const r=this.failures;this.failures++;const i=e*this.getDelay(r)-e;null===(n=this.observer)||void 0===n||n.onBackoff(i,t),await this.waitable.wait(e,i),this.waitable=new o.a6}getFailures(){return this.failures}}},63037:(e,t,n)=>{n.d(t,{CE:()=>s,Os:()=>r,Ud:()=>i,V_:()=>a,xd:()=>l});var o=n(63143);function r(e,t){t.startsWith("offline -")?t="offline":t.startsWith("mobileNativeError -")&&(t="mobileNativeError");const n=e[t]||0;e[t]=n+1,e._total+=1}const i=1*o.C0,a=.5*o.C0,s=10*o.C0,l=5*o.C0},68204:(e,t,n)=>{n.d(t,{E$:()=>s,L1:()=>c,RP:()=>l,sG:()=>a,vG:()=>d});n(57658);var o=n(58573),r=n(72126);const i=25;function a(e){const{sections:t,context:n,query:a}=e;let s=a.trim().toLowerCase();if(s.startsWith("/")&&(s=s.slice(1)),!s)return c(t,n);const l=function(e){return e.map((e=>({...e,actions:e.actions.map((t=>{const n=t.searchName||t.displayName||"",o=[n,e.searchTitle||e.title||"",n].join(" ");return{...t,searchName:o}}))})))}(c(function(e,t){const n=[];for(const o of e){const e={...o,actions:[]};for(const r of o.actions)if(r.subActions){if(r.collapseSubActionsIntoParent){for(const n of r.subActions(t))for(const t of n.actions)e.actions.push(t);continue}const i=r.subActions(t).map((e=>({...e,key:`${o.key} ${r.key} ${e.key}`,title:e.title||r.displayName,searchTitle:[r.searchName||r.displayName,e.searchTitle||e.title].filter(Boolean).join(" ")})));for(const e of i)n.push(e)}else e.actions.push(r);e.actions.length&&n.push(e)}return n}(t,n),n)),d=[],u=new Map;for(const o of l)for(const e of o.actions)u.set(e,o),d.push(e);const p=(0,o.ZP)(s,d,(e=>e.searchName||""),{minThreshold:i,getSortScore:e=>-e.score*(e.original.sortScoreMultiplier??1)}),m=new Set(p),f=d.filter((e=>Boolean(e.alwaysShowInSearch)&&!m.has(e))),g=f.filter((e=>"start"===e.alwaysShowInSearch)),h=f.filter((e=>"end"===e.alwaysShowInSearch)),v=r.vM([...g,...p,...h],(e=>{const t=u.get(e);if(t)return t.title})),b=[];for(const o of Object.keys(v)){const e=v[o],t=u.get(e[0]);t&&b.push({...t,actions:e})}return b}function s(e,t){if(!t)return e;let n=0;const o=[];for(const r of e){if(n>=t)break;const e=r.actions.slice(0,t-n);e.length>0&&(n+=e.length,o.push({...r,actions:e}))}return o}function l(e,t){const n=[];for(const o of e){const e=o.actions.filter(t);e.length>0&&n.push({...o,actions:e})}return n}function c(e,t){return l(e,(e=>d(e,t)))}function d(e,t){if(e.validators){return e.validators.every((e=>e(t)))}return!0}},19037:(e,t,n)=>{n.d(t,{S4:()=>nn,xD:()=>me,AK:()=>mn,j2:()=>hn,XQ:()=>at,Eo:()=>it,v_:()=>gn,wF:()=>Xe,ro:()=>et,WC:()=>cn,sR:()=>Ht,O4:()=>qt,_J:()=>Xt,cW:()=>Wt,nW:()=>Me,zz:()=>xe,RF:()=>Te,U4:()=>Lt,U_:()=>Se,eo:()=>ke,OO:()=>In,J5:()=>_e,k5:()=>we,KE:()=>ye,M:()=>be,NW:()=>Et,vy:()=>Bt,Zk:()=>wn,IT:()=>st,FS:()=>Ue,YB:()=>rt,iJ:()=>Dt,TK:()=>Rt,IC:()=>Xn,xk:()=>De,ry:()=>Re,Kb:()=>yn,Jl:()=>Sn,Kh:()=>Ft,T2:()=>Ot,lr:()=>to,OT:()=>Vn,W3:()=>Ln,p4:()=>Nn,zO:()=>zn,l$:()=>Ge,KJ:()=>qe,z2:()=>Un,EJ:()=>jn,W5:()=>On,y9:()=>fn,iK:()=>tn,_T:()=>yt,lA:()=>Le,b4:()=>je,Dt:()=>mt,k6:()=>Mn,Vw:()=>Kt,UI:()=>Jt,W2:()=>Ke,fy:()=>Hn,xw:()=>kt,YG:()=>Tt,f7:()=>It,dM:()=>At,p5:()=>Yn,zX:()=>Qe,YO:()=>un,oY:()=>en,Vf:()=>Ne,VB:()=>We,P5:()=>$n,FY:()=>Ye,D:()=>Ut,RO:()=>bn,d:()=>lt,ar:()=>ct,Vc:()=>Jn,Rr:()=>$e,QL:()=>nt,K5:()=>Ie,LH:()=>Ce,$H:()=>ze,J8:()=>ot,Mg:()=>Pt,nJ:()=>zt,gn:()=>pt,US:()=>Zn,IZ:()=>Ct,mq:()=>dn,Nn:()=>rn,vj:()=>Mt,OX:()=>eo,JF:()=>Ve,fI:()=>Ze,wT:()=>xn,Gz:()=>tt,sz:()=>ve,HB:()=>Qn,p1:()=>Fe,b1:()=>Gt,jl:()=>_t,V5:()=>ut,Cj:()=>He,I:()=>vn,tq:()=>gt,Fx:()=>ft,_z:()=>Oe,EC:()=>he,q4:()=>ln,tY:()=>vt,DF:()=>sn,F6:()=>pn,KH:()=>jt,vd:()=>$t,YZ:()=>bt,Id:()=>Bn,$I:()=>wt,lv:()=>on,vM:()=>qn,Gg:()=>St,FX:()=>Ee,Mn:()=>ht,AT:()=>no,lP:()=>ro,X:()=>Pe,FO:()=>oo,_n:()=>Fn,U7:()=>ge,pl:()=>Wn,c2:()=>Ae,$c:()=>Tn,P9:()=>Je,ED:()=>dt,OF:()=>Rn,YP:()=>An,ur:()=>Dn,Rd:()=>En,tJ:()=>Pn,DU:()=>Zt,ff:()=>fe,or:()=>pe,Tx:()=>an,eM:()=>kn,uq:()=>Cn,jp:()=>Gn,KS:()=>Kn,QY:()=>Vt,KL:()=>Nt,zl:()=>Yt});var o=n(41432),r=n(50475),i=n(80951),a=n(42509),s=n(43593),l=n(74181),c=n(72126),d=n(87479),u=n(72141);const p=["TypeScript","JavaScript","GraphQL","HTML","CSS","Scss","JSON","XML","Rust"];var m=n(21202),f=n(6287),g=n(70279),h=n(63921),v=n(29369),b=n(90965),y=n(64684),_=n(70203),S=n(10906),w=n(95477),k=n(69783),I=n(28020),C=n(78429),x=n(75770),T=n(85957),M=n(46654),P=n(18514),A=n(95697),R=n(58202),D=n(81844),E=n(40134),B=n(50694),F=n(63208),O=n(80444),Z=n(16772),V=n(88632),U=n(807),N=n(24042),L=n(64233),j=n(77080),z=n(19111),q=n(88923),H=n(83212),W=n(81236),K=n(79797),G=(n(49557),n(55320)),$=n(27724),Q=n(10743),Y=n(99757),X=n(24666),J=n(35057),ee=n(49117),te=n(77181),ne=n(11599),oe=n(92783),re=n(68056),ie=n(35026),ae=n(98165),se=n(59139),le=n(28187),ce=n(48779),de=n(89086),ue=n(85644);const pe=function(e){return t=>e.some((e=>e(t)))},me=function(e){return t=>e.every((e=>e(t)))},fe=function(e){return t=>!e(t)},ge=e=>e.blocks&&1===e.blocks.length,he=e=>e.blocks&&e.blocks.length>1,ve=e=>!!(0,C.H)()&&e.blocks.every((e=>{const t=e.getParentId(),n=e.recordStoreUIParentStore,o=null==n?void 0:n.id;return t&&o&&t!==o})),be=e=>e.blocks.every((t=>{const n=t.recordStoreUIParentStore;if(!n)return!1;const o=e.publicEditMode?e.publicEditMode:(0,ae.n3)(n)&&H.Z.getMode(e.environment,n);return!M.YF(o)&&n.canEdit()})),ye=e=>{const{environment:t}=e;return e.blocks.every((e=>M.KE({environment:t,block:e})))},_e=e=>!Y.n.state&&e.blocks.every((t=>"suggest"!==U.Z.getMode(t)&&(!M.YF(e.publicEditMode)&&t.canEdit()))),Se=e=>!Y.n.state&&e.blocks.every((t=>{if(M.YF(e.publicEditMode))return!1;const n=ne.$0();return n?n.canEditCollection():t.canEdit()})),we=e=>!Y.n.state&&e.blocks.every((t=>!M.YF(e.publicEditMode)&&(t.isCollectionView()?t.canEditCollection():t.canEdit()))),ke=e=>{let{environment:t,publicEditMode:n,blocks:o}=e;if(Y.n.state)return!1;const{id:r}=t.currentUser;return!!r&&(!M.YF(n)&&o.every((e=>{const n=(0,M.WE)({userId:r,store:e}).filter((t=>{let{type:n,role:o}=t;if(!o)return!1;const r=e.isCollectionView()||e.isTemplate()?u.D7(o):u.J5(o);return"public_permission"!==n&&r}));return n.length>0&&M.KE({environment:t,block:e})})))},Ie=e=>{if(e.blocks&&1===e.blocks.length){const[n]=e.blocks;if(n.isCollectionView()){var t;const e=null===(t=n.getCollectionViewCollectionStore())||void 0===t?void 0:t.getValue();if(e)return(0,a.Gq)(e)||(0,a.Ev)(e)||(0,a.OY)(e)}}return!1},Ce=e=>{if(e.blocks&&1===e.blocks.length){const[n]=e.blocks;if(n.isCollectionView()){var t;const e=null===(t=n.getCollectionViewCollectionStore())||void 0===t?void 0:t.getValue();if(e)return(0,a.Ev)(e)}}return!1},xe=e=>!Y.n.state&&e.blocks.every((e=>e.canAdmin())),Te=e=>!Y.n.state&&e.blocks.every((e=>e.canComment())),Me=e=>e.blocks.some((e=>Boolean(R.R.findBlockFromStoreWithMethod(e,"activate")))),Pe=e=>e.blocks.every((e=>e.isRestricted())),Ae=e=>{const{currentSpaceStore:t}=O.default.state,{currentUser:n}=e.environment;return(t?t.getPermissionItems():[]).some((e=>u.jg(e)&&e.user_id===n.id&&u.zz(e.role)))},Re=function(){const e=I.np();return!e||!e.isLocked()},De=()=>{const e=I.np();return Be(e)},Ee=e=>e.blocks.some((e=>Be(e))),Be=e=>{if(!e)return!1;return!!e.getAssociatedCollectionStore()},Fe=e=>e.blocks.length>0&&e.blocks.some((e=>e.isLocked())),Oe=e=>e.blocks.length>0,Ze=e=>e.blocks.some((e=>{const t=I.np();return!!(t&&t.isPageBlock()&&t.isLocked()&&t.uiContains(e)&&t!==e)})),Ve=e=>e.blocks.some((e=>{const{mainEditorCurrentBlockStore:t}=O.default.state;return Boolean(t&&t.isCollectionView()&&t.isLocked()&&t.uiContains(e)&&t!==e)})),Ue=e=>e.blocks.every((e=>{const t=e.getType();return Boolean(t&&(0,o.XD)(t)&&!(0,o.S9)(t))})),Ne=e=>{var t;const n=null===(t=O.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id;if(e.blocks[0]){const t=e.blocks[0].getType(),r=e.blocks[0].id;return Boolean(t&&r===n&&(0,o.XD)(t))}return!1},Le=e=>e.blocks.every((e=>{const t=e.getRecordStoreUIParent();return Boolean(t&&e.isDefined()&&e.getParentId()!==t.id)})),je=e=>e.blocks.every((e=>{const t=e.getRecordStoreUIParent();return Boolean(t&&t.canEdit()&&e.isDefined()&&e.getParentId()!==t.id)})),ze=e=>{if(e.blocks){const t=e.blocks[0];return Boolean(t&&t.isDefined()&&t.getType()===o.Ti.file&&t.getProperties().source)}return!1},qe=e=>{if(!e.blocks)return!1;const t=e.blocks[0],n=t&&t.getProperties().source;if(!n)return!1;const o=i.zB(n);return!!o&&s.E$(o,[w.default.secureFileS3.url,w.default.secureFileS3V2.url])},He=e=>{if(e.blocks){const t=e.blocks[0];if(t.isType(o.Ok))return Boolean(t.getProperties())}return!1},We=e=>{if(e.blocks){const t=e.blocks[0],n=t&&t.getType();return Boolean(n&&(0,o.VB)(n))}return!1},Ke=e=>{if(e.blocks){const t=e.blocks[0].getModel();return Boolean(null==t?void 0:t.isType(o.oe))}return!1},Ge=e=>t=>{if(t.blocks){const n=t.blocks[0];return Boolean(n&&n.getProperties()[e])}return!1},$e=(Ge("source"),e=>{if(!ge(e))return!1;const t=e.blocks&&e.blocks[0];if(t){const e=t.getType();return Boolean(e&&(0,o.XD)(e)&&t.isEmptyTitle())}return!1}),Qe=e=>{if(e.blocks){const t=e.blocks[0],n=null==t?void 0:t.getModel();return Boolean(null==n?void 0:n.isType(o.f4))}return!1},Ye=e=>{if(e.blocks){const t=e.blocks[0];if(t&&t.getType()===o.Ti.transclusionReference){const e=t.getTransclusionReferenceTargetStore();return Boolean(e&&e.canEdit())}return!1}return!1},Xe=e=>e.blocks.every((e=>{const t=e.getModel(),n=e.getRecordStoreUIParent();return Boolean(t&&t.isType(o.Zi)&&t.getType()!==o.Ti.transclusionContainer&&e.getParentTable()!==f.v&&n&&n.id===e.getParentId())})),Je=e=>t=>t.blocks&&t.blocks[0]&&c.mf(t.blocks[0].getType)&&t.blocks[0].getType()===e,et=e=>t=>c.yW(t.blocks,(t=>t&&c.mf(t.getType)&&t.getType()===e)),tt=e=>{const t=e.blocks[0],{language:n}=t.getProperties(),o=(0,_.QaF)(n);return p.includes(o)},nt=e=>()=>j.default.checkGate(e),ot=e=>t=>{if(1!==t.blocks.length)return!1;const n=t.blocks[0],o=n.getParentBlockStore(),r=null==o?void 0:o.getContentStores(),i=null==r?void 0:r.map((t=>t.getType()===e));if(!i||0===(null==i?void 0:i.length))return!1;const a=null==r?void 0:r.map((e=>e.id)).indexOf(n.id);return void 0!==a&&(0===a||!i[a-1])},rt=e=>e.blocks.every((e=>{const t=null==e?void 0:e.getModel();return null!=t&&t.isType("button")?j.default.checkGate("button_block_colors"):Boolean((null==t?void 0:t.isType(o.Zj))&&e.getParentTable()!==f.v)})),it=e=>{const t=I.RM();return!!t&&e.blocks.every((e=>t.uiContains(e)&&t.id!==e.id))},at=e=>{const t=e.blocks[0],n=null==t?void 0:t.getRecordStoreUIRoot();return!!n&&e.blocks.every((e=>n.uiContains(e)&&n.id!==e.id))},st=e=>e.blocks.every((e=>{const t=R.R.findBlockFromStoreWithMethod(e,"canRenderFullScreen");return Boolean(t&&t.canRenderFullScreen())})),lt=function(e){let{environment:{device:t}}=e;return t.isElectron},ct=function(){return Boolean(N.Z.state.isElectronHandlingZoom)},dt=function(e){let{environment:{device:t}}=e;return t.isWindows},ut=function(e){let{environment:{device:t}}=e;return t.isMac},pt=function(e){let{environment:{device:t}}=e;return t.isIOS},mt=function(e){let{environment:{device:t}}=e;return t.isAndroid},ft=function(e){let{environment:{device:t}}=e;return t.isMobileNative},gt=function(e){let{environment:{device:t}}=e;return t.isMobile},ht=function(e){let{environment:{device:t}}=e;return t.isPhone},vt=function(e){let{environment:{device:t}}=e;return t.isNative},bt=function(e){let{environment:{device:t}}=e;return!t.isMobile},yt=()=>w.default.isAdminMode,_t=e=>{let{environment:t}=e;return Boolean(t.currentUser.isLoggedIn()||t.publicDomainUserId)},St=function(){return V.Z.state.online},wt=e=>!e.blocks.every((t=>{const n=t.inMemoryRecordCache===e.environment.defaultRecordCache.inMemoryRecordCache,o=t.inMemoryRecordCache.cacheFallbacks.has(e.environment.defaultRecordCache.inMemoryRecordCache);return n||o})),kt=e=>e.blocks.some((e=>e.isTemplate())),It=e=>e.blocks.some((e=>e.isCollectionViewPageWithContent())),Ct=e=>e.blocks.every((()=>!xt()||hn("page",!1)(e))),xt=()=>{const e=I.np();return null==e?void 0:e.isCollectionViewPageWithContent()},Tt=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return t.isCollectionView()}return!1},Mt=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return t.isType(o.Ti.collectionView)}return!1},Pt=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return t.isType(o.Ti.collectionViewPage)}return!1},At=function(e){return t=>{if(t.blocks&&1===t.blocks.length){const[n]=t.blocks,o=R.R.findCollectionViewBlockFromStore(n);return!!o&&o.collectionContextStore.getViewType()===e}return!1}},Rt=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks;return 1===t.getCollectionViewStores().length}return!1},Dt=e=>{if(e.blocks&&1===e.blocks.length){const[t]=e.blocks,n=t.getCollectionViewCollectionStore();if(!n)return!1;const o=n.getSchema();return Object.values(o).map((e=>null==e?void 0:e.type)).every((e=>e&&B.g$.isPropertyTypeConvertableToSimpleTable[e]))}return!0},Et=e=>P.NW(e.environment),Bt=e=>P.vy(e.environment),Ft=function(){return L.Z.state.open},Ot=function(){return k.Z.state.open},Zt=function(){return z.Z.state.open},Vt=function(){return Q.Z.state.open},Ut=function(){return"editing"===X.default.state.mode},Nt=function(){return"empty"!==X.default.state.mode&&!(0,re.iG)(X.default.state.multiSelection)},Lt=function(){return!((0,de.J6)(_.GKr.User)||(0,de.J6)(_.GKr.Bot)||(0,de.J6)(_.GKr.Date)||(0,de.J6)(_.GKr.Page))},jt=function(){return $.default.state.stores.length>0},zt=e=>{const t=O.default.state.currentSpaceStore;return(0,ce.Cx)(t)},qt=e=>e.blocks.every((e=>Boolean(D.Z.findOutlinerItemFromStore(e)))),Ht=e=>e.blocks.every((e=>{const t=D.Z.findOutlinerItemFromStore(e);return Boolean(t&&t.isTopLevelItem&&"bookmarks"===t.type)})),Wt=e=>e.blocks.every((e=>{const t=D.Z.findOutlinerItemFromStore(e);return Boolean(t&&t.isTopLevelItem&&"shared"===t.type)})),Kt=e=>{const t=e.blocks[0];if(!t)return!1;const n=t.getParentBlockStore();return!!n&&n.isLocked()},Gt=e=>!$t(e),$t=e=>{if(!(0,A.bq)())return!0;const t=e.blocks[0];if(t){if(t.getParentTable()===v.e0){const n=(0,ae.VP)(t);if(!n||!(0,ie.si)({teamStore:n,environment:e.environment}))return!1}}return!0};function Qt(e){if(!e)return;const t=e.getParentPointer(),n=e.getRecordStoreUIParent();return(null==t?void 0:t.table)===v.e0&&n?K.zX.createChildStore(n,t):Qt(e.getParentBlockStore())}const Yt=e=>{const{id:t}=e.environment.currentUser;return!!t&&e.blocks.every((e=>{const n=e.getPermissionItems();return(0,d.ws)(n,t)}))},Xt=e=>e.blocks.every((e=>{const t=D.Z.findOutlinerItemFromStore(e);return Boolean(t&&t.isTopLevelItem)})),Jt=e=>{const{currentSpaceViewStore:t}=O.default.state,n=e.blocks[0];return Boolean(t&&n&&(0,oe.Z)({spaceViewStore:t,pageId:n.id}))},en=e=>{const t=I.np();return e.blocks[0]&&e.blocks[0]===t},tn=e=>e.blocks.every((t=>Boolean(M.IJ(e.environment,t)))),nn=e=>e.blocks.every((e=>M.S4(e))),on=e=>Boolean(O.default.state.mainEditorCurrentBlockStore),rn=e=>T.Tx()&&e.blocks[0]&&e.blocks[0]===q.default.peekTarget.state,an=e=>T.Tx(),sn=e=>e.blocks.every((e=>{const t=null==e?void 0:e.getType();return Boolean(t&&(0,o.S9)(t))})),ln=e=>1===e.blocks.length&&(0,I.qG)(e.blocks[0].id),cn=e=>!e.blocks.some((e=>{const t=null==e?void 0:e.getSystemBlockTypeStore().getValue();return(0,r.u7)(t)})),dn=e=>{var t;if(1!==e.blocks.length)return!1;const n=e.blocks[0],o=S.fm(n),r=null==o||null===(t=o.collectionViewBlockStore())||void 0===t?void 0:t.id;return!(!o||!r)&&Boolean(I.qG(r)&&o.isCompactView.state)},un=e=>e.blocks.some((e=>{e.useCrdt()})),pn=e=>e.blocks.every((e=>{const t=e.getType(),n=e.getFormat();return Boolean(t&&(0,o._T)(t,n))})),mn=e=>e.blocks.every((e=>Boolean(e.findRecordStoreUIAncestor((e=>e instanceof K.Xr||e instanceof K.G&&e.isCollectionView())).ancestor))),fn=e=>{let{blocks:t}=e;return t.length>0&&(0,te.bX)(t[0])},gn=e=>{let{blocks:t}=e;return S.v_(t)};function hn(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return n=>n.blocks.every((n=>{const o=S.fm(n,t),r=null==o?void 0:o.collectionViewStore();return(null==r?void 0:r.getType())===e}))}const vn=function(){const{currentSpaceStore:e}=O.default.state;return Boolean(e&&e.canRead())},bn=function(){const{currentSpaceStore:e}=O.default.state;return Boolean(e&&e.canEdit())},yn=e=>{if(w.default.isAdminMode)return!0;if(e.blocks.some((e=>{const t=(0,E.B)({blockId:e.id,setting:"disableExport"});return Boolean(null==t?void 0:t.disabled)})))return!1;if(zt(e)&&!xe(e))return!1;const t=_n(e),{environment:n,blocks:o}=e;return o.every((e=>{const o=(0,ae.VP)(e);return o?(!n.currentUser.id||!(0,y.s8)({team:{membership:o.getRawMembership()},userId:n.currentUser.id}))&&!o.getDisableExport():t}))},_n=function(e){let{environment:t}=e;const{currentSpaceStore:n}=O.default.state;if(!n)return!1;const o=W.Z.getPublicSpaceData(t,n.id);return n.isDefined()?!n.getDisableExport():o?!o.disableExport:yt()},Sn=()=>{const{currentSpaceStore:e}=O.default.state;return!!e&&!e.getDisableMoveToSpace()},wn=e=>!Y.n.state&&(!!e.blocks.every((e=>e.canEdit()))&&!!tn(e)),kn=e=>e.blocks.every((t=>{var n;return"edit"===(null===(n=H.Z.getMode(e.environment,t))||void 0===n?void 0:n.permission)})),In=e=>{if(!be(e))return!1;const t=e.blocks.filter((e=>{const t=e.recordStoreUIParentStore,n=e.getParentStore();return t&&n&&t.id===n.id}));return 0===t.length||_e({...e,blocks:t})},Cn=e=>{let{environment:t}=e;const n=(0,I.k_)(t).state;return Boolean(n&&n.showSharedOverflowButton)},xn=e=>{let{blocks:t}=e;return t.some((e=>Boolean(e.findRecordStoreUIAncestor((e=>e instanceof K.G&&e.isTransclusionType())).ancestor)))},Tn=e=>{let{environment:t}=e;return"on"===j.default.getGroup("lucy-in-the-sky-with-tab-blocks")},Mn=e=>{let{blocks:t}=e;if(!t||0===t.length)return!1;const n=t[0].getType(),r=t[0].getFormat();return Boolean(r.block_width)&&!Boolean(r.block_page_width)&&!Boolean(r.block_full_width)&&Boolean(n&&(0,o._7)(n))},Pn=function(e){var t;let{blocks:n}=e;return Boolean(null===(t=(0,le.Jk)(n[0]))||void 0===t||null===(t=t.slackIntegrationStore)||void 0===t?void 0:t.isReady())},An=function(){var e;const{currentSpaceStore:t}=O.default.state,n=null==t||null===(e=t.getBotSettingsStore())||void 0===e?void 0:e.getValue();return!(0,b.CJ)(n)||Boolean((null==n?void 0:n.integration_approval_statuses)&&n.integration_approval_statuses[l.T0])},Rn=function(e){var t;let{blocks:n}=e;const{slackIntegrationStore:o}=(0,le.Jk)(n[0]);return Boolean(o.isReady()&&!(null!=o&&null!==(t=o.getKeyStore("enabled"))&&void 0!==t&&t.getValue()))},Dn=function(e){var t;let{blocks:n}=e;const{blockStore:o,slackIntegrationStore:r}=(0,le.Jk)(n[0]);return Boolean(r.isReady()&&(null==r||null===(t=r.getKeyStore("enabled"))||void 0===t?void 0:t.getValue())&&o.id!==n[0].id)},En=function(e){var t;let{blocks:n}=e;const{blockStore:o,slackIntegrationStore:r}=(0,le.Jk)(n[0]);return Boolean(r.isReady()&&(null==r||null===(t=r.getKeyStore("enabled"))||void 0===t?void 0:t.getValue())&&o.id===n[0].id)},Bn=function(e){var t;let{blocks:n}=e;return(null===(t=n[0])||void 0===t?void 0:t.getSpaceId())!==h.N3},Fn=e=>1===e.blocks.length&&e.blocks[0].getType()===o.Ti.table,On=e=>{const t=F.Z.state;return t.isActive&&1===e.blocks.length&&e.blocks[0]===t.simpleTableStore},Zn=e=>{let{blocks:t}=e;return t.some((e=>Boolean(e.isImmediateColumnChild())))},Vn=e=>{const t=F.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n}=t;return B.g$.getNumberOfColumns(n)>1},Un=e=>{const t=F.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:o}=t,r=0===o.start.row&&o.end.row===B.g$.getNumberOfRows(n)-1,i=0<=o.start.col&&o.start.col<=o.end.col&&o.start.col<=B.g$.getNumberOfColumns(n)-1;return"column"===o.type&&i&&r},Nn=e=>{const t=F.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:o}=t,r=0===o.start.row&&o.end.row===B.g$.getNumberOfRows(n)-1,i=0===o.start.col&&0===o.end.col;return"column"===o.type&&i&&r},Ln=e=>{const t=F.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n}=t;return B.g$.getNumberOfRows(n)>1},jn=e=>{const t=F.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:o}=t,r=0===o.start.col&&o.end.col===B.g$.getNumberOfColumns(n)-1,i=0<=o.start.row&&o.start.row<=o.end.row&&o.start.row<=B.g$.getNumberOfRows(n)-1;return"row"===o.type&&i&&r},zn=e=>{const t=F.Z.state;if(!t.isActive)return!1;const{simpleTableStore:n,selection:o}=t,r=0===o.start.col&&o.end.col===B.g$.getNumberOfColumns(n)-1,i=0===o.start.row&&0===o.end.row;return"row"===o.type&&i&&r},qn=e=>{let{environment:t}=e;return(0,J.QM)()},Hn=e=>{if(1!==e.blocks.length)return!1;const t=e.blocks[0].getParentStore();return!(!t||t.table!==m.iU)&&t.isType(o.Ti.tab)},Wn=e=>{const t=e.blocks[0];return Boolean(t&&t.isCollectionView()&&t.getCollectionViewSourceCollectionStore())},Kn=e=>{if(!ge(e))return!1;const t=e.blocks[0];return(0,ue.z)(t)},Gn=e=>(e=>{let{environment:t,blocks:n}=e;if(!(0,A.bq)())return!1;if(!x.lQ({environment:t,blocks:n}))return!1;const o=t.currentUser.id,{currentSpaceStore:r}=O.default.state;if(!o||null==r||!r.isDefined())return!1;if(!A.Xq({environment:t,spaceStore:r}))return!1;for(const s of n){var i,a;if(!s.isPageBlock())return!1;if("team"!==(null===(i=D.Z.findOutlinerItemFromStore(s))||void 0===i?void 0:i.type))return!1;const e=null===(a=Qt(s))||void 0===a?void 0:a.getMembers();if(!e||!(0,y.pd)({membership:e},o))return!1}return!0})(e)&&bt(e);function $n(){const{currentSpaceStore:e}=O.default.state,t=null==e?void 0:e.getBotSettingsStore().getValue();return!(0,b.CJ)(t)||Boolean((null==t?void 0:t.integration_approval_statuses)&&t.integration_approval_statuses[l._o])}const Qn=e=>Boolean(e.blocks[0].getFormat().is_placeholder),Yn=e=>{var t;return Boolean((null===(t=e.blocks[0].getFormat().alias_pointer)||void 0===t?void 0:t.table)===g.x_)},Xn=()=>{const e=I.np();if(!e||!e.hasContent())return!1;if(1===e.getContentLength()){const t=e.getContentStores()[0].getTitleStore();if(Q.Z.state.open&&Q.Z.state.textStore===t)return!1;if(Z.default.isEditingEmptyBlock())return!1}return!0};function Jn(){return Boolean(N.Z.state.isElectronUsingCommandNumber)}const eo=e=>e.blocks.some(ee.td),to=e=>e.blocks.every((e=>{const t=null==e?void 0:e.getModel();return null!=t&&t.isType("button")?j.default.checkGate("button_block_colors"):Boolean(null==t?void 0:t.isType(o.Nn))}));function no(){return G.default.state.open}const oo=e=>(0,se.rd)(e.environment),ro=e=>{const{environment:t}=e,{device:n}=t,o="quickSearch"===t.RouterStore.state.route.name;return n.isElectron&&o}},97978:(e,t,n)=>{n.d(t,{NM:()=>he,ls:()=>Ze,mc:()=>Se,Cd:()=>He,of:()=>Te,Ts:()=>Ae,eR:()=>Re,cG:()=>Ne,TA:()=>Ce,nZ:()=>Oe,nB:()=>qe,oT:()=>Ve,fK:()=>fe,$A:()=>ge,Jq:()=>ve,pH:()=>Ee,Ug:()=>ze,ci:()=>We,j:()=>_e,UG:()=>Ie,lu:()=>ke,kB:()=>xe,oP:()=>ye,Zf:()=>be});var o=n(1302),r=n(82496),i=n(65680),a=n(97880);const s="v2";function l(e){let t=[];if(e.length>0){if(t=e.filter((e=>{let{code:t}=e;return(0,i.Qh)(t)})),0===t.length)return"en-US";const n=t[0].quality,o=t.filter((e=>{let{quality:t}=e;return t===n}));let r=o.find((e=>"en"===e.code));return r||(r=o[0]),function(e){let t=(0,a.qg)(i.vi,e.code)?i.vi[e.code]:i.vi.en;return"es"===e.code?t="ES"===e.region?"es-ES":"es-LA":"zh"===e.code&&(t="TW"===e.region||"HK"===e.region?"zh-TW":"zh-CN"),t}(r)}return"en-US"}function c(e){const t=function(e){return l(r.parse(e))}(e);return`${s}/${t}`}var d=n(15145),u=n(53504),p=n(33728),m=n(55632),f=n(68626),g=n(15157),h=n(72126),v=n(77897),b=n(4615),y=n(9852),_=n(47425),S=n(64684),w=n(7250),k=n(64002),I=n(54642),C=(n(95477),n(28020)),x=n(33929),T=n(75538),M=n(12252),P=n(58455),A=n(80444),R=n(77080),D=n(88893),E=n(88280),B=(n(57658),n(93214));const F="not_defined";let O=function(e){return e.BASE_SPACE_DATA="base_space_data",e.SPACE_MEMBER_DATA="space_member_data",e.SPACE_NONMEMBER_DATA="space_nonmember_data",e.SPACE_DATA_NOT_LOADED="space_data_not_loaded",e}({});var Z=n(72141),V=n(29477),U=n(62992),N=n(73123),L=n(98165),j=n(85957),z=n(51),q=n(88923),H=n(81236),W=n(79797),K=n(87956),G=n(35057),$=n(99334),Q=n(12955),Y=n(74503),X=n(57491);const J="__mobileNativeSessionInfo";var ee=n(46654),te=n(48779);async function ne(e,t,n){const o=await Te(e),{preboot:r,dontWait:i}=n||{};i||r||await async function(e){e.currentUser.isLoggedIn()&&A.default.state.mainEditorCurrentBlockStore&&(await A.default.waitUntil((()=>Boolean(A.default.state.mainEditorCurrentBlockStore&&A.default.state.mainEditorCurrentBlockStore.isReady))),A.default.state.currentSpaceStore&&await E.subscriptionDataStoreInstance.waitUntilLoaded());P.default.shouldRefresh(e.currentUser.id)&&await Ee(e)}(e);const a=i?void 0:await le(e),s=Re(),{currentUserStore:l,currentSpaceStore:c}=A.default.state,d=(0,X.getMobileNativeDeviceInfo)(),u=window[J]??{},p=await(0,Y.getDesktopDeviceInfo)(),m=await async function(e,t){const n=await(0,Q.hasPermissionForThirdPartyService)("amplitude",e),o=(0,B.l$)(t);return{is_user_consent_to_track:n,tid:o}}(e,t),f=(null==a?void 0:a.space_id)||void 0;return{data:{...ae(),...o,...a,...ie(),...Ae(),...se(),...re(),...oe({userId:null==l?void 0:l.id,spaceId:null==c?void 0:c.id}),...p,...d,...u,...s,...m,...ue(),...(g={spaceId:f,userId:Ve(),deviceId:o.device_id,eventName:t},{unique_event_marker:de(g)})},spaceId:null==a?void 0:a.space_id};var g}function oe(e){const{userId:t,spaceId:n}=e;if(!t||!n)return;const o=He({userId:t,spaceId:n});return o?{notion_session_id:o.id,notion_session_start_ts:o.sessionStartTime,tab_id:(0,y.c$)(),tab_count:(0,$.K)()}:void 0}function re(){const e=K.Z.state;if(e)return{queryId:e.queryId}}const ie=function(){const e=q.default.state,t=j.mH(),n=C.np();if(n){const o=ee.YO(n).map((e=>{let{permissionItem:t}=e;return t})),r=o.find((e=>"public_permission"===e.type)),i=o.find((e=>"space_permission"===e.type)),s=o.filter((e=>"user_permission"===e.type&&(0,Z.rz)(e.role))),l=o.filter((e=>"user_permission"===e.type&&(0,Z.J5)(e.role))),c=function(e){const t=L.uJ(e),n=[],o=h.xH(t.map((e=>{if(e instanceof W.zX)return;const t=e.getCopiedFromPointer();return t&&U.J(t)&&n.push(t.id),n})).filter(a.$K));return o}(n),d=Boolean(c)&&c.length>0,u=e.open?void 0:A.default.state.currentCollectionViewStore,{publicPageData:p}=z.Z.state,m=n.getCopiedFromPointer();return{page_id:n.id,page_public_role:r?r.role:F,page_space_role:i?i.role:F,page_all_collaborator_count:l.length+s.length,page_editor_collaborator_count:l.length,page_read_only_collaborator_count:s.length,page_content_count:n.getContentLength(),page_current_user_role:n.getRole(),page_is_peek:t,page_copied_from:m?(0,b.F9)(m.id):void 0,page_is_notion_template:!!m&&U.J(m),page_is_template:n.isTemplate(),page_is_prepopulated:d,page_prepopulated_template_ids:c,page_is_database:n.isCollectionView(),page_view_type:u?u.getType():void 0,page_user_has_explicit_access:p?p.userHasExplicitAccess:F}}};function ae(){const{currentSpaceViewStore:e}=A.default.state;return e&&e.isDefined()?{notify_desktop:e.getNotifyDesktop(),notify_email:e.getNotifyEmail(),notify_mobile:e.getNotifyMobile(),notify_email_digest:e.getNotifyEmailDigest()}:{}}const se=function(){const{mainEditorCurrentBlockStore:e}=A.default.state;if(e){const t=L.VP(e);if(t)return{team_id:(0,b.cj)(t.id)}}return{}};async function le(e){var t;await(0,V.OI)(2e3,Promise.all([E.subscriptionDataStoreInstance.waitUntilLoaded(),z.Z.waitUntilLoaded()]));const n=E.subscriptionDataStoreInstance.state,{currentUserStore:o,currentSpaceStore:r}=A.default.state,{publicPageData:i}=z.Z.state,a=(0,C.zj)(),s=a?(0,b.F9)(a):void 0,{mainEditorCurrentBlockStore:l}=A.default.state,c=null!=r&&r.isDefined()?{id:null==r?void 0:r.id,settings:null==r?void 0:r.getSettings(),email_domains:null==r?void 0:r.getEmailDomains(),plan_type:null==r?void 0:r.getPlanType(),initial_use_cases:null==r?void 0:r.getInitialUseCases(),invite_link_enabled:null==r?void 0:r.getInviteLinkEnabled(),created_by_id:null==r?void 0:r.getCreatedById(),created_time:r.getCreatedTime()}:void 0,d=(null==r?void 0:r.id)||(null==i?void 0:i.spaceId)||(null==l?void 0:l.getSpaceId()),u=Boolean(null==c||null===(t=c.settings)||void 0===t?void 0:t.is_teams_enabled),{currentUserRootStore:p}=A.default.state,m=p&&p.isReady()?h.jj(p.getSpaceViewStores().map((e=>e.getSpaceId()))).length:void 0;if(d&&o&&r&&n){const t=H.Z.getPublicSpaceData(e,d),o=D.YK(n),i=D.CM(n).length||0,a=D.su(n),l=D.lk(n),p=n.hasPaidNonzero,f=t?t.domain:void 0,g=c&&c.email_domains?c.email_domains:void 0,v=D.zl(e,n),y=(0,te.Ib)(t),_=(0,te.ww)(t),S=h.hj(v)&&!Number.isNaN(v)&&v!==1/0?v:0;return{space_analytics_data_type:O.SPACE_MEMBER_DATA,subscription_tier:(0,G.zt)(),page_id:s,space_id:(0,b.F9)(d),space_is_subscribed:o,space_visible_total:i,space_visible_members:a,space_visible_guests:l,space_visible_members_bucketized:(0,N.aT)(a),space_block_usage:D.Lz(e,n),space_block_usage_over_limit:D.Ln(e,n),space_role:r.getRole(),space_block_usage_percent:S,space_timeline_view_usage:D._9(n)?n.timelineViewUsage:void 0,space_created_time:y,available_credit:0,space_domain:f,space_email_domains:g,space_has_paid_nonzero:p,space_plan_type:_,space_initial_use_cases:c?c.initial_use_cases:void 0,space_invite_link_enabled:null==c?void 0:c.invite_link_enabled,space_created_by:null!=c&&c.created_by_id?(0,b.F9)(c.created_by_id):void 0,teams_is_enabled:u,current_space_view_count:m}}if(i){const t=i.spaceId?H.Z.getPublicSpaceData(e,i.spaceId):void 0,n=(0,te.Ib)(t),o=(0,te.ww)(t);return{space_analytics_data_type:O.SPACE_NONMEMBER_DATA,space_id:d?(0,b.F9)(d):void 0,space_domain:i.spaceDomain,page_id:s,subscription_tier:(0,G.zt)(),space_created_time:n,space_plan_type:o,space_invite_link_enabled:null==c?void 0:c.invite_link_enabled,space_created_by:null!=c&&c.created_by_id?(0,b.F9)(c.created_by_id):void 0,teams_is_enabled:u,current_space_view_count:m}}return c?{space_analytics_data_type:O.BASE_SPACE_DATA,space_id:(0,b.F9)(c.id),space_created_time:c.created_time,space_plan_type:c.plan_type,space_invite_link_enabled:c.invite_link_enabled,space_created_by:c.created_by_id?(0,b.F9)(c.created_by_id):void 0,teams_is_enabled:u,current_space_view_count:m}:{space_analytics_data_type:O.SPACE_DATA_NOT_LOADED,space_id:null!=r&&r.id?(0,b.F9)(null==r?void 0:r.id):void 0,current_space_view_count:m}}const ce={};function de(e){const{spaceId:t,userId:n,deviceId:o,eventName:r}=e,i=(0,b.Ul)(`${t}:${n}:${o}:${r}`),a=ce[i],s=Date.now();if(!a)return ce[i]=s,!0;const l=new Date(a),c=new Date(s);return l.getUTCDate()!==c.getUTCDate()?(ce[i]=s,!0):void 0}function ue(){let e;return R.default.state.isLoaded&&(e=R.default.getStatsigExperimentsMap()),{experiments:e,experimentStoreLoaded:R.default.state.isLoaded}}var pe=n(36867);const me=18e5;async function fe(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];const t=P.default.verboseAnalytics;if(await m.fK({traits:e}),t)for(const n of e)console.log("track:%c identify","font-weight: bold;",n)}async function ge(e){const{environment:t,userId:n,traits:o,skipIntercom:r}=e,i=P.default.shouldRefresh(n)?await Ee(t):P.default.state,a=function(e){const t=Re();if(!t.user_id)return;const{user_id:n,email:o,name:r,...i}=e;return{...i,user_id:t.user_id,email:t.email,name:t.name}}(o);if(!a)return void f.rateLimitedLog({level:"warning",from:"analyticsHelpers",type:"noCleanAnalyticsUser"});const s=(0,b.F9)(a.user_id);if(!r){var l;const e=x.default.getIntl(),t=null===(l=A.default.state.currentUserStore)||void 0===l?void 0:l.getFullName(e);w.$A({userId:s,userName:t,traits:a,settings:i})}if(null!=i&&i.isLoggingEnabled){const e=C.VU().map(b.F9),n=await le(t),o=await Te(t),r=await async function(e){if(await(0,Q.hasPermissionForThirdPartyService)("mutiny",e)){const t="mutiny.user.token",n=await(0,Q.getCookie)(e,t)||window.localStorage.getItem(t);if(n)return{mutinyVisitorId:n}}return{}}(t),{accept_language_raw:i,accept_language_preference:l}=o,c=(0,u.Z)({accept_language_raw:i,accept_language_preference:l},"ignore-class-instances"),d={...o,...r,space_has_paid_nonzero:!(!n||!("space_has_paid_nonzero"in n))&&n.space_has_paid_nonzero,integrations:{All:!0}},p={...a,user_email:a.email,...c,...d};m.$A({userId:s,traits:p,spaceIds:e})}P.default.verboseAnalytics&&console.log("identify:",JSON.stringify(o))}const he=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:P.default.verboseAnalytics;await m.HX(),e&&console.log("deidentify user")};async function ve(e){const t=await le(e);if(P.default.state.isIntercomEnabled){const e=await async function(e){const{currentUserRootStore:t,currentUserStore:n}=A.default.state;if(n&&t&&e){await Promise.all([t.load(),n.load()]);const o=t.getSpaceViewStores();await Promise.all(o.map((e=>e.load())));const r=h.oA(o.map((e=>e.getSpaceStore())));return await Promise.all(r.map((e=>e.load()))),h.oA(r.map((t=>{const o=t.isDefined()?{id:t.id,plan_type:t.getPlanType(),beta_enabled:t.getBetaEnabled()}:void 0;if(o){const r=(0,b.F9)(o.id);if(r===e.space_id){const r=E.subscriptionDataStoreInstance.state,i=D.XX(r),a={id:e.space_id,name:Fe(n,o.plan_type),size:(0,te.jv)(t).length,is_subscribed:"space_is_subscribed"in e&&e.space_is_subscribed,is_beta:Boolean(o.beta_enabled)};return i&&(a.plan=i.plan),"space_data_not_loaded"!==e.space_analytics_data_type&&e.space_created_time&&(a.company_created_at=e.space_created_time),a}return{id:r,name:Fe(n,o.plan_type),size:(0,te.jv)(t).length}}})))}return[]}(t);w.Jq({companiesData:e})}t&&P.default.state.isLoggingEnabled&&m.Jq({spaceId:t.space_id,spaceData:t})}async function be(e,t){if(!e.currentUser.id)return;const n=(0,b.F9)(e.currentUser.id);return ge({environment:e,userId:n,traits:{...t,user_id:n},skipIntercom:!0})}async function ye(e,t,n){const{eventName:o,eventProperties:r}=t;await _e(e,o,r,n)}async function _e(e,t,n,o){try{const i=P.default.verboseAnalytics;0;const{data:a,spaceId:s}=await ne(e,t,o);!function(e,t,n){if(!n)return;for(const[o,r]of Object.entries(n))t[o]!==r&&f.log({level:"info",from:"analyticsHelpers",type:"forceOverrideMismatch",data:{eventName:e,miscDataToConvertToString:{forceOverrideKey:o,forceOverrideValue:r,autoTrackedValue:t[o]}}})}(t,a,null==o?void 0:o.forceOverrideAutomaticEventData);const l=(0,u.Z)(h.Xh({...n,...a,...null==o?void 0:o.forceOverrideAutomaticEventData}),"ignore-class-instances");w.j({eventName:t,eventData:l});const c={eventName:t,eventData:{...d.ni(l),__context:{locale:a.preferred_locale,page:{referrer:window.document.referrer,search:window.location.search}},sharedUUID:(0,b.ZP)()},spaceId:s};var r;if(m.j(c),i&&console.log(`track:%c ${t}`,"font-weight: bold;",n),e.device.isMobileNative&&R.default.checkGate("debug_analytics"))null===(r=e.mobileNative)||void 0===r||r.debugLog(`🦁 analytic event: ${t} | ${JSON.stringify(n)}`)}catch(i){f.log({level:"error",from:"analyticsHelpers",type:"track",data:{eventName:t,miscDataToConvertToString:{e:i}}})}}function Se(e){return{trackEvent:t=>{_e(e,t.eventName,t.properties)}}}const we={};function ke(e,t,n,o,r,i){const a=we[n],s=Date.now();return(!a||s-a>1e3*o)&&(we[n]=s,_e(e,t,r,i),!0)}function Ie(e,t,n,o){(0,v.lB)(n)&&_e(e,t,o)}async function Ce(e,t){await o.default.afterNextFlush();const n=R.default.getConfigKey("event_trail_events",e);if("object"==typeof n&&"number"==typeof n.sampleRate)return(0,v.aw)(n.sampleRate);if("number"==typeof(null==t?void 0:t.defaultSampleRateOverride))return(0,v.aw)(t.defaultSampleRateOverride);const r=R.default.getConfigKey("event_trail_events","defaultSampleRate");return"number"==typeof r?(0,v.aw)(r):!(null==t||!t.shouldSendIfStatsigNotInitialized)}async function xe(e){const{environment:t,eventName:n,eventProperties:o,options:r}=e;if(await Ce(n,r))return _e(t,n,o,r)}async function Te(e){var t,n,o,r;const{device:i,RouterStore:a}=e,s=null===(t=a.getState())||void 0===t||null===(t=t.route)||void 0===t?void 0:t.name,l=await Ne(e),{pathname:c,...d}=(0,k.nx)(null===(n=document.location)||void 0===n?void 0:n.href,(0,y.x6)())||{},{width:u,height:p}=e.WindowSizeStore.state,m={app_version:i.version,desktop_app_version:i.desktopAppVersion,mobile_app_version:i.mobileAppVersion,is_desktop_app_or_browser:!i.isMobile,is_desktop:i.isElectron,is_mobile:i.isMobile,is_tablet:i.isTablet,is_react_native:i.isMobileNative,is_ios:i.isIOS,is_logged_in:Ue(e),deviceType:i.os,device_type:i.deviceType,device_os:i.os,platform:i.platform,browser:i.browserName,browser_version:i.browserVersion,browser_version_bucketized:Pe(i.browserVersion,i.browserName),dnt:i.doNotTrackEnabled,device_id:l&&(0,b.F9)(l),tags:(0,y.mM)(),host:null===(o=document.location)||void 0===o?void 0:o.host,route_name:s,notion_top_level_domain:null===(r=document.location)||void 0===r||null===(r=r.host)||void 0===r||null===(r=r.split(".notion."))||void 0===r?void 0:r[1],referrer:document.referrer||"none",accept_language_raw:Le(),accept_language_preference:je(),...d,windowWidth:u,windowHeight:p,isActive:M.Z.state.active,is_foreground:document.hasFocus(),fired_during_onboarding:T.default.state.isOnboarding};return{...h.GM(m,h.o8),appSource:"client"}}const Me=new Set(["Safari","Mobile Safari"]);function Pe(e,t){const n=e.split(".");return Me.has(t)?n.slice(0,2).join("."):n[0]}const Ae=function(){const{currentUserSettingsStore:e}=A.default.state;if(e&&e.isDefined()){let n={};const o=e.getSettings();return o&&(n={user_persona:o.persona,user_source:o.source,user_use_case:o.use_case,time_zone:o.time_zone,time_zone_region:"string"==typeof o.time_zone?(t=o.time_zone,"N/A"===t?t:t.split("/")[0]):void 0,locale:o.locale,preferred_locale:o.preferred_locale,signup_time:o.signup_time,used_desktop_web_app:o.used_desktop_web_app,used_mobile_web_app:o.used_mobile_web_app,used_mac_app:o.used_mac_app,used_windows_app:o.used_windows_app,used_ios_app:o.used_ios_app,used_android_app:o.used_android_app,user_session_count:(0,pe.g)(e.id)}),h.GM(n,h.o8)}var t},Re=function(){const e={user_id:Ve(),user_email:P.default.state.user_email,email:P.default.state.user_email,name:P.default.state.user_name};return h.GM(e,h.o8)};const De=new Map;async function Ee(e){const t=e.currentUser.id;if(t){if(!De.has(t)){const n=Be(e,{loggedIn:!0});De.set(t,n),n.then((()=>{De.delete(t)})).catch((e=>{throw De.delete(t),e}))}return De.get(t)}return Be(e,{loggedIn:!1})}async function Be(e,t){t.loggedIn&&await A.default.waitUntilRendered();const n=await I.getUserAnalyticsSettings(e,{});if("success"!==n.type)return void f.log({level:"warning",from:"analyticsHelpers",type:"fetchAnalyticsSettings",data:{miscDataToConvertToString:{response:n}}});const o=n.data;return P.default.setState(o),o}const Fe=function(e,t){const n=e.getEmail();return n&&"team"===t?(0,p.Gd)(n):n||void 0};function Oe(e){return e.map((e=>(0,te.cD)(e))).filter(a.lm).some((e=>_.QM(e)))}function Ze(e){const t=e.map((e=>(0,te.cD)(e))),n=new Set(h.oA(t));return n.has("enterprise")?"enterprise":n.has("business")?"business":n.has("plus")?"plus":n.has("personal")?"personal_pro":n.has("team_free")?"team_free":n.has("personal_free")?"personal_free":n.has("free")?"free":"none"}function Ve(){const e=P.default.state.user_id;return e?(0,b.F9)(e):void 0}function Ue(e){const t=function(e){var t;return(null==e||null===(t=e.currentUser)||void 0===t?void 0:t.id)||e.publicDomainUserId}(e);return Boolean(t)}async function Ne(e){const t=await(0,Q.getBrowserId)(e);return t&&(0,b.F9)(t)}function Le(){return R.default.getAcceptLanguageHeader()}function je(){return c(Le()||"")}function ze(){return"on"===R.default.getEligibleGroup({experimentId:"zendesk",defaultGroup:"unassigned"})}function qe(e){var t;const n=e.id,o=e.isDefined()?{membership:e.getMembers(),settings:e.getSettingsStore().getValue(),is_default:e.isDefault(),description:e.getDescription(),icon:e.getIcon(),team_pages:e.getTeamPagesStore().getValue()}:void 0;if(!o||!o.settings)return{team_id:(0,b.cj)(n),no_team_value:!0};const r=o.membership||[];return{team_id:(0,b.cj)(n),team_current_size:r.length,team_current_num_users:r.filter((e=>"user"===e.entity_type)).length,team_current_num_groups:r.filter((e=>"group"===e.entity_type)).length,team_access_level:(0,S.B5)(o.settings),team_is_default:o.is_default,team_has_description:Boolean(o.description),team_has_icon:Boolean(o.icon),team_top_pages:(null===(t=o.team_pages)||void 0===t?void 0:t.length)??0}}function He(e){const t=g.Z.get({userId:e.userId,key:`${e.spaceId}:analytics_session`});if(!(t&&Date.now()-t.lastFocusedTime>me))return t}function We(e){g.Z.set({userId:e.userId,key:`${e.spaceId}:analytics_session`,value:e.session})}},28020:(e,t,n)=>{n.d(t,{AK:()=>Ie,B7:()=>ne,CP:()=>ve,Fv:()=>X,JE:()=>ye,RF:()=>re,RM:()=>oe,VU:()=>Se,VV:()=>_e,Xb:()=>de,YO:()=>ie,Zy:()=>Ce,_H:()=>te,_u:()=>ue,h1:()=>le,hq:()=>pe,k_:()=>me,kw:()=>fe,np:()=>J,o:()=>we,p5:()=>xe,qG:()=>ae,qQ:()=>be,rq:()=>Te,tu:()=>ce,ui:()=>he,wU:()=>ke,yn:()=>ge,zj:()=>ee});var o=n(14577),r=n(41432),i=n(53877),a=n(72126),s=n(72141),l=n(99405),c=(n(21202),n(23867)),d=n(19889),u=n(10906),p=n(95477),m=n(53323),f=n(50627),g=n(94841),h=n(49427),v=n(34859),b=n(51),y=n(80444),_=n(80641),S=n(33784),w=n(55367),k=n(64233),I=n(69316),C=n(73329),x=n(3418),T=n(42653),M=n(94416),P=n(48863),A=n(22294),R=n(19111),D=n(53730),E=n(19671),B=n(13023),F=n(88923),O=n(79797),Z=n(69784),V=n(13105),U=n(82187),N=n(55320),L=n(27724),j=n(10743),z=n(24666),q=n(16194),H=n(93827),W=n(85957),K=n(46654),G=n(65598),$=n(77546),Q=n(48779),Y=n(95697);function X(){if(y.default.state.mainEditorCurrentBlockStore)return{id:y.default.state.mainEditorCurrentBlockStore.id,spaceId:(0,c.C)(y.default.state.mainEditorCurrentBlockStore.pointer.spaceId)}}function J(){const e=F.default.state,t=W.mH();return e.open&&t?e.target:y.default.state.mainEditorCurrentBlockStore}function ee(){if(y.default.state.mainEditorCurrentBlockStore)return y.default.state.mainEditorCurrentBlockStore.id}function te(){return W.Tx()?B.Z:E.Z}function ne(e){let t;return y.default.state.currentUserStore?t=y.default.state.currentUserStore:e.currentUser.id&&(t=new O.U6(e,{table:d.KJ,id:e.currentUser.id})),t}function oe(){const e=L.default.getCurrentRootStore();if(e&&e instanceof O.G)return e}function re(){const e=L.default.getCurrentRootStore();if(e&&e instanceof O.G)return e;const{currentSpaceStore:t}=y.default.state;return t||void 0}function ie(e){return!e&&(0,g.WE)(y.default.state.mainEditorCurrentBlockStore)}function ae(e){return"myTasks"===(0,g.G)({blockOrCollectionId:e})}const se=new V.P({debugName:"getAppRenderState",memoizeRecursion:!0,deepEquals:!1,compute:function(e){var t;const{mainEditorCurrentBlockStore:n,initialized:o}=y.default.state,r=e.currentUser.isLoggedIn(),i=e.RouterStore.state.route,a=Boolean(n&&n.canRead()&&n.isDefined()),c=Boolean(n&&n.canEdit()&&n.isDefined()),d=Boolean(n&&(0,G.Oh)(n)),u=n&&a&&(0,K.IJ)(e,n),p=Boolean(u),m=u&&(0,s.J5)(u.permissionItem.role),f=c&&!m,g=(null==n||null===(t=n.getModel())||void 0===t?void 0:t.isNonverifiedContentClassification())&&!(n&&_.Z.bypassedPage(n.id))&&!f,{publicPageData:h}=b.Z.state,v=!o||!d,S=Boolean((0,l.HK)(i)&&(!(0,l.wO)(i)&&!n||n&&n.isReady()&&!a||g||(null==h?void 0:h.requireInterstitial)||(null==h?void 0:h.requireLogin)&&!r));return{shouldShowSidebar:function(){if((0,H.C)())return Boolean(null==h?void 0:h.template);const e="quickSearch"===i.name;return Boolean(!e&&!S&&r&&(v||(0,l.wO)(i)||a&&(c&&!p||d&&!p)&&!g&&!(null!=h&&h.requireInterstitial)))}(),shouldShowFrame:!S,shouldShowError:S}}}),le=e=>se.getStateFor(e),ce=new o.Z((()=>{const{mainEditorCurrentBlockStore:e}=y.default.state,t=e&&e.isCollectionView();return A.Z.state.isKeyboardMode&&!q.Z.state&&!U.Z.isActive()&&!t&&!N.default.state.open&&!M.Z.state.open&&!I.Z.state.open&&!(0,m.n)()&&0===C.Z.state.banners.length}),{debugName:"appHelpers.shouldHideTopbarStore"});function de(e){const{currentSpaceViewStore:t}=y.default.state;if(t){return a.G0(t.getWorkspacePages(),(0,Q.KA)(e,t),t.getPrivatePages(e)).filter((e=>e.isNavigableBlock()))}return[]}function ue(e){const{currentSpaceViewStore:t}=y.default.state;return t?a.mN([...t.getBookmarkedPages(),...t.getWorkspacePages(),...(0,Q.KA)(e,t),...t.getPrivatePages(e)],"id"):[]}function pe(e){return e.getType()===r.Ti.copyIndicator&&!D.transactionQueue.isPendingTransactionForRecord(e.pointer)}const me=a.HP((e=>new o.Z((()=>function(e){const{currentSpaceStore:t,currentSpaceViewStore:n,currentUserRootStore:o,currentUserSettingsStore:r}=y.default.state;if(!(n&&o&&t&&r))return;const i=(0,Q.jv)(t),a=n.getBookmarkedPages(),s=n.getWorkspacePages(),l=n.getTeamsStores(),{allSharedPagesStores:c,visibleSharedPagesStores:d}=(0,Q.MC)({environment:e,spaceViewStore:n,userSettingsStore:r}).state,u=n.getPrivatePages(e),p=(0,Q.Cx)(t),m=1===i.length&&0===s.length&&"personal"===t.getPlanType(),f=a.length>0,g=!p&&!(0,Y.bq)()&&s.length>0,h=c.length>0,v=r.hasUserPinnedToOutliner({spaceId:t.id,type:"shared"}),b=(0,Y.bq)();return{isGuest:p,isPersonalSpace:m,showBookmarksSection:f,showWorkspaceSection:g,showSharedSection:h,showPrivateSection:!p,showOnlyPrivateSection:!(f||g||h||b),showSharedOverflowButton:c.length>Q.G$||v,stickTemplateItemsToBottom:a.length+c.length+s.length+u.length>=8,allSharedPagesStores:c,visibleSharedPagesStores:d,showTeamSection:b,userJoinedTeamsStores:l}}(e)),{useDeepEqual:!0,debugName:"sidebarStateStore"}))),fe=new o.Z((()=>A.Z.state.isKeyboardMode||Z.default.state.isActive||w.ZP.state.isDragging||j.Z.state.open||R.Z.state.open||k.Z.state.open||P.Z.state.open||x.Z.hasOpenMouseCapturePopup()||E.Z.state.isOpen&&!F.default.isCenterPeekOpen()||B.Z.state.isOpen||S.Z.state.open||T.Z.state.isPinned),{debugName:"menuIsOpenStore"}),ge=new o.Z((()=>{const{currentSpaceViewStore:e,currentUserStore:t}=y.default.state,n=new Set;if(!e||!t)return n;for(const o of e.getTeamsStores()){o.getMembers().find((e=>"user"===e.entity_type&&e.user_id===t.id))&&n.add(o.id)}return n}),{useDeepEqual:!0,debugName:"userTeamsInCurrentSpace"});function he(e){return e.device.isPhone?24:96}function ve(e){return he(e)}function be(e){const t=L.default.getCurrentDefaultContainer(),n=f.zL-2*he(e);if(t){const e=h.Z.find((e=>e.props.store===t.props.store));if(e){const t=e.getContentInnerWidth();if(t)return Math.min(n,t)}}return n}function ye(){const e=J(),t=z.default.state;if("editing"!==t.mode)return!1;const n=t.multiSelection.start.store;return e&&e.id===n.id&&n.path.includes("title")||!1}function _e(){const e=z.default.state;if("editing"!==e.mode)return!1;const t=e.multiSelection.start.store,n="collection"===t.table;return t.path.includes("name")&&n||!1}function Se(){const{currentUserRootStore:e}=y.default.state;if(e){const t=e.getSpaceViewStores();return a.oA(t.map((e=>e.getSpaceId())))}return[]}function we(e){return a.mN(e.getSpaceViewStores(),(e=>e.getSpaceId())).filter((e=>{const t=e.getSpaceStore();return e.isDefined()&&t&&t.canEdit()}))}async function ke(e){await e.load();const t=e.getSpaceViewStores();await Promise.all(t.map((async e=>{await e.load();const t=e.getSpaceStore();t&&await t.load()})))}const Ie=new o.Z((function(){const{currentUserSettingsStore:e}=y.default.state,t=(0,i.aN)();if(e){const n=e.getSettings();return void 0===(null==n?void 0:n.start_day_of_week)?t:null==n?void 0:n.start_day_of_week}return t}),{debugName:"userSettingsStartOfWeek"});function Ce(e){const{environment:t,store:n}=e;return n.isCollectionView()?(0,$.eA)(t)?v.Z.All:v.Z.Y:!(0,u.en)(n)&&F.default.isSidePeekOpen()?v.Z.All:v.Z.Y}function xe(e){const{isFullScreen:t,environment:n}=e;return t&&(0,$.eA)(n)?v.Z.None:v.Z.X}function Te(){p.default.isAdminMode||console.log("%c\n\tnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\n\tnnnn                         nnnn\n\tnnnnnnn                          nnnn\n\tnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\n\tnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\n\tnnnnnnnn                           nnn\n\tnnnnnnnn    nnnnnnnn     nnnnnnn   nnn\n\tnnnnnnnn      nnnnnnn      nnn     nnn\n\tnnnnnnnn      nnnnnnnn     nnn     nnn\n\tnnnnnnnn      nnnnnnnnnn   nnn     nnn\n\tnnnnnnnn      nnn nnnnnnn  nnn     nnn\n\tnnnnnnnn      nnn  nnnnnnnnnnn     nnn\n\tnnnnnnnn      nnn   nnnnnnnnnn     nnn\n\tnnnnnnnn      nnn     nnnnnnnn     nnn\n\tnnnnnnnn      nnn      nnnnnnn     nnn\n\tnnnnnnnn    nnnnnnnn    nnnnnn     nnn\n\t  nnnnnn                           nnn\n\t\tnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\t\tWe're hiring!\n\t\t  nnnnnnnnnnnnnnnnnnnnnnnnnnnnnnnn\t\tnotion.so/careers\n\t\t\t\t ","font-family: monospace")}},91924:(e,t,n)=>{n.d(t,{HU:()=>u,IJ:()=>c,Q7:()=>l,eC:()=>d,k2:()=>p});var o=n(6495),r=n(32739),i=n(95477),a=n(77080),s=n(18514);function l(e){return!!e.device.isMobileNative&&(e.device.isIOS&&"on"===a.default.getEligibleGroup({experimentId:"ios_3rd_party_login_with_external_browser",defaultGroup:"control"})||e.device.isAndroid&&"on"===a.default.getEligibleGroup({experimentId:"android_3rd_party_login_with_external_browser",defaultGroup:"control"}))}function c(e){const{device:t}=e,n=l(e);if(t.isMobileNative){return{redirectToAuth:!1,callbackType:n?"nativeredirect":"native"}}if(t.isElectron){return{redirectToAuth:!1,callbackType:"nativeredirect"}}return{redirectToAuth:!0,callbackType:"redirect"}}function d(e){const{device:t}=e,n=l(e);if(t.isMobileNative){return{redirectToAuth:!1,callbackType:n?"nativeredirect":"native"}}if(t.isElectron){return{redirectToAuth:!1,callbackType:"nativeredirect"}}if(t.isMobileBrowser||(0,s.Sr)()){return{redirectToAuth:!0,callbackType:"redirect"}}return{redirectToAuth:!0,callbackType:"popup"}}async function u(e,t,n){if(e.device.isHttpApp){const e=await fetch(t);return(await e.json()).url}{const e=await fetch(r.NV({httpUrl:t,protocol:i.default.protocol,includePort:n}));return(await e.json()).url}}function p(e){return r.jP({url:o.tu[e],isLocalHost:"local"===e})}},80365:(e,t,n)=>{n.d(t,{L:()=>m});var o=n(66897),r=n(36576),i=n(72126),a=n(21202),s=n(70279),l=n(23867),c=n(19889),d=n(97880),u=n(79797);function p(e,t){const n=i.oA(e.map((e=>function(e,t){if("comment_mention"===e.mentioned_from.type){const n=u.t1.createChildStore(t,{table:s.x_,id:e.mentioned_from.comment_id,spaceId:(0,l.C)(void 0)});if(!n.isDefined())return;const o=u.t1.createChildStore(t,n.getParentPointer());if(!o.isDefined())return;const r=u.G.createChildStore(t,{table:a.iU,id:o.getParentId()}),i=r.getNavigableBlockStore();if(!i)return;return r.id===i.id?{backlinkStore:i,timestamp:n.getLastEditedTime()}:{backlinkStore:i,scrollToBlockId:r.id,discussionId:o.id,timestamp:n.getLastEditedTime()}}if("reference"===e.mentioned_from.type){const n=u.G.createChildStore(t,{table:a.iU,id:e.mentioned_from.parent_block_id}).getNavigableBlockStore();if(!n)return;const o=n.getLastEditedTime();return{backlinkStore:n,scrollToBlockId:e.block_id,timestamp:o||0}}if("property_mention"===e.mentioned_from.type){const{block_id:n}=e.mentioned_from,o=u.G.createChildStore(t,{table:a.iU,id:n});if(!o.isDefined())return;const r=o.getNavigableBlockStore();if(!r)return;return r.id===o.id?{backlinkStore:r,timestamp:o.getLastEditedTime()}:{backlinkStore:r,scrollToBlockId:o.id,timestamp:o.getLastEditedTime()}}if("collection_reference"===e.mentioned_from.type){const{block_id:n}=e.mentioned_from,o=u.G.createChildStore(t,{table:a.iU,id:n});if(!o.isDefined())return;const r=o.getNavigableBlockStore();if(!r)return;return r.id===o.id?{backlinkStore:r,timestamp:o.getLastEditedTime()}:{backlinkStore:r,scrollToBlockId:o.id,timestamp:o.getLastEditedTime()}}if("alias"===e.mentioned_from.type||"transclusion_reference"===e.mentioned_from.type){const n=u.G.createChildStore(t,{table:a.iU,id:e.mentioned_from.pointer.id}),o=n.getNavigableBlockStore();if(!o)return;return{backlinkStore:o,scrollToBlockId:n.id,timestamp:o.getLastEditedTime()}}(0,d.t1)(e.mentioned_from)}(e,t)))),o=i.vM(n,(e=>{let{backlinkStore:t}=e;return t.id})),r=Object.values(o).map((e=>i.MR(e,(e=>e.discussionId?2:e.scrollToBlockId?1:0))[0]));return r.sort(((e,t)=>t.timestamp-e.timestamp)),r}function m(e,t){const{id:n}=t.currentUser;let i;if(n){const t=e.getRecordValue({table:c.KJ,id:n});t&&(i=(0,o.dp)(t))}const a=t.LocalBacklinkStore.getBacklinkState({blockId:e.id,currentUserId:t.currentUser.id}),s=(0,r.sU)({actor:i,blockId:e.id,backlinks:a.backlinks,getRecordModel:e.getRecordModel});return 0===s.length?{backlinks:[],inaccessibleBacklinkCount:a.inaccessibleBacklinkCount}:{backlinks:p(s,e),inaccessibleBacklinkCount:a.inaccessibleBacklinkCount}}},42:(e,t,n)=>{n.d(t,{Fr:()=>L,Jy:()=>B,S7:()=>O,UG:()=>U,W_:()=>I,Yu:()=>A,ZW:()=>V,_Z:()=>E,ax:()=>w,iC:()=>R,iD:()=>N,n_:()=>F,sU:()=>D,sw:()=>S});var o=n(30120),r=n(47025),i=n(99036),a=n(80951),s=n(42613),l=n(53877),c=n(42875),d=n(72126),u=n(4615),p=n(71644),m=n(45953),f=n(21202),g=n(6287),h=n(70203),v=n(97880),b=n(9291),y=n(33929);const _=(0,b.defineMessages)({addNewTodoTitle:{defaultMessage:"Add a new to-do",id:"blockTemplates.templateButton.addNewTodoTitle"}});function S(){return m.Ao.create({block:{root:{id:"root",version:27,type:"factory",properties:{title:[[y.default.formatMessage(_.addNewTodoTitle)]]},content:["to_do"]},to_do:{id:"to_do",version:4,type:"to_do",parent_table:"block",parent_id:"root",alive:!0}}})}function w(){return m.Ao.create({block:{root:{id:"root",version:0,type:"button",format:{automation_id:"automation"}}},automation:{automation:{id:"automation",parent_id:"root",parent_table:f.iU,alive:!0,status:"active",trigger:{id:(0,u.ZP)(),type:"button"},action_ids:[],properties:{name:""}}}})}const k=(0,b.defineMessages)({namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.table.namePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.table.tagsPropertyTitle"}});function I(e){const{isInline:t,name:n}=e,o=(0,p.ZP)();return m.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:g.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0}},collection_view:{view:{id:"view",version:0,type:"table",format:{collection_pointer:{table:g.v,id:"collection"},table_properties:[{property:"title",visible:!0,width:276},{property:o,visible:!0}],table_wrap:!0},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,h.TPx)(n):void 0,schema:{title:{name:y.default.formatMessage(k.namePropertyTitle),type:"title"},[o]:{name:y.default.formatMessage(k.tagsPropertyTitle),type:"multi_select"}},format:{collection_page_properties:[{property:o,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}const C=(0,b.defineMessages)({viewTitle:{defaultMessage:"Board view",id:"blockTemplates.board.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.board.namePropertyTitle"},assignPropertyTitle:{defaultMessage:"Assign",id:"blockTemplates.board.assignPropertyTitle"},statusPropertyTitle:{defaultMessage:"Status",id:"blockTemplates.board.statusPropertyTitle"},card1Title:{defaultMessage:"Card 1",id:"blockTemplates.board.card1Title"},card2Title:{defaultMessage:"Card 2",id:"blockTemplates.board.card2Title"},card3Title:{defaultMessage:"Card 3",id:"blockTemplates.board.card3Title"}});const x=(0,b.defineMessages)({viewTitle:{defaultMessage:"Calendar view",id:"blockTemplates.calendar.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.calendar.namePropertyTitle"},datePropertyTitle:{defaultMessage:"Date",id:"blockTemplates.calendar.datePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.calendar.tagsPropertyTitle"}});const T=(0,b.defineMessages)({viewTitle:{defaultMessage:"Timeline view",id:"blockTemplates.timeline.viewTitle"},datePropertyTitle:{defaultMessage:"Date",id:"blockTemplates.timeline.datePropertyTitle"}});const M=(0,b.defineMessages)({viewTitle:{defaultMessage:"Gallery view",id:"blockTemplates.gallery.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.gallery.namePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.gallery.tagsPropertyTitle"},createdPropertyTitle:{defaultMessage:"Created",id:"blockTemplates.gallery.createdPropertyTitle"},page1Title:{defaultMessage:"Page 1",id:"blockTemplates.gallery.page1Title"},page2Title:{defaultMessage:"Page 2",id:"blockTemplates.gallery.page2Title"},page3Title:{defaultMessage:"Page 3",id:"blockTemplates.gallery.page3Title"},page1TodoTitle:{defaultMessage:"To-do",id:"blockTemplates.gallery.page1TodoTitle"},page1CompletedTodoTitle:{defaultMessage:"Completed To-do",id:"blockTemplates.gallery.page1CompletedTodoTitle"}});const P=(0,b.defineMessages)({viewTitle:{defaultMessage:"List view",id:"blockTemplates.list.viewTitle"},namePropertyTitle:{defaultMessage:"Name",id:"blockTemplates.list.namePropertyTitle"},tagsPropertyTitle:{defaultMessage:"Tags",id:"blockTemplates.list.tagsPropertyTitle"},createdPropertyTitle:{defaultMessage:"Created",id:"blockTemplates.list.createdPropertyTitle"},page1Title:{defaultMessage:"Page 1",id:"blockTemplates.list.page1Title"},page2Title:{defaultMessage:"Page 2",id:"blockTemplates.list.page2Title"},page3Title:{defaultMessage:"Page 3",id:"blockTemplates.list.page3Title"}});function A(e){const{environment:t,isInline:n,viewType:d,name:u}=e;return"table"===d?I({environment:t,isInline:n,name:u}):"board"===d?function(e){const{isInline:t,name:n}=e,o=(0,p.ZP)(),r=(0,p.ZP)();return m.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:g.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(C.card1Title)]]}},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(C.card2Title)]]}},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(C.card3Title)]]}}},collection_view:{view:{id:"view",version:0,type:"board",name:y.default.formatMessage(C.viewTitle),query2:{aggregations:[{aggregator:"count"}]},format:{collection_pointer:{table:g.v,id:"collection"},board_columns_by:{property:o,type:"status",groupBy:"group",sort:{type:"ascending"}},board_columns:[{property:o,value:{type:"status",value:{type:"by_group",group:s.G1}}},{property:o,value:{type:"status",value:{type:"by_group",group:s.Ho}}},{property:o,value:{type:"status",value:{type:"by_group",group:s.RW}}}],board_properties:[{property:o,visible:!1},{property:r,visible:!0}]},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,h.TPx)(n):void 0,schema:{title:{name:y.default.formatMessage(C.namePropertyTitle),type:"title"},[r]:{name:y.default.formatMessage(C.assignPropertyTitle),type:"person"},[o]:(0,i.I4)(y.default.formatMessage(C.statusPropertyTitle),y.default.getIntl())},format:{collection_page_properties:[{property:o,visible:!0},{property:r,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:u}):"calendar"===d?function(e){const{isInline:t,name:n}=e,o=(0,p.ZP)(),r=(0,p.ZP)();return m.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:g.v,id:"collection"}},view_ids:["view"],alive:!0}},collection_view:{view:{id:"view",version:0,type:"calendar",name:y.default.formatMessage(x.viewTitle),format:{collection_pointer:{table:g.v,id:"collection"}},query2:{calendar_by:o},parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,h.TPx)(n):void 0,schema:{title:{name:y.default.formatMessage(x.namePropertyTitle),type:"title"},[o]:{name:y.default.formatMessage(x.datePropertyTitle),type:"date"},[r]:{name:y.default.formatMessage(x.tagsPropertyTitle),type:"multi_select"}},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:u}):"list"===d?function(e){const{isInline:t,name:n}=e,o=(0,p.ZP)(),r=(0,p.ZP)();return m.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:g.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(P.page1Title)]]}},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(P.page2Title)]]}},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(P.page3Title)]]}}},collection_view:{view:{id:"view",version:0,type:"list",name:y.default.formatMessage(P.viewTitle),query2:{aggregations:[{aggregator:"count"}]},format:{collection_pointer:{table:g.v,id:"collection"},list_properties:[{property:o,visible:!0}]},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,h.TPx)(n):void 0,schema:{title:{name:y.default.formatMessage(P.namePropertyTitle),type:"title"},[o]:{name:y.default.formatMessage(P.tagsPropertyTitle),type:"multi_select",options:[]},[r]:{name:y.default.formatMessage(P.createdPropertyTitle),type:"created_time"}},format:{collection_page_properties:[{property:r,visible:!0},{property:o,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:u}):"gallery"===d?function(e){const{isInline:t,name:n}=e,o=(0,p.ZP)(),r=(0,p.ZP)();return m.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:g.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(M.page1Title)]]},content:["to_do_1","to_do_2"]},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(M.page2Title)]]}},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0,properties:{title:[[y.default.formatMessage(M.page3Title)]]}},to_do_1:{id:"to_do_1",type:"to_do",parent_id:"item_1",parent_table:"block",alive:!0,properties:{title:[[y.default.formatMessage(M.page1TodoTitle)]]}},to_do_2:{id:"to_do_2",type:"to_do",parent_id:"item_1",parent_table:"block",alive:!0,properties:{title:[[y.default.formatMessage(M.page1CompletedTodoTitle)]],checked:[["Yes"]]}}},collection_view:{view:{id:"view",version:0,type:"gallery",name:y.default.formatMessage(M.viewTitle),query2:{aggregations:[{aggregator:"count"}]},format:{collection_pointer:{table:g.v,id:"collection"},gallery_cover:{type:"page_content"}},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,h.TPx)(n):void 0,schema:{title:{name:y.default.formatMessage(M.namePropertyTitle),type:"title"},[o]:{name:y.default.formatMessage(M.tagsPropertyTitle),type:"multi_select",options:[]},[r]:{name:y.default.formatMessage(M.createdPropertyTitle),type:"created_time"}},format:{collection_page_properties:[{property:r,visible:!0},{property:o,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:u}):"timeline"===d?function(e){const{isInline:t,name:n}=e,r=(0,p.ZP)(),s=(0,p.ZP)(),d=(0,p.ZP)();return m.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:g.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",properties:{title:[[y.default.formatMessage(C.card1Title)]],[r]:(0,a.d7)((0,l.fZ)(o.ou.now().minus({days:5}).startOf("day").valueOf(),o.ou.now().minus({days:1}).startOf("day").valueOf(),(0,c.r)()))},alive:!0},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",properties:{title:[[y.default.formatMessage(C.card2Title)]],[r]:(0,a.d7)((0,l.fZ)(o.ou.now().minus({days:3}).startOf("day").valueOf(),o.ou.now().plus({days:1}).startOf("day").valueOf(),(0,c.r)()))},alive:!0},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",properties:{title:[[y.default.formatMessage(C.card3Title)]],[r]:(0,a.d7)((0,l.fZ)(o.ou.now().minus({days:1}).startOf("day").valueOf(),o.ou.now().plus({days:3}).startOf("day").valueOf(),(0,c.r)()))},alive:!0}},collection_view:{view:{id:"view",version:0,type:"timeline",name:y.default.formatMessage(T.viewTitle),format:{collection_pointer:{table:g.v,id:"collection"},timeline_show_table:!t,timeline_properties:[{property:"title",visible:!0}],timeline_table_properties:[{property:"title",visible:!0,width:280},{property:r,visible:!1,width:180},{property:s,visible:!1,width:180},{property:d,visible:!1,width:180}]},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,h.TPx)(n):void 0,schema:{title:{name:y.default.formatMessage(C.namePropertyTitle),type:"title"},[r]:{name:y.default.formatMessage(T.datePropertyTitle),type:"date"},[s]:{name:y.default.formatMessage(C.assignPropertyTitle),type:"person"},[d]:(0,i.I4)(y.default.formatMessage(C.statusPropertyTitle),y.default.getIntl())},format:{collection_page_properties:[{property:r,visible:!0},{property:s,visible:!0},{property:d,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:u}):"page"!==d?"chart"===d?function(e){const{isInline:t,name:n}=e,o=(0,p.ZP)(),i={title:{name:y.default.formatMessage(k.namePropertyTitle),type:"title"},[o]:{name:y.default.formatMessage(k.tagsPropertyTitle),type:"multi_select"}};return m.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:g.v,id:"collection"}},view_ids:["view"],alive:!0},item_1:{id:"item_1",type:"page",parent_id:"collection",parent_table:"collection",alive:!0},item_2:{id:"item_2",type:"page",parent_id:"collection",parent_table:"collection",alive:!0},item_3:{id:"item_3",type:"page",parent_id:"collection",parent_table:"collection",alive:!0}},collection_view:{view:{id:"view",version:0,type:"chart",format:{collection_pointer:{table:g.v,id:"collection"},chart_config:(0,r.Gy)({collectionSchema:i,collectionPointer:{table:g.v,id:"collection"}})},page_sort:["item_1","item_2","item_3"],parent_id:"root",parent_table:"block",alive:!0}},collection:{collection:{id:"collection",name:n?(0,h.TPx)(n):void 0,schema:i,format:{collection_page_properties:[{property:o,visible:!0}]},parent_id:"root",parent_table:"block",alive:!0}}})}({environment:t,isInline:n,name:u}):void(0,v.t1)(d):void 0}function R(e){const{isInline:t,viewType:n}=e;return m.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",view_ids:["view"],alive:!0}},collection_view:{view:{id:"view",version:0,type:n,parent_id:"root",parent_table:"block",alive:!0}}})}function D(e){const{isInline:t,viewType:n,integrationId:o}=e;return m.Ao.create({block:{root:{id:"root",type:t?"collection_view":"collection_view_page",collection_id:"collection",format:{collection_pointer:{table:g.v,id:"collection"}},view_ids:["view"],alive:!0}},collection:{collection:{id:"collection",name:void 0,schema:{},format:{is_placeholder:!0,integration_id:o},parent_id:"root",parent_table:"block",alive:!0}},collection_view:{view:{id:"view",version:0,type:n,format:{collection_pointer:{table:g.v,id:"collection"}},parent_id:"root",parent_table:"block",alive:!0}}})}function E(){return m.Ao.create({block:{root:{id:"root",type:"transclusion_container",content:["empty_text"],alive:!0},empty_text:{id:"empty_text",type:"text",parent_id:"root",parent_table:"block",alive:!0}}})}function B(e){return m.Ao.create({block:{root:{id:"root",type:"ai_block",content:[],alive:!0,format:{ai_prompt_key:e}}}})}function F(e){const t=d.DZ(e,(e=>`column${e+1}`));return m.Ao.create({block:{root:{id:"root",type:"column_list",content:t,alive:!0},...Object.assign({},...t.map((t=>{const n=`${t}_text`;return{[t]:{id:t,type:"column",parent_id:"root",parent_table:"block",content:[n],alive:!0,format:{column_ratio:1/e}},[n]:{id:n,type:"text",parent_id:t,parent_table:"block",alive:!0}}})))}})}function O(){const e=[(0,p.ZP)(),(0,p.ZP)()];return m.Ao.create({block:{root:{id:"root",type:"table",content:["row_1","row_2","row_3"],alive:!0,format:{table_block_column_order:e}},row_1:{id:"row_1",type:"table_row",parent_id:"root",parent_table:"block",alive:!0},row_2:{id:"row_2",type:"table_row",parent_id:"root",parent_table:"block",alive:!0},row_3:{id:"row_3",type:"table_row",parent_id:"root",parent_table:"block",alive:!0}}})}const Z=(0,b.defineMessages)({tab1Title:{defaultMessage:"Tab 1",id:"blockTemplates.list.tab1Title"},tab2Title:{defaultMessage:"Tab 2",id:"blockTemplates.list.tab2Title"},tab3Title:{defaultMessage:"Tab 3",id:"blockTemplates.list.tab3Title"}});function V(){return m.Ao.create({block:{root:{id:"root",type:"tab",alive:!0,content:["tab1","tab2","tab3"]},tab1:{id:"tab1",parent_id:"root",parent_table:"block",type:"text",alive:!0,properties:{title:[[y.default.formatMessage(Z.tab1Title)]]}},tab2:{id:"tab2",parent_id:"root",parent_table:"block",type:"text",alive:!0,properties:{title:[[y.default.formatMessage(Z.tab2Title)]]}},tab3:{id:"tab3",parent_id:"root",parent_table:"block",type:"text",alive:!0,properties:{title:[[y.default.formatMessage(Z.tab3Title)]]}}}})}function U(e){return m.Ao.create({[f.iU]:{root:{id:"root",type:e,format:{toggleable:!0}}}})}function N(e,t){return m.Ao.create({[f.iU]:{root:{id:"root",type:"code",properties:{title:h.TPx(t),language:h.TPx(e)}}}})}function L(){return m.Ao.create({[f.iU]:{root:{id:"root",type:"drawing",format:{drawing_value:void 0,block_page_width:!0,block_height:480}}}})}},43250:(e,t,n)=>{n.d(t,{$ji:()=>Yt,A_D:()=>R,Apy:()=>ln,Aur:()=>St,B8p:()=>D,BEs:()=>Ie,BKn:()=>qe,BaY:()=>We,C18:()=>je,CBT:()=>Qe,CZG:()=>ge,C_N:()=>Xt,Cjq:()=>mt,D$4:()=>rt,Dkf:()=>Wt,EGJ:()=>Bt,Ep8:()=>v,F4o:()=>Pe,FJA:()=>q,FLq:()=>vt,FoE:()=>me,G6g:()=>ie,GNl:()=>W,GZn:()=>yn,GbT:()=>V,Gcz:()=>Rt,GfL:()=>K,HKr:()=>te,HwD:()=>Jt,I2F:()=>J,I9j:()=>Je,IAq:()=>yt,Iiy:()=>dn,IpQ:()=>de,J2F:()=>wt,JR_:()=>Dt,JUE:()=>Ne,JiD:()=>i,JkF:()=>Ce,K3y:()=>Z,K4T:()=>Vt,KA2:()=>X,KLh:()=>O,LoZ:()=>re,MD7:()=>F,MU2:()=>Re,MV2:()=>bt,M_0:()=>cn,Mdu:()=>Le,Mfh:()=>_e,Mpz:()=>_t,MsS:()=>u,N7t:()=>pe,NFf:()=>fe,Nn$:()=>h,No6:()=>I,OE$:()=>mn,OK_:()=>m,Oau:()=>N,PBs:()=>g,QS0:()=>x,QSt:()=>o,Qcf:()=>w,Qgj:()=>dt,Quo:()=>c,RG3:()=>Fe,RIA:()=>Qt,S94:()=>H,S9A:()=>hn,TAd:()=>He,TFu:()=>on,TYv:()=>ze,UBk:()=>E,Uhm:()=>pt,Uwd:()=>Oe,V6y:()=>Ct,VMO:()=>Mt,Voi:()=>ht,Wh_:()=>C,Wiy:()=>T,Wy1:()=>ut,Xgx:()=>at,Xj_:()=>p,Xjk:()=>bn,Xsh:()=>et,Y6l:()=>Ve,Y7r:()=>Xe,YHn:()=>$,YOJ:()=>_n,YPt:()=>y,Z87:()=>ft,ZHw:()=>P,ZmO:()=>Q,Zp2:()=>nn,_so:()=>It,a6i:()=>ce,aL4:()=>De,afv:()=>G,aiP:()=>a,alX:()=>r,b_f:()=>j,blN:()=>Te,c7X:()=>Ft,cFM:()=>nt,dXl:()=>gn,euV:()=>k,exn:()=>ye,f0e:()=>sn,f8P:()=>ae,fHd:()=>_,fOh:()=>fn,fe0:()=>ke,gGc:()=>Y,gec:()=>lt,gjL:()=>ee,gug:()=>l,hEP:()=>rn,hKO:()=>ue,hzx:()=>ne,i25:()=>kt,irE:()=>Ut,j35:()=>Ae,jWx:()=>Ze,kDE:()=>Lt,kUP:()=>Tt,l24:()=>Me,lIT:()=>M,lmr:()=>Sn,mJW:()=>b,mSZ:()=>A,mWS:()=>At,myM:()=>it,nM$:()=>Ot,nU_:()=>he,o4s:()=>zt,oc0:()=>Ye,ovr:()=>jt,p0b:()=>U,p1Q:()=>S,p4m:()=>se,pg$:()=>tn,q1J:()=>xe,qnV:()=>un,qr0:()=>Ke,qxR:()=>Ue,rG8:()=>$e,rIE:()=>Be,rIj:()=>ot,rIs:()=>en,rKl:()=>s,rTm:()=>Gt,rVO:()=>$t,rcG:()=>ve,rli:()=>Se,s$o:()=>tt,sbt:()=>Zt,sqL:()=>Nt,srZ:()=>L,tQh:()=>z,tfM:()=>xt,ulv:()=>vn,vvn:()=>gt,wFE:()=>oe,wG0:()=>an,wKH:()=>f,wXs:()=>Et,wlU:()=>B,wnm:()=>st,x2W:()=>ct,x4y:()=>d,x9t:()=>Ht,xvU:()=>Kt,y4j:()=>pn,yNE:()=>Ee,ykc:()=>be,zYS:()=>we,z_z:()=>qt,zar:()=>Ge,zov:()=>le,zwY:()=>Pt});const o="notion-cursor-default",r="hidden",i="notion-fadein",a="notion-mobile",s="notion-fadein-fast",l="notion-front-page",c="analytics-scroll-point",d="notion-login",u="notion-light-theme",p="notion-dark-theme",m="notion-scroller",f="vertical",g="horizontal",h="notion-history-modal",v="notion-block-resizer",b="notion-overlay-container",y="notion-default-overlay-container",_="notion-page-template-modal",S="notion-peek-renderer",w="notion-text-action-menu",k="notion-selectable",I="notion-selectable-halo",C="notion-focusable-within",x="notion-page-content",T="notion-frame",M="notion-topbar",P="notion-topbar-mobile",A="notion-topbar-more-button",R="notion-topbar-action-buttons",D="notion-share-menu",E="notion-share-menu-publish-tab",B="notion-share-menu-publish-button",F="notion-topbar-share-menu",O="notion-updates-menu",Z="notion-topbar-updates-button",V="notion-topbar-favorite-button",U="notion-topbar-comments-button",N="notion-search-menu",L="notion-embed-menu",j="notion-unfurling-menu",z="notion-media-menu",q="notion-invite",H="notion-record-icon",W="notion-calendar-header-days",K="notion-board-group",G="notion-block-permission-settings-workspace-access",$="notion-block-permission-settings-team-access",Q="notion-block-permission-settings-team-access",Y="notion-block-permission-settings-group-access",X="notion-page-view-discussion",J="notion-updates-button-mentions",ee="notion-updates-button-all-updates",te="notion-updates-button-archive",ne="notion-discussion-input-edit-existing-comment",oe="notion-discussion-input",re="notion-discussion-reply-menu",ie="notion-comment-overflow-menu",ae="notion-shimmer",se="notion-link",le="ai-block",ce="notion-sharing-permission-role-select",de="notion-sharing-permission-expiration-timestamp",ue="notion-language-picker",pe="notion-cookie-selector",me="notion-activity-section-icon",fe="notion-activity-section-header",ge="notion-activity-section-time",he="notion-activity-section-children",ve="notion-sidebar",be="notion-sidebar-mobile",ye="notion-open-sidebar",_e="notion-close-sidebar",Se="notion-sidebar-switcher",we="notion-space-settings",ke="notion-outliner-bookmarks",Ie="notion-outliner-workspace",Ce="notion-outliner-shared",xe="notion-outliner-private",Te="notion-outliner-offline",Me="notion-outliner-team",Pe="notion-outliner-bookmarks-header",Ae="notion-outliner-workspace-header",Re="notion-outliner-shared-header",De="notion-outliner-private-header",Ee="notion-outliner-offline-header",Be="notion-outliner-team-header",Fe="notion-outliner-joined-team-header",Oe="notion-outliner-unjoined-team-header",Ze="notion-outliner-search-team-header",Ve="notion-outliner-public-page-template-includes-header",Ue="notion-outliner-team-context-menu-button",Ne="notion-outliner-team-heading-context-menu-button",Le="notion-outliner-team-context-menu",je="notion-updates-menu",ze="notion-sidebar-trash-menu",qe="notion-password-modal",He="notion-scim-table-revoke-button",We="notion-subscription-checkout-title",Ke="notion-subscription-checkout-description",Ge="notion-update-sidebar",$e="notion-update-sidebar-tab-comments-segmented-control",Qe="notion-update-sidebar-tab-comments-dropdown-control",Ye="notion-update-sidebar-tab-comments-dropdown-button-open",Xe="notion-update-sidebar-tab-comments-dropdown-button-resolved",Je="notion-update-sidebar-tab-comments-header",et="notion-update-sidebar-tab-comments-comments-scroller",tt="notion-update-sidebar-tab-comments-discussion-item",nt="notion-update-sidebar-tab-updates-header",ot="notion-team-settings-modal",rt="notion-add-members-modal",it="notion-new-team",at="notion-use-case-onboarding-profile",st="notion-use-case-onboarding-persona-survey",lt="notion-workspace-choose",ct="notion-workspace-plan-choose",dt="notion-workspace-create",ut="notion-workspace-invite",pt="notion-onboarding-error",mt="notion-onboarding-popup",ft="notion-onboarding-button",gt="notion-onboarding-plan-type-personal",ht="notion-onboarding-plan-type-team",vt="notion-onboarding-plan-type-school",bt="notion-onboarding-app-download",yt="notion-onboarding-persona-survey-persona",_t="notion-onboarding-persona-survey-role",St="notion-onboarding-persona-survey-companysize",wt="notion-onboarding-persona-survey-usecases",kt="notion-onboarding-timed-trial-upsell",It="notion-table-view",Ct="notion-table-view-add-column",xt="notion-table-view-add-row",Tt="notion-table-view-header-row",Mt="notion-table-view-header-cell",Pt="notion-table-view-row",At="notion-table-view-cell",Rt="notion-table-view-empty-placeholder",Dt="notion-table-view-drag-and-fill-handle",Et="notion-table-view-frozen-column-repositioner",Bt="notion-board-view",Ft="notion-calendar-view",Ot="notion-list-view",Zt="notion-gallery-view",Vt="notion-collection-item",Ut="notion-calendar-view-day",Nt="notion-collection-view-item-add",Lt="notion-timeline-view",jt="notion-timeline-item",zt="notion-timeline-item-row",qt="notion-timeline-item-properties",Ht="notion-collection-view-body",Wt="notion-view-settings-sidebar",Kt="notion-collection-edit-view",Gt="notion-collection-view-tab-button",$t="notion-collection-add-view",Qt="notion-collection-automation-edit-view",Yt="notion-template-picker-item",Xt="notion-template-picker-item-action-menu",Jt="draggable-ghost-section",en="developer-integrations-container",tn="developer-integrations-list",nn="developer-integration-create",on="developer-integration-view",rn="developer-integration-lab",an="developer-integration-not-found",sn="notion-table-row-selector",ln="notion-table-column-selector",cn="notion-table-row",dn="notion-table-cell",un="notion-table-cell-text",pn="notion-table-selection-overlay",mn="notion-table-tbody-selectable",fn="notion-table-content",gn="notion-temporary-comment",hn="notion-margin-discussion-item",vn="search-query-result-item",bn="search-result-body-section-title",yn="search-result-mobile-body-scroller",_n="notion-completions-feedback-popup",Sn="notion-help-button"},47853:(e,t,n)=>{n.d(t,{D:()=>i});var o=n(13991),r=n(25666);function i(e){return r.D(e,o.SP)}},49117:(e,t,n)=>{n.d(t,{$5:()=>T,Gb:()=>I,PN:()=>S,Rr:()=>M,pZ:()=>_,pt:()=>w,td:()=>C,uV:()=>x});var o=n(14577),r=n(28751),i=n(81730),a=n(94412),s=n(61202),l=n(86433),c=n(1274),d=n(35102),u=n(42875),p=n(59753),m=n(87479),f=n(149),g=n(98963),h=n(97880),v=n(77080),b=n(79797),y=n(35057);const _=30;function S(){return v.default.checkGate("button_property")}function w(e){const{context:t}=e;let n,o;if(t.persisted){const{automationStore:r}=t,a=e.automationValue??r.getValue();if(!a)return{error:new i.MO("Missing automation record")};n=p.kk.fromValue(g.cv,a),o=r.getActionStores().map((e=>e.getModel())).filter(h.$K)}else n=new a.X({triggerType:"button",actions:t.actions,parentPointer:t.parentPointer,spaceId:t.parentPointer.spaceId}),o=t.actions.map((e=>new a.e(e,t.parentPointer.spaceId)));const r=t.parentRecordStore.getRecordModel,s=t.parentRecordStore.loadRecordModel,c={automationModel:n,actionModels:o,handleDataRequest:(0,d.yf)(r,s),intl:t.intl,getRecordModel:r,loadRecordModel:s,userTimeZone:(0,u.r)()};let m;if("button_property"===t.type){const e=t.collectionContextStore.collectionStore();if(!e)return{error:new i.MO("Missing collectionContextStore")};m={...c,collectionPointer:e.getSpaceShardedPointer(),contextType:t.type}}else if("button_block"===t.type){const e=t.pageStore.getAssociatedCollectionStore();m={...c,collectionPointer:null==e?void 0:e.getSpaceShardedPointer(),contextType:t.type}}else"event"===t.type?m={...c,collectionPointer:t.parentPointer,contextType:t.type}:"structured_automation"===t.type||"recurrence"===t.type||"assistant"===t.type?m={...c,contextType:t.type}:(0,h.t1)(t);return(0,l.rS)(m)}const k=new WeakMap;function I(e){const t=k.get(e.automationStore);if(t)return t;{const t=new o.Z((()=>function(e){const t=e.automationStore.getModel();if(!t)return{executionPermissionStatus:"unknown",typecheckResult:void 0};const n=e.automationStore.getActionStores().map((e=>e.getModel()));if(!n.every((0,h.AO)((e=>(0,h.$K)(e)?{true:e}:{false:e}))))return{executionPermissionStatus:"insufficient",typecheckResult:void 0};const o=w({context:e});if(f.x.isFail(o))return{executionPermissionStatus:"unknown",typecheckResult:o};const i={automationModel:t};for(const a of n){const t=(0,r.z)(a.getType()).getExecutionDependencies(i,a),n=(0,s.TD)({getRecordModel:e.parentRecordStore.getRecordModel,permissions:t,typecheckContextValues:o.value.valueTypes});for(const r of n){const t=(0,b.Kv)(e.parentRecordStore,r.pointer).getRole();if(!t||(0,m.gr)(t,r.minimumRole))return{executionPermissionStatus:"insufficient",typecheckResult:o}}}return{executionPermissionStatus:"sufficient",typecheckResult:o}}(e)),{debugName:"buttonAutomationAnalysisCachedStore"});return k.set(e.automationStore,t),t}}function C(e){return Boolean(e.findRecordStoreUIAncestor((e=>e instanceof b.zq&&e.isType("duplicate_blocks"))).ancestor)}function x(e,t){const n=e.getModel(),o=e.getActionStores(),r=o.filter((e=>e.isDefined())).map((e=>e.getModel())).filter(h.$K);if(n&&r.length===o.length)return{checkExperimentGate:e=>Promise.resolve(v.default.checkGate(e)),checkExperimentGroup:e=>Promise.resolve(v.default.getGroup(e)),checkSubscribed:()=>Promise.resolve((0,y.sX)()),automation:n,automationActions:r,contextType:t,checkType:"canAddAction"}}function T(e){if(!e)return{editPermissionStatus:"unknown",reason:"missing_automation_context"};const{automationStore:t}=e,n=t.getValue(),o=t.getModel();if(!o||!n)return{editPermissionStatus:"unknown",reason:"missing_automation_model"};const i=t.getActionStores().map((e=>e.getModel()));if(!i.every((0,h.AO)((e=>(0,h.$K)(e)?{true:e}:{false:e}))))return{editPermissionStatus:"unknown",reason:"missing_automation_action_model"};const a=w({context:e});if(f.x.isFail(a))return{editPermissionStatus:"unknown",reason:"typecheck_error"};const l=i.length>0&&i.some((e=>!e.isType("slack_notification")));if(o.isType("event")&&l&&!(0,y.sX)())return{editPermissionStatus:"insufficient",reason:"free_workspace"};const d={automationModel:o},u=i.filter((e=>e.isType("slack_notification")));for(const c of u){const t=(0,r.z)(c.getType()).getExecutionDependencies(d,c),n=(0,s.TD)({getRecordModel:e.parentRecordStore.getRecordModel,permissions:t,typecheckContextValues:a.value.valueTypes});for(const o of n){const t=(0,b.Kv)(e.parentRecordStore,o.pointer).getRole();if(!t||(0,m.gr)(t,o.minimumRole))return{actionId:c.id,editPermissionStatus:"insufficient",reason:"missing_permissions"}}}const p=(0,c.fz)({automationValue:n,actionValues:t.getActionStores().map((e=>({config:e.getConfig(),type:e.getType()})))});for(const r of p){const e=t.getRecordRole(r.pointer);if(!e||(0,m.gr)(e,r.minimumRequiredRole))return{editPermissionStatus:"insufficient",reason:"missing_permissions"}}return{editPermissionStatus:"sufficient"}}function M(e){const{contextType:t,environment:n}=e,{device:o}=n,r=o.isIOS&&o.isMobileNative;return"event"===t&&!r}},97004:(e,t,n)=>{n.d(t,{CN:()=>P,Gz:()=>M,H_:()=>_,IX:()=>A,Me:()=>x,Mj:()=>C,Nq:()=>k,OC:()=>b,Pi:()=>T,RL:()=>S,Zh:()=>w,m1:()=>R,mu:()=>B,qd:()=>y,tJ:()=>D,yU:()=>I,ze:()=>E});n(57658);var o=n(76205),r=n(99036),i=n(43690),a=n(10070),s=n(53504),l=n(93824),c=n(42875),d=n(72126),u=n(97880),p=n(40663),m=n(77080),f=n(28020),g=n(17335),h=n(77181),v=n(33929);const b="notion://database/hide_subitems_filter";function y(e){const{schema:t,filters:n,getRecordModel:r}=e,i=[];for(const o of Object.keys(t)){const e=_({property:o,schema:t,getRecordModel:r});e&&i.push(e)}const a=i.filter((e=>!n.find((t=>(0,o.aN)(t.filter)&&t.filter.property===e.property))));return d.MR(a,(e=>{const n=t[e.property];return(null==n?void 0:n.name)||""}))}function _(e){const{property:t,schema:n,getRecordModel:r}=e,i=(0,g.zZ)({property:t,schema:n,getRecordModel:r});if((0,o.a_)(i)?!(0,o.mv)(i.subfilter):!(0,o.mv)(i))return{property:t,filter:i}}function S(e){var t;const{collectionContextStore:n,applySubitemFilter:i,filterOutHideSubitemsQuickFilter:a}=e;let s=n.currentPropertyFiltersStore.state;const l=n.currentCombinatorFilterStore.state,c=i&&n.currentSubitemFormatStoreForUiDisplay.state,u=n.normalizedSchemaStore.state,p=c&&u[c.property],f=p&&"relation"===p.type&&(0,r.F0)(p)===(null===(t=n.collectionStore())||void 0===t?void 0:t.id)&&p.property,g=f?{property:f,filter:{operator:"is_empty"}}:void 0;a&&m.default.checkGate("collection_subitem_new_show_hide_options")&&(s=s.filter((e=>e.id!==b)));const h=(0,o.OH)({propertyFilters:s,combinatorFilter:l,schema:u});return d.oA([g,...h])}function w(e,t){var n,r;const a=e.collectionViewStore();if(!a)return{combinatorFilter:void 0,filters:{moveOps:[],removed:[],updated:[],moved:[],added:[]},sorts:void 0};const c="persisted"===t?a.getQueryStore().getKeyStore("sort").getValue()||[]:(null===(n=e.normalizedQueryStore.state)||void 0===n?void 0:n.sort)||[],u=e.currentSortsStore.state,p="persisted"===t?a.getQueryStore().getKeyStore("filter").getValue():null===(r=e.normalizedQueryStore.state)||void 0===r?void 0:r.filter,m=e.currentCombinatorFilterStore.state,f="persisted"===t?a.getPropertyFiltersStore().getValue()||[]:function(e){const t=e.normalizedSchemaStore.state,n=e.normalizedFormatStore.state.property_filters||[];return d.oA(n.filter((n=>{const r=(0,i.dN)(n.filter,t),a=e.collectionViewBlockStore();if(t[n.filter.property]&&r&&(0,o.J5)(t,n.filter.property,r.filter,null==a?void 0:a.getRecordModel))return r&&{id:n.id,filter:r}})))}(e),g=e.currentPropertyFiltersStore.state,h=f.map((e=>e.id)),v=g.map((e=>e.id)),{beforeOps:b,removeOps:y}=(0,l.q)(h,v),_=Array.from(y).filter((e=>!v.includes(e))),S=Object.keys(b).map((e=>({id:e,beforeId:b[e]}))),w=S.filter((e=>{let{id:t}=e;return h.includes(t)})).map((e=>{let{id:t}=e;return t})),k=S.filter((e=>{let{id:t}=e;return!h.includes(t)})).map((e=>{let{id:t}=e;return t})),I=g.filter((e=>f.find((t=>{if(e.id!==t.id)return!1;const n=d.Xh(t),o=d.Xh(e);return!d.Xy((0,s.Z)(o,"ignore-class-instances"),(0,s.Z)(n,"ignore-class-instances"))})))).map((e=>e.id));return{combinatorFilter:d.Xy(p,m)?void 0:{value:m},filters:{moveOps:S,removed:_,updated:I,moved:w,added:k},sorts:d.Xy(c,u)?void 0:{value:u}}}function k(e){const t=e.localStateDiffStore.state;return Boolean(t.filters.moved.length>0||t.filters.added.length>0||t.filters.removed.length>0||t.filters.updated.length>0||void 0!==t.combinatorFilter||void 0!==t.sorts)}function I(e){const t=e.localStateDiffStore.state;return Boolean(t.filters.moved.length>0||t.filters.added.length>0||t.filters.removed.length>0||t.filters.updated.length>0||void 0!==t.combinatorFilter)}function C(e){const t=e.localStateDiffStore.state;return Boolean(void 0!==t.sorts)}function x(e){return{property:(0,r.uS)(e),filter:{operator:"string_contains",value:{type:"exact",value:void 0}}}}function T(e){const t=e.currentCombinatorFilterStore.state,n=e.currentPropertyFiltersStore.state.filter((e=>!B(e.id))).map((e=>e.filter)),o=[...(null==t?void 0:t.filters)||[],...n];return{...t,filters:o,operator:"and"}}function M(e,t){const n=e.currentCombinatorFilterStore.state,o=e.currentPropertyFiltersStore.state.filter((e=>e.id!==t.id)),r=[...(null==n?void 0:n.filters)||[],t.filter];return{combinatorFilter:{operator:"and",...n,filters:r},propertyFilters:o}}function P(e,t,n,o){let r=n.filter((e=>"is_group"===e.type)).map((t=>e.find((e=>e.name===t.value)))).filter(u.$K),i=n.filter((e=>"is_option"===e.type)).map((e=>t.find((t=>t.value===e.value)))).filter(u.$K);for(const a of e){const e=a.optionIds??[];if(r.some((e=>e.id===a.id)))i=i.filter((t=>!e.includes(t.id)));else if(e.length>0){const t=i.filter((t=>!e.includes(t.id)));t.length+e.length===i.length&&(i=t,r=[...r,a])}}if("is_option"===o.type){const n=t.find((e=>e.value===o.value));if(!n)return;const a=i.filter((e=>e.id!==n.id));if(a.length<i.length)i=a;else{const o=e.find((e=>{var t;return null===(t=e.optionIds)||void 0===t?void 0:t.includes(n.id)})),a=r.find((e=>e.id===(null==o?void 0:o.id)));if(a){const e=t.filter((e=>{var t;return(null===(t=a.optionIds)||void 0===t?void 0:t.includes(e.id))&&e.id!==n.id}));r=r.filter((e=>e.id!==a.id)),i=[...i,...e]}else{i=[...i,n];const e=(null==o?void 0:o.optionIds)??[];if(o&&e.length>0){const t=i.filter((t=>!e.includes(t.id)));t.length+e.length===i.length&&(i=t,r=[...r,o])}}}}else if("is_group"===o.type){const t=e.find((e=>e.name===o.value));if(!t)return;const n=r.filter((e=>e.id!==t.id));if(n.length<r.length)r=n;else{const e=t.optionIds??[];r=[...r,t],i=i.filter((t=>!e.includes(t.id)))}}else(0,u.t1)(o.type);return[...r.map((e=>({type:"is_group",value:e.name}))),...i.map((e=>({type:"is_option",value:e.value})))]}function A(e){const{group:t,options:n,filterValues:o}=e,r=o.some((e=>"is_group"===e.type&&e.value===t.name)),i=n.filter((e=>{var n;return null===(n=t.optionIds)||void 0===n?void 0:n.includes(e.id)})),a=new Map;for(const d of i){const e=o.some((e=>"is_option"===e.type&&e.value===d.value))||r;a.set(d.id,e)}const s=Array.from(a.values()),l=s.some((e=>e)),c=s.every((e=>e))&&s.length>0;return{groupCheckState:!(!r&&!c)||!!l&&"partial",optionCheckedInfo:a}}function R(e){var t;const{collectionStore:n,collectionContextStore:r,environment:i}=e,s=r.relativeVariableStore.state,l=r.currentPropertyFiltersStore.state,d=r.currentCombinatorFilterStore.state,u=l.filter((e=>!(0,o.Oo)(e.filter))).map((e=>e.filter));if(0===u.length&&!d)return;const p=null==n?void 0:n.getModel(),m=null===(t=r.collectionViewStore())||void 0===t?void 0:t.getCollectionSource(),g=r.normalizedSchemaStore.state,h={schema:p&&m?(0,a.Hs)(m.type,g,p):g,userId:i.currentUser.id,userTimeZone:(0,c.r)(),userStartOfWeek:f.AK.state,intl:v.default.getIntl(),relativeVariableResult:s};return{filter:{filters:d?[...u,d]:u,operator:"and"},propertyMapping:void 0,context:h}}function D(e,t,n){const{property:o}=t,i=e[o];if(!(i&&"rollup"===i.type&&i.relation_property&&i.target_property))return i;{const t=e[i.relation_property];if(t&&(0,r.p_)(t)){const e=(0,r.j0)(t);if(e){const t=n.getRecordModel(e);if(!t)return;const o=t.getNormalizedSchema();if(o){const e=o[i.target_property];if(e&&"rollup"!==e.type)return e}}}}}function E(e,t){const n=e.collectionViewStore(),r=e.currentSubitemFormatStoreForUiDisplay.state,i=null==n?void 0:n.getType(),a=S({collectionContextStore:e,applySubitemFilter:t&&Boolean(r)&&!(i&&(0,h.Av)(i)),filterOutHideSubitemsQuickFilter:!t});return(0,o.kk)(a)}function B(e){return(0,p.EE)(e)||e===b}},4708:(e,t,n)=>{n.d(t,{$d:()=>x,A3:()=>y,B9:()=>_,En:()=>I,F$:()=>g,Hk:()=>T,Mo:()=>C,Or:()=>u,Rv:()=>p,Ye:()=>d,_6:()=>l,fJ:()=>w,gp:()=>m,kG:()=>k,p1:()=>c,s$:()=>b,u3:()=>v,uD:()=>S,wE:()=>h,wd:()=>M,zq:()=>f});n(13991),n(95477);var o=n(77080),r=n(88893),i=n(35057),a=n(48779),s=n(95697);function l(e){return!e.device.isMobile&&"on"===o.default.getEligibleGroup({experimentId:"contextual-invite-on-select-focus",defaultGroup:"control"})}function c(){return r.ye()&&"on"===o.default.getEligibleGroup({experimentId:"request_membership",defaultGroup:"control"})}function d(e){return r.ye()&&!(0,i.wP)()&&"on"===o.default.getEligibleGroup({experimentId:"guest_membership_request",defaultGroup:"control"})}function u(){return b()}function p(){return(0,i.Mk)()}function m(e){let{currentSpaceStore:t}=e;return!!(0,a.Q9)(t)&&"on"===o.default.getEligibleGroup({experimentId:"share_modal_placeholder",defaultGroup:"control"})}function f(e){return!e.device.isMobile}function g(){return(0,s.bq)()&&"on"===o.default.getEligibleGroup({experimentId:"teamspace_guests",defaultGroup:"control"})}function h(e){return!e.device.isMobile&&o.default.checkGate("space_settings_people_section")}function v(){return(0,s.bq)()&&"on"===o.default.getEligibleGroup({experimentId:"teams_invite_link",defaultGroup:"control"})}function b(){return(0,s.bq)()&&"on"===o.default.getEligibleGroup({experimentId:"team_invite_link_ms2",defaultGroup:"control"})}function y(){return o.default.checkGate("drawing_block")}function _(){return o.default.checkGate("team_add_app_template_tooltip")}function S(){return o.default.getEligibleGroup({experimentId:"share_modal_autofill_email",defaultGroup:"control"})}function w(){return"on"===o.default.getEligibleGroup({experimentId:"share_modal_pending_invite_status_ui",defaultGroup:"control"})}function k(e){if(!(0,a.Fn)(e))return"control";return(0,s.$)(e)?"control":o.default.getEligibleGroup({experimentId:"share_modal_guest_member_confirmation",defaultGroup:"control"})??"control"}function I(){return!1}function C(){return o.default.checkGate("recover_user_content_in_product")}function x(){return o.default.checkGate("sites_multiple_domains")}function T(){return o.default.checkGate("sites_settings_published_by")}function M(){return o.default.checkGate("guest_invite_requests")}},14976:(e,t,n)=>{n.d(t,{Dn:()=>re,Gj:()=>de,IY:()=>W,Ob:()=>ge,PY:()=>me,Qb:()=>ee,Rl:()=>ve,SD:()=>ie,So:()=>he,TQ:()=>ye,Ut:()=>te,We:()=>_e,Xh:()=>K,bD:()=>H,cD:()=>ue,fm:()=>pe,kV:()=>le,li:()=>ae,lw:()=>ne,n$:()=>X,vO:()=>se,x9:()=>J,xX:()=>fe});var o=n(22377),r=n(15095),i=n(42875),a=n(72126),s=n(82883),l=n(21202),c=n(70203),d=n(44805),u=n(63143),p=n(993),m=n(32741),f=n(48514),g=n(95477),h=n(24990),v=n(33929),b=n(68056),y=n(77080),_=n(30874),S=n(69316),w=n(79797),k=n(24666),I=n(46150),C=n(41056),x=n(62619),T=n(83631),M=n(49394),P=n(45162),A=n(70219),R=n(65598),D=n(31352),E=n(89224);function B(e){return x.kK(e)&&e.classList.contains(d.Eu)}function F(e){return x.kK(e)&&e.classList.contains(d.tL)}function O(e){return function(e){const t=x.sh(e,(e=>(0,T.Xu)(e)||(0,I.eD)(e)));if(t&&B(t))return t}(e)||V(e)||function(e){const t=x.sh(e,(e=>F(e)||(0,I.eD)(e)));if(t&&F(t))return t}(e)}function Z(e){return x.kK(e)&&e.classList.contains(o.P)}function V(e){const t=x.sh(e,(e=>(0,T.Xu)(e)||(0,I.eD)(e)));if(t&&(0,T.Xu)(t))return t}const U=function(e){return x.kK(e)&&e.classList.contains(d.mb)},N=function(e){if(U(e))return!0;try{return U(e.parentNode)}catch(t){return!1}},L=function(e){try{const t=x.sh(e,(e=>Boolean(e.getAttribute&&e.getAttribute("contenteditable"))||(0,I.eD)(e)));return t&&t.isContentEditable}catch(t){return!1}};function j(e){return x.kK(e)&&e.classList.contains(d.$A)}function z(e,t){if(e===t.container){if(x.Gs(e)){const n=e.textContent||"";return(0,r.p4)(n.substring(0,t.offset)).length}{const n=Array.from(e.childNodes).slice(0,t.offset).map((e=>Q(G(e)))).join("");return(0,r.p4)(n).length}}let n=0;for(const o of Array.from(e.childNodes)){if(o.contains(t.container))return n+z(o,t);n+=(0,r.p4)(Q(G(o))).length}return n}function q(e,t){const n=(0,I.X1)(e);if(!n)return 0;const o=function(e,t){const n=O(e);if(n){const e=n.parentNode,o=Array.from(e.childNodes).indexOf(n);return{container:e,offset:0===t?o:o+1}}if(U(e)||U(e.parentNode))return{container:e,offset:(e.textContent||" ").length-1};return{container:e,offset:t}}(e,t);return z(n,o)}function H(e,t){if(0===t)return!(e.childNodes.length>0)||B(e.childNodes[0])||Z(e.childNodes[0])||(0,T.Xu)(e.childNodes[0])||F(e.childNodes[0])||j(e.childNodes[0])?{container:e,offset:0}:{container:e.childNodes[0],offset:0};const n=a.cx(e.childNodes,j),o=n>=0?n-1:e.childNodes.length-1;let i=t;for(let s=0;s<=o;s++){const t=e.childNodes[s],n=Q(G(t)),l=(0,r.p4)(n).length;if(s===o?i-l<=0:i-l<0){if(B(t)||(0,T.Xu)(t)||Z(t)||U(t)||F(t)){const e=x.oG(t.parentNode,t);return{container:t.parentNode,offset:e}}if(t.nodeType===Node.TEXT_NODE){return{container:t,offset:a.tP((0,r.p4)(n),0,i).join("").length}}return H(t,i)}i-=l}return{container:e,offset:0}}function W(e){const{environment:t,textValue:n,parentStore:o,disableHover:r,disableStyleAnnotations:a,disableInsertedDeletedAnnotations:s,disableDateStyleAnnotations:l,disabled:c,emojiType:u,highlightDiscussionId:p,renderedPageBlockId:m,parentBlockId:f,theme:b,katex:S,disableLinks:w,formulaValueTypes:k,stopLinkPropagation:I,linkTargetBlank:x}=e,{device:T,currentUser:M}=t,P=y.default.checkGate("enable_deleted_page_indicator");return d.IY({textValue:n,getRecordModel:o.getRecordModel,getRecordRole:o.getRecordRole,disableHover:r,disableStyleAnnotations:a,disableInsertedDeletedAnnotations:s,disableDateStyleAnnotations:l,disableLinks:w||!1,userTimeZone:(0,i.r)(),disabled:c,isAndroid:T.isAndroid,isSafariOrIOS:T.isSafari||T.isIOS,isWindows:T.isWindows,showEmojiInline:T.isWindows,emojiType:u,highlightDiscussionId:p,theme:b,intl:v.default.getIntl(),renderedPageBlockId:m,parentBlockId:f,katex:S,isClient:!0,baseUrl:g.default.domainBaseUrl,publicDomainName:g.default.publicDomainName,currentUserId:M.id,overwriteBaseUrlFromSpaceId:(0,A.b)(t),externalIntegrations:_.Z.integrations.state,formulaValueTypes:k,enableDeletedPageIndicator:P,stopLinkPropagation:I,linkTargetBlank:x,emojiData:h.Z.state,getToday:C.H,isMobileNative:T.isMobileNative,isMobileNativeExternalLinkFixEnabled:y.default.checkGate("mobile_native_external_link_fix"),displayInUserTimezone:y.default.checkGate("display_date_in_user_timezone")})}const K=function(e,t){return(0,s.X)({textValue:e,getRecordModel:t.getRecordModel,userTimeZone:(0,i.r)(),intl:v.default.getIntl()})};function G(e){let t="";if(B(e))t+=c.qyI;else if((0,T.Xu)(e))t=c.fuX;else if(Z(e))t+=e.alt;else if(function(e){return x.kK(e)&&"br"===e.tagName.toLowerCase()}(e))t+="\n";else if(x.Gs(e))t+=e.textContent;else if(F(e));else for(const n of Array.from(e.childNodes))t+=G(n);return t}const $=new RegExp(d.U3,"g");function Q(e){return e.replace($,"")}const Y={[c.qyI]:{deleteEndToken:new RegExp(`${c.qyI}$`,"g"),deleteToken:new RegExp(`(${c.qyI})([^${d.U3}])`,"g"),existingToken:new RegExp(`${c.qyI}${d.U3}`,"g")},[c.fuX]:{deleteEndToken:new RegExp(`${c.fuX}$`,"g"),deleteToken:new RegExp(`(${c.fuX})([^${d.U3}])`,"g"),existingToken:new RegExp(`${c.fuX}${d.U3}`,"g")}};function X(e,t){if(!t)return"";let n=G(t);if(e.device.isAndroid)for(const[o,r]of Object.entries(Y))n=n.replace(r.deleteEndToken,"").replace(r.deleteToken,"$2").replace(r.existingToken,o);return"\n"===n[n.length-1]&&(n=n.substring(0,n.length-1)),n}function J(e,t,n){if(!e)return!1;let o=n,r=t;for(;r!==e&&!j(r);){const{parentNode:e}=r;if(!e)break;o=x.oG(e,r),r=e}if(j(r))return o>0;const i=a.cx(e.childNodes,j);return!(i<0)&&(r===e&&o>i)}function ee(e,t){const n=(0,I.X1)(e);if(!n)return;const o=q(e,t),r=O(e);return{index:o,forceEmit:Boolean(r),afterEndOfLine:J(n,e,t)}}function te(e,t){if(t||(t=E.get()),t){const e=q(t.startContainer,t.startOffset),n=q(t.endContainer,t.endOffset),o=O(t.startContainer)||O(t.endContainer);return{selection:{startIndex:e,endIndex:n},forceEmitSelectionStore:Boolean(o)}}}function ne(e,t,n){const o=H(e,t),r=H(e,n);return E.rangeFromContainerOffsets({start:o,end:r})}function oe(e,t,n,o){if(e===n&&t===o)return!0;if(N(e)!==N(n))return!1;if(V(e)!==V(n))return!1;const r=(0,I.X1)(e),i=(0,I.X1)(n);if(r!==i)return!1;if(q(e,t)!==q(n,o))return!1;return J(r,e,t)===J(i,n,o)}function re(e,t){return!e&&!t||!(!e||!t)&&(e.startOffset===t.startOffset&&e.endOffset===t.endOffset&&e.startContainer===t.startContainer&&e.endContainer===t.endContainer||L(e.startContainer)&&L(t.startContainer)&&oe(e.startContainer,e.startOffset,t.startContainer,t.startOffset)&&oe(e.endContainer,e.endOffset,t.endContainer,t.endOffset))}function ie(e){const{environment:t,event:n,textValue:o,editorNode:r,store:i,canEdit:a,disableEquationInteraction:s}=e,l=ce({event:n,textValue:o,editorNode:r});(t.device.isFirefox||"editing"!==k.default.state.mode||k.default.isEmptySelection()||l&&(0,T.Xu)(l.node))&&l&&(s&&(0,T.Xu)(l.node)||p.VO({environment:t,event:n,interactiveToken:l,store:i,canEdit:a}))}function ae(e){const{environment:t,event:n,textValue:o,editorNode:r,store:i,parentStore:a,canEdit:s}=e,l=ce({event:n,textValue:o,editorNode:r});l&&p.ON({environment:t,event:n,interactiveToken:l,store:i,parentStore:a,canEdit:s})}function se(e){const{environment:t,event:n,textValue:o,editorNode:r,store:i,canEdit:a}=e,s=ce({event:n,textValue:o,editorNode:r});s&&p.Nh({environment:t,event:n,interactiveToken:s,store:i,canEdit:a})}function le(e){const{environment:t,event:n,textValue:o,editorNode:r,store:i,canEdit:a}=e;if(n.target===r)return void m.lY();const s=ce({event:n,textValue:o,editorNode:r});s&&p.Zl({environment:t,event:n,interactiveToken:s,store:i,canEdit:a})}function ce(e){const{event:t,textValue:n,editorNode:o}=e,r=x.sh(t.target,(e=>Boolean(e.getAttribute&&e.getAttribute("data-token-index"))));if(r&&null!=o&&o.contains(r)){const e=r.getAttribute("data-token-index");if(e){const t=parseInt(e,10);if(n){const e=n[t];if(e)return{textValue:n,tokenIndex:t,textToken:e,node:r}}}}}const de=e=>pe({store:e.store,temporaryAnnotation:c.GKr.TemporaryComment,multiSelection:f.Z.state.open&&"inline"===f.Z.state.type?f.Z.state.multiSelection:void 0}),ue=e=>{const{find:t,blockId:n}=e;let{textValue:o}=e;if(!o)return;const r=S.Z.state.currentFocusedResult;return(0,M.ub)({textValue:o,find:t,intl:v.default.getIntl()}).forEach(((e,t)=>{let{selection:i}=e;const s=n&&n===(null==r?void 0:r.id)&&a.Xy(i,null==r?void 0:r.selection)?c.GKr.TemporarySelectedFindHighlight:c.GKr.TemporaryFindHighlight;o=c.aSf({textValue:o,selection:i,annotation:[s]})})),o},pe=e=>{const{store:t,temporaryAnnotation:n,multiSelection:o}=e,r=t.getValue();if(o){const e=(0,P.L5)(o).find((e=>{let{store:n}=e;return n===t}));if(e){const{selection:t}=e;return c.aSf({textValue:r,selection:t,annotation:[n]})}}return r};function me(e){const{store:t,equationStore:n}=e;if(!n.isOpen())return;const o=(0,b.QY)(n.state.savedTextSelectionState.multiSelection);if(!o)return;const{store:r,selection:i}=o;if(t!==r)return;const a=r.getValue(),s=i.startIndex===i.endIndex?a:c._QS(a,i.startIndex,i.endIndex),l=T.qZ({equationState:n.state,isTemporary:!0});return l?c.P$X(s,[l],i.startIndex):void 0}function fe(e){const{store:t,selection:n}=e,o=t.getValue();if(n.startIndex+1!==n.endIndex)return o;const r=c.b1T(o,n.startIndex);if(!r||!c.eOb(r))return o;const i=n.startIndex===n.endIndex?o:c._QS(o,n.startIndex,n.endIndex),a=(0,u.uh)(r[1],c.rIb),s=[r[0],[...a,c.EPB()]];return c.P$X(i,[s],n.startIndex)}function ge(e){const{store:t,mentionMenuState:n}=e,o=t.getValue();if(n.textStore!==t)return o;const r=n.temporaryInputData.state;if(!r)return o;const i=(0,D.O2)(t,n.oldTextValue,r.prefix);if(i&&i.prefix){const{tokensBeforeRange:e,tokensInsideRange:t,tokensAfterRange:n}=c.xrQ(o,i.prefix.startIndex,i.filter.endIndex),a=c.QaF(t);return[...e,c.V3y(a,[c.mF$(r)]),...n]}return o}function he(e){const{store:t,selection:n}=e,o=t.getValue(),{tokensBeforeRange:r,tokensInsideRange:i,tokensAfterRange:a}=c.xrQ(o,n.startIndex,n.endIndex),s=c.QaF(i);return[...r,c.V3y(s,[[c.GKr.TemporarySelection]]),...a]}const ve=e=>{let{store:t,textValue:n}=e;if(!n)return n;if(t.table!==l.iU)return n;const o=w.G.createChildStore(t,{table:t.table,id:t.id});if(o.isInsideCollection()||o.isType("callout")||o.isType("code"))return n;let r=n;return(0,R.bB)((0,R.yJ)(o)).unresolved.forEach((e=>{const t=["m",e.id];r=c.aSf({textValue:r,annotation:t,selection:{startIndex:0,endIndex:1/0}})})),r};function be(e){if(e.nodeType===Node.TEXT_NODE)return e;if(x.kK(e)&&"false"===e.getAttribute("contentEditable"))return e;let t;const n=x.kd(e);return n.forEach((e=>{null!==e.textContent&&e.textContent.indexOf("\n")>=0&&(t=e)})),t||(n.length>0?n[n.length-1]:e)}function ye(e){const t=E.get();if(!t)return;const n=t.startContainer,o=(0,I.X1)(n),r=null==o?void 0:o.childNodes,i=!E.isExpanded(t);if(r&&(r.length>1||i)){const i=(0,I.g4)(n,o),g=a.cx(r,(e=>e===i));let h,v,b=!0,y=n,_=t.startOffset;if(0===_)for(let e=g-1;b&&e>=0;e--){const t=be(r[e]);if(t.nodeType===Node.TEXT_NODE){var s;const e=null===(s=t.textContent)||void 0===s?void 0:s.lastIndexOf("\n");var l,c;if(void 0!==e&&e>=0)null!==(l=t.textContent)&&void 0!==l&&l.length&&e+1<(null===(c=t.textContent)||void 0===c?void 0:c.length)&&(y=t,_=e+1),b=!1;else y=t,_=0}else y=t,_=0}b=!0;for(let e=g;b&&e<r.length;e++){const t=be(r[e]);if(t.nodeType===Node.TEXT_NODE){let e;var d,u,p,m;if(y===t)e=null===(d=t.textContent)||void 0===d?void 0:d.indexOf("\n",_);else e=null===(u=t.textContent)||void 0===u?void 0:u.indexOf("\n");if(void 0!==e&&e>=0)h=t,v=e+1===(null===(p=t.textContent)||void 0===p?void 0:p.length)?e:e+1,b=!1;else h=t,v=(null===(m=t.textContent)||void 0===m?void 0:m.length)||0}else{var f;h=t,v=(null===(f=t.textContent)||void 0===f?void 0:f.length)||0}}if(y&&h){const t=E.rangeFromContainerOffsets({start:{container:y,offset:_},end:{container:h,offset:v||0}});E.set(t,e)}}}function _e(e,t){const n=c.$0A(e.id,e.getSpaceId()),o=c.YCD(n);return{textValue:[o],tokenIndex:0,textToken:o,node:t}}},70764:(e,t,n)=>{n.d(t,{NP:()=>s,QS:()=>f,mO:()=>c,sw:()=>m,xt:()=>p});var o=n(20270),r=n(9291),i=(n(95477),n(77080)),a=n(30874);function s(e){const t=a.Z.state;return t.loaded?t.bots.filter((t=>t.integration_id===e)):[]}const l=(0,r.defineMessages)({invalidRequest:{id:"unfurlingHelpers.authenticatedErrorDescription.invalidRequest",defaultMessage:"The authentication request is invalid. Please contact support if issue persists."},unauthorizedClient:{id:"unfurlingHelpers.unauthorizedClient.",defaultMessage:"The client is not authorized to request an authorization code using this method. Please contact support if issue persists."},accessDenied:{id:"unfurlingHelpers.authenticatedErrorDescription.accessDenied",defaultMessage:"The resource owner or authorization server denied the request. Check with your organization or resource owner to ensure OAuth installation is enabled."},unsupportedResponseType:{id:"unfurlingHelpers.authenticatedErrorDescription.unsupportedResponseType",defaultMessage:"The authorization server does not support obtaining an authorization code using this method. Please contact support if issue persists."},invalidScope:{id:"unfurlingHelpers.authenticatedErrorDescription.invalidScope",defaultMessage:"The requested scope is invalid. Please contact support if issue persists."},serverError:{id:"unfurlingHelpers.authenticatedErrorDescription.serverError",defaultMessage:"The authorization server encountered an unexpected condition that prevented it from fulfilling the request. Please contact support if issue persists."},temporarilyUnavailable:{id:"unfurlingHelpers.authenticatedErrorDescription.temporarilyUnavailable",defaultMessage:"The authorization server is currently unable to handle the request due to a temporary overloading or maintenance of the server. Please contact support if issue persists."},githubAppRequestAccessUnsupported:{id:"unfurlingHelpers.authenticatedErrorDescription.githubAppRequestAccessUnsupported",defaultMessage:"Request Access is not supported. You must be both a Github Admin and Notion Workspace Admin to connect the two apps."},unknownError:{id:"unfurlingHelpers.authenticatedErrorDescription.unknownError",defaultMessage:"The authorization server responded with an unknown error (`{value}`). Please contact support if issue persists."}});function c(e){return"invalid_request"===e?l.invalidRequest:"unauthorized_client"===e?l.unauthorizedClient:"access_denied"===e?l.accessDenied:"unsupported_response_type"===e?l.unsupportedResponseType:"invalid_scope"===e?l.invalidScope:"server_error"===e?l.serverError:"temporarily_unavailable"===e?l.temporarilyUnavailable:"github_app_request_access_unsupported"===e?l.githubAppRequestAccessUnsupported:l.unknownError}const d=(0,r.defineMessages)({unknownError:{id:"unfurlingHelpers.unfurlResponseError.unknownError",defaultMessage:"Can't load preview"},accessDenied:{id:"unfurlingHelpers.unfurlResponseError.accessDenied",defaultMessage:"Access denied"},reAuthenticate:{id:"unfurlingHelpers.unfurlResponseError.reAuthenticate",defaultMessage:"Re-authentication necessary"},notFound:{id:"unfurlingHelpers.unfurlResponseError.notFound",defaultMessage:"Content not found"},unprocessableEntity:{id:"unfurlingHelpers.unfurlResponseError.unprocessableEntity",defaultMessage:"Unrecognized URL"},rateLimited:{id:"unfurlingHelpers.unfurlResponseError.rateLimited",defaultMessage:"Too many requests"},serverError:{id:"unfurlingHelpers.unfurlResponseError.serverError",defaultMessage:"Can't load preview"},invalidRequest:{id:"unfurlingHelpers.unfurlResponseError.invalidRequest",defaultMessage:"Can't load preview"},authRefresh:{id:"unfurlingHelpers.unfurlResponseError.authRefresh",defaultMessage:"Fetching Preview"},githubNotAcceptable:{id:"unfurlingHelpers.unfurlResponseError.githubNotAcceptable",defaultMessage:"Need owner role"},jiraNotAcceptable:{id:"unfurlingHelpers.unfurlResponseError.jiraNotAcceptable",defaultMessage:"Synced in another workspace"},notAcceptable:{id:"unfurlingHelpers.unfurlResponseError.notAcceptable",defaultMessage:"Not Acceptable"},databaseSyncLimit:{id:"unfurlingHelpers.unfurlResponseError.databaseSyncLimit",defaultMessage:"Synced Database limit reached"}}),u=(0,r.defineMessages)({unknownError:{id:"unfurlingHelpers.unfurlResponseErrorDescription.unknownError",defaultMessage:'There was an error trying to get information for this resource. Received error code "{statusCode}".'},accessDenied:{id:"unfurlingHelpers.unfurlResponseErrorDescription.accessDenied",defaultMessage:"You do not have appropriate permission to access this resource."},reAuthenticate:{id:"unfurlingHelpers.unfurlResponseErrorDescription.reAuthenticate",defaultMessage:"You need to re-authenticate your account to access this resource."},notFound:{id:"unfurlingHelpers.unfurlResponseErrorDescription.notFound",defaultMessage:"The resource information for this link could not be found. It may no longer exist or you may not have appropriate permission to access it."},unprocessableEntity:{id:"unfurlingHelpers.unfurlResponseErrorDescription.unprocessableEntity",defaultMessage:"This url is not currently embedable by this integration."},rateLimited:{id:"unfurlingHelpers.unfurlResponseErrorDescription.rateLimited",defaultMessage:'"{integrationName}" received too many requests for you or your organization. Please wait a few minutes and try again.'},serverError:{id:"unfurlingHelpers.unfurlResponseErrorDescription.serverError",defaultMessage:'Oh no! Seems like there was a "{integrationName}" server error. Received error code "{statusCode}".'},invalidRequest:{id:"unfurlingHelpers.unfurlResponseErrorDescription.invalidRequest",defaultMessage:'There was an error trying to get information for this resource. Received error code "{statusCode}".'},authRefresh:{id:"unfurlingHelpers.unfurlResponseErrorDescription.authRefresh",defaultMessage:"Fetching Preview via Login Update, please wait."},githubNotAcceptable:{id:"unfurlingHelpers.unfurlResponseErrorDescription.githubNotAcceptable",defaultMessage:"You do not have appropriate permission to sync this resource. You need to have an owner role."},jiraNotAcceptable:{id:"unfurlingHelpers.unfurlResponseErrorDescription.jiraNotAcceptable",defaultMessage:"You have synced this resource in another workspace."},notAcceptable:{id:"unfurlingHelpers.unfurlResponseErrorDescription.notAcceptable",defaultMessage:"You do not have appropriate permission to sync this resource. You need to have an owner role."},databaseSyncLimit:{id:"unfurlingHelpers.unfurlResponseErrorDescription.databaseSyncLimit",defaultMessage:"Your workspace has hit the Synced Database limit."}});function p(e,t){return void 0===e?{message:d.unknownError,description:u.unknownError}:401===e?{message:d.reAuthenticate,description:u.reAuthenticate}:439===e?{message:d.authRefresh,description:u.authRefresh}:403===e?{message:d.accessDenied,description:u.accessDenied}:404===e?{message:d.notFound,description:u.notFound}:422===e?{message:d.unprocessableEntity,description:u.unprocessableEntity}:429===e?{message:d.rateLimited,description:u.rateLimited}:406===e?"jira"===t?{message:d.jiraNotAcceptable,description:u.jiraNotAcceptable}:"github"===t?{message:d.githubNotAcceptable,description:u.githubNotAcceptable}:{message:d.notAcceptable,description:u.notAcceptable}:417===e?{message:d.databaseSyncLimit,description:u.databaseSyncLimit}:(0,o.Ms)(e)?{message:d.serverError,description:u.serverError}:{message:d.invalidRequest,description:u.invalidRequest}}function m(e){return!e.device.isMobileBrowser}function f(){return"on"===i.default.getGroup("beta-developers-external")}},15010:(e,t,n)=>{n.d(t,{JF:()=>a,QZ:()=>i,WD:()=>l,e2:()=>s});n(92996);var o=n(44317),r=(n(40663),n(80444));function i(){const{currentUserSettingsStore:e,currentSpaceStore:t}=r.default.state,n=(null==e?void 0:e.getSettings())||{},o=null==t?void 0:t.getPlanType();return"professional"===n.domain_type&&"team"===o}function a(){const{currentUserSettingsStore:e}=r.default.state;return((null==e?void 0:e.getSettings())||{}).domain_type}function s(e){const t=e.getSettings(),n=null==t?void 0:t.signup_time;return n?(0,o.O5)(n):null}function l(e){const{currentUserSettingsStore:t}=r.default.state;if(t&&t.id===e.currentUser.id)return t}},56518:(e,t,n)=>{n.d(t,{Ef:()=>C,FQ:()=>x,Gp:()=>y,IU:()=>h,Li:()=>v,X4:()=>S,ZI:()=>k,ax:()=>I,nZ:()=>_,tt:()=>b,xF:()=>g});var o=n(15145),r=n(97531),i=n(1800),a=n(42875),s=n(25718),l=n(482),c=n(74446),d=n(21202),u=n(97880),p=n(95477),m=n(79797),f=n(33929);const g="paste";function h(e){let t,n;const o=new Set,r=new Set;for(const i of e){const e=i.getParentBlockStore();if(e&&"column"===e.getType()){o.add(e.id),r.add(i.id);const a=e.getParentBlockStore();if(a&&"column_list"===a.getType()){n=a.getSpaceId();const e=a.id;if(void 0===t&&(t=e),t!==e)return}}}if(t&&o.size>1&&n)return{columnListId:t,columnIds:o,blockIds:r,spaceId:n}}function v(e,t){if(!e.clipboardData)return;const n=e.clipboardData.getData("text/html");e.clipboardData.setData("text/html",`${n}${y(t)}`)}function b(e){if(!e.clipboardData)return;return _(e.clipboardData.getData("text/html"))}function y(e){return`\x3c!-- notionvc: ${e} --\x3e`}function _(e){const t=e.match(/\<\!-- notionvc\: ([0-9A-F]{8}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{4}-[0-9A-F]{12}) --\>$/i);return t?t[1]:void 0}function S(e){const{blockValues:t,rootBlock:n,getRecordValue:o,isWindows:r,markdownSerializationOptions:i,markdownLinkifyIt:a}=e;let l=s.on(t,{...I({rootBlock:n,getRecordValue:o}),transformAnnotation:null==i?void 0:i.transformAnnotation,transformBlockMapping:null==i?void 0:i.transformBlockMapping});const c={markdown:void 0,html:void 0};if(l){l=l.replaceAll(w,"$1"),c.markdown=k(r,l);const e=a&&s.c8({...a,markdown:l});e&&(c.html=k(r,e))}return c}const w=/\[(https?:\/\/[^\])]+)\]\(\1\)/g;function k(e,t){return e?t.split("\r\n").reduce(((e,t)=>[...e,...t.split("\n")]),[]).join("\r\n"):t}function I(e){const{rootBlock:t,getRecordValue:n}=e;return{root:t,navigableBlockId:t.id,renderParentBlockId:void 0,blockId:t.id,userTimeZone:(0,a.r)(),intl:f.default.getIntl(),getRecordValue:n,numberedListCache:{},bulletedListCache:{},getRecordsWithParent:()=>[],getExportedPathToFile:e=>{let{toFileURI:t}=e;return t},getExportedRenderAsset:e=>{let{toFileURI:t}=e;return t},getExportedPathToPage:e=>{let{toPageId:t}=e;return(0,i.Z)({pageId:t,pageValue:n({table:d.iU,id:t}),baseUrl:p.default.domainBaseUrl,pageVisitSource:o.tY.Export})},baseUrl:p.default.domainBaseUrl,publicDomainName:p.default.publicDomainName,resultCache:new Map}}function C(e){const{rootBlock:t,clipboardData:n,isWindows:o,fallbackGetRecordValue:r,markdownSerializationOptions:i,markdownLinkifyIt:a}=e,{tree:s,blockSelection:l}=n,d=c.mF.tryUntilFound(...l.blocks.map((e=>e.blockSubtree&&c.mF.fromRecordMap(e.blockSubtree))).filter(u.$K),r),p=s.value,m=l.blocks.map((e=>d({...p,id:e.blockId}))).filter(u.$K);return S({rootBlock:t,getRecordValue:d,blockValues:m,isWindows:o,markdownSerializationOptions:i,markdownLinkifyIt:a})}function x(e){const t=e.pointerPath[e.pointerPath.length-1];return m.G.isTextSliceTreeTextValuePath(e.attributePath)?[l.op.set({pointer:t,path:["properties","title"],args:e.copiedText}),l.op.update({pointer:t,path:["format"],args:(0,r.K$)(t.id,e.copiedText)})]:[l.op.set({pointer:t,path:e.attributePath,args:e.copiedText})]}},75079:(e,t,n)=>{n.d(t,{Pn:()=>s,Pp:()=>m,Y5:()=>u,ZO:()=>c,vS:()=>l,yr:()=>p});var o=n(43690),r=n(58421),i=n(77080),a=n(77144);function s(e,t){const n=null==e?void 0:e.collectionViewBlockStore(),o=null==e?void 0:e.collectionStore(),i=null==e?void 0:e.collectionViewStore(),a=null==e?void 0:e.filtersBarOpenStore.state,s=null==i?void 0:i.getType(),l=(null==e?void 0:e.settingsStore)&&(0,r.n)(null==e?void 0:e.settingsStore),c=null==n?void 0:n.id;return{view_type:s,context_type:null==e?void 0:e.contextType,is_compact_view:null==e?void 0:e.isCompactView.state,settings_menu:null!=e&&e.settingsStore.state.open&&l?l.type:void 0,collection_id:t||(null==o?void 0:o.id),collection_view_id:null==i?void 0:i.id,collection_view_block_id:c,filters_bar_open:a,is_in_wiki:null==n?void 0:n.isCollectionViewPageWithContent(),personal_home_type:null==e?void 0:e.getPageVisitSourceOverride(),database_visit_id:null==e?void 0:e.visitSessionId}}function l(e,t){var n,r,i,a,s,l,u;if(!e)return{view_type:"missing_context_store",row_count_category:"missing_context_store",column_count_category:"missing_context_store",has_relation_column:"missing_context_store",has_rollup_column:"missing_context_store",has_formula_column:"missing_context_store",is_client_mode_enabled:"missing_context_store",tracking_source:void 0,collection_view_block_id:"missing_context_store",collection_view_id:"missing_context_store",collection_id:"missing_context_store",collection_type:"missing_context_store",has_groups:"missing_context_store",has_aggregations:"missing_context_store",database_visit_id:"missing_context_store"};const p=e.isClientModeEnabled.state,m=(null===(n=e.collectionViewBlockStore())||void 0===n?void 0:n.id)||"missing",f=(null===(r=e.collectionViewStore())||void 0===r?void 0:r.id)||"missing",g=(null===(i=e.collectionStore())||void 0===i?void 0:i.id)||"missing",h=null===(a=e.collectionViewStore())||void 0===a?void 0:a.getCollectionSource(),v=null===(s=e.collectionStore())||void 0===s?void 0:s.getSchema();if(!v)return{view_type:"missing_schema",row_count_category:"missing_schema",column_count_category:"missing_schema",has_relation_column:"missing_schema",has_rollup_column:"missing_schema",has_formula_column:"missing_schema",is_client_mode_enabled:p,tracking_source:t,collection_view_block_id:m,collection_view_id:f,collection_id:g,collection_type:(null==h?void 0:h.type)||"missing",has_groups:"missing_schema",has_aggregations:"missing_schema",database_visit_id:e.visitSessionId};const{has_relation_column:b,has_rollup_column:y,has_formula_column:_}=function(e){const t="missing_schema";if(void 0===e)return{has_relation_column:t,has_rollup_column:t,has_formula_column:t};let n=!1,o=!1,r=!1;for(const i of Object.values(e))if("relation"===(null==i?void 0:i.type)&&(n=!0),"rollup"===(null==i?void 0:i.type)&&(o=!0),"formula"===(null==i?void 0:i.type)&&(r=!0),n&&o&&r)break;return{has_relation_column:n,has_rollup_column:o,has_formula_column:r}}(v),S=null===(l=e.remoteRequestStore.state)||void 0===l?void 0:l.loader;let w="missing",k="missing";return S&&(w=o.LU(S),k=o.sn(S)),{view_type:e.getViewType()||"unknown",row_count_category:c(null===(u=e.remoteResult.state)||void 0===u?void 0:u.sizeHint),column_count_category:d(v),has_relation_column:b,has_rollup_column:y,has_formula_column:_,is_client_mode_enabled:p,tracking_source:t,collection_view_block_id:m,collection_view_id:f,collection_id:g,collection_type:(null==h?void 0:h.type)||"missing",has_groups:w,has_aggregations:k,database_visit_id:e.visitSessionId}}function c(e){return void 0===e?"unknown":e<=100?"0-100":e<=200?"100-200":e<=300?"200-300":e<=400?"300-400":e<=500?"400-500":e<=600?"500-600":e<=700?"600-700":e<=800?"700-800":e<=900?"800-900":e<=1e3?"900-1000":"1001_or_more"}function d(e){const t=Object.keys(e).length;return t<=10?"0-10":t<=20?"10-20":t<=50?"20-50":"51_or_more"}function u(e){const{from:t,collectionContextStore:n,sizeHintAtStart:o}=e,r=l(n),{row_count_category:i,...a}=r;return{...a,from:t,property_type:"property_type"in e?e.property_type:void 0,did_trigger_fetch:n?n.isLoading.state:"missing_context_store",row_count_category:c(o)}}function p(e){const{collectionContextStore:t,is_native_drop:n,is_empty:o}=e;return{...l(t),is_native_drop:n,is_empty:o}}function m(e){var t;const{environment:n,collectionContextStore:r,visibleItemsCount:s}=e,c=l(r),d=r.remoteResult.state?o.aW({result:r.remoteResult.state}).length:0,u=0===d?void 0:s/d;return{...c,percentage_of_remote_result_visible:void 0===u?"empty_remote_result":0===u?"0":u<=.25?"0-25":u<=.5?"25-50":u<=.75?"50-75":u<1?"75-100":1===u?"100":"greater_than_100",wasm_sqlite_initialized:a.Z.state.metricData.state.wasm_sqlite_initialized,did_prefetch:"hit-match"===(null===(t=n.prefetchCache)||void 0===t||null===(t=t.getPrefetchAnalytic("queryCollection"))||void 0===t?void 0:t.type),has_split_aggregation_feature:i.default.checkGate("collection_split_aggregation_v2")}}},17335:(e,t,n)=>{n.d(t,{$7:()=>_,D0:()=>k,Fc:()=>S,HL:()=>x,IF:()=>A,KV:()=>G,Qz:()=>$,SW:()=>Y,Sb:()=>w,Sj:()=>y,WC:()=>v,_T:()=>R,cq:()=>B,ip:()=>T,li:()=>H,qh:()=>z,rn:()=>m,x:()=>C,xe:()=>X,zZ:()=>g});var o=n(2032),r=n(76205),i=n(34299),a=n(35102),s=n(72126),l=n(97880),c=n(4308),d=n(9291),u=n(33929);const p={text:{operator:"string_contains",value:{type:"exact",value:void 0}},relation:{operator:"relation_contains",value:{type:"exact",value:void 0}},url:{operator:"string_contains",value:{type:"exact",value:void 0}},checkbox:{operator:"checkbox_is",value:{type:"exact",value:void 0}},created_by:{operator:"person_contains",value:{type:"exact",value:void 0}},last_edited_by:{operator:"person_contains",value:{type:"exact",value:void 0}},select:{operator:"enum_is",value:{type:"exact",value:void 0}},multi_select:{operator:"enum_contains",value:{type:"exact",value:void 0}},status:{operator:"status_is",value:{type:"is_group",value:void 0}},person:{operator:"person_contains",value:{type:"exact",value:void 0}},number:{operator:"number_equals",value:{type:"exact",value:void 0}},auto_increment_id:{operator:"number_equals",value:{type:"exact",value:void 0}},date:{operator:"date_is_relative_to",value:{type:"relative",value:"surrounding",unit:"week"}},created_time:{operator:"date_is",value:{type:"exact",value:void 0}},last_edited_time:{operator:"date_is",value:{type:"exact",value:void 0}},last_visited_time:{operator:"date_is",value:{type:"exact",value:void 0}},email:{operator:"string_contains",value:{type:"exact",value:void 0}},phone_number:{operator:"string_contains",value:{type:"exact",value:void 0}},title:{operator:"string_contains",value:{type:"exact",value:void 0}},file:{operator:"is_empty"},location:{operator:"location_is",value:{type:"exact",value:void 0}},verification:{operator:"verification_is",value:{type:"exact",value:void 0}}};function m(e){return p[e]}function f(e){return"v2"===e.version?function(e){if(!e.formula2)return{operator:"is_empty"};const t=e.formula2.result_type;if("array"===t.type){const e=(0,a.B8)(t.of);return"array"===e.type||"function"===e.type?{operator:"is_empty"}:"block"===e.type||"unknown"===e.type?{operator:"any",subfilter:m("text")}:{operator:"any",subfilter:m(e.type)}}if("unknown"===t.type||"block"===t.type)return m("text");return m(t.type)}(e):function(e){return e.formula&&e.formula.result_type?m(e.formula.result_type):{operator:"is_empty"}}(e)}function g(e){const{property:t,schema:n}=e,a=n[t];if(!a||"button"===a.type)return{operator:"is_empty"};if("formula"===a.type)return f(a);if("rollup"===a.type){if(a.aggregation&&"show_unique"!==a.aggregation){return m((0,o.W6)((0,o.gu)(a.aggregation)))}{const t=(0,i.gT)(e);if(!t){return{operator:"any",subfilter:{operator:"is_empty"}}}if("rollup"===t.targetPropertySchema.type){return{operator:"any",subfilter:{operator:"is_empty"}}}if("formula"===t.targetPropertySchema.type){const e=f(t.targetPropertySchema);if((0,r.a_)(e))return e;return{operator:"any",subfilter:e}}if("button"===t.targetPropertySchema.type)return{operator:"is_empty"};return{operator:"any",subfilter:m(t.targetPropertySchema.type)}}}return m(a.type)}const h=(0,d.defineMessages)({date_is_within:{defaultMessage:"Is between",id:"collectionFilterMenuHelpers.operator.dateIsWithin"},date_is_relative_to:{defaultMessage:"Is relative to today",id:"collectionFilterMenuHelpers.operator.dateIsRelativeTo"},is_empty:{defaultMessage:"Is empty",id:"collectionFilterMenuHelpers.operator.isEmpty"},is_not_empty:{defaultMessage:"Is not empty",id:"collectionFilterMenuHelpers.operator.isNotEmpty"},string_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.stringIs"},string_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.stringIsNot"},string_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.stringContains"},string_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.stringDoesNotContain"},string_starts_with:{defaultMessage:"Starts with",id:"collectionFilterMenuHelpers.operator.stringStartsWith"},string_ends_with:{defaultMessage:"Ends with",id:"collectionFilterMenuHelpers.operator.stringEndsWith"},checkbox_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.checkboxIs"},checkbox_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.checkboxIsNot"},enum_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.enumIs"},enum_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.enumIsNot"},enum_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.enumContains"},enum_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.enumDoesNotContain"},status_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.statusIs"},status_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.statusIsNot"},person_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.personContains"},person_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.personDoesNotContain"},relation_contains:{defaultMessage:"Contains",id:"collectionFilterMenuHelpers.operator.relationContains"},relation_does_not_contain:{defaultMessage:"Does not contain",id:"collectionFilterMenuHelpers.operator.relationDoesNotContain"},location_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.locationIs"},location_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.locationIsNot"},number_equals:{defaultMessage:"=",id:"collectionFilterMenuHelpers.operator.numberEquals"},number_does_not_equal:{defaultMessage:"≠",id:"collectionFilterMenuHelpers.operator.numberDoesNotEqual"},number_greater_than:{defaultMessage:">",id:"collectionFilterMenuHelpers.operator.numberGreaterThan"},number_less_than:{defaultMessage:"<",id:"collectionFilterMenuHelpers.operator.numberLessThan"},number_greater_than_or_equal_to:{defaultMessage:"≥",id:"collectionFilterMenuHelpers.operator.numberGreaterThanOrEqualTo"},number_less_than_or_equal_to:{defaultMessage:"≤",id:"collectionFilterMenuHelpers.operator.numberLessThanOrEqualTo"},date_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.dateIs"},date_is_before:{defaultMessage:"Is before",id:"collectionFilterMenuHelpers.operator.dateIsBefore"},date_is_after:{defaultMessage:"Is after",id:"collectionFilterMenuHelpers.operator.dateIsAfter"},date_is_on_or_before:{defaultMessage:"Is on or before",id:"collectionFilterMenuHelpers.operator.dateIsOnOrBefore"},date_is_on_or_after:{defaultMessage:"Is on or after",id:"collectionFilterMenuHelpers.operator.dateIsOnOrAfter"},any:{defaultMessage:"Any",id:"collectionFilterMenuHelpers.operator.any"},none:{defaultMessage:"None",id:"collectionFilterMenuHelpers.operator.none"},every:{defaultMessage:"Every",id:"collectionFilterMenuHelpers.operator.every"},string_has_no_alphabet_prefix:{defaultMessage:"(Not used)",id:"collectionFilterMenuHelpers.operator.stringHasNoAlphabetPrefix"},verification_is:{defaultMessage:"Is",id:"collectionFilterMenuHelpers.operator.verificationStateIs"},verification_is_not:{defaultMessage:"Is not",id:"collectionFilterMenuHelpers.operator.verificationStateIsNot"}});function v(e){return u.default.formatMessage(h[e])}const b=(0,d.defineMessages)({today:{defaultMessage:"Today",id:"collectionFilterMenuHelpers.relativeDates.today"},tomorrow:{defaultMessage:"Tomorrow",id:"collectionFilterMenuHelpers.relativeDates.tomorrow"},yesterday:{defaultMessage:"Yesterday",id:"collectionFilterMenuHelpers.relativeDates.yesterday"},one_week_ago:{defaultMessage:"One week ago",id:"collectionFilterMenuHelpers.relativeDates.oneWeekAgo"},one_week_from_now:{defaultMessage:"One week from now",id:"collectionFilterMenuHelpers.relativeDates.oneWeekFromNow"},one_month_ago:{defaultMessage:"One month ago",id:"collectionFilterMenuHelpers.relativeDates.oneMonthAgo"},one_month_from_now:{defaultMessage:"One month from now",id:"collectionFilterMenuHelpers.relativeDates.oneMonthFromNow"}}),y=(0,d.defineMessages)({past:{defaultMessage:"Past",id:"collectionFilterMenuHelpers.relativeDates.past"},future:{defaultMessage:"Next",id:"collectionFilterMenuHelpers.relativeDates.next"}}),_=(0,d.defineMessages)({direction:{defaultMessage:"Direction",id:"collectionFilterMenuHelpers.relativeDates.direction"},unit:{defaultMessage:"Unit",id:"collectionFilterMenuHelpers.relativeDates.unit"}}),S=(0,d.defineMessages)({this:{defaultMessage:"This",id:"collectionFilterMenuHelpers.relativedates.this"}}),w=(0,d.defineMessages)({day:{defaultMessage:"day",id:"collectionFilterMenuHelpers.relativeDates.day"},week:{defaultMessage:"week",id:"collectionFilterMenuHelpers.relativeDates.week"},month:{defaultMessage:"month",id:"collectionFilterMenuHelpers.relativeDates.month"},year:{defaultMessage:"year",id:"collectionFilterMenuHelpers.relativeDates.year"}}),k=(0,d.defineMessages)({day:{defaultMessage:"days",id:"collectionFilterMenuHelpers.relativeDates.days"},week:{defaultMessage:"weeks",id:"collectionFilterMenuHelpers.relativeDates.weeks"},month:{defaultMessage:"months",id:"collectionFilterMenuHelpers.relativeDates.months"},year:{defaultMessage:"years",id:"collectionFilterMenuHelpers.relativeDates.years"}}),I=(0,d.defineMessages)({exactDate:{defaultMessage:"Custom date",id:"collectionFilterMenuHelpers.relativeDates.exactDate"},exactDateRange:{defaultMessage:"Exact dates",id:"collectionFilterMenuHelpers.relativeDates.exactDateRange"}});function C(e){return"exact"===e.type?u.default.formatMessage(I.exactDate):u.default.formatMessage(b[e.value])}const x=(0,d.defineMessages)({custom:{defaultMessage:"Relative range",id:"collectionFilterMenuHelpers.relativeDates.range"},surrounding:{defaultMessage:"Surrounding range",id:"collectionFilterMenuHelpers.relativeDates.customRange"},this_week:{defaultMessage:"This week",id:"collectionFilterMenuHelpers.relativeDates.thisWeek"},the_past_week:{defaultMessage:"The past week",id:"collectionFilterMenuHelpers.relativeDates.thePastWeek"},the_past_month:{defaultMessage:"The past month",id:"collectionFilterMenuHelpers.relativeDates.thePastMonth"},the_past_year:{defaultMessage:"The past year",id:"collectionFilterMenuHelpers.relativeDates.thePastYear"},the_next_week:{defaultMessage:"The next week",id:"collectionFilterMenuHelpers.relativeDates.theNextWeek"},the_next_month:{defaultMessage:"The next month",id:"collectionFilterMenuHelpers.relativeDates.theNextMonth"},the_next_year:{defaultMessage:"The next year",id:"collectionFilterMenuHelpers.relativeDates.theNextYear"}});function T(e){return"custom"===e.value?function(e){const t=u.default.formatMessage(y[e.direction]),n=1===e.count?u.default.formatMessage(w[e.unit]):u.default.formatMessage(k[e.unit]);return 1===e.count?`${t} ${n}`:`${t} ${e.count} ${n}`}(e):"surrounding"===e.value?function(e){const t=u.default.formatMessage(w[e.unit]);return`${u.default.formatMessage(S.this)} ${t}`}(e):"exact"===e.type?u.default.formatMessage(I.exactDateRange):"relative"===e.type?u.default.formatMessage(x[e.value]):void(0,l.t1)(e)}const M=(0,d.defineMessages)({start_date:{defaultMessage:"Start date",id:"collectionFilterMenuHelpers.dateFilterModes.start_date"},end_date:{defaultMessage:"End date",id:"collectionFilterMenuHelpers.dateFilterModes.end_date"}}),P=(0,d.defineMessages)({start_date:{defaultMessage:"For date ranges, filters on the start date. For individual dates, filters on the date.",id:"collectionFilterMenuHelpers.dateFilterModesTooltip.start_date"},end_date:{defaultMessage:"For date ranges, filters on the end date. For individual dates, filters on the date.",id:"collectionFilterMenuHelpers.dateFilterModesTooltip.end_date"}});function A(e){return u.default.formatMessage(M[e])}function R(e){return u.default.formatMessage(P[e])}const D=(0,d.defineMessages)({and:{defaultMessage:"And",id:"collectionFilterMenuHelpers.combinatorOperators.and"},or:{defaultMessage:"Or",id:"collectionFilterMenuHelpers.combinatorOperators.or"}}),E=(0,d.defineMessages)({checked:{defaultMessage:"Checked",id:"collectionFilterMenuHelpers.checkbox.checked"},unchecked:{defaultMessage:"Unchecked",id:"collectionFilterMenuHelpers.checkbox.unchecked"}});function B(e){return e.value?u.default.formatMessage(c.A3(e.value)):""}const F=e=>{let{filter:t,schema:n}=e;return j({filter:t.subfilter,schema:n})},O=e=>{let{filter:t}=e;return C(t.value)},Z=e=>{let{filter:t}=e;return T(t.value)},V=e=>{let{filter:t}=e;return`"${t.value.value||""}"`},U=e=>{let{filter:t}=e;return void 0===t.value.value?void 0:t.value.value.toString()},N=e=>{let{filter:t}=e;return function(e){const t=e.value?E.checked:E.unchecked;return u.default.formatMessage(t)}(t.value)},L={is_empty:()=>{},is_not_empty:()=>{},string_is:V,string_is_not:V,string_contains:V,string_does_not_contain:V,string_starts_with:V,string_ends_with:V,checkbox_is:N,checkbox_is_not:N,enum_is:V,enum_is_not:V,enum_contains:V,enum_does_not_contain:V,status_is:V,status_is_not:V,relation_contains:()=>{},relation_does_not_contain:()=>{},person_contains:()=>{},person_does_not_contain:()=>{},location_is:()=>{},location_is_not:()=>{},number_equals:U,number_does_not_equal:U,number_greater_than:U,number_less_than:U,number_greater_than_or_equal_to:U,number_less_than_or_equal_to:U,date_is:O,date_is_before:O,date_is_after:O,date_is_on_or_before:O,date_is_on_or_after:O,date_is_within:Z,date_is_relative_to:Z,any:F,none:F,every:F,string_has_no_alphabet_prefix:()=>{},verification_is:V,verification_is_not:V};function j(e){const{filter:t}=e,n=v(t.operator),o=L[t.operator](e);return s.oA([n,o]).join(" ")}function z(e){const{filter:t,schema:n}=e;if((0,r.vA)(t)){const e=t.filters||[],o=s.oA(e.map((e=>{const t=z({filter:e,schema:n});if(t)return(0,r.vA)(e)?`(${t})`:t}))),i=u.default.formatMessage(D[t.operator]);return o.join(` ${i} `)}if((0,r.aN)(t)){const e=n[t.property];if(!e)return;const o=t.filter,r=e.name,i=j({filter:o,schema:n});return s.oA([r,i]).join(" ")}}const q={text:function(e,t){return(0,r._N)(t)?{operator:t}:(0,r.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:"string_has_no_alphabet_prefix"===e.operator?{operator:t}:{operator:t,value:e.value}},number:function(e,t){return(0,r._N)(t)?{operator:t}:(0,r.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},checkbox:function(e,t){return{operator:t,value:e.value}},select:function(e,t){return(0,r._N)(t)?{operator:t}:(0,r.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},multi_select:function(e,t){return(0,r._N)(t)?{operator:t}:(0,r.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},status:function(e,t){return(0,r._N)(t)?{operator:t}:(0,r.mv)(e)?{operator:t,value:{type:"is_option",value:void 0}}:{operator:t,value:e.value}},relation:function(e,t){return(0,r._N)(t)?{operator:t}:(0,r.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},person:function(e,t){return(0,r._N)(t)?{operator:t}:(0,r.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value}},date:function(e,t,n){if((0,r._N)(t))return{operator:t};const o=(0,r.mv)(e)?void 0:e.use_end;return"date_is_within"===t?"date_is_within"!==e.operator?{operator:t,value:{type:"exact",value:void 0},use_end:o}:e:"date_is_relative_to"===t?"date_is_relative_to"!==e.operator?{operator:t,value:{type:"relative",value:"surrounding",unit:"week"},use_end:o}:e:(0,r.TQ)(e)?"combinator"===n?{operator:t,value:{type:"relative",value:"today"},use_end:o}:{operator:t,value:{type:"exact",value:void 0},use_end:o}:(0,r.mv)(e)?{operator:t,value:{type:"exact",value:void 0}}:{operator:t,value:e.value,use_end:o}},file:function(e,t){return{operator:t}},location:function(e,t){return{operator:t,value:e.value}},verification:function(e,t){return{operator:t,value:e.value}}};function H(e,t,n,o){return(0,q[e])(t,n,o)}const W=(0,d.defineMessages)({and:{defaultMessage:"And",id:"database.filterOperators.and"},or:{defaultMessage:"Or",id:"database.filterOperators.or"}}),K=(0,d.defineMessages)({and:{defaultMessage:"All filters must match",id:"database.filterOperators.andCaption"},or:{defaultMessage:"At least one filter must match",id:"database.filterOperators.orCaption"}});function G(e,t){return"and"===e?t.formatMessage(W.and):t.formatMessage(W.or)}function $(e,t){return"and"===e?t.formatMessage(K.and):t.formatMessage(K.or)}const Q=(0,d.defineMessages)({any:{defaultMessage:"Any",id:"database.filterOperators.any"},every:{defaultMessage:"Every",id:"database.filterOperators.every"},none:{defaultMessage:"None",id:"database.filterOperators.none"}});function Y(e,t){return"any"===e?t.formatMessage(Q.any):"every"===e?t.formatMessage(Q.every):t.formatMessage(Q.none)}const X=(0,d.defineMessages)({number:{id:"collectionFilterMenuFilter.filterOperators.number.order",defaultMessage:"{operator}{operatorValue}"},text:{id:"collectionFilterMenuFilter.filterOperators.text.order",defaultMessage:"{operator}{operatorValue}"},checkbox:{id:"collectionFilterMenuFilter.filterOperators.checkbox.order",defaultMessage:"{operator}{operatorValue}"},select:{id:"collectionFilterMenuFilter.filterOperators.select.order",defaultMessage:"{operator}{operatorValue}"},multi_select:{id:"collectionFilterMenuFilter.filterOperators.multi_select.order",defaultMessage:"{operator}{operatorValue}"},status:{id:"collectionFilterMenuFilter.filterOperators.status.order",defaultMessage:"{operator}{operatorValue}"},relation:{id:"collectionFilterMenuFilter.filterOperators.relation.order",defaultMessage:"{operator}{operatorValue}"},location:{id:"collectionFilterMenuFilter.filterOperators.location.order",defaultMessage:"{operator}{operatorValue}"},person:{id:"collectionFilterMenuFilter.filterOperators.person.order",defaultMessage:"{operator}{operatorValue}"},date:{id:"collectionFilterMenuFilter.filterOperators.date.order",defaultMessage:"{operator}{operatorValue}"},file:{id:"collectionFilterMenuFilter.filterOperators.file.order",defaultMessage:"{operator}{operatorValue}"},verification:{id:"collectionFilterMenuFilter.filterOperators.verification.order",defaultMessage:"{operator}{operatorValue}"}})},92918:(e,t,n)=>{n.d(t,{Cz:()=>x,F6:()=>D,II:()=>P,XD:()=>b,_1:()=>A,ar:()=>I,ej:()=>w,ew:()=>_,h6:()=>M,hJ:()=>R,kW:()=>y,nX:()=>S,nr:()=>k,qW:()=>C});n(57658);var o=n(92996),r=n(35011),i=n(14714),a=n(99036),s=n(97058),l=n(8848),c=n(38297),d=n(72126),u=n(97880),p=n(9291),m=n(77080),f=n(28020),g=n(65183),h=n(26991),v=n(29376);const b=10,y=10,_=50,S=(0,p.defineMessages)({unsupportedGroupAction:{id:"collectionGroupHelpers.unsupportedGroupAction",defaultMessage:"Selected group is not available for this task."}});function w(e){const{groupBy:t,schema:n,format:o,filter:r,groupsFormatKey:a,limit:s}=e,l=n[t.property];if(!l||!(0,i.LG)(l))return;const c=o[a]||[],d=c.reduce(((e,t)=>(0,i.eF)(t)?e+1:e),0);return{type:"groups",groupBy:t,filter:r,groupSortPreference:c.map((e=>e.value)),limit:s+d}}function k(e,t,n){const o=e.filter((e=>!(0,i.ZH)(e,t))),r=o.filter((e=>!(0,i.eF)(e))),a=o.filter((e=>(0,i.eF)(e)));return[...r.slice(0,n-1),t,...r.slice(n-1),...a]}function I(e,t){const n=e.filter((e=>!(0,i.ZH)(e,t))),o=n.filter((e=>!(0,i.eF)(e))),r=n.filter((e=>(0,i.eF)(e)));return[...o,t,...r]}function C(e){return!e.device.isPhone&&(e.isFullScreen||e.isRootChild)}function x(e){const{schema:t,groupBy:n,schemaGroups:a,reducerResults:l,relativeVariableResult:c,getRecordModel:u,viewAppConfigUri:p}=e;if(!n)return[];const m=t[n.property];if(!m||!(0,i.LG)(m))return[];const f=[...e.formatGroups,...a&&!l?a.map((e=>({property:n.property,value:e}))):[]];let h;if("manual"===(0,i.mu)(n).type){if(h=f,l)for(const{value:e}of l){const t={property:n.property,value:e};h.push(t)}p===o.sV&&(h=(0,s.gd)(h,e.formatGroups.map((e=>e.value))))}else{const e=new Map;for(const t of f)e.set((0,i.mD)(t),t);h=l?l.map((t=>{let{value:o}=t;return e.get((0,i.Hd)(o))||{property:n.property,value:o}})):[];for(const t of f)h.push(t)}if(l){if(n.hideEmptyGroups){const e=new Set,t=new Set;for(const n of l){const o=(0,i.Hd)(n.value);0===n.total?t.add(o):e.add(o)}h=h.map((n=>{const o=(0,i.mD)(n);if(t.has(o))return{...n,emptyHidden:!0};if(e.has(o)){const e={...n};return delete e.emptyHidden,e}return n}))}else h=h.map((e=>{if(e.emptyHidden){const t={...e};return delete t.emptyHidden,t}return e}));h=p===o.sV&&n.property===o.Es.TaskToSprintRelation?h.map((e=>"relation"===e.value.type&&(0,i.t2)(e.value.value)||void 0===e.value||void 0===e.value.value?e:{...e,hiddenByDefault:!0})):h.map((e=>{if(e.hiddenByDefault){const t={...e};return delete t.hiddenByDefault,t}return e}))}const v=h.filter((e=>{if(e.property!==n.property)return!1;const t=e.value;if(t.type!==m.type)return!1;if(void 0===t.value)return!(0,g.Dt)(m);if("formula"===m.type){const t=(0,r.mm)(m);if(!m.formula&&!m.formula2||"unknown"===t)return!1;if("formula"!==e.value.type||"formula"!==n.type)return!1;const o=e.value.value;if(!o)return!0;if("block"===t&&"text"===o.type)return!0;if(o.type!==t)return!1;const a=n.groupBy;return"relation"===a.type?function(e,t,n){if(!e||!e.value)return!0;if("relation"!==t.type||"relation"!==e.type)return!1;if((0,i.t2)(e.value))return!1;const o=n(e.value);return null==o?void 0:o.alive}(o,{...a,property:n.property},u):T({groupValue:o,groupBy:{property:n.property,...a},getRecordModel:u,relativeVariableResult:c})}return T({groupValue:t,groupBy:n,getRecordModel:u,relativeVariableResult:c,propertySchema:m})}));return d.mN(v,(e=>(0,i.mD)(e)))}function T(e){const{groupValue:t,groupBy:n,getRecordModel:o,relativeVariableResult:r,propertySchema:a}=e;if(!t.value)return!0;const s=n.type;if("formula"===s)return!1;if("select"===s){if("select"!==(null==a?void 0:a.type))return!1;return(a.options??[]).some((e=>e.value===t.value))}if("multi_select"===s){if("multi_select"!==(null==a?void 0:a.type))return!1;return(a.options??[]).some((e=>e.value===t.value))}if("status"===s){if("status"!==(null==a?void 0:a.type))return!1;const e=a.options??[],o=a.groups??[];if("status"!==t.type)return!1;const{value:r}=t;return"by_group"===r.type?("status"!==s||"group"===n.groupBy)&&o.some((e=>e.name===r.group)):"by_option"===r.type&&(("status"!==s||"option"===n.groupBy)&&e.some((e=>e.value===r.option)))}return(0,i.A1)(s)?function(e,t){if(!e||!e.value)return!0;if(!(0,i.ib)(t)||!(0,i.Mc)(e)||!t.groupBy)return!1;const n=e.value.type;if("relative"===t.groupBy)return"today"===n||"yesterday"===n||"last_7_days"===n||"last_30_days"===n||"tomorrow"===n||"next_7_days"===n||"next_30_days"===n||"month"===n;if("day"===t.groupBy)return"day"===n;if("week"===t.groupBy)return"week"===n;if("month"===t.groupBy)return"month"===n;if("year"===t.groupBy)return"year"===n;(0,u.t1)(t.groupBy)}(t,n):(0,i.HB)(s)?function(e,t){if(!e||!e.value)return!0;if(!(0,i.aB)(t)||!(0,i.R7)(e)||!t.groupBy)return!1;const n=e.value.type;if("alphabet_prefix"===t.groupBy)return"alphabet_prefix"===n||"other"===n;if("exact"===t.groupBy)return"exact"===n;(0,u.t1)(t.groupBy)}(t,n):"number"===s?function(e,t){if(!e||!e.value)return!0;if("number"!==t.type||"number"!==e.type)return!1;const n=e.value;if("out_of_range"===n.type)return n.start===t.start&&n.end===t.end;if("range"===n.type){const e=(0,i.n6)(n.start,t.start,t.end,t.size);return e&&"range"===e.type&&e.start===n.start}(0,u.t1)(n)}(t,n):"relation"===s?"relation"===(null==a?void 0:a.type)&&function(e,t,n,o,r){var a;if(!t||!t.value)return!0;if("relation"!==n.type||"relation"!==t.type)return!1;if((0,i.t2)(t.value)){var s,l;const n=e.collection_pointer&&o(e.collection_pointer);if(!r||!n)return!1;const i=null==n||null===(s=n.getFormat())||void 0===s?void 0:s.app_config_uri,a=null===(l=r[n.id])||void 0===l?void 0:l[t.value.value.variable],c=null==n?void 0:n.getSchema();return(0,h.Sh)(c,i)&&a}const d=o(t.value);if(!d)return!1;const u=(0,c.ky)({block:d,getRecordModel:o});if(r&&u){if((0,i.qQ)({relativeVariableValues:r[null==u?void 0:u.id],pointer:d.pointer}).length>0)return!1}return Boolean(d.alive&&((null==u?void 0:u.id)===e.collection_id||(null==u?void 0:u.id)===(null===(a=e.collection_pointer)||void 0===a?void 0:a.id)))}(a,t,n,o,r):"location"===s?function(e,t,n){if(!e||!e.value)return!0;if("location"!==t.type||"location"!==e.type)return!1;const o=n(e.value);return Boolean(o)}(t,n,o):!(!(0,i.pd)(s)&&"checkbox"!==s)||void(0,u.t1)(s)}function M(e,t){var n;const o=t.collectionViewStore(),r=null==o||null===(n=o.getFormat().board_columns_by)||void 0===n?void 0:n.disableBoardColorColumns;return void 0===r||r}function P(e){const{environment:t,groupFormat:n,schema:r,format:s,collectionContextStore:c,theme:d}=e,u=M(0,c);if(!s.collection_group_by&&u)return;const p=(0,f.YO)(c.isInPeekRenderer.state)?l.H:l.bw;if(n){const e=r[n.property];if(e&&!u){const t=n.value;if((0,a.cu)(e)){const n=(e.options||[]).find((e=>e.value===t.value));return p(d,null==n?void 0:n.color)}if("status"===e.type&&"status"===t.type){var m,g;let n;if("by_group"===(null===(m=t.value)||void 0===m?void 0:m.type)){var h;const o=t.value.group;n=null===(h=e.groups)||void 0===h||null===(h=h.find((e=>e.name===o)))||void 0===h?void 0:h.color}else if("by_option"===(null===(g=t.value)||void 0===g?void 0:g.type)){var b;const o=t.value.option;n=null===(b=e.options)||void 0===b||null===(b=b.find((e=>e.value===o)))||void 0===b?void 0:b.color}return p(d,n)}if("relation"===e.type&&"relation"===t.type&&(0,i.t2)(t.value)){const n=c.collectionStore();if(!n)return p(d,"default");const r=(0,v.gO)(e,n),i=(0,v.uJ)(e,n),a=null==r?void 0:r.getPropertyMapping(),s=null==a?void 0:a[o.b0.StatusV2],l=i&&s&&i[s];if(l&&"status"===l.type){var y;const e=t.value.value.variable,n=null===(y=l.options)||void 0===y||null===(y=y.find((t=>t.id===e)))||void 0===y?void 0:y.color;if(n)return p(d,n)}}}}return p(d,"default")}function A(e){return!("board"===e.viewType&&"board_columns_by"===e.groupByKey)}function R(){return m.default.checkGate("collection_groups_functional")}function D(e){const{stores:t,collectionContextStore:n}=e,o=n.collectionStoresStore.state.map((e=>e.id));return"collectionTypedView"===n.contextType?t.filter((e=>{const t=e.getAssociatedCollectionStore();return t&&o.includes(t.id)})):t}},65183:(e,t,n)=>{n.d(t,{yZ:()=>P,_W:()=>Q,dN:()=>Y,Sb:()=>$,_Y:()=>j,DL:()=>N,oy:()=>L,Km:()=>z,sN:()=>V,Bh:()=>O,aW:()=>U,r_:()=>X,TP:()=>G,k4:()=>J,to:()=>K,JI:()=>q,K8:()=>H,Dt:()=>ne,Rb:()=>B,Cg:()=>te,SO:()=>R,Tr:()=>D});var o=n(41432),r=n(99036),i=n(80951),a=n(35013),s=n(21321),l=n(69628),c=n(17948),d=(n(67294),n(45238)),u=n(85893);const p=(0,d.I)("collectionPieChart",{viewBox:"0 0 18 17",svg:(0,u.jsx)("path",{d:"M9 16.4297C4.58594 16.4297 0.929688 12.7812 0.929688 8.35938C0.929688 3.94531 4.57812 0.289062 8.99219 0.289062C13.4141 0.289062 17.0703 3.94531 17.0703 8.35938C17.0703 12.7812 13.4141 16.4297 9 16.4297ZM9 14.8438C10.5469 14.8438 11.9688 14.3047 13.0781 13.4062L8.59375 9.03125C8.44531 8.88281 8.38281 8.73438 8.38281 8.52344V1.90625C5.07812 2.21094 2.52344 4.96875 2.52344 8.35938C2.52344 11.9531 5.40625 14.8438 9 14.8438ZM9.625 7.57031L14.4375 4.8125C13.3828 3.21094 11.6484 2.10156 9.625 1.90625V7.57031ZM10.1406 8.71094L13.9922 12.5078C14.9219 11.3828 15.4844 9.9375 15.4844 8.35938C15.4844 7.49219 15.3125 6.67188 15.0078 5.92188L10.1406 8.71094Z"})});var m=n(42696),f=n(10405),g=n(72126),h=n(19889),v=n(3791),b=n(97880),y=n(9291),_=n(33929),S=n(80444),w=n(77080),k=n(83212),I=n(79797),C=n(88280),x=n(19124),T=n(37034),M=n(95697);const P=32,A=(0,y.defineMessages)({title:{defaultMessage:"Title",id:"database.propertyTypeName.title"},text:{defaultMessage:"Text",id:"database.propertyTypeName.text"},number:{defaultMessage:"Number",id:"database.propertyTypeName.number"},url:{defaultMessage:"URL",id:"database.propertyTypeName.url"},select:{defaultMessage:"Select",id:"database.propertyTypeName.select"},multi_select:{defaultMessage:"Multi-select",id:"database.propertyTypeName.multi_select"},status:{defaultMessage:"Status",id:"database.propertyTypeName.status"},person:{defaultMessage:"Person",id:"database.propertyTypeName.person"},email:{defaultMessage:"Email",id:"database.propertyTypeName.email"},phone_number:{defaultMessage:"Phone",id:"database.propertyTypeName.phone_number"},date:{defaultMessage:"Date",id:"database.propertyTypeName.date"},file:{defaultMessage:"Files & media",id:"database.propertyTypeName.file"},checkbox:{defaultMessage:"Checkbox",id:"database.propertyTypeName.checkbox"},formula:{defaultMessage:"Formula",id:"database.propertyTypeName.formula"},relation:{defaultMessage:"Relation",id:"database.propertyTypeName.relation"},rollup:{defaultMessage:"Rollup",id:"database.propertyTypeName.rollup"},created_time:{defaultMessage:"Created time",id:"database.propertyTypeName.created_time"},created_by:{defaultMessage:"Created by",id:"database.propertyTypeName.created_by"},last_edited_time:{defaultMessage:"Last edited time",id:"database.propertyTypeName.last_edited_time"},last_edited_by:{defaultMessage:"Last edited by",id:"database.propertyTypeName.last_edited_by"},last_visited_time:{defaultMessage:"Last visited time",id:"database.propertyTypeName.last_visited_time"},button:{defaultMessage:"Button",id:"database.propertyTypeName.button"},auto_increment_id:{defaultMessage:"ID",id:"database.propertyTypeName.auto_increment_id"},location:{defaultMessage:"Location",id:"database.propertyTypeName.location"},verification:{defaultMessage:"Verification",id:"database.propertyTypeName.verification"},ai_summary:{defaultMessage:"AI summary",id:"database.propertyTypeName.text.summarizeWithAi"},ai_custom_prompt:{defaultMessage:"AI custom autofill",id:"database.propertyTypeName.text.customPromptWithAI"},ai_extract:{defaultMessage:"AI key info",id:"database.propertyTypeName.text.extractInfoWithAI"},ai_translate:{defaultMessage:"AI translation",id:"database.propertyTypeName.text.translateWithAI"},ai_keywords:{defaultMessage:"AI keywords",id:"database.propertyTypeName.text.keywordsWithAI"}}),R={title:_.default.formatMessage(A.title),text:_.default.formatMessage(A.text),number:_.default.formatMessage(A.number),url:_.default.formatMessage(A.url),select:_.default.formatMessage(A.select),multi_select:_.default.formatMessage(A.multi_select),status:_.default.formatMessage(A.status),person:_.default.formatMessage(A.person),email:_.default.formatMessage(A.email),phone_number:_.default.formatMessage(A.phone_number),date:_.default.formatMessage(A.date),file:_.default.formatMessage(A.file),checkbox:_.default.formatMessage(A.checkbox),formula:_.default.formatMessage(A.formula),relation:_.default.formatMessage(A.relation),rollup:_.default.formatMessage(A.rollup),created_time:_.default.formatMessage(A.created_time),created_by:_.default.formatMessage(A.created_by),last_edited_time:_.default.formatMessage(A.last_edited_time),last_edited_by:_.default.formatMessage(A.last_edited_by),last_visited_time:_.default.formatMessage(A.last_visited_time),button:_.default.formatMessage(A.button),auto_increment_id:_.default.formatMessage(A.auto_increment_id),location:_.default.formatMessage(A.location),verification:_.default.formatMessage(A.verification),ai_summary:_.default.formatMessage(A.ai_summary),ai_custom_prompt:_.default.formatMessage(A.ai_custom_prompt),ai_extract:_.default.formatMessage(A.ai_extract),ai_translate:_.default.formatMessage(A.ai_translate),ai_keywords:_.default.formatMessage(A.ai_keywords)};(0,y.defineMessages)({text:{defaultMessage:"A single line of text.",id:"database.propertyTypeDescription.text"},number:{defaultMessage:"A number, with options to format as currency, percent, and more.",id:"database.propertyTypeDescription.number"},url:{defaultMessage:"A link to a page on the web.",id:"database.propertyTypeDescription.url"},select:{defaultMessage:"Select from a list of options.",id:"database.propertyTypeDescription.select"},multi_select:{defaultMessage:"Tag with values from a list of options.",id:"database.propertyTypeDescription.multi_select"},status:{defaultMessage:"Tag with a list of custom options with groups",id:"database.propertyTypeDescription.status"},person:{defaultMessage:"Reference a person on your team.",id:"database.propertyTypeDescription.person"},email:{defaultMessage:"Reference an email address.",id:"database.propertyTypeDescription.email"},phone_number:{defaultMessage:"Reference a phone number.",id:"database.propertyTypeDescription.phone_number"},date:{defaultMessage:"A date, with options to format and include time.",id:"database.propertyTypeDescription.date"},file:{defaultMessage:"Upload files and images.",id:"database.propertyTypeDescription.file"},checkbox:{defaultMessage:"Track status with a single checkbox.",id:"database.propertyTypeDescription.checkbox"},formula:{defaultMessage:"Compute a formula using other properties of a page.",id:"database.propertyTypeDescription.formula"},relation:{defaultMessage:"Allow pages in this database to reference pages in another.",id:"database.propertyTypeDescription.relation"},rollup:{defaultMessage:"Display and summarize data from a relation.",id:"database.propertyTypeDescription.rollup"},created_time:{defaultMessage:"Reference the date and time a page was created.",id:"database.propertyTypeDescription.created_time"},created_by:{defaultMessage:"Reference the person that created a page.",id:"database.propertyTypeDescription.created_by"},last_edited_time:{defaultMessage:"Reference the date and time a page was last edited.",id:"database.propertyTypeDescription.last_edited_time"},last_edited_by:{defaultMessage:"Reference the person that last edited a page.",id:"database.propertyTypeDescription.last_edited_by"},last_visited_time:{defaultMessage:"Reference the date and time a page was last visited by you.",id:"database.propertyTypeDescription.last_visited_time"},button:{defaultMessage:"A clickable button that can be configured to perform any action.",id:"database.propertyTypeDescription.button"},auto_increment_id:{defaultMessage:"An auto-increment ID.",id:"database.propertyTypeDescription.auto_increment_id"},location:{defaultMessage:"A location.",id:"database.propertyTypeDescription.location"},verification:{defaultMessage:"Verified status.",id:"database.propertyTypeDescription.verification"}});const D=["text","number","select","multi_select","status","date","person","file","checkbox","url","email","phone_number","formula","relation","rollup","created_time","created_by","last_edited_time","last_edited_by","button","auto_increment_id","verification"],E=["select","multi_select","status","person","date","created_time","created_by","last_edited_time","last_edited_by"],B=function(e){return E.includes(e.type)},F=(0,y.defineMessages)({tableDisplayName:{defaultMessage:"Table",id:"collectionHelpers.table.displayName"},boardDisplayName:{defaultMessage:"Board",id:"collectionHelpers.board.displayName"},calendarDisplayName:{defaultMessage:"Calendar",id:"collectionHelpers.calendar.displayName"},listDisplayName:{defaultMessage:"List",id:"collectionHelpers.list.displayName"},galleryDisplayName:{defaultMessage:"Gallery",id:"collectionHelpers.gallery.displayName"},timelineDisplayName:{defaultMessage:"Timeline",id:"collectionHelpers.timline.displayName"},pageDisplayName:{defaultMessage:"Page",id:"collectionHelpers.page.displayName"},chartDisplayName:{defaultMessage:"Chart",id:"collectionHelpers.chart.displayName"}}),O={table:_.default.formatMessage(F.tableDisplayName),board:_.default.formatMessage(F.boardDisplayName),calendar:_.default.formatMessage(F.calendarDisplayName),list:_.default.formatMessage(F.listDisplayName),gallery:_.default.formatMessage(F.galleryDisplayName),timeline:_.default.formatMessage(F.timelineDisplayName),page:_.default.formatMessage(F.pageDisplayName),chart:_.default.formatMessage(F.chartDisplayName)},Z=(0,y.defineMessages)({table:{defaultMessage:"Table with types to store and view any kind of structured data",id:"collectionHelpers.table.caption"},board:{defaultMessage:"Kanban board, great for project planning and bug tracking",id:"collectionHelpers.board.caption"},calendar:{defaultMessage:"Month view, for event planning and scheduling",id:"collectionHelpers.calendar.caption"},list:{defaultMessage:"A simplified page view, great for bookmarks and notes",id:"collectionHelpers.list.caption"},gallery:{defaultMessage:"Grid of cards, use for mood boards, index cards, and recipes",id:"collectionHelpers.gallery.caption"},timeline:{defaultMessage:"A timeline view, great for project scheduling and planning",id:"collectionHelpers.timeline.caption"},page:{defaultMessage:"A page view for organizing pages hierarchically, great for documents and wikis",id:"collectionHelpers.page.caption"},chart:{defaultMessage:"Visualize your data with various chart types",id:"collectionHelpers.chart.caption"}}),V={table:_.default.formatMessage(Z.table),board:_.default.formatMessage(Z.board),calendar:_.default.formatMessage(Z.calendar),list:_.default.formatMessage(Z.list),gallery:_.default.formatMessage(Z.gallery),timeline:_.default.formatMessage(Z.timeline),page:_.default.formatMessage(Z.page),chart:_.default.formatMessage(Z.chart)},U={table:m.t,board:a.i,calendar:s.N,list:c.O,gallery:l.n,timeline:f._,page:c.O,chart:p},N={table:void 0,board:"board_cover",calendar:void 0,list:void 0,gallery:"gallery_cover",timeline:void 0,page:void 0,chart:void 0},L={table:void 0,board:"board_cover_size",calendar:void 0,list:void 0,gallery:"gallery_cover_size",timeline:void 0,page:void 0,chart:void 0},j={table:void 0,board:"board_cover_aspect",calendar:void 0,list:void 0,gallery:"gallery_cover_aspect",timeline:void 0,page:void 0,chart:void 0},z={table:!0,board:!1,calendar:!1,list:!0,gallery:!0,timeline:!0,page:!1,chart:!0};function q(e){const t=e.getType(),n=e.getTitleStore();return t&&(0,o.dM)(t)&&n?n:e.getBlockTitleStore()}function H(e,t){let n=[];switch(t){case"gallery":e&&e.gallery_properties&&(n=e.gallery_properties);break;case"board":e&&e.board_properties&&(n=e.board_properties)}const o=n.find((e=>{let{property:t}=e;return"title"===t}));return!!o&&Boolean(o.visible)}const W=["text","number","select","multi_select","status","date","person","ai_summary","ai_extract","ai_custom_prompt","ai_translate","ai_keywords","file","checkbox","url","email","phone_number","formula","relation","rollup","created_time","created_by","last_edited_time","last_edited_by","button","auto_increment_id","location","verification"];function K(e){if((0,r.XU)(e))switch(e){case"ai_custom_prompt":case"ai_extract":case"ai_summary":case"ai_translate":case"ai_keywords":return"suggested";default:throw(0,b.t1)(e)}return"standard"}function G(e){let{isSyncedCollection:t,collectionContextStore:n,environment:o}=e;return W.filter((e=>{if((0,r.XU)(e)){const t=n.collectionStore();if(!t)return!1;const r=k.Z.getMode(o,t);return t.isTypedCollection()?"suggested"!==K(e)&&(0,x.mX)(o,r,t):(0,x.mX)(o,r,t)}return!!((0,M.QI)()&&"collectionTypedView"===n.contextType||"location"!==e)}))}function $(e){let{propertySchema:t,property:n,blockStores:o,collectionSchema:a}=e;return!(0===o.length||!(0,i.GL)(t))&&((0,r.iE)(t)?o.every((e=>Q(t,e,a))):!(0,r.ZY)(t.type)&&!(0,i.wl)(n))}function Q(e,t,n){const o=e.verifier_property;if(!o)return!1;const r=t.getPropertyValue(o),a=(0,i.DW)({textValue:r,propertySchema:n[o],blockCreatorPointer:t.getCreatedByPointer()}),s=S.default.state.currentUserRootStore;return!!s&&a.some((e=>e.id===s.id&&e.table===h.KJ))}function Y(e){let{targetCollectionStore:t,propertySchema:n,pointer:o}=e;if(!(Boolean(n.property)&&w.default.checkGate("collections_relation_picker_require_edit_perms")))return!0;return I.G.createChildStore(t,o).canEdit()}function X(e){const{collectionStore:t,environment:n,intl:o,queryForFilter:r}=e;if(""===r)return!0;return(0,T.vU)({environment:n,intl:o,store:t}).toUpperCase().includes(r.toUpperCase())}function J(){var e;const t=(null===(e=C.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.addOns)??[];return(0,v.de)(t)}function ee(e,t){for(const n of t)void 0===e[n]&&delete e[n]}function te(e){const t=g.Xh(e.loader);if(ee(t,["sort","reducerDependencies","searchQuery","upwardTraversalRelation","vectorSearch","filter"]),t.reducers)for(const n of Object.values(t.reducers))switch(n.type){case"results":ee(n,["filter","searchQuery","loadContentCover"]);break;case"groups":ee(n,["filter"]);break;case"aggregation":ee(n,["filter"]),void 0===n.aggregation.property&&ee(n.aggregation,["property"])}return{collectionView:e.collectionView,source:e.source,loader:t,aggregationStatus:e.aggregationStatus}}function ne(e){return"status"===e.type&&void 0!==e.defaultOption||"person"===e.type&&void 0!==e.default}},48543:(e,t,n)=>{n.d(t,{LQ:()=>u,Ls:()=>l,RI:()=>p,RO:()=>m});var o=n(17683),r=n(31490),i=n(32240),a=n(9291),s=n(33929);const l={table:"side_peek",board:"side_peek",calendar:"center_peek",list:"side_peek",gallery:"center_peek",timeline:"side_peek",page:"side_peek",chart:"side_peek"},c=(0,a.defineMessages)({side_peek:{defaultMessage:"Side peek",id:"database.viewPropertiesMenu.peekMode.sidePeek"},center_peek:{defaultMessage:"Center peek",id:"database.viewPropertiesMenu.peekMode.centerPeek"},full_page:{defaultMessage:"Full page",id:"database.viewPropertiesMenu.peekMode.fullPage"}}),d=(0,a.defineMessages)({side_peek:{defaultMessage:"Open pages on the side. Keeps the view behind interactive.",id:"database.viewPropertiesMenu.peekMode.description.sidePeek"},center_peek:{defaultMessage:"Open pages in a focused, centered modal.",id:"database.viewPropertiesMenu.peekMode.description.centerPeek"},full_page:{defaultMessage:"Open pages in full page.",id:"database.viewPropertiesMenu.peekMode.description.fullPage"}}),u=e=>{switch(e){case"side_peek":return s.default.formatMessage(c.side_peek);case"center_peek":return s.default.formatMessage(c.center_peek);case"full_page":return s.default.formatMessage(c.full_page)}},p=e=>{switch(e){case"side_peek":return s.default.formatMessage(d.side_peek);case"center_peek":return s.default.formatMessage(d.center_peek);case"full_page":return s.default.formatMessage(d.full_page)}},m=e=>{switch(e){case"side_peek":return i.y;case"center_peek":return o.Q;case"full_page":return r.M}}},65742:(e,t,n)=>{n.d(t,{AZ:()=>H,B8:()=>Z,BJ:()=>x,C1:()=>G,DS:()=>j,EW:()=>X,GK:()=>N,Ge:()=>k,Gz:()=>A,H5:()=>M,HZ:()=>Se,Ii:()=>ce,Ip:()=>q,Ne:()=>ue,PF:()=>L,Qw:()=>ge,S7:()=>b,ST:()=>E,TW:()=>F,Tp:()=>ie,Wk:()=>y,XO:()=>O,YE:()=>ve,YP:()=>le,Zn:()=>me,_Q:()=>ne,_e:()=>P,al:()=>V,bK:()=>U,bk:()=>B,cK:()=>z,d$:()=>K,e$:()=>R,fc:()=>te,fj:()=>$,i2:()=>S,lf:()=>_,lx:()=>I,pQ:()=>ae,pe:()=>de,ph:()=>be,px:()=>w,qG:()=>J,rr:()=>re,vX:()=>he,x2:()=>D,xI:()=>Q,xJ:()=>Y,xP:()=>oe,xd:()=>fe,y1:()=>pe,yk:()=>ee});var o=n(30120),r=n(13991),i=n(49085),a=n(30823),s=n(99036),l=n(80951),c=n(40506),d=n(7057),u=n(53877),p=n(6695),m=n(42875),f=n(15157),g=n(97880),h=n(77794),v=n(77181);const b=5,y=3,_=2,S=21;let w=function(e){return e[e.LeftResizer=0]="LeftResizer",e[e.RightResizer=1]="RightResizer",e[e.ItemDrag=2]="ItemDrag",e}({});const k=4e3,I=k/4,C=864e5,x={hours:{snapUnit:"fifteen_minutes",primaryDisplayUnit:"fifteen_minutes",secondaryDisplayUnit:"day",activeRangeType:void 0,msPerPixel:C/7e3,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"fifteen_minutes",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:9,getDateRangePlaceholderDuration:e=>e.plus({hour:1})},day:{snapUnit:"fifteen_minutes",primaryDisplayUnit:"hour",secondaryDisplayUnit:"day",activeRangeType:void 0,msPerPixel:69120,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"hour",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:2,getDateRangePlaceholderDuration:e=>e.plus({hour:3})},week:{snapUnit:"day",primaryDisplayUnit:"day",secondaryDisplayUnit:"month",activeRangeType:"highlight_days",msPerPixel:48e4,primaryDisplayUnitAlignment:"range_middle",verticalDividerUnit:"day",showWeekendIndicators:!0,hidePrimaryIndicatorIntersectionOffset:void 0,getDateRangePlaceholderDuration:e=>e.plus({day:1})},bi_week:{snapUnit:"day",primaryDisplayUnit:"day",secondaryDisplayUnit:"month",activeRangeType:"highlight_days",msPerPixel:108e4,primaryDisplayUnitAlignment:"range_middle",verticalDividerUnit:void 0,showWeekendIndicators:!0,hidePrimaryIndicatorIntersectionOffset:void 0,getDateRangePlaceholderDuration:e=>e.plus({day:3})},month:{snapUnit:"day",primaryDisplayUnit:"day",secondaryDisplayUnit:"month",activeRangeType:"highlight_days",msPerPixel:216e4,primaryDisplayUnitAlignment:"range_middle",verticalDividerUnit:void 0,showWeekendIndicators:!0,hidePrimaryIndicatorIntersectionOffset:void 0,getDateRangePlaceholderDuration:e=>e.plus({day:5})},quarter:{snapUnit:"day",primaryDisplayUnit:"week",secondaryDisplayUnit:"month",activeRangeType:"display_range",msPerPixel:72e5,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"month",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:35,getDateRangePlaceholderDuration:e=>e.plus({week:2})},year:{snapUnit:"day",primaryDisplayUnit:"week",secondaryDisplayUnit:"month",activeRangeType:"display_range",msPerPixel:C/5,primaryDisplayUnitAlignment:"range_start",verticalDividerUnit:"month",showWeekendIndicators:!1,hidePrimaryIndicatorIntersectionOffset:6,getDateRangePlaceholderDuration:e=>e.plus({week:4})}},T="month";function M(e){var t;return null===(t=P(e))||void 0===t?void 0:t.property}function P(e){const t=e.normalizedFormatStore.state.timeline_arrows_by;if(null==t||!t.property)return;const n=e.normalizedSchemaStore.state[t.property],o=e.collectionStore();return n&&"relation"===n.type&&n.property&&o&&(0,s.F0)(n)===o.id?{property:t.property,inverse:n.property}:void 0}function A(e){return{zoomLevel:i.default.createValue(T),currentRange:i.default.createValue({startTimestamp:0,endTimestamp:0}),dragState:i.default.createValue(void 0),drawState:i.default.createValue(void 0),hoveredItem:i.default.createValue(void 0),dateRangePlaceholder:i.default.createValue({active:!1}),scrollLeft:i.default.createValue(void 0),outerSizeObserver:new h.E,timelineSizeObserver:new h.E,horizontalScroller:void 0,savePreference:void 0,isFullScreen:e.isFullScreen,isRootChild:e.isRootChild,destroyed:!1}}function R(e,t){return t/x[e].msPerPixel}function D(e,t){return t*x[e].msPerPixel}function E(e){return"fifteen_minutes"===e||"hour"===e}function B(e){const{store:t,query:n,schema:o,userId:r,intl:i}=e,l=t.getModel();if(!l)return;const c=t.getAssociatedCollectionStore(),{timeline_by:d,timeline_by_end:p}=n;if(!d)return;const f=o[d];if(!f||!(0,s.Lt)(f))return;const g=(0,a.FT)({property:d,schema:o,block:l,getRecordModel:t.getRecordModel,propertyMapping:null==c?void 0:c.getPropertyMapping(),collectionRequestContext:{userId:r,userTimeZone:(0,m.r)(),depth:0,intl:i,visitedProperties:new Set,resultCache:new Map}}).next().value;if("date"!==(null==g?void 0:g.type))return;const h=g.value;if(!p||d===p)return h;{const e=o[p];if(!e||!(0,s.Lt)(e))return;const n=(0,a.FT)({property:p,schema:o,block:l,getRecordModel:t.getRecordModel,propertyMapping:null==c?void 0:c.getPropertyMapping(),collectionRequestContext:{userId:r,userTimeZone:(0,m.r)(),depth:0,intl:i,visitedProperties:new Set,resultCache:new Map}}).next().value;if(n&&"date"===n.type){const e=n.value,t=u.rH(h,e);if(t)return u.Qq(t)}}}function F(e){const{store:t,dateValue:n,query:o}=e,{timeline_by:r,timeline_by_end:i}=o;if(!r)return;const a=t.getAssociatedCollectionStore(),d=(null==a?void 0:a.getSchema())??e.schema,u=(null==a?void 0:a.getMappedProperty(r))??r,p=i?(null==a?void 0:a.getMappedProperty(i))??i:void 0,m=d[u];if(m&&(0,s.Lt)(m)){if(!p||u===p)return{[u]:(0,l.d7)(n)};{const e=d[u];if(!e||!(0,s.Lt)(e))return;const o=(0,l.Gl)(t.getPropertyValue(u)),r=(0,l.Gl)(t.getPropertyValue(p));if("date"===n.type)return{[u]:(0,l.d7)({type:"date",start_date:n.start_date,reminder:c.V3(o)}),[p]:(0,l.d7)({type:"date",start_date:n.start_date,reminder:c.V3(r)})};if("daterange"===n.type)return{[u]:(0,l.d7)({type:"date",start_date:n.start_date,reminder:c.V3(o)}),[p]:(0,l.d7)({type:"date",start_date:n.end_date,reminder:c.V3(r)})};if("datetime"===n.type)return{[u]:(0,l.d7)({type:"datetime",start_date:n.start_date,start_time:n.start_time,time_zone:n.time_zone,reminder:c._3(o)}),[p]:(0,l.d7)({type:"datetime",start_date:n.start_date,start_time:n.start_time,time_zone:n.time_zone,reminder:c._3(r)})};if("datetimerange"===n.type)return{[u]:(0,l.d7)({type:"datetime",start_date:n.start_date,start_time:n.start_time,time_zone:n.time_zone,reminder:c._3(o)}),[p]:(0,l.d7)({type:"datetime",start_date:n.end_date,start_time:n.end_time,time_zone:n.time_zone,reminder:c._3(r)})};(0,g.t1)(n)}}}function O(e,t){const n=E(t),o=u.NK(n?e:c.Dy(e),(0,m.r)()),r=j(o.start,t),i=n&&"date"===e.type?o.start.plus({days:1}).startOf("day"):o.end||r;return{start:r,end:n?j(i,t):q(i,t)}}function Z(e){return`timeline:${e}`}function V(e){const{horizontalScroller:t,outerSizeObserver:n}=e,o=e.zoomLevel.state,{startTimestamp:r}=e.currentRange.state;return r+D(o,(t?t.scrollLeft:0)+n.rect.state.width/2)}function U(e){const{environment:t,timestamp:n,timelineState:o,paddingLeft:r,format:i}=e;return n-D(o.zoomLevel.state,Q({environment:t,paddingLeft:r,format:i,isFullScreen:o.isFullScreen,isRootChild:o.isRootChild})/2)}function N(e){const{environment:t,timestamp:n,timelineState:o,paddingLeft:r,format:i}=e;return n-D(o.zoomLevel.state,Q({environment:t,paddingLeft:r,format:i,isFullScreen:o.isFullScreen,isRootChild:o.isRootChild})-o.outerSizeObserver.rect.state.width/2)}function L(e){const{timestamp:t,timelineState:n}=e;return t+D(n.zoomLevel.state,-n.outerSizeObserver.rect.state.width/2)}function j(e,t){if("fifteen_minutes"===t){const t=15*Math.floor(e.minute/15);return e.set({minute:t}).startOf("minute")}return e.startOf(t)}function z(e,t){if("fifteen_minutes"===t){const t=15*Math.floor(e.minute/15)-15;return e.set({minute:t}).startOf("minute")}return e.startOf(t).minus({[t]:1}).startOf(t)}function q(e,t){if("fifteen_minutes"===t){const t=15*Math.floor(e.minute/15)+15;return e.set({minute:t}).startOf("minute")}return e.plus({[t]:1}).startOf(t)}function H(e){const{startValue:t,snapUnit:n,desiredStart:o,desiredEnd:r}=e;let i=t;const a=c.Ze(t)||(0,m.r)();if(o){const e=W(o,n,"start",a);if("datetime"===e.type)if("date"===i.type){const e={type:"daterange",start_date:i.start_date,end_date:i.start_date};i=u.bD(e,(0,m.r)())}else"daterange"===i.type&&(i=u.bD(i,(0,m.r)()));"date"===i.type?i={...i,type:"daterange",start_date:e.start_date,end_date:i.start_date}:"daterange"===i.type?i={...i,type:"daterange",start_date:e.start_date,end_date:i.end_date}:"datetime"===i.type?i={...i,type:"datetimerange",start_date:e.start_date,start_time:"datetime"===e.type?e.start_time:i.start_time,end_date:i.start_date,end_time:i.start_time}:"datetimerange"===i.type&&(i={...i,type:"datetimerange",start_date:e.start_date,start_time:"datetime"===e.type?e.start_time:i.start_time})}if(r){const e=W(r,n,"end",a);if("datetime"===e.type)if("date"===i.type){const e={type:"daterange",start_date:i.start_date,end_date:i.start_date};i=u.bD(e,(0,m.r)())}else"daterange"===i.type&&(i=u.bD(i,(0,m.r)()));"date"===i.type||"daterange"===i.type?i={...i,type:"daterange",end_date:e.start_date}:"datetime"!==i.type&&"datetimerange"!==i.type||(i={...i,type:"datetimerange",end_date:e.start_date,end_time:"datetime"===e.type?e.start_time:"datetimerange"===i.type?i.end_time:i.start_time})}return c.qW(i)}function W(e,t,n,o){const r=z(e,t),i=j(e,t),a=q(e,t),s=E(t);let l;return l="start"===n?e.valueOf()>=i.valueOf()+(i.valueOf()-r.valueOf())/2?a:i:e.valueOf()>=i.valueOf()+(i.valueOf()-r.valueOf())/2?s?a:i:s?i:r,function(e,t,n){return E(t)?u.CQ(e.valueOf(),n):u.hT(e.valueOf(),n)}(l,t,o)}function K(e){const{environment:t,isFullScreen:n,isRootChild:o}=e;return(t.device.isDesktop||t.device.isTablet)&&(n||o)}function G(e){const{environment:t,format:n,isFullScreen:o,isRootChild:r}=e;return K({environment:t,isFullScreen:o,isRootChild:r})&&Boolean(n.timeline_show_table)}function $(e){const{isFullScreen:t,isRootChild:n}=e;return!t&&n&&G(e)}function Q(e){const{environment:t,paddingLeft:n,format:o,isFullScreen:r,isRootChild:i}=e;if(!G({environment:t,format:o,isFullScreen:r,isRootChild:i}))return 0;return n+(o.timeline_table_properties||[]).reduce(((e,t)=>(t.width&&t.visible?t.width:0)+e),0)}function Y(){const e=o.ou.now().setLocale(r.SP);return e.toLocaleString(o.ou.TIME_SIMPLE)===e.toLocaleString(o.ou.TIME_24_SIMPLE)}function X(e,t,n){return"day"===n?(0,d.Yx)(t,"month_day_long",e):"month"===n?(0,d.Yx)(t,"month_long",e):void(0,g.t1)(n)}function J(e,t){return"day"===t?(0,d.Yx)(e,"long",r.SP):"month"===t?(0,d.Yx)(e,"month_year_long",r.SP):void(0,g.t1)(t)}function ee(e,t){const n=u.NK(e,c.Ze(e)||(0,m.r)(),r.SP),{primaryDisplayUnit:o}=x[t],i="fifteen_minutes"===o||"hour"===o?"month_day_time":"month_day";return(0,d.Yx)(n.start.valueOf(),i,r.SP)}function te(e,t){const n=u.NK(e,c.Ze(e)||(0,m.r)(),r.SP),{primaryDisplayUnit:o}=x[t],i=(n.end||n.start).valueOf(),a="fifteen_minutes"===o||"hour"===o?"month_day_time":"month_day";return(0,d.Yx)(i,a,r.SP)}function ne(e,t){const n=u.NK(e,c.Ze(e)||(0,m.r)(),r.SP),{primaryDisplayUnit:o}=x[t],i="fifteen_minutes"===o||"hour"===o?"medium_with_time":"medium",a=(0,d.Yx)(n.start.valueOf(),i,r.SP);return n.end?`${a} → ${(0,d.Yx)(n.end.valueOf(),i,r.SP)}`:a}function oe(e,t){return j(e,t)<e?q(e,t):e}function re(e){return e.device.nativeScrollbarWidth>0||e.device.isFirefox||e.device.isPhone}function ie(e){return!(e.device.isFirefox||e.device.isMobile)}function ae(e,t){const n=t.currentUser.id,o=e.getFormat().timeline_preference,r=Z(e.id),i=f.Z.get({userId:n,key:r}),a={zoomLevel:T,centerTimestamp:Date.now()};return se(i)||se(o)||a}function se(e){if(e&&"number"==typeof e.centerTimestamp&&p.H.includes(e.zoomLevel))return e}function le(e,t){let n=e.timeline_table_properties||[];if(t){n.find((e=>{let{visible:t}=e;return Boolean(t)}))||(n=(0,p.Rt)(n,"title",!0))}return{timeline_show_table:t,timeline_table_properties:n}}function ce(e){const{environment:t,collectionContextStore:n,timelineState:o,isFullScreen:r,isRootChild:i}=e,a=o.zoomLevel.state,s=n.normalizedFormatStore.state,l=G({environment:t,format:s,isFullScreen:r,isRootChild:i}),c=l&&s.timeline_table_properties?s.timeline_table_properties.length:0,d=s.timeline_properties||[],u=d.filter((e=>"title"!==e.property));return{zoom_level:a,show_table:l,show_table_properties_count:c,show_timeline_title:d.length!==u.length,show_timeline_properties_count:u.length}}const de=33,ue=66,pe=22,me=33,fe=4,ge=96;function he(e){return e?de:ue}function ve(e,t,n){if(!t)return[];const o=M(e);if(!o)return[];const r=t.getPropertyValue(o),i=n[o];return r&&i&&"relation"===i.type?(0,l.j$)({relationValue:(0,l.rq)(r),propertySchema:i,getRecordModel:t.getRecordModel}):[]}function be(e,t,n){var o;if(!t)return[];const r=null===(o=(0,v.wf)(e))||void 0===o?void 0:o.property;if(!r)return[];const i=t.getPropertyValue(r),a=n[r];return i&&a&&"relation"===a.type?(0,l.j$)({relationValue:(0,l.rq)(i),propertySchema:a,getRecordModel:t.getRecordModel}):[]}const ye=2,_e=40;function Se(e){const{timelineState:t,placeholderDate:n,subitemPlaceholderDate:o}=e,r=o??e.dateValue;if(!r)return;const i=t.zoomLevel.state,{snapUnit:a}=x[i],{startTimestamp:s,endTimestamp:l}=t.currentRange.state,{start:c,end:d}=O(r,a),u=d.valueOf()>s&&c.valueOf()<l,p=R(i,c.valueOf()-s)+ye,m=o?Math.max(p+_e,0):Math.max(p,0),f=R(i,d.valueOf()-s)-ye,g=R(i,l-s),h=Math.min(f,g),v=h/R(i,l-s);return{visible:u,isPlaceholder:Boolean(n),isExistingSubitemPlaceholder:Boolean(o),left:m,right:h,maskPercent:v}}},77181:(e,t,n)=>{n.d(t,{A7:()=>A,Af:()=>E,Av:()=>k,CJ:()=>C,Cr:()=>Y,EK:()=>H,F0:()=>S,Hw:()=>_,JR:()=>U,Kg:()=>$,Ll:()=>j,Ns:()=>R,SM:()=>D,T2:()=>W,bX:()=>I,dI:()=>x,fd:()=>V,g0:()=>N,gY:()=>y,kC:()=>M,kG:()=>L,ko:()=>z,ls:()=>Q,nK:()=>K,qb:()=>G,uU:()=>O,vJ:()=>q,wI:()=>X,wf:()=>w,xb:()=>T,yU:()=>F,yr:()=>P,zV:()=>B});n(57658);var o=n(41432),r=n(76205),i=n(99036),a=n(80951),s=n(60246),l=n(42875),c=n(72126),d=n(95371),u=n(10906),p=n(58202),m=n(95802),f=n(77556),g=n(77080),h=n(79797),v=n(28020),b=n(33929);const y=4,_=24,S=10;function w(e){var t;const n=null===(t=e.collectionStore())||void 0===t?void 0:t.getFormat().subitem_property,o=e.collectionStore();if(!o||!o.getSchema()||!n)return;const r=o.getSchema()[n];if(!r||"relation"!==r.type||i.F0(r)!==o.id)return;const a=r.property;if(!a)return;const s=o.getSchema()[a];return s&&"relation"===s.type?{property:n,inverse:a}:void 0}function k(e){return"table"===e||"timeline"===e||"list"===e}function I(e){var t;const n=(0,u.fm)(e),o=null==n||null===(t=n.collectionViewStore())||void 0===t?void 0:t.getType();return Boolean((null==n?void 0:n.currentSubitemFormatStoreForUiDisplay.state)&&o&&k(o))}function C(e){const{store:t,subitemFormat:n,propertySchema:o}=e,r=t.getPropertyValue(n.property),i=(0,a.rq)(r),s=t.getRecordModel;return a.j$({relationValue:i,propertySchema:o,getRecordModel:s})}function x(e){const{store:t,subitemFormat:n,originAction:o}=e,r=t.getPropertyValue(n.property),i=(0,a.rq)(r),s=t.getRecordModel;return a.kc({relationValue:i,getRecordModel:s,originAction:o})}function T(e){const{store:t,subitemFormat:n,propertySchema:o}=e,r=t.getPropertyValue(n.inverse),i=(0,a.rq)(r),s=t.getRecordModel;return a.j$({relationValue:i,propertySchema:o,getRecordModel:s})}function M(e){const{store:t,collectionStore:n,collectionContextStore:o,subitemFormat:i,subitemPathKey:a,propertyFilters:s,combinatorFilter:c,currentUserId:d}=e,u=n.getSchema()[i.property];if(!u||"relation"!==u.type)return[];const p=C({store:t,subitemFormat:i,propertySchema:u});if(0===p.length)return[];let m=p.filter((e=>!a.includes(e.id))).map((e=>h.G.createChildStore(t,e)));const f=o.relativeVariableStore.state,g={schema:o.normalizedSchemaStore.state,userId:d,userTimeZone:(0,l.r)(),userStartOfWeek:v.AK.state,intl:b.default.getIntl(),relativeVariableResult:f},y=new Map;if(s&&s.length>0||c){const e=(0,r.q)({filter:{filters:c?[...s.filter((e=>!(0,r.Oo)(e.filter))).map((e=>e.filter)),c]:s.filter((e=>!(0,r.Oo)(e.filter))).map((e=>e.filter)),operator:"and"},propertyMapping:void 0,context:g});m=m.filter((t=>Z({blockStore:t,compiledFilter:e,subitemFormat:i,propertySchema:u,visitedIds:new Set,resultCache:y})))}return m}function P(e,t){var n,o;const r=e.currentSubitemFormatStoreForUiDisplay.state;if(!r)return new d.DG([]);const a=e.collectionStore();if(!a)return new d.DG([]);const u=e.currentSortsStore.state,p=a.getRecordModel,m=g.default.checkGate("better_database_text_sorts"),f=s.$m({userTimeZone:(0,l.r)(),intl:b.default.getIntl(),userSorts:u,userId:e.getCurrentUserId(),apiSorts:[],useImprovedSort:m}),h=e.normalizedSchemaStore.state[r.property],v=h&&"relation"===h.type&&i.F0(h)===(null===(n=e.collectionStore())||void 0===n?void 0:n.id)&&h.property,y=null===(o=e.collectionViewStore())||void 0===o?void 0:o.getType(),_=!v||y&&k(y)?void 0:{property:v,filter:{operator:"is_empty"}},S=[..._&&v?[{id:v,filter:_}]:[],...e.currentPropertyFiltersStore.state],w=e.currentCombinatorFilterStore.state,I=e.subitemExpandedStore.state,C=c.xH(e.groupsStore.getAllGroupStates().map((e=>e.resultsStore.state)));return new d.DG(C.map((n=>{const o=D(n);return(0,d.MW)(o,(n=>{let{store:o,pathKey:i}=n;const l=I.get(i);if(!l)return{value:{store:o,pathKey:i},children:[]};const d=function(e){const{store:t,collectionStore:n,collectionContextStore:o,subitemFormat:r,querySorts:i,limit:a,subitemPathKey:l,propertyFilters:d,combinatorFilter:u,currentUserId:p,getRecordModel:m}=e,f=M({store:t,collectionStore:n,collectionContextStore:o,subitemFormat:r,subitemPathKey:l,propertyFilters:d,combinatorFilter:u,currentUserId:p});if(!f)return[];const h=g.default.checkGate("better_database_text_sorts"),v=new s.EO([...i,...s.Xm(f.map((e=>e.id))??[])],h),b=new Map;f.forEach((e=>{v.updateBlock({block:e.getModel(),schema:n.getSchema(),propertyMapping:void 0,getRecordModel:m,resultCache:b})}));const y=f.map((e=>e.id))??[],_=s.Qx(y,v),S={};return _.forEach(((e,t)=>{S[e]=t})),c.MR(f,(e=>S[e.id])).slice(0,a)}({store:o,collectionStore:a,collectionContextStore:e,subitemFormat:r,querySorts:f,limit:l.limit,subitemPathKey:i,propertyFilters:S,combinatorFilter:w,currentUserId:t,getRecordModel:p}).map((e=>({store:e,pathKey:B(i,e)})));return{value:{store:o,pathKey:i},children:d}}))})))}function A(e,t){const n=e?[e]:[],o=t.groupsStore.getGroupState(n);if(!o)return[];const r=o.resultsStore.state;if(!t.currentSubitemFormatStoreForUiDisplay.state)return r;const i=[],a=t.subitemTreeStore.state;for(const s of a.children)F({results:i,tree:s});return i}function R(e){return(0,d.CY)(e.children[e.children.length-1])}function D(e){return{store:e,pathKey:E([e.pointer])}}function E(e){return e.map((e=>e.id)).join(",")}function B(e,t){return e?`${e},${t.id}`:t.id}function F(e){const{results:t,tree:n}=e;t.push(n.value.store);for(const o of n.children)F({results:t,tree:o})}function O(e){var t,n;const{block:o,collectionContextStore:r}=e,s=null==r||null===(t=r.currentSubitemFormatStoreForUiDisplay.state)||void 0===t?void 0:t.inverse;if(!s)return!1;const l=r.normalizedSchemaStore.state[s];if(!l||!(0,i.p_)(l))return!1;const c=null===(n=r.collectionViewBlockStore())||void 0===n?void 0:n.getRecordModel;if(!c)return!1;return(0,a.Ds)({block:o,propertySchema:l,getRecordModel:c}).length>0}function Z(e){const{blockStore:t,compiledFilter:n,subitemFormat:o,propertySchema:r,visitedIds:i,resultCache:a}=e;i.add(t.id);const s=t.getModel();if(!s)return!1;if(n({block:s,getRecordModel:t.getRecordModel,propertyMapping:void 0,resultCache:a}))return!0;const l=C({store:t,subitemFormat:o,propertySchema:r});return 0!==l.length&&l.map((e=>h.G.createChildStore(t,e))).filter((e=>!i.has(e.id))).some((e=>Z({blockStore:e,compiledFilter:n,subitemFormat:o,propertySchema:r,visitedIds:i,resultCache:a})))}async function V(e){const{blockStore:t,compiledFilter:n,subitemFormat:o,propertySchema:r,subitemExpandedStore:i,pathKey:s,forceStoresToLoad:l,visitedIds:c}=e;if(await t.load(),c.has(t.id))return;c.add(t.id);const d=l?await async function(e){const{store:t,subitemFormat:n,propertySchema:o}=e,r=t.getPropertyValue(n.property),i=(0,a.rq)(r);await Promise.all(i.map((e=>h.G.createChildStore(t,e).load())));const s=t.getRecordModel;return a.j$({relationValue:i,propertySchema:o,getRecordModel:s})}({store:t,subitemFormat:o,propertySchema:r}):C({store:t,subitemFormat:o,propertySchema:r});if(0===d.length)return;i.state.set(s,{isExpanded:!0,limit:20});const u=new Map;for(const a of d){const e=h.G.createChildStore(t,a),d=e.getModel();if(!d)continue;n({block:d,getRecordModel:e.getRecordModel,propertyMapping:void 0,resultCache:u})||await V({blockStore:e,compiledFilter:n,subitemFormat:o,propertySchema:r,subitemExpandedStore:i,pathKey:B(s,e),forceStoresToLoad:l,visitedIds:c})}}function U(e){if(!e.collectionStore())return;const t=e.currentSubitemFormatStoreForCollection.state,n=e.normalizedSchemaStore.state,o=(null==t?void 0:t.inverse)&&n[t.inverse],r=(null==t?void 0:t.property)&&n[t.property];if(!(r&&(0,i.p_)(r)&&o&&(0,i.p_)(o)))return;const a=o.property,s=r.property;return a&&s?{childRelationProperty:a,parentRelationProperty:s,childRelationSchema:o,parentRelationSchema:r,subitemFormat:t}:void 0}function N(e){const t=(0,u.fm)(e);if(t)return U(t)}function L(e,t){const n=j(e,t);if(n)return U(n)}function j(e,t){if(!e)return;if(!(e.isType(o.Ti.collectionViewPage)||e.isType(o.Ti.page)))return;const n=e.getAssociatedCollectionStore();if(!n)return;const r=new f.Z(t);return r.setContext({type:"collectionPage",collectionViewBlockStore:void 0,collectionStore:n}),r}function z(e){const t=e.getFormat().subitem_property;if(!t)return;const n=e.getSchema()[t];if(!n||"relation"!==n.type)return;const o=n.property;return o?{property:t,inverse:o}:void 0}function q(e,t){if(!e.isType("page"))return!1;if(!t)return!1;return!!t.collectionStore()&&Boolean(t.currentSubitemFormatStoreForCollection.state)}function H(e){var t,n;const{blockId:o,collectionContextStore:r}=e,i=null===(t=r.currentSubitemFormatStoreForCollection)||void 0===t?void 0:t.state,a=null==i?void 0:i.inverse;if(!i||!a)return!1;const s=e.blockStore??(null===(n=p.R.findBlockFromId(o))||void 0===n?void 0:n.getBlockStore());if(!s)return!1;const l=s.getSchema();if(!l)return!1;const c=l[a];return!(!c||"relation"!==c.type)&&T({store:s,subitemFormat:i,propertySchema:c}).length>0}function W(e){let{blocks:t,parentRelationProperty:n,parentRelationSchema:o,collectionViewBlockStore:r}=e;const i=new Set;for(const a of t)i.add(a.id);return c.xH(t.map((e=>{const t=(e=>{const t=e.getPropertyValue(n);return a.j$({relationValue:a.rq(t),propertySchema:o,getRecordModel:e.getRecordModel})})(e),s=t.map((e=>e.id));if(0===t.length)return[h.G.createChildStore(r,e.pointer)];return m.C.findAllSelectablesFromIds(s.filter((e=>!i.has(e)))).map((e=>e.props.store)).map((t=>h.G.createChildStore(t,e.pointer)))})))}function K(e,t){const n=e.subitemTreeStore,o=(0,d.DY)(n.state.children,(e=>e.value.store===t)),r=o?E(o.map((e=>e.value.store))):"";return e.subitemExpandedStore.state.get(r)}function G(e,t){const n=$(e,t);return e.filter(((e,t)=>n.includes(t)))}function $(e,t){const n=new Set;e.forEach((e=>{n.add(e.pointer.id)}));const o=[];return e.forEach(((e,r)=>{const i=e.getPropertyValue(t.inverse);a.rq(i).some((e=>n.has(e.id)))||o.push(r)})),o}function Q(e){var t;let{collectionContextStore:n}=e;return w(n)&&g.default.checkGate("collection_subitem_new_show_hide_options")&&"flattened"===(null===(t=n.collectionViewStore())||void 0===t?void 0:t.getFormat().subitem_display_mode)}function Y(e){let{collectionContextStore:t,blockId:n,blockStore:o}=e;return Q({collectionContextStore:t})&&H({blockId:n,collectionContextStore:t,blockStore:o})}function X(e){let{collectionContextStore:t,blockStore:n}=e;return function(e){var t;let{collectionContextStore:n}=e;return w(n)&&g.default.checkGate("collection_subitem_new_show_hide_options")&&"hidden"===(null===(t=n.collectionViewStore())||void 0===t?void 0:t.getFormat().subitem_display_mode)}({collectionContextStore:t})&&function(e){var t;const{collectionContextStore:n,blockStore:o}=e,r=null===(t=n.currentSubitemFormatStoreForCollection)||void 0===t?void 0:t.state,i=null==r?void 0:r.property;if(!r||!i)return!1;const a=o.getSchema();if(!a)return!1;const s=a[i];return!(!s||"relation"!==s.type)&&C({store:o,subitemFormat:r,propertySchema:s}).length>0}({collectionContextStore:t,blockStore:n})}},43224:(e,t,n)=>{n.d(t,{F6:()=>r,aB:()=>a,pT:()=>i});var o=n(9291);const r={maxWidth:280,width:"max-content",overflowWrap:"break-word",textWrap:"wrap",whiteSpace:"pre-line"},i=280,a=(0,o.defineMessages)({addPropertyDescriptionTooltip:{id:"database.viewSettings.propertyTab.description.addDescriptionTooltip",defaultMessage:"Add property description"},editPropertyDescriptionTooltip:{id:"database.viewSettings.propertyTab.description.editDescriptionTooltip",defaultMessage:"Edit property description"}})},26991:(e,t,n)=>{n.d(t,{As:()=>p,Sh:()=>u,iL:()=>m,ki:()=>g,qf:()=>f});var o=n(76205),r=n(30823),i=n(99036),a=n(96367),s=n(21202),l=n(6287),c=n(79797),d=n(29376);function u(e,t){return(0,a.oN)(e,t)}function p(e,t,n,o){const r=e.relativeVariableStore.state;if(r){const e=r[n.id],i=null==e?void 0:e[t];if(i){return c.G.createChildStore(o,{table:s.iU,id:i,spaceId:n.spaceId})}}}function m(e){var t;const{blockStore:n,collectionId:i,appConfigUri:s,variable:l,schema:c}=e;if((null===(t=n.getAssociatedCollectionStore())||void 0===t?void 0:t.id)!==i)return!1;const d=a.qB[s][l].reducer,u=d.getProperty(),p=c[u],m=n.getPropertyValue(u),f=d.getPropertyFilter(c,l);return!!(0,o.CA)({filter:f,filterType:"status",relativeVariableValues:void 0})((0,r.yK)({propertySchema:p,propertyValue:m}))}function f(e,t){if((0,o.e)(e.filter)){if(((0,o.vR)(e.filter)?(0,o.YO)(e.filter):[]).some((e=>"relative"===e.type)))return function(e,t){const n=t.getSchema()[e];return!(!n||!(0,i.p_)(n))&&(0,a.oN)((0,d.uJ)(n,t),(0,d.ke)(n,t))}(e.property,t)}return!0}function g(e,t,n){return!!e&&Object.values(e).some((e=>{if("groups"===e.type&&"relation"===e.groupBy.type){const o=e.groupBy.property,r=t[o];if(r.collection_pointer){const e=c.NW.createChildStore(n,{table:l.v,id:r.collection_pointer.id}),t=e.getFormat().app_config_uri;return t&&a.qB[t]&&e.isDefined()&&(0,a.oN)(e.getSchema(),t)}}return!1}))}},78175:(e,t,n)=>{n.d(t,{Po:()=>l,hF:()=>a,zE:()=>s});var o=n(10906),r=(n(95477),n(77080)),i=n(88923);function a(e){let t=e;for(;t&&(!t||!t.isNavigableBlock());){if("column"===t.getType())return!0;t=t.getParentBlockStore()}return!1}function s(e,t){const{device:n}=t;if(n.isPhone)return!1;if((0,o.en)(e)){return i.default.getSidePeekWidth(t.WindowSizeStore.state.width)>=i.sidePeekNoColumnWidth}return!0}function l(e,t){return!t.device.isMobile&&("on"===r.default.getGroup("columns-full-width")&&(e.isType("column_list")&&e.isChildOfRecordStoreUIRoot()&&s(e,t)&&!(null!==(n=e.getParentBlockStore())&&void 0!==n&&n.isFullWidth())&&!(0,o.en)(e)));var n}},78663:(e,t,n)=>{n.d(t,{$W:()=>m,FD:()=>g,Fu:()=>h,Xc:()=>f});var o=n(72126),r=n(97880),i=n(57819),a=n(30793),s=n(28685),l=n(79797),c=n(27724),d=n(24666),u=n(33929),p=n(73959);function m(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:u.default.getIntl();if("helpMeEdit"===e.key||"helpMeDraft"===e.key||"helpMeWrite"===e.key){var n;const o=null===(n=e.steps)||void 0===n?void 0:n[0],r="text"===(null==o?void 0:o.type)&&o.prefilledValue;return r?t.formatMessage({id:"completionPopup.prefilledValue",defaultMessage:"Write about {prefilledValue} "},{prefilledValue:r}):""}if(!(0,a.TE)(e.key))return"";switch(e.key){case"brainstormIdeas":return t.formatMessage({id:"completionPopup.brainStorm.prefilledValue",defaultMessage:"Brainstorm ideas on "});case"blogPost":return t.formatMessage({id:"completionPopup.blogPost.prefilledValue",defaultMessage:"Write a blog post about "});case"outline":return t.formatMessage({id:"completionPopup.outline.prefilledValue",defaultMessage:"Write an outline about "});case"socialMediaPost":return t.formatMessage({id:"completionPopup.socialMediaPost.prefilledValue",defaultMessage:"Write a social media post about "});case"pressRelease":return t.formatMessage({id:"completionPopup.pressRelease.prefilledValue",defaultMessage:"Write a press release about "});case"creativeStory":return t.formatMessage({id:"completionPopup.creativeStory.prefilledValue",defaultMessage:"Write a creative story about "});case"essay":return t.formatMessage({id:"completionPopup.essay.prefilledValue",defaultMessage:"Write an essay about "});case"poem":return t.formatMessage({id:"completionPopup.poem.prefilledValue",defaultMessage:"Write a poem about "});case"todoList":return t.formatMessage({id:"completionPopup.todoList.prefilledValue",defaultMessage:"Write a todo list about "});case"meetingAgenda":return t.formatMessage({id:"completionPopup.meetingAgenda.prefilledValue",defaultMessage:"Write a meeting agenda about "});case"prosConsList":return t.formatMessage({id:"completionPopup.prosConsList.prefilledValue",defaultMessage:"Write a pros and cons list about "});case"jobDescription":return t.formatMessage({id:"completionPopup.jobDescription.prefilledValue",defaultMessage:"Write a job description about "});case"salesEmail":return t.formatMessage({id:"completionPopup.salesEmail.prefilledValue",defaultMessage:"Write a sales email about "});case"recruitingEmail":return t.formatMessage({id:"completionPopup.recruitingEmail.prefilledValue",defaultMessage:"Write a recruiting email about "});default:(0,r.t1)(e.key)}}function f(){const{stores:e}=c.default.state,t=e[0],n=o.Z$(e),r=t?t.getRecordStoreUIRoot():void 0;if(r&&r instanceof l.G&&n){return{type:"blockSelection",stores:e,currentPage:r,origin:n,scrollerStore:(0,i.Dj)(r)}}}function g(){const e=d.default.state;if("editing"!==e.mode)return;const t=e.multiSelection,n=t.start.store,o=n.getRecordStoreUIRoot(),r=s.E.findNodeFromStore(n),a=(0,p.sQ)(n),c=null==a?void 0:a.getRecordStoreUIParent(),u=(0,i.Dj)(o),m=a&&a instanceof l.G&&a!==o?a:void 0,f=m??r;if(!(o&&o instanceof l.G&&f))return;return{type:"cursor",textSelection:t,currentPage:o,currentBlock:m,origin:f,currentParent:c,scrollerStore:u,isPageTitle:o.id===n.id}}function h(){const{stores:e}=c.default.state,t=d.default.state,n="empty"!==t.mode?t.multiSelection:void 0,o="empty"!==t.mode?t.multiSelection.start.store:void 0,r=o?o.getRecordStoreUIRoot():void 0;if(n&&r&&r instanceof l.G){const t=(0,p.sQ)(n.end.store),o=null==t?void 0:t.getRecordStoreUIParent(),a=(0,i.Dj)(r);if(t&&o){return{type:"textSelection",stores:e,textSelection:n,currentPage:r,origin:t,endBlock:t,endBlockParent:o,scrollerStore:a}}}}},43455:(e,t,n)=>{n.d(t,{$A:()=>_,Ie:()=>C,KF:()=>b,N9:()=>I});n(57658);var o=n(40591),r=n.n(o),i=n(41432),a=n(19531),s=n(22808),l=n(25718),c=n(19889),d=n(70203),u=n(7928),p=n(33929),m=n(83089);const f=!1;function g(){if(f){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log("completionMarkdownHelpers:",...t)}}function h(e,t){return(0,u.Nz)(e,t).replace(/ /g,"")}const v=(e,t)=>{const{getRecordValue:n,intl:o}=t;let r;if(d.IWo(e)){const t=d.zEN(e);r=`@${h(o,n({table:c.KJ,id:t}))}`}else if(d.fpG(e)){r=d.zyO(e).start_date}return r&&g(`Transforming annotation for completion: ${r}`),r};function b(){let e=0,t=0;function n(n){e+=1,e>t&&(t=e);try{return l.Lk(n)}finally{e-=1}}function o(){return":".repeat(t-e+2)}return{transformAnnotation:v,transformBlockMapping:{callout(e){var t;const{block:r,exportArgs:i}=e,a=l.WB({block:r,exportArgs:i}),c=null===(t=r.format)||void 0===t?void 0:t.page_icon,d=(0,s.Z)(c)?c:"",u=n(e),p=o();return{text:`${p} aside ${d}\n\n${a}`.trim(),breakLines:!0,children:u,suffix:p}},toggle(e){const{block:t,exportArgs:r}=e,i=l.WB({block:t,exportArgs:r}),a=n(e),s=o();return{text:`${s} ▶ ${i}\n\n`.trim(),breakLines:!0,children:a,suffix:s}}}}}const y=(0,m.V9)({unicode:()=>/@\p{Letter}+/gu,fallback:/@[A-Za-z]+/g});async function _(e,t,n){const o=e.matchAll(y),r=[];for(const i of o){const e=i[0].slice(1);if(void 0===n.get(e)){const o=async()=>{const o=await S(t,e);o?(g(`Found user result for mention "${e}": ${o.email}`),n.set(e,o)):(g(`Found no user result for mention "${e}".`),n.set(e,null))};r.push(o())}}await Promise.all(r)}async function S(e,t){const n=await e(t),o=p.default.getIntl();let r;for(const i of n){if(h(o,i)===t){if(r)return;r=i}}return r}function w(e){const{md:t,name:n,regex:o,createTokens:r}=e,{arrayReplaceAt:i}=t.utils;function a(e,t,i){let a=0;const s=[];if(e.replace(o,(function(o){const l=Array.from(arguments);let c=l.length-1;"string"!=typeof l[c]&&(c-=1);const d=l[c],u=l[c-1];if(u>0&&(0,m.D_)(d[u-1]))return"";if(u+o.length<d.length&&(0,m.D_)(d[u+o.length]))return"";const p=r(o,t);if(!p)return"";if(u>a){const t=new i("text","",0);t.content=e.slice(a,u),s.push(t)}for(const{type:e,attrs:t,tag:r,level:a,content:m}of p){const o=new i(e,"",0);if(t)for(const[e,n]of Object.entries(t))o.attrPush([e,n]);r&&(o.tag=r,o.markup=n),void 0!==a&&(o.level=a),m&&(o.content=m),s.push(o)}return a=u+o.length,""})),a<e.length){const t=new i("text","",0);t.content=e.slice(a),s.push(t)}return s}t.core.ruler.after("linkify",n,(e=>{let t=0;const n=e.tokens;for(let r=0;r<n.length;r++){const s=n[r].children;if("inline"===n[r].type&&s)for(let l=s.length-1;l>=0;l--){const c=s[l];"link_open"!==c.type&&"link_close"!==c.type||"auto"===c.info&&(t-=c.nesting),"text"===c.type&&0===t&&o.test(c.content)&&(n[r].children=i(s,l,a(c.content,c.level,e.Token)))}}return!0}))}function k(e){return t=>{!function(e){w({md:e,name:"date_mentions",regex:/20\d\d-\d\d-\d\d/g,createTokens:(e,t)=>[{type:"date_mention_open",tag:"time",attrs:{datetime:e,[a.KD.dateFormat]:"relative"},level:t+1},{type:"text",content:e},{type:"date_mention_close",tag:"/time",level:t}]})}(t),function(e,t){w({md:e,name:"user_mentions",regex:y,createTokens(e,n){const o=e.slice(1),r=t.get(o);if(r)return[{type:"user_mention_open",tag:"a",level:n+1,attrs:{[a.KD[d.GKr.User]]:r.id}},{type:"text",content:e},{type:"user_mention_close",tag:"/a",level:n}]}})}(t,e),function(e){const t=/^aside\s+(.*)$/,n={validate:e=>Boolean(e.trim().match(t)),render(n,o){if(1===n[o].nesting){const r=n[o].info.trim().match(t);let l=(null==r?void 0:r[1])??"";(0,s.Z)(l)||(l="");const c="gray_background",d=function(e,t){const n=[];for(const[o,r]of t)n.push(`${o}="${e.utils.escapeHtml(r)}"`);return n.join(" ")}(e,[[a.KD[i.Ti.callout],""],[a.KD.calloutBackground,c],[a.KD.calloutIcon,l]]);return`<div ${d}>`}return"</div>"}};e.use(r(),"callout_block",n)}(t),function(e){const t=/^▶\s+(.*)$/,n={validate:e=>Boolean(e.trim().match(t)),render(n,o){if(1===n[o].nesting){const r=n[o].info.trim().match(t),i=(null==r?void 0:r[1])??"";return`<details><summary>${e.utils.escapeHtml(i)}</summary>`}return"</details>"}};e.use(r(),"toggle_block",n)}(t)}}function I(e){return{plugin:k(e)}}function C(e){return/\[.+\]\([^)]*$/.test(e)}},19124:(e,t,n)=>{n.d(t,{AC:()=>R,G9:()=>S,GD:()=>I,Gw:()=>D,It:()=>b,KZ:()=>M,RT:()=>x,Zt:()=>C,eL:()=>y,kL:()=>P,mX:()=>A,q:()=>T,qB:()=>_,z1:()=>w});var o=n(94568),r=n(38823),i=n(8848),a=n(52897),s=n(12970),l=n(91856),c=n(11751),d=n(72126),u=n(9291),p=(n(95477),n(80444)),m=n(21273),f=n(77080),g=n(83212),h=n(48779);const v=(0,u.defineMessages)({helpMeWrite:{defaultMessage:"Ask AI to write...",id:"id.completions.helpMeWrite"},helpMeWritePlaceholder:{defaultMessage:'What would you like to write about?\nFor example, "5 reasons why we should hire a dedicated designer"',id:"id.completions.helpMeWritePlaceholder"},helpMeDraftPlaceholder:{defaultMessage:'What would you like to write about?\nFor example, "article about the benefits of learning a new language"',id:"id.completions.helpMeDraftPlaceholder"},summarize:{defaultMessage:"Summarize",id:"id.completions.summarize"},findActionItems:{defaultMessage:"Find action items",id:"id.completions.findActionItems"},summarizeMeetingTranscript:{id:"id.completions.summarizeMeetingTranscript",defaultMessage:"Summarize meeting"}}),b={key:"helpMeWrite",category:"writeWithAI",name:v.helpMeWrite,svg:c.t,svgFill:i.FN.light.purple[400],requiresContent:!0,steps:[{key:"prompt",name:v.helpMeWritePlaceholder,placeholder:v.helpMeWritePlaceholder,type:"text"}]},y={key:"helpMeDraft",category:"draftWithAI",name:v.helpMeWrite,svg:c.t,svgFill:i.FN.light.purple[400],requiresNoContent:!0,steps:[{key:"prompt",name:v.helpMeDraftPlaceholder,placeholder:v.helpMeDraftPlaceholder,type:"text"}]};function _(e){const{customPrompt:t,isPageEmpty:n}=e;return{key:n?"helpMeDraft":"helpMeWrite",category:"writeWithAI",name:v.helpMeWrite,svg:a.d,svgFill:i.FN.light.purple[400],steps:[{key:"prompt",name:v.helpMeWritePlaceholder,placeholder:v.helpMeWritePlaceholder,type:"text",prefilledValue:t}]}}function S(){return[{key:"summarize",category:"extractFromContent",name:v.summarize,svg:l.Y,svgFill:i.FN.light.purple[400]},{key:"findActionItems",category:"extractFromContent",name:v.findActionItems,svg:s.O,svgFill:i.FN.light.purple[400]},b]}function w(){return d.KX(S(),"key")}function k(){const e=p.default.state.currentSpaceStore;return!!e&&e.isAiEnabledOnSpace()}function I(e){if(f.default.checkGate("disable_ai_big_red_button"))return!1;const t=p.default.state.currentSpaceStore;if((0,h.Cx)(t))return!1;const n=null==t?void 0:t.canRead();return!(e&&e.hasPublicPermission&&!n)&&k()}function C(e){return k()}function x(e,t){return I(e)&&t.canEdit()}function T(){return f.default.checkGate("autotag_ambient_trigger")&&f.default.checkGate("autotag_ambient_trigger_space")}function M(){return f.default.checkGate("autofill_tags")}function P(){return I(void 0)&&f.default.checkGate("enable_ai_suggested_properties")}function A(e,t,n){return I(t)&&n.canEditCollection()}function R(e){m.Z.setState(new r.m({getEligibleGroup:e=>f.default.getEligibleGroup({experimentId:e}),isAiEnabled:()=>{const t=p.default.state.mainEditorCurrentBlockStore;return I(t&&g.Z.getMode(e,t))},getIsWorkspaceVectorEmbeddingsComplete:()=>{var e;return(null===(e=p.default.state.currentSpaceStore)||void 0===e||null===(e=e.getSettings())||void 0===e?void 0:e.embedding_index_is_live)??!1},checkGate:e=>f.default.checkGate(e)}))}function D(){var e;return(null===(e=p.default.state.currentSpaceStore)||void 0===e?void 0:e.id)===o.vj}},72340:(e,t,n)=>{n.d(t,{$6:()=>a,CN:()=>r,SL:()=>s,Tc:()=>i});var o=n(77080);const r=5;function i(e){return"on"===o.default.getEligibleGroup({experimentId:"parallel_confluence_importer_via_api",defaultGroup:"control"})}function a(e){return o.default.getEligibleGroup({experimentId:"special_case_confluence_file_size",defaultGroup:r.toString()})}function s(e){return"on"===o.default.getEligibleGroup({experimentId:"migrate_confluence_into_teamspace",defaultGroup:"control"})}},53323:(e,t,n)=>{n.d(t,{L:()=>s,n:()=>l});var o=n(63143),r=n(88632),i=n(99757);const a=1*o.hM;function s(){var e;if(r.Z.state.online){if(null!==(e=i.Z.state.connectionError)&&void 0!==e&&e.startTime){var t;if(Date.now()-(null===(t=i.Z.state.connectionError)||void 0===t?void 0:t.startTime)<a)return}return i.Z.state.connectionError}}function l(){return Boolean(s())}},46150:(e,t,n)=>{n.d(t,{C7:()=>h,D1:()=>_,G0:()=>m,GF:()=>i,GZ:()=>s,HM:()=>d,Hd:()=>g,X1:()=>b,_F:()=>u,d_:()=>c,eD:()=>f,g4:()=>y,xp:()=>S});var o=n(62619);const r="data-content-editable-leaf",i={[r]:!0},a="data-content-editable-root",s={[a]:!0},l="data-content-editable-root-tiny-selection-trap",c={[l]:!0},d="data-content-editable-selecting",u="data-content-editable-composing",p="data-content-editable-void",m={[p]:!0};function f(e){return o.kK(e)&&e.hasAttribute(r)}function g(e){return o.kK(e)&&e.hasAttribute(l)}function h(e){return Boolean(o.kK(e)&&e.querySelector(`[${r}]`))}function v(e){return o.kK(e)&&e.hasAttribute(a)}function b(e){return o.sh(e,f)}function y(e,t){return e.parentElement===t?e:o.sh(e,(e=>e.parentElement===t))||e}function _(e,t){if(!e||!t)return!1;const n=S(e),o=S(t);return Boolean(n&&n===o)}function S(e){const t=o.sh(e,(e=>v(e)||function(e){return o.kK(e)&&e.hasAttribute(p)}(e)));if(t&&v(t))return t}},40959:(e,t,n)=>{n.d(t,{Hc:()=>M,MU:()=>C,O5:()=>P,tg:()=>T});var o=n(1302),r=n(41892),i=n(41432),a=n(45953),s=n(21202),l=n(9291),c=n(98104),d=n(33929),u=n(95802),p=n(77080),m=n(92083),f=n(19037),g=n(42),h=n(4708),v=n(78175),b=n(19124),y=n(8989),_=n(56335),S=n(68056),w=n(73959),k=n(89086);const I=(0,l.defineMessages)({textTitle:{id:"newBlock.text.title",defaultMessage:"Text"},textDescription:{id:"newBlock.text.description",defaultMessage:"Just start writing with plain text."},textKeywords:{id:"newBlock.text.fuzzySearchKeywords",defaultMessage:"Plain Text"},pageTitle:{id:"newBlock.page.title",defaultMessage:"Page"},pageDescription:{id:"newBlock.page.description",defaultMessage:"Embed a sub-page inside this page."},pageKeywords:{id:"newBlock.page.fuzzySearchKeywords",defaultMessage:"Page"},linkToPageTitle:{id:"newBlock.linkToPage.title",defaultMessage:"Link to page"},linkToPageDescription:{id:"newBlock.linkToPage.description",defaultMessage:"Link to an existing page."},linkToPageKeywords:{id:"newBlock.linkToPage.fuzzySearchKeywords",defaultMessage:"Link to page ltp"},linkedDatabaseDescription:{id:"newBlock.linkToCollection.description",defaultMessage:"Add an existing database to this page."},transclusionContainerTitle:{id:"newBlock.transclusionContainer.title",defaultMessage:"Synced block"},transclusionContainerDescription:{id:"newBlock.transclusionContainer.description",defaultMessage:"Sync content across pages."},transclusionContainerKeywords:{id:"newBlock.transclusionContainer.fuzzySearchKeywords",defaultMessage:"Create synced block reference transclusion portal block embed group"},toDoTitle:{id:"newBlock.toDo.title",defaultMessage:"To-do list"},toDoDescription:{id:"newBlock.toDo.description",defaultMessage:"Track tasks with a to-do list."},toDoKeywords:{id:"newBlock.toDo.fuzzySearchKeywords",defaultMessage:"Todo To-Do Checkbox List"},headerTitle:{id:"newBlock.header.title",defaultMessage:"Heading 1"},headerDescription:{id:"newBlock.header.description",defaultMessage:"Big section heading."},headerKeywords:{id:"newBlock.header.fuzzySearchKeywords",defaultMessage:"Heading 1 # h1"},subHeaderTitle:{id:"newBlock.subHeader.title",defaultMessage:"Heading 2"},subHeaderDescription:{id:"newBlock.subHeader.description",defaultMessage:"Medium section heading."},subHeaderKeywords:{id:"newBlock.subHeader.fuzzySearchKeywords",defaultMessage:"sub heading 2 ## h2 two"},subSubHeaderTitle:{id:"newBlock.subSubHeader.title",defaultMessage:"Heading 3"},subSubHeaderDescription:{id:"newBlock.subSubHeader.description",defaultMessage:"Small section heading."},subSubHeaderKeywords:{id:"newBlock.subSubHeader.fuzzySearchKeywords",defaultMessage:"subsub heading 3 ### h3 three"},imageTitle:{id:"newBlock.image.title",defaultMessage:"Image"},imageDescription:{id:"newBlock.image.description",defaultMessage:"Upload or embed with a link."},imageKeywords:{id:"newBlock.image.fuzzySearchKeywords",defaultMessage:"Image Picture Gif Giphy"},bookmarkTitle:{id:"newBlock.bookmark.title",defaultMessage:"Web bookmark"},bookmarkDescription:{id:"newBlock.bookmark.description",defaultMessage:"Save a link as a visual bookmark."},bookmarkKeywords:{id:"newBlock.bookmark.fuzzySearchKeywords",defaultMessage:"Web Link Bookmark"},dividerTitle:{id:"newBlock.divider.title",defaultMessage:"Divider"},dividerDescription:{id:"newBlock.divider.description",defaultMessage:"Visually divide blocks."},dividerKeywords:{id:"newBlock.divider.fuzzySearchKeywords",defaultMessage:"Horizontal Rule Divider --- —-"},codeTitle:{id:"newBlock.code.title",defaultMessage:"Code"},codeDescription:{id:"newBlock.code.description",defaultMessage:"Capture a code snippet."},codeKeywords:{id:"newBlock.code.fuzzySearchKeywords",defaultMessage:"Code ```"},quoteTitle:{id:"newBlock.quote.title",defaultMessage:"Quote"},quoteDescription:{id:"newBlock.quote.description",defaultMessage:"Capture a quote."},quoteKeywords:{id:"newBlock.quote.fuzzySearchKeywords",defaultMessage:"Quote"},bulletedListTitle:{id:"newBlock.bulletedList.title",defaultMessage:"Bulleted list"},bulletedListDescription:{id:"newBlock.bulletedList.description",defaultMessage:"Create a simple bulleted list."},bulletedListKeywords:{id:"newBlock.bulletedList.fuzzySearchKeywords",defaultMessage:"Bulleted Unordered List"},numberedListTitle:{id:"newBlock.numberedList.title",defaultMessage:"Numbered list"},numberedListDescription:{id:"newBlock.numberedList.description",defaultMessage:"Create a list with numbering."},numberedListKeywords:{id:"newBlock.numberedList.fuzzySearchKeywords",defaultMessage:"Numbered Ordered List"},toggleTitle:{id:"newBlock.toggle.title",defaultMessage:"Toggle list"},toggleDescription:{id:"newBlock.toggle.description",defaultMessage:"Toggles can hide and show content inside."},toggleKeywords:{id:"newBlock.toggle.fuzzySearchKeywords",defaultMessage:"Toggle list expand"},fileTitle:{id:"newBlock.file.title",defaultMessage:"File"},fileDescription:{id:"newBlock.file.description",defaultMessage:"Upload or embed with a link."},fileKeywords:{id:"newBlock.file.fuzzySearchKeywords",defaultMessage:"File upload attach"},videoTitle:{id:"newBlock.video.title",defaultMessage:"Video"},videoDescription:{id:"newBlock.video.description",defaultMessage:"Embed from YouTube, Vimeo..."},videoKeywords:{id:"newBlock.video.fuzzySearchKeywords",defaultMessage:"Video"},audioTitle:{id:"newBlock.audio.title",defaultMessage:"Audio"},audioDescription:{id:"newBlock.audio.description",defaultMessage:"Embed from SoundCloud, Spotify..."},audioKeywords:{id:"newBlock.audio.fuzzySearchKeywords",defaultMessage:"Audio Sound Music"},embedTitle:{id:"newBlock.embed.title",defaultMessage:"Embed"},embedDescription:{id:"newBlock.embed.description",defaultMessage:"For PDFs, Google Maps, and more."},embedKeywords:{id:"newBlock.embed.fuzzySearchKeywords",defaultMessage:"Embed iFrame"},driveTitle:{id:"newBlock.drive.title",defaultMessage:"Google Drive"},driveDescription:{id:"newBlock.drive.description",defaultMessage:"Embed a Google Doc, Google Sheet..."},driveKeywords:{id:"newBlock.drive.fuzzySearchKeywords",defaultMessage:"Google Drive"},figmaTitle:{id:"newBlock.figma.title",defaultMessage:"Figma"},figmaDescription:{id:"newBlock.figma.description",defaultMessage:"Embed a Figma file."},figmaKeywords:{id:"newBlock.figma.fuzzySearchKeywords",defaultMessage:"Figma"},loomTitle:{id:"newBlock.loom.title",defaultMessage:"Loom"},loomDescription:{id:"newBlock.loom.description",defaultMessage:"Embed a Loom recording."},loomKeywords:{id:"newBlock.loom.fuzzySearchKeywords",defaultMessage:"Loom"},typeformTitle:{id:"newBlock.typeform.title",defaultMessage:"Typeform"},typeformDescription:{id:"newBlock.typeform.description",defaultMessage:"Embed a Typeform."},typeformKeywords:{id:"newBlock.typeform.fuzzySearchKeywords",defaultMessage:"Typeform"},codepenTitle:{id:"newBlock.codepen.title",defaultMessage:"CodePen"},codepenDescription:{id:"newBlock.codepen.description",defaultMessage:"Embed a CodePen."},codepenKeywords:{id:"newBlock.codepen.fuzzySearchKeywords",defaultMessage:"CodePen"},tweetTitle:{id:"newBlock.tweet.title",defaultMessage:"Tweet"},tweetDescription:{id:"newBlock.tweet.description",defaultMessage:"Embed a Tweet."},tweetKeywords:{id:"newBlock.tweet.fuzzySearchKeywords",defaultMessage:"Tweet"},gistTitle:{id:"newBlock.gist.title",defaultMessage:"GitHub Gist"},gistDescription:{id:"newBlock.gist.description",defaultMessage:"Embed a Gist from GitHub."},gistKeywords:{id:"newBlock.gist.fuzzySearchKeywords",defaultMessage:"GitHub Gist"},mapsTitle:{id:"newBlock.maps.title",defaultMessage:"Google Maps"},mapsDescription:{id:"newBlock.maps.description",defaultMessage:"Embed a Google Map."},mapsKeywords:{id:"newBlock.maps.fuzzySearchKeywords",defaultMessage:"Google Maps"},framerTitle:{id:"newBlock.framer.title",defaultMessage:"Framer"},framerDescription:{id:"newBlock.framer.description",defaultMessage:"Embed a Framer prototype."},framerKeywords:{id:"newBlock.framer.fuzzySearchKeywords",defaultMessage:"Framer"},invisionTitle:{id:"newBlock.invision.title",defaultMessage:"Invision"},invisionDescription:{id:"newBlock.invision.description",defaultMessage:"Embed an Invision project."},invisionKeywords:{id:"newBlock.invision.fuzzySearchKeywords",defaultMessage:"Invision"},mixpanelTitle:{id:"newBlock.mixpanel.title",defaultMessage:"Mixpanel"},mixpanelDescription:{id:"newBlock.mixpanel.description",defaultMessage:"Embed a Mixpanel project."},mixpanelKeywords:{id:"newBlock.mixpanel.fuzzySearchKeywords",defaultMessage:"Mixpanel"},equationTitle:{id:"newBlock.equation.title",defaultMessage:"Block equation"},equationDescription:{id:"newBlock.equation.description",defaultMessage:"Display a standalone math equation."},equationKeywords:{id:"newBlock.equation.fuzzySearchKeywords",defaultMessage:"LaTeX Math Block Equation $$ Formula"},pdfTitle:{id:"newBlock.pdf.title",defaultMessage:"PDF"},pdfDescription:{id:"newBlock.pdf.description",defaultMessage:"Embed a PDF."},pdfKeywords:{id:"newBlock.pdf.fuzzySearchKeywords",defaultMessage:"PDF"},factoryTitle:{id:"newBlock.factory.title",defaultMessage:"Template button"},factoryDescription:{id:"newBlock.factory.description",defaultMessage:"Duplicate blocks with a click."},factoryKeywords:{id:"newBlock.factory.fuzzySearchKeywords",defaultMessage:"Template Duplicate Button"},buttonTitle:{id:"newBlock.button.title",defaultMessage:"Button"},buttonDescription:{id:"newBlock.button.description",defaultMessage:"Run custom automations with a click."},buttonKeywords:{id:"newBlock.button.fuzzySearchKeywords",defaultMessage:"Button automation template duplicate"},breadcrumbTitle:{id:"newBlock.breadcrumb.title",defaultMessage:"Breadcrumb"},breadcrumbDescription:{id:"newBlock.breadcrumb.description",defaultMessage:"Show the current page location."},breadcrumbKeywords:{id:"newBlock.breadcrumb.fuzzySearchKeywords",defaultMessage:"Breadcrumb"},calloutTitle:{id:"newBlock.callout.title",defaultMessage:"Callout"},calloutDescription:{id:"newBlock.callout.description",defaultMessage:"Make writing stand out."},calloutKeywords:{id:"newBlock.callout.fuzzySearchKeywords",defaultMessage:"Callout"},table_of_contentsTitle:{id:"newBlock.tableOfContents.title",defaultMessage:"Table of contents"},table_of_contentsDescription:{id:"newBlock.tableOfContents.description",defaultMessage:"Show an outline of your page."},table_of_contentsKeywords:{id:"newBlock.tableOfContents.fuzzySearchKeywords",defaultMessage:"TOC Table of Contents"},whimsicalTitle:{id:"newBlock.whimsical.title",defaultMessage:"Whimsical"},whimsicalDescription:{id:"newBlock.whimsical.description",defaultMessage:"Embed a Whimsical board."},whimsicalKeywords:{id:"newBlock.whimsical.fuzzySearchKeywords",defaultMessage:"Whimsical"},hexTitle:{id:"newBlock.hex.title",defaultMessage:"Hex"},hexDescription:{id:"newBlock.hex.description",defaultMessage:"Embed a Hex cell."},hexKeywords:{id:"newBlock.hex.fuzzySearchKeywords",defaultMessage:"Hex"},deepnoteTitle:{id:"newBlock.deepnote.title",defaultMessage:"Deepnote"},deepnoteDescription:{id:"newBlock.deepnote.description",defaultMessage:"Embed a Deepnote block."},deepnoteKeywords:{id:"newBlock.deepnote.fuzzySearchKeywords",defaultMessage:"Deepnote"},miroTitle:{id:"newBlock.miro.title",defaultMessage:"Miro"},miroDescription:{id:"newBlock.miro.description",defaultMessage:"Embed a Miro board."},miroKeywords:{id:"newBlock.miro.fuzzySearchKeywords",defaultMessage:"Miro"},abstractTitle:{id:"newBlock.abstract.title",defaultMessage:"Abstract"},abstractDescription:{id:"newBlock.abstract.description",defaultMessage:"Embed an Abstract project."},abstractKeywords:{id:"newBlock.abstract.fuzzySearchKeywords",defaultMessage:"Abstract"},sketchTitle:{id:"newBlock.sketch.title",defaultMessage:"Sketch"},sketchDescription:{id:"newBlock.sketch.description",defaultMessage:"Embed a Sketch document."},sketchKeywords:{id:"newBlock.sketch.fuzzySearchKeywords",defaultMessage:"Sketch"},excalidrawTitle:{id:"newBlock.excalidraw.title",defaultMessage:"Excalidraw"},excalidrawDescription:{id:"newBlock.excalidraw.description",defaultMessage:"Embed an Excalidraw whiteboard."},excalidrawKeywords:{id:"newBlock.excalidraw.fuzzySearchKeywords",defaultMessage:"Excalidraw"},replitTitle:{id:"newBlock.replit.title",defaultMessage:"Replit"},replitDescription:{id:"newBlock.replit.description",defaultMessage:"Embed a repl."},replitKeywords:{id:"newBlock.replit.fuzzySearchKeywords",defaultMessage:"Replit"},databaseTitle:{id:"newBlock.database.title",defaultMessage:"Database"},databaseDescription:{id:"newBlock.database.description",defaultMessage:"Create a new database."},inlineTimelineDatabaseTitle:{id:"newBlock.inlineTimelineDatabase.title",defaultMessage:"Timeline database - Inline"},inlineTimelineDatabaseDescription:{id:"newBlock.inlineTimelineDatabase.description",defaultMessage:"Add a Timeline database to this page."},inlineTimelineDatabaseKeywords:{id:"newBlock.inlineTimelineDatabase.fuzzySearchKeywords",defaultMessage:"Timeline database - Inline"},fullPageTableDatabaseTitle:{id:"newBlock.fullPageTableDatabase.title",defaultMessage:"Table database - Full page"},fullPageTableDatabaseDescription:{id:"newBlock.fullPageTableDatabase.description",defaultMessage:"Add a Table database as a sub-page."},fullPageTableDatabaseKeywords:{id:"newBlock.fullPageTableDatabase.fuzzySearchKeywords",defaultMessage:"Table database - Full page"},fullPageBoardDatabaseTitle:{id:"newBlock.fullPageBoardDatabase.title",defaultMessage:"Board database - Full page"},fullPageBoardDatabaseDescription:{id:"newBlock.fullPageBoardDatabase.description",defaultMessage:"Add a Board database as a sub-page."},fullPageBoardDatabaseKeywords:{id:"newBlock.fullPageBoardDatabase.fuzzySearchKeywords",defaultMessage:"Board database - Full page"},fullPageGalleryDatabaseTitle:{id:"newBlock.fullPageGalleryDatabase.title",defaultMessage:"Gallery database - Full page"},fullPageGalleryDatabaseDescription:{id:"newBlock.fullPageGalleryDatabase.description",defaultMessage:"Add a Gallery database as a sub-page."},fullPageGalleryDatabaseKeywords:{id:"newBlock.fullPageGalleryDatabase.fuzzySearchKeywords",defaultMessage:"Gallery database - Full page"},fullPageListDatabaseTitle:{id:"newBlock.fullPageListDatabase.title",defaultMessage:"List database - Full page"},fullPageListDatabaseDescription:{id:"newBlock.fullPageListDatabase.description",defaultMessage:"Add a List database as a sub-page."},fullPageListDatabaseKeywords:{id:"newBlock.fullPageListDatabase.fuzzySearchKeywords",defaultMessage:"List database - Full page"},fullPageCalendarDatabaseTitle:{id:"newBlock.fullPageCalendarDatabase.title",defaultMessage:"Calendar database - Full page"},fullPageCalendarDatabaseDescription:{id:"newBlock.fullPageCalendarDatabase.description",defaultMessage:"Add a Calendar database as a sub-page."},fullPageCalendarDatabaseKeywords:{id:"newBlock.fullPageCalendarDatabase.fuzzySearchKeywords",defaultMessage:"Calendar database - Full page"},fullPageTimelineDatabaseTitle:{id:"newBlock.fullPageTimelineDatabase.title",defaultMessage:"Timeline database - Full page"},fullPageTimelineDatabaseDescription:{id:"newBlock.fullPageTimelineDatabase.description",defaultMessage:"Add a Timeline database as a sub-page."},fullPageTimelineDatabaseKeywords:{id:"newBlock.fullPageTimelineDatabase.fuzzySearchKeywords",defaultMessage:"Timeline database - Full page"},simpleTableTitle:{id:"newBlock.simple_table.title",defaultMessage:"Table"},simpleTableDescription:{id:"newBlock.simple_table.description",defaultMessage:"Add simple tabular content to your page."},simpleTableKeywords:{id:"newBlock.simple_table.fuzzySearchKeywords",defaultMessage:"Table"},tabTitle:{id:"newBlock.tab.title",defaultMessage:"Tabs"},tabDescription:{id:"newBlock.tab.description",defaultMessage:"Organize content in tabs."},tabKeywords:{id:"newBlock.tab.keywords",defaultMessage:"tab tabs tabbed switch toggle"},toggleFormatHeaderTitle:{id:"newBlock.toggleFormatHeader.title",defaultMessage:"Toggle heading 1"},toggleFormatHeaderDescription:{id:"newBlock.toggleFormatHeader.description",defaultMessage:"Hide content inside a large heading."},toggleFormatHeaderKeywords:{id:"newBlock.toggleFormatHeader.fuzzySearchKeywords",defaultMessage:"toggle heading expand 1 # h1"},toggleFormatSubHeaderTitle:{id:"newBlock.toggleFormatSubHeader.title",defaultMessage:"Toggle heading 2"},toggleFormatSubHeaderDescription:{id:"newBlock.toggleFormatSubHeader.description",defaultMessage:"Hide content inside a medium heading."},toggleFormatSubHeaderKeywords:{id:"newBlock.toggleFormatSubHeader.fuzzySearchKeywords",defaultMessage:"toggle sub heading expand 2 ## h2 two"},toggleFormatSubSubHeaderTitle:{id:"newBlock.toggleFormatSubSubHeader.title",defaultMessage:"Toggle heading 3"},toggleFormatSubSubHeaderDescription:{id:"newBlock.toggleFormatSubSubHeader.description",defaultMessage:"Hide content inside a small heading."},toggleFormatSubSubHeaderKeywords:{id:"newBlock.toggleFormatSubSubHeader.fuzzySearchKeywords",defaultMessage:"toggle subsub heading expand 3 ### h3 three"},columnListTitle:{id:"newBlock.columnList.title",defaultMessage:"Columns"},columnListDescription:{id:"newBlock.columnList.description",defaultMessage:"Create columns of blocks."},columnListKeywords:{id:"newBlock.columnList.fuzzySearchKeywords",defaultMessage:"Create col column columns block vertical"},column2Title:{id:"newBlock.column2.title",defaultMessage:"2 columns"},column2Description:{id:"newBlock.column2.description",defaultMessage:"Create 2 columns of blocks."},column2Keywords:{id:"newBlock.column2.fuzzySearchKeywords",defaultMessage:"Create col c2 col2 columns block vertical 2col two"},column3Title:{id:"newBlock.column3.title",defaultMessage:"3 columns"},column3Description:{id:"newBlock.column3.description",defaultMessage:"Create 3 columns of blocks."},column3Keywords:{id:"newBlock.column3.fuzzySearchKeywords",defaultMessage:"c3 col3 column3 columns 3col three"},column4Title:{id:"newBlock.column4.title",defaultMessage:"4 columns"},column4Description:{id:"newBlock.column4.description",defaultMessage:"Create 4 columns of blocks."},column4Keywords:{id:"newBlock.column4.fuzzySearchKeywords",defaultMessage:"c4 col4 column4 columns 4col four"},column5Title:{id:"newBlock.column5.title",defaultMessage:"5 columns"},column5Description:{id:"newBlock.column5.description",defaultMessage:"Create 5 columns of blocks."},column5Keywords:{id:"newBlock.column5.fuzzySearchKeywords",defaultMessage:"c5 col5 column5 columns 5col five"},mermaidCodeTitle:{id:"newBlock.mermaidCode.title",defaultMessage:"Code - Mermaid"},mermaidCodeDescription:{id:"newBlock.mermaidCode.description",defaultMessage:"Create a diagram by writing code."},mermaidCodeKeywords:{id:"newBlock.mermaidCode.fuzzySearchKeywords",defaultMessage:"mermaid diagram graphviz flowchart code"},aiSummaryBlockTitle:{id:"newBlock.aiSummaryBlock.title",defaultMessage:"Summary"},aiSummaryBlockDescription:{id:"newBlock.aiSummaryBlock.description",defaultMessage:"Generate a summary for the current page."},aiSummaryKeywords:{id:"newBlock.aiSummaryBlock.fuzzySearchKeywords",defaultMessage:"summary ai"},aiActionItemsBlockTitle:{id:"newBlock.aiActionItemsBlock.title",defaultMessage:"Action items"},aiActionItemsDescription:{id:"newBlock.aiActionItemsBlock.description",defaultMessage:"Extract action items from current page."},aiActionItemsKeywords:{id:"newBlock.aiActionItemsBlock.fuzzySearchKeywords",defaultMessage:"find action items ai"},aiFreePromptBlockTitle:{id:"newBlock.aiFreePromptBlock.title",defaultMessage:"Custom AI Block"},aiFreePromptDescription:{id:"newBlock.aiFreePromptBlock.description",defaultMessage:"Generate content from any instruction."},aiFreePromptKeywords:{id:"newBlock.aiFreePromptBlock.fuzzySearchKeywords",defaultMessage:"ask help question prompt ai custom block content"},drawingTitle:{id:"newBlock.drawing.title",defaultMessage:"Drawing"},drawingDescription:{id:"newBlock.drawing.description",defaultMessage:"Draw and diagram on an infinite canvas."},drawingKeywords:{id:"newBlock.drawing.fuzzySearchKeywords",defaultMessage:"drawing diagram canvas illustration draw sketch tldraw doodle mindmap architecture paint pen"},aiSectionBlockTitle:{id:"newBlock.aiSection.title",defaultMessage:"AI Section"},aiSectionKeywords:{id:"newBlock.aiSection.fuzzySearchKeywords",defaultMessage:"ai section heading meeting note summary action items"},asanaImportTitle:{id:"newBlock.asanaImport.import",defaultMessage:"Asana"},asanaImportDescription:{id:"newBlock.asanaImport.description",defaultMessage:"Bring projects and tasks form Asana into Notion."},asanaImportKeywords:{id:"newBlock.asanaImport.fuzzySearchKeywords",defaultMessage:"Asana Projects Tasks Import"},confluenceApiImportTitle:{id:"newBlock.confluenceApiImport.import",defaultMessage:"Confluence"},confluenceApiImportDescription:{id:"newBlock.confluenceApiImport.description",defaultMessage:"Bring documents from Confluence via API into Notion."},confluenceApiImportKeywords:{id:"newBlock.confluenceApiImport.fuzzySearchKeywords",defaultMessage:"Confluence"},googleDocsImportTitle:{id:"newBlock.googleDocsImport.import",defaultMessage:"Google Docs"},googleDocsImportDescription:{id:"newBlock.googleDocsImport.description",defaultMessage:"Bring documents from Google Docs into Notion."},googleDocsImportKeywords:{id:"newBlock.googleDocsImport.fuzzySearchKeywords",defaultMessage:"Google Docs Import"},dropboxPaperImportTitle:{id:"newBlock.dropboxPaperImport.import",defaultMessage:"Dropbox Paper"},dropboxPaperImportDescription:{id:"newBlock.dropboxPaperImport.description",defaultMessage:"Bring documents from Dropbox Paper into Notion."},dropboxPaperImportKeywords:{id:"newBlock.dropboxPaperImport.fuzzySearchKeywords",defaultMessage:"Dropbox Paper Import"},evernoteImportTitle:{id:"newBlock.evernoteImport.import",defaultMessage:"Evernote"},evernoteImportDescription:{id:"newBlock.evernoteImport.description",defaultMessage:"Bring notes from Evernote into Notion."},evernoteImportKeywords:{id:"newBlock.evernoteImport.fuzzySearchKeywords",defaultMessage:"Evernote Import"},wordImportTitle:{id:"newBlock.wordImport.import",defaultMessage:"Word"},wordImportDescription:{id:"newBlock.wordImport.description",defaultMessage:"Bring documents from Microsoft Word into Notion."},wordImportKeywords:{id:"newBlock.wordImport.fuzzySearchKeywords",defaultMessage:"Word Import"},workflowyImportTitle:{id:"newBlock.workflowyImport.import",defaultMessage:"Workflowy"},workflowyImportDescription:{id:"newBlock.workflowyImport.description",defaultMessage:"Bring documents from Workflowy into Notion."},workflowyImportKeywords:{id:"newBlock.workflowyImport.fuzzySearchKeywords",defaultMessage:"Workflowy Import"},mondayImportTitle:{id:"newBlock.mondayImport.import",defaultMessage:"Monday"},mondayImportDescription:{id:"newBlock.mondayImport.description",defaultMessage:"Bring projects & tasks from Monday into Notion."},mondayImportKeywords:{id:"newBlock.mondayImport.fuzzySearchKeywords",defaultMessage:"Monday Import"},trelloImportTitle:{id:"newBlock.trelloImport.import",defaultMessage:"Trello"},trelloImportDescription:{id:"newBlock.trelloImport.description",defaultMessage:"Bring projects & tasks from Trello into Notion."},trelloImportKeywords:{id:"newBlock.trelloImport.fuzzySearchKeywords",defaultMessage:"Trello Import"},quipImportTitle:{id:"newBlock.quipImport.import",defaultMessage:"Quip"},quipImportDescription:{id:"newBlock.quipImport.description",defaultMessage:"Bring documents from Quip into Notion."},quipImportKeywords:{id:"newBlock.quipImport.fuzzySearchKeywords",defaultMessage:"Quip Import"},csvImportTitle:{id:"newBlock.csvImport.import",defaultMessage:"CSV"},csvImportDescription:{id:"newBlock.csvImport.description",defaultMessage:"Bring data from CSV into Notion."},csvImportKeywords:{id:"newBlock.csvImport.fuzzySearchKeywords",defaultMessage:"CSV Import"},genericImportTitle:{id:"newBlock.genericImport.import",defaultMessage:"ZIP"},genericImportDescription:{id:"newBlock.genericImport.description",defaultMessage:"Bring data from other tools into Notion."},genericImportKeywords:{id:"newBlock.genericImport.fuzzySearchKeywords",defaultMessage:"Generic Universal Zip Import"},htmlImportTitle:{id:"newBlock.htmlImport.import",defaultMessage:"HTML"},htmlImportDescription:{id:"newBlock.htmlImport.description",defaultMessage:"Bring data from HTML into Notion."},htmlImportKeywords:{id:"newBlock.htmlImport.fuzzySearchKeywords",defaultMessage:"HTML Import"},markdownImportTitle:{id:"newBlock.markdownImport.import",defaultMessage:"Text and Markdown"},markdownImportDescription:{id:"newBlock.markdownImport.description",defaultMessage:"Bring data from text and markdown into Notion."},markdownImportKeywords:{id:"newBlock.markdownImport.fuzzySearchKeywords",defaultMessage:"Text Markdown Import"}});function C(e){const{key:t,displayName:n,fuzzySearchKeywords:o,blockType:r,thumbnail:i,tooltipPhoto:l,description:c,createTemplate:u,shouldShow:p,badge:m,postCreateCallback:f,collectionViewType:g,isToggleable:h}=e,v=d.default.formatMessage(o),b=v!==o.defaultMessage?`${v} ${o.defaultMessage}`:v;return{key:t,displayName:d.default.formatMessage(n),analyticsName:n.defaultMessage,searchName:b,thumbnail:i,tooltipPhoto:l,description:c?d.default.formatMessage(c):void 0,templateRootBlockId:"root",blockType:r,createTemplate:u||(()=>a.Ao.create({[s.iU]:{root:{id:"root",type:r}}})),shouldShow:p,badge:m,postCreateCallback:f,collectionViewType:g,isToggleable:h}}function x(e){const{key:t,displayName:n,fuzzySearchKeywords:o,thumbnail:r,tooltipPhoto:i,description:a,shouldShow:s,badge:l,postCreateCallback:c,collectionViewType:u,isToggleable:p,action:m}=e,f=d.default.formatMessage(o),g=f!==o.defaultMessage?`${f} ${o.defaultMessage}`:f;return{key:t,displayName:d.default.formatMessage(n),analyticsName:n.defaultMessage,searchName:g,thumbnail:r,tooltipPhoto:i,description:a?d.default.formatMessage(a):void 0,templateRootBlockId:"root",shouldShow:s,badge:l,postCreateCallback:c,collectionViewType:u,isToggleable:p,action:m}}const T={[i.tD.asanaImport]:x({key:i.tD.asanaImport,displayName:I.asanaImportTitle,fuzzySearchKeywords:I.asanaImportKeywords,thumbnail:r.Z.images.import.asanaPng,description:I.asanaImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"asana",openedFrom:"slash_command"})},shouldShow:e=>R()}),[i.tD.confluenceApiImport]:x({key:i.tD.confluenceApiImport,displayName:I.confluenceApiImportTitle,fuzzySearchKeywords:I.confluenceApiImportKeywords,thumbnail:r.Z.images.import.confluencePng,description:I.confluenceApiImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"confluenceApi",openedFrom:"slash_command"})},shouldShow:e=>R()}),[i.tD.googleDocsImport]:x({key:i.tD.googleDocsImport,displayName:I.googleDocsImportTitle,fuzzySearchKeywords:I.googleDocsImportKeywords,thumbnail:r.Z.images.import.googleDocsPng,description:I.googleDocsImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"gdocs",openedFrom:"slash_command"})},shouldShow:e=>R()}),[i.tD.dropboxPaperImport]:x({key:i.tD.dropboxPaperImport,displayName:I.dropboxPaperImportTitle,fuzzySearchKeywords:I.dropboxPaperImportKeywords,thumbnail:r.Z.images.import.dropboxPaperPng,description:I.dropboxPaperImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"dropbox",openedFrom:"slash_command"})},shouldShow:e=>R()}),[i.tD.evernoteImport]:x({key:i.tD.evernoteImport,displayName:I.evernoteImportTitle,fuzzySearchKeywords:I.evernoteImportKeywords,thumbnail:r.Z.images.import.evernotePng,description:I.evernoteImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"evernote",openedFrom:"slash_command"})},shouldShow:e=>R()}),[i.tD.mondayImport]:x({key:i.tD.mondayImport,displayName:I.mondayImportTitle,fuzzySearchKeywords:I.mondayImportKeywords,thumbnail:r.Z.images.import.mondayPng,description:I.mondayImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"monday",openedFrom:"slash_command"})},shouldShow:e=>R()&&(0,_.d)()}),[i.tD.quipImport]:x({key:i.tD.quipImport,displayName:I.quipImportTitle,fuzzySearchKeywords:I.quipImportKeywords,thumbnail:r.Z.images.import.quipPng,description:I.quipImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"quip",openedFrom:"slash_command"})},shouldShow:e=>R()}),[i.tD.trelloImport]:x({key:i.tD.trelloImport,displayName:I.trelloImportTitle,fuzzySearchKeywords:I.trelloImportKeywords,thumbnail:r.Z.images.import.trelloPng,description:I.trelloImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"trello",openedFrom:"slash_command"})},shouldShow:e=>R()}),[i.tD.workflowyImport]:x({key:i.tD.workflowyImport,displayName:I.workflowyImportTitle,fuzzySearchKeywords:I.workflowyImportKeywords,thumbnail:r.Z.images.import.workflowyPng,description:I.workflowyImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"workflowy",openedFrom:"slash_command"})},shouldShow:e=>R()}),[i.tD.wordImport]:x({key:i.tD.wordImport,displayName:I.wordImportTitle,fuzzySearchKeywords:I.wordImportKeywords,thumbnail:r.Z.images.import.wordPng,description:I.wordImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"docx",openedFrom:"slash_command"})},shouldShow:e=>R()}),[i.tD.csvImport]:x({key:i.tD.csvImport,displayName:I.csvImportTitle,fuzzySearchKeywords:I.csvImportKeywords,thumbnail:r.Z.images.import.csvPng,description:I.csvImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"csv",openedFrom:"slash_command"})},shouldShow:e=>R()}),[i.tD.htmlImport]:x({key:i.tD.htmlImport,displayName:I.htmlImportTitle,fuzzySearchKeywords:I.htmlImportKeywords,thumbnail:r.Z.images.import.htmlPng,description:I.htmlImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"html",openedFrom:"slash_command"})},shouldShow:e=>R()}),[i.tD.markdownImport]:x({key:i.tD.markdownImport,displayName:I.markdownImportTitle,fuzzySearchKeywords:I.markdownImportKeywords,thumbnail:r.Z.images.import.textPng,description:I.markdownImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"markdown",openedFrom:"slash_command"})},shouldShow:e=>R()}),[i.tD.genericImport]:x({key:i.tD.genericImport,displayName:I.genericImportTitle,fuzzySearchKeywords:I.genericImportKeywords,thumbnail:r.Z.images.import.importPng,description:I.genericImportDescription,action:()=>{m.Z.setState({...m.Z.state,open:!0,currentTab:"imports",highlightedSetting:void 0,defaultSubtab:"genericImporter",openedFrom:"slash_command"})},shouldShow:e=>R()&&(0,y.tt)()})},M={[i.Ti.text]:C({key:i.Ti.text,blockType:i.Ti.text,displayName:I.textTitle,fuzzySearchKeywords:I.textKeywords,thumbnail:r.Z.images.blocks.textPng,description:I.textDescription,tooltipPhoto:r.Z.images.tooltips.blocks.textPng}),[i.Ti.page]:C({key:i.Ti.page,blockType:i.Ti.page,displayName:I.pageTitle,fuzzySearchKeywords:I.pageKeywords,thumbnail:r.Z.images.blocks.pagePng,description:I.pageDescription,tooltipPhoto:r.Z.images.tooltips.blocks.pagePng}),[i.Ti.linkToPage]:C({key:i.Ti.linkToPage,blockType:i.Ti.linkToPage,displayName:I.linkToPageTitle,fuzzySearchKeywords:I.linkToPageKeywords,thumbnail:r.Z.images.blocks.linkPng,description:I.linkToPageDescription,tooltipPhoto:r.Z.images.tooltips.blocks.linkToPagePng}),[i.Ti.transclusionContainer]:C({key:i.Ti.transclusionContainer,blockType:i.Ti.transclusionContainer,displayName:I.transclusionContainerTitle,fuzzySearchKeywords:I.transclusionContainerKeywords,thumbnail:r.Z.images.blocks.transclusionPng,description:I.transclusionContainerDescription,tooltipPhoto:r.Z.images.tooltips.blocks.transclusionPng,shouldShow:e=>!(0,f.wT)(e),createTemplate:e=>g._Z()}),[i.Ti.toDo]:C({key:i.Ti.toDo,blockType:i.Ti.toDo,displayName:I.toDoTitle,fuzzySearchKeywords:I.toDoKeywords,thumbnail:r.Z.images.blocks.toDoPng,description:I.toDoDescription,tooltipPhoto:r.Z.images.tooltips.blocks.toDoListPng}),[i.Ti.header]:C({key:i.Ti.header,blockType:i.Ti.header,displayName:I.headerTitle,fuzzySearchKeywords:I.headerKeywords,thumbnail:r.Z.images.blocks.headerPng,description:I.headerDescription,tooltipPhoto:r.Z.images.tooltips.blocks.headerPng}),[i.Ti.subHeader]:C({key:i.Ti.subHeader,blockType:i.Ti.subHeader,displayName:I.subHeaderTitle,fuzzySearchKeywords:I.subHeaderKeywords,thumbnail:r.Z.images.blocks.subheaderPng,description:I.subHeaderDescription,tooltipPhoto:r.Z.images.tooltips.blocks.subHeaderPng}),[i.Ti.subSubHeader]:C({key:i.Ti.subSubHeader,blockType:i.Ti.subSubHeader,displayName:I.subSubHeaderTitle,fuzzySearchKeywords:I.subSubHeaderKeywords,thumbnail:r.Z.images.blocks.subsubheaderPng,description:I.subSubHeaderDescription,tooltipPhoto:r.Z.images.tooltips.blocks.subsubheaderPng}),[i.Ti.image]:C({key:i.Ti.image,blockType:i.Ti.image,displayName:I.imageTitle,fuzzySearchKeywords:I.imageKeywords,description:I.imageDescription,tooltipPhoto:r.Z.images.tooltips.blocks.imagePng,thumbnail:r.Z.images.blocks.imagePng}),[i.Ti.bookmark]:C({key:i.Ti.bookmark,blockType:i.Ti.bookmark,displayName:I.bookmarkTitle,fuzzySearchKeywords:I.bookmarkKeywords,thumbnail:r.Z.images.blocks.webBookmarkPng,description:I.bookmarkDescription,tooltipPhoto:r.Z.images.tooltips.blocks.webBookmarkPng}),[i.Ti.divider]:C({key:i.Ti.divider,blockType:i.Ti.divider,displayName:I.dividerTitle,fuzzySearchKeywords:I.dividerKeywords,thumbnail:r.Z.images.blocks.dividerPng,description:I.dividerDescription,tooltipPhoto:r.Z.images.tooltips.blocks.dividerPng}),[i.Ti.code]:C({key:i.Ti.code,blockType:i.Ti.code,displayName:I.codeTitle,fuzzySearchKeywords:I.codeKeywords,thumbnail:r.Z.images.blocks.codePng,description:I.codeDescription,tooltipPhoto:r.Z.images.tooltips.blocks.codePng}),[i.Ti.quote]:C({key:i.Ti.quote,blockType:i.Ti.quote,displayName:I.quoteTitle,fuzzySearchKeywords:I.quoteKeywords,thumbnail:r.Z.images.blocks.quotePng,description:I.quoteDescription,tooltipPhoto:r.Z.images.tooltips.blocks.quotePng}),[i.Ti.bulletedList]:C({key:i.Ti.bulletedList,blockType:i.Ti.bulletedList,displayName:I.bulletedListTitle,fuzzySearchKeywords:I.bulletedListKeywords,thumbnail:r.Z.images.blocks.bulletedListPng,description:I.bulletedListDescription,tooltipPhoto:r.Z.images.tooltips.blocks.bulletedListPng}),[i.Ti.numberedList]:C({key:i.Ti.numberedList,blockType:i.Ti.numberedList,displayName:I.numberedListTitle,fuzzySearchKeywords:I.numberedListKeywords,thumbnail:r.Z.images.blocks.numberedListPng,description:I.numberedListDescription,tooltipPhoto:r.Z.images.tooltips.blocks.numberedListPng}),[i.Ti.toggle]:C({key:i.Ti.toggle,blockType:i.Ti.toggle,displayName:I.toggleTitle,fuzzySearchKeywords:I.toggleKeywords,thumbnail:r.Z.images.blocks.togglePng,description:I.toggleDescription,tooltipPhoto:r.Z.images.tooltips.blocks.toggleListPng,isToggleable:!0}),[i.Ti.file]:C({key:i.Ti.file,blockType:i.Ti.file,displayName:I.fileTitle,fuzzySearchKeywords:I.fileKeywords,thumbnail:r.Z.images.blocks.filePng,tooltipPhoto:r.Z.images.tooltips.blocks.filePng,description:I.fileDescription}),[i.Ti.video]:C({key:i.Ti.video,blockType:i.Ti.video,displayName:I.videoTitle,fuzzySearchKeywords:I.videoKeywords,thumbnail:r.Z.images.blocks.videoPng,tooltipPhoto:r.Z.images.tooltips.blocks.videoPng,description:I.videoDescription}),[i.Ti.audio]:C({key:i.Ti.audio,blockType:i.Ti.audio,displayName:I.audioTitle,fuzzySearchKeywords:I.audioKeywords,thumbnail:r.Z.images.blocks.audioPng,description:I.audioDescription}),[i.Ti.embed]:C({key:i.Ti.embed,blockType:i.Ti.embed,displayName:I.embedTitle,fuzzySearchKeywords:I.embedKeywords,thumbnail:r.Z.images.blocks.embedPng,description:I.embedDescription}),[i.Ti.drive]:C({key:i.Ti.drive,blockType:i.Ti.drive,displayName:I.driveTitle,fuzzySearchKeywords:I.driveKeywords,thumbnail:r.Z.images.blocks.drivePng,description:I.driveDescription,shouldShow:e=>(0,f.P5)()}),[i.Ti.figma]:C({key:i.Ti.figma,blockType:i.Ti.figma,displayName:I.figmaTitle,fuzzySearchKeywords:I.figmaKeywords,thumbnail:r.Z.images.blocks.figmaPng,description:I.figmaDescription}),[i.Ti.loom]:C({key:i.Ti.loom,blockType:i.Ti.loom,displayName:I.loomTitle,fuzzySearchKeywords:I.loomKeywords,thumbnail:r.Z.images.blocks.loomPng,description:I.loomDescription}),[i.Ti.typeform]:C({key:i.Ti.typeform,blockType:i.Ti.typeform,displayName:I.typeformTitle,fuzzySearchKeywords:I.typeformKeywords,thumbnail:r.Z.images.blocks.typeformPng,description:I.typeformDescription}),[i.Ti.codepen]:C({key:i.Ti.codepen,blockType:i.Ti.codepen,displayName:I.codepenTitle,fuzzySearchKeywords:I.codepenKeywords,thumbnail:r.Z.images.blocks.codepenPng,description:I.codepenDescription}),[i.Ti.tweet]:C({key:i.Ti.tweet,blockType:i.Ti.tweet,displayName:I.tweetTitle,fuzzySearchKeywords:I.tweetKeywords,thumbnail:r.Z.images.blocks.twitterPng,description:I.tweetDescription}),[i.Ti.gist]:C({key:i.Ti.gist,blockType:i.Ti.gist,displayName:I.gistTitle,fuzzySearchKeywords:I.gistKeywords,thumbnail:r.Z.images.blocks.githubPng,description:I.gistDescription}),[i.Ti.maps]:C({key:i.Ti.maps,blockType:i.Ti.maps,displayName:I.mapsTitle,fuzzySearchKeywords:I.mapsKeywords,thumbnail:r.Z.images.blocks.mapsPng,description:I.mapsDescription}),[i.Ti.framer]:C({key:i.Ti.framer,blockType:i.Ti.framer,displayName:I.framerTitle,fuzzySearchKeywords:I.framerKeywords,thumbnail:r.Z.images.blocks.framerPng,description:I.framerDescription}),[i.Ti.invision]:C({key:i.Ti.invision,blockType:i.Ti.invision,displayName:I.invisionTitle,fuzzySearchKeywords:I.invisionKeywords,thumbnail:r.Z.images.blocks.invisionPng,description:I.invisionDescription}),[i.Ti.equation]:C({key:i.Ti.equation,blockType:i.Ti.equation,displayName:I.equationTitle,fuzzySearchKeywords:I.equationKeywords,thumbnail:r.Z.images.blocks.texPng,tooltipPhoto:r.Z.images.tooltips.blocks.mathPng,description:I.equationDescription}),[i.Ti.pdf]:C({key:i.Ti.pdf,blockType:i.Ti.pdf,displayName:I.pdfTitle,fuzzySearchKeywords:I.pdfKeywords,thumbnail:r.Z.images.blocks.pdfPng,description:I.pdfDescription}),[i.Ti.factory]:C({displayName:I.factoryTitle,fuzzySearchKeywords:I.factoryKeywords,thumbnail:r.Z.images.blocks.templateButtonPng,key:i.Ti.factory,blockType:i.Ti.factory,description:I.factoryDescription,tooltipPhoto:r.Z.images.tooltips.blocks.templateButtonPng,createTemplate:g.sw,shouldShow:()=>!1}),[i.Ti.button]:C({displayName:I.buttonTitle,fuzzySearchKeywords:I.buttonKeywords,thumbnail:r.Z.images.blocks.templateButtonPng,key:i.Ti.button,blockType:i.Ti.button,description:I.buttonDescription,tooltipPhoto:r.Z.images.tooltips.blocks.templateButtonPng,createTemplate:g.ax}),[i.Ti.breadcrumb]:C({displayName:I.breadcrumbTitle,thumbnail:r.Z.images.blocks.breadcrumbPng,tooltipPhoto:r.Z.images.tooltips.blocks.breadcrumbPng,description:I.breadcrumbDescription,fuzzySearchKeywords:I.breadcrumbKeywords,key:i.Ti.breadcrumb,blockType:i.Ti.breadcrumb}),[i.Ti.callout]:C({key:i.Ti.callout,blockType:i.Ti.callout,displayName:I.calloutTitle,thumbnail:r.Z.images.blocks.calloutPng,description:I.calloutDescription,fuzzySearchKeywords:I.calloutKeywords,tooltipPhoto:r.Z.images.tooltips.blocks.calloutPng}),[i.Ti.tableOfContents]:C({displayName:I.table_of_contentsTitle,fuzzySearchKeywords:I.table_of_contentsKeywords,thumbnail:r.Z.images.blocks.tableOfContentsPng,tooltipPhoto:r.Z.images.tooltips.blocks.tableOfContentsPng,description:I.table_of_contentsDescription,key:i.Ti.tableOfContents,blockType:i.Ti.tableOfContents}),[i.Ti.whimsical]:C({key:i.Ti.whimsical,blockType:i.Ti.whimsical,displayName:I.whimsicalTitle,fuzzySearchKeywords:I.whimsicalKeywords,thumbnail:r.Z.images.blocks.whimsicalPng,description:I.whimsicalDescription}),[i.Ti.mixpanel]:C({key:i.Ti.mixpanel,blockType:i.Ti.mixpanel,displayName:I.mixpanelTitle,fuzzySearchKeywords:I.mixpanelKeywords,thumbnail:r.Z.images.blocks.mixpanelPng,description:I.mixpanelDescription}),[i.Ti.miro]:C({key:i.Ti.miro,blockType:i.Ti.miro,displayName:I.miroTitle,fuzzySearchKeywords:I.miroKeywords,thumbnail:r.Z.images.blocks.miroPng,description:I.miroDescription}),[i.Ti.abstract]:C({key:i.Ti.abstract,blockType:i.Ti.abstract,displayName:I.abstractTitle,thumbnail:r.Z.images.blocks.abstractPng,description:I.abstractDescription,fuzzySearchKeywords:I.abstractKeywords}),[i.Ti.sketch]:C({key:i.Ti.sketch,blockType:i.Ti.sketch,displayName:I.sketchTitle,thumbnail:r.Z.images.blocks.sketchPng,description:I.sketchDescription,fuzzySearchKeywords:I.sketchKeywords}),[i.Ti.excalidraw]:C({key:i.Ti.excalidraw,blockType:i.Ti.excalidraw,displayName:I.excalidrawTitle,thumbnail:r.Z.images.blocks.excalidrawPng,description:I.excalidrawDescription,fuzzySearchKeywords:I.excalidrawKeywords}),[i.Ti.replit]:C({key:i.Ti.replit,blockType:i.Ti.replit,displayName:I.replitTitle,thumbnail:r.Z.images.blocks.replitPng,description:I.replitDescription,fuzzySearchKeywords:I.replitKeywords}),[i.Ti.table]:C({key:i.Ti.table,blockType:i.Ti.table,displayName:I.simpleTableTitle,thumbnail:r.Z.images.blocks.simpleTablePng,description:I.simpleTableDescription,fuzzySearchKeywords:I.simpleTableKeywords,tooltipPhoto:r.Z.images.tooltips.blocks.simpleTablePng,createTemplate:()=>g.S7()}),[i.Ti.tab]:C({key:i.Ti.tab,blockType:i.Ti.tab,displayName:I.tabTitle,thumbnail:r.Z.images.blocks.tabsPng,tooltipPhoto:r.Z.images.tooltips.blocks.tabsPng,description:I.tabDescription,fuzzySearchKeywords:I.tabKeywords,createTemplate:()=>g.ZW(),shouldShow:e=>(0,f.$c)(e)}),[i.Ti.hex]:C({key:i.Ti.hex,blockType:i.Ti.hex,displayName:I.hexTitle,thumbnail:r.Z.images.blocks.hexPng,description:I.hexDescription,fuzzySearchKeywords:I.hexKeywords}),[i.Ti.deepnote]:C({key:i.Ti.deepnote,blockType:i.Ti.deepnote,displayName:I.deepnoteTitle,thumbnail:r.Z.images.blocks.deepnotePng,description:I.deepnoteDescription,fuzzySearchKeywords:I.deepnoteKeywords}),[i.MF.toggleFormatHeaderBlock]:C({key:i.MF.toggleFormatHeaderBlock,blockType:i.Ti.header,displayName:I.toggleFormatHeaderTitle,fuzzySearchKeywords:I.toggleFormatHeaderKeywords,thumbnail:r.Z.images.blocks.toggleHeading1Png,description:I.toggleFormatHeaderDescription,tooltipPhoto:r.Z.images.tooltips.blocks.toggleH1Png,createTemplate:()=>g.UG(i.Ti.header),isToggleable:!0}),[i.MF.toggleFormatSubHeaderBlock]:C({key:i.MF.toggleFormatSubHeaderBlock,blockType:i.Ti.subHeader,displayName:I.toggleFormatSubHeaderTitle,fuzzySearchKeywords:I.toggleFormatSubHeaderKeywords,thumbnail:r.Z.images.blocks.toggleHeading2Png,description:I.toggleFormatSubHeaderDescription,tooltipPhoto:r.Z.images.tooltips.blocks.toggleH2Png,createTemplate:()=>g.UG(i.Ti.subHeader),isToggleable:!0}),[i.MF.toggleFormatSubSubHeaderBlock]:C({key:i.MF.toggleFormatSubSubHeaderBlock,blockType:i.Ti.subSubHeader,displayName:I.toggleFormatSubSubHeaderTitle,fuzzySearchKeywords:I.toggleFormatSubSubHeaderKeywords,thumbnail:r.Z.images.blocks.toggleHeading3Png,description:I.toggleFormatSubSubHeaderDescription,tooltipPhoto:r.Z.images.tooltips.blocks.toggleH3Png,createTemplate:()=>g.UG(i.Ti.subSubHeader),isToggleable:!0}),[i.Ti.columnList]:C({key:i.Ti.columnList,blockType:i.Ti.columnList,displayName:I.columnListTitle,fuzzySearchKeywords:I.columnListKeywords,thumbnail:r.Z.images.blocks.columnListPng,description:I.columnListDescription,tooltipPhoto:r.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>g.n_(2),shouldShow:e=>!e.environment.device.isPhone}),[i.MF.column2Block]:C({key:i.MF.column2Block,blockType:i.Ti.columnList,displayName:I.column2Title,fuzzySearchKeywords:I.column2Keywords,thumbnail:r.Z.images.blocks.columnListPng,description:I.column2Description,tooltipPhoto:r.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>g.n_(2),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(v.hF)}),[i.MF.column3Block]:C({key:i.MF.column3Block,blockType:i.Ti.columnList,displayName:I.column3Title,fuzzySearchKeywords:I.column3Keywords,thumbnail:r.Z.images.blocks.columnListPng,description:I.column3Description,tooltipPhoto:r.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>g.n_(3),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(v.hF)}),[i.MF.column4Block]:C({key:i.MF.column4Block,blockType:i.Ti.columnList,displayName:I.column4Title,fuzzySearchKeywords:I.column4Keywords,thumbnail:r.Z.images.blocks.columnListPng,description:I.column4Description,tooltipPhoto:r.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>g.n_(4),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(v.hF)}),[i.MF.column5Block]:C({key:i.MF.column5Block,blockType:i.Ti.columnList,displayName:I.column5Title,fuzzySearchKeywords:I.column5Keywords,thumbnail:r.Z.images.blocks.columnListPng,description:I.column5Description,tooltipPhoto:r.Z.images.tooltips.blocks.columnListPng,createTemplate:()=>g.n_(5),shouldShow:e=>!e.environment.device.isPhone&&!e.blocks.some(v.hF)}),[i.MF.mermaidCodeBlock]:C({key:i.MF.mermaidCodeBlock,blockType:i.Ti.code,displayName:I.mermaidCodeTitle,fuzzySearchKeywords:I.mermaidCodeKeywords,thumbnail:r.Z.images.blocks.codePng,description:I.mermaidCodeDescription,tooltipPhoto:r.Z.images.tooltips.blocks.codePng,createTemplate:()=>g.iD("Mermaid","graph TD\n  Mermaid --\x3e Diagram"),postCreateCallback:e=>{o.default.afterNextFlush((()=>{o.default.afterNextFlush((()=>{const t=u.C.find((t=>t.props.store.id===e.id)),n=null==t?void 0:t.props.store,o=n&&(0,w.mh)(n);if(o){var r;const e=(0,S.TD)({store:o,selection:{startIndex:0,endIndex:(null===(r=(0,k.x0)(o))||void 0===r?void 0:r.endIndex)??0}});c.NA({multiSelection:e})}}))}))}}),[i.MF.aiSummaryBlock]:C({key:i.MF.aiSummaryBlock,blockType:i.Ti.aiBlock,displayName:I.aiSummaryBlockTitle,fuzzySearchKeywords:I.aiSummaryKeywords,thumbnail:r.Z.images.blocks.tableOfContentsPng,description:I.aiSummaryBlockDescription,badge:"ai",createTemplate:()=>g.Jy("summarize"),shouldShow:e=>!e.environment.device.isPhone&&A(e)}),[i.MF.aiActionItemsBlock]:C({key:i.MF.aiActionItemsBlock,blockType:i.Ti.aiBlock,displayName:I.aiActionItemsBlockTitle,fuzzySearchKeywords:I.aiActionItemsKeywords,thumbnail:r.Z.images.blocks.bulletedListPng,description:I.aiActionItemsDescription,badge:"ai",createTemplate:()=>g.Jy("findActionItems"),shouldShow:e=>!e.environment.device.isPhone&&A(e)}),[i.MF.aiFreePromptBlock]:C({key:i.MF.aiFreePromptBlock,blockType:i.Ti.aiBlock,displayName:I.aiFreePromptBlockTitle,fuzzySearchKeywords:I.aiFreePromptKeywords,thumbnail:r.Z.images.blocks.calloutPng,description:I.aiFreePromptDescription,badge:"ai",createTemplate:()=>g.Jy("helpMeWrite"),shouldShow:e=>!e.environment.device.isPhone&&A(e)}),[i.Ti.drawing]:C({key:i.Ti.drawing,blockType:i.Ti.drawing,displayName:I.drawingTitle,fuzzySearchKeywords:I.drawingKeywords,thumbnail:r.Z.images.externalIntegrations.acmeIconPng,description:I.drawingDescription,shouldShow:e=>(0,h.A3)(),createTemplate:()=>g.Fr()})},P=(M[i.Ti.callout],M[i.Ti.toggle],[i.MF.aiSummaryBlock,i.MF.aiActionItemsBlock,i.MF.aiFreePromptBlock]),A=e=>{let{publicEditMode:t}=e;return(0,b.GD)(t)};function R(){return"on"===p.default.getEligibleGroup({experimentId:"slash_command_import",defaultGroup:"control"})}},11599:(e,t,n)=>{n.d(t,{$0:()=>d,A$:()=>l,ab:()=>s,dy:()=>c,kq:()=>p,p1:()=>u});var o=n(80951),r=n(80444),i=n(88923);function a(){const e=d(),{mainEditorCurrentBlockStore:t}=r.default.state,n=i.default.state.open&&i.default.state.target||t;return e||n}function s(e,t){const n=a(),o=null==n?void 0:n.getFormat(),r=e&&e[t],i=(null==o?void 0:o.collection_page_sections)||[];if(!r){if("backlinks"===t)return"section_collapsed";if("comments"===t)return"section_show";if("margin_comments"===t)return"inline";if(i&&i.filter((e=>e.section===t))){const e=i.find((e=>e.section===t));if(e)return e.visibility}return"inline"}return r}function l(e,t){const n=a();if(!n)return!1;return s(n.getFormat().page_section_visibility,e)===t}function c(e){const t=a();if(!t)return!0;return"section_show"===s(t.getFormat().page_section_visibility,e)}function d(){const{mainEditorCurrentBlockStore:e}=r.default.state,t=i.default.state.open&&i.default.state.target||e;return null==t?void 0:t.getAssociatedCollectionStore()}function u(){const e=d();if(!e)return!1;const t=e.getParentBlockStore();return Boolean(t&&(t.isLocked()||t.isNavigableAncestorLocked()))}function p(e){const{propertySchema:t}=e,{type:n}=t,r=(0,o.eb)(t);return!(["created_time","created_by","last_edited_time","last_edited_by"].includes(n)||r)}},41056:(e,t,n)=>{n.d(t,{H:()=>a,u:()=>s});var o=n(49085),r=n(53877);const i=new Map;function a(e){if(!i.has(e)){const t=o.default.createValue((()=>(0,r.Uu)(e)));i.set(e,t)}return i.get(e).state}function s(){for(const[e,t]of i){const n=(0,r.Uu)(e);t.state.equals(n)||t.setState(n)}}},21969:(e,t,n)=>{n.d(t,{H:()=>a,W:()=>i});var o=n(80310),r=n(64002);function i(e){const t=(0,r.Qc)(e);return t.query[o.JF]="true",(0,r.bf)({url:(0,r.WU)(t),query:t.query,hash:t.hash||void 0})}function a(e){const t=(0,r.Qc)((0,r.T1)(e));return t.query[o.f6]="true",(0,r.bf)({url:(0,r.WU)(t),query:t.query,hash:t.hash||void 0})}},74503:(e,t,n)=>{async function o(){const e={};if(!window.__isElectron)return{};const t=window.__desktopDeviceInfo;if(t)e.desktopOsVersion=t.os,e.desktopKernelVersion=t.kernel,e.desktopElectronVersion=t.electron,e.desktopChromiumVersion=t.chromium,e.desktopArch=t.arch,e.desktopPlatform=t.platform;else{const t=["architecture","fullVersionList","platformVersion"],o=await navigator.userAgentData.getHighEntropyValues(t);e.desktopArch="arm"===(n=o.architecture)?"arm64":n,e.desktopOsVersion=o.platformVersion,e.desktopPlatform=window.__platform;const r=navigator.userAgent.match(/Chrome\/([\d.]+)/);e.desktopChromiumVersion=r?r[1]:"Unknown";const i=navigator.userAgent.match(/Electron\/([\d.]+)/);e.desktopElectronVersion=i?i[1]:"Unknown"}var n;return e}n.r(t),n.d(t,{getDesktopDeviceInfo:()=>o})},71776:(e,t,n)=>{n.d(t,{$Z:()=>s,GU:()=>i,OS:()=>l,cr:()=>a});n(57658);var o=n(77420),r=n(9844);function i(e){const{ids:t,table:n,userStore:o}=e,r=[];for(const i of t){const e=o.getRecordModel({id:i,table:n});e&&r.push(e)}return a(r)}function a(e){return e.slice().sort(((e,t)=>t.created_at-e.created_at))}const s=["all","internal","public"],l={[o.cZ]:"internal",[r.K2]:"public"}},25898:(e,t,n)=>{function o(e,t,n,o){return Math.sqrt((e-n)*(e-n)+(t-o)*(t-o))}n.d(t,{Z:()=>o})},62619:(e,t,n)=>{n.d(t,{Gs:()=>a,IL:()=>p,OW:()=>u,UG:()=>i,kA:()=>m,kK:()=>s,kd:()=>c,oG:()=>d,r3:()=>f,sh:()=>l});n(57658);var o=n(15095),r=n(72126);function i(e){try{return Boolean(e&&void 0!==e.nodeType)}catch(t){return!1}}function a(e){return i(e)&&e.nodeType===Node.TEXT_NODE}function s(e){return i(e)&&e.nodeType===Node.ELEMENT_NODE}function l(e,t){for(;i(e)&&!t(e);)e=e.parentNode;return e}function c(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(i(e)){for(const n of o.p4(e.childNodes))a(n)?t.push(n):n.childNodes&&c(n,t);return t}return[]}const d=function(e,t){return i(e)&&i(t)?r.cx(e.childNodes,(e=>e===t)):-1},u=(()=>{if("undefined"==typeof window)return!0;if(window.InputEvent&&"function"==typeof window.InputEvent.prototype.getTargetRanges)return!0;const e=window.document.createElement("div");e.contentEditable="true";return"onbeforeinput"in e})(),p=e=>{!u&&e.preventDefault&&e.preventDefault()};function m(e){return"inputType"in e}function f(e,t){return e!==t&&e.contains(t)}},43045:(e,t,n)=>{let o;n.d(t,{N:()=>a});let r=!1;function i(){r||(r=!0,window.requestAnimationFrame((()=>{r=!1,(o||(o=document.createElement("div"),o.style.position="fixed",o.style.top="-9999px",o.style.left="-9999px",o.style.zIndex="-9999",document.body.appendChild(o)),o).style.height=`${Math.random()}px`})))}function a(){const e=window.getSelection();e&&e.anchorNode&&i()}},63085:(e,t,n)=>{n.d(t,{bf:()=>S,kl:()=>k,NX:()=>_,sj:()=>y,W4:()=>m,id:()=>g,cJ:()=>h,I$:()=>w,YG:()=>b});n(21703);var o=n(80951),r=n(68626);n(57658);var i=n(29477),a=n(64002),s=n(95477),l=n(77080),c=n(24608);const d=3,u=1e4;async function p(e){const{environment:t,sourceURL:n}=e;let o;o=`https://embed.notion.co/api/iframely?key=${s.default.iframely_prod.key}&url=${n}`;const a={environment:t,method:"GET",url:o,format:"json"},{result:l}=await i.W(d,u,(()=>(0,c.ZP)(a)));if(l&&"success"===l.type)return function(e){const t=e;return Object.keys(e).forEach((n=>{if("meta"===n&&(e[n].title&&(t.title=e[n].title),e[n].description&&(t.description=e[n].description),e[n].site&&(t.provider_name=e[n].site)),"url"===n&&(t.url=e[n]),"links"===n){if(e[n].thumbnail&&e[n].thumbnail.length>0){t.images=[];const o={width:Number,height:Number,url:String};o.width=e[n].thumbnail[0].media&&e[n].thumbnail[0].media.width?e[n].thumbnail[0].media.width:480,o.height=e[n].thumbnail[0].media&&e[n].thumbnail[0].media.height?e[n].thumbnail[0].media.height:1080,o.url=e[n].thumbnail[0]&&e[n].thumbnail[0].href?e[n].thumbnail[0].href:"",t.images.push(o)}e[n].icon&&e[n].icon.length>0&&(t.favicon_url=e[n].icon[0].href)}})),t}(l.data);r.log({level:"error",from:"embedHelpers",type:"getExtractedData",error:null==l?void 0:l.error,data:{miscDataToConvertToString:{provider:"iframely"}}})}async function m(e,t){const n=encodeURIComponent(t.trim());return"on"===l.default.getEligibleGroup({experimentId:"iframely_switch",defaultGroup:"control"})?await p({environment:e,sourceURL:n}):await async function(e,t){const n={environment:e,method:"GET",url:`https://api.embed.ly/1/extract?key=${s.default.embedly.key}&url=${t}`,format:"json"},{result:o}=await i.W(d,u,(()=>(0,c.ZP)(n)));if(o&&"success"===o.type)return o.data;r.log({level:"error",from:"embedHelpers",type:"getExtractedData",error:null==o?void 0:o.error,data:{miscDataToConvertToString:{provider:"embedly"}}})}(e,n)}const f=/(\/d\/|id=)([-\w]{25,})/;function g(e){const t=e.match(f);if(t&&!(t.length<3))return t[2]}function h(e){return o.zB(e.store.getProperties().source)||e.source}const v=new Set(["http:","https:","blob:","data:"]),b=function(e){const t=new URL(e,s.default.domainBaseUrl).protocol;return v.has(t)};function y(e){if(e&&e instanceof S)return{type:"invalid_protocol",protocol:e.protocol}}function _(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.location.protocol;const n=w(e);if(!n)return{type:"invalid_url",source:e};const o=new URL(n).protocol;return"https:"===t&&"http:"===o?{type:"invalid_protocol",protocol:o}:void 0}class S extends Error{constructor(e){const t=new URL(e,s.default.domainBaseUrl).protocol;super(`Invalid URL protocol: "${t}"`),this.name=void 0,this.protocol=void 0,this.protocol=t,this.name="InvalidUrlProtocolError"}}function w(e){let t=a.yn(e);if(t||e.includes(":")||(t=a.yn(`https:${e}`)),t&&new URL(t).origin!==location.origin)return t}function k(e){const{aspectRatio:t,isFullWidth:n,isFullHeight:o,preserveScale:r,height:i}=e,a={position:"relative",display:"flex",justifyContent:"center",width:"100%",minHeight:100};return o?(a.height="100%",a.position=void 0):n||!r?a.height=i:(a.height=0,a.paddingBottom=100*(t||.75)+"%"),a}},83631:(e,t,n)=>{n.d(t,{D9:()=>b,JT:()=>k,Jf:()=>I,ND:()=>y,TJ:()=>S,Xu:()=>_,bc:()=>v,by:()=>w,nk:()=>C,qZ:()=>x});var o=n(41892),r=n(98923),i=n(15095),a=n(65454),s=n(72126),l=n(70203),c=n(44805),d=n(97880),u=n(63143),p=n(36610),m=n(62619),f=n(68056),g=n(89224),h=n(89086);function v(){return(0,a.ZP)(o.Z.katex.katexMinCss,{resourceType:a._g.Stylesheet})}function b(e){const{source:t,currentEquationToken:n,selectedText:o}=e;return"rich_text_menu"===t?n?{type:"edit",source:t}:{type:"create",source:t,selection:!0}:"input_keyboard_shortcut"===t?n?{type:"edit",source:t}:{type:"create",source:t,selection:Boolean(o)}:"slash_menu"===t?{type:"create",source:t,selection:!1}:"click_token"===t||"arrow_keys"===t?{type:"edit",source:t}:"text_filter"===t?{type:"create",source:t,selection:!0}:void(0,d.t1)(t)}function y(e){const{environment:t,equation:n,from:o}=e;p.iA(t,{equation:n,equationNewlineCount:n.split("\n").length-1,equationBackslashCount:n.split("\\").length-1,equationLength:i.p4(n).length,from:o})}function _(e){return m.kK(e)&&e.classList.contains(c.et)}function S(e){const{selection:t,environment:n}=e,o=g.getRect(t);if(!o){return m.sh(t.startContainer,m.kK).getBoundingClientRect()}if(n.device.isChrome){const e=t.startContainer.childNodes[t.startOffset];return e&&_(e)?e.getBoundingClientRect():m.kK(t.startContainer)?new DOMRect(o.left,o.top,o.width,t.startContainer.getBoundingClientRect().height):new DOMRect(o.left,o.top,o.width,22)}return o}function w(e){const{environment:t,equation:n,displayMode:o}=e,i=t.KatexStore.getKatex();return i&&(0,r.CY)({katex:i,equation:n,options:{displayMode:"block"===o}}).error}function k(e){if("editing"!==e.mode)return;const t=(0,f.QY)(e.multiSelection);if(!t)return;const{store:n,selection:o}=t,{tokensBeforeRange:r,tokensInsideRange:i}=l.xrQ(n.getValue(),o.startIndex,o.endIndex);let a=s.Sm(r.map(l.J1x));for(const s of i){const e=l.J1x(s),t={startIndex:a,endIndex:a+e};if(l.YrK(s))return{token:s,position:t};a+=e}}function I(e){let t=e;for(let n=0;n<2;n+=1){const e=/^\$(.*)\$$/m.exec(t);if(!e||!e[1])break;t=e[1]}return t}function C(e){const t=(0,f.QY)(e.multiSelection);if(!t)return[];const{selection:n,store:o}=t,r=o.getValue();if(!r)return[];const i=h.wd(n)&&n.startIndex>0?[n.startIndex-1]:[n.startIndex];return h.oc(i,r)[0]||[]}function x(e){const{equationState:t,isTemporary:n}=e,o=t.editingToken?u.uh(l.hDy(t.editingToken),(e=>l.kuv(e)||l.QVC(e))):u.uh(t.annotations,(e=>l.kuv(e)||l.QVC(e)||l.ZAl(e))),r=s.oA([n&&l.W9d(),...o]);return l.qZ6(t.value,r)}},73744:(e,t,n)=>{n.d(t,{DJ:()=>a,ZV:()=>i,lj:()=>r});let o=!1;try{const e=Object.defineProperty({},"passive",{get:function(){o=!0}});window.addEventListener("test",(()=>{}),e)}catch(s){}const r=function(e,t,n,r){o?e.addEventListener(t,n,{passive:!0,capture:Boolean(r)}):e.addEventListener(t,n,Boolean(r))},i=function(e,t,n,o){e.removeEventListener(t,n,Boolean(o))};function a(e){if(void 0!==e)return"shiftKey"in e&&"altKey"in e&&e.shiftKey&&e.altKey?"window":"metaKey"in e&&e.metaKey||"ctrlKey"in e&&e.ctrlKey?"tab":void 0}},41232:(e,t,n)=>{n.d(t,{GQ:()=>f,Ue:()=>m,Xg:()=>b,_F:()=>h,_l:()=>g,o$:()=>y,pI:()=>v,y6:()=>p});var o=n(17215),r=n(78601),i=n(2864),a=n(97880),s=n(44876),l=n(80444),c=n(77080),d=n(30874),u=n(40671);function p(e){if(e.isCollectionView()){var t,n;if(null===(t=e.getCollectionViewCollectionStore())||void 0===t||!t.isSyncedCollection())return;return null===(n=e.getCollectionViewCollectionStore())||void 0===n?void 0:n.getFormat()}return e.getFormat()}function m(e,t){const n=d.Z.state;if(!e||!n.loaded)return[];const o=(0,s.ny)({url:e,integrations:d.Z.integrations.state,currentSpaceId:t});return"success"!==o.type?[]:n.bots.filter((e=>e.integration_id===o.integration.id))}function f(e,t){if(!e)return;const n=(0,s.ny)({url:e,integrations:d.Z.integrations.state,currentSpaceId:t});return"success"===n.type?n:void 0}function g(e){const{store:t,isInDarkMode:n}=e,r=p(t);if(null!=r&&r.is_placeholder||null!=r&&r.error){const e=d.Z.integrations.state.find((e=>{let{id:t}=e;return r.integration_id===t}));if(e){const t=d.Z.bots.state.filter((t=>t.integration_id===e.id)).map((e=>{let{id:t}=e;return t})),{icon:a,dark_icon:c,accent_color:u,accent_icon:p}=e.info,m=n&&c?c:a;if(!m||!u||!p)return;const f=r.original_url;let g;if(f){var i;const t=(0,s.ny)({url:f,integrations:[e],currentSpaceId:null===(i=l.default.state.currentSpaceStore)||void 0===i?void 0:i.id});"success"===t.type&&(g=t.pattern)}return{type:null!=r&&r.is_placeholder?"placeholder":"error",userHasBotForIntegration:t.length>0,renderConfig:{headerAttributes:[{formatter:o.V1.placeholder,attribute:{id:"title",name:"Title",type:"inline",values:[e.name],format:{type:"title"}}}]},action:f&&!g?"error":void 0,updating:!1,originalUrl:f,pattern:g,integration:{id:e.id,icon:m,name:e.name,accentColor:u,accentIcon:p},botIds:t}}}return h({...e,getRenderFn:e=>e.block})}function h(e){var t;const{store:n,isInDarkMode:o,canEdit:i,currentUserId:c,showAction:d,getRenderFn:g}=e,h=p(n);if(!h||h.is_placeholder)return;if(void 0===h.external_object_id&&void 0!==h.uri)return;const v=h.original_url||h.uri;if(!n.isDefined())return;const b=f(v,n.getSpaceId()??(null===(t=l.default.state.currentSpaceStore)||void 0===t?void 0:t.id));if(!v||!b)return;const y=m(v,n.getSpaceId()),_=y.length>0,S=n.getExternalObjectSubInstanceStores(),w=S.map((e=>e.getFormat())).filter(a.$K);if(w.length!==S.length)return;const{integration:k,pattern:I}=b,{icon:C,dark_icon:x,accent_color:T,accent_icon:M}=k.info,P=o&&x?x:C;if(!P||!T||!M)return;const A=(0,r.U)(I.name),R=(0,s.Tf)({url:v,integration:k}),D=g(A)({integrationIcon:P,root:h,relations:w,parsedAttributes:R});if(!D)return;const E=u.Z.state.updatingUrls.has(v),B=Date.now(),F=Boolean(n.getCreatedById()!==c&&n.getCreatedTime()&&B-n.getCreatedTime()<6e4);let O;return!E&&i&&c&&(d?O=d:h.error?O="error":(null==h||!h.stale)&&h.attributes||F||(O=_?"update":"authenticate")),{type:"active",renderConfig:D,action:O,updating:E,originalUrl:v,integration:{id:k.id,icon:P,name:k.name,accentColor:T,accentIcon:M},pattern:I,userHasBotForIntegration:_,botIds:y.map((e=>{let{id:t}=e;return t}))}}function v(e,t){if(!t)return e;const n=f(e,t);return"success"!==(null==n?void 0:n.type)?e:(0,i.l)({url:e,integration:n.integration,pattern:n.pattern})}function b(){return"on"===c.default.getEligibleGroup({experimentId:"link_preview_resizing",defaultGroup:"control"})}function y(){return"on"===c.default.getEligibleGroup({experimentId:"link_preview_resizing_api",defaultGroup:"control"})}},6398:(e,t,n)=>{n.d(t,{hx:()=>U,lf:()=>O,ox:()=>B,r4:()=>F,t9:()=>Z});var o=n(67294),r=n(13991),i=n(480),a=n(86628),s=n(24405),l=n(6906),c=n(17397),d=n(8848),u=n(84619),p=n(7057),m=n(53877),f=n(42875),g=n(19233),h=n(97880),v=n(82990),b=n(44876),y=n(9291),_=n(62896),S=n(51077),w=n(56496),k=n(12981),I=n(81865),C=n(65085),x=n(85567),T=n(60682),M=n(77907),P=n(14976),A=n(33929),R=n(85893);function D(e){window.__c={n:"ExternalObjectInstanceAttributeToken"};const{title:t,color:n,icon:o}=e,r=(0,s.Fg)(),i=n?(0,d.MJ)(`rgb(${n.r},${n.g},${n.b})`):void 0,a=(0,d.KR)(r,i);return(0,R.jsx)(x.Z,{format:u.lo.Medium,value:o?(0,R.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[(0,R.jsx)(I.Z,{isAuthenticated:!1,url:o,width:32,render:(e,t)=>(0,R.jsx)(k.Z,{src:t,height:12,placeholderLoadedStyle:{width:12,height:12,marginRight:4}})}),(0,R.jsx)(_.Z,{children:(0,l.Z)(t)})]}):(0,R.jsx)(_.Z,{children:(0,l.Z)(t)}),showRemoveButton:!1,color:a.textColor,backgroundColor:a.backgroundColor,isSingle:!0,style:{display:"flex",whiteSpace:"break-spaces",flex:"0 0 auto"}})}function E(e){var t,n,o;window.__c={n:"ExternalObjectInstanceRelation"};const{uri:r,store:i,...s}=e,l=(0,a.VK)((()=>{const e=i.getExternalObjectSubInstanceStores().find((e=>{const t=e.getKeyStore("format").getKeyStore("uri").getValue();return t&&t===r}));if(e)return e.getFormat()}),[i,r]);if(!l)return null;const c=null===(t=l.attributes)||void 0===t?void 0:t.find(b.Id),d=null===(n=l.attributes)||void 0===n?void 0:n.find(b.li),u=null===(o=l.attributes)||void 0===o?void 0:o.find(b.hW);return c?u?(0,R.jsx)(D,{title:c.values[0],color:u.values[0],icon:null==d?void 0:d.values[0]}):c?(0,R.jsxs)("span",{style:{display:"flex",alignItems:"center"},children:[d&&(0,R.jsx)(S.Z,{type:"image_url",imageURL:d.values[0],size:16,style:{marginRight:4},imageStyle:s.avatarStyle}),(0,R.jsx)(B,{attribute:c,store:i,...s})]},r):null:null}function B(e){window.__c={n:"ExternalObjectInstanceAttribute"};const{attribute:t,formatter:n,store:o,style:r,avatarStyle:i}=e,a=(0,s.Fg)();if((0,b.Id)(t)){var l;const e=t.values[0];if("enum"===(null===(l=t.format)||void 0===l?void 0:l.type)){const{color:n}=t.format;return(0,R.jsx)(D,{title:e,color:n})}{const t=e.replace(/[\r\n]/g,"").trim(),o=n?A.default.formatMessage(n,{value:t}):t;return(0,R.jsx)("div",{spellCheck:!1,style:{whiteSpace:"nowrap",color:a.mediumTextColor,...r},children:o})}}if((0,b.OM)(t))return(0,R.jsx)(E,{uri:t.values[0],store:o,style:r,avatarStyle:i});if((0,b.Gc)(t))return(0,R.jsx)(F,{attribute:t,formatter:e.formatter,style:e.style,dateStyle:"relative"});if((0,b.An)(t)){const e=t.values[0];return(0,R.jsx)("div",{style:{color:a.mediumTextColor,fontSize:12,...r},children:n?A.default.formatMessage(n,{value:e}):String(e)})}return null}function F(e){window.__c={n:"ExternalObjectInstanceDateAttribute"};const{attribute:t,formatter:n,style:o,dateStyle:i}=e,a=(0,y.useIntl)(),l=(0,s.Fg)(),c=t.values[0];let d;if("datetimerange"===c.type)d=(0,p.ZV)({allowRelativeDates:!1,displayInUserTimezone:!0,intl:a,value:c});else{const e=(0,m.uO)(c,(0,f.r)());i&&"relative"!==i?"exact_time"===i?d=(0,p.Yx)(e,"medium_with_time",r.SP):"exact_date"===i?d=(0,p.Yx)(e,"medium",r.SP):(0,h.t1)(i):d=(0,p.tv)(e,r.SP)}const u=n?A.default.formatMessage(n,{value:d}):d;return(0,R.jsx)("div",{style:{color:l.mediumTextColor,fontSize:12,whiteSpace:"nowrap",...o},children:u})}function O(e){window.__c={n:"ExternalObjectInstanceIconAttribute"};const t=(0,s.Fg)(),{attribute:n,isSmall:o}=e,r=o?22:34,i={...e.style,borderRadius:r,boxShadow:t.avatarBoxShadow};return(0,b.li)(n)?(0,R.jsx)(S.Z,{type:"image_url",imageURL:n.values[0],size:r,imageStyle:i}):(0,b.Id)(n)?(0,R.jsx)("div",{style:{...i,borderRadius:r,overflow:"hidden",boxShadow:t.avatarBoxShadow,height:30,width:30},children:(0,R.jsx)(w.Z,{size:r,title:n.values[0]})}):null}function Z(e){var t;window.__c={n:"ExternalObjectInstanceCodeBodyAttribute"};const{attribute:n}=e,{value:i}=(0,M.useDependency)(M.deps.prismjs),a=o.useRef(null),l=(0,s.yK)((e=>({text:{flexGrow:1,flexShrink:1,textAlign:"left",fontFamily:v.Z.getCompositeFontFamily(r.SP).githubMono,fontSize:"85%",tabSize:2,minHeight:"1em"},buttons:{fontWeight:v.Z.fontWeight.medium}})),[]);return o.useEffect((()=>{var e;i&&a.current&&(a.current.innerHTML=function(e,t,n){if(n&&(0,c.L9)(n)){const o=g.W[n];return e.highlight(t,e.languages[o],n)}return`<code>${t}</code>`}(i,n.values[0],null===(e=n.format)||void 0===e?void 0:e.language))}),[i,null===(t=n.format)||void 0===t?void 0:t.language,n.values]),i?(0,R.jsx)("div",{style:{marginRight:4,marginBottom:4,width:"100%"},children:(0,R.jsx)(C.Z,{moreElement:(0,R.jsxs)(R.Fragment,{children:["…"," ",(0,R.jsx)("span",{style:{...l.text,...l.buttons},children:(0,R.jsx)(y.FormattedMessage,{id:"externalObjectInstance.bodyAttribute.moreLabel",defaultMessage:"more"})})]}),lessElement:(0,R.jsx)(R.Fragment,{children:(0,R.jsx)("span",{style:{...l.text,...l.buttons},children:(0,R.jsx)(y.FormattedMessage,{id:"externalObjectInstance.bodyAttribute.showLessLabel",defaultMessage:"show less"})})}),maxLines:8,children:(0,R.jsx)("div",{spellCheck:!1,style:l.text,ref:a})})}):null}function V(e){window.__c={n:"GetText"};const{attribute:t,store:n}=e,o=(0,s.Fg)(),r=(0,i.O7)(),l=(0,a.VK)((()=>(0,b.Id)(t)?t.values[0]:(0,P.IY)({environment:r,textValue:{value:t.values,spaceId:n.id},disableHover:!0,disableStyleAnnotations:!1,disableInsertedDeletedAnnotations:!1,disableDateStyleAnnotations:!1,disableLinks:!1,disabled:!1,katex:r.KatexStore.getKatex(),parentStore:n,emojiType:(0,T.e_)(r),formulaValueTypes:[],theme:o})),[r,n,o,t]);return(0,R.jsx)("div",{children:l})}function U(e){window.__c={n:"ExternalObjectInstanceStringBodyAttribute"};const t=(0,s.yK)((e=>({text:{color:e.regularTextColor,fontSize:12,lineHeight:1.45},buttons:{fontWeight:v.Z.fontWeight.medium}})),[]);return(0,R.jsx)("div",{style:{marginRight:4,marginBottom:4,width:"100%"},children:(0,R.jsx)(C.Z,{moreElement:(0,R.jsxs)(R.Fragment,{children:["…"," ",(0,R.jsx)("span",{style:{...t.text,...t.buttons},children:(0,R.jsx)(y.FormattedMessage,{id:"externalObjectInstance.bodyAttribute.moreLabel",defaultMessage:"more"})})]}),lessElement:(0,R.jsx)(R.Fragment,{children:(0,R.jsx)("span",{style:{...t.text,...t.buttons},children:(0,R.jsx)(y.FormattedMessage,{id:"externalObjectInstance.bodyAttribute.showLessLabel",defaultMessage:"show less"})})}),maxLines:3,children:(0,R.jsx)("div",{spellCheck:!1,style:t.text,children:(0,R.jsx)(V,{attribute:e.attribute,store:e.store})})})})}},69988:(e,t,n)=>{n.d(t,{LX:()=>c,Vu:()=>d,XT:()=>p,ZP:()=>m,fe:()=>u,il:()=>l});n(57658);var o=n(72126),r=n(92338),i=n(63143);function a(e){const t=[];let n=!1,o=e;for(;""!==o;){const e=n?r.dK:r.Um,i=o.indexOf(e);if(-1===i)return t.push(s(o,!1)),t;const a=o.substring(0,i),l=o.slice(i+e.length);""!==a&&t.push(s(a,n)),o=l,n=!n}return t}function s(e,t){return t?[e,"highlight"]:[e]}function l(e){return 2===e.length&&"highlight"===e[1]}function c(e){return e[0]}function d(e){return e.reduce(((e,t)=>{if(0===e.length)return[t];const n=e[e.length-1];return l(n)===l(t)?[...e.slice(0,e.length-1),s(c(n)+c(t),l(t))]:[...e,t]}),[])}function u(e){if(!e)return[];let t=a(e);t.some((e=>l(e)&&1===c(e).length))&&(t=d(t));const n=t.filter(l).map(c);return o.jj(n)}function p(e){const{text:t,patterns:n,uniqueTokenHighlighterContext:r}=e,a=o.jj(n.filter((e=>e.length>0)));if(0===a.length)return[s(t,!1)];const l=o.MR(a,(e=>-e.length)).map(o.hr);return function(e,t,n){const o=(0,i.uO)(t,e);if(0===o.length)return[s(e,!1)];let r=0;const a=[];for(let i=0;i<o.length;i++){const t=o[i];if(!t)continue;let l;void 0===n||!n.has(t[0].toLowerCase())?(void 0!==n&&n.add(t[0].toLowerCase()),r!==t.index&&a.push(s(e.slice(r,t.index),!1)),a.push(s(t[0],!0)),l=t.index+t[0].length):l=r;o[i+1]||l===e.length||a.push(s(e.slice(l),!1)),r=l}return a}(t,new RegExp(l.join("|"),"ig"),r)}const m=a},44486:(e,t,n)=>{n.d(t,{W:()=>i});var o=n(41432),r=n(79797);function i(e){return e.findRecordStoreUIAncestor((e=>e instanceof r.G&&e.getType()===o.Ti.factory)).ancestor}},79897:(e,t,n)=>{n.d(t,{A3:()=>c,rf:()=>l});var o=n(67294),r=n(72126),i=n(80444),a=n(81236),s=n(48779);function l(e){const{currentUserRootStore:t}=i.default.state,n=null==t?void 0:t.getSpaceViewStores(),o=r.oA(null==n?void 0:n.map((e=>e.getSpaceId()))).map((t=>a.Z.getPublicSpaceData(e,t))),l=function(e){const t=e.map((e=>(0,s.cD)(e))),n=new Set(r.oA(t));return n.has("enterprise")?"enterprise":n.has("business")?"business":n.has("plus")?"plus":n.has("team_free")?"team_free":n.has("student")?"student":n.has("personal")?"personal":n.has("personal_free")?"personal_free":(n.has("free"),"free")}(o);return{userHighestPlanType:l,isSalesAssistedPlan:r.hX(o,{subscriptionTier:l}).some((e=>{if("none"!==(null==e?void 0:e.role)&&!0===(null==e?void 0:e.is_sales_assisted))return!0}))}}function c(){const[e,t]=(0,o.useState)(!1);return(0,o.useEffect)((()=>{function e(e){var n,o;"forethoughtWidgetOpened"===(null==e||null===(n=e.data)||void 0===n?void 0:n.event)?t(!0):"forethoughtWidgetClosed"===(null==e||null===(o=e.data)||void 0===o?void 0:o.event)&&t(!1)}return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}})),e}},19306:(e,t,n)=>{n.d(t,{W:()=>a});var o=n(9291),r=n(33929);const i=(0,o.defineMessages)({twoItems:{id:"formatSettings.twoItems",defaultMessage:"{item1} and {item2}"},threeOrMoreItems:{id:"formatSettings.threeOrMoreItems",defaultMessage:"{item1}, and {numberOfOther} others"},twoItemsWithAmpersand:{id:"formatSettings.twoItems.withAmpersand",defaultMessage:"{item1} & {item2}"},threeOrMoreItemsWithRemoveComma:{id:"formatSettings.threeOrMoreItems.withRemoveComma",defaultMessage:"{item1} and {numberOfOther} others"},threeOrMoreItemsWithAmpersand:{id:"formatSettings.threeOrMoreItems.withAmpersand",defaultMessage:"{item1}, & {numberOfOther} others"},threeOrMoreItemsWithAmpersandAndRemoveComma:{id:"formatSettings.threeOrMoreItems.withAmpersandAndRemoveComma",defaultMessage:"{item1} & {numberOfOther} others"}});function a(e,t){const{removeComma:n,useAmpersand:o}=t||{};if(0===e.length)return"";const a=e[0];if(1===e.length)return a;const s=e[1];if(2===e.length)return o?r.default.formatMessage(i.twoItemsWithAmpersand,{item1:a,item2:s}):r.default.formatMessage(i.twoItems,{item1:a,item2:s});const l=e.length-1;return o?n?r.default.formatMessage(i.threeOrMoreItemsWithAmpersandAndRemoveComma,{item1:a,numberOfOther:l}):r.default.formatMessage(i.threeOrMoreItemsWithAmpersand,{item1:a,numberOfOther:l}):r.default.formatMessage(i.threeOrMoreItems,{item1:a,numberOfOther:l})}},35683:(e,t,n)=>{n.d(t,{uP:()=>c,_R:()=>u,vu:()=>l});n(57658);var o=n(30120),r=(n(21703),n(30541),n(7406));const i=class{constructor(e){let{maxSize:t,prefix:n,store:o,version:r}=e;this.prefix=void 0,this.maxSize=void 0,this.store=void 0,this.version=void 0,this.serializedKeys=void 0,this.namespace=void 0,this.lastVersion=void 0,this.createInternalKey=e=>`${this.namespace}${e}`,this.maxSize=t,this.prefix=n,this.store=o,this.version=r.toString(),this.namespace=`${n}:${r}::`,this.serializedKeys=`${n}:${r}:keys`,this.lastVersion=`${n}:version`}set(e,t){try{this.setInternal(e,t),this.promote(e)}catch(n){return{error:(0,r.tg)(n)}}return{value:void 0}}get(e){try{const t=this.getInternal(e);if(null!==t)return{value:t}}catch(t){return{error:(0,r.tg)(t)}}return{value:void 0}}remove(e){try{this.getKeys().indexOf(e)>-1&&(this.removeInternal(e),this.evict(e))}catch(t){return{error:(0,r.tg)(t)}}return{value:void 0}}clear(){try{const e=this.getKeys();for(const t of e)this.removeInternal(t);this.setKeys([])}catch(e){return{error:(0,r.tg)(e)}}return{value:void 0}}scan(e){try{const t=this.getKeys();for(const n of t){const t=this.getInternal(n);if(null===t)throw new Error(`Item not found: ${n}`);e(n,t)}}catch(t){return{error:(0,r.tg)(t)}}return{value:void 0}}entries(){const e=[],t=this.scan(((t,n)=>{e.push([t,n])}));return t.error?{error:t.error}:{value:e}}keys(){try{return{value:this.getKeys()}}catch(e){return{error:(0,r.tg)(e)}}}slowGC(){const e=[],t=e=>e!==this.serializedKeys&&(!!e.endsWith("keys")&&this.isOldKey(e));for(let n=0;n<this.store.length;n+=1){const o=this.store.key(n);null!==o&&((this.isOldKey(o)||t(o))&&e.push(o))}for(const n of e)this.store.removeItem(n)}updateVersionAndGC(){const e=this.store.getItem(this.lastVersion);if(null!==e){const t=parseInt(e,10),n=parseInt(this.version,10),o=!Number.isNaN(t),r=!Number.isNaN(n);o&&r&&t<n&&this.slowGC()}this.store.setItem(this.lastVersion,this.version)}isOldKey(e){if(!e.startsWith(`${this.prefix}:`))return!1;const t=e.substring(`${this.prefix}:`.length),n=parseInt(t,10);if(Number.isNaN(n))return!1;return n<parseInt(this.version,10)}getKeys(){const e=this.store.getItem(this.serializedKeys);if(null===e)return[];const t=JSON.parse(e);return Array.isArray(t)?t:[]}setKeys(e){const t=JSON.stringify(e);this.store.setItem(this.serializedKeys,t)}promote(e){const t=this.getKeys(),n=t.indexOf(e);if(n>-1)t.splice(n,1),t.unshift(e);else if(t.unshift(e),t.length>this.maxSize){const e=t.splice(this.maxSize);for(const t of e)this.removeInternal(t)}this.setKeys(t)}evict(e){const t=this.getKeys(),n=t.indexOf(e);n>-1&&t.splice(n,1),this.setKeys(t)}setInternal(e,t){this.store.setItem(this.createInternalKey(e),JSON.stringify(t))}getInternal(e){const t=this.store.getItem(this.createInternalKey(e));return null===t?null:JSON.parse(t)}removeInternal(e){this.store.removeItem(this.createInternalKey(e))}};var a=n(72126),s=n(97880);let l=function(e){return e.Default="Default",e.Link="Link",e.Favorite="Favorite",e.Search="Search",e}({});const c=3,d={BONUS:{DEFAULT:100,LINK:120,SEARCH:200,FAVORITE:140},BONUS_NORMALIZER:100,TIME_BUCKETS:[{days:4,weight:100},{days:14,weight:70},{days:31,weight:50},{days:90,weight:30}],DEFAULT_BUCKET_WEIGHT:10};class u{constructor(e){var t=this;this.maxStoredVisits=void 0,this.visits=void 0,this.recordVisit=e=>{const{id:t,type:n,timestampForTestingOnly:o}=e,r=this.createVisit(n,o),i=this.visits.get(t);if(i.error)return;const s=i.value||this.createVisitCacheEntry();var l,c,d;s.totalVisits+=1,s.recentVisits=(l=s.recentVisits,c=r,d=this.maxStoredVisits,[...(0,a.pm)(l,d-1),c]),this.visits.set(t,s)},this.getVisits=e=>{const t=this.visits.get(e);if(!t.error)return t.value},this.getVisitedIds=()=>{const e=this.visits.keys();return e.error?[]:e.value},this.getFrecencyScore=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();const r=t.getVisits(e);if(!r)return u.UNVISITED_FRECENCY_SCORE;const{totalVisits:i,recentVisits:c}=r;if(0===i||0===c.length)return u.UNVISITED_FRECENCY_SCORE;const p=c.map((e=>{const{type:t,timestamp:r}=e,i=function(e){const{BONUS:t}=d;switch(e){case l.Default:return t.DEFAULT;case l.Link:return t.LINK;case l.Favorite:return t.FAVORITE;case l.Search:return t.SEARCH;default:(0,s.t1)(e)}}(t),a=function(e,t){const{TIME_BUCKETS:n,DEFAULT_BUCKET_WEIGHT:r}=d,i=o.ou.fromMillis(e).diff(o.ou.fromMillis(t),"days").get("days");return i<=n[0].days?n[0].weight:i<=n[1].days?n[1].weight:i<=n[2].days?n[2].weight:i<=n[3].days?n[3].weight:r}(n,r);return a*(i/d.BONUS_NORMALIZER)})),m=(0,a.Sm)(p)/p.length;return Math.ceil(i*m)};const{maxBlocks:n,maxStoredVisits:r,store:c,version:p}=e;this.maxStoredVisits=r,this.visits=new i({prefix:e.prefix||"FrecencyStore",maxSize:n,store:c,version:p})}initialize(){this.visits.updateVersionAndGC()}sortFrecencyHighToLow(e){const{items:t,now:n,recordFrecency:o}=e;return(0,a.MR)(t,(e=>{const t="number"==typeof e.score?e.score:1,r=this.getFrecencyScore(e.id,n);o&&(e.frecencyScore=r);const i=e.personalizationBoost??1;return-1*t*Math.max(r,i)}))}createVisitCacheEntry(){return{totalVisits:0,recentVisits:[]}}createVisit(e,t){return{type:e,timestamp:"number"==typeof t?t:Date.now()}}clear(){const e=[];this.visits.scan((t=>e.push(t)));for(const t of e)this.visits.remove(t)}}u.UNVISITED_FRECENCY_SCORE=1},8989:(e,t,n)=>{n.d(t,{RT:()=>a,bk:()=>s,tt:()=>i});var o=n(77080),r=n(72340);function i(){return"on"===o.default.getEligibleGroup({experimentId:"generic_importer",defaultGroup:"control"})}function a(){return o.default.checkGate("zip_importer_enabled")}function s(e){const t=o.default.getEligibleGroup({experimentId:"special_case_generic_file_size",defaultGroup:r.CN.toString()});return Number(t)}},84210:(e,t,n)=>{n.d(t,{Hu:()=>u,ZP:()=>p});var o=n(1800),r=n(15157),i=n(63306),a=(n(64002),n(95477)),s=n(80444),l=n(77556),c=n(88923),d=n(98165);function u(e){e={fullyQualified:!0,...e};const{store:t,collectionViewId:n,showMoveTo:u,saveParent:p,preferPublicLink:m,duplicate:f,getSpaceDomain:g,pageVisitSource:h,queryId:v}=e;let b;if(n)b=n;else if(t&&t.isCollectionView()){const e=r.Z.get({userId:t.environment.currentUser.id,key:l.Z.getLocalViewPreferenceKey(t.id)});if(e)b=e;else{const e=t.getCollectionViewsStore().getValue();e&&(b=e[0])}}const y=t.getParentSpaceStore(),{currentSpaceStore:_}=s.default.state,S=y||_,w=(0,d.fJ)(t),k=(0,i.$t)(w),I=m&&k?(null==S?void 0:S.getPublicContentDomain())||(null==g?void 0:g()):null==S?void 0:S.getEditDomain();let C=a.default.domainBaseUrl;const x=m&&k&&I;if(x){let e="https:";try{e=new URL(a.default.domainBaseUrl||"").protocol||e}catch{}C=`${e}//${I}.${a.default.publicDomainName}`}let T=t,M=e.scrollToBlockId;if(t.isReady()&&!t.isNavigableBlock()){const e=(0,d.Dg)(t);e&&(T=e,M=t.id)}const P=s.default.state.mainEditorCurrentBlockStore;let A,R,D;return P&&e.openInSidePeek?(A=P,R=T.id,D=(0,c.getUrlParamFromPeekMode)(c.PeekModeSide)):(A=T,R=e.peekViewBlockId,D=e.peekMode),(0,o.Z)({pageId:A.id,pageModel:A.getModel(),pageVisitSource:h,queryId:v,scrollToBlockId:M,peekViewBlockId:R,peekMode:D,collectionViewId:b,discussionId:e.discussionId,spaceDomain:x?void 0:I,baseUrl:e.fullyQualified||m?C:void 0,showMoveTo:u,saveParent:p,duplicate:f,templateGalleryItem:e.templateGalleryItem,projectManagementLaunch:e.projectManagementLaunch})}const p=u},87078:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(15723);const r=function(){const e=document.documentElement;return new o.iL(0,0,e.clientWidth,e.clientHeight)}},28415:(e,t,n)=>{n.d(t,{qH:()=>u,vE:()=>c});var o=n(65454),r=n(99405),i=n(57549),a=n(47839),s=n(95477),l=n(77080);async function c(e){const{environment:t,accessToken:n}=e;if(i.D6(t,{from:e.from}),t.device.isElectron){const t=await a.openGoogleDrivePickerPopup({url:(0,r.zN)(s.default.domainBaseUrl,{token:n})});if(!t)return;"integration"in e?e.callback(!1,t.url):e.callback(t.id)}else await(0,o.ZP)("https://apis.google.com/js/api.js"),"integration"in e?window.gapi.load("picker",(()=>d({environment:t,accessToken:n,callback:e.callback,integration:e.integration}))):window.gapi.load("picker",(()=>d({environment:t,accessToken:n,callback:e.callback})))}function d(e){const{environment:t,accessToken:n}=e,o=`${window.location.protocol}//${window.location.host}`;(new window.google.picker.PickerBuilder).enableFeature(window.google.picker.Feature.SUPPORT_DRIVES).setOAuthToken(n).hideTitleBar().setOrigin(o).addView(new window.google.picker.DocsView).setCallback((n=>{if(n.action===window.google.picker.Action.PICKED&&n.docs&&n.docs.length>0){const o=n.docs[0];"integration"in e?e.callback(!1,o.url):e.callback(o.id),i.D6(t,{from:"link_preview_placeholder"})}})).build().setVisible(!0)}function u(){return"on"===l.default.getEligibleGroup({experimentId:"google_external_integration_file_picker",defaultGroup:"control"})}},12534:(e,t,n)=>{n.d(t,{$0:()=>a,Af:()=>o,Wi:()=>s,ZP:()=>l});let o=function(e){return e[e.ButtonMouseDown=0]="ButtonMouseDown",e[e.EditorMouseDown=1]="EditorMouseDown",e[e.EditorMouseUp=2]="EditorMouseUp",e[e.EditorClick=3]="EditorClick",e[e.MenuListClick=4]="MenuListClick",e[e.EditorContextMenu=5]="EditorContextMenu",e[e.EditorMouseOver=6]="EditorMouseOver",e[e.EditorHoverMouseMove=7]="EditorHoverMouseMove",e[e.EditorDropMouseMove=8]="EditorDropMouseMove",e[e.EditorDoubleClick=9]="EditorDoubleClick",e[e.SidebarMouseMove=10]="SidebarMouseMove",e[e.ManageTeamsRowClick=11]="ManageTeamsRowClick",e[e.MobileTap=12]="MobileTap",e[e.CollectionSettingsClick=13]="CollectionSettingsClick",e[e.BaseTableRowClick=14]="BaseTableRowClick",e[e.NotificationClick=15]="NotificationClick",e[e.CollectionAutomationSettingsClick=16]="CollectionAutomationSettingsClick",e}({});const r={};function i(e){const t=r[e.context],n=e.event.nativeEvent||e.event;if(t!==n){var o;r[e.context]=n;"unhandled"===(null===(o=e.callback)||void 0===o?void 0:o.call(e))&&(r[e.context]=t)}}function a(e){i({event:e,context:o.EditorMouseDown,callback:()=>{}})}function s(e){i({event:e,context:o.EditorClick,callback:()=>{}})}const l=i},87290:(e,t,n)=>{n.d(t,{B:()=>l,x:()=>s});var o=n(55367),r=n(22294),i=n(86486),a=n(27724);let s=function(e){return e[e.Default=0]="Default",e[e.Hovered=1]="Hovered",e[e.Selected=2]="Selected",e[e.SelectedDescendant=3]="SelectedDescendant",e}({});function l(e,t){var n;const l=a.default.state.stores,c=i.default.state;if(1===l.length&&l.includes(e))return s.Selected;if(l.length>0&&l.every((t=>e.uiContains(t))))return s.SelectedDescendant;const d=o.ZP.state;return d&&d.isDragging&&d.currentParentStore&&e.uiContains(d.currentParentStore)||d&&d.isDragging&&d.currentDropZone&&d.currentDropZone.type===o.Dl.Selectable&&null!==(n=d.currentDropZone)&&void 0!==n&&n.store&&e.uiContains(d.currentDropZone.store)||c.isOpen&&c.currentStore===e||t&&!r.Z.state.isKeyboardMode?s.Hovered:s.Default}},49394:(e,t,n)=>{n.d(t,{Je:()=>u,ub:()=>d});n(57658);var o=n(72126),r=n(70203),i=n(44805),a=n(80444),s=n(26842),l=n(95256),c=n(20454);function d(e){const{find:t,textValue:n,intl:d}=e,u=(0,r.Oqk)({textValue:n,substring:t,ignoreCase:!0}).map((e=>({selection:e,allowReplace:!0}))),p=function(e){const{textValue:t,find:n,intl:i}=e,s=(0,r.P0m)(t),d=a.default.state.currentUserStore;if(0===s.length||!d)return[];const u=s.map((e=>{let t,{pointer:o,selection:r}=e;if("notion_user"===o.table)t=c.U.createChildStore(d,o);else{if("bot"!==o.table)return void o.table;t=l.Q.createChildStore(d,o)}if(t.getDisplayName(i).toLowerCase().includes(n.toLowerCase()))return r}));return o.oA(u)}({textValue:n,intl:d,find:t}).map((e=>({selection:e,allowReplace:!1}))),m=(0,r.Un8)({textValue:n,find:t,intl:d}).map((e=>({selection:e,allowReplace:!1}))),f=function(e){const{find:t,textValue:n}=e,l=(0,r.HC)(n),c=a.default.state.currentSpaceStore;if(!c)return[];const d=l.map((e=>{let{pointer:n,selection:o}=e;const a=s.G.createChildStore(c,n);if((0,r.QaF)(a.getTitleValue()).substring(0,i.l0).toLowerCase().includes(t.toLowerCase()))return o}));return o.oA(d)}({textValue:n,find:t}).map((e=>({selection:e,allowReplace:!1})));return[...u,...p,...f,...m]}function u(e){const{block:t,find:n,intl:r}=e,i=[];if("table_row"!==t.getType())return[];const a=t.getProperties();return o.oA(Object.values(a)).forEach((e=>{const t=d({find:n,intl:r,textValue:e});t.length>0&&i.push(...t)})),i}},45023:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(27537),r=n.n(o),i=n(72126);const a=function e(t,n,o){if(Array.isArray(o))return o.some((o=>e(t,n,o)));{const e=o.toLowerCase().split("+");if(t.device.isWindows||t.device.isLinux){if((i.q9(e,"command")||i.q9(e,"ctrl"))!==n.ctrlKey)return!1}else{if(i.q9(e,"command")!==n.metaKey)return!1;if(i.q9(e,"ctrl")!==n.ctrlKey)return!1}return i.q9(e,"shift")===n.shiftKey&&(i.q9(e,"alt")===n.altKey&&i.yW(e,(e=>{if("command"===e||"shift"===e||"ctrl"===e||"alt"===e)return!0;const t="code:";if(e.startsWith(t)&&n.code){const t=e.substr(5);return n.code.toLowerCase()===t}return r()(n.keyCode)===e})))}}},92783:(e,t,n)=>{n.d(t,{Z:()=>o});const o=e=>{const{spaceViewStore:t,pageId:n}=e;if(!t||!n)return!1;return-1!==t.getBookmarkedPageIds().indexOf(n)}},28314:(e,t,n)=>{n.d(t,{lF:()=>a,yA:()=>r});var o=n(49085);const r=function(){return i},i={shift:!1,option:!1,control:!1,command:!1},a=o.default.createValue(i),s=function(e){i.shift=Boolean(e.shiftKey),i.option=Boolean(e.altKey),i.control=Boolean(e.ctrlKey),i.command=Boolean(e.metaKey),a.emit()};window.addEventListener("keydown",s),window.addEventListener("keyup",s),window.addEventListener("focus",(function(e){i.shift=!1,i.option=!1,i.control=!1,i.command=!1,a.emit()}))},78429:(e,t,n)=>{n.d(t,{H:()=>i});var o=n(95477),r=n(77080);function i(){return o.default.isAdminMode||"on"===r.default.getEligibleGroup({experimentId:"highlight_legacy_transclusions",defaultGroup:"control"})}},48709:(e,t,n)=>{n.d(t,{FV:()=>c,Fs:()=>m,Ts:()=>f,ZG:()=>p,cX:()=>d,dY:()=>h,hy:()=>u,uP:()=>g});var o=n(99405),r=n(70203),i=n(64002),a=n(95477),s=n(23178);function l(e,t){const n=s.Z.state;n.open&&n.focusLinkInput!==e&&s.Z.setState({...n,focusLinkInput:e,url:t?"":n.url})}function c(){l(!0),p(!1)}function d(){l(!1)}function u(){l(!1,!0)}function p(e){const t=s.Z.state;t.open&&t.focusTitleInput!==e&&s.Z.setState({...t,focusTitleInput:e})}function m(e){const{editingToken:t}=e;if(!t)return;const n=r.hDy(t),o=r.rlz(n);return o?r.zW$(o):void 0}function f(e){if(!e)return;const t=r.hDy(e);return r.rlz(t)?r.WiV(e):void 0}function g(e){return e.url||""}function h(e){const t=r.rOz(e);if(t&&"url"===t.type){const e=(0,o.Wj)({url:t.href,baseUrl:a.default.domainBaseUrl,publicDomainName:a.default.publicDomainName,isMobile:!1,protocol:void 0,currentUrl:void 0});return"page"===e.name?{type:"notion",url:t.href,notionPage:e}:{type:"web",url:t.href}}const n=(0,i.yn)(e);if(n)return{type:"other",url:n}}},27383:(e,t,n)=>{n.d(t,{y:()=>r});function o(e){return e.teamId?`${e.collectionViewId}-${e.teamId}`:e.collectionViewId}const r=new class{constructor(){this.cache=new Map,this._locallyMutatedTasksDatabase=!1}get locallyMutatedTasksDatabase(){return this._locallyMutatedTasksDatabase}set locallyMutatedTasksDatabase(e){this._locallyMutatedTasksDatabase=e}get(e){const t=o(e);return this.cache.get(t)}set(e,t){const n=o(e);for(this.cache.delete(n),this.cache.set(n,t);this.cache.size>25;){const e=this.cache.keys().next().value;this.cache.delete(e)}}}},28125:(e,t,n)=>{n.d(t,{S:()=>s,k:()=>a});var o=n(13991),r=n(77080),i=n(12955);function a(e){const{mobileNative:t}=e;if(t){const n=Boolean(t.sqliteConnection),o=i.canSetCookie(e);return n&&o}return!0}function s(e){return"en-US"===o.SP&&(e.device.isElectron&&r.default.checkGate("desktop_app_signup_hide_passcode")||e.device.isMobileNative&&e.device.isIOS&&r.default.checkGate("ios_app_signup_hide_passcode"))}},87279:(e,t,n)=>{n.d(t,{Xp:()=>s,mw:()=>l,og:()=>r,qW:()=>c});var o=n(67381);let r=function(e){return e[e.Modal=0]="Modal",e[e.ActionSheet=1]="ActionSheet",e[e.Popup=2]="Popup",e}({});const i="menu",a=(0,o.Q)({modernContextDefaultValue:{menuType:void 0},displayName:i,legacyContextKey:i}),s=a.context,l=a.legacyPropTypes,c=a.Provider},85818:(e,t,n)=>{n.d(t,{$6:()=>a,Ds:()=>r,_K:()=>i,tM:()=>s});var o=n(72126);function r(e,t){let n=0;for(let o=0;o<t.length;o+=1){const r=t[o];if(e>n+r.items.length-1){n+=r.items.length;continue}const i=e-n,a=r.items[i];if(!a)return;return{item:a,index:{section:o,indexLocal:i}}}}function i(e,t){const n=t[e.section];if(!n)return;const o=n.items[e.indexLocal];return o||void 0}function a(e,t){return o.Sm(t.slice(0,e.section).map((e=>e.items.length)))+e.indexLocal}function s(e){return e.reduce(((e,t)=>e+t.items.length),0)}},98742:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(72126),r=n(77744);function i(e,t){const n={...e};return Object.keys(t).forEach((i=>{const a=t[i],s=e[i];s&&i.startsWith("on")&&o.mf(a)?n[i]=function(){s(...arguments),a(...arguments)}:s&&("ref"===i||i.endsWith("Ref"))&&a?n[i]=(0,r.lq)(s,a):s||(n[i]=a||s)})),n}},64496:(e,t,n)=>{n.d(t,{_3:()=>s,fP:()=>a,qE:()=>i});var o=n(5162);const r="__mobileExperimentCache";function i(){return window[r]}function a(e,t,n){if(n)return t&&n.userExperiments?n.userExperiments[t]:{experimentsBySpace:{},experimentsWithoutSpace:n.deviceExperiments,isLoaded:!0,userId:void 0,deviceId:e,test:!1}}function s(e){return(0,o.Y)("supportsMobileExperimentCache")}},52533:(e,t,n)=>{n.d(t,{S$:()=>a,Y2:()=>i,nd:()=>r});n(97880);var o=n(11342);n(95477);let r=function(e){return e[e.Bottom=0]="Bottom",e[e.Floating=1]="Floating",e}({});function i(e){const{environment:t}=e;return!t.device.isIOS&&!t.device.isAndroid}function a(e){const{environment:t}=e;if(!t.device.isIOS)return!1;if(!t.mobileNative||!t.mobileNative.api.openUpgradeModal)return!1;{if(!t.device.mobileAppVersion)return!1;const e=o.parseVersion(t.device.mobileAppVersion),n=o.parseVersion("0.4.165");if(!e||!n)return!1;return!o.isLessThanVersion(e,n)}}},56335:(e,t,n)=>{n.d(t,{d:()=>r});var o=n(77080);function r(){return"on"===o.default.getEligibleGroup({experimentId:"monday_importer",defaultGroup:"control"})}},39500:(e,t,n)=>{n.d(t,{N9:()=>s,Nf:()=>l,Vc:()=>r,X9:()=>c,uG:()=>d});var o=n(30583);const r={mouse:6,finger:0,stylus:6},i=3,a=4;function s(e){return e.button===i||e.button===a}function l(e){return e&&"stylus"===e.touchType?"stylus":"finger"}const c=function(){return o.IL.moved};function d(e){return!!e.isTrusted&&c()}},75770:(e,t,n)=>{n.d(t,{lQ:()=>F,hD:()=>B,cJ:()=>Z,HE:()=>D,uw:()=>O,EC:()=>P,ah:()=>A,vz:()=>E,ru:()=>V,ed:()=>U});n(21703),n(67294);var o=n(41432),r=n(53877),i=n(69246),a=n(21202),s=n(6287),l=n(15047),c=n(29369),d=n(97880),u=n(9291),p=n(47307),m=n(74523),f=n(80444),g=n(55367),h=n(79797),v=n(99757),b=n(33929),y=n(35026),_=n(98165),S=n(46654),w=n(18514),k=n(48779),I=n(85644),C=n(82990),x=n(85893);async function T(){return p.confirmUserAction({message:(0,x.jsx)("span",{children:(0,x.jsx)(u.FormattedMessage,{defaultMessage:"Are you sure you want to make this page private? <boldtext>Only you will be able to access it.</boldtext>",id:"confirmDialog.movePageToPrivate.message",values:{boldtext:e=>(0,x.jsx)("span",{style:{fontWeight:C.Z.fontWeight.semibold},children:e})}})}),acceptLabel:(0,x.jsx)(u.FormattedMessage,{defaultMessage:"Move to private",id:"confirmDialog.movePageToPrivate.confirmButton.label"})})}const M=(0,u.defineMessages)({privateDestinationName:{id:"moveToHelpers.destinationName.private",defaultMessage:"Private"},numPagesDescriptorString:{id:"moveToHelpers.movePageDescriptorString",defaultMessage:"{numPagesMoved, plural, one {# page} other {# pages}}"},numPagesWithSubitemsDescriptorString:{id:"moveToHelpers.movePagesWithSubitemsDescriptorString",defaultMessage:"{numPagesMoved, plural, one {# page} other {# pages}} and {numSubitemsMoved, plural, one {# sub-item} other {# sub-items}}"},numBlocksDescriptorString:{id:"moveToHelpers.moveBlocksDescriptorString",defaultMessage:"{numBlocksMoved, plural, one {# block} other {# blocks}}"},bookmarksDestinationName:{id:"moveToHelpers.destinationName.favorites",defaultMessage:"Favorites"},movedMessagesWithDestinationToast:{id:"moveToHelpers.afterBulkMoveCompleteToastMessageWithDestination",defaultMessage:"Moved {pageDescriptor} to {destinationName}"},movedToDestinationShortToast:{id:"moveToHelpers.afterMoveCompleteOnMobileToastMessageWithDestination",defaultMessage:"Moved to {destinationName}"},movedMessagesToast:{id:"moveToHelpers.afterBulkMoveCompleteToastMessage",defaultMessage:"Moved {pageDescriptor}"}});function P(e){const{movedItems:t,numSubitems:n}=e;if(!(t.filter((e=>e.isNavigableBlock())).length===t.length))return b.default.formatMessage(M.numBlocksDescriptorString,{numBlocksMoved:t.length});if(1===t.length){const e=R(t[0]);if(e)return e}return n?b.default.formatMessage(M.numPagesWithSubitemsDescriptorString,{numPagesMoved:t.length-n,numSubitemsMoved:n}):b.default.formatMessage(M.numPagesDescriptorString,{numPagesMoved:t.length})}const A=e=>{const{environment:t,movedItems:n,moveToLocation:o,numSubitems:r}=e,i=P({movedItems:n,numSubitems:r}),a=function(e){const{environment:t,moveToLocation:n}=e,{currentSpaceStore:o}=f.default.getState();if(void 0===n||void 0===o)return;switch(n.type){case"moveToBlock":return R(n.blockStore);case"moveToCollection":return R(n.collectionStore);case"moveToCurrentWorkspace":return(0,k.rn)(t,o);case"moveToPrivatePages":return b.default.formatMessage(M.privateDestinationName);case"moveToTeam":return R(n.teamStore);case"moveToOtherWorkspace":return(0,k.rn)(t,n.spaceStore);case"moveToBookmarks":case"moveToShared":return;default:(0,d.t1)(n)}}({environment:t,moveToLocation:o});return a?t.device.isPhone?b.default.formatMessage(M.movedToDestinationShortToast,{destinationName:a}):b.default.formatMessage(M.movedMessagesWithDestinationToast,{pageDescriptor:i,destinationName:a}):b.default.formatMessage(M.movedMessagesToast,{pageDescriptor:i})};const R=e=>{var t;const n=b.default.getIntl();if(e)return null===(t=e.getModel())||void 0===t?void 0:t.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:r.x7,intl:n})},D=(e,t)=>{const{currentSpaceStore:n}=f.default.getState(),o=("space"===e.type?e.id:e.spaceId)??(null==n?void 0:n.id);if(void 0===n||void 0===o)return;const r=(e=>{var t;const{currentUserRootStore:n,currentSpaceStore:o}=f.default.state;return(null==o?void 0:o.id)===e?o:null==n||null===(t=n.getSpaceViewStores())||void 0===t||null===(t=t.find((t=>{var n;return(null===(n=t.getSpaceStore())||void 0===n?void 0:n.id)===e})))||void 0===t?void 0:t.getSpaceStore()})(o);if(r){if(r.id!==n.id)return{type:"moveToOtherWorkspace",spaceStore:r,targetParentId:"space-private-pages"!==e.type?e.id:r.id};switch(e.type){case"page":{const t=f.default.state.mainEditorCurrentBlockStore;if(!t)return;return{type:"moveToBlock",blockStore:h.G.createChildStore(t,{table:a.iU,id:e.id})}}case"collection":return{type:"moveToCollection",collectionStore:h.NW.createChildStore(r,{table:s.v,id:e.id})};case"space":return{type:"moveToCurrentWorkspace"};case"space-private-pages":return{type:"moveToPrivatePages"};case"team":return{type:"moveToTeam",teamStore:h.zX.createChildStore(r,{table:c.e0,id:e.id})};default:(0,d.t1)(e)}}},E=e=>{const{droppedDirection:t,targetStore:n,outlinerSectionType:o}=e,{currentSpaceStore:r}=f.default.getState();if(!r||!o)return;let a=n;if("block"===(null==n?void 0:n.table)&&t!==g.vh.Onto){if("bookmarks"===o)return{type:"moveToBookmarks"};if("shared"===o)return{type:"moveToShared"};a=null==n?void 0:n.getParentStore()}if(void 0===a)return;if(r.id===a.id)return(e=>{switch(e){case"workspace":return{type:"moveToCurrentWorkspace"};case"bookmarks":return{type:"moveToBookmarks"};case"private":return{type:"moveToPrivatePages"};case"shared":return{type:"moveToShared"};case"team":case i.kg:case i.PT:case i.cz:case i.mu:case i.g$:return;default:(0,d.t1)(e)}})(o);switch(a.table){case"block":return{type:"moveToBlock",blockStore:a};case"team":return{type:"moveToTeam",teamStore:a}}};function B(e){let{environment:t,blocks:n}=e;if(v.n.state)return{canMoveBlocks:!1,reason:{key:"unknown"}};for(const o of n){if(o.getParentTable()===c.e0){const e=(0,_.VP)(o);if(!e||!(0,y.si)({teamStore:e,environment:t}))return{canMoveBlocks:!1,reason:{key:"lockedTopLevelTeamPage"}}}if(!o.canAdmin())return{canMoveBlocks:!1,reason:{key:"needsFullAccess"}};if(!S.KE({environment:t,block:o})){const e=o.getParentStore();return{canMoveBlocks:!1,reason:{key:"needsEditAccessOnParent",parentStore:e instanceof h.G?e:void 0}}}}return{canMoveBlocks:!0}}function F(e){let{environment:t,blocks:n}=e;return B({environment:t,blocks:n}).canMoveBlocks}function O(e){const{type:t}=e,{mainEditorCurrentBlockStore:n,currentSpaceStore:o}=f.default.state;if(!o)throw new Error("currentSpaceStore not found");const r=n||o;if("space"!==t&&e.spaceId&&e.spaceId!==o.id)return h.H2.createChildStore(r,{table:l.bx,id:e.spaceId});switch(t){case"space-private-pages":return h.H2.createChildStore(r,{table:l.bx,id:o.id});case"space":return h.H2.createChildStore(r,{table:l.bx,id:e.id});case"page":return h.G.createChildStore(r,{table:a.iU,id:e.id});case"collection":return h.NW.createChildStore(r,{table:s.v,id:e.id});case"team":return h.zX.createChildStore(o,{table:c.e0,id:e.id,spaceId:o.id});default:(0,d.t1)(t)}}async function Z(){return await p.confirmUserAction({message:(0,x.jsx)("b",{children:(0,x.jsx)(u.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmTitle",defaultMessage:"Some content and settings may be broken on the duplicated page."})}),description:(0,x.jsxs)(x.Fragment,{children:[(0,x.jsx)("div",{style:{marginBottom:8},children:(0,x.jsx)(u.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmDescription1",defaultMessage:"This may include: links, relations, permissions, page history, and more."})}),(0,x.jsx)(u.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmDescription2",defaultMessage:"This page will remain unchanged in the current workspace, and a duplicate version will be created in the workspace you have chosen."}),(0,x.jsx)(m.Z,{title:(0,x.jsx)("div",{children:(0,x.jsx)(u.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmHelpLink",defaultMessage:"Learn more"})}),href:(0,w.UY)("guides.duplicateToSpace"),analyticsFrom:"move_to_confirm_duplicate_to_space",style:{marginTop:12}})]}),acceptLabel:(0,x.jsx)(u.FormattedMessage,{id:"moveToHelpers.duplicateToSpaceConfirmAcceptLabel",defaultMessage:"I understand, duplicate"})})}function V(e){let{targets:t,destination:n,direction:r,draggingOutlinerType:i}=e;if(r===g.vh.Onto&&t.some((e=>e.id===n.id)))return!0;const a=void 0!==(0,_._A)(n);return!(!t.some((e=>(0,I.A)(e)))||!a)||!("bookmarks"===i||!function(e){let{targets:t,destination:n,direction:r}=e;const i=t.some((e=>e.isCollectionView()||!e.isType(o.Zi)));if(!i)return!1;if(n.isCollectionView()&&!(0,I.A)(n)){if(r===g.vh.Onto)return!0;if(!n.getRecordStoreUIParent())return!0}const a=n.getAssociatedCollectionStore();if(r!==g.vh.Onto&&a&&!a.isPageTreeCollection())return!0;return!1}({targets:t,destination:n,direction:r}))}async function U(e){const t=function(e){const{from:t,environment:n}=e;if("moveTo"===t){const{moveToValue:t}=e.moveToArgs;return D(t,n)}if("dragAndDrop"===t){const{destination:t,direction:o,destinationOutlinerType:r}=e.dropArgs;return E({targetStore:t,droppedDirection:o,outlinerSectionType:r,environment:n})}}(e),n=await async function(e){const{blocks:t,environment:n,moveToLocation:o,from:r}=e;if(!o||"moveToOtherWorkspace"===o.type||"moveToBookmarks"===o.type)return{confirmed:!0,shouldClearPagePermissions:!1};const i="moveToPrivatePages"===o.type,a="moveTo"===r?e.moveToArgs.destination:e.dropArgs.destination,s=a&&N({stores:[a],environment:n});if(!i&&!s)return{confirmed:!0,shouldClearPagePermissions:!1};if(!N({stores:t,environment:n})){return await T()?{confirmed:!0,shouldClearPagePermissions:!0}:{confirmed:!1}}if(!i)return{confirmed:!0,shouldClearPagePermissions:!1};const l=n.currentUser.id;if(t.some((e=>{const t=e.getPermissionItems();return 0!==t.length&&(1!==t.length||"user_permission"!==t[0].type||t[0].user_id!==l)}))){return await T()?{confirmed:!0,shouldClearPagePermissions:!0}:{confirmed:!1}}return{confirmed:!0,shouldClearPagePermissions:!1}}({...e,moveToLocation:t});if(!n.confirmed)return{confirmed:!1};const{shouldClearPagePermissions:o}=n;return{confirmed:!0,shouldClearPagePermissions:o}}function N(e){const{stores:t,environment:n}=e,{currentSpaceStore:o}=f.default.state;if(!o)return!1;for(const r of t){const e=(0,_.u3)(r);if(!((null==e?void 0:e.table)===a.iU&&e.isTopLevelPrivatePage({spaceStore:o,environment:n})))return!1}return!0}},44499:(e,t,n)=>{n.d(t,{Hn:()=>f,XQ:()=>p,Xk:()=>u,qB:()=>m});n(57658);var o=n(92996),r=n(41432),i=n(21202),a=n(6287),s=n(55367),l=n(42330),c=n(79797),d=n(75770);function u(e,t){return!(!e.isNavigableBlock()&&e.getType()!==r.Ti.alias)&&(!e.isLinkedCollectionView()&&(!e.getMovedStore().getValue()&&!(0,d.ru)({targets:t,destination:e,direction:s.vh.Onto})))}function p(e){let{recentPageResults:t,blockResults:n,suggestedPages:o}=e;const r=new Set;for(const i of o){const e=i instanceof c.NW?i.getParentId():i.id;e&&r.add(e)}return[...t.filter((e=>!r.has(e.blockId))),...n.filter((e=>!r.has(e.blockId)))]}function m(e){const t=[];for(const o of e){const e=o.getParentPointer();if(e)if(e.table===i.iU)t.push(e.id);else if(e.table===a.v){var n;const e=null===(n=o.getAssociatedCollectionStore())||void 0===n?void 0:n.getParentPointer();e&&e.table===i.iU&&t.push(e.id)}}return t}function f(){const e=l.ZP.getTargetsDatabaseType();return l.ZP.getVariant()===o.ii&&e&&e!==o.GZ}},68056:(e,t,n)=>{n.d(t,{NV:()=>u,QY:()=>m,TD:()=>f,_v:()=>a,e6:()=>p,iG:()=>c,k_:()=>s,ko:()=>d,qS:()=>l,yt:()=>h});var o=n(97880),r=n(89086);function i(e,t){return e.store===t.store&&e.index===t.index}function a(e,t){return!e&&!t||!(!e||!t)&&(i(e.start,t.start)&&i(e.end,t.end))}function s(e){return{start:{...e.start},end:{...e.end}}}function l(e){return!e||e.start.store===e.end.store}function c(e){return l(e)&&e.start.index===e.end.index}function d(e){return 0===e.start.index&&c(e)}function u(e){return c(e)&&(0,r.J_)(e.start.store,{startIndex:e.start.index,endIndex:e.end.index})}function p(e,t){const n=[e.start.store,e.end.store];return n.includes(t.start.store)||n.includes(t.end.store)}function m(e){if(e)return l(e)?{store:e.start.store,selection:{startIndex:e.start.index,endIndex:e.end.index}}:void 0}function f(e){const{store:t,selection:n}=e;if(t&&n)return{start:{store:t,index:n.startIndex},end:{store:t,index:n.endIndex}}}const g=(0,o.AO)((e=>e&&"object"==typeof e&&"store"in e&&"index"in e?{true:e}:{false:e})),h=(0,o.AO)((e=>{if("object"==typeof e&&e&&"start"in e&&"end"in e){const{start:t,end:n}=e;if(g(t)&&g(n))return{true:e}}return{false:e}}))},45162:(e,t,n)=>{n.d(t,{$r:()=>F,Aw:()=>Z,L5:()=>I,Nj:()=>R,W9:()=>P,Zb:()=>x,fx:()=>E,r:()=>k,ri:()=>V,tp:()=>A,uZ:()=>O,xI:()=>S});n(21703);var o=n(55010),r=n(45060),i=n(41432),a=n(92595),s=n(68626),l=n(73597),c=n(70842),d=n(28685),u=n(26842),p=n(14976),m=n(46150),f=n(68056),g=n(69645),h=n(73959),v=n(89224),b=n(89086);const y=!1;function _(){if(y){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.warn("multiTextSelectionHelpers:",...t)}}function S(e,t){const n=(0,f.QY)(t);return n||s.rateLimitedLog({from:"multiTextSelectionHelpers",type:"TODO",level:"warning",data:{name:e,message:e}}),n}const w={startIndex:0,endIndex:1/0};function k(e,t){const{start:n,end:r}=e;if((0,f.qS)(e))return n.store===t?"contained-within":void 0;if(n.store===t)return"starts-at";if(r.store===t)return"ends-at";const i=d.E.findNodeFromStore(n.store),a=d.E.findNodeFromStore(r.store),s=d.E.findNodeFromStore(t);return i&&a&&s&&1===(0,o.Z)(s,i)&&-1===(0,o.Z)(s,a)?"covers":void 0}function I(e){const{start:t,end:n}=e,o=(0,f.QY)(e);if(o){const e=d.E.findEditableWithStore(o.store);if(e){return[{editable:e,...o}]}return[]}const r=C(t),i=C(n);if(!r||!i){const e=r||i;if(!e)return[];return[{editable:e.editable,store:e.position.store,selection:{startIndex:e.position.index,endIndex:e.position.index}}]}const a=(0,b.yR)(r.editable).filter((e=>{var t,n,o;return(null===(t=e.contentEditableContext)||void 0===t?void 0:t.id)===(null===(n=r.editable.contentEditableContext)||void 0===n?void 0:n.id)&&(null===(o=e.getNode())||void 0===o?void 0:o.isConnected)})),s=a.findIndex((e=>e.props.store.id===r.editable.props.store.id)),l=a.findIndex((e=>e.props.store.id===i.editable.props.store.id));if(-1===s){throw Object.assign(new Error("Start editable not found in DOM order array"),r)}if(-1===l){throw Object.assign(new Error("End editable not found in DOM order array"),i)}if(!(s<=l))throw new Error(`Start (index ${s}) must be before end (index ${l}) in DOM`);const c=a.slice(s,l+1);return c.map(((e,t)=>{if(0===t){const{position:t}=r;return{editable:e,store:e.props.store,selection:{startIndex:t.index,endIndex:1/0}}}if(t===c.length-1){const{position:t}=i;return{editable:e,store:e.props.store,selection:{startIndex:0,endIndex:t.index}}}return{editable:e,store:e.props.store,selection:w}}))}function C(e){const t=d.E.findEditableWithStore(e.store);if(t)return{editable:t,position:e}}function x(e){var t;const{range:n,contentEditableLeafRegistry:o,allowInvisibleEndSelection:r,constraintToContentEditableRootNode:i,avoidEdgesOfContentEditableRoot:a}=e;if(!n)return;if(i&&i!==(0,m.xp)(n.commonAncestorContainer))return;if(a&&(0,m.Hd)(n.commonAncestorContainer))return void _("not snapping - range is at edge of content editable root");let s,l=!1,c=o.getParentContentEditableLeaf(n.startContainer);c||(s??=o.getByDOMOrder(),c=(0,v.snapContainerOffsetToNode)({nodesInDomOrder:s,containerOffset:{container:n.startContainer,offset:n.startOffset},snapTowards:"end"}),l=!0,_("snapped start",n.startContainer,n.startOffset,"to",c));let d=o.getParentContentEditableLeaf(n.endContainer);if(!d||!r&&d&&0===n.endOffset&&n.endContainer===d.node&&d.node!==(null===(t=c)||void 0===t?void 0:t.node)){s??=o.getByDOMOrder();const e=s.findIndex((e=>{var t;let{node:n}=e;return n===(null===(t=c)||void 0===t?void 0:t.node)})),t=-1!==e?s.slice(e):s,i=d&&!r?t.filter((e=>{var t;let{node:n}=e;return n!==(null===(t=d)||void 0===t?void 0:t.node)})):t;d=(0,v.snapContainerOffsetToNode)({nodesInDomOrder:i,containerOffset:{container:n.endContainer,offset:n.endOffset},snapTowards:"start"}),l=!0,_("snapped end",n.endContainer,n.endOffset,"inside",t,"to",d)}if(!c||!d){const e=c??d;if(!e)return;return{start:e,end:e,forceEmit:!0}}return{start:c,end:d,forceEmit:l}}function T(e){const t=e.getTitleStore();if(t){if(d.E.findNodeFromStore(t))return t}}function M(e){for(const t of e){const e=T(t);if(e&&t.getType()!==i.Ti.code)return{blockStore:t,titleStore:e}}}function P(e){const t=M(e);if(!t)return;const n=function(e){return M([...e].reverse())}(e);if(!n)return;const o=(0,g.dq)({includeNonSelectableListContainer:!1,root:t.blockStore.getHighestContentBlockUIAncestor()});if(!o)return;const r=(0,g.Ib)(n.blockStore,o);if(!r)return;let i;for(const a of(0,l.JK)(r)){const e=a.value.store.getTitleStore();if(e){const t=(0,b.x0)(e);t&&(i={store:e,index:t.endIndex})}}if(!i)return;return{start:{store:t.titleStore,index:0},end:i}}function A(e){var t;const{multiSelection:n,filterCommonAncestors:o,focus:r}=e;if((0,f.qS)(n)){var a;let e=(0,h.sQ)(n.start.store);if((null===(a=e)||void 0===a?void 0:a.getType())===i.Ti.tableRow){var s;const t=null===(s=e.getRecordStoreUIParent())||void 0===s?void 0:s.recordStoreUIParentStore;t&&t instanceof u.G&&(e=t)}if(!e)return;return{stores:[e]}}const c=R({multiSelection:n,includeNonSelectable:!1});if(!c)return;const d=o?(0,l.tL)(c.treeRange):(0,l.bu)(c.treeRange),p=Array.from(d),m=p[0],g=null==m||null===(t=m.value.component)||void 0===t||null===(t=t.contentEditableContext)||void 0===t?void 0:t.id,b=p.filter((e=>{var t;return(null===(t=e.value.component)||void 0===t||null===(t=t.contentEditableContext)||void 0===t?void 0:t.id)===g||e.value.store.getType()===i.Ti.table})).map((e=>e.value.store));return{stores:b,pivot:"end"===r||r===n.end||void 0===r&&!(0,v.selectionIsBackwards)()?b[b.length-1]:b[0]}}function R(e){const{multiSelection:t,includeNonSelectable:n}=e,o=(0,h.sQ)(t.start.store),r=(0,h.sQ)(t.end.store);if(!o||!r)return;const i=o.getHighestContentBlockUIAncestor(),a=(0,g.dq)({includeNonSelectableListContainer:n,root:i});if(!a)return;const s=(0,g.v5)(o,[a]),l=(0,g.v5)(r,[a]);if(!s||!l)return;const d=c.T.fromNearestCommonAncestor(s,l);return d?{tree:a,treeRange:d}:void 0}function D(e){const{leafNode:t,rangeContainer:n,defaultEndIndex:r}=e;_("Range outside of leaf, attempting to recover",t,n);const i=(0,o.Z)(t,n);let a=0;if(-1===i)a=r;else{if(1!==i)throw new Error("Invalid relativeStartPosition. index should not be inside leaf");a=0}return{index:a,forceEmit:!0,afterEndOfLine:!1}}function E(e){var t,n,o,r;const{range:i,contentEditableLeafRegistry:a,allowInvisibleEndSelection:s,avoidEdgesOfContentEditableRoot:l}=e;if(!i)return;let c,u,f=!1;if(a&&a.hasMembers()){const e=x({range:i,contentEditableLeafRegistry:a,allowInvisibleEndSelection:s,constraintToContentEditableRootNode:void 0,avoidEdgesOfContentEditableRoot:l});e&&(c=e.start.node,u=e.end.node,f||=e.forceEmit),_("getMultiTextSelectionFromRange: snapped to leafs",e,i)}else c=(0,m.X1)(i.startContainer),u=(0,m.X1)(i.endContainer),_("getMultiTextSelectionFromRange: found parent leafs",c,u,i);const g=c?d.E.find((e=>{var t;return(null===(t=e.getContentEditableLeaf())||void 0===t?void 0:t.getNode())===c})):void 0,h=u?d.E.find((e=>{var t;return(null===(t=e.getContentEditableLeaf())||void 0===t?void 0:t.getNode())===u})):void 0;if(!g||!h)return void _("getMultiTextSelectionFromRange: missing editable",{startMissing:!g,endMissing:!h});const v=!i.collapsed,y=g.props.store;let S=h.props.store;const{startContainer:w,endContainer:k}=i,I=(null===(t=(n=h.props).getEndSelection)||void 0===t?void 0:t.call(n).endIndex)??0,C=(null===(o=c)||void 0===o?void 0:o.contains(i.startContainer))&&(0,p.Qb)(i.startContainer,i.startOffset)||D({leafNode:c,rangeContainer:w,defaultEndIndex:I});let T=(null===(r=u)||void 0===r?void 0:r.contains(i.endContainer))&&(0,p.Qb)(i.endContainer,i.endOffset)||D({leafNode:u,rangeContainer:k,defaultEndIndex:I});if(v&&T.afterEndOfLine){const e=(0,b.hn)(S);e&&(_("end after EOL",i.endContainer,i.endOffset),S=e,T={index:0,forceEmit:!0,afterEndOfLine:!1})}return{multiSelection:{start:{store:y,index:C.index},end:{store:S,index:T.index}},forceEmit:f||C.forceEmit||T.forceEmit}}function B(e,t){if(!e&&!t)return 0;if(!t)return-1;if(!e)return 1;if(e.store===t.store)return e.index-t.index;const n=d.E.findNodeFromStore(e.store),r=d.E.findNodeFromStore(t.store);return(0,o.Z)(n,r)}function F(e,t){const[n,o]=[e,t].sort(B);return{start:n,end:o}}function O(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:(0,v.selectionIsBackwards)())?{focus:e.start,anchor:e.end}:{focus:e.end,anchor:e.start}}function Z(e){return e.device.isAndroid?"gesture":e.device.isIOS||e.device.isElectron||e.device.isSafari||e.device.isChrome?"always":void 0}function V(e){return e.isChrome&&96===parseInt(e.browserVersion,10)}(0,a.exposeDebugValue)("multiTextSelectionToBlockSelection",A),(0,r.Rw)({canFormat:e=>(0,f.yt)(e),header(e){const{table:t,tr:n,td:o,object:i,CONTAINER_STYLE:a}=r.TI,s=d.E.findNodeFromStore(e.start.store),l=d.E.findNodeFromStore(e.end.store);return t(a,n({},o({},"start:"),o({},i(e.start.index)," in"),o({},i(e.start.store)),o({},i(s))),n({},o({},"end:"),o({},i(e.end.index)," in"),o({},i(e.end.store)),o({},i(l))))},hasBody:e=>!1,body:e=>null})},99445:(e,t,n)=>{n.d(t,{A8:()=>f,UF:()=>l,bW:()=>s,yk:()=>i,yt:()=>r});n(57658);var o=n(15095);function r(e){if(0===e)return"a";let t=0,n=0,o="";for(;e>0;)t=(e-1)/26,n=(e-1)%26,e=Math.floor(t),o=String.fromCharCode(97+n)+o;return o}function i(e){let t=0,n=0;const o=e.split("").reverse();for(const r of o){t+=(r.charCodeAt(0)-96)*26**n,n+=1}return t}const a={"m̄":1e6,"d̄":5e5,"c̄":1e5,"l̄":5e4,"x̄":1e4,"v̄":5e3,m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1};function s(e){let t="";if(0===e)return"0";for(const n in a){const o=Math.floor(e/a[n]);if(o>=0)for(let e=0;e<o;e++)t+=n;e%=a[n]}return t}function l(e){const t=o.p4(e);let n,r,i,s,l=0;for(let o=0;o<t.length;o++){if(n=t[o],r=n?a[n]:void 0,i=t[o+1],s=i?a[i]:void 0,!r)return-1;s&&r<s?l-=r:l+=r}return l}const c=4.44,d={i:3.64,v:8.36,x:8.08,l:3.73,c:8.64,d:9.52,m:13.61,"m̄":13.61,"d̄":9.52,"c̄":8.64,"l̄":3.73,"x̄":8.08,"v̄":8.36};function u(e){const t=o.p4(e);let n=0;for(const o of t)n+=d[o];return n+c}const p=[24],m=14;function f(e){const t=l(e);if(t<=p.length)return p[t-1];let n=p[p.length-1];for(let o=p.length+1;o<=t;o++){const e=u(s(o));e>n&&(n=e+m),p.push(n)}return n}},45950:(e,t,n)=>{n.d(t,{Dx:()=>p,Ye:()=>u,ne:()=>m,yY:()=>d});n(21703),n(57658);var o=n(72126),r=n(59753),i=n(45953),a=n(33361),s=n(21202),l=n(18245),c=n(77080);async function d(e){const{environment:t,recordPointers:n,recurFn:o,recordIsRequired:s}=e,l=i.PF.create();return await a.uf({recordPointers:n,recordMap:l,recurFn:(e,t)=>o(e,t),loadRecordModel:async e=>{const n=t.defaultRecordCache.inMemoryRecordCache.getModelAndRole({pointer:e,userId:t.currentUser.id});if(n)return n;const o=t.defaultRecordCache.persistedRecordCache;if(o){const n=await o.get(e,t.currentUser.id);if(n)return{model:r.kk.fromValue(e.table,n.value),role:n.role}}if(s(e))throw new Error(`Failed to load a required record: ${e.table}, ${e.id}, ${e.spaceId}.`)}}),l}async function u(e){const{environment:t}=e,n=e.environment.currentUser.id;if(e.inMemoryRecordCache)return e.inMemoryRecordCache.getModelAndRole({pointer:e.pointer,userId:n});let o=t.defaultRecordCache.inMemoryRecordCache.getModelAndRole({pointer:e.pointer,userId:n});if(void 0!==o)return o;if(e.useInMemoryCacheOnly)return;if(e.prefetchPromise&&"pending"===e.prefetchPromise.state.status&&(await e.prefetchPromise.wrappedPromise,o=t.defaultRecordCache.inMemoryRecordCache.getModelAndRole({pointer:e.pointer,userId:n}),void 0!==o))return o;const{persistedRecordCache:i}=e.environment.defaultRecordCache;if(i){const t=await i.get(e.pointer,n);if(t)return{model:r.kk.fromValue(e.pointer.table,t.value),role:t.role}}}async function p(e){const{parent:t,inMemoryRecordCache:n,environment:o}=e,i=[],a=e.environment.currentUser.id,l=e.environment.defaultRecordCache.persistedRecordCache;if(l&&n===o.defaultRecordCache.inMemoryRecordCache){return(await l.getBlocksWithParent({parent:t,userId:a})).map((e=>({model:r.kk.fromValue(s.iU,e.value),role:e.role})))}return n.forEachRecord(a,(e=>{let{model:n,role:o}=e;n.table===s.iU&&n.parent_table===t.table&&n.parent_id===t.id&&i.push({model:n,role:o})})),i}async function m(e){const{environment:t,inMemoryRecordCache:n}=e,i=r.kk.fromCollection(e.collection);if(!i)return[];const a=i.pointer;if(!i.isPageTreeCollection()){const e=l.default.mark("collections.get_local_pages_in_collection"),o=p({environment:t,parent:a,inMemoryRecordCache:n});return l.default.measure(e,{environment:t}),o}const u=i.getRootPagePointer(),m=c.default.checkGate("wiki_perf_improvement_local_enabled"),f=l.default.mark("collections.get_local_pages_in_collection_wiki"),g=m?await async function(e){const{rootPagePointer:t,environment:n}=e,o=[],r=(e,n)=>e.table!==s.iU?[]:(e.pointer.id===t.id||"page"!==e.type&&"collection_view_page"!==e.type||o.push({model:e,role:n}),e.getContentIds().map((t=>({table:s.iU,id:t,spaceId:e.spaceId}))));return await d({environment:n,recordPointers:[t],recurFn:r,recordIsRequired:()=>!1}),o}({environment:t,rootPagePointer:u}):await async function(e){const{rootPagePointer:t,environment:n,inMemoryRecordCache:r}=e;let i=[t];const a=[];for(;i.length>0;){const e=i.map((e=>p({environment:n,parent:e,inMemoryRecordCache:r}))),t=(await Promise.all(e)).flat();for(const n of t){var s;const e=null==n||null===(s=n.model)||void 0===s?void 0:s.type;"page"!==e&&"collection_view_page"!==e||a.push(n)}i=o.oA(t.map((e=>{var t;return null===(t=e.model)||void 0===t?void 0:t.pointer})))}return a}({environment:t,rootPagePointer:u,inMemoryRecordCache:n});return l.default.measure(f,{environment:t,data:{status:m?"v2":"v1"}}),g}},35026:(e,t,n)=>{n.d(t,{EE:()=>T,N:()=>P,P4:()=>M,Pl:()=>C,Ps:()=>R,Q2:()=>w,Yz:()=>A,l6:()=>_,si:()=>x,vs:()=>S});n(57658),n(30541);var o=n(15145),r=n(41432),i=n(42875),a=n(15157),s=n(72126),l=n(69246),c=n(21202),d=n(70279),u=n(29369),p=n(64684),m=n(70203),f=n(97880),g=n(79797),h=n(13105),v=n(75770);const b=new Set([r.Ti.page,r.Ti.collectionView,r.Ti.collectionViewPage,r.Ti.alias]),y=new Set([r.Ti.factory]);function _(e){const{allSharedPages:t,state:n,intl:o,teamStore:r}=e,{query:a,filter:s}=n;return t.map((e=>{if(!e.isDefined())return;const t=e.getLastEditedTime()||e.getCreatedTime();if(!t)return;const n=e.getLastEditedByPointer()??e.getCreatedByPointer(),c=e.getParentId();if(r){if("owned"===s&&c!==r.id)return;if("shared"===s&&c===r.id)return}return(0,l.fY)({block:e.getModel(),query:a,getRecordModel:e.getRecordModel,userTimeZone:(0,i.r)(),intl:o})?{blockId:e.id,timestamp:t,authorPointer:n}:void 0})).filter(f.$K)}function S(e){const{sharedPageItems:t}=e;return s.MR(t,(e=>{let{timestamp:t}=e;return t})).reverse()}function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b;const o=[],r=new Set,i=[e];for(;i.length>0;){const a=i.shift();if(r.has(a.id))continue;r.add(a.id);const s=I(a,e,t,n);o.push(...s.outlinerItems),i.unshift(...s.subtree)}return o}const k=new h.P({debugName:"getOutlinerItemsStoresInSubtreePageMentions",memoizeRecursion:!1,deepEquals:!1,compute(e){var t;const n=null===(t=e.getTitleStore())||void 0===t?void 0:t.getValue(),o=m.cCA(n);return e.getRecordStoreArray(e,o).filter((t=>t.getParentId()===e.id)).concat(e.getContentStores())}});function I(e,t,n,o){var i;const a=e.getType();if(a&&n.has(a)||(null===(i=e.getModel())||void 0===i||null===(i=i.getAliasTargetPointer())||void 0===i?void 0:i.table)===d.x_)return{outlinerItems:[],subtree:[]};if(a&&e!==t&&o.has(a))return{outlinerItems:[e],subtree:[]};const s=e.getType()===r.Ti.transclusionReference?e.getTransclusionReferenceTargetStore():e;if(!s)return{outlinerItems:[],subtree:[]};return{outlinerItems:[],subtree:k.getStateFor(s)}}function C(e){let{environment:t,draggingStores:n,parentStore:o,currentSpaceStore:r}=e;if(!t.currentUser.id)return!1;if(!n.every((e=>e.isNavigableBlock())))return!1;if(!(0,v.lQ)({environment:t,blocks:n}))return!1;if((null==o?void 0:o.table)===u.e0){return x({environment:t,teamStore:g.zX.createChildStore(r,{table:u.e0,id:o.id,spaceId:r.id})})}return!0}function x(e){let{environment:t,teamStore:n}=e;const o=t.currentUser.id;if(!n.isDefined())return!1;return!(n.getDisableTeamPageEdits()&&o&&!(0,p.pd)({membership:n.getMembers()},o))&&n.canAddOrRemoveTopLevelPages()}function T(e){let{typeWithTeam:t,sidebarState:n,currentSpaceViewStore:o,environment:r}=e;switch(t.type){case"team":return t.teamStore.getTeamPagesStores();case"bookmarks":return o.getBookmarkedPages();case"workspace":return o.getWorkspacePages();case"shared":return n.visibleSharedPagesStores;case"private":return o.getPrivatePages(r);default:(0,f.t1)(t)}}function M(e){let{typeWithTeam:t,currentSpaceStore:n,currentSpaceViewStore:o}=e;switch(t.type){case"team":return t.teamStore.getTeamPagesStore();case"bookmarks":return o.getBookmarkedPagesStore();case"workspace":return n.getPagesStore();case"shared":return o.getSharedPagesStore();case"private":return o.getPrivatePagesStore();default:(0,f.t1)(t)}}function P(e){switch(e){case"bookmarks":return o.tY.SidebarBookmark;case"workspace":return o.tY.SidebarWorkspace;case"shared":return o.tY.SidebarShared;case"private":return o.tY.SidebarPrivate;case"team":return o.tY.SidebarTeam;case"teamSidebar":case"teamBrowserSearch":case"teamBrowserUnjoinedTeams":case"teamBrowserJoinedTeams":return o.tY.SidebarTeamBrowser;case l.g$:return o.tY.SidebarPublicPageTemplateIncludes;default:(0,f.t1)(e)}}function A(e){return w(g.G.createChildStore(e,{table:c.iU,id:e.id}),y,b)}function R(e){const{store:t,toOpen:n,environment:o,isTopLevelItem:r}=e;r&&a.Z.set({userId:o.currentUser.id,key:`Outliner-${t.id}`,value:n})}},50627:(e,t,n)=>{n.d(t,{CX:()=>p,OZ:()=>h,RH:()=>v,a_:()=>u,du:()=>f,kC:()=>m,mO:()=>g,y6:()=>d,zL:()=>c});var o=n(41432),r=n(6695),i=n(77546),a=n(82136),s=n(88923),l=n(28020);const c=900;function d(e){const t=e.getAssociatedCollectionStore();if(!t)return;const n=e.getSchema(),o=t.getFormat();return r.iB(o,n,void 0,r.j5.Collection)}function u(e){if(e.isCollectionView()){const t=e.getCollectionViewSourceCollectionStore();return!!t&&t.isSyncedCollection()}return e.isType(o.Ti.externalObjectInstancePage)}function p(e){return!e.hasContent()&&(!e.isCollectionView()||e.isType("collection_view_page")&&e.isCollectionViewPageWithContent())}function m(e,t){const n={width:"100%",display:"flex",flexDirection:"column",alignItems:"center",flexShrink:0,flexGrow:0};return e.isCollectionView()&&(e.isLocked()&&(n.cursor="default"),i.eA(t)&&(n.position="sticky",n.left=0)),n}function f(e,t,n){return g(e,t,n)?"100%":c}function g(e,t,n){if(t===a.S.CollectionPageView)return!0;const{device:o}=n,{isPhone:r}=o,i=e.isFullWidth(),s=e.isCollectionView(),l=h(t);return i&&!r||s||l||r}function h(e){return e===a.S.PeekView}function v(e,t){if(e===a.S.PeekView){const e=s.default.getPeekMode();return s.PeekModePadding.horizontal[e]}return(0,l.ui)(t)}},78873:(e,t,n)=>{n.d(t,{E:()=>s,c:()=>l});var o=n(54642),r=n(97799),i=n(69503),a=n(92083);function s(e){const{environment:t,onSubmit:n,onCancel:o}=e;t.device.isMobile?r.Z.setState({open:!0}):a.Z.setState({open:!0,openedFrom:"login",currentTab:"profile",defaultSubtab:void 0,highlightedSetting:void 0}),i.Z.setState({open:!0,setNewPassword:!0,password:"",repeatPassword:"",isSet:!1,onSubmit:n,onCancel:o})}async function l(e){const{environment:t,userEmail:n}=e,r=await o.getLoginOptions(t,{email:n});if("failed"===r.type)return{error:r.error};const i=r.data;return{value:{isSamlEnforced:"required"===i.samlSignIn,didLogInWithSaml:"available"===i.samlSignIn&&i.hasAccount&&"saml"===i.lastLoginMethod,hasPassword:"required"!==i.samlSignIn&&i.hasAccount&&i.passwordSignIn}}}},98165:(e,t,n)=>{n.d(t,{D0:()=>K,Dg:()=>O,Eb:()=>R,KU:()=>L,Om:()=>E,Pj:()=>V,RC:()=>$,VP:()=>U,_A:()=>j,e3:()=>H,fJ:()=>A,fl:()=>z,n3:()=>W,oZ:()=>G,qA:()=>P,s:()=>D,u3:()=>Z,uJ:()=>B,wf:()=>F,yI:()=>q});n(57658);var o=n(41432),r=n(72126),i=n(63306),a=n(72141),s=n(73360),l=n(74446),c=n(45953),d=n(606),u=n(98963),p=n(18844),m=n(21202),f=n(6287),g=n(70279),h=n(33709),v=n(91644),b=n(15047),y=n(29369),_=n(97880),S=n(80444),w=n(79797),k=n(13105),I=n(65598);function C(e,t){const{table:n,id:o,spaceId:r}=t,i=r||e.pointer.spaceId;if(n===f.v)return w.NW.createChildStore(e,{table:f.v,id:o});if(n===b.bx)return w.H2.createChildStore(e,{table:b.bx,id:o});if(n===m.iU)return w.G.createChildStore(e,{table:m.iU,id:o});if(n===g.x_){if(i)return w.T5.createChildStore(e,{table:g.x_,id:o,spaceId:i})}else if(n===h.qF){if(i)return w.jQ.createChildStore(e,{table:h.qF,id:o,spaceId:i})}else if(n===y.e0){if(i)return w.zX.createChildStore(e,{table:y.e0,id:o,spaceId:i})}else if(n===p.Xj){if(i)return w.zq.createChildStore(e,{table:p.Xj,id:o,spaceId:i})}else if(n===u.cv&&i)return w.Mz.createChildStore(e,{table:u.cv,id:o,spaceId:i})}function x(e){const t=S.default.state.mainEditorCurrentBlockStore;return t?t.inMemoryRecordCache!==e.inMemoryRecordCache?e:t:e}function T(e){const t=x(e);return((n=e)instanceof w.G||n instanceof w.H2||n instanceof w.NW||n instanceof w.T5||n instanceof w.jQ||n instanceof w.zX||n instanceof w.zq||n instanceof w.Mz)&&e.getRecordStoreUIParent()===t?e:C(t,e.pointer);var n}const M=new k.P({debugName:"getPathStores",memoizeRecursion:!0,deepEquals:!1,compute:function(e,t){const n=e.getValue();if(!n||!(0,s.oK)(n))return[e];const o=d.dr.getParentPointerFromRecordWithParent(n),r=C(x(e),o);return r?[e].concat(t(r)):[e]}}),P=function(e){const t=T(e);return t?M.getStateFor(t):[]};function A(e){return r.oA(P(e).map((e=>{if("space"===e.table){if(!(0,I.Mm)(e))return;return e.getModel()}if("block"===e.table){const{pointer:t}=e,n=(0,w.Vh)(e,t,"alive").getValue(),o=(0,w.Vh)(e,t,"parent_id").getValue(),r=(0,w.Vh)(e,t,"type").getValue();if(void 0!==n&&void 0!==o&&void 0!==r)return e.getModel()}else if(e.table===y.e0){const{pointer:t}=e;if(!(0,w.Vh)(e,t,"settings").getValue())return;return e.getModel()}})))}function R(e){const{store:t,teamPermissionItems:n}=e,o=c.Ak.create(),r=V(t)||S.default.state.currentSpaceStore;return r&&n.forEach((e=>{const t=w.zX.createChildStore(r,{table:y.e0,id:e.team_id,spaceId:r.id});o.setModel({id:t.id,table:y.e0,spaceId:r.id},t.getModel())})),o}async function D(e){const t=[];return await i.ne(e.pointer,l.zF.fromMonomorphicFunctionUnsafe((async n=>{let o;if(n.table===f.v?o=w.NW.createChildStore(e,n):n.table===b.bx?o=w.H2.createChildStore(e,n):n.table===m.iU?o=w.G.createChildStore(e,n):n.table===g.x_?o=w.T5.createChildStore(e,n):n.table===h.qF&&(o=w.jQ.createChildStore(e,n)),o)return t.push(o),await o.load(),o.getValue()}))),t}const E=function(e){const t=w.t1.fromV1(e);if(t instanceof w.G||t instanceof w.NW){const e=t.getParentTable(),n=t.getParentId();if(e&&n){if(e===f.v)return w.NW.createChildStore(t,{table:f.v,id:n});if(e===b.bx)return w.H2.createChildStore(t,{table:b.bx,id:n});if(e===m.iU)return w.G.createChildStore(t,{table:m.iU,id:n});if(e===g.x_)return w.T5.createChildStore(t,{table:g.x_,id:n,spaceId:t.getSpaceId()});if(e===y.e0)return w.zX.createChildStore(t,{table:y.e0,id:n});if(e===p.Xj)return w.zq.createChildStore(t,{table:p.Xj,id:n,spaceId:t.getSpaceId()});if(e===v.AT)return w.Vf.createChildStore(t,{table:v.AT,id:n,spaceId:t.getSpaceId()});(0,_.t1)(e)}}},B=function(e){return P(e).filter((e=>{if(!e.canRead())return!1;if(e instanceof w.G){const t=e.getType();return t&&(0,o.S9)(t)}return e instanceof w.zX}))},F=function(e){const t=P(e).find((e=>{let t;return(e instanceof w.G||e instanceof w.NW)&&(t=e.getAlive()),!1===t}));return Boolean(t)},O=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const n=B(e)[t];return n instanceof w.zX?O(n,t+1):n},Z=function(e){const t=B(e);return t[t.length-1]},V=function(e){return P(e).find((e=>e.table===b.bx))},U=function(e){const t=P(e);return N(t)},N=function(e){return e.find((e=>e.table===y.e0))},L=e=>e.find((e=>e.table===y.e0)),j=function(e){return P(e).find((e=>{var t;return e.table===m.iU&&(null===(t=e.getCollectionStore())||void 0===t?void 0:t.isPageTreeCollection())}))},z=function(e){for(const t of e)if((t instanceof w.G||t instanceof w.NW)&&(!t.isDefined()||!t.getAlive()))return!1;return!0},q=function(e){for(const t of e)if(t instanceof w.G||t instanceof w.NW){if(!t.isDefined())continue;if(!t.getAlive())return!0}return!1};function H(e){for(const t of e)if(t instanceof w.G){if(!t.isDefined())continue;const e=t.getMovedStore().getValue();if(void 0!==e)return{store:t,moved:e}}}function W(e){return"block"===e.table||"space"===e.table||"collection"===e.table||"comment"===e.table||"discussion"===e.table}const K=function(e){const t=P(e).find((e=>{if(e.table===y.e0)return Boolean(e.getArchivedBy())}));return Boolean(t)};function G(e){const t=P(e);for(const n of t)if(n.table===b.bx)return n.getSettings().space_request}function $(e){const{environment:t,store:n}=e,o=t.currentUser.id;if(!o)return!1;const r=P(n),i=r.every((e=>Boolean(e.isReady())));if(!i)return;const s=!r.some((e=>Boolean(e instanceof w.G&&!e.isDefined())));if(!s)return!1;const l=r.some((e=>{if(e instanceof w.G){const t=(e.getPermissionItemsStore().getValue()||[]).find((e=>(0,a.$D)(e)||(0,a.hV)(e)||(0,a.ix)(e)||(0,a.RI)(e)||(0,a.ZQ)(e)||(0,a.FB)(e)||(0,a.jg)(e)&&e.user_id!==o));return Boolean(t)}return e instanceof w.zX}));return!l}},85957:(e,t,n)=>{n.d(t,{PQ:()=>d,Tx:()=>s,mH:()=>l,wq:()=>c});var o=n(24646),r=n(4926),i=n(88923),a=n(27724);function s(){return i.default.isCenterPeekOpen()||a.default.isInPeekRenderer()}function l(){const e=i.default.state;return e.open&&(s()||e.isOpening)}function c(e){return Boolean(e.findRecordStoreUIAncestor((e=>e===i.default.peekTarget.state)).ancestor)}function d(e){const t=r.Z.state;return i.default.isSidePeekOpen()?(0,o.vJ)(e):i.default.isCenterPeekOpen()?Math.min(e.WindowSizeStore.state.width-2*i.PeekModeOuterPadding,i.CenterPeekModeOuterWidth+t):0}},46654:(e,t,n)=>{n.d(t,{S4:()=>j,Z9:()=>G,KE:()=>J,uY:()=>se,zT:()=>ce,Dt:()=>re,WE:()=>ae,aG:()=>de,YO:()=>N,rc:()=>oe,su:()=>ee,r_:()=>Q,BZ:()=>X,YF:()=>Y,Oc:()=>z,JI:()=>H,UK:()=>q,yi:()=>W,mU:()=>ne,U7:()=>te,IJ:()=>L,Xu:()=>K,SO:()=>$});n(67635),n(57658);var o=n(66897),r=n(68626),i=n(72126),a=n(59753),s=n(63306),l=n(91627),c=n(54368),d=n(21202),u=n(77420),p=n(15047),m=n(65635),f=n(47969),g=n(29369),h=n(19889),v=n(97880);class b{constructor(e){this.agentPointer=void 0,this.logErrorFn=void 0;const{agentPointer:t,logErrorFn:n}=e;this.agentPointer=t,this.logErrorFn=n}getActorPointer(){return this.agentPointer}getSpaceRole(e){return"none"}getTeamRole(e){return"none"}getGroupRole(e){return"none"}}n(21703);function y(e){const{undecoratedGetRecordModel:t,logErrorFn:n,from:o}=e;return a.om.fromMonomorphicFunctionUnsafe((e=>{const r=t(e);return void 0===r&&n({from:o,type:"NecessaryRecordWasNotProvided",error:new Error(`${o} needed the following record: ${e.table}/${e.id}, but it was not provided`),data:e}),r}),t.getRecordValue)}class _{logIfUnexpectedSpace(e){this.relevantEntities.relevantSpaceIds.has(e)||this.logErrorFn({from:"BotActorMembership",type:"NonRelevantSpaceRequested",error:new Error(`Space role was requested for ${e}, which was not a pre-determined "relevant" space id`),data:{spaceId:e}})}constructor(e){this.botPointer=void 0,this.getRecordModel=void 0,this.logErrorFn=void 0,this.memoizedSpaceRoles=void 0,this.relevantEntities=void 0;const{botPointer:t,getRecordModel:n,logErrorFn:o,relevantEntities:r}=e;this.botPointer=t,this.logErrorFn=o,this.getRecordModel=y({undecoratedGetRecordModel:n,logErrorFn:o,from:"BotActorMembership"}),this.memoizedSpaceRoles={},this.relevantEntities=r}getActorPointer(){return this.botPointer}getSpaceRole(e){this.logIfUnexpectedSpace(e);const t=this.memoizedSpaceRoles[e];if(void 0!==t)return t;const n=this.getRecordModel((0,m.HY)({botId:this.botPointer.id,spaceId:e})),o=void 0===n?"none":n.membership_type;return this.memoizedSpaceRoles[e]=o,this.memoizedSpaceRoles[e]}getTeamRole(e){return"none"}getGroupRole(e){return"none"}}var S=n(64684);class w{logIfUnexpectedSpace(e){this.relevantEntities.relevantSpaceIds.has(e)||this.logErrorFn({from:"UserActorMembership",type:"NonRelevantSpaceRequested",error:new Error(`Space role was requested for ${e}, which was not a pre-determined "relevant" space id`),data:{spaceId:e}})}logIfUnexpectedTeam(e){const{teamId:t,spaceId:n}=e;this.relevantEntities.relevantTeamIds.has(t)||this.logErrorFn({from:"UserActorMembership",type:"NonRelevantTeamRequested",error:new Error(`Team role was requested for ${t}, which was not a pre-determined "relevant" team id`),data:{teamId:t,spaceId:n}})}logIfUnexpectedGroup(e){const{groupId:t}=e;this.relevantEntities.relevantGroupIds.has(t)||this.logErrorFn({from:"UserActorMembership",type:"NonRelevantGroupRequested",error:new Error(`Group role was requested for ${t}, which was not a pre-determined "relevant" group id`),data:e})}constructor(e){this.userPointer=void 0,this.getRecordModel=void 0,this.logErrorFn=void 0,this.relevantEntities=void 0,this.memoizedSpaceRoles=void 0,this.memoizedTeamRoles=void 0,this.memoizedSpaceToGroupMembership=void 0;const{userPointer:t,getRecordModel:n,logErrorFn:o,relevantEntities:r}=e;this.userPointer=t,this.getRecordModel=y({undecoratedGetRecordModel:n,logErrorFn:o,from:"UserActorMembership"}),this.logErrorFn=o,this.relevantEntities=r,this.memoizedSpaceRoles={},this.memoizedTeamRoles={},this.memoizedSpaceToGroupMembership={}}getActorPointer(){return this.userPointer}getSpaceRole(e){this.logIfUnexpectedSpace(e);const t=this.memoizedSpaceRoles[e];if(void 0!==t)return t;const n=this.getRecordModel((0,f.v8)({userId:this.userPointer.id,spaceId:e})),o=void 0===n?"none":n.membership_type;return this.memoizedSpaceRoles[e]=o,this.memoizedSpaceRoles[e]}getTeamRole(e){const{teamId:t,spaceId:n}=e;this.logIfUnexpectedTeam({teamId:t,spaceId:n});const o=this.memoizedTeamRoles[t];if(void 0!==o)return o;const r=this.getRecordModel({table:g.e0,id:t,spaceId:n});if(void 0===r)return this.memoizedTeamRoles[t]="none",this.memoizedTeamRoles[t];const i=[];if(r.isDefault()){"none"!==this.getSpaceRole(r.getSpaceId())&&i.push("member")}r.getRawMembership().forEach((e=>{if("user"===e.entity_type)e.user_id===this.userPointer.id&&i.push(e.type);else if("group"===e.entity_type)if("member"===e.type){"none"!==this.getGroupRole({spaceId:r.getSpaceId(),groupId:e.group_id})&&i.push(e.type)}else(0,v.t1)(e);else(0,v.t1)(e)}));const a=(0,S.uG)(...i);return this.memoizedTeamRoles[t]=a,this.memoizedTeamRoles[t]}getGroupRole(e){const{groupId:t,spaceId:n}=e;this.logIfUnexpectedGroup({groupId:t,spaceId:n});const o=this.getGroupMembershipForSpace(n)[t];if(void 0===o){const e="UserActorMembership";return this.logErrorFn({from:e,type:"NecessaryRecordWasNotProvided",error:new Error(`${e} needed the following (group:${t}, space:${n}, but it was not found`),data:{table:"group",groupId:t,spaceId:n}}),"none"}return o}getGroupMembershipForSpace(e){if(void 0!==this.memoizedSpaceToGroupMembership[e])return this.memoizedSpaceToGroupMembership[e];const t={};this.memoizedSpaceToGroupMembership[e]=t;const n=this.getRecordModel({id:e,table:p.bx});return n?(n.getPermissionGroups().forEach((e=>{var n;null!==(n=e.user_ids)&&void 0!==n&&n.includes(this.userPointer.id)?t[e.id]="member":t[e.id]="none"})),t):t}}let k;k=Symbol.iterator;class I{constructor(e){this.userActorMemberships=void 0,this.botActorMemberships=void 0,this.agentActorMemberships=void 0;const{logErrorFn:t,relevantEntities:n,getRecordModel:o,actorPointers:r}=e;this.userActorMemberships={},this.botActorMemberships={},this.agentActorMemberships={};for(const i of r)i.table===h.KJ?this.userActorMemberships[i.id]=new w({userPointer:i,relevantEntities:n,logErrorFn:t,getRecordModel:o}):i.table===u.cZ?this.botActorMemberships[i.id]=new _({botPointer:i,relevantEntities:n,logErrorFn:t,getRecordModel:o}):i.table===c.y?this.agentActorMemberships[i.id]=new b({agentPointer:i,logErrorFn:t}):(0,v.t1)(i)}getActorMembership(e){return e.table===h.KJ?this.userActorMemberships[e.id]:e.table===u.cZ?this.botActorMemberships[e.id]:e.table===c.y?this.agentActorMemberships[e.id]:void(0,v.t1)(e)}*[k](){yield*Object.values(this.userActorMemberships),yield*Object.values(this.botActorMemberships),yield*Object.values(this.agentActorMemberships)}}var C=n(72141);function x(e){const t=new Set,n=new Set,o=new Set,r=e=>{e.forEach((e=>{if((0,C.hV)(e))o.add(e.group_id);else if((0,C.fG)(e)||(0,C.bm)(e))n.add(e.team_id);else if(!((0,C.jg)(e)||(0,C.FB)(e)||!(0,C.C2)(e)||(0,C.$D)(e)||(0,C.e_)(e)||(0,C.ix)(e)||(0,C.Ix)(e)||(0,C.KK)(e)))throw(0,v.t1)(e)}))};for(const{pointer:i,model:a}of e)if(void 0!==i.spaceId&&t.add(i.spaceId),i.table===p.bx)t.add(i.id);else if(i.table===g.e0){if(n.add(i.id),void 0!==a){const e=a;t.add(e.getSpaceId()),e.getRawMembership().forEach((e=>{"group"===e.entity_type&&o.add(e.group_id)}));r(e.getPermissionItems());const n=e.getParentPointer();n.table===p.bx&&void 0!==n.id&&t.add(n.id)}}else if(i.table===f.WU){const{spaceId:e}=(0,f.KQ)(i.id);t.add(e)}else if(i.table===m.Zx){const{spaceId:e}=(0,m.td)(i.id);t.add(e)}else if(i.table===d.iU&&void 0!==a){const e=a;t.add(e.getSpaceId()),r(e.getPermissionItems())}return{relevantSpaceIds:t,relevantTeamIds:n,relevantGroupIds:o}}var T=n(87479),M=n(4615),P=n(45953),A=n(80444),R=n(83212),D=n(79797),E=n(88893),B=n(35057),F=n(88280),O=n(98165),Z=n(65598),V=n(48779),U=n(95697);function N(e){const t=O.fJ(e),n=T.KJ(t);return T.YO(n)}function L(e,t){const{id:n}=e.currentUser;if((0,V.C)()&&(0,V.Fn)(e))return;let r;if(n){const e=t.getRecordValue({table:h.KJ,id:n});e&&(r=(0,o.dp)(e))}const i=O.qA(t).map((e=>e.getModel())).filter(v.$K);return T.IJ({actor:r,ancestors:i})}function j(e){return N(e).map((e=>{let{permissionItem:t}=e;return t})).some((t=>C.$D(t)&&C.YX(t.role)&&(void 0===t.allow_duplicate||!0===t.allow_duplicate)&&(!e.isTypedCollectionViewBlock()||e.isCollectionViewPageWithContent())))}function z(e){return N(e).map((e=>{let{permissionItem:t}=e;return t})).some((e=>C.$D(e)))}function q(e){return N(e).map((e=>{let{permissionItem:t}=e;return t})).some((e=>C.ix(e)))}async function H(e){const{currentUserRootStore:t}=A.default.state;if(!t)return!1;if(!(0,M.e)(e))return!1;const n=D.G.createChildStore(t,{table:d.iU,id:e});return await n.load(),z(n)}function W(e,t){let n;if(n=t instanceof D.H2?(0,V.jv)(t):N(t).map((e=>{let{permissionItem:t}=e;return t})),1===n.length){const[t]=n;return"user_permission"===t.type&&C.zz(t.role)&&t.user_id===e.currentUser.id}return!1}function K(e){const{subscriptionData:t,newGuestIds:n}=e;if(!t)return!1;const o=(0,B.c4)(t);if(void 0===o)return!1;const r=E.ND(t).map((e=>e.userId)),i=E.hn(t).map((e=>e.userId)),a=new Set([...r,...n]);for(const l of i)a.delete(l);const s=Math.max(o,r.length);return a.size>s}function G(e){if(!e)return!1;const t=(0,B.c4)(e);if(void 0===t)return!0;return E.ND(e).map((e=>e.userId)).length<t}function $(e){const{store:t,permissionItems:n}=e;if(t instanceof D.H2)return!1;const o=F.subscriptionDataStoreInstance.state;if(!o)return!1;return K({subscriptionData:o,newGuestIds:n.filter(C.jg).filter((e=>"none"!==e.role)).map((e=>e.user_id))})}function Q(e){return{editor:"Full access",read_and_write:"Can edit",comment_only:"Can comment",reader:"Can read",none:"No access"}[e]}function Y(e){return!!e&&(e.hasPublicPermission&&"edit"!==e.permission)}function X(e){return!!e&&(e.hasPublicPermission&&"view"===e.permission)}function J(e){let{environment:t,block:n}=e;const o=n.getParentStore();if(!o)return!1;return!Y(O.n3(o)&&R.Z.getMode(t,o))&&o.canEdit()}function ee(){let e=arguments.length>1?arguments[1]:void 0;const t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find((t=>"user_permission"===t.type&&t.user_id===e));return t&&t.role||"none"}function te(){const{currentSpaceStore:e}=A.default.state;return"enterprise"===(null==e?void 0:e.getSubscriptionTier())}function ne(e,t){const n=new Set;var o;(0,Z.Y)(e)?null===(o=e.getPermissionItems())||void 0===o||o.forEach((e=>{C.jg(e)&&n.add(e.user_id)})):e.getPermissionItems().forEach((e=>{C.jg(e)&&n.add(e.user_id)}));return t.filter((e=>"existingUser"!==e.type||!n.has(e.value.id)))}function oe(e){const t=A.default.state.mainEditorCurrentBlockStore;if(!t||!e)return;const n=re({userId:e,store:t}).role;return n&&!T.oF(n)?n:void 0}function re(e){let{userId:t,store:n}=e;return ae({userId:t,store:n})[0]}function ie(e){const{recordMap:t,explicitTeamsRecordMap:n,actorPointers:o,getRecordModelFnFallback:i,logErrorFn:s}=e,c=t||P.Ak.create(),d=a.om.fromRecordMap(t),u=a.om.fromRecordMap(n),p=a.om.tryUntilFound(d,u,i),m=new l.X(o),f=function(e){const{recordMap:t,actorPointers:n,logErrorFn:o,getRecordModelFnWithMaybeMissingRecords:r}=e,i=x(t);return new I({getRecordModel:r,actorPointers:n,logErrorFn:o,relevantEntities:i})}({recordMap:c,getRecordModelFnWithMaybeMissingRecords:p,actorPointers:m,logErrorFn:s??(e=>{const{from:t,type:n,error:o,data:i}=e;r.log({level:"error",from:t,type:n,error:{name:o.name,message:o.message,stack:o.stack},data:{miscDataToConvertToString:i}})})});return{originalRecordMap:c,explicitTeamsRecordMap:n,actorPointersSet:m,actorMemberships:f,temporarySpacesForSpaceUserValues:void 0,type:"loaded_permissions_context"}}function ae(e){let{userId:t,store:n}=e;const o=s.DW(n.pointer,n.getRecordModel),r=O.Pj(n)||A.default.state.currentSpaceStore,a=r&&r.isDefined()&&!o.findLast(T.zX)?[...o,r.getModel()]:o,l=P.Ak.create();a.forEach((e=>{l.setModel(e.pointer,e)}));const c=N(n),d=O.VP(n),u=c.filter((e=>{let{permissionItem:t}=e;return(C.zU(t)||C.LW(t))&&t.team_id!==(null==d?void 0:d.id)})).map((e=>e.permissionItem)),p=O.Eb({store:n,teamPermissionItems:u}),m={table:h.KJ,id:t},f=ie({actorPointers:[m],explicitTeamsRecordMap:p,recordMap:l,getRecordModelFnFallback:n.getRecordModel}),g=T.qY({actorPointer:m,ancestors:a,permissionsContext:f}).map((e=>e.permissionItem));if(0===g.length)return[{type:"user_permission",role:"none",user_id:t}];const v=i.oA(g.map((e=>e.role))),b=T.nl(...v);return g.filter((e=>e.role===b)).sort(le)}function se(e){let{userId:t,store:n}=e;const o=s.DW(n.pointer,n.getRecordModel),r=O.Pj(n)||A.default.state.currentSpaceStore,i=r&&r.isDefined()&&!o.findLast(T.zX)?[...o,r.getModel()]:o,a=P.Ak.create();i.forEach((e=>{a.setModel(e.pointer,e)}));const l=N(n),c=O.VP(n),u=l.filter((e=>{let{permissionItem:t}=e;return(C.zU(t)||C.LW(t))&&t.team_id!==(null==c?void 0:c.id)})).map((e=>e.permissionItem)),p=O.Eb({store:n,teamPermissionItems:u}),m={table:h.KJ,id:t},f=ie({actorPointers:[m],explicitTeamsRecordMap:p,recordMap:a,getRecordModelFnFallback:n.getRecordModel}),v=T.qY({actorPointer:m,ancestors:i,permissionsContext:f}),b=[...v];v.find((e=>"user_permission"===e.permissionItem.type))||b.push({permissionItem:{type:"user_permission",role:"none",user_id:t},from:{table:d.iU,blockId:n.id}});const y=F.subscriptionDataStoreInstance.state,_=new Set(y?E.ND(y).map((e=>e.userId)):[]);if(null!=_&&_.has(t))return b.sort(((e,t)=>le(e.permissionItem,t.permissionItem))).reverse().sort(((e,t)=>C.xm[t.permissionItem.role??"none"]-C.xm[e.permissionItem.role??"none"]));!v.find((e=>"explicit_team_permission"===e.permissionItem.type&&e.permissionItem.team_id===(null==c?void 0:c.id)))&&c&&(0,U.AL)({teamStore:c,spaceStore:r,userId:t})&&b.push({permissionItem:{type:"explicit_team_permission",role:"none",team_id:c.id},from:{table:g.e0,teamId:c.id}});!v.find((e=>"explicit_team_owner_permission"===e.permissionItem.type&&e.permissionItem.team_id===(null==c?void 0:c.id)))&&c&&(0,S.pd)({membership:c.getMembers()},t)&&b.push({permissionItem:{type:"explicit_team_owner_permission",role:"none",team_id:c.id},from:{table:g.e0,teamId:c.id}});return v.find((e=>"space_permission"===e.permissionItem.type))||b.push({permissionItem:{type:"space_permission",role:"none"},from:{table:d.iU,blockId:n.id}}),b.sort(((e,t)=>le(e.permissionItem,t.permissionItem))).reverse().sort(((e,t)=>C.xm[t.permissionItem.role??"none"]-C.xm[e.permissionItem.role??"none"]))}function le(e,t){const n=C.jg(e),o=C.jg(t);if(n||o)return n&&o?0:n?-1:1;const r=C.hV(e),i=C.hV(t);if(r||i)return r&&i?0:r?-1:1;const a=C.Lq(e),s=C.Lq(t);return a||s?a&&s?0:a?-1:1:0}function ce(e){const{botStore:t,addPermission:n}=e,o=n?T.uH(t.getCapabilities()):"none",r=t.getParentId(),i=t.getParentTable();let a={type:"bot_permission",bot_id:t.id,role:o};return r&&i&&(a={type:"bot_permission",bot_id:t.id,role:o,parent_id:r,parent_table:i}),a}function de(e){const t=a.kk.isAnyModel(e)?e.getPermissionItems():e.permissions;return i.oA((t||[]).map((e=>{if((0,C.jg)(e)&&(0,C.Jy)(e.role))return{userId:e.user_id,role:e.role}})))}},45101:(e,t,n)=>{n.d(t,{Aw:()=>C,Bu:()=>P,DF:()=>A,Ji:()=>V,NN:()=>M,Nd:()=>x,OA:()=>F,ZK:()=>Z,Zp:()=>R,a_:()=>B,cm:()=>T,fR:()=>L,gQ:()=>U,t0:()=>N,xT:()=>E,z5:()=>D});n(57658),n(67294);var o=n(15070),r=n(8848),i=n(72141),a=n(4615),s=n(21202),l=n(15047),c=n(97880),d=n(82990),u=n(7928),p=n(9291),m=n(91219),f=n(47307),g=n(80444),h=n(29677),v=n(88893),b=n(35057),y=n(88280),_=n(28020),S=n(33929),w=n(65598),k=n(16639),I=n(85893);async function C(e){let{environment:t,permissionsInviteStoreState:n,from:o}=e;const r=(0,I.jsx)(p.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.confirmationMessage",defaultMessage:"Your changes have not been saved. Discard changes?"}),i=(0,I.jsx)(p.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.confirmationButton.label",defaultMessage:"Yes"}),a=(0,I.jsx)(p.FormattedMessage,{id:"permissionsInvite.closeInviteDialog.cancelButton.label",defaultMessage:"Cancel"});if(n.inviteTargets.length>0){const e=await f.confirmUserAction({message:r,acceptLabel:i,cancelLabel:a});return m.q_(t,{...B(t,n),from:o,discard_changes:e}),!e}return!1}const x=e=>{const{target:t,permissionsInviteStore:n}=e;return n.state.inviteTargets.find((e=>"newUser"===t.type?"newUser"===e.type&&t.value.email===e.value.email:e.type===t.type&&e.value.id===t.value.id))},T=e=>{const{targetStore:t,permissionsInviteStore:n,userTarget:o}=e;return!!x({permissionsInviteStore:n,target:o})||"existingUser"===o.type&&R({target:o,store:t})},M=e=>{const{targetStore:t,permissionsInviteStore:n,currentInviteActors:r}=e;if(!r)return{inviteUsers:[],inviteGroups:[],inviteBots:[]};const i=r.inviteUsers.filter((e=>!T({targetStore:t,permissionsInviteStore:n,userTarget:e})));return{inviteBots:r.inviteBots.filter((e=>!(!e.value.alive||x({permissionsInviteStore:n,target:e})||!(0,o.oA)(e.value)&&!(0,o.c9)(e.value))&&!R({target:e,store:t}))),inviteGroups:r.inviteGroups.filter((e=>!x({permissionsInviteStore:n,target:e})&&!R({target:e,store:t}))),inviteUsers:i,importedContacts:r.importedContacts}},P=(e,t)=>{if(!e||!t||0===e.length||0===t.length)return t;const n=new Set(e.map((e=>e.value.email.toLowerCase())));return t.filter((e=>!n.has(e.value.email.toLowerCase())))},A=e=>{const{intl:t,target:n}=e;switch(n.type){case"newUser":return n.value.email;case"existingUser":return(0,u.Nz)(t,n.value);case"bot":return(0,o.Mh)(n.value);case"group":return(0,k.kF)({intl:t,group:n.value});default:(0,c.t1)(n)}},R=e=>{const{target:t,store:n}=e;return!!n.isDefined()&&((0,w.Y)(n)?n.getMembers().filter((e=>{switch(t.type){case"existingUser":return"user"===e.entity_type&&t.value.id===e.user_id;case"group":return"group"===e.entity_type&&t.value.id===e.group_id}})).length>0:n.getPermissionItems().some((e=>{switch(t.type){case"existingUser":return(0,i.jg)(e)&&e.user_id===t.value.id;case"bot":return(0,i.FB)(e)&&e.bot_id===t.value.id;case"group":return(0,i.hV)(e)&&e.group_id===t.value.id;case"newUser":return!1;default:return(0,c.t1)(t)}})))};function D(e){const{environment:t,permissionsInviteStore:n,store:o,renderInShareModal:r}=e;n.setState({modalOpen:!r,tokenQuery:"",inviteTargets:[],inviteRole:E(e),isInviteTargetsEmpty:!0,table:(0,w.Mm)(o)?l.bx:s.iU,flowId:(0,a.ZP)(),inputFocus:"invitee",emailMessage:""}),(0,w.Mm)(o)?m.$z(t):m.Mq(t,{...B(t,e.permissionsInviteStore.state)})}function E(e){const{store:t,isSubscribed:n}=e;return(0,w.Mm)(t)?n?"read_and_write":"editor":(0,b.Mk)()?"editor":"read_and_write"}function B(e,t){var n;const{isInviteTargetsEmpty:o,inviteRole:r,flowId:i}=t,a=(0,_.np)(),s=null==a?void 0:a.getRole(),l=null===(n=g.default.state.currentSpaceStore)||void 0===n?void 0:n.getRole(),{inviteTargets:c,emailMessage:d}=t,u=(0,b.zt)(),p={invite_flow_id:i,user_count:0,is_bot:!1,invite_message_length:(null==d?void 0:d.length)??0,...s&&{page_current_user_role:s},...l&&{space_role:l},...u&&{subscription_tier:u}};if(o)return p;if(0===c.length)return p;if(function(e){return e.length>0&&"bot"===e[0].type}(c))return{...p,is_bot:!0};const m=c.filter(h.cl).length,f=c.filter(h.fZ).length+m;return{...p,role:r,user_count:f,new_user_count:m}}function F(e){return"newUser"===e.type||"existingUser"===e.type&&("none"===e.spaceRole||"not_in_space"===e.spaceRole)}const O=(0,p.defineMessages)({workspaceOwnerTooltip:{id:"inviteUserModal.userRole.workspaceOwnerBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a workspace owner in this workspace"},workspaceOwnerBadge:{id:"inviteUserModal.userRole.workspaceOwnerBadge.label",defaultMessage:"Workspace Owner"},adminTooltip:{id:"inviteUserModal.userRole.adminBadge.tooltip",defaultMessage:"{ userNameAndEmail} is an admin in this workspace"},adminBadge:{id:"inviteUserModal.userRole.adminBadge.label",defaultMessage:"Admin"},membershipAdminTooltip:{id:"inviteUserModal.userRole.membershipAdminBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a membership admin in this workspace"},membershipAdminBadge:{id:"inviteUserModal.userRole.membershipAdminBadge.label",defaultMessage:"Membership admin"},memberTooltip:{id:"inviteUserModal.userRole.memberBadge.tooltip",defaultMessage:"{ userNameAndEmail} is a member in this workspace"},memberBadge:{id:"inviteUserModal.userRole.memberBadge.label",defaultMessage:"Member"},guestTooltip:{id:"inviteUserModal.userRole.guest.tooltip",defaultMessage:"{ userNameAndEmail} is a guest in this workspace"},guestBadge:{id:"inviteUserModal.userRole.guestBadge.label",defaultMessage:"Guest"}});function Z(e){const{environment:t,customStyle:n}=e,{device:o}=t;return{display:"inline-flex",height:18,textTransform:"uppercase",fontSize:10,marginBottom:2,fontWeight:d.Z.fontWeight.medium,letterSpacing:1,color:r.ZP.uiLightGray,border:`1px solid ${r.ZP.uiLightGray}`,minWidth:70,alignItems:"center",justifyContent:"center",paddingTop:o.isAndroid?2:1,paddingBottom:1,paddingLeft:3,paddingRight:3,borderRadius:4,...n}}function V(e){const{role:t,intl:n,nameOrEmail:o}=e,r=o||n.formatMessage({id:"userTypeTooltip.generalPerson",defaultMessage:"This person"});switch(t){case"editor":return{tooltip:n.formatMessage(O.workspaceOwnerTooltip,{userNameAndEmail:r}),userRoleBadge:n.formatMessage(O.workspaceOwnerBadge)};case"membership_admin":return{tooltip:n.formatMessage(O.membershipAdminTooltip,{userNameAndEmail:r}),userRoleBadge:n.formatMessage(O.membershipAdminBadge)};case"read_and_write":return{tooltip:n.formatMessage(O.memberTooltip,{userNameAndEmail:r}),userRoleBadge:n.formatMessage(O.memberBadge)};case"none":return{tooltip:n.formatMessage(O.guestTooltip,{userNameAndEmail:r}),userRoleBadge:n.formatMessage(O.guestBadge)};default:(0,c.t1)(t)}}function U(e){return F(e)?"rgba(246, 192, 80, 0.26)":void 0}function N(e){var t;const{inviteTargets:n,recordStore:o,canEditSpaceMembership:r}=e;if(0===n.length)return null;if(!o)return null;const{inviteTargetGuests:i,inviteTargetMembers:a}=function(e){const t=[],n=[];return e.forEach((e=>{F(e)?t.push(e):n.push(e)})),{inviteTargetGuests:t,inviteTargetMembers:n}}(n),s=r?[...a,...i]:a,l=r?[]:i,c=S.default.getIntl(),d=(0,w.OY)(o)?null===(t=o.getBlockTitleStore())||void 0===t?void 0:t.getValue():o.getName();return r||0===l.length?(0,I.jsx)(p.FormattedMessage,{id:"permissionsInvite.inviteConfirmationToast.usersAddedMessage",defaultMessage:"{numberOfTargets, plural, one {Added {targetName} to {recordName}} other {Added {numberOfTargets} people to {recordName}}}",values:{numberOfTargets:s.length,targetName:A({intl:c,target:s[0]}),recordName:d}}):0===s.length?(0,I.jsx)(p.FormattedMessage,{id:"permissionsInvite.inviteConfirmationToast.inviteRequestedMessage",defaultMessage:"{numberOfTargets, plural, one {Requested {targetName} for approval} other {Requested {numberOfTargets} invites for approval}}",values:{numberOfTargets:l.length,targetName:A({intl:c,target:l[0]})}}):(0,I.jsx)(p.FormattedMessage,{id:"permissionsInvite.inviteConfirmationToast.userAddedAndRequestedText",defaultMessage:"{numberOfAddedTargets, plural, one {Added {addedTargetName}} other {Added {numberOfAddedTargets} people}} & {numberOfRequestedTargets, plural, one {requested {requestedTargetName} for approval} other {requested {numberOfRequestedTargets} people for approval}}",values:{numberOfAddedTargets:s.length,addedTargetName:A({intl:c,target:s[0]}),numberOfRequestedTargets:l.length,requestedTargetName:A({intl:c,target:l[0]})}})}function L(e){if("existingUser"!==e.type)return;const t=y.subscriptionDataStoreInstance.state,n=(t?v.CM(t):[]).find((t=>t.userId===e.value.id));return n?n.role:"not_in_space"}},13273:(e,t,n)=>{n.d(t,{Xt:()=>i,al:()=>l,jM:()=>s,yT:()=>a});var o=n(43250),r=n(62619);function i(e){const{menuElement:t,clickedElement:n}=e;return t!==n&&!t.contains(n)&&(!n.classList.contains("notion-link")&&!(n.closest(`.${o.mJW}`)&&!n.closest(`.${o.p1Q}`)&&!n.closest(`.${o.Nn$}`)&&!n.closest(`.${o.fHd}`)))}function a(e){if((0,r.sh)(e,(e=>e.classList&&(e.classList.contains(o.p1Q)||e.classList.contains(o.Nn$)||e.classList.contains(o.fHd)))))return!1;const t=(0,r.sh)(e,(e=>e.classList&&e.classList.contains(o.mJW)));return Boolean(t)}function s(e){const t=(0,r.sh)(e,(e=>e.classList&&e.classList.contains(o.Dkf)));return Boolean(t)}function l(e){const t=(0,r.sh)(e,(e=>e.classList&&e.classList.contains(o.RIA)));return Boolean(t)}},17504:(e,t,n)=>{n.d(t,{V:()=>i,Z:()=>a});var o=n(74948),r=n(12534);const i=e=>{(0,r.ZP)({event:e,context:r.Af.SidebarMouseMove,callback:()=>{o.close()}})};const a=function(e){return e({onMouseMove:i})}},55227:(e,t,n)=>{n.d(t,{g7:()=>s,kF:()=>c});n(57658);var o=n(72126),r=n(70203),i=n(62619);const a=e=>e&&e[1];function s(e){let t="";const n=document.createElement("div");n.innerHTML=e;const r=i.kd(n);for(const i of r){const e=o.YU(i.data);if(null!==i.parentElement&&i.parentElement!==n){t+=`<span class="${l({parent:i.parentElement,root:n}).join(" ")}">${e}</span>`}else t+=e}return t}function l(e){const{parent:t,root:n}=e,o=new Set;let r=t;for(;r&&r!==n;)r.classList.forEach((e=>{o.add(e)})),r=r.parentElement??void 0;return Array.from(o)}function c(e,t){const n={text:d(e),syntax:d(t)},o=p(u(n.text,n.syntax)),i={text:0,syntax:0},s={text:0,syntax:0},l=[],c=e.map(r.WiV).join("");for(const[r,d]of o){const e=r+d,o=t[i.syntax],u={value:c.substring(r,e),textTokenIndex:i.text,classNames:a(o)};l.push(u);const p=n.text[i.text],m=n.syntax[i.syntax];e>=s.text+p&&(i.text+=1,s.text+=p),e>=s.syntax+m&&(i.syntax+=1,s.syntax+=m)}return l}const d=e=>e.map((e=>e[0].length)),u=(e,t)=>{const n=e.slice(),o=t.slice(),r=[];let i=0,a=0;for(;i<n.length&&a<o.length;){const e=n[i],t=o[a];e===t?(r.push(e),i+=1,a+=1):e<t?(r.push(e),i+=1,o[a]-=e):(r.push(t),n[i]-=t,a+=1)}return r},p=e=>{let t=0;return e.reduce(((e,n)=>(e.push([t,n]),t+=n,e)),[])}},70219:(e,t,n)=>{n.d(t,{b:()=>i});var o=n(95477),r=n(81236);function i(e){return t=>{const{RouterStore:n}=e;if("page"!==n.state.route.name||!n.state.route.requestedOnPublicDomain)return;const i=r.Z.getPublicSpaceData(e,t),a=(null==i?void 0:i.domain)||n.state.route;return`${window.location.protocol}//${a}.${o.default.publicDomainName}`}}},58239:(e,t,n)=>{n.d(t,{ZT:()=>c,lX:()=>a,rq:()=>s});var o=n(15157),r=n(21202),i=n(15047);async function a(e){let{currentUserId:t,spaceStore:n}=e;const r=o.Z.get({userId:t,key:l(n.id)});return u(n,n.loadRecordModel,r)}function s(e){let{currentUserId:t,spaceId:n,value:r}=e;o.Z.set({userId:t,key:l(n),value:r})}const l=function(e){return`quickAddParent3:${e}`};function c(e){let{currentUserId:t,spaceId:n,parent:r,databaseType:i}=e;o.Z.set({userId:t,key:d(n,i),value:r})}const d=function(e,t){return`quickAddTypedParent:${e}:${t||"default"}`};async function u(e,t,n){let o;if(n)if("page"===n.type){await t({table:r.iU,id:n.id})&&(o=n)}else if("space"===n.type){await t({table:i.bx,id:n.id})&&(o=n)}return o||{type:"space-private-pages",spaceId:e.id}}},15447:(e,t,n)=>{n.d(t,{Od:()=>g,Wk:()=>b,X4:()=>p,_5:()=>v,_k:()=>h,h_:()=>f,rw:()=>m});n(57658);var o=n(14577),r=n(72126),i=n(54642),a=n(18245),s=n(80444),l=n(77080),c=n(69327),d=n(29026);const u=1e3,p=new o.Z((()=>{const{currentSpaceStore:e}=s.default.state;if(!e)return[];return c.Z.getWithoutSubscribing(e.id).slice(0,u).filter((e=>!e.store.pathIsDead()))}),{debugName:"recentAlivePagesStore"});function m(e,t){if("object"==typeof t&&t){const{spaceId:e,blockId:n,visitedAt:o}=t.userPageVisit||{};if(!e||!n||!o)return;!function(e){let{spaceId:t,pageId:n,visitedAt:o}=e;const r=c.Z.getWithoutSubscribing(t),i={pageId:n,visitedAt:o},a=function(e){let{newRecentPage:t,currentRecentPages:n}=e;const o=n.filter((e=>e.pageId!==t.pageId)),r=o;let i=0;for(;i<o.length;i++)if(t.visitedAt>=o[i].visitedAt){r.splice(i,0,t);break}i===o.length&&r.push(t);return r}({newRecentPage:i,currentRecentPages:r});c.Z.set(t,a),p.recompute()}({spaceId:e,pageId:n,visitedAt:o})}}async function f(e){let{environment:t,userId:n,spaceId:o}=e;const s=l.default.getGroup("search-more-recent-pages-in-local"),d="lazy-";let u;s.startsWith(d)&&(u=r.o5(s.slice(5))||void 0);const m=s.startsWith(d),f=a.default.mark("load_global_recent_pages_initial_load"),g=a.default.mark("load_global_recent_pages");async function h(e,r){const l=await i.getRecentPageVisits(t,{userId:n,spaceId:o,limit:e},n);"success"===l.type&&(a.default.measure(r,{environment:t,data:{experiment_group:s}}),c.Z.set(o,l.data.pages.map((e=>({pageId:e.id,visitedAt:e.visitedAt}))))),p.recompute()}m?(h(u,g),await h(void 0,f)):await h(u,g)}async function g(e,t){var n,o;let{environment:r,userId:a,spaceId:s}=t;if(c.Z.getWithoutSubscribing(s).length>u)return!1;const l=await i.getRecentPageVisits(r,{userId:a,spaceId:s,beforeTimestamp:e,limit:d.Xv},a);if("success"!==l.type||l.data.pages.length<=0)return!1;const m=l.data.pages.map((e=>({pageId:e.id,visitedAt:e.visitedAt}))),f=null===(n=c.Z.get(s))||void 0===n?void 0:n.length;c.Z.mergeRecentPages(m,s);const g=null===(o=c.Z.get(s))||void 0===o?void 0:o.length;return p.recompute(),f!==g}const h=["today","yesterday","past_week","past_30_days","older"];function v(e){const t=Date.now(),n=864e5,o=t-e,r=new Date(e).getDay(),i=new Date(t).getDay(),a=new Date(t);a.setDate(a.getDate()-1);const s=a.getDay();return r===i&&o<=n?"today":r===s&&o<=1728e5?"yesterday":o<=6048e5?"past_week":o<=2592e6?"past_30_days":"older"}function b(e){return null==e?void 0:e.map((e=>({visitedAt:e.visitedAt,pageId:e.pageId}))).sort(((e,t)=>t.visitedAt-e.visitedAt)).slice(0,50)}},44133:(e,t,n)=>{n.r(t),n.d(t,{getDebugSourcesForIdsInOperations:()=>c,setBlockIdDebugSource:()=>s,setupRecordCacheDebugging:()=>a});var o=n(39593);let r=!1;const i=new(n.n(o)())({max:1e4});function a(e){e.isMobile||(r=!0)}function s(e,t){r&&(i.has(e)||i.set(e,t))}const l=/[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}/g;function c(e,t){const n={blocks:{},isIdSourceCacheFull:i.itemCount===i.max},o=JSON.stringify(t),r=new Set(Array.from(o.matchAll(l)).map((e=>e[0])));for(const s of r){var a;let t=!1;const o={},r=i.get(s);r&&(t=!0,o.debugSource=r);const l=e.defaultRecordCache.inMemoryRecordCache.getRecord({pointer:{table:"block",id:s},userId:e.currentUser.id});null!=l&&null!==(a=l.value)&&void 0!==a&&a.type&&(t=!0,o.blockType=l.value.type),t&&(n.blocks[s]=o)}return n}},65598:(e,t,n)=>{n.d(t,{D4:()=>Z,GP:()=>z,HK:()=>V,M1:()=>$,MI:()=>x,Mm:()=>W,No:()=>q,OY:()=>_,Oh:()=>G,PF:()=>F,SJ:()=>k,Sd:()=>T,Xp:()=>B,Y:()=>y,ak:()=>O,al:()=>A,bB:()=>E,bQ:()=>L,dv:()=>P,dz:()=>Q,ig:()=>N,le:()=>U,mY:()=>D,sl:()=>H,vV:()=>R,x8:()=>w,yJ:()=>S,zP:()=>j});var o=n(92595),r=n(68626),i=n(72126),a=n(606),s=n(70921),l=n(21202),c=n(70279),d=n(33709),u=n(15047),p=n(29369),m=n(97880),f=n(34047),g=n(79797),h=n(13105),v=n(98165);const b=128;function y(e){return e.table===p.e0}function _(e){return e.table===l.iU}function S(e){return A(e,{recursivelyLoadAllDiscussions:!1}).filter(f.De)}function w(e){return(0,g.Vh)(e,e.pointer,"discussions")}function k(e){let t=0;return e.findRecordStoreUIAncestor((n=>(n!==e&&e.id&&n.id===e.id&&n.table===e.table&&i.Xy(e.path,n.path)&&t++,!1))),t>1}const I=new h.P({debugName:"recursiveChildBlocks",memoizeRecursion:!0,deepEquals:!1,compute:function(e,t){if(k(e))return[];return e.getContentStores().map((e=>{switch(e.getType()){case"page":return;case"transclusion_reference":return e.getTransclusionReferenceTargetStore();default:return e}})).filter(m.$K).flatMap((e=>[e,...t(e)]))}}),C=new h.P({debugName:"recursiveWihTransclusionChildBlocks",memoizeRecursion:!0,deepEquals:!1,compute:function(e,t){if(k(e))return[];return e.getContentStores().map((e=>{if("page"!==e.getType())return e})).filter(m.$K).flatMap((e=>[e,...t(e)]))}});function x(e){const{blockStore:t,traverseTransclusionReferences:n}=e;return n?I.getStateFor(t):C.getStateFor(t)}function*T(e){const{blockStores:t,traverseTransclusionReferences:n}=e;for(const o of t){yield o;for(const e of x({blockStore:o,traverseTransclusionReferences:n}))yield e}}const M=new h.P({debugName:"loadedDiscussionStores",memoizeRecursion:!1,deepEquals:!1,compute:function(e){const t=w(e),n=((null==t?void 0:t.getValue())||[]).map((t=>g.t1.createChildStore(e,a.dr.fromPointerLike({table:d.qF,id:t,spaceId:e.pointer.spaceId}))));return n.reverse(),n}});function P(e){return e.table===c.x_}function A(e,t){const n=t.excludeSelf?[]:[e],o=null!=t&&t.recursivelyLoadAllDiscussions?[...n,...I.getStateFor(e)]:n,r=new Set;return o.flatMap(M.getStateFor).filter((e=>!!(null!=t&&t.includeLoadingDiscussions||e.isDefined())&&(!r.has(e.id)&&(r.add(e.id),!0))))}function R(e,t){return E(A(e,t)).unresolved}function D(e,t){return E(A(e,t)).resolved}function E(e){const t=e.filter((e=>e.isDefined())),[n,o]=i.uK(t,(e=>e.getResolved()));return{resolved:n,unresolved:o}}function B(e,t){return(Array.isArray(e)?e:R(e,t)).reduce(((e,n)=>{const o=n.getValue();return o?t.onlyIncludeBlockLevelDiscussions&&!(0,f.De)(n)?e:e+(o.comments||[]).length:e}),0)}function F(e){if("text"!==e.getType())return!1;const t=e.getBlockTitleStore().getValue();return(!t||!t.length)&&(!e.hasContent()&&0===function(e,t){return R(e,t).length}(e,{recursivelyLoadAllDiscussions:!1}))}function O(e){return(0,g.Vh)(e,e.pointer,"comments")}function Z(e){if(!e)return[];const t=O(e);return(t.getValue()||[]).map((e=>g.T5.createChildStore(t,{table:c.x_,id:e,spaceId:t.pointer.spaceId})))}function V(e){if(e.isDefined())return g.t1.createChildStore(e,e.getParentPointer())}function U(e){const t=N(e);return(t.getValue()||[]).map((n=>g.G.createChildStore(t,a.dr.fromPointerLike({table:l.iU,id:n,spaceId:e.pointer.spaceId}))))}function N(e){return(0,g.Vh)(e,e.pointer,"content")}function L(e){return(0,g.Vh)(e,e.pointer,"last_edited_time")}function j(e){return(0,g.Vh)(e,e.pointer,"text")}function z(e){if(e.isDefined())return g.t1.createChildStore(e,e.getParentPointer())}function q(e,t,n){return g.t1.createChildStore(e,{table:s.TY,id:t,spaceId:n})}function H(e){if(e.isDefined())return q(e,e.getActivityId(),e.getSpaceId())}function W(e){return e.table===u.bx}(0,o.exposeDebugValue)("getDiscussionStores",A);const K=i.P2((e=>{r.log(e)}),500),G=function(e){let t=e,n=0;for(;t;){if(!t.isReady())return!1;if(n>=b)return K({level:"error",from:"recordStoreHelpers",type:"areAncestorsLoaded",data:{message:"max depth reached",miscDataToConvertToString:{maxDepth:b,id:e.id,table:e.table,currentStoreId:t.id,currentTable:t.table}}}),!1;n+=1,t=(0,v.Om)(t)}return!0};async function $(e){let t=e,n=0;for(;t;){if(t.isReady()||await t.load(),n>=b)return K({level:"error",from:"recordStoreHelpers",type:"loadAncestors",data:{message:"max depth reached",miscDataToConvertToString:{maxDepth:b,id:e.id,table:e.table,currentStoreId:t.id,currentTable:t.table}}}),!1;n+=1,t=(0,v.Om)(t)}}function Q(e){return e.table===l.iU&&i.Xy(e.path,["content"])}},37034:(e,t,n)=>{n.d(t,{NO:()=>u,V:()=>p,vU:()=>m});var o=n(17215),r=n(42875),i=n(82883),a=n(13493),s=n(10906),l=n(79797),c=n(65183),d=n(48779);function u(e,t){if(e.isDefined())return e.getModel().getEmptyTitlePlaceholder({getRecordModel:e.getRecordModel,userTimeZone:(0,r.r)(),intl:t})}function p(e,t,n,a){if(e instanceof l.zX)return e.getName();if(e instanceof l.H2)return(0,d.rn)(n,e);if(e instanceof l.Xr){const t=e.getName();if(t)return t;const n=e.getType();return n?c.Bh[n]:void 0}if("none"===e.getRole())return o.x(t);if(!e.isDefined())return;const s=e instanceof l.G?e.getTitleValue():e.getName();return(0,i.X)({textValue:s,getRecordModel:e.getRecordModel,userTimeZone:(0,r.r)(),intl:t,disableInsertedAnnotations:a})}function m(e){const{environment:t,intl:n,untitledFallback:r,store:i}=e,l=r?n.formatMessage(r):function(e,t){if(e.table===a.n){const n=e.getType();if(n&&"page"!==n&&s.b1[n])return t.formatMessage(s.b1[n])}return o.Q2(t)}(i,n);return p(i,n,t,!1)||u(i,n)||l}},81166:(e,t,n)=>{n.d(t,{Bq:()=>I,l7:()=>f,W3:()=>g,uM:()=>k,qi:()=>y,Gt:()=>b,cn:()=>C,OH:()=>_,g3:()=>S,K9:()=>w,vi:()=>x,nB:()=>v,Tq:()=>h,dH:()=>m});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("dateInterval",{viewBox:"0 0 20 20",svg:(0,r.jsx)(r.Fragment,{children:(0,r.jsx)("path",{d:"M4.345 10.359l1.832 1.36c.191.146.378.182.56.11.183-.074.274-.226.274-.459v-.847H8.96a.52.52 0 00.54-.533.513.513 0 00-.157-.376.521.521 0 00-.383-.158H7.01V8.63c0-.246-.093-.4-.28-.465-.186-.068-.371-.034-.553.103L4.345 9.64a.43.43 0 00-.185.362c0 .146.062.264.185.356zm11.31 0l-1.832 1.36c-.191.146-.378.182-.56.11-.183-.074-.274-.226-.274-.459v-.847H11.04a.533.533 0 01-.383-.15.521.521 0 01-.157-.383c0-.146.052-.272.157-.376a.521.521 0 01.383-.158h1.95V8.63c0-.246.093-.4.28-.465.186-.068.371-.034.553.103l1.832 1.374a.43.43 0 01.185.362.423.423 0 01-.185.356zM3.378 15.16c.183 0 .33-.051.445-.16a.553.553 0 00.17-.42V5.449a.592.592 0 00-.17-.438.601.601 0 00-.445-.17.592.592 0 00-.437.17.592.592 0 00-.171.438v9.132c0 .173.057.31.17.42s.26.16.438.16zm13.24 0c.183 0 .33-.051.445-.16a.552.552 0 00.17-.42V5.447a.592.592 0 00-.17-.437.6.6 0 00-.445-.17.592.592 0 00-.437.17.593.593 0 00-.171.437v9.132c0 .173.057.31.17.42.115.11.26.16.438.16z"})})}),a=(0,o.I)("hand",{viewBox:"0 0 28 28",svg:(0,r.jsx)("path",{d:"M13.6572 23.1553C16.918 23.1553 19.1943 21.415 20.416 17.9873L21.9893 13.584C22.1035 13.2588 22.1562 12.9512 22.1562 12.6611C22.1562 11.6592 21.4092 10.9209 20.416 10.9209C19.7832 10.9209 19.2119 11.2812 18.9131 11.9668L18.4385 13.1182C18.4209 13.1533 18.4033 13.1709 18.3682 13.1709C18.3242 13.1709 18.3066 13.1445 18.3066 13.1006V6.35059C18.3066 5.23438 17.5771 4.51367 16.4961 4.51367C16.1621 4.51367 15.8545 4.61914 15.6172 4.82129C15.4414 3.93359 14.8174 3.38867 13.9121 3.38867C13.0332 3.38867 12.3916 3.94238 12.207 4.80371C11.9873 4.61035 11.7061 4.51367 11.4072 4.51367C10.3965 4.51367 9.70215 5.2168 9.70215 6.2627V7.08008C9.48242 6.86914 9.16602 6.75488 8.83203 6.75488C7.82129 6.75488 7.10938 7.51074 7.10938 8.58301V16.2822C7.10938 20.5361 9.72852 23.1553 13.6572 23.1553ZM13.6133 21.6523C10.4668 21.6523 8.54199 19.6484 8.54199 16.124V8.75C8.54199 8.41602 8.75293 8.1875 9.06934 8.1875C9.39453 8.1875 9.62305 8.41602 9.62305 8.75V13.2764C9.62305 13.6543 9.93066 13.918 10.2822 13.918C10.6426 13.918 10.9502 13.6543 10.9502 13.2764V6.48242C10.9502 6.14844 11.1611 5.91992 11.4863 5.91992C11.8027 5.91992 12.04 6.14844 12.04 6.48242V12.8105C12.04 13.1885 12.3389 13.4609 12.6904 13.4609C13.0508 13.4609 13.3584 13.1885 13.3584 12.8105V5.36621C13.3584 5.04102 13.5869 4.79492 13.9033 4.79492C14.2197 4.79492 14.4482 5.04102 14.4482 5.36621V12.7051C14.4482 13.0654 14.7383 13.3467 15.0986 13.3467C15.4678 13.3467 15.7666 13.0654 15.7666 12.7051V6.48242C15.7666 6.14844 15.9863 5.91992 16.3115 5.91992C16.6279 5.91992 16.8564 6.14844 16.8564 6.48242V15.2451C16.8564 15.7549 17.1816 16.0449 17.6035 16.0361C17.9551 16.0361 18.2715 15.8779 18.4824 15.4121L19.748 12.5732C19.8975 12.2305 20.1963 12.125 20.4688 12.2217C20.7676 12.3359 20.8643 12.626 20.7236 13.0039L19.0889 17.5127C17.999 20.501 16.1621 21.6523 13.6133 21.6523Z"})}),s=(0,o.I)("overlap",{viewBox:"0 0 20 20",svg:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("path",{d:"M4.917 14.496h1.729v-1.1H4.93c-.342 0-.604-.091-.786-.274-.182-.182-.273-.45-.273-.806V5.52c0-.356.09-.625.273-.807.182-.182.444-.273.786-.273h6.83c.336 0 .596.09.779.273.186.182.28.451.28.807v1.497h1.1V5.459c0-.702-.18-1.23-.54-1.586-.355-.355-.888-.533-1.6-.533H4.918c-.716 0-1.254.178-1.614.533-.355.351-.533.88-.533 1.586v6.918c0 .707.178 1.237.533 1.593.36.35.898.526 1.614.526zm3.315 3.165h6.863c.711 0 1.244-.177 1.6-.533.36-.355.54-.884.54-1.586V8.624c0-.702-.18-1.23-.54-1.586-.356-.355-.889-.533-1.6-.533H8.232c-.716 0-1.253.178-1.613.533-.356.351-.534.88-.534 1.586v6.918c0 .707.178 1.235.534 1.586.36.356.897.533 1.613.533zm.014-1.1c-.342 0-.604-.091-.787-.274-.182-.182-.273-.45-.273-.806V8.686c0-.356.091-.625.273-.807.183-.182.445-.273.787-.273h6.829c.337 0 .597.09.779.273.187.182.28.451.28.807v6.795c0 .355-.093.624-.28.806-.182.183-.442.274-.78.274H8.247z"}),(0,r.jsx)("path",{d:"M13.976 12.448l-1.832 1.36c-.192.147-.379.183-.561.11-.182-.073-.273-.225-.273-.458v-.848H9.7a.533.533 0 01-.383-.15.521.521 0 01-.157-.383c0-.145.053-.27.157-.376s.233-.157.383-.157h1.61v-.827c0-.246.093-.401.28-.465.187-.068.371-.034.554.103l1.832 1.374a.43.43 0 01.184.362.423.423 0 01-.184.356z"})]})});var l=n(97880),c=n(9291),d=n(51592);const u=(0,c.defineMessages)({dependenciesPropertySelectDefaultOptionCaption:{id:"database.viewSettings.relationFeatures.dependencies.propertySelectPopup.default.caption",defaultMessage:"This property will be used for dependencies in new views, and will set date shifting behavior across all views."},deleteDependenciesAcceptModalTitle:{id:"collectionSettings.relationFeatures.deleteDependenciesAcceptModal.title",defaultMessage:"Turn off dependencies?"},dependenciesMenuTitle:{id:"database.viewSettings.dependenciesTab.title",defaultMessage:"Dependencies"},dateShiftingSectionCaption:{id:"collectionSettings.dependenciesView.dateShiftingSection.caption",defaultMessage:"Automatic date shifting"},datePropertyPickerTitle:{id:"database.viewSettings.relationFeatures.datePropertyPicker.title",defaultMessage:"Shift using"},startDate:{id:"database.viewSettings.relationFeatures.datePropertyPicker.startDate",defaultMessage:"Start date"},endDate:{id:"database.viewSettings.relationFeatures.datePropertyPicker.endDate",defaultMessage:"End date"},advancedSettings:{id:"database.viewSettings.dependenciesAdvancedSettingsTab.title",defaultMessage:"Advanced settings"},newDateProperty:{id:"collectionSettings.dependenciesFeature.newDateProperty.name",defaultMessage:"Date"},doNotShiftButton:{id:"collectionSettings.dependenciesView.dateShiftingButton.doNotShift.label",defaultMessage:"Do not automatically shift"},consumeGapButton:{id:"collectionSettings.dependenciesView.dateShiftingButton.consumeGap.label",defaultMessage:"Shift only when dates overlap"},avoidWeekendsSwitcherTitle:{id:"collectionSettings.dependenciesView.dateShiftingSection.avoidWeekends.switcher.title",defaultMessage:"Avoid weekends"},hideDependenciesInView:{id:"CollectionSettingsViewRelationFeatures.hideDependenciesInView",defaultMessage:"Hide dependencies in view"},showDependenciesInView:{id:"CollectionSettingsViewRelationFeatures.showDependenciesInView",defaultMessage:"Show dependencies in view"},turnOnDependenciesButton:{id:"collectionSettings.dependenciesView.turnOnDependenciesButton.label",defaultMessage:"Turn on dependencies"},turnOffDependenciesButton:{id:"database.viewSettings.relationsPropertyTab.removeDependenciesButton.title",defaultMessage:"Turn off dependencies"},dateShiftSuccess:{id:"collectionDateActions.dateShiftSuccess",defaultMessage:"Shifted the dates of {numDependenciesUpdated, plural, one {1 dependent {item}} other {{numDependenciesUpdated} dependent {items}}}"},dateShiftSomeNotUpdatedDueToPermissions:{id:"collectionDateActions.dateShiftSomeNotUpdatedDueToPermissions",defaultMessage:"Shifted the dates of {numDependenciesUpdated, plural, one {1 dependent {item}} other {{numDependenciesUpdated} dependent {items}}}. Others could not be shifted because you do not have permission"},dateShiftAllNotUpdatedDueToPermissions:{id:"collectionDateActions.dateShiftAllNotUpdatedDueToPermissions",defaultMessage:"The dates of dependent {items} could not be shifted because you do not have permission"},shiftingNotApplicableNoShiftingMessage:{id:"CollectionSettingsViewRelationFeatures.shiftingNotApplicableNoShiftingMessage",defaultMessage:"The dates of dependent {items} in this view will not automatically shift. To change the date shifting behavior, update the default relation property in Advanced settings."},shiftingNotApplicableConsumeGapMessage:{id:"CollectionSettingsViewRelationFeatures.shiftingNotApplicableConsumeGapMessage",defaultMessage:"The dates of dependent {items} in this view will shift when {item} dates overlap. To change the date shifting behavior, update the default relation property in Advanced settings."},shiftingNotApplicablePreserveGapMessage:{id:"CollectionSettingsViewRelationFeatures.shiftingNotApplicablePreserveGapMessage",defaultMessage:"The dates of dependent {items} in this view will shift maintaining the time between {items}. To change the date shifting behavior, update the default relation property in Advanced settings."},preserveGapButton:{id:"collectionSettings.dependenciesView.dateShiftingButton.preserveGap.label",defaultMessage:"Shift & maintain time between {items}"},avoidWeekendsSwitcherCaption:{id:"collectionSettings.dependenciesView.dateShiftingSection.avoidWeekends.switcher.description",defaultMessage:"Prevent shifted {items} from starting or ending on weekends"},dependenciesMenuDescription:{id:"database.viewSettings.relationsPropertyTab.dependencies.description",defaultMessage:"Use dependencies to show {items} that are blocking — or blocked by — other {items}."},dependenciesPropertyPickerCaption:{id:"database.viewSettings.relationsPropertyTab.dependencies.relationPropertyPicker.caption",defaultMessage:"Choose the relation property that represents the {items} that are blocked. We use “Blocking” as our default."}}),p=(0,c.defineMessages)({hideSubitemsInView:{id:"CollectionSettingsViewRelationFeatures.hideSubitemsInView",defaultMessage:"Hide sub-{items} in view"},showSubitemsInView:{id:"CollectionSettingsViewRelationFeatures.showSubitemsInView",defaultMessage:"Show sub-{items} in view"},turnOnSubItemsButton:{id:"collectionSettings.subitemsView.turnOnSubitemsButton.label",defaultMessage:"Turn on sub-{items}"},turnOffSubItemsButton:{id:"database.viewSettings.relationsPropertyTab.removeSubItemsButton.title",defaultMessage:"Turn off sub-{items}"},subItemsMenuTitle:{id:"database.viewSettings.subItemsTab.title",defaultMessage:"Sub-{items}"},subItemsMenuDescription:{id:"database.viewSettings.relationsPropertyTab.subitems.description",defaultMessage:"Use sub-{items} to break large {items} into smaller, more manageable chunks."},deleteSubItemsAcceptModalTitle:{id:"collectionSettings.relationFeatures.deleteSubItemsAcceptModal.title",defaultMessage:"Turn off sub-{items}?"},subItemsPropertyPickerCaption:{id:"database.viewSettings.relationsPropertyTab.subitems.relationPropertyPicker.caption",defaultMessage:"Choose the relation property that represents the sub-{items}. We use “Sub-{item}” as our default."},subItemsPropertySelectDefaultOptionCaption:{id:"database.viewSettings.relationFeatures.subitems.propertySelectPopup.default.caption",defaultMessage:"This property will be used for sub-{items} in new views."},toggleNestingOnTitleMenuItemTooltip:{id:"database.viewSettings.relationFeatures.subitems.toggleNestingOnTitleMenuItemTooltip.default.caption",defaultMessage:"Whether nesting and the toggle button should always be on the title column or the left-most column. Only relevant for table views"}}),m=(0,c.defineMessages)({relationFeatureShownMessage:{id:"database.viewSettings.mainTab.feature.shown",defaultMessage:"Shown"},relationFeatureOnMessage:{id:"database.viewSettings.mainTab.feature.on",defaultMessage:"On"},relationFeatureOffMessage:{id:"database.viewSettings.mainTab.feature.off",defaultMessage:"Off"},relationFeatureHiddenMessage:{id:"database.viewSettings.mainTab.relationFeatureHidden",defaultMessage:"Hidden"},turnOffAndDelete:{id:"collectionSettings.relationFeatures.turnOffFeatureAllViewsButton.label",defaultMessage:"Turn off & delete properties"},turnOffFeature:{id:"collectionSettings.relationFeatures.turnOffFeatureWithoutDeleteButton.label",defaultMessage:"Turn off & keep properties"},turnOffFeatureDeletedProperties:{id:"collectionSettings.relationFeatures.turnOffFeature.deletedProperties.description",defaultMessage:"This will also delete the properties <span>{propertyName}</span> and <span>{inversePropertyName}</span>."},...u,...p});function f(e){return"consume_gap"===e?s:"preserve_gap"===e?i:a}function g(e){let t;return t="consume_gap"===e.dateShiftingMode?m.consumeGapButton:"preserve_gap"===e.dateShiftingMode?m.preserveGapButton:m.doNotShiftButton,{...t,values:{items:(0,d.Q_)(e.databaseType,!0)}}}function h(e){let t;return"timeline_arrows_by"===e.feature?t=m.turnOnDependenciesButton:"subitem"===e.feature?t=m.turnOnSubItemsButton:(0,l.t1)(e.feature),{...t,values:{items:(0,d.Q_)(e.databaseType,!0)}}}function v(e){let t;return"timeline_arrows_by"===e.feature?t=m.turnOffDependenciesButton:"subitem"===e.feature?t=m.turnOffSubItemsButton:(0,l.t1)(e.feature),{...t,values:{items:(0,d.Q_)(e.databaseType,!0)}}}function b(e){let t;return"timeline_arrows_by"===e.feature?t=m.dependenciesMenuTitle:"subitem"===e.feature?t=m.subItemsMenuTitle:(0,l.t1)(e.feature),{...t,values:{items:(0,d.Q_)(e.databaseType,!0)}}}function y(e){let t;return"timeline_arrows_by"===e.feature?t=m.dependenciesMenuDescription:"subitem"===e.feature?t=m.subItemsMenuDescription:(0,l.t1)(e.feature),{...t,values:{items:(0,d.Q_)(e.databaseType,!0)}}}function _(e){let t;return"timeline_arrows_by"===e.feature?t=m.deleteDependenciesAcceptModalTitle:"subitem"===e.feature?t=m.deleteSubItemsAcceptModalTitle:(0,l.t1)(e.feature),{...t,values:{items:(0,d.Q_)(e.databaseType,!0)}}}function S(e){let t;return"timeline_arrows_by"===e.feature?t=m.dependenciesPropertyPickerCaption:"subitem"===e.feature?t=m.subItemsPropertyPickerCaption:(0,l.t1)(e.feature),{...t,values:{item:(0,d.sN)(e.databaseType,!0),items:(0,d.Q_)(e.databaseType,!0)}}}function w(e){let t;return"timeline_arrows_by"===e.feature?t=m.dependenciesPropertySelectDefaultOptionCaption:"subitem"===e.feature?t=m.subItemsPropertySelectDefaultOptionCaption:(0,l.t1)(e.feature),{...t,values:{item:(0,d.sN)(e.databaseType,!0),items:(0,d.Q_)(e.databaseType,!0)}}}function k(e){let t;return(0,l.$K)(e.currentDateShiftConfig)?"preserve_gap"===e.currentDateShiftConfig.mode?t=m.shiftingNotApplicablePreserveGapMessage:"consume_gap"===e.currentDateShiftConfig.mode?t=m.shiftingNotApplicableConsumeGapMessage:(0,l.t1)(e.currentDateShiftConfig.mode):t=m.shiftingNotApplicableNoShiftingMessage,{...t,values:{items:(0,d.Q_)(e.databaseType,!0)}}}function I(e){return{...m.avoidWeekendsSwitcherCaption,values:{items:(0,d.Q_)(e,!0)}}}function C(e){const{feature:t,isOn:n,databaseType:o}=e;let r;return"timeline_arrows_by"===t?r=n?m.hideDependenciesInView:m.showDependenciesInView:"subitem"===t?r=n?m.showSubitemsInView:m.hideSubitemsInView:(0,l.t1)(t),{...r,values:{items:(0,d.Q_)(o,!0)}}}function x(e){const t={numDependenciesUpdated:e.result.numDependenciesUpdated,item:(0,d.sN)(e.databaseType,!0),items:(0,d.Q_)(e.databaseType,!0)};return e.result.numCouldNotUpdateDueToPermissions>0?e.result.numDependenciesUpdated>0?{message:{...m.dateShiftSomeNotUpdatedDueToPermissions,values:t},canUndo:!0}:{message:{...m.dateShiftAllNotUpdatedDueToPermissions,values:{}},canUndo:!1}:e.result.numDependenciesUpdated>0?{message:{...m.dateShiftSuccess,values:t},canUndo:!0}:void 0}},29376:(e,t,n)=>{n.d(t,{BI:()=>y,DB:()=>E,KV:()=>g,Mu:()=>f,NA:()=>M,ND:()=>P,OP:()=>h,Pi:()=>v,U1:()=>x,ZI:()=>C,aI:()=>k,gO:()=>D,gZ:()=>S,ke:()=>A,m8:()=>I,ny:()=>_,pR:()=>b,rj:()=>w,uJ:()=>R});n(57658);var o=n(99036),r=n(95200),i=n(77657),a=n(6695),s=n(42875),l=n(22808),c=n(59753),d=n(97880),u=n(51592),p=n(10906),m=n(79797);n(65742);const f=32;function g(e,t){return e.normalizedSchemaStore.state[t]}function h(e,t,n){const r=g(e,t);if(!r||"relation"!==r.type||!r.property)return!1;const i=e.collectionStore(),a=n.getSchema();return o.$u({propertySchema:r,sourceCollectionId:null==i?void 0:i.id,property:t,targetCollectionSchema:a})}function v(e){const t=(0,d.qP)(e).find((e=>{let[t,n]=e;if(n&&(0,o.NK)(n))return n.connectedRelation.integration_id===i.U9}));if(t&&t[1]&&(0,o.NK)(t[1]))return t[1]}function b(e){return Boolean(v(e))}function y(e,t){if(!e)return!1;const n=e[t];return Boolean(n&&(0,o.NK)(n)&&n.connectedRelation.integration_id===i.U9)}function _(e,t){if("relation"!==(null==t?void 0:t.type))return;const n=null==t?void 0:t.collection_pointer,o=e.collectionViewBlockStore();return n&&o?m.NW.createChildStore(o,n):void 0}function S(e){return p.eD({collectionStore:e,collectionViewBlockStore:e.getParentBlockStore(),checkNavigableAncestorLocked:!1})}function w(e){const{inverseName:t,collectionStore:n,propertySchema:o,intl:r,targetCollectionStore:i,from:a}=e;return t||(n.isDefined()&&o?k(r,{sourceCollection:n.getModel(),isSelfRelation:n.id===i.id,targetCollectionStore:i,createUnique:!0,from:a}):"")}function k(e,t){var n;const{sourceCollection:o,isSelfRelation:i,targetCollectionStore:a,createUnique:d,from:p}=t,m=c.kk.fromCollection(o),f=e.formatMessage({id:"relationHelpers.autoInverseRelation.untitledDatabase",defaultMessage:"Untitled Database"}),g=null===(n=m.getRenderIcon({}))||void 0===n?void 0:n.icon,h=m.getRenderTitle({getRecordModel:a.getRecordModel,userTimeZone:(0,s.r)(),intl:e})||f,v=m.getDatabaseType();let b;if(i)if("subitem"===p){const t=(0,u.sN)(v,!0);b=e.formatMessage({defaultMessage:"Parent {item}",id:"relationHelpers.autoSelfRelationInverseToggle.typedName"},{item:t})}else b="timeline_arrows_by"===p?e.formatMessage({defaultMessage:"Blocked by",id:"relationHelpers.autoSelfRelationInverseArrow.name"},{sourceCollectionName:h}):e.formatMessage({defaultMessage:"Related back to {sourceCollectionName}",id:"relationHelpers.autoSelfRelationInverse.name"},{sourceCollectionName:h});else b=g&&(0,l.Z)(g)?e.formatMessage({defaultMessage:"{sourceCollectionIcon} {sourceCollectionName}",id:"relationHelpers.autoInverseRelationWithIcon.name"},{sourceCollectionIcon:g,sourceCollectionName:h}):e.formatMessage({defaultMessage:"{sourceCollectionName}",id:"relationHelpers.autoInverseRelationSimple.name"},{sourceCollectionName:h});const y=a.getSchema();return y&&d?(0,r.Z)(b,(e=>!Object.values(y).find((t=>Boolean(t&&t.name===e))))):b}function I(e,t){var n,o;const{targetCollectionStore:i,isSelfRelation:a,sourceSchema:c,createUnique:d,from:p}=t,m=null===(n=i.getModel())||void 0===n||null===(n=n.getRenderIcon({}))||void 0===n?void 0:n.icon,f=e.formatMessage({id:"relationHelpers.autoInverseRelation.untitledDatabase",defaultMessage:"Untitled Database"}),g=(null===(o=i.getModel())||void 0===o?void 0:o.getRenderTitle({getRecordModel:i.getRecordModel,userTimeZone:(0,s.r)(),intl:e}))||f,h=i.getDatabaseType();let v;if(a)if("subitem"===p){const t=(0,u.sN)(h,!0);v=e.formatMessage({defaultMessage:"Sub-{item}",id:"relationHelpers.autoSelfRelationNest.typedName"},{item:t})}else v="timeline_arrows_by"===p?e.formatMessage({defaultMessage:"Blocking",id:"relationHelpers.autoSelfRelationTimelineArrow.name"},{targetCollectionName:g}):e.formatMessage({defaultMessage:"Related {targetCollectionName}",id:"relationHelpers.autoSelfRelation.name"},{targetCollectionName:g});else v=m&&(0,l.Z)(m)?e.formatMessage({defaultMessage:"{targetCollectionIcon} {targetCollectionName}",id:"relationHelpers.autoRelationWithIcon.name"},{targetCollectionIcon:m,targetCollectionName:g}):e.formatMessage({defaultMessage:"{targetCollectionName}",id:"relationHelpers.autoRelation.name"},{targetCollectionName:g});const b=Object.values(c);return d?(0,r.Z)(v,(e=>!b.find((t=>Boolean(t&&t.name===e))))):v}function C(e){const t=a.iB(e.getFormat(),e.getSchema(),void 0,a.j5.Relation);return t?t.collection_relation_options??{}:{}}function x(e){var t;const{collectionStore:n,property:o}=e;return(null===(t=C(n)[o])||void 0===t?void 0:t.related_properties)??[]}function T(e,t){return Object.entries(t).map((n=>{let[r,i]=n;if(!i||!(0,o.p_)(i))return;const a=(0,o.j0)(i),s=e.collectionStore();if(!a||a.id!==(null==s?void 0:s.pointer.id)||!s||!h(e,r,s))return;const l=i.property;if(!l)return;const c=t[l];if(!c||"relation"!==c.type)return;const d=(0,o.j0)(c);return d&&d.id===(null==s?void 0:s.pointer.id)?{propertyID:r,inversePropertyID:l}:void 0})).filter(d.$K)}function M(e,t){return T(e,t).map((e=>e.propertyID))}function P(e,t){const n=T(e,t),o=new Set,r=[];for(const{propertyID:i,inversePropertyID:a}of n)o.has(i)||o.has(a)||(r.push([i,a]),o.add(i),o.add(a));return r}function A(e,t){const n=(0,o.j0)(e);if(!n)return;const r=m.NW.createChildStore(t,n);return r?null==r?void 0:r.getFormat().app_config_uri:void 0}function R(e,t){const n=(0,o.j0)(e);if(!n)return;const r=m.NW.createChildStore(t,n);return r?null==r?void 0:r.getSchema():void 0}function D(e,t){const n=(0,o.j0)(e);if(!n)return;const r=m.NW.createChildStore(t,n);return r||void 0}function E(e){var t;if(e.patternName)return null===(t=e.integration.info)||void 0===t||null===(t=t.original_url_patterns)||void 0===t?void 0:t.filter((t=>{var n;return t.name===e.patternName&&(null===(n=t.additional_types)||void 0===n?void 0:n.connectedRelation)})).find((t=>{let{regex:n}=t;return new RegExp(n).test(e.url)}))}},77546:(e,t,n)=>{n.d(t,{Ez:()=>m,Gf:()=>h,Oc:()=>d,SD:()=>a,VW:()=>s,Wr:()=>u,eA:()=>g,hI:()=>c,xH:()=>l});n(57658);var o=n(69454);const r=8,i={auto:!0,scroll:!0};function a(e){return e&&e instanceof HTMLElement?e:e&&e.parentElement?e.parentElement:void 0}function s(e){const t=a(e);if(t)return f(t,"vertical")}function l(e){const t=a(e);if(t)return f(t,"horizontal")}function c(e){let t=e;const n=[];do{const e=window.getComputedStyle(t);e&&(e.overflow&&i[e.overflow]||e.overflowY&&i[e.overflowY]||e.overflowX&&i[e.overflowX])&&n.push(t),t=t.parentElement}while(t);return n}function d(e){const{el:t,windowHeight:n}=e,i=e.minEdgeDist??r,a=s(t);if(!a||!a.getBoundingClientRect)return;const l=t.getBoundingClientRect(),c=a.getBoundingClientRect(),d=n-o.Z.estimatedNativeWebBottomOverlap(),u=Math.min(c.bottom,d);l.top<c.top?a.scrollTop=a.scrollTop-(c.top-l.top)-i:l.bottom>u&&(a.scrollTop=a.scrollTop+(l.bottom-u)+i)}function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{edgeDist:0,animate:!1};const n=s(e),{animate:o,edgeDist:r}=t;if(!n||!n.getBoundingClientRect)return;const i=e.getBoundingClientRect(),a=n.getBoundingClientRect();if(o){const e=500,t=n.scrollTop-(a.top-i.top)-r,o=n.scrollTop,s=t-o,l=16;let c=0;const d=()=>{var t,r,i;c+=l,n.scrollTop=(t=c,r=o,i=s,(t/=e/2)<1?i/2*t*t+r:-i/2*(--t*(t-2)-1)+r),c<e&&requestAnimationFrame(d)};d()}else n.scrollTop=n.scrollTop-(a.top-i.top)-r}function p(e){return e&&e.overflowY&&i[e.overflowY]}function m(e){if(!e)return;let t=e;if(t)do{const e=t.parentElement&&window.getComputedStyle(t.parentElement);if(e&&p(e))return t;t=t.parentElement||void 0}while(t);return document.body}function f(e,t){if(!e)return;let n=e;if(n)do{const e=window.getComputedStyle(n);if(n.classList&&n.classList.contains("notion-scroller")&&n.classList.contains(t)||p(e))return n;n=n.parentElement||void 0}while(n);return document.body}function g(e){return e.device.isDesktop&&!e.device.isSafari}function h(e){return e.device.isDesktop}},45010:(e,t,n)=>{n.d(t,{Z:()=>o});const o={}},59139:(e,t,n)=>{n.d(t,{Qi:()=>l,XP:()=>i,bN:()=>s,rd:()=>a});var o=n(77080),r=n(55320);function i(){return!1}function a(e){return"on"===o.default.getGroup("search-intent-based-grouping-n-side-peek")||s(e)}function s(e){return"quickSearch"===e.RouterStore.state.route.name}function l(e){if(e.device.isMobile)return!1;const t=e.currentUser.id;if(!a(e)||!t)return!1;return!o.default.checkGate("search_toggle_side_peek")||r.default.state.preferSidePeekOpen}},97638:(e,t,n)=>{n.d(t,{AX:()=>z,De:()=>w,FN:()=>k,IV:()=>U,MQ:()=>j,MS:()=>R,Nu:()=>V,VA:()=>I,VD:()=>S,YB:()=>F,_Q:()=>M,b9:()=>B,bC:()=>L,dy:()=>q,g8:()=>N,gC:()=>A,oO:()=>O,p6:()=>C,pG:()=>Z,uL:()=>E,zD:()=>P});n(57658);var o=n(40506),r=n(7057),i=n(53877),a=n(42875),s=n(72126),l=n(21202),c=n(92338),d=n(9291),u=n(54642),p=n(80444),m=n(46735),f=n(43250),g=n(98165),h=n(46654),v=n(15447);function b(e){return Boolean(e&&e.length>0)}function y(e){return Boolean(e.starting||e.ending)}function _(e){return Boolean(e)}const S={requireEditPermissions:_,isDeletedOnly:_,excludeTemplates:_,navigableBlockContentOnly:_,ancestors:b,parentId:function(e){return void 0!==e},createdBy:b,editedBy:b,lastEditedTime:y,createdTime:y,isAdminModeDeletedPageSearch:_,blockTypes:function(e){return Boolean(e&&e.length>0)},inTeams:function(e){return b(c.iY(e))},includePublicPagesWithoutExplicitAccess:_,audience:function(e){return Boolean(e)},dev_excludedPages:b,dev_excludedTeams:b,databaseType:b};function w(e){return e?{requireEditPermissions:S.requireEditPermissions(e.requireEditPermissions),isDeletedOnly:S.isDeletedOnly(e.isDeletedOnly),excludeTemplates:S.excludeTemplates(e.excludeTemplates),navigableBlockContentOnly:S.navigableBlockContentOnly(e.navigableBlockContentOnly),ancestors:S.ancestors(e.ancestors),parentId:S.parentId(e.parentId),createdBy:S.createdBy(e.createdBy),editedBy:S.editedBy(e.editedBy),createdTime:S.createdTime(e.createdTime),lastEditedTime:S.lastEditedTime(e.lastEditedTime),blockTypes:S.blockTypes(e.blockTypes),inTeams:S.inTeams(e.inTeams),dev_excludedPages:S.dev_excludedPages(e.dev_excludedPages),dev_excludedTeams:S.dev_excludedTeams(e.dev_excludedTeams)}:{requireEditPermissions:!1,isDeletedOnly:!1,excludeTemplates:!1,navigableBlockContentOnly:!1,ancestors:!1,parentId:!1,createdBy:!1,editedBy:!1,createdTime:!1,lastEditedTime:!1,blockTypes:!1,inTeams:!1,dev_excludedPages:!1,dev_excludedTeams:!1}}function k(e){const t=w(e);return Object.values(t).some((e=>Boolean(e)))}function I(e){const t=w(e),{navigableBlockContentOnly:n,...o}=t;return Object.values(o).some((e=>Boolean(e)))}function C(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.sF;const a=i.OQ.notionDateToLuxon(e,{locale:t.locale});return(0,r.Cp)(a,n)}function x(e,t){const n=i.OQ.notionDateTimeToLuxon(e,t.locale);return(0,r.ZW)(n,"medium_with_time")}const T=(0,d.defineMessages)({startAndEnd:{defaultMessage:"{startDate} - {endDate}",id:"searchHelpers.betweenStartAndEndDates"},afterStart:{defaultMessage:"After {startDate}",id:"searchHelpers.afterStartDate"},beforeEnd:{defaultMessage:"Before {endDate}",id:"searchHelpers.beforeEndDate"}});function M(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.sF,r="",i="";return e.starting&&(r="date"===e.starting.type?C(e.starting,t,n):x(e.starting,t)),e.ending&&(i="date"===e.ending.type?C(e.ending,t,n):x(e.ending,t)),r&&i?t.formatMessage(T.startAndEnd,{startDate:r,endDate:i}):r?t.formatMessage(T.afterStart,{startDate:r}):t.formatMessage(T.beforeEnd,{endDate:i})}function P(e){return Boolean(e.target&&e.target instanceof HTMLElement&&e.target.classList.contains("rdp-day"))}function A(e){const{input:t,spaceId:n,publicAccessPermissionAncestorBlockId:o,searchSessionId:r,searchSessionFlowNumber:i,source:a,forcedClusterPattern:s,searchExperimentOverrides:l,recentPagesForBoosting:d,forcedBlockIds:u,excludedBlockIds:p}=e,{query:m,limit:f,debug:g}=t;return n?{type:c.n8.BlocksInSpace,query:m.text.trim(),spaceId:n,limit:f,filters:m.filters,sort:m.sort,source:a||"quick_find",debug:g,searchExperimentOverrides:l,searchSessionId:r,searchSessionFlowNumber:i,forcedClusterPattern:s,recentPagesForBoosting:(0,v.Wk)(d),forcedBlockIds:u,excludedBlockIds:p}:o?{type:c.n8.BlocksInAncestor,query:m.text.trim(),ancestorId:o,filters:m.filters,sort:m.sort,limit:f,source:a||"quick_find_public",debug:g,searchExperimentOverrides:l,searchSessionId:r,searchSessionFlowNumber:i,forcedClusterPattern:s,forcedBlockIds:u,excludedBlockIds:p}:void 0}function R(e){const{environment:t}=e,n=A(e);return!!n&&u.search(t,n)}class D{constructor(e){this.startingTimestamp=void 0,this.endingTimestamp=void 0,this.startingTimestamp=e.starting&&i.uO(e.starting,(0,a.r)()),this.endingTimestamp=e.ending&&i.uO(e.ending,(0,a.r)())}matches(e){return void 0!==e&&(!(void 0!==this.startingTimestamp&&e<this.startingTimestamp)&&!(void 0!==this.endingTimestamp&&e>this.endingTimestamp))}}class E{constructor(e){this.filters=void 0,this.activeFilters=void 0,this.ancestorFilterIds=void 0,this.parentFilterId=void 0,this.createdTimeMatcher=void 0,this.lastEditedTimeMatcher=void 0,this.teamFilterIds=void 0,this.dev_notInTeamFilterIds=void 0,this.dev_notInPagesFilterIds=void 0,this.filters=e,this.activeFilters=w(e),this.ancestorFilterIds=new Set(e.ancestors),this.parentFilterId=e.parentId,this.createdTimeMatcher=new D(e.createdTime),this.lastEditedTimeMatcher=new D(e.lastEditedTime),this.teamFilterIds=new Set(c.iY(e.inTeams)??[]),this.dev_notInTeamFilterIds=new Set(e.dev_excludedTeams),this.dev_notInPagesFilterIds=new Set(e.dev_excludedPages)}matches(e){let{blockModel:t,path:n}=e;if(!Boolean(this.activeFilters.isDeletedOnly)!==t.alive)return!1;if(this.activeFilters.excludeTemplates&&t.is_template)return!1;if(this.activeFilters.editedBy){const e=t.last_edited_by_id||t.last_edited_by;if(!e||!this.filters.editedBy.includes(e))return!1}if(this.activeFilters.createdBy){const e=t.created_by_id||t.created_by;if(!e||!this.filters.createdBy.includes(e))return!1}if(this.activeFilters.ancestors&&!n.some((e=>{let{value:t}=e;return this.ancestorFilterIds.has(t.id)})))return!1;if(this.activeFilters.parentId){if(n.length<2)return!1;const[e,{value:{id:t}}]=n;return this.parentFilterId===t}if(this.activeFilters.lastEditedTime&&!this.lastEditedTimeMatcher.matches(t.last_edited_time))return!1;if(this.activeFilters.createdTime&&!this.createdTimeMatcher.matches(t.created_time))return!1;if(this.activeFilters.inTeams){var o;const e=g.KU(n),t=null==e||null===(o=e.value)||void 0===o?void 0:o.id;if(!t||!this.teamFilterIds.has(t))return!1}return!0}}function B(e){if(e&&!e.error)return e.value}function F(e){let{sort:t,unsorted:n,batchSize:o,currentUserId:r}=e;const i=Date.now();if("relevance"!==t.field)return n;const a=s.yo(n,o).map((e=>m.Z.sortFrecencyHighToLow({items:e,now:i,currentUserId:r,recordFrecency:!0})));return s.xH(a)}function O(e){const{localResults:t,serverResults:n}=e;if(t||n){if(t&&n){const o=new Set(t.map((e=>e.id)));function r(e){return(null==e?void 0:e.sources)??[]}return t.map((e=>{const t=(o=e.id,null==n?void 0:n.find((e=>e.id===o)));var o;const i=(null==(a=t)?void 0:a.originalPosition)??e.originalPosition;var a;const s=[...new Set([...e.badges??[],...(null==t?void 0:t.badges)??[]])];return{...e,originalPosition:i,serverEventProperties:(null==t?void 0:t.serverEventProperties)??e.serverEventProperties,sources:[...e.sources,...r(t)],badges:s}})).concat(n.filter((e=>!o.has(e.id))))}return t??n}}function Z(e){var t,n,o,r;const{focusedIndexStore:i,searchActionsStore:a,searchResultStore:s}=e,l=O({localResults:null===(t=s.state.localResults)||void 0===t?void 0:t.results,serverResults:null===(n=s.state.serverResults)||void 0===n?void 0:n.results}),c=null===(o=i.state)||void 0===o?void 0:o.global,d=null===(r=i.state)||void 0===r?void 0:r.local;if(void 0===c||void 0===d)return;const u=a.state.length,p=c<u&&a.state[c];if(p&&"assistant"===p.type)return{type:p.type};const m=c-u;if(!l||l.length<=0||m<0)return;const f=l[m];return f?{type:"page_result",value:{index:{global:c,local:d},selectedResult:f,allSearchResults:l}}:void 0}function V(e){const{existingResults:t,newPageResults:n}=e;if(void 0!==t||void 0!==n){if(t&&n){const e=[...t.results],o=new Set(t.results.map((e=>e.id)));return e.push(...n.results.filter((e=>!(e.sources.includes(c.vp.ElasticsearchRandom)&&e.originalPosition<t.results.length)&&!o.has(e.id)))),{...n,results:e,total:n.total}}return t??n}}function U(e){const{intentBasedGrouping:t,localResults:n,serverResults:o}=e,r=O({localResults:n,serverResults:o})??[],i=r.filter((e=>e.sources.includes(c.vp.ElasticsearchUniqueID))),a=r.filter((e=>!e.sources.includes(c.vp.ElasticsearchUniqueID)));return t?{type:"intent-based-grouping",sections:{uniqueIdSearchResults:i,jumpBackInSearchResults:a.filter((e=>e.sources.includes(c.vp.Local))),serverOnlySearchResults:a.filter((e=>!e.sources.includes(c.vp.Local)))},allSearchResults:r}:i.length>0?{type:"unique-id",sections:{uniqueIdSearchResults:i,nonUniqueIdSearchResults:a},allSearchResults:r}:{type:"all",sections:{allSearchResults:r},allSearchResults:r}}function N(e,t,n){const o=n??(e.device.isMobile?2:3);return t.slice(0,o)}function L(e){const{mainEditorCurrentBlockStore:t}=p.default.state,n=t&&h.IJ(e,t);return{hasPublicAccessPermission:Boolean(n),publicAccessPermissionAncestorBlockId:(null==n?void 0:n.from.table)===l.iU?null==n?void 0:n.from.blockId:void 0}}function j(e){let{environment:t,searchResultsSection:n,modalBodyMenu:o,searchFilterMenu:r,actionItemCount:i}=e;if(!n)return 0;let a=0;if(t.device.isMobile){const e=null==o?void 0:o.getNode(),t=null==r?void 0:r.getNode();if(e instanceof Element&&t instanceof Element){const n=e.getElementsByClassName(f.GZn)[0];n instanceof Element&&(a=n.clientHeight-t.clientHeight+n.scrollTop)}}else a=n.getBoundingClientRect().height+n.scrollTop;let s=0,l=0;const c=n.getElementsByClassName(f.Xjk);for(let u=0;u<c.length;u++){l+=c[u].clientHeight}const d=n.getElementsByClassName(f.ulv);for(let u=0;u<d.length;u++){const e=d[u];if(!(a-l>e.clientHeight/2))break;s+=1,l+=e.clientHeight}return s-i}function z(e){if(void 0===e)return[];return e.map((e=>({id:e.id,score:e.score,sources:e.sources,spaceId:e.spaceId})))}function q(e){var t;if(void 0!==(null==e?void 0:e.highlightBlockId)&&void 0===(null===(t=e.highlight)||void 0===t?void 0:t.title))return e.highlightBlockId}},69645:(e,t,n)=>{n.d(t,{Bj:()=>h,D_:()=>_,Ib:()=>g,XL:()=>y,dq:()=>v,kC:()=>b,v5:()=>f});n(57658);var o=n(55010),r=n(45060),i=n(21202),a=n(95371),s=n(374),l=n(97880),c=n(94419),d=n(95802),u=n(27724),p=n(28020),m=n(62619);function f(e,t){return(0,a.DY)(t,(t=>t.value.store===e))}function g(e,t){const n=f(e,[t]);if(n&&n.length>0)return n[n.length-1]}function h(e){const t=e.container??u.default.getCurrentDefaultContainer();if(!t)return new a.DG([]);const n=[];d.C.forEach((o=>{const r=o.getNode(),i=o.props.store;if(!r)return;if(o.getContextSelectableContainer()!==t)return;(o.props.canSelect||e.includeNonSelectableListContainer&&o.props.isListContainer)&&n.push({node:r,store:i,component:o})}));var r;return(r=n,(0,a.Yc)({values:r,compareOrder:(e,t)=>(0,o.Z)(e.node,t.node),isAncestor:(e,t)=>m.r3(e.node,t.node)}))||new a.DG([])}function v(e){const t=e.root||(0,p.RM)();if(t){const n=h(e);return new a.mp({store:t,node:void 0,component:void 0},n.children)}}function b(e){const{rootStore:t,root:n,target:o}=e,r=(0,a.DY)(n.children,(e=>e===o));if(void 0===r)return;const i=[t];let s=t;for(const a of r){const e=a.value.store;if(!e)return;const t=s.getTransclusionReferenceTargetStore()??s;let n=t.getContentStores();const o=t.getAutomationStore();if(o){const e=o.getActionStores();n=n.concat(e.flatMap((e=>e.getBlockStores())))}const r=n.find((t=>t.id===e.id));if(!r)return;i.push(r),s=r}return i}function y(e){var t;const{treeOperation:n,deleteFrom:o}=e,r=[],a=null===(t=n.deleteFromParent.value.store)||void 0===t?void 0:t.getContentStore(),s=n.deletingChildren.map((e=>e.value.store)).filter(l.$K);for(const l of s){const e=l.getRecordStoreUIParent(),t=e&&e.table===i.iU&&1===e.path.length&&"content"===e.path[0]&&e,n="record-store-parent"===o&&t||a;n&&r.push({parent:n,childToRemove:l})}return r}function _(e){const{transaction:t,treeOperation:n,deleteFrom:o,observer:r}=e;switch(n.operation){case"delete":return void y({treeOperation:n,deleteFrom:o}).forEach((e=>{let{parent:o,childToRemove:i}=e;const a={parent:o,childToRemove:i,transaction:t};c.Od(a),null==r||r.onRemove(n,a)}));case"insert":{var i,a;const e=null===(i=n.insertIntoParent.value.store)||void 0===i?void 0:i.getContentStore(),o=null===(a=n.adjacentSibling)||void 0===a?void 0:a.value.store,r=n.insertChildren.map((e=>e.value.store));("listAfter"===n.direction&&o||"listBefore"===n.direction&&!o)&&r.reverse();for(const i of r)if(e&&i)if("listAfter"===n.direction){const n={insert:i,parent:e,transaction:t,after:o};c.BE(n)}else{const n={insert:i,parent:e,transaction:t,before:o};c.Vt(n)}return}case"move":for(const e of(0,s.Z)(n))_({transaction:t,treeOperation:e,deleteFrom:o,observer:void 0});return void(null==r||r.onMove(n));default:(0,l.t1)(n)}}!function(){const{span:e,object:t,div:n,CONTAINER_STYLE:o}=r.TI;(0,r.Rw)({canFormat:e=>Boolean(e&&e instanceof a.mp),header:(r,i)=>e(o,e({},t(r,{useDefaultFormatter:!0})),n({},t(r.value.store)),r.children.length?n({},t(r.children)):void 0),hasBody:(e,t)=>!1,body:e=>null})}()},73959:(e,t,n)=>{n.d(t,{J2:()=>m,Mn:()=>u,iZ:()=>h,mh:()=>f,sQ:()=>p,sY:()=>v,x7:()=>g});var o=n(41432),r=n(50694),i=n(80444),a=n(55367),s=n(88923),l=n(79797),c=n(27724),d=n(98165);function u(e){return!e.isPhone}function p(e){if(arguments.length>1&&void 0!==arguments[1]&&arguments[1]&&e instanceof l.G)return e;let t=e;for(;;){if(t=t.getRecordStoreUIParent(),!t)return;if(t&&t instanceof l.G&&t!==e)return t}}function m(e){const t=p(e);if(t)return d.Dg(t)}function f(e){const t=e.getType(),n=e.getModel(),i=e.getProperties();if(t&&n)return t&&(0,o.XD)(t)&&"factory"!==t&&!(0,o.S9)(t)?e.getBlockTitleStore():n.isInlineCollectionView()?e.getTitleStore():n.isType(o.oe)&&i&&i.caption?e.getCaptionStore():t===o.Ti.table?r.g$.getCellTextStore({simpleTableStore:e,rowIndex:0,columnIndex:0}):void 0}function g(e){const t=p(e);if(t)return t&&(t===i.default.state.mainEditorCurrentBlockStore||s.default.state.open&&t===s.default.state.target)}function h(e){const{stores:t,phase:n}=c.default.state;return 1===t.length&&t[0]===e&&n===c.SelectionPhase.Editing}function v(e){const{stores:t,phase:n}=c.default.state,o=new Set(t.map((e=>e.id))),r=d.qA(e),i=o.has(e.id),s=r.some((e=>o.has(e.id))),l=i||s;return!(n!==c.SelectionPhase.Selected||!l||a.ZP.state.isDragging)}},89014:(e,t,n)=>{n.d(t,{u:()=>i,x:()=>r});const o=new Map;function r(e){return o.get(e)}function i(e,t){o.set(e,t)}},41984:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(6287);const r=function(e){return!(e.getParentTable()===o.v)||e.isTemplate()}},28187:(e,t,n)=>{n.d(t,{F6:()=>m,Jk:()=>d,SG:()=>p,kC:()=>f});n(57658);var o=n(77657),r=n(63787),i=n(90965),a=(n(95477),n(80444)),s=n(77080),l=n(79797),c=n(98165);const d=function(e){const t=c.qA(e),n=[];for(const o of t)"block"===o.table&&n.push({blockStore:o,slackIntegrationStore:(0,l.Kv)(e,{table:r.s,id:o.id})});for(const{blockStore:o,slackIntegrationStore:r}of n)if(r.isReady()){if(r.getKeyStore("enabled").getValue())return{blockStore:o,slackIntegrationStore:r}}return{blockStore:e,slackIntegrationStore:(0,l.Kv)(e,{table:r.s,id:e.id})}};function u(){var e;const t=null===(e=a.default.state.currentSpaceStore)||void 0===e?void 0:e.getBotSettingsStore().getValue();return(0,i.hU)({spaceBotSettings:t,integrationId:o.nO,env:"production"})}function p(){return s.default.checkGate("legacy_slack_notifications")}function m(){return!!u()&&"on"===s.default.getGroup("notion-to-slack")}function f(){return!!u()&&"on"===s.default.getGroup("notion-mentions-to-slack")}},48779:(e,t,n)=>{n.d(t,{G$:()=>N,cJ:()=>X,Q6:()=>fe,w3:()=>J,rg:()=>U,g4:()=>ee,k0:()=>z,MC:()=>j,KA:()=>H,Wd:()=>K,ns:()=>Q,XD:()=>Y,rn:()=>G,TC:()=>ie,jv:()=>$,lQ:()=>re,C:()=>se,Fn:()=>ae,di:()=>oe,Q9:()=>ce,kt:()=>me,Cx:()=>te,j9:()=>le,CV:()=>ne,iX:()=>W,Ib:()=>ue,ww:()=>de,cD:()=>pe,$U:()=>ge});n(21703);var o=n(14577),r=n(15145),i=n(44317),a=n(72126),s=n(62193),l=n(21202),c=n(15047),d=n(19889),u=n(66079),p=n(28182),m=n(9852),f=n(90965),g=n(97880),h=n(3297),v=n(94273),b=n(40277),y=n(12321),_=n(65452),S=n(95477),w=n(75538);var k=n(94841),I=n(88310),C=n(80444),x=n(92425),T=n(77080),M=n(81236),P=n(79797),A=n(13105),R=n(29226),D=n(88893),E=n(84210),B=n(33929),F=n(98165),O=n(46654),Z=n(65598),V=n(95697);async function U(e,t){const n=await async function(e,t){const n=e.currentUser.id,o=t.getSpaceStore();if(await t.load(),o&&n){var r;t.hasRemoteSharedPages()||await _.l({environment:e,spaceId:o.id,userId:n});const i=x.Z.getSharedPagesState({spaceId:o.id,userId:n}),a=(i&&i.currentPageIds?i.currentPageIds:[]).map((e=>P.G.createChildStore(o,{table:l.iU,id:e,spaceId:o.id})));await Promise.all([o.load(),Promise.all(t.getBookmarkedPageStores().map((e=>e.load()))),Promise.all(Y(e,o).map((e=>e.load()))),Promise.all(t.getSharedPageStores().map((e=>e.load()))),Promise.all(a.map((e=>e.load())))]);return[...t.getBookmarkedPages(),...t.getWorkspacePages(),...H(e,t),...t.getPrivatePages(e),...(null===(r=t.getTeamsStores())||void 0===r||null===(r=r[0])||void 0===r?void 0:r.getTeamPageStores())||[],...a].filter((t=>!(0,O.IJ)(e,t)))}}(e,t)??[];return n[0]}const N=7,L=new s.Uw;function j(e){return L.memo((()=>new o.Z((()=>z(e)),{debugName:"sharedPageContextStore"})),[e.environment,e.spaceViewStore,e.userSettingsStore])}function z(e){const{environment:t,spaceViewStore:n,userSettingsStore:o}=e,r=n.getSpaceId(),i=H(t,n),a=new Set(i.map((e=>{let{id:t}=e;return t})));if(!r)return{allSharedPagesStores:i,visibleSharedPagesStores:i};if(!o.hasUserPinnedToOutliner({type:"shared",spaceId:r}))return{allSharedPagesStores:i,visibleSharedPagesStores:i.slice(0,N)};return{allSharedPagesStores:i,visibleSharedPagesStores:n.getPinnedSharedPages().filter((e=>{let{id:t}=e;return a.has(t)}))}}const q=new s.Uw;function H(e,t){const n=e.currentUser.id,o=t.getSpaceStore();if(o&&n){const r=x.Z.getSharedPagesState({spaceId:o.id,userId:n}),i=r&&r.currentPageIds?r.currentPageIds:[],s=q.memo((()=>function(e,t){return new A.P({debugName:"isValidSharedRemotePage",memoizeRecursion:!1,deepEquals:!1,compute:function(n){if(!e.currentUser.id)return!1;const o=(0,F.u3)(n);let r=!1;return o&&((0,Z.OY)(o)?r=!(0,V.bq)()&&e.currentUser.id&&t.isDefined()&&n.hasSpacePermission()?(0,f.kC)(t.getPermissionItems(),e.currentUser.id):o.id!==n.id&&o.canRead():(0,Z.Y)(o)&&(r=(0,V.zz)({teamStore:o,spaceStore:t,userId:e.currentUser.id})&&o.canRead())),!(!((0,Z.Oh)(n)&&n.canRead()&&n.isNavigableBlock()&&n.isSharedPage(t,e))||(0,F.wf)(n)||r)}})}(e,o)),[e,o]),c=a.oA(i.map((e=>{const t=P.G.createChildStore(o.getPagesStore(),{table:l.iU,id:e,spaceId:o.id});if(s.getStateFor(t))return t}))),d=new Set(c.map((e=>e.id)));let u;const p=t.getSharedPageStores(),m=0===p.length;if(m){u=Y(e,o).filter((e=>{d.has(e.id)}))}else u=p.filter((e=>!(0,F.wf)(e)&&d.has(e.id)));(0,I.As)({use_legacy_shared_pages_ordering:m&&u.length>0});const g=[...u,...c];return a.mN(g,(e=>e.id))}return[]}async function W(e){const{disableRedirectUrl:t,environment:n}=e;await y.w();const{id:o}=n.currentUser,{url:i,spaceId:s,route:l}=await v.Ie(n),c=s?J(s):void 0,f=function(e){const{environment:t,lastVisitedUrl:n,lastVisitedSpaceView:o}=e,i=ee(t,null==o?void 0:o.getModel());switch(i){case"last_visited_page":return n?{url:n,isPersonalHomeUrl:!1}:void 0;case"first_page":return;case"personal_home":if(!o)return;const e=k.Al(o);if(!e)return;return{url:(0,E.ZP)({store:e,preferPublicLink:!1,pageVisitSource:r.tY.DefaultHome}),isPersonalHomeUrl:!0};default:(0,g.t1)(i)}}({environment:n,lastVisitedUrl:i,lastVisitedSpaceView:c}),_=null==f?void 0:f.url,S=h.qd(o),w=b.th(o),I=m.DD();if(!o)throw new Error("User not logged in.");const C=new P.U6(n,{table:d.KJ,id:o}),x=new P.r9(n,{table:u.dx,id:o}),T=new P.vO(n,{table:p.Sr,id:o}),[M,A]=await Promise.all([C.awaitNonNullValue(),x.awaitNonNullValue(),T.awaitNonNullValue()]),R=!!M&&Boolean(M.onboarding_completed),D=!!M&&Boolean(M.mobile_onboarding_completed),B=function(e,t){const n=(0,u.ao)(e);return n&&n.length>0?P.V9.createChildStore(t,n[0]):void 0}(A,x);B&&await B.load();const F=B?B.getSpaceStore():void 0;if(l&&!t){const e=await b.Jv({environment:n,request:{type:"block-space",...l}}).next();if(e.value){const t=e.value,n="page"===l.name?l.blockId:void 0,o=["read_and_write","comment_only","reader"].includes(t.publicAccessRole);if(t&&!a.xb(t)&&(t.canJoinSpace||t.userHasExplicitAccess||!o))return{userStore:C,userSettingsStore:T,userRootStore:x,firstSpace:F,firstSpaceView:B,lastVisitedSpaceView:c,redirectUrl:_,forkPageBlockId:S,publicAccessPageId:w,oauthAuthorizationParams:I,redirectPageId:n,hasExplicitAccessToRedirectPage:t.userHasExplicitAccess,redirectSpaceName:t.spaceName,redirectSpaceId:t.spaceId,canJoinRedirectSpace:t.canJoinSpace,onboardingCompleted:R,mobileOnboardingCompleted:D,isPersonalHomeRedirect:(null==f?void 0:f.isPersonalHomeUrl)??!1}}}return{userStore:C,userSettingsStore:T,userRootStore:x,firstSpace:F,firstSpaceView:B,lastVisitedSpaceView:c,forkPageBlockId:S,publicAccessPageId:w,oauthAuthorizationParams:I,redirectUrl:void 0,redirectPageId:void 0,hasExplicitAccessToRedirectPage:void 0,redirectSpaceId:void 0,canJoinRedirectSpace:void 0,onboardingCompleted:R,mobileOnboardingCompleted:D,redirectSpaceName:void 0,isPersonalHomeRedirect:!1}}function K(e,t){return P.t1.fromV1(t).getIcon()}function G(e,t){const n=t.getName(),o=B.default.getIntl().formatMessage({defaultMessage:"Untitled workspace",id:"spaceHelpers.getSpaceName.untitledWorkspace.name"});if(n)return n||o;{const n=M.Z.getPublicSpaceData(e,t.id);if(n)return n.name||o}return o}function $(e){return function(e){return(0,P.Vh)(e,{table:c.bx,id:e.id},"permissions")}(e).getValue()||[]}function Q(e,t){const n=e.currentUser.id,o=t.getPagesStore().getValue();if(o&&n){const e=R.Z.getSpaceInaccessiblePages(t.id,n);return e?o.filter((t=>!e.has(t))):o}return[]}function Y(e,t){const n=t.getPagesStore();return Q(e,t).map((e=>P.G.createChildStore(n,{table:l.iU,id:e})))}function X(e,t,n){const o=M.Z.getPublicSpaceData(e,t),r=!Boolean(null==o?void 0:o.domainIsAutogenerated),i=a.oA([r&&(null==o?void 0:o.domain),"invite",n]).join("/");return`${S.default.domainBaseUrl}/${i}`}function J(e){const{currentUserRootStore:t}=C.default.state;return null==t?void 0:t.getSpaceViewStores().find((t=>t.getSpaceId()===e))}function ee(e,t){var n;const o=function(e,t){var n,o;if(null!==(n=e.mobileNative)&&void 0!==n&&n.supportsNativeHomeOnPhone())return{setting:"last_visited_page",fromExplicitSetting:!1};const r=null==t||null===(o=t.getSettings())||void 0===o?void 0:o.on_app_start;if((0,g.$K)(r))return{setting:r,fromExplicitSetting:!0};const{isPhone:i,isMobileNative:a}=e.device,s=!(i&&a||function(){const e=C.default.state.spaceTransitionStatus;let t;switch(e){case"joiningOrCreatingSpace":t=!0;break;case"switchingToOrLoadingSpace":case"notTransitioning":t=!1;break;default:(0,g.t1)(e)}return t||w.default.state.isOnboarding}());return{setting:s?"personal_home":"last_visited_page",fromExplicitSetting:!1}}(e,t);if("personal_home"!==o.setting)return o.setting;const r=null==t?void 0:t.getSpaceId(),i=null==t?void 0:t.getUserId(),a=!T.default.isStatsigEnabledAndInitialized()||!r||!i||r!==(null===(n=C.default.state.currentSpaceStore)||void 0===n?void 0:n.id)||i!==e.currentUser.id;let s;return s=o.fromExplicitSetting?a?function(e){var t;const n=null==e||null===(t=e.getPersonalHomeSettings())||void 0===t?void 0:t.home_landing_page_enabled;switch(n){case"home_landing_page_with_default":case"home_landing_page_without_default":return!0;case"no_home_landing_page":case void 0:return!1;default:(0,g.t1)(n)}}(t):(0,V.QI)("dev_beta_and_ga"):a?function(e){var t;const n=null==e||null===(t=e.getPersonalHomeSettings())||void 0===t?void 0:t.home_landing_page_enabled;switch(n){case"home_landing_page_with_default":return!0;case"home_landing_page_without_default":case"no_home_landing_page":case void 0:return!1;default:(0,g.t1)(n)}}(t):(0,V.MS)("dev_beta_and_ga"),s?"personal_home":"last_visited_page"}function te(e){return!!e&&!e.canRead()}function ne(e){return!!e&&e.getZeroRetentionEnabled()}function oe(e,t){const n=(0,D.CM)(t)||[],o=e.currentUser.id;for(const r of n)if(r.userId===o&&"none"===r.role&&r.isTeamGuest)return!0;return!1}function re(e){return!!e&&e.canAdmin()}function ie(e){let{spaceStore:t,groupId:n}=e;return((null==t?void 0:t.getPermissionGroups())||[]).find((e=>e.id===n))}function ae(e){const t=C.default.state.currentSpaceStore,n=e.currentUser.id;return Boolean(t&&n&&t.getSpaceUserStore(n).isWorkspaceOwner())}function se(){const e=C.default.state.currentSpaceStore;return!(null==e||!e.isDefined())&&"enterprise"===e.getSubscriptionTier()}function le(e){const t=e.getSubscriptionTier();return"plus"===t||"business"===t||"enterprise"===t}function ce(e){const t=function(e){const t=null==e?void 0:e.getCreatedTime();return t?(0,i.O5)(t):null}(e);return null!==t&&t<=7}function de(e){return(0,g.lm)(e)&&"none"!==e.role?e.planType:void 0}function ue(e){return(0,g.lm)(e)&&"none"!==e.role?e.createdTime:void 0}function pe(e){return(0,g.lm)(e)&&"none"!==e.role?e.subscriptionTier:void 0}function me(e){return T.default.checkGate("guest_invite_requests")&&(null==e?void 0:e.getEnableGuestInviteRequest())}function fe(e){return Boolean(me(e))&&!Boolean(null==e?void 0:e.canAdmin())}function ge(e){return e=(e=e.toLowerCase()).replace(/[^a-z0-9-]/g,"")}},16639:(e,t,n)=>{n.d(t,{N5:()=>p,kF:()=>c,kQ:()=>d,rm:()=>u});var o=n(72126),r=n(72141),i=n(19889),a=n(9291),s=n(20454);const l=(0,a.defineMessages)({untitledGroupName:{defaultMessage:"Untitled",id:"spaceBasicSettings.spacePermissionsSettings.groupsTab.defaultNewGroupName"}});function c(e){const{intl:t,group:n}=e;return n.name||t.formatMessage(l.untitledGroupName)}function d(e){const{group:t,spaceStore:n}=e,o=t.user_ids||[];if(!n)return[];const r=n.getPermissionItems();return o.filter((e=>Boolean(r.find((t=>"user_permission"===t.type&&t.user_id===e)))))}function u(e){const{group:t,spaceStore:n,limit:r}=e,a=d({group:t,spaceStore:n}),l=a.length;if(!n)return{countRemainingUsers:0,totalNumberMembers:l,limitedUserStores:[]};const c=r?a.slice(0,r):a;return{limitedUserStores:o.oA(a.map((e=>s.U.createChildStore(n,{table:i.KJ,id:e})))),countRemainingUsers:a.length-c.length,totalNumberMembers:l}}function p(e){let{userStores:t,spaceStore:n,intl:i}=e;return o.MR(t,(e=>e.getSearchName(i))).sort(((e,t)=>{var o,i;if(!n)return 0;const a=n.getPermissionItems(),s=null===(o=a.find((t=>"user_permission"===t.type&&t.user_id===e.id)))||void 0===o?void 0:o.role,l=null===(i=a.find((e=>"user_permission"===e.type&&e.user_id===t.id)))||void 0===i?void 0:i.role;return s&&l?r.Av.indexOf(l)-r.Av.indexOf(s):0}))}},15517:(e,t,n)=>{n.d(t,{ZL:()=>m,lr:()=>c,mn:()=>p,sK:()=>l});var o=n(68626),r=n(15157),i=n(63143),a=n(30021),s=n(46735);async function l(){if("storage"in navigator&&"estimate"in navigator.storage){const{quota:e,usage:t}=await navigator.storage.estimate();if("number"==typeof e&&"number"==typeof t)return{quota:e,usage:t}}if("webkitPersistentStorage"in navigator){const e=navigator.webkitPersistentStorage;if("queryUsageAndQuota"in e)return new Promise((t=>{e.queryUsageAndQuota(((e,n)=>{t("number"==typeof n&&"number"==typeof e?{usage:e,quota:n}:void 0)}),(()=>t(void 0)))}))}}async function c(){if(navigator.storage&&navigator.storage.persist)try{const e=await navigator.storage.persist();return o.clientLogglyEnvironmentData.isPersistent=e,e}catch(e){console.trace("Persistence is disabled",e)}}const d=.9,u=15*i.js;function p(e){const{quota:t,usage:n}=e;return n/t<=d&&t>=u}function m(e){const t=a.Z.state;e?(s.Z.clearForUser(e),r.Z.clearStorageForUser(e)):localStorage.clear(),a.Z.setState(t)}},75024:(e,t,n)=>{n.d(t,{Dp:()=>s,jy:()=>d,mK:()=>i,pd:()=>l,wK:()=>c,yv:()=>a});var o=n(97880),r=n(82990);const i={listStyleType:"none",padding:0,margin:0};r.Z.fontWeight.regular;function a(e,t){const n="UIRegular"===t?r.Z.fontSize.UIRegular:"UISmall"===t?r.Z.fontSize.UISmall:(0,o.t1)(t);return e.device.isMobile?n.mobile:n.desktop}function s(e,t){const n="UIRegular"===t?r.Z.lineHeight.UIRegular:"UISmall"===t?r.Z.lineHeight.UISmall:(0,o.t1)(t);return e.device.isMobile?n.mobile:n.desktop}function l(e){return{display:"-webkit-box",overflow:"hidden",WebkitBoxOrient:"vertical",WebkitLineClamp:e}}function c(e){let{topLeft:t,topRight:n,bottomLeft:o,bottomRight:r}=e;return[t,n,r,o].map((e=>e?`${e}px`:"0")).join(" ")}const d={position:"absolute",overflow:"hidden",clip:"rect(1px, 1px, 1px, 1px)",whiteSpace:"nowrap",height:1,width:1}},52315:(e,t,n)=>{n.d(t,{b:()=>o,r:()=>r});const o=function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e.isReady())return!1;if(n[e.id])return!0;if(n[e.id]=!0,i(e,t))return!0;const r=e.getContentStores();let a=!0;for(const i of r)o(i,!1,n)||(a=!1);return a};async function r(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(await e.load(),n[e.id])return;if(n[e.id]=!0,i(e,t))return;const o=e.getContentStores();await Promise.all(o.map((e=>r(e,!1,n))))}function i(e,t){return!(!e.isPageBlock()||t)||!!e.isCollectionView()}},32363:(e,t,n)=>{n.d(t,{ni:()=>u,wY:()=>c});n(67294);var o=n(97880),r=n(44876),i=n(9291),a=n(30874),s=n(33929),l=n(85893);function c(e,t){const n=function(e,t){if(!e)return;const n=(0,r.ny)({url:e,integrations:a.Z.integrations.state,currentSpaceId:t});if("success"!==n.type)return;return n.integration.name}(e),s=function(e,t){if(!e)return;const n=(0,r.ny)({url:e,integrations:a.Z.integrations.state,currentSpaceId:t});if("success"!==n.type)return;if(!n.pattern.collectionItemType)return;switch(n.pattern.collectionItemType){case"project":return(0,l.jsx)(i.FormattedMessage,{defaultMessage:"Project",id:"syncedCollectionIndicators.project.label"});case"pull_request":return(0,l.jsx)(i.FormattedMessage,{defaultMessage:"Pull Requests",id:"syncedCollectionIndicators.pullRequests.label"});case"issue":return(0,l.jsx)(i.FormattedMessage,{defaultMessage:"Issues",id:"syncedCollectionIndicators.issues.label"});case"calendar":return(0,l.jsx)(i.FormattedMessage,{defaultMessage:"Calendar",id:"syncedCollectionIndicators.calendar.label"});case"release":return(0,l.jsx)(i.FormattedMessage,{defaultMessage:"Releases",id:"syncedCollectionIndicators.releases.label"});default:(0,o.t1)(n.pattern.collectionItemType)}}(e,t);return s?n?(0,l.jsx)(i.FormattedMessage,{id:"syncedCollectionIndicators.originalUrlWithIntegration",defaultMessage:"{collectionType} in {integrationName}",values:{integrationName:n,collectionType:s}}):(0,l.jsx)("span",{children:n}):(0,l.jsx)(i.FormattedMessage,{defaultMessage:"Link to original url",id:"syncedCollectionIndicators.originalUrl"})}const d=(0,i.defineMessages)({github_pull:{defaultMessage:"Oauth Pull Request",id:"syncedCollectionIndicators.oauthGithubPullRequest.label"},github_issue:{defaultMessage:"Oauth Issue",id:"syncedCollectionIndicators.oauthGithubIssue.label"},Event:{defaultMessage:"Event",id:"syncedCollectionIndicators.event.label"},figma_file:{defaultMessage:"File",id:"syncedCollectionIndicators.figmaFile.label"},google_drive_file:{defaultMessage:"File",id:"syncedCollectionIndicators.googleDriveFile.label"},zendesk_ticket:{defaultMessage:"Ticket",id:"syncedCollectionIndicators.zendeskTicket.label"}});function u(e){const{pattern:t,integration:n}=e;return`${n.name} ${function(e){switch(e.name){case"Event":return s.default.formatMessage(d.Event);case"figma_file":return s.default.formatMessage(d.figma_file);case"github_pull":return s.default.formatMessage(d.github_pull);case"github_issue":return s.default.formatMessage(d.github_issue);case"google_drive_file":return s.default.formatMessage(d.google_drive_file);case"zendesk_ticket":return s.default.formatMessage(d.zendesk_ticket);default:return e.name}}(t)}`}},78122:(e,t,n)=>{n.d(t,{A8:()=>u,Bj:()=>b,Bt:()=>S,Fy:()=>g,T0:()=>m,Xg:()=>_,ZH:()=>p,hC:()=>y,hL:()=>v,iT:()=>f,wG:()=>h});n(67294);var o=n(72126),r=n(97880),i=n(9291),a=n(86080),s=n(47307),l=n(64369),c=n(95697),d=n(85893);async function u(e){let{isCurrentUser:t,teamName:n,memberName:o}=e;return await s.confirmUserAction({message:t?(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Are you sure you want to leave {teamName}?",id:"teamActions.leaveTeam.confirmDialogMessage.removingYourself",values:{teamName:n}}):(0,d.jsx)(i.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogMessage.removingSomeoneElse",defaultMessage:"Are you sure you want to remove {memberName} from {teamName}?",values:{memberName:o,teamName:n}}),description:t?(0,d.jsx)(i.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogDescription.removingYourself",defaultMessage:"You'll no longer see this teamspace in your sidebar and you may lose permissions to the teamspace's pages."}):(0,d.jsx)(i.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogDescription.removingSomeoneElse",defaultMessage:"This change won't apply to any restricted pages in the teamspace."}),acceptLabel:t?(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Leave Teamspace",id:"teamActions.leaveTeam.confirmDialogAcceptLabel.removingYourself"}):(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Remove",id:"teamActions.leaveTeam.confirmDialogAcceptLabel"}),cancelLabel:(0,d.jsx)(i.FormattedMessage,{id:"teamActions.leaveTeam.confirmDialogCancelLabel.removingSomeoneElse",defaultMessage:"Cancel"})})}function p(){s.showMessage({message:(0,d.jsx)(i.FormattedMessage,{id:"teamActions.leaveTeam.onlyTeamMemberLeftDialogMessage",defaultMessage:"Invite another teamspace owner to leave this teamspace"})})}function m(e){s.showMessage({message:(0,d.jsx)(i.FormattedMessage,{id:"teamActions.leaveTeam.userMembershipFromGroupDialogMessage",defaultMessage:"You can't leave this teamspace because you're a member of {groupNames}.",values:{groupNames:o.oA(e.map((e=>`"${e.name}"`))).join(", ")}})})}function f(e){var t;let{group:n,onAccept:o}=e;s.showDialog({message:n.name?(0,d.jsx)(i.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.title",defaultMessage:"Are you sure you want to remove {groupName}?",values:{groupName:n.name}}):(0,d.jsx)(i.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.title.noGroupName",defaultMessage:"Are you sure you want to remove this group?"}),description:(0,d.jsx)(i.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.description",defaultMessage:"{numGroupMembers} {numGroupMembers, plural, one {member} other {members}} from this group will be removed from this teamspace.",values:{numGroupMembers:(null===(t=n.user_ids)||void 0===t?void 0:t.length)||0}}),showCancel:!0,keepFocus:!1,handleCancel:s.dismissDialog,items:[{label:(0,d.jsx)(i.FormattedMessage,{id:"TeamSettings.groups.removeGroupModal.confirmationButton",defaultMessage:"Remove group"}),color:"red",onAccept:o}]})}async function g(e,t){return await a.b({message:(0,d.jsxs)("div",{style:{display:"flex",flexDirection:"column"},children:[(0,d.jsx)(i.FormattedMessage,{id:"teamActions.archiveTeam.confirmDialogTitle",defaultMessage:"Are you sure you want to archive this teamspace?"}),(0,d.jsx)(l.Z,{isMultiline:!0,style:{marginTop:8},children:t?(0,d.jsx)(i.FormattedMessage,{id:"teamActions.archiveTeam.transitionToZeroTeams.confirmDialogDescription",defaultMessage:'This is your last default teamspace. Archiving will remove the "Teamspaces" section in your sidebar. Type the teamspace name to confirm.'}):(0,d.jsx)(i.FormattedMessage,{id:"teamActions.archiveTeam.confirmDialogDescription",defaultMessage:"Archiving this teamspace will remove access and hide it in the sidebar for all teamspace members. Type the teamspace name to confirm."})})]}),acceptLabel:(0,d.jsx)(i.FormattedMessage,{id:"teamActions.archiveTeam.confirmDialogAcceptLabel",defaultMessage:"Archive teamspace"}),requiredInputValue:e})}async function h(e){return await s.confirmUserAction({message:(0,d.jsx)("div",{style:{display:"flex",flexDirection:"column"},children:(0,d.jsx)(i.FormattedMessage,{id:"teamActions.movePagesFromArchivedTeam.confirmDialogTitle",defaultMessage:'Would you like to move pages under {teamName} to the "Private" and "Shared" sections in your sidebar?',values:{teamName:e}})}),acceptLabel:(0,d.jsx)(i.FormattedMessage,{id:"teamActions.movePagesFromArchivedTeam.confirmDialogAcceptLabel",defaultMessage:"Move pages"}),cancelLabel:(0,d.jsx)(i.FormattedMessage,{id:"teamActions.movePagesFromArchivedTeam.confirmDialogCancelLabel",defaultMessage:"Proceed without moving pages"})})}async function v(e){let{teamName:t,currentIsDefault:n,accessLevel:o,isDefault:a,numberOfTeamGuests:l}=e;const c=(0,d.jsx)("div",{style:{marginTop:8},children:(0,d.jsx)(i.FormattedMessage,{id:"teamActions.confirmTeamAccessDialog.disableDefaultTeamLabel",defaultMessage:"{teamName} will also no longer be a default teamspace and auto-add workspace members.",values:{teamName:t}})});let u,p;return"private"===o?(u=(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Are you sure you want to make {teamName} private?",id:"teamActions.confirmTeamAccessChangeDialog.privateTeam.titleWithName",values:{teamName:t}}),p=(0,d.jsxs)("div",{children:[(0,d.jsx)(i.FormattedMessage,{id:"teamActions.teamScreen.privateTeam.description",defaultMessage:"Only members will be able to see the teamspace and its content."}),n&&c]})):a?l>0?(u=(0,d.jsx)(i.FormattedMessage,{id:"teamActions.confirmTeamAccessChangeDialog.defaultTeamWithGuests.titleWithName",defaultMessage:"Are you sure you want to make {teamName} a default teamspace?",values:{teamName:t}}),p=(0,d.jsx)(i.FormattedMessage,{id:"teamActions.teamScreen.defaultTeamWithGuests.description",defaultMessage:"Everyone in the workspace and future workspace members will be added to this teamspace. Additionally, {numberOfTeamGuests} teamspace guests will be removed.",values:{numberOfTeamGuests:l}})):(u=(0,d.jsx)(i.FormattedMessage,{id:"teamActions.confirmTeamAccessChangeDialog.defaultTeam.titleWithName",defaultMessage:"Are you sure you want to make {teamName} a default teamspace?",values:{teamName:t}}),p=(0,d.jsx)(i.FormattedMessage,{id:"teamActions.teamScreen.defaultTeam.description",defaultMessage:"Everyone in the workspace and future workspace members will be added to this teamspace."})):"open"===o?(u=(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Are you sure you want to make {teamName} open?",id:"teamActions.confirmTeamAccessChangeDialog.openTeam.titleWithName",values:{teamName:t}}),p=(0,d.jsxs)("div",{children:[!n&&(0,d.jsx)(i.FormattedMessage,{id:"teamActions.teamScreen.openTeam.description",defaultMessage:"Everyone in the workspace will have access to the teamspace and its content."}),n&&c]})):"closed"===o?(u=(0,d.jsx)(i.FormattedMessage,{defaultMessage:"Are you sure you want to make {teamName} closed?",id:"teamActions.confirmTeamAccessChangeDialog.closedTeam.titleWithName",values:{teamName:t}}),p=(0,d.jsxs)("div",{children:[(0,d.jsx)(i.FormattedMessage,{id:"teamActions.teamScreen.closedTeam.description",defaultMessage:"The teamspace will still be discoverable, but joining will be invite-only."}),n&&c]})):(0,r.t1)(o),await s.confirmUserAction({message:u,description:p})}async function b(e){let t;switch(e){case"disable_guests":t=(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.disableGuests.confirmationTitle",defaultMessage:"Are you sure? All page guests in this teamspace will be removed."});break;case"disable_public_access":t=(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.disablePublicPages.confirmationTitle",defaultMessage:"Are you sure? This will remove access for anyone who is not a member or guest of the workspace from all pages in this teamspace."});break;case"disable_export":case"disable_team_page_edits":return!0;default:(0,r.t1)(e)}return await s.confirmUserAction({message:t})}async function y(e){let t;switch(e){case"disable_guests":t=(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.disableGuestsOverride.confirmationTitle",defaultMessage:"Are you sure you want to allow guests on this teamspace? By default, guests are not allowed on teamspaces in this workspace."});break;case"disable_public_access":t=(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.disablePublicPagesOverride.confirmationTitle",defaultMessage:"Are you sure you want to allow teamspace pages to be made public? By default, pages in this workspace cannot be made public."});break;case"disable_export":t=(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.disableExportOverride.confirmationTitle",defaultMessage:"Are you sure you want to allow teamspace pages to be exported? By default, pages in this workspace cannot be exported."});break;case"disable_team_page_edits":return!0;default:(0,r.t1)(e)}return await s.confirmUserAction({message:t,acceptLabel:(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.workspaceSettingOverride.confirmationButtonLabel",defaultMessage:"Override workspace setting"})})}async function _(e){let{environment:t,spaceStore:n,teamName:o}=e;const r=t.currentUser.id;if(!r||!n)return!0;return!(await(0,c.F0)({environment:t,spaceStore:n,currentUserId:r})).some((e=>{var t;return(null===(t=e.getName())||void 0===t?void 0:t.trim())===o.trim()}))||await s.confirmUserAction({message:(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.confirmDuplicateTeamName.message",defaultMessage:"A teamspace with the same name already exists. Are you sure you want to name this teamspace “{teamName}”?",values:{teamName:o}}),cancelLabel:(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.confirmDuplicateTeamName.cancelLabel",defaultMessage:"Cancel"})})}async function S(){return await s.confirmUserAction({message:(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.setTeamPermissions.ClearCustomTeamPermissionsDialogMessage",defaultMessage:"Raising the permission level for all teamspace members will remove some custom permissions. Are you sure you want to proceed?"}),cancelLabel:(0,d.jsx)(i.FormattedMessage,{id:"teamSettings.setTeamPermissions.cancelLabel",defaultMessage:"Cancel"})})}},21115:(e,t,n)=>{n.d(t,{$$:()=>u,CC:()=>g,JB:()=>h,K9:()=>m,Ke:()=>v,_t:()=>d,e6:()=>p,zs:()=>f});var o=n(9291),r=n(64964),i=n(1310),a=n(19306),s=n(33929);const l=(0,o.defineMessages)({leftTeam:{id:"teamPermissionsActions.leftTeam",defaultMessage:"Left {teamName}"},leftTeamNoName:{id:"teamPermissionsActions.leftTeamNoName",defaultMessage:"Left team"},leftYetStillInTeam:{id:"teamPermissionsActions.leftYetStillInTeam",defaultMessage:"You are still in {hasTeamName, select, true {{teamName}} other {the team}} because you are a member of the following groups: {groupsString}"},removedYetStillInTeam:{id:"teamPermissionsActions.removedYetStillInTeam",defaultMessage:"{hasMemberName, select, true {{memberName}} other {The removed user}} is still in {hasTeamName, select, true {{teamName}} other {the team}} because they are a member of the following groups: {groupsString}"},joinedTeam:{id:"teamPermissionsActions.joinedTeam",defaultMessage:"Joined {teamName}"},joinedTeamUsingAdminPrivileges:{id:"teamPermissionsActions.joinedTeamUsingAdminPrivileges",defaultMessage:"Joined {teamName} using admin privileges"},upgradedSelfToOwner:{id:"teamPermissionsActions.upgradedSelfToOwnerUsingAdminPrivileges",defaultMessage:"Became owner of {teamName} using admin privileges"},archivedTeam:{id:"teamPermissionsActions.archivedTeam",defaultMessage:"Archived {teamName}"},restoredTeam:{id:"teamPermissionsActions.restoredTeam",defaultMessage:"Restored {teamName}"},restoredTeamNoName:{id:"teamPermissionsActions.restoredTeamNoName",defaultMessage:"Restored team"},duplicatedTeam:{id:"teamPermissionsActions.duplicatedTeam",defaultMessage:"Duplicated {teamName}"},duplicatedTeamNoName:{id:"teamPermissionsActions.duplicatedTeamNoName",defaultMessage:"Duplicated teamspace"}}),c=(e,t,n)=>{const o=s.default.formatMessage(e,{...t});r.oV({label:o,durationMs:n})},d=e=>c(l.upgradedSelfToOwner,{teamName:e}),u=e=>{let{teamName:t,usingAdminPrivileges:n}=e;return c(n?l.joinedTeamUsingAdminPrivileges:l.joinedTeam,{teamName:t})},p=e=>e?c(l.leftTeam,{teamName:e}):c(l.leftTeamNoName),m=(e,t)=>{const n=(0,a.W)(t.flatMap((e=>e.name||[])));c(l.leftYetStillInTeam,{hasTeamName:void 0!==e,teamName:e,groupsString:n},i.JY)},f=(e,t,n)=>{const o=(0,a.W)(n.flatMap((e=>e.name||[])));c(l.removedYetStillInTeam,{hasMemberName:void 0!==e,hasTeamName:void 0!==t,memberName:e,teamName:t,groupsString:o},i.JY)},g=e=>c(l.archivedTeam,{teamName:e}),h=e=>e?c(l.restoredTeam,{teamName:e}):c(l.restoredTeamNoName),v=e=>e?c(l.duplicatedTeam,{teamName:e}):c(l.duplicatedTeamNoName)},95697:(e,t,n)=>{n.d(t,{q9:()=>ce,$r:()=>ae,ZN:()=>se,oI:()=>V,Xq:()=>$,KP:()=>ie,W8:()=>de,Pr:()=>Q,qX:()=>j,F0:()=>W,sj:()=>z,tu:()=>ge,wP:()=>me,Mf:()=>q,xo:()=>re,tO:()=>ne,xf:()=>oe,ku:()=>Z,AL:()=>ee,MS:()=>F,QI:()=>O,U2:()=>ue,zz:()=>te,bq:()=>L,Hu:()=>G,tV:()=>pe,C2:()=>K,dY:()=>fe,$:()=>X,Gc:()=>N,OX:()=>J});n(57658);var o=n(480),r=n(86628),i=n(14577),a=n(29477);const s=Symbol("unset");class l{constructor(e){this.timeoutMs=void 0,this.fetch=void 0,this.useLastValue=void 0,this.promise=void 0,this.lastFetched=void 0,this.lastValue=void 0,this.changeTrigger=a.UZ();const{timeoutMs:t,fetch:n,useLastValue:o}=e;this.timeoutMs=t,this.fetch=n,this.promise=void 0,this.useLastValue=o,this.lastValue=s}async getWithState(){if(this.isReady()&&this.lastValue!==s)return{value:this.lastValue,state:"cached"};if(this.promise)return{value:await this.promise,state:"cached"};this.promise=this.fetch().catch((e=>{if(this.useLastValue&&this.lastValue!==s)return this.lastValue;throw e}));try{const e=await this.promise;return this.lastFetched=Date.now(),e!==this.lastValue&&(this.changeTrigger.resolve(e),this.changeTrigger=a.UZ()),this.lastValue=e,{value:e,state:"fetched"}}finally{this.promise=void 0}}async get(){const{value:e}=await this.getWithState();return e}isReady(){const e=Date.now();return Boolean(this.lastFetched&&this.lastValue!==s&&this.lastFetched>e-this.timeoutMs)}waitUntilChange(){return this.changeTrigger.promise}}var c=n(68626),d=n(72126),u=n(87479),p=n(72141),m=n(45953),f=n(29369),g=n(19889),h=n(64684),v=n(97880),b=n(9291),y=n(54642),_=n(95477),S=n(38676),w=n(80444),k=n(77080),I=n(45483),C=n(79797),x=n(30397),T=n(88893),M=n(88280),P=n(60396),A=n(28020),R=n(4708),D=n(15010),E=n(46654),B=n(48779);function F(e){return O(e)&&k.default.checkGate("sidebar_home_default_landing_gate")}function O(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"dev_beta_and_ga";const{currentSpaceStore:t,currentUserStore:n}=w.default.state;if(!n)return!1;const o=null==t?void 0:t.getSpaceUserStore(n.id);if(null==o||!o.isMember())return!1;switch(e){case"dev_only":return k.default.checkGate("sidebar_home_dev_gate");case"dev_or_beta":return k.default.checkGate("sidebar_home_dev_gate")||k.default.checkGate("sidebar_home_beta_gate");case"dev_beta_and_ga":return k.default.checkGate("sidebar_home_dev_gate")||k.default.checkGate("sidebar_home_beta_gate")||k.default.checkGate("sidebar_home_ga_gate");default:(0,v.t1)(e)}}function Z(){return k.default.checkGate("sidebar_pages_hide_toggles")}function V(){return _.default.isAdminMode||!1}const U=d.HP((()=>new i.Z((()=>{const{currentSpaceStore:e}=w.default.state;return!!e&&e.isTeamsEnabled()}),{debugName:"teamsEnabledStore"})));function N(){return(0,r.VK)((()=>U().state),[])}function L(){return U().state}async function j(e){let{environment:t,spaceStore:n,includeArchived:o=!1,currentUserId:r}=e;const i=await y.getTeams(t,{spaceId:n.id,includeArchived:o},r);return"failed"===i.type?(c.rateLimitedLog({from:"teamsHelpers",level:"error",type:"getTeamsFailed"}),[]):i.data.teamIds.map((e=>C.zX.createChildStore(n,{table:f.e0,id:e})))}async function z(e){let{spaceStore:t,currentUserId:n,includeArchived:o,minRoleOnTeamStores:r,environment:i}=e;if(!t||!n)return[];const a=await y.getAllTeamsInSpaceForAdmin(i,{spaceId:t.id,includeArchived:o},n);if("failed"===a.type)return[];const s=a.data.teamIds.map((e=>C.zX.createChildStore(t,{table:f.e0,id:e}))),l=[],c=[];for(const m of s){const e=m.getRole()??"none";(0,u.gr)(e,r)?c.push(m.id):l.push(m)}const d=m.Ak.create(a.data.recordMap);P.Z.initialize({environment:i,userId:n,spaceId:t.id,teamIds:a.data.teamIds,getRecordWithRole:e=>({role:r,value:d.getValue(e)})});const p=c.map((e=>P.Z.createTeamStoreFromCache({environment:i,teamId:e,spaceId:t.id,userId:n}))).filter(v.$K);return[...l,...p]}function q(e){return x.Z.state.teams.filter((t=>t.getMembers().some((t=>"user"===t.entity_type&&t.user_id===e))))}const H=new Map;async function W(e){let{environment:t,spaceStore:n,includeArchived:o=!1,currentUserId:r}=e;const i=`${n.id}:${o}`,a=H.get(i);if(a)return a.get();const s=new l({timeoutMs:3e4,fetch:async()=>j({environment:t,spaceStore:n,includeArchived:o,currentUserId:r}),useLastValue:!0});return H.set(i,s),s.get()}function K(e){return!!e&&"private"===(0,h.B5)(e)}function G(e){return e&&(0,h.jI)(e)}function $(e){let{environment:t,spaceStore:n}=e;return!!n&&(!(0,B.Cx)(n)&&((0,B.Fn)(t)||!n.getDisableTeamCreation()))}function Q(e){const t=(0,E.YO)(e).map((e=>e.permissionItem)),n=t.find(p.ix),o=(null==n?void 0:n.role)??"none",r=(0,T.Io)().reduce(((e,t)=>(e.add(t.userId),e)),new Set),i=t.filter((e=>!(!(0,p.jg)(e)||!r.has(e.user_id))||!!(0,p.hV)(e))),a=function(e){if(0===e.length)return;return e.reduce(((e,t)=>(0,u.SL)(t,e)?t:e),e[0])}(i.map((e=>e.role)))??"read_and_write";return{accessLevel:"none"===o?"private":"closed",spacePermissionRole:o,teamPermissionRole:(0,u.nl)(a,o),members:i.map((e=>{const{type:t}=e;return"user_permission"===t?{entity_type:"user",type:"member",user_id:e.user_id}:"group_permission"===t?{entity_type:"group",type:"member",group_id:e.group_id}:void(0,v.t1)(t)}))}}function Y(e){let{environment:t,currentSpaceStore:n,subscriptionData:o}=e;return!!n&&(!t.device.isMobile&&!n.isTeamsEnabled()&&!(0,T.wY)(o)&&(0,B.lQ)(n))}function X(e){const{currentSpaceStore:t}=w.default.state;return Y({environment:e,currentSpaceStore:t,subscriptionData:M.subscriptionDataStoreInstance.state})}function J(){const e=(0,o.O7)();return(0,r.VK)((()=>{const{currentSpaceStore:t}=w.default.state,n=M.subscriptionDataStoreInstance.state;return Y({environment:e,currentSpaceStore:t,subscriptionData:n})}),[e])}function ee(e){let{teamStore:t,spaceStore:n,userId:o}=e;return!!(t.isDefined()&&null!=n&&n.isDefined()&&o)&&(0,h.AL)({team:{is_default:t.isDefault(),membership:t.getMembers()},spaceValue:{permissions:n.getPermissionItems(),permission_groups:n.getPermissionGroups()},userId:o})}function te(e){let{teamStore:t,spaceStore:n,userId:o}=e;return!(!t.isDefined()||!o)&&(0,h.zz)({team:{is_default:t.isDefault(),membership:t.getMembers()},space:{permissions:(null==n?void 0:n.getPermissionItems())||[],permission_groups:(null==n?void 0:n.getPermissionGroups())||[]},userId:o})}function ne(e){let{teamStore:t,spaceStore:n}=e;return n?(0,h.tO)({team:{is_default:t.isDefault(),membership:t.getMembers()},space:{permissions:n.getPermissionItems(),permission_groups:n.getPermissionGroups()}}):[]}function oe(e){let{teamStore:t,spaceStore:n}=e;return null!=n&&n.isDefined()?(0,h.xf)({team:{is_default:t.isDefault(),membership:t.getMembers()},space:n.getModel()}):[]}function re(){return x.Z.state.teams.flatMap((e=>e.getTeamPages()))}function ie(e,t){return e.isDefault()?-1:t.isDefault()?1:0}const ae=["owner","member"],se=["owner","member","team_level_guest"],le=(0,b.defineMessages)({ownerLabel:{id:"teamPermissionsMenu.ownerItem.label",defaultMessage:"Teamspace owner"},ownerCaption:{id:"teamPermissionsMenu.ownerItem.caption",defaultMessage:"Can edit teamspace settings and full access to teamspace pages."},memberLabel:{id:"teamPermissionsMenu.memberItem.label",defaultMessage:"Teamspace member"},memberCaption:{id:"teamPermissionsMenu.memberItem.caption",defaultMessage:"Cannot edit teamspace settings and can access teamspace pages."},guestLabel:{id:"teamPermissionsMenu.guestItem.label",defaultMessage:"Teamspace guest"},guestCaption:{id:"teamPermissionsMenu.guestItem.caption",defaultMessage:"Only has access to invited teamspaces."}}),ce={owner:{label:le.ownerLabel,caption:le.ownerCaption},member:{label:le.memberLabel,caption:le.memberCaption},team_level_guest:{label:le.guestLabel,caption:le.guestCaption}};function de(e){return`${_.default.domainBaseUrl}/team/${e}/join`}function ue(e){var t;return!(null===(t=e.getSettings())||void 0===t||!t.disable_invite_link)}function pe(e){const t=[],n=[];for(const o of e)o.isDefined()&&(void 0===o.getArchivedBy()?n.push(o):t.push(o));return{archivedTeams:t,unarchivedTeams:n}}function me(e){const t=(0,D.WD)(e);if(!t)return!1;const n=t.getKeyStore("settings").getKeyStore("seen_team_add_app_template_tooltip_at").getValue();return void 0!==n&&n>0}function fe(e){let{environment:t,teamId:n}=e;const o=Boolean(S.sidebarExpandedStore.state);return(0,R.B9)()&&w.default.state.inAppCalloutStore.canShow("team_add_app_template_tooltip")&&!me(t)&&0===I.Z.state.openModals.size&&o&&function(e){var t;let{environment:n,teamId:o}=e;const r=((null===(t=(0,A.k_)(n).getState())||void 0===t?void 0:t.userJoinedTeamsStores)??[]).find((e=>{const t=e.getTeamPagesStores().filter((e=>{var t;return Boolean(null===(t=e.getCollectionStore())||void 0===t?void 0:t.getDatabaseType())}));return e.canAddOrRemoveTopLevelPages()&&t.length<2}));return!!r&&r.id===o}({environment:t,teamId:n})}function ge(e){let{currentUserStore:t,currentSpaceStore:n,teamStore:o,members:r}=e;return d.oA(r.map((e=>{const{entity_type:r}=e;return"user"===r?function(e){let{currentUserStore:t,teamStore:n,member:o}=e;if(!t)return;const r=he({teamStore:n,member:o}),i=C.U6.createChildStore(t,{table:g.KJ,id:o.user_id});return{type:"user",memberInfo:o,permissionItem:{type:"user_permission",user_id:o.user_id,role:r},userStore:i}}({currentUserStore:t,teamStore:o,member:e}):"group"===r?function(e){let{currentSpaceStore:t,teamStore:n,member:o}=e;const r=(0,B.TC)({spaceStore:t,groupId:o.group_id});if(!r)return;const i=he({teamStore:n,member:o});return{type:"group",memberInfo:o,permissionItem:{type:"group_permission",group_id:r.id,role:i},permissionGroup:r}}({currentSpaceStore:n,teamStore:o,member:e}):void(0,v.t1)(r)})))}function he(e){let{teamStore:t,member:n}=e;const o=t.getPermissionItems();if(!o)return"none";const r=function(e){let{permissions:t,member:n}=e;const o=null==t?void 0:t.find((e=>(0,p.hV)(e)&&"group"===n.entity_type&&e.group_id===n.group_id||(0,p.jg)(e)&&"user"===n.entity_type&&n.user_id===e.user_id));return null==o?void 0:o.role}({permissions:o,member:n});return r||(0,h.xC)({id:t.id,permissions:t.getPermissionItems()})}},60846:(e,t,n)=>{n.d(t,{D$:()=>l,JZ:()=>c,NL:()=>s,UZ:()=>d});n(21703);var o=n(52027),r=n.n(o),i=n(15095);const a=new(r()),{DIFF_DELETE:s,DIFF_INSERT:l,DIFF_EQUAL:c}=r(),d=function(e,t){const n=u(e,{count:0,encoding:{},decoding:{}}),o=n.encodedString,r=u(t,n.cypher),i=r.encodedString,s=r.cypher,l=function(e,t){return e.map((e=>{let[n,o]=e;return[n,p(o,t)]}))}(a.diff_main(o,i),s);return l.filter((e=>{let[t,n]=e;return""!==n}))};function u(e,t){const n=i.p4(e).map((e=>{const n=t.encoding[e];if(n)return n;{const n=String.fromCharCode(t.count);return t.count++,t.encoding[e]=n,t.decoding[n]=e,n}}));if(t.count>65535)throw new Error("This string has way too many different characters.");const o=n.join("");return{cypher:t,encodedString:o}}function p(e,t){return e.split("").map((e=>t.decoding[e])).join("")}},31352:(e,t,n)=>{n.d(t,{O2:()=>a,Ye:()=>c,ug:()=>s,zK:()=>l});var o=n(15095),r=n(72126),i=n(70203);function a(e,t,n){const a=e.getValue(),s=i.eeV(t),l=i.eeV(a);if(0===s.length&&0===l.length)return""===n?{filter:{startIndex:0,endIndex:0}}:void 0;const c=r.d9(s).reverse(),d=r.d9(l).reverse(),u=l.findIndex(((e,t)=>e!==s[t])),p=d.findIndex(((e,t)=>e!==c[t]));if(-1===u||-1===p)return;const m=o.p4(n),f={filter:{startIndex:u+(m.length>0?1:0),endIndex:u+l.length-s.length}};if(m.length>0){const e=f.filter.startIndex-m.length,t=f.filter.startIndex;l.slice(e,t).join("")===n&&(f.prefix={startIndex:e,endIndex:t})}return f}function s(e,t){if(!t)return;const n=e.getValue();return i.eeV(n).slice(t.filter.startIndex,t.filter.endIndex).join("")}function l(e,t,n){return s(e,a(e,t,n?"@":""))}function c(e,t,n,o,a){if(void 0===e)return!0;if(t&&0===n&&o>3)return!0;if(1===e.length){const t=r.Z$(e);if(t){if(/\s/g.test(t)){const e=a.getValue();if(e&&1===e.length){const t=i.QaF(e);return!(2===t.length&&t.startsWith("/"))}}}}else if(e.length>=2){return e.endsWith("  ")}return!1}},89224:(e,t,n)=>{n.r(t),n.d(t,{areRangesEqual:()=>E,clear:()=>w,containerOffsetIsBetweenNodes:()=>R,get:()=>v,getIncompleteDOMEndpoint:()=>_,getRect:()=>k,getSelectionRect:()=>I,isExpanded:()=>T,isMouseRightClicking:()=>L,isMouseSelecting:()=>N,rangeFromContainerOffsets:()=>M,rangeFromPoint:()=>C,rangeToContainerOffsets:()=>A,resetMouseRightClicking:()=>j,selectionIsBackwards:()=>Z,set:()=>b,setDOMEndpoint:()=>S,setOnNode:()=>x,snapContainerOffsetToNode:()=>D,startListeners:()=>O,toStaticRange:()=>P});n(21703);var o=n(55010),r=n(45060),i=n(1302),a=n(92595),s=n(7406),l=n(68626),c=n(72126),d=n(15723);const u=!1;new WeakMap;let p;const m=c.HP((()=>window.__isElectron?f:()=>window))();function f(){return!p||window.document.hasFocus()?(g("getWindow(): Returning main window because it has focus."),window):p?(g("getWindow(): Returning focused child window."),p):(g("getWindow(): Returning main window because nothing has focus"),window)}function g(){u&&console.log(...arguments)}var h=n(73744);const v=function(){const e=m().getSelection();if(e&&e.rangeCount>0){return e.getRangeAt(0)}},b=function(e,t){y.reset();const n=window.getSelection();if(n){if(!(t.isFirefox&&parseFloat(t.browserVersion)<92))try{return function(e,t){const{focus:n,anchor:o}=A(t);e.collapse(o.container,o.offset),e.extend(n.container,n.offset)}(n,e)}catch(o){l.log({from:"textSelection",type:"textSelectionSet",level:"error",error:(0,s.tg)(o)})}return function(e,t){const n=document.createRange();n.setStart(t.startContainer,t.startOffset),n.setEnd(t.endContainer,t.endOffset),e.removeAllRanges(),e.addRange(n)}(n,e)}};const y=new class{constructor(e){this.state=void 0,this.debugName=e,(0,a.exposeDebugInstance)("endpointLatch",this)}complete(e){if(this.state&&this.state.endpoint!==e.endpoint&&this.state.onlyIfEqual===e.onlyIfEqual){const t="start"===this.state.endpoint?this.state:e,n="end"===this.state.endpoint?this.state:e;return this.state=void 0,{start:t,end:n}}if(this.state){let t=`${this.debugName}: cannot complete latch:`;const n=this.state.endpoint===e.endpoint,o=this.state.onlyIfEqual!==e.onlyIfEqual;n&&(t+=` same endpoint ${e.endpoint}`),o&&(t+=" different tokens"),l.log({level:"warning",from:"EndpointLatch",type:"cannotCompleteLatch",data:{name:this.debugName,message:t,miscDataToConvertToString:{sameEndpoint:n,differentTokens:o}}})}this.state=e}reset(){this.state&&(l.log({level:"warning",from:"EndpointLatch",type:"resetPartialLatch",data:{name:this.debugName,message:`reset latch with endpoint ${this.state.endpoint}`}}),this.state=void 0)}}("domSelection");function _(){return y.state}function S(e,t){const n=y.complete(e);if(!n)return;const{start:o,end:r}=n,i=M({start:o.position,end:r.position});b(i,t)}function w(e){y.reset();const t=window.getSelection();t&&(e.device.isMobile&&e.device.isAndroid?t.collapse(null,void 0):t.removeAllRanges())}const k=function(e){if(e){if(e.collapsed&&e.getClientRects){const t=c.Go(e.getClientRects()[0]);if(!c.xb(t))return t}else if(e.getBoundingClientRect){const t=c.Go(e.getBoundingClientRect());if(!c.xb(t))return t}if(e.startContainer.nodeType===Node.ELEMENT_NODE){if(0===e.startOffset){const t=e.startContainer.getBoundingClientRect();return new d.iL(t.left,t.top,0,t.height)}const t=e.startContainer.childNodes[e.startOffset-1];if(t&&t.nodeType===Node.ELEMENT_NODE){const e=t.getBoundingClientRect();return new d.iL(e.left,e.top,0,e.height)}const n=e.startContainer.childNodes[e.startOffset];if(n&&n.nodeType===Node.ELEMENT_NODE){const e=n.getBoundingClientRect();return new d.iL(e.left,e.top,0,e.height)}}}};function I(){const e=v();if(e)return k(e)}const C=function(e,t){if(document.caretRangeFromPoint){return document.caretRangeFromPoint(e,t)??void 0}if(document.caretPositionFromPoint){const n=document.caretPositionFromPoint(e,t),o=document.createRange();return o.setStart(n.offsetNode,n.offset),o.setEnd(n.offsetNode,n.offset),o}throw new Error("Browser does not support method caretRangeFromPoint or caretPositionFromPoint")};function x(e,t){const n=document.createRange();n.selectNode(e),b(n,t)}function T(e){return Boolean(e&&!e.collapsed)}function M(e){const{start:t,end:n}=e,o=document.createRange();if(t.container)try{o.setStart(t.container,t.offset)}catch(r){console.info(r)}if(n.container)try{o.setEnd(n.container,n.offset)}catch(r){console.info(r)}return o}function P(e){if(!e)return;const{startContainer:t,startOffset:n,endContainer:o,endOffset:r,collapsed:i}=e;return{startContainer:t,startOffset:n,endContainer:o,endOffset:r,collapsed:i}}function A(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Z();const n={container:e.startContainer,offset:e.startOffset},o={container:e.endContainer,offset:e.endOffset},[r,i]=t?[n,o]:[o,n];return{start:n,end:o,focus:r,anchor:i}}function R(e,t,n){if(!t&&!n)return!1;if(!t&&n){const t=document.createRange();return t.selectNode(n),-1===t.comparePoint(e.container,e.offset)}if(t&&!n){const n=document.createRange();return n.selectNode(t),1===n.comparePoint(e.container,e.offset)}if(t&&n){const o=document.createRange();return o.setStartAfter(t),o.setEndBefore(n),0===o.comparePoint(e.container,e.offset)}return!1}function D(e){const{nodesInDomOrder:t,containerOffset:n,snapTowards:o}=e;for(let r=0;r<=t.length;r++){const e=t[r-1],i=t[r];if(R(n,null==e?void 0:e.node,null==i?void 0:i.node))return"start"===o?e:i}}function E(e,t){return e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset&&e.collapsed===t.collapsed}const B=new class{constructor(){this.currentHasNonEmptySelection=!1,this.currentIsBackwards=void 0,this.mouseDownSelection=void 0}selectionIsBackwards(){return Boolean(this.currentHasNonEmptySelection&&this.currentIsBackwards)}updateSelectionDirection(e,t){if(!e||!t||t.collapsed)return this.currentHasNonEmptySelection=!1,void(this.currentIsBackwards=void 0);if(this.currentHasNonEmptySelection=!0,void 0===this.currentIsBackwards){const n=1===t.startContainer.childNodes.length&&t.startContainer.childNodes[0].TEXT_NODE&&t.startContainer.childNodes[0]===e.startContainer;if(e.startContainer===t.startContainer||n)this.currentIsBackwards=t.startOffset<e.startOffset;else{const n=(0,o.Z)(t.startContainer,e.startContainer);this.currentIsBackwards=-1===n}}}startListeners(){window.addEventListener("mousedown",(()=>{i.default.afterNextFlush((()=>{this.mouseDownSelection=v()}))})),window.addEventListener("mouseup",(()=>{i.default.afterNextFlush((()=>{const e=v();this.updateSelectionDirection(this.mouseDownSelection,e)}))})),window.addEventListener("keydown",(()=>{const e=v();i.default.afterNextFlush((()=>{const t=v();this.updateSelectionDirection(e,t)}))}))}},F=new class{constructor(){this.mouseDown=!1,this.keysDown=0,this.wasBackwards=!1,this.device=void 0,this.debugDrawRects=()=>{const e=v();if(T(e)){const{focus:t,anchor:n}=A(e,this.wasBackwards),o=M({start:t,end:t}),i=k(o);i&&(0,r.yX)(i,"FOCUS","red");const a=M({start:n,end:n}),s=k(a);s&&(0,r.yX)(s,"ANCHOR","blue")}},this.handleSelectionChange=()=>{var e;(this.mouseDown||this.keysDown||null!==(e=this.device)&&void 0!==e&&e.isAndroid)&&(this.wasBackwards=function(){const e=window.getSelection();if(!e)return!1;const{focusNode:t,focusOffset:n,anchorNode:r,anchorOffset:i}=e;if(t===r)return n<i;return-1===(0,o.Z)(t,r)}())},this.handleKeyDown=()=>{this.keysDown++},this.handleKeyUp=()=>{this.keysDown--},this.handleMouseDown=()=>{this.mouseDown=!0},this.handleMouseUp=()=>{this.mouseDown=!1}}startListeners(e){return this.device=e,document.addEventListener("selectionchange",this.handleSelectionChange),window.addEventListener("keydown",this.handleKeyDown),window.addEventListener("keyup",this.handleKeyUp),window.addEventListener("mousedown",this.handleMouseDown),window.addEventListener("mouseup",this.handleMouseUp),()=>{document.removeEventListener("selectionchange",this.handleSelectionChange),window.removeEventListener("keydown",this.handleKeyDown),window.removeEventListener("keyup",this.handleKeyUp),window.removeEventListener("mousedown",this.handleMouseDown),window.removeEventListener("mouseup",this.handleMouseUp)}}};function O(e){B.startListeners(),F.startListeners(e)}function Z(){return B.currentIsBackwards||F.wasBackwards}(0,a.exposeDebugGetter)("selectionIsBackwards",Z);let V=!1,U=!1;function N(){return V}function L(){return U}function j(){return U=!1}(0,h.lj)(window,"mousedown",(e=>{0===e.button?V=!0:2===e.button&&(U=!0)}),!0),(0,h.lj)(window,"mouseup",(e=>{0===e.button?V=!1:2===e.button&&(U=!1)}),!0)},89086:(e,t,n)=>{n.d(t,{Gq:()=>J,HE:()=>ee,J5:()=>X,J6:()=>P,J_:()=>V,Ld:()=>x,Ov:()=>N,P2:()=>E,Q3:()=>K,Rb:()=>w,Rw:()=>F,ST:()=>D,ZZ:()=>Y,a6:()=>T,bj:()=>R,dQ:()=>te,e7:()=>O,fM:()=>$,fu:()=>Z,fx:()=>W,hn:()=>q,iB:()=>U,k2:()=>M,lV:()=>Q,mK:()=>z,oc:()=>C,qK:()=>ne,qh:()=>G,td:()=>S,wd:()=>k,x0:()=>B,yR:()=>L,yj:()=>A});n(57658);var o=n(55010),r=n(74994),i=n(41432),a=n(15095),s=n(72126),l=n(21202),c=n(70203),d=n(95371),u=n(28685),p=n(95802),m=n(15723),f=n(50628),g=n(27724),h=n(24666),v=n(68056),b=n(45162),y=n(69645);const _="data-text-edit-side";function S(e){return{[_]:e}}function w(e){if(e instanceof HTMLElement){const t=e.closest(`[${_}]`),n=null==t?void 0:t.getAttribute(_);if("start"===n||"end"===n)return n}}function k(e){return e.startIndex===e.endIndex}function I(e){const{startIndex:t}=e;let n;return n=k(e)?[t-1]:function(e){return s.w6(e.startIndex,e.endIndex)}(e),n}function C(e,t){const n=c.lzi(t),o=n.map((e=>a.p4(c.WiV(e))));if(1===e.length&&-1===e[0]){const e=n[0];if(e){return[c.hDy(e).filter((e=>c.$z2(c.J7s(e))))]}return[]}return e.map((e=>{let t=0;const r=o.findIndex((n=>(t+=n.length,t>e))),i=n[r];return i?c.hDy(i):[]}))}function x(e){if("editing"===h.default.state.mode)return T(e,h.default.state.multiSelection,h.default.state.forceExtendAnnotations)}function T(e,t,n){return M([e],t,n)[e]}function M(e,t,n){const o={};if(0===e.length)return o;if((0,v.iG)(t)){for(const t of e){const e=n[t];if(null!=e&&e.extend){const n=e.annotation;o[t]=n}}return o}const r=new Set(e);let i=!0;const a=(0,b.L5)(t);for(const{store:s,selection:l}of a){const e=s.getValue(),t=c.Ulv(e,l),{tokensInsideRange:n}=c.xrQ(e,t.startIndex,t.endIndex);for(const a of n){const e=c.hDy(a);for(const t of r){const n=e.find((e=>c.J7s(e)===t));if(i&&n)o[t]=n;else if(n);else if(delete o[t],r.delete(t),0===r.size)return o}i=!1}}return o}function P(e){const t=h.default.state;if("editing"!==t.mode)return!1;const{multiSelection:n}=t;if((0,v.iG)(n))return!1;const o=(0,b.L5)(n);for(const{store:r,selection:i}of o){const t=r.getValue();if(!t)continue;const n=c.lzi(t);let o=0;for(const r of n){const t=a.p4(c.WiV(r));if(o>=i.startIndex&&o<i.endIndex||o<i.startIndex&&o+t.length>i.startIndex){if(c.hDy(r).some((t=>c.J7s(t)===e)))return!0}o+=t.length}}return!1}function A(e,t){const n=I(e),o=t.getValue()||[];return function(e,t,n){const o=new r.u,i=e[0]||[];for(const r of i)c.ZAl(r)||(c.lFw(r)||c.EqZ(r)?D(t,n.startIndex,c.J7s(r))&&o.add(r):o.add(r));return o}(C(n,o),o,e)}function R(){const e=h.default.state;if("editing"!==e.mode)return new r.u;const{multiSelection:t,forceExtendAnnotations:n}=e,o=(0,b.L5)(t);if(0===o.length)return new r.u;const{store:i,selection:a}=o[0],l=A(a,i);return s.M6(n,((e,t)=>{e&&(e.extend?l.add(e.annotation):l.remove(e.annotation))})),l}function D(e,t,n){const o=c.b1T(e,t),r=c.hDy(o);return Boolean(r.find((e=>c.J7s(e)===n)))}function E(e){const t=B(e);if(t)return{startIndex:0,endIndex:t.endIndex}}function B(e){const t=u.E.findEditableWithStore(e);if(t)return t.props.getEndSelection?t.props.getEndSelection():void 0;{const t=c.eeV(e.getValue());return{startIndex:t.length,endIndex:t.length}}}function F(e){return 0===e.startIndex&&0===e.endIndex}function O(e,t){return e.store===t&&0===e.index}function Z(e,t){return!e&&!t||e&&t&&(e.startIndex===t.startIndex||!e.startIndex&&!t.startIndex)&&(e.endIndex===t.endIndex||!e.endIndex&&!t.endIndex)}function V(e,t){return Z(t,B(e))}function U(e,t){var n;return e.store===t&&e.index===(null===(n=B(t))||void 0===n?void 0:n.endIndex)}function N(){const e=g.default.getCurrentDefaultContainer();return u.E.getMembersByDOMOrder({filter:t=>{const n=t.getContextClosestSelectable();if(!n)return!1;const o=n.getContextSelectableContainer();return o&&o===e}})}function L(e){const t=e.getNode(),n=t?g.default.getDefaultContainerFromTarget(t):g.default.getCurrentDefaultContainer();return u.E.getMembersByDOMOrder({filter:e=>{const t=e.getContextClosestSelectable();if(!t)return!1;const o=t.getContextSelectableContainer();return o&&o===n}})}function j(e){return N().filter((e=>!e.props.disabled)).map((e=>e.props.store))}function z(e){const t=j(),n=t.indexOf(e);return-1===n?null:t[n-1]}function q(e){const t=j(),n=t.indexOf(e);return-1===n?null:t[n+1]}function H(e){const t=[];for(const n of e){const e=s.cx(t,(e=>{const t=e[0];return m.Kr(n.rect,t.rect)}));e>=0?t[e].push(n):t.push([n])}return t}function W(e,t,n){const{selectableRectMap:r}=f.Z.state,i=n?g.default.getDefaultContainerFromTarget(n):void 0,a=g.default.getCurrentDefaultContainer(),l=i||a,c=p.C.getMembersByDOMOrder({filter:e=>e.props.canSelect&&e.props.canEditText&&e.getContextSelectableContainer()===l}),d=[];for(const o of c){const e=r.get(o);e&&d.push({selectable:o,rect:e})}const u=d.filter((e=>{let{rect:n}=e;return n.top<=t}));u.reverse();const m=H(u),h=s.UI(m,(e=>e.sort(((e,t)=>-1*(0,o.Z)(e.selectable.getNode(),t.selectable.getNode())))[0])),v=s.F(h,(t=>{let{rect:n}=t;return Math.min(Math.abs(n.left-e),Math.abs(n.right-e))}));if(v)return v;const b=H(d.filter((e=>e.rect.bottom>=t&&u.indexOf(e)<0))),y=s.UI(b,(e=>e.sort(((e,t)=>(0,o.Z)(e.selectable.getNode(),t.selectable.getNode())))[0])),_=s.F(y,(t=>{let{rect:n}=t;return Math.min(Math.abs(n.left-e),Math.abs(n.right-e))}));return _||void 0}function K(e,t){const{selectableRectMap:n}=f.Z.state,o=p.C.getMembersByDOMOrder({filter:e=>e.getContextSelectableContainer()===t});for(let r=o.length-1;r>=0;r--){const t=n.get(o[r]);if(t&&t.bottom>e)return!1}return!0}function G(e,t){const n=(0,y.dq)({includeNonSelectableListContainer:!0});if(!n)return!1;const o=s.Z$((0,d.DY)([n],(e=>e.value.component===t)));if(!o)return!1;const{selectableRectMap:r}=f.Z.state;return!(0,d.Yz)(o,(n=>{const o=n.component&&r.get(n.component);return!!(o&&e<=o.bottom&&n.component!==t)}))}function $(e,t,n){const o=e.getValue(),r=[],i=n?c.Jcv(o):c.QaF(o),{startIndex:l,endIndex:d}=t,u=a.p4(i),p=s.tP(u,0,l),m=s.qr(p,(e=>"\n"===e));m>=0?r.push(m):r.push(0);for(let a=l;a<d;a++){"\n"===u[a]&&r.push(a)}return r}function Q(e){const{multiSelection:t}=e;return(0,b.L5)(t).map((e=>{let{store:t,selection:n}=e;const o=c.lzi(t.getValue()),r=c.Ulv(o,n),{tokensInsideRange:i}=c.xrQ(o,r.startIndex,r.endIndex);return c.QaF(i)})).join("\n\n")}function Y(e){const t=h.default.state;return"empty"!==t.mode&&Boolean((0,b.r)(t.multiSelection,e))}function X(e){const t=h.default.state;return"editing"===t.mode&&(t.multiSelection.start.store===e&&(t.multiSelection.end.store===e?"contains-selection":"contains-selection-start"))}function J(e){const t=h.default.state;if("editing"!==t.mode)return!1;const{start:n,end:o}=t.multiSelection;return n.store===e||o.store===e}function ee(e){const t=h.default.state;if("empty"===t.mode)return;const n=(0,v.QY)(t.multiSelection);if(n)return n.store===e?{type:"contain",selection:c.Ulv(e.getValue(),n.selection)}:void 0;const{start:o,end:r}=t.multiSelection;if(o.store===e){const t=c.eeV(e.getValue()).length;return{type:"start",index:Math.min(o.index,t)}}if(r.store===e){const t=c.eeV(e.getValue()).length;return{type:"end",index:Math.min(r.index,t)}}}function te(e){if(!(0,v.iG)(e))return!1;const{store:t,index:n}=e.start;return 0===n||"\n"===c.eeV(t.getValue())[n-1]}function ne(){if("editing"!==h.default.state.mode)return!1;const e=(0,v.QY)(h.default.state.multiSelection);if(!e)return!1;if(!e.store.isTable(l.iU))return!1;if(0===g.default.state.stores.length)return!1;return e.store.getRecordStoreAtRootPath().getType()===i.Ti.code&&(h.default.isEditingCaption()?"caption":"body")}},17311:(e,t,n)=>{n.d(t,{Z:()=>o});const o={unit:8,borderRadius:4,card:{desktop:{small:{width:180,height:100},medium:{width:260,height:148},large:{width:320,height:180}},mobile:{width:"100%"}},vertical:{micro:2,tiny:4,small:8,medium:12,large:24},horizontal:{micro:2,tiny:4,small:8,medium:12,large:24}}},16402:(e,t,n)=>{n.d(t,{IS:()=>d,gs:()=>m,hH:()=>u,uy:()=>p});var o=n(44317),r=n(63143),i=n(9291),a=n(33929);const s=(0,i.defineMessages)({year:{id:"timeUtils.durationDescriptor.year",defaultMessage:"{numYears, plural, one {{numYears} year ago} other {{numYears} years ago}}"},day:{id:"timeUtils.durationDescriptor.day",defaultMessage:"{numDays, plural, one {{numDays} day ago} other {{numDays} days ago}}"},week:{id:"timeUtils.durationDescriptor.week",defaultMessage:"{numWeeks, plural, one {{numWeeks} week ago} other {{numWeeks} weeks ago}}"},hour:{id:"timeUtils.durationDescriptor.hour",defaultMessage:"{numHours, plural, one {{numHours} hour ago} other {{numHours} hours ago}}"},minute:{id:"timeUtils.durationDescriptor.minute",defaultMessage:"{numMinutes, plural, one {{numMinutes} minute ago} other {{numMinutes} minutes ago}}"},second:{id:"timeUtils.durationDescriptor.second",defaultMessage:"Just now"}}),l=(0,i.defineMessages)({year:{id:"timeUtils.durationDescriptor.ultraCompactYear",defaultMessage:"{numYears}y"},day:{id:"timeUtils.durationDescriptor.ultraCompactDay",defaultMessage:"{numDays}d"},week:{id:"timeUtils.durationDescriptor.ultraCompactWeek",defaultMessage:"{numWeeks}w"},hour:{id:"timeUtils.durationDescriptor.ultraCompactHour",defaultMessage:"{numHours}h"},minute:{id:"timeUtils.durationDescriptor.ultraCompactMinute",defaultMessage:"{numMinutes}m"},second:{id:"timeUtils.durationDescriptor.ultraCompactSeconds",defaultMessage:"Just now"}}),c=(0,i.defineMessages)({year:{id:"timeUtils.durationDescriptor.compactYear",defaultMessage:"{numYears}y ago"},day:{id:"timeUtils.durationDescriptor.compactDay",defaultMessage:"{numDays}d ago"},week:{id:"timeUtils.durationDescriptor.compactWeek",defaultMessage:"{numWeeks}w ago"},hour:{id:"timeUtils.durationDescriptor.compactHour",defaultMessage:"{numHours}h ago"},minute:{id:"timeUtils.durationDescriptor.compactMinute",defaultMessage:"{numMinutes}m ago"},second:{id:"timeUtils.durationDescriptor.compactSecond",defaultMessage:"Just now"}});function d(e){let{useCompactFormat:t,useUltraCompactFormat:n,useLowercase:o,roundDownYears:i,useWeeks:d}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const u=n?l:t?c:s,p=new Date(e),m=a.default.getIntl().locale,f=new Date,g=+f-e;if(g>=r._I&&i){const e=Math.floor(g/r._I);return a.default.formatMessage(u.year,{numYears:e})}if(p.getFullYear()!==f.getFullYear()){const e={year:"numeric",month:"short",day:"numeric"},t={year:"numeric",month:"2-digit",day:"2-digit"};return p.toLocaleDateString(m,n?t:e)}const h=Math.floor(g/r.A0);if(h<28&&h>7&&d){const e=Math.floor(h/7);return a.default.formatMessage(u.week,{numWeeks:e})}if(h>=3)return p.toLocaleDateString(m,{month:"short",day:"numeric"});if(h>=1)return a.default.formatMessage(u.day,{numDays:h});const v=Math.floor(g/r.U6);if(v>=1)return a.default.formatMessage(u.hour,{numHours:v});const b=Math.floor(g/r.hM);return b>=1?a.default.formatMessage(u.minute,{numMinutes:b}):o?a.default.formatMessage(u.second).toLocaleLowerCase():a.default.formatMessage(u.second)}function u(e,t){const n=t-e,i=Math.floor(n/r._I),s=Math.floor(n/r.A0),l=Math.floor(n/r.U6),c=Math.floor(n/r.hM),d=Math.floor(n/r.C0);return i>=1?a.default.formatMessage(o.eG.year,{numYears:i}):s>=1?a.default.formatMessage(o.eG.day,{numDays:s}):l>=1?a.default.formatMessage(o.eG.hour,{numHours:l}):c>=1?a.default.formatMessage(o.eG.minute,{numMinutes:c}):a.default.formatMessage(o.eG.second,{numSeconds:d})}function p(e,t){return new Date(e).toLocaleDateString(a.default.getIntl().locale,{month:"long",year:"numeric",day:"2-digit",hour:"numeric",minute:"2-digit",second:t?void 0:"2-digit"})}function m(e){return new Date(e).toLocaleDateString(a.default.getIntl().locale,{month:"short",year:"numeric",day:"numeric"})}},35328:(e,t,n)=>{n.d(t,{BX:()=>p,JO:()=>c,_A:()=>l,fn:()=>m,ih:()=>s,m1:()=>u,tZ:()=>d,th:()=>f});var o=n(41432),r=n(29373),i=n(27724),a=n(45131);function s(e){return Boolean(o.ZY[e])}function l(e,t){return Boolean("toggle"===e||o.wZ[e]&&(null==t?void 0:t.toggleable))}function c(e){return Boolean(o.wZ[e])}function d(e){return o.ZY[e]}function u(e){return o.wZ[e]}function p(e){return"toggle"===e.getType()||m(e)}function m(e){const t=e.getType(),n=e.getFormat();return Boolean(void 0!==t&&(0,o.eJ)(t,n))}function f(e,t,n){let o;o=i.default.state.stores.includes(t)?i.default.state.stores:[t];const s=!(a.Z.isOpen(t.id)&&!n);for(const i of o)r.rd({blockId:i.id,state:s,currentUserId:e.currentUser.id})}},16861:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(68626);n(95477);const r={provider:void 0,logInvertedTextOperationError(e){const{invertedOperation:t,maybeRemappedInvertedOperation:n,transaction:r,errorCode:i}=e;if(this.provider)return this.provider.logInvertedTextOperationError(e);const a=r.getUserActionForAnalyticsPurposesOnly(),{command:s}=t,l=`Applying inverted text operation "${s}" from transaction "${a}" failed with error "${i}".`;o.log({level:"error",from:"transactionDebugHelpers",type:"crdt:logInvertedTextOperationError",error:{message:l},data:{userAction:a,operation:s,errorName:i}})},isDebuggingEnabled(){return Boolean(this.provider)}}},99341:(e,t,n)=>{n.d(t,{JG:()=>a,Vm:()=>i,_V:()=>l,jQ:()=>s});n(57658);var o=n(72126),r=n(77337);function i(e,t){let{allowSquashing:n}=t;if(0===e.length)return{squashedTasks:[]};const i={squashedTasks:[],userId:e[0].userId};function a(e){var t,a;const s=o.Z$(i.squashedTasks),l=s?s.task:void 0,c=Boolean((null===(t=e.debug)||void 0===t?void 0:t.userFlow)||(null==l||null===(a=l.debug)||void 0===a?void 0:a.userFlow));s&&l&&n&&!c&&function(e,t){function n(e){const t=e.operations.map((e=>e.pointer));return o.sv(t,o.Xy)}const r=n(e),i=n(t);return 1===r.length&&1===i.length&&o.Xy(r,i)}(l,e)?(l.operations=(0,r.Iw)([...l.operations,...e.operations]),s.subTasks.push(e)):i.squashedTasks.push({task:{...e},subTasks:[e]})}for(const r of e){if(i.userId!==r.userId)return i;if(JSON.stringify(o.VS(i.squashedTasks,(e=>e.task.operations))).length>=l)return 0===i.squashedTasks.length&&a(r),i;a(r)}return i}function a(e){const{transaction:t,timestamp:n,callback:o}=e;return{id:t.id,userId:t.userId,spaceId:t.spaceId,debug:{userAction:t.getUserActionForAnalyticsPurposesOnly(),userFlow:t.getUserFlowForAnalyticsPurposesOnly()},timestamp:n,operations:t.operations,callback:o,useSudoMode:t.useSudoMode}}function s(e){const t=a({transaction:e,timestamp:Date.now(),callback:void 0});return JSON.stringify(t).length>l}const l=1e5},64856:(e,t,n)=>{n.d(t,{AK:()=>a,IJ:()=>c,W$:()=>i,Xv:()=>s,ox:()=>l,wF:()=>d});var o=n(72126),r=n(9163);function i(e,t){return a(d(e,t))}function a(e){return void 0!==e&&(e===r.FW||e===r.lR)}function s(e,t){if(a(t))return;const n=r.eU[e],o=n.steps.findIndex((e=>e.id===t));return-1===o?n.steps[0].id:o===n.steps.length-1?r.FW:n.steps[o+1].id}function l(e,t){const n=d(e,t);if(n&&!a(n))return s(t,n)}function c(e,t){const n=d(e,t);if(n)return function(e,t){const n=r.eU[e];var i;if(a(t))return null===(i=(0,o.Z$)(n.steps))||void 0===i?void 0:i.id;const s=n.steps.findIndex((e=>e.id===t));return-1!==s&&0!==s?n.steps[s-1].id:void 0}(t,n)}function d(e,t){var n;if(!e)return;const o=((null===(n=e.getSettings())||void 0===n?void 0:n.tutorials)||{})[t];return void 0===o?r.eU[t].steps[0].id:o}},66638:(e,t,n)=>{n.d(t,{u:()=>a});var o=n(18245),r=n(88923),i=n(94134);function a(e){const{environment:t,type:n,blockStore:a,store:s,isInCollectionView:l}=e,c=o.default.mark(n),d=null==a?void 0:a.getType(),u=null==a?void 0:a.useCrdt();o.default.measureAfterNextFlush(c,{environment:t,getData:()=>{const e=null==a?void 0:a.getType(),t=a&&"properties"===s.path[0]&&"title"===s.path[1],n=a&&"properties"===s.path[0]&&"caption"===s.path[1];return{table:s.table,block_property:t?"title":n?"caption":void 0,block_type:e,use_crdt:u,block_type_initial:e!==d?d:void 0,peek_mode:r.default.state.mode,is_in_collection_view:l,profiling_tool:i.getProfilingToolForSession()}}})}},83089:(e,t,n)=>{function o(e){const{unicode:t,fallback:n}=e;try{return t()}catch(o){return n}}n.d(t,{D_:()=>i,Ff:()=>r,V9:()=>o});const r=o({unicode:()=>/\p{L}/u,fallback:/[a-zA-Z]/});function i(e){return r.test(e)}},36867:(e,t,n)=>{n.d(t,{_:()=>a,g:()=>s});var o=n(7057),r=n(15157);const i="userSessionCount";function a(e){const t=c(e);if(!t)return void l({userId:e,count:1});const{count:n,updatedAt:r}=t;(0,o.$6)(r,!0)!==(0,o.$6)(Date.now(),!0)&&l({userId:e,count:n+1})}function s(e){if(!e)return 0;const t=c(e);return(null==t?void 0:t.count)||0}function l(e){let{userId:t,count:n}=e;const o={count:n,updatedAt:Date.now()};r.Z.set({userId:t,key:i,value:o})}function c(e){return r.Z.get({userId:e,key:i})}},85644:(e,t,n)=>{function o(e){return e.isType("page")&&!e.isLocked()&&!e.isCollectionView()&&!e.isInsideCollection()&&!e.isAssociatedCollectionAPageTree()&&e.canAdmin()}function r(e){var t;return(null===(t=e.getCollectionStore())||void 0===t?void 0:t.isPageTreeCollection())??!1}n.d(t,{A:()=>r,z:()=>o})},73819:(e,t,n)=>{n.d(t,{Iy:()=>S,PE:()=>y,ez:()=>b,rv:()=>_});var o=n(67294),r=n(60177),i=n(64338),a=n(13991),s=(n(480),n(97511)),l=n(33125),c=n(86628),d=n(24405),u=n(8848),p=n(82990),m=(n(92650),n(46654)),f=n(65598),g=n(58202),h=n(79797),v=n(99757);function b(e,t,n,a){const s=(0,r.Dl)();(0,i.q7)(null==s?void 0:s.domLock),(0,o.useImperativeHandle)(t,(()=>n),[n]),(0,l.c)(g.R,(()=>n),[n]);return e&&!(0,f.SJ)(e)?a:null}function y(e,t){const n=(0,s.l)();return(0,c.VK)((()=>{if(t)return!1;if(v.n.state)return!1;const o=n&&n.publicEditModeStore.state;return!(0,m.YF)(o)&&e.canEdit()}),[t,n,e])}function _(e){const t=(0,d.Fg)();return(0,c.VK)((()=>{const n=e.getFormat().block_color||"default";return(0,u.fi)(n,t)}),[e,t])}function S(e){return(0,c.VK)((()=>{const t=e.getRecordStoreUIRoot();if(!(t instanceof h.G))return;const n=t.getFormatStore().getKeyStore("page_font").getValue();return p.Z.getHeaderFontFamily({pageFont:n,locale:a.SP})}),[e])}},28267:(e,t,n)=>{n.d(t,{X:()=>i});var o=n(67294),r=n(77794);function i(e){const[t,n]=(0,o.useState)(void 0);return(0,o.useEffect)((()=>{if(!e.current)return;const t=new r.E;return t.observe(e.current),t.rect.addListener((e=>{n(e.state)})),()=>{t.destroy()}}),[e]),t}},63474:(e,t,n)=>{n.d(t,{D:()=>a});var o=n(67294),r=n(480),i=n(97978);function a(){const e=(0,r.O7)();return(0,o.useMemo)((()=>(0,i.mc)(e)),[e])}},26344:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(67294),r=n(72126),i=n(12534);function a(e){return(0,o.useMemo)((()=>({onMouseDown:t=>{e&&(0,i.ZP)({event:t,context:i.Af.EditorMouseDown,callback:r.yR})},onClick:t=>{e&&(0,i.ZP)({event:t,context:i.Af.EditorClick,callback:r.yR})},onDoubleClick:t=>{e&&(0,i.ZP)({event:t,context:i.Af.EditorDoubleClick,callback:r.yR})},onContextMenu:t=>{e&&(0,i.ZP)({event:t,context:i.Af.EditorContextMenu,callback:r.yR})}})),[e])}},35630:(e,t,n)=>{n.d(t,{AS:()=>s,iP:()=>l});var o=n(67294),r=n(480),i=n(86628);const a=(0,o.createContext)(void 0);function s(e){const t=(0,i.VK)((()=>e.state.height),[e]),n=(0,o.useContext)(a)||window;return n!==window?n.innerHeight:t}function l(){const{WindowSizeStore:e}=(0,r.O7)();return(0,i.VK)((()=>{const{width:t,height:n}=e.state;return{width:t,height:n}}),[e])}},5659:(e,t,n)=>{n.d(t,{A:()=>s});var o=n(92595),r=n(55652),i=n(4408),a=n(45950);const s=(0,o.exposeDebugValue)("offlineDebugger",new class{constructor(){var e=this;this.enableLogging=!1,this.operationLatency={},this.log=function(t){if(e.enableLogging){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];console.groupCollapsed(t,...o),console.trace(),console.groupEnd()}},this.generateLocalRecordMap=a.yY,this.getLocalRecord=a.Ye,this.getLocalBlocksWithParent=a.Dx}async measure(e,t,n){var o=this;const i=`OFFLINE: ${e}:`;return this.operationLatency[e]||(this.operationLatency[e]=new r.s((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return o.log(i,...t)}))),this.operationLatency[e].measureErrors(t,"hit","miss",n)}trace(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log("OFFLINE:",...t)}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.log("OFFLINE:",...t)}traceMiss(e,t){for(var n=arguments.length,o=new Array(n>2?n-2:0),r=2;r<n;r++)o[r-2]=arguments[r];this.trace(`missed: record ${e}:${t}`,...o)}clearMemory(){i.LK(window.__console.environment)}})},76856:(e,t,n)=>{function o(e,t,n,o,r){const i="y"===r?"scrollTop":"scrollLeft",a=e[i],s=t-a,l=+new Date;let c=!0,d=null;const u=()=>{if(!c)return;window.requestAnimationFrame(u);const r=+new Date,p=Math.floor(function(e,t,n,o){return(e/=o/2)<1?n/2*e*e+t:-n/2*(--e*(e-2)-1)+t}(r-l,a,s,n));d?d===e[i]?(e[i]=p,d=e[i]):c=!1:(e[i]=p,d=e[i]),r>l+n&&(e[i]=t,c=!1,o&&o())};window.requestAnimationFrame(u)}n.d(t,{Z:()=>o})},75233:(e,t,n)=>{n.d(t,{Z:()=>r});n(21703);var o=n(26263);const r=new class{constructor(){this.pendingEvictions=void 0,this.environmentProvider=void 0,this.environmentProvider=()=>{throw new Error("Environment not ready")},this.pendingEvictions=new Map}getPendingEvictionCount(){return this.pendingEvictions.size}updateEnvironment(e){this.environmentProvider=()=>e}addToPendingEvictions(e,t){const n=(0,o.R)(e),r={...e,timestamp:t};this.pendingEvictions.set(n,r)}removeFromPendingEvictions(e){this.pendingEvictions.delete((0,o.R)(e))}forEachPendingEviction(e){for(const{pointer:t,userId:n,timestamp:o}of this.pendingEvictions.values())e({userId:n,pointer:t,timestamp:o,environment:this.environmentProvider()})}}},79420:(e,t,n)=>{n.d(t,{Z:()=>i});n(21703);var o=n(26263),r=n(21202);const i=new class{constructor(){this.subscribedRecords=void 0,this.pendingUnsubscribeRecords=void 0,this.environmentProvider=void 0,this.environmentProvider=()=>{throw new Error("Environment not ready")},this.subscribedRecords=new Map,this.pendingUnsubscribeRecords=new Map}getPendingUnsubscribeCount(){return this.pendingUnsubscribeRecords.size}updateEnvironment(e){this.environmentProvider=()=>e}getSubscriptionForRecord(e){return this.subscribedRecords.get((0,o.R)(e))}isSubscribedToRecord(e){const t=this.subscribedRecords.get((0,o.R)(e));return Boolean(t)}addToSubscribedRecords(e){const t=(0,o.R)(e),n={...e};this.subscribedRecords.set(t,n)}removeFromSubscribedRecords(e){const t=(0,o.R)(e);this.subscribedRecords.delete(t)}addToPendingUnsubscribeRecords(e,t){const n=(0,o.R)(e),r={...e,timestamp:t};this.pendingUnsubscribeRecords.set(n,r)}removeFromPendingUnsubscribeRecords(e){this.pendingUnsubscribeRecords.delete((0,o.R)(e))}forEachPendingUnsubscribeRecord(e){for(const{pointer:t,userId:n,timestamp:o}of this.pendingUnsubscribeRecords.values())e({userId:n,pointer:t,timestamp:o,environment:this.environmentProvider()})}reset(){this.subscribedRecords=new Map,this.pendingUnsubscribeRecords=new Map}safelyGetEnvironment(){try{return this.environmentProvider()}catch(e){return}}getSubscribedBlockDebuggingData(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.safelyGetEnvironment();if(!t)return;const n={loadedBlockTypes:{},loaded:0,notLoaded:0};for(const[o,i]of this.subscribedRecords.entries())if((e||!this.pendingUnsubscribeRecords.has(o))&&i.pointer.table===r.iU){const e=t.defaultRecordCache.inMemoryRecordCache.getRecord(i);if(e&&e.value){const t=e.value.type;t in n.loadedBlockTypes||(n.loadedBlockTypes[t]=0),n.loadedBlockTypes[t]+=1,n.loaded+=1}else n.notLoaded+=1}return n}}},32223:(e,t,n)=>{n.r(t),n.d(t,{isConnected:()=>i.Mb,isConnecting:()=>i.J9,onMobileNativeReceiveRawMessageStoreMessage:()=>i.tD,onMobileNativeUpdateMessageStoreState:()=>i.Ce,resetRecordSubscriptions:()=>a,updateEnvironment:()=>s});var o=n(75233),r=n(79420),i=n(88536);function a(){r.Z.reset()}function s(e){r.Z.updateEnvironment(e),o.Z.updateEnvironment(e)}},88536:(e,t,n)=>{n.d(t,{vj:()=>Fe,mb:()=>V,cO:()=>De,C$:()=>U,EM:()=>ve,ZN:()=>be,Tm:()=>he,gE:()=>ye,Mb:()=>de,J9:()=>ue,id:()=>pe,Ap:()=>Be,tD:()=>Pe,Ce:()=>Me,eg:()=>Oe,Tg:()=>Ce,Ji:()=>Re,Ld:()=>Ve,hd:()=>Ze,r1:()=>Ne,L4:()=>Ae,g4:()=>me});n(57658),n(21703);var o=n(40682),r=n(68626),i=n(7406),a=n(29477),s=n(21051);const l=class{constructor(e){this.performRequests=void 0,this.batchSize=void 0,this.maxWorkers=void 0,this.maxDelayMs=void 0,this.timeSource=void 0,this.queue=[],this.workerTasks=new Map,this.nextWorkerId=0,this.currentWorkers=0,this.requestsRunning=0,this.awaitingTimeout=!1,this.dequeue=async()=>{if(this.currentWorkers>=this.maxWorkers||0===this.queue.length)return;const e=this.nextWorkerId;this.nextWorkerId++,this.currentWorkers++;const t=this.queue.splice(0,this.batchSize),n=t.map((e=>e[0]));let o,r;this.workerTasks.set(e,t),this.requestsRunning+=t.length;try{o=await this.performRequests(n)}catch(a){r=(0,i.tg)(a)}try{if(r)for(let e=0;e<t.length;e++){t[e][1].reject(r)}else if(o)for(let e=0;e<t.length;e++){const n=t[e],r=o[e];n[1].resolve(r)}}catch(a){}this.currentWorkers--,this.workerTasks.delete(e),this.requestsRunning-=t.length,this.dequeueAfterFilledBatchOrTimeout()};const{performRequests:t,batchSize:n,maxWorkers:o,maxDelayMs:r}=e;this.performRequests=t,this.batchSize=n,this.maxWorkers=o,this.maxDelayMs=r,this.timeSource=s.O}getStats(){return{queue:this.queue.length,running:this.requestsRunning,workers:this.currentWorkers}}updateTimeSource(e){this.timeSource=e}updateBatchSize(e){this.batchSize=e}updateMaxDelayMs(e){this.maxDelayMs=e}updateMaxWorkers(e){this.maxWorkers=e,this.dequeueAfterFilledBatchOrTimeout()}enqueue(e){const t=a.UZ();return this.queue.push([e,t]),this.dequeueAfterFilledBatchOrTimeout(),(0,o.m)({promise:t.promise,canCancel:()=>this.queue.some((e=>e[1]===t)),cancel:e=>{const n=this.queue.findIndex((e=>e[1]===t));n>=0&&(this.queue.splice(n,1),t.reject(e))}})}dequeueAfterFilledBatchOrTimeout(){this.queue.length>=this.batchSize?this.dequeue():this.awaitingTimeout||(this.awaitingTimeout=!0,this.timeSource.setTimeout((()=>{this.awaitingTimeout=!1,this.dequeue()}),this.maxDelayMs))}cancel(){const e=this.workerTasks,t=this.queue;this.workerTasks=new Map,this.queue=[];for(const n of e.values())for(const e of n)e[1].reject(new Error("CanceledTask."));for(const n of t)n[1].reject(new Error("CanceledTask."))}};var c=n(72126),d=n(91155),u=n(77897),p=n(75189),m=n(44615),f=n(4615),g=n(12139),h=n(63143),v=n(36054),b=n(95477),y=n(18245),_=n(5162),S=n(88632);const w=window.location.host.endsWith(b.default.publicDomainName);var k=n(1302),I=n(97978),C=n(77080);function x(e,t){k.default.afterNextFlush((()=>{C.default.checkGate("message_store_client_send_request_metric_enabled")&&I.j(e,"message_store.client.send_request",t)}))}const T=async()=>n.e(7168).then(n.bind(n,14854)),M=!1,P=90*h.C0,A=.5*h.C0,R=30*h.C0,D=3e3,E=10*h.C0,B={versions:!0,collection:!0,activity:!0,notification:!0,teams_in_space:!0,user_page_visit:!0,backlinks:!0,user_content:!0,page_visit:!0,user_shared_pages_in_space:!0,presence:!0,user_joined_teams_in_space:!0,teams_migration_completed_in_space:!0,diagnosticPing:!0,_other:!0};function F(e){const t=e.indexOf("/");if(-1===t)return"_other";const n=e.substring(0,t);return n in B?n:"_other"}function O(e,t){var n;const o=F(t),r=null===(n=(0,m.pz)(t))||void 0===n?void 0:n.table,i=e[o];if(i){if(r){const e=i[r];if(!e)return void Je(`Warning: "${o}.${r}" has no existing counters!`);i[r]=e-1}i._total-=1,e._total-=1}else Je(`Warning: "${o}" has no existing counters!`)}function Z(e){return{_id:e,charactersSent:0,requestsSent:0,requestsTimedOut:0,responsesReceivedWithoutHandlers:0,successfulResponsesReceived:0,unsuccessfulResponsesReceived:0,invalidMessagesReceived:0,notificationsReceived:0,messagesReceived:0}}function V(){return{...ie}}function U(e){const t=ie;if(e._id===t._id)return{charactersSent:t.charactersSent-e.charactersSent,requestsSent:t.requestsSent-e.requestsSent,requestsTimedOut:t.requestsTimedOut-e.requestsTimedOut,responsesReceivedWithoutHandlers:t.responsesReceivedWithoutHandlers-e.responsesReceivedWithoutHandlers,successfulResponsesReceived:t.successfulResponsesReceived-e.successfulResponsesReceived,unsuccessfulResponsesReceived:t.unsuccessfulResponsesReceived-e.unsuccessfulResponsesReceived,invalidMessagesReceived:t.invalidMessagesReceived-e.invalidMessagesReceived,notificationsReceived:t.notificationsReceived-e.notificationsReceived,messagesReceived:t.messagesReceived-e.messagesReceived}}const N=new Map,L=new Map;class j extends Map{isCancelable(e){return Boolean(this.getCancelable(e))}getCancelable(e){const t=this.get(e);if(null!=t&&t.canCancel())return t}}const z=new j,q=new j,H=new Map,W=new Map,K=Date.now();let G={_total:0};const $="messageStoreInternals",Q=new r.BatchedLogger({from:$,type:"BulkDebug",level:"info",maxLength:250,logToConsole:M});let Y,X,J,ee,te=0,ne=0,oe=0,re=0,ie=Z(0),ae=0,se=s.O,le=!1,ce="uninitialized";function de(){return"open"===ce}function ue(){return"uninitialized"===ce||"opening"===ce}const pe=!0;function me(e,t){let n=W.get(e);n||(n={},W.set(e,n)),Object.assign(n,t)}function fe(e){Q.log({level:"info",from:$,type:e})}function ge(){X=function(e){var t;const n=null==e||null===(t=e.socket)||void 0===t||null===(t=t.transport)||void 0===t||null===(t=t.query)||void 0===t?void 0:t.transport;if("websocket"===n||"polling"===n)return n}(this),fe(`ping:${X}`),Y=Date.now(),Je(`Incoming primus ping received from server via ${X}.`)}function he(){return G}function ve(){return{...Le.getStats(),batchSubscribeQueue:ze.getStats(),batchUnsubscribeQueue:qe.getStats()}}function be(e){const{lastOfflineTimestamp:t}=S.Z.getState(),n=ve(),{batchSubscribeQueue:o,batchUnsubscribeQueue:r}=n;return{currentConnectionCounters:ie,timeSinceLastIncomingPing:Y&&e-Y,lastIncomingPingTransportType:X,timeSinceLastResponseReceived:J&&e-J,timeSinceLastReadyStateChange:ee&&e-ee,timeSinceLastOffline:t&&e-t,largestMessageSize:ae||void 0,messageStoreRequestsQueued:n.queue,messageStoreRequestsRunning:n.running,batchSubscribeQueue:o,batchUnsubscribeQueue:r,messageStoreConnectionState:ce,uptime:e-K,subscriptionCounters:G,primusEndEventsReceived:ne,primusErrorEventsReceived:oe,connectionResetsDueToFailedRequests:re}}function ye(){const e=[];L.forEach(((t,n,o)=>{const r=(0,m.pz)(n);r&&t.value&&e.push({id:r.id,table:r.table,version:t.value})}));const t=c.vM(e,(e=>e.table)),n={};return Object.entries(t).map((e=>{let[t,n]=e;const o={};return n.forEach((e=>{o[e.id]=e.version})),{table:t,value:o}})).forEach((e=>{n[e.table]=e.value})),n}function _e(e){switch(Q.log({level:"info",from:$,type:"readyStateChange",data:{message:e}}),ee=Date.now(),e){case"end":ce="closed";break;case"open":ce="open";break;case"opening":ce="opening"}}const Se=c.HP((e=>async function(e){if(w)return;if(Ye(e))return void r.log({level:"warning",from:$,type:"CreatePrimusClientCalledForNativeMessageStoreClient"});te+=1;const{createClient:t}=await T(),n=t({minReconnectDelayMs:4*h.C0,maxReconnectDelayMs:8*h.C0});return n.on("data",$e),n.on("open",(()=>{fe("open"),we(e)})),n.on("reconnected",(e=>{Te(),Q.log({level:"info",from:$,type:"reconnected",data:{message:`Reconnected in ${null==e?void 0:e.duration} ms`}})})),n.on("reconnect",(()=>{fe("reconnect")})),n.on("reconnect scheduled",(e=>{Q.log({level:"info",from:$,type:"reconnect scheduled",data:{message:`Reconnecting in ${null==e?void 0:e.scheduled} ms, attempt ${null==e?void 0:e.attempt} of ${null==e?void 0:e.retries}`}})})),n.on("reconnect timeout",(()=>{fe("reconnect timeout")})),n.on("reconnect failed",(()=>{fe("reconnect failed")})),n.on("timeout",(()=>{fe("timeout")})),n.on("destroy",(()=>{fe("destroy")})),n.on("close",(()=>{fe("close")})),n.on("online",(()=>{fe("online")})),n.on("offline",(()=>{fe("offline")})),n.on("error",(e=>{let t;t="TransportError"===e.type?{level:"info",from:$,type:"primusTransportError",error:(0,d.Ui)(e)}:{level:"error",from:$,type:"unknownPrimusError",error:(0,d.Ui)(e)};(0,u.lB)(1)&&r.rateLimitedLog(t),Q.log(t),oe+=1})),n.on("incoming::ping",ge),n.on("readyStateChange",_e),n.on("end",(()=>{fe("end"),n.off("readyStateChange",_e),ne+=1,async function(e,t){var n,o;r.log({level:"info",from:$,type:"messageStoreEnd",error:{message:`SocketId: ${null==e||null===(n=e.socket)||void 0===n?void 0:n.id} Query:${null==e||null===(o=e.transport)||void 0===o?void 0:o.query}`}}),xe(),se.setTimeout((()=>{void 0!==e&&e.destroy()}),0);const i=await Se(t);if(e!==i)return;Se.cache.clear(),se.setTimeout((()=>{Se(t)}),2*h.C0)}(n,e)})),window.__primusClient=n,n}(e)),(function(){return"primus"}));function we(e){ie=Z(ie._id+1),N.forEach(((t,n)=>{const o=L.get(n);Ee(n,o?o.version:-1,e).catch((e=>{r.log({level:"warning",from:$,type:"ReconnectSubscriptionError",error:(0,d.Ui)(e)})}))})),M&&function(){const e=Date.now(),t=20;function n(){const o=ve();function r(e){return 0===e.queue&&0===e.running}if(r(o)&&r(o.batchSubscribeQueue)&&r(o.batchUnsubscribeQueue))return Je(`Queues emptied after ${Date.now()-e} ms`),void(ke=void 0);ke=window.setTimeout(n,t)}ke&&window.clearTimeout(ke);Je("Starting measurement of time until send queues are empty."),n()}()}let ke,Ie;function Ce(e){if(Ie)throw new Error("Having more than one onRestartMessageStoreConnectionHandler is not currently supported");Ie=e}function xe(){var e;le=!1,ze.cancel(),qe.cancel(),function(){for(const e of H.values())window.clearTimeout(e.timeout);H.clear()}(),z.clear(),q.clear(),He.cancel(),Le.cancel(),W.clear(),G={_total:0},null===(e=Ie)||void 0===e||e()}function Te(){xe()}function Me(e,t){if(!Ye(t))return;Je("onMobileNativeUpdateMessageStoreState",e);const n=!("open"===ce)&&"open"===e;n&&Te(),_e(e),n&&we(t)}function Pe(e,t){if(!Ye(t))return;const n=JSON.parse(e);Je("onMobileNativeReceiveRawMessageStoreMessage",n),de()||Me("open",t),$e(n)}async function Ae(e){var t;const{key:n,field:o,updates:r,ttl:i,environment:a}=e;await(null===(t=Ge({method:"updateField",request:{key:n,field:o,updates:r,ttl:i},environment:a}))||void 0===t?void 0:t.response)}async function Re(e){var t;const{key:n,field:o,value:r,ttl:i,environment:a}=e;await(null===(t=Ge({method:"setField",request:{key:n,field:o,value:r,ttl:i},environment:a}))||void 0===t?void 0:t.response)}async function De(e){if(w)return{type:"messageStoreDisabled"};const t=(0,f.ZP)(),{environment:n}=e,o=(0,m.JK)(t),r="diagnosticPing",i=a.UZ(),s=e.logToConsole??M,l={};function c(e,t){l[e]=t,s&&console.log(`diagnosticPing ${e}=${t}`)}const d=await a.aM(async function(){var e;const a=performance.now();await Ve(o,((e,t)=>{t&&i.resolve(performance.now())}),r,n);const s=performance.now(),d=s-a;c("registerSubscriptionResponseMs",d);const u=await(null===(e=Ge({method:"diagnosticPing",request:{id:t},environment:n,onRequestSent:()=>{c("diagnosticPingEnqueuedMs",performance.now()-s)}}))||void 0===e?void 0:e.response);if(!u)return{type:"canceled",key:o,...l};const p=function(e){const t=l[e];if(void 0===t)throw new Error(`Assertion failure, expected timing for "${e}" to be defined`);return t}("diagnosticPingEnqueuedMs"),m=u.setValueTime;c("diagnosticPingServerSideSetValueMs",m);const f=performance.now()-s;c("diagnosticPingResponseMs",f);const g=await i.promise-s;c("diagnosticPingNotificationMs",g);const h=performance.now();await Ne(o,r,n);const v=performance.now();return{type:"success",key:o,registerSubscriptionResponseMs:d,diagnosticPingEnqueuedMs:p,diagnosticPingServerSideSetValueMs:m,diagnosticPingResponseMs:f,diagnosticPingNotificationMs:g,unregisterSubscriptionResponseMs:v-h,totalMs:v-a}}().catch((e=>(g.rn(e,{from:$,type:"diagnosticPingError",data:{key:o}}),{type:"error",key:o,...l}))),R);return d.timeout?{type:"timeout",key:o,...l}:d.result}async function Ee(e,t,n){pe&&me(e,{latestRegisterSubscriptionRequestTimestamp:Date.now()}),function(e,t){var n;const o=F(t),r=null===(n=(0,m.pz)(t))||void 0===n?void 0:n.table;let i=e[o];if(i||(i={_total:0},e[o]=i),r){const e=i[r]||0;i[r]=e+1}i._total+=1,e._total+=1}(G,e);const o=q.getCancelable(e);if(o)o.cancel(new Error("Cancelled by sendRegisterSubscription()"));else{const o={key:e,version:t},r=ze.enqueueCancelable({request:o,environment:n});if(r){z.set(e,r.asyncQueuePromise);try{await r.response}finally{z.delete(e)}}}pe&&me(e,{latestRegisterSubscriptionResponseTimestamp:Date.now()})}function Be(e){return z.isCancelable(e)}function Fe(e,t){const n=z.getCancelable(e);if(!n)throw new Error(`Assertion failure, subscription request for key ${e} does not exist or is not cancelable`);Ue(e,t)&&(O(G,e),n.cancel(new Error("Cancelled by cancelRegisterSubscription()")),pe&&W.delete(e))}async function Oe(e,t,n){var o;await(null===(o=Ge({method:"registerOnDisconnect",request:{disconnectId:e,operations:t},environment:n}))||void 0===o?void 0:o.response)}async function Ze(e,t){var n;await(null===(n=Ge({method:"unregisterOnDisconnect",request:{disconnectId:e},environment:t}))||void 0===n?void 0:n.response)}async function Ve(e,t,n,o){if(w)return;let r=N.get(e);if(!r||0===r.length)return r=[{listener:t,listenerId:n}],N.set(e,r),void(de()?await Ee(e,-1,o):"uninitialized"!==ce||Ye(o)||await Se(o));if(r.find((e=>e.listenerId===n)))r=[...r.filter((e=>e.listenerId!==n)),{listener:t,listenerId:n}],N.set(e,r);else{r=[...r,{listener:t,listenerId:n}],N.set(e,r);const o=L.get(e);o&&t(e,o.value,o.passThroughData)}}function Ue(e,t){if(w)return!1;const n=N.get(e);if(!n)return!1;const o=n.filter((e=>e.listenerId!==t));return o.length!==n.length&&(0===o.length?(N.delete(e),L.delete(e),!0):(N.set(e,o),!1))}async function Ne(e,t,n){Ue(e,t)&&de()&&await async function(e,t){pe&&me(e,{latestUnregisterSubscriptionRequestTimestamp:Date.now()}),O(G,e);const n=z.getCancelable(e);if(n)n.cancel(new Error("Cancelled by sendUnregisterSubscription()"));else{const n={key:e},o=qe.enqueueCancelable({request:n,environment:t});if(o){q.set(e,o.asyncQueuePromise);try{await o.response}finally{q.delete(e)}}}pe&&W.delete(e)}(e,n)}const Le=new o.z(20);class je{constructor(e,t){this.queue=void 0,this.wrappedPerformRequests=async e=>{const t=e[0].environment;Je(`Sending a batch of ${e.length} ${this.methodName} requests.`);const n=this.performRequests(t,e.map((e=>e.request)));if(!n)throw new Error("MessageStore is disabled.");const o=await n;if(!o)throw new Error("Request cancelled.");return o},this.methodName=e,this.performRequests=t,this.queue=new l({performRequests:this.wrappedPerformRequests,batchSize:250,maxDelayMs:A,maxWorkers:1})}updateTimeSource(e){this.queue.updateTimeSource(e)}getStats(){return this.queue.getStats()}cancel(){this.queue.cancel()}enqueueCancelable(e){if(w)return;const t=this.queue.enqueue(e),n=t.catch((e=>{Je(`enqueueCancelable() for ${this.methodName} cancelled (${e.message})`)}));return{asyncQueuePromise:t,response:n}}}const ze=new je("registerSubscription",((e,t)=>He.enqueue((async()=>{var n;const o=Ge({method:"registerBatchSubscriptions",request:{subscriptions:t},environment:e});return null===(n=await(null==o?void 0:o.response))||void 0===n?void 0:n.responses})))),qe=new je("unregisterSubscription",((e,t)=>He.enqueue((async()=>{var n;const o=Ge({method:"unregisterBatchSubscriptions",request:{keys:t.map((e=>e.key))},environment:e});return null===(n=await(null==o?void 0:o.response))||void 0===n?void 0:n.keys.map((e=>({key:e})))})))),He=new o.z(1);let We;function Ke(){if(!We)return;const{totalRequests:e,requestCounts:t,startTime:n}=We;Je("checkRequestThroughputForBurstWarning requestCounts =",t),e>D&&r.log({level:"warning",from:$,type:"BurstThroughputExceeded",data:{time:Date.now()-n,totalRequests:e,requestCounts:t}}),We=void 0}function Ge(e){if(w)return;const{method:t,request:n,environment:o}=e,r=y.default.mark("message_store.client.send_request.in_queue_time");x(o,{status:"enqueued",endpoint:t}),pe&&function(e){We||(We={startTime:Date.now(),totalRequests:0,requestCounts:{}},se.setTimeout(Ke,E)),We.totalRequests+=1,We.requestCounts[e]=(We.requestCounts[e]||0)+1}(t);const i=Le.enqueue((()=>{var i;const s=(0,f.ZP)();!function(e,t){k.default.afterNextFlush((()=>{C.default.checkGate("message_store_client_send_request_metric_enabled")&&(I.j(e,"message_store.client.send_request.queue_running_size",{value:t.running}),I.j(e,"message_store.client.send_request.queue_backup_size",{value:t.queue}))}))}(o,Le.getStats());const l=y.default.mark("message_store.client.send_request.round_trip_time");y.default.measure(r,{environment:o,data:{endpoint:t}});const c=a.UZ(),d=Date.now(),u=pe?window.setTimeout((()=>{"open"===ce&&(ie.requestsTimedOut+=1,Q.log({level:"info",from:$,type:"requestTimeout",data:{requestId:s,time:Date.now()-d}}))}),P):void 0;H.set(s,{resolve:c.resolve,reject:c.reject,timeout:u,sendTime:d}),Q.log({level:"info",from:$,type:"requestSent",data:{requestId:s,method:t}});const p={type:`${b.default.messageStore.api}/${t}`,requestId:s,...n};return ie.requestsSent+=1,async function(e){const{message:t,environment:n}=e,o=Qe(n),r=JSON.stringify(t);ie.charactersSent+=r.length,ae<r.length&&(ae=r.length);if(o)o(r);else{const e=await Se(n);null==e||e.write(t)}}({message:p,environment:o}),null===(i=e.onRequestSent)||void 0===i||i.call(e),c.promise.then((e=>{y.default.measure(l,{environment:o,data:{endpoint:t}}),x(o,{status:"success",endpoint:t})})).catch((e=>{const n=Le.getStats();x(o,{status:"failure",endpoint:t,queue_running_size:n.running,queue_backup_size:n.queue})})),c.promise}));return{response:i.catch((e=>{e instanceof Xe&&!Ye(o)&&!le?(le=!0,re+=1,fe("connectionResetDueToFailedRequest"),Se(o).then((e=>{null==e||e.end()})),Je(`sendRequest() for ${t} returned server error (${e.message}), resetting connection`,n)):Je(`sendRequest() cancelled or errored for ${t} (${e.message})`,n)})),asyncQueuePromise:i}}function $e(e){ie.messagesReceived+=1;const t=(0,v.Gu)(p.yx,e);if(t)return ie.invalidMessagesReceived+=1,void r.rateLimitedLog({level:"warning",from:$,type:"ValidationError",data:{miscDataToConvertToString:e},error:(0,d.Ui)(t)});const n=e;if("response"===n.type){var o;const{requestId:e,status:t,result:r}=n,i=H.get(e);if(H.delete(e),Q.log({level:"info",from:$,type:"responseReceived",data:{requestId:e,response:t,time:i&&Date.now()-i.sendTime,internalProcessingTimeMs:null===(o=n.result)||void 0===o?void 0:o.internalProcessingTimeMs}}),!i)return void(ie.responsesReceivedWithoutHandlers+=1);J=Date.now(),window.clearTimeout(i.timeout),"ok"===t?(ie.successfulResponsesReceived+=1,i.resolve(r)):(ie.unsuccessfulResponsesReceived+=1,i.reject(new Xe(r)))}else{ie.notificationsReceived+=1;const{key:e,value:t,version:o,passThroughData:a}=n,s=N.get(e);if(!s)return;L.set(e,{version:o,value:t,passThroughData:a});for(const{listener:n}of s)try{n(e,t,a)}catch(i){r.log({level:"warning",from:$,type:"ListenerError",error:(0,d.Ui)(i)})}}}function Qe(e){var t;if((0,_.Y)("supportsNativeMessageStore"))return e&&(null===(t=e.mobileNative)||void 0===t?void 0:t.api.sendRawMessageStoreMessage)}function Ye(e){return Boolean(Qe(e))}class Xe extends Error{constructor(e){super(e),this.name="FailedMessageStoreRequestError"}}function Je(){if(M){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.info("messageStoreInternals:",...t)}}},2688:(e,t,n)=>{n.d(t,{ZP:()=>l});var o=n(89101),r=n(41641),i=n(88536);class a{constructor(){this.uniqueIdCounter=0}addListener(e,t,n,o){if((0,r.Z)(e))return n||(n=this.computeNewSubscriptionId()),i.Ld(e,t,n,o),{key:e,subscriptionId:n}}removeListener(e,t){let{key:n,subscriptionId:o}=e;(0,r.Z)(n)&&i.r1(n,o,t)}async updateField(e,t,n,o,r){await i.L4({key:e,field:t,updates:n,ttl:o,environment:r})}async setField(e,t,n,o,r){await i.Ji({key:e,field:t,value:n,ttl:o,environment:r})}async onDisconnect(e,t,n,o){const r=`${n}/${e}`;await i.eg(r,t,o)}async clearOnDisconnect(e,t,n){const o=`${t}/${e}`;await i.hd(o,n)}computeNewSubscriptionId(){return this.uniqueIdCounter+=1,`subscription:${this.uniqueIdCounter}`}}class s{constructor(){this.isQueuingListeners=!0,this.queuedListeners=[],this.defaultMessageDispatcher=new a}addListener(e,t,n,o){return this.isQueuingListeners?(n||(n=this.defaultMessageDispatcher.computeNewSubscriptionId()),this.queuedListeners=[...this.queuedListeners.filter((t=>t.key!==e||t.subscriptionId!==n)),{key:e,listener:t,subscriptionId:n}],{key:e,subscriptionId:n}):this.defaultMessageDispatcher.addListener(e,t,n,o)}removeListener(e,t){let{key:n,subscriptionId:o}=e;this.isQueuingListeners?this.queuedListeners=this.queuedListeners.filter((e=>e.key!==n&&e.subscriptionId!==o)):this.defaultMessageDispatcher.removeListener({key:n,subscriptionId:o},t)}updateField(e,t,n,o,r){return Promise.resolve()}setField(e,t,n,o,r){return Promise.resolve()}onDisconnect(e,t,n,o){return Promise.resolve()}clearOnDisconnect(e,t,n){return Promise.resolve()}stopQueueingSubscriptions(e){this.isQueuingListeners&&(this.queuedListeners.forEach((t=>{this.defaultMessageDispatcher.addListener(t.key,t.listener,t.subscriptionId,e)})),this.queuedListeners=[],this.isQueuingListeners=!1)}}const l=window.location.pathname===o.VP.quickSearch?new s:new a},84709:(e,t,n)=>{n.r(t),n.d(t,{subscribe:()=>I,unsubscribe:()=>P,unsubscribeAfterDelay:()=>D,unsubscribeForAllUsers:()=>T});n(21703);var o=n(1302),r=n(92595),i=n(68626),a=n(44615),s=n(63143),l=n(41641),c=n(4408),d=(n(95477),n(53730)),u=(n(57658),n(77897),n(29477),n(4615),n(3022),n(54642),n(79420)),p=n(88536);const m=!1,f=!1,g=60*s.C0,h=15*s.C0;s.C0;class v{constructor(e){this.map=new Map,this.timeoutMs=e}set(e){const{key:t,onTimeout:n,onClear:o,value:r}=e;this.clear(t);const i=window.setTimeout((()=>{this.map.delete(t),null==n||n()}),this.timeoutMs);this.map.set(t,{timeout:i,value:r,onClear:o})}get(e){var t;return null===(t=this.map.get(e))||void 0===t?void 0:t.value}clear(e){const t=this.map.get(e);var n;void 0!==t&&(window.clearTimeout(t.timeout),this.map.delete(e),null===(n=t.onClear)||void 0===n||n.call(t))}has(e){return this.map.has(e)}}const b=new v(g),y=new v(h);var _=n(75233),S=n(2688);const w="recordSubscriptionActions";function k(e,t,n){const o=a.pz(t);if(!o)return void i.rateLimitedLog({level:"warning",from:"handleRemoteVersionUpdate",type:"ValidationError",data:{key:t,miscDataToConvertToString:{version:n}}});if(null!==n&&"number"!=typeof n)return void i.rateLimitedLog({level:"warning",from:"handleRemoteVersionUpdate",type:"ValidationError",data:{key:t,miscDataToConvertToString:{pointer:o,version:n}}});const r=[void 0,...e.currentUser.loggedInUserIds];p.id&&((0,p.g4)(t,{latestUpdateTimestamp:Date.now()}),function(e){if(m&&f)return;const t=b.get(e);t&&(t.latestUpdate=Date.now()),y.clear(e)}(t));for(const i of r){if(u.Z.getSubscriptionForRecord({userId:i,pointer:o})){const t=e.defaultRecordCache.inMemoryRecordCache.getVersion({pointer:o,userId:i}),r=d.transactionQueue.isPendingTransactionForRecord(o);(null===n||n>t)&&!r&&c.bG({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:o,userId:i})}}}function I(e){const{pointer:t,userId:n,environment:r}=e,i={pointer:t,userId:n};C(t)||(u.Z.removeFromPendingUnsubscribeRecords(i),_.Z.removeFromPendingEvictions(i),u.Z.isSubscribedToRecord(i)||(u.Z.addToSubscribedRecords(i),o.default.afterNextFlush((()=>{const o=r.defaultRecordCache.inMemoryRecordCache.getRecord(i);o?x({record:o,...e}):c.bG({environment:r,inMemoryRecordCache:r.defaultRecordCache.inMemoryRecordCache,userId:n,pointer:t}).then((t=>{x({record:t,...e})}))}))))}function C(e){return!e.id||!e.table||("emptyDroppableKey"===e.id||"placeholder"===e.id)}function x(e){const{environment:t,pointer:n,userId:o,record:r}=e,s={pointer:n,userId:o};if(!u.Z.isSubscribedToRecord(s))return;const c=a.ZS(n);(0,l.Z)(c)&&(n.id&&n.table?S.ZP.addListener(c,((e,n)=>k(t,e,n)),w,t):i.rateLimitedLog({level:"warning",from:"recordSubscriptionActions:subscribe",type:"KeyValidationError",data:{pointer:n,miscDataToConvertToString:{record:r,key:s,versionsKey:c}}}))}function T(e){for(const t of e.environment.currentUser.loggedInUserIds)P({...e,userId:t})}function M(e){const{pointer:t}=e;if(C(t))return!1;if(!u.Z.isSubscribedToRecord(e))return!1;u.Z.removeFromSubscribedRecords(e);const n=a.ZS(t);return!!(0,l.Z)(n)&&(!(!t.id||!t.table)||(i.rateLimitedLog({level:"warning",from:"recordSubscriptionActions:unsubscribe",type:"KeyValidationError",data:{pointer:t,miscDataToConvertToString:{versionsKey:n}}}),!1))}function P(e){const{environment:t}=e;M(e)&&S.ZP.removeListener({key:a.ZS(e.pointer),subscriptionId:w},t)}const A=2*s.hM,R=A;function D(e){const{pointer:t,environment:n,userId:o}=e;if(C(t))return;if(n.defaultRecordCache.inMemoryRecordCache.hasListener(t))return;const r=a.ZS(t);if((0,p.Ap)(r)){const e={pointer:t,userId:o};return _.Z.addToPendingEvictions(e,Date.now()+R),void(M(e)&&(0,p.vj)(r,w))}u.Z.addToPendingUnsubscribeRecords(e,Date.now()+A)}function E(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];u.Z.forEachPendingUnsubscribeRecord((n=>{let{pointer:o,userId:r,timestamp:i,environment:a}=n;if(i<e){u.Z.removeFromPendingUnsubscribeRecords({pointer:o,userId:r});const e={pointer:o,userId:r};t&&console.log("Unsubscribing and evicting",JSON.stringify(o)),a.defaultRecordCache.inMemoryRecordCache.deleteRecord(e),P({pointer:o,userId:r,environment:a})}})),_.Z.forEachPendingEviction((n=>{let{pointer:o,userId:r,timestamp:i,environment:a}=n;if(i<e){_.Z.removeFromPendingEvictions({pointer:o,userId:r});const e={pointer:o,userId:r};t&&console.log("Evicting",JSON.stringify(o)),a.defaultRecordCache.inMemoryRecordCache.deleteRecord(e)}}))}setInterval((()=>{E(Date.now())}),1e4),(0,r.exposeDebugValue)("forceUnsubscribeAndEvictPendingRecords",(()=>{E(1/0,!0)})),setTimeout((()=>{(0,p.Tg)((()=>{u.Z.forEachPendingUnsubscribeRecord((e=>{let{pointer:t,userId:n,timestamp:o,environment:r}=e;u.Z.removeFromPendingUnsubscribeRecords({pointer:t,userId:n});const i={pointer:t,userId:n};_.Z.addToPendingEvictions(i,o),P({pointer:t,userId:n,environment:r})}))}))}),0)},91948:(e,t,n)=>{n.d(t,{Z:()=>s});n(67294);var o=n(86628),r=n(85248),i=n(17294),a=n(85893);function s(e){let{targetRecordId:t,style:n}=e;window.__c={n:"MoveOrDuplicateProgress"};const s=(0,o.VK)((()=>i.Z.state[t]),[t]);if(!s)return null;const{taskStatus:l,completeBlocks:c,totalBlocks:d}=s,u=(()=>{switch(l){case"not_started":case"failure":return;case"success":return 100;case"in_progress":if("number"!=typeof c||"number"!=typeof d)return;if(0===d)return;const e=c/d;return 1===e?99:Math.round(100*e)}})();return"number"!=typeof u?null:(0,a.jsx)(r.k,{percentage:u,style:n})}},98110:(e,t,n)=>{n.d(t,{Z:()=>m});var o=n(67294),r=n(480),i=n(86628),a=n(15145),s=n(9291),l=n(75754),c=n(6854),d=n(73744),u=n(35683),p=n(85893);function m(e){window.__c={n:"MoveToSnackbarButtons"};const t=(0,r.O7)(),n=(0,i.VK)((()=>!t.device.isPhone),[t]);return(0,p.jsxs)(p.Fragment,{children:[n&&(0,p.jsx)(f,{...e}),(0,p.jsx)(c.ow,{onUndo:void 0})]})}function f(e){let{moveToLocation:t,movedItems:n}=e;window.__c={n:"MoveToVisitButton"};const i=(0,r.O7)(),m=(0,o.useCallback)((e=>{var o;if(t&&"moveToBlock"===t.type)l._({environment:i,openInNew:d.DJ(e),store:t.blockStore,scrollToBlockId:null===(o=n[0])||void 0===o?void 0:o.id,visitType:u.vu.Link,pageVisitSource:a.tY.Move})}),[i,t,n]);return t&&"moveToBlock"===t.type?(0,p.jsx)(c.Pn,{onClick:m,children:(0,p.jsx)(s.FormattedMessage,{defaultMessage:"Visit",id:"moveToHelpers.afterMoveToast.viewButton"})}):null}},41549:(e,t,n)=>{n.d(t,{$x:()=>s,Fz:()=>c,VV:()=>p,h_:()=>m,l5:()=>u,mx:()=>h,pe:()=>d,yJ:()=>l});n(57658);var o=n(63143),r=n(66353),i=n(45325),a=n(50770);function s(e,t){const n=o.vM(e,(e=>{let{notification:t}=e;return t.navigable_block_id??t.id}));return n.forEach(((e,o)=>{const r=[],i=new Set;e.forEach((e=>{const{activity:t}=e;"commented"!==t.type&&r.push(e);const n=t.discussion_id;void 0===n||i.has(n)||(r.push(e),i.add(n))}));const a=r.filter((e=>{let{notification:n}=e;return("mentions"!==t||!n.visited)&&!("archive"===t&&!n.visited)}));0!==a.length?n.set(o,a):n.delete(o)})),n}function l(){const e=r.ZP.state||r.Ve;return(e.width<r.fK||e.width>r.Rx)&&(e.width=r.RJ),i.NotificationInboxFilterOptions.includes(e.filter)||(e.filter=r.uZ),e}function c(){return l().filter}function d(){return l().width}function u(){const e=i.default.state.openState,t=i.default.state.mode;return"closed"===e||"peek"===t?0:d()}function p(){const e=i.default.state.openState,t=i.default.state.mode;return"closed"===e||"closing"===e||"peek"===t?0:d()}function m(e){const{useInboxRedesign:t}=e;return t&&!(0,a.UE)()?{fontWeight:void 0}:{}}function f(e,t){const n=void 0===e?new Date:new Date(e);return n.setDate(n.getDate()-t),n.setHours(0,0,0,0),n.getTime()}function g(e,t){const n=void 0===e?new Date:new Date(e),o=n.getDay();return n.setDate(n.getDate()-o-7*t),n.setHours(0,0,0,0),n.getTime()}function h(e){return[{name:"today",cutoffTime:f(e,0)},{name:"this_week",cutoffTime:g(e,0)},{name:"last_week",cutoffTime:g(e,1)},{name:"older"}]}},50770:(e,t,n)=>{n.d(t,{H7:()=>i,UE:()=>s,r_:()=>a});var o=n(5162),r=n(77080);function i(e){const t=Boolean(null==e?void 0:e.disableExposureLogging);if((0,o.Y)("supportsMobileWebInbox2"))return!0;return"control"!==r.default.getEligibleGroup({experimentId:"inbox_2_0",defaultGroup:"control",disableExposureLogging:t})}function a(){const e=r.default.getEligibleGroup({experimentId:"inbox_2_0",defaultGroup:"control"});return"peek"===e||"time_grouping"===e}function s(){return"time_grouping"===r.default.getEligibleGroup({experimentId:"inbox_2_0",defaultGroup:"control"})}},84437:(e,t,n)=>{n.d(t,{Bm:()=>I,N$:()=>S,WS:()=>k,fW:()=>b,sh:()=>v,tE:()=>w});var o=n(72126),r=n(4615),i=n(89101),a=n(64002),s=n(86615),l=n(54642),c=n(47839),d=n(12714),u=n(82530),p=n(37181),m=n(95477),f=n(97978),g=n(71574),h=n(59110);async function v(e){const{environment:t,spaceStore:n,collectionViewStore:o,from:s}=e;if(!!n&&!(0,g.tE)())return void async function(e){const{environment:t,spaceStore:n,collectionViewStore:o,from:s}=e;if(t.device.isElectron){const e=a.bf({url:`${m.default.domainBaseUrl}${i._j.signup}`,query:{showNotionCalendarModal:"true"}});return void d.D({environment:t,url:e})}const l=await _({environment:t,spaceStore:n,collectionViewStore:o,from:s}),c=(0,r.ZP)(),u=a.bf({url:m.default.calendar.notionAuthUrl,query:{...l,csrf:c}});await(0,g.PQ)({environment:t,csrf:c}),h.Z.setState({isConnectingCalendar:!0}),d.D({environment:t,url:u})}(e);const l=o?m.default.calendar.openNotionDatabaseUrl:m.default.calendar.domainBaseUrl,u=await _({environment:t,collectionViewStore:o,spaceStore:n,from:s});!async function(e){const{environment:t,url:n,targetSelf:o}=e;if(!t.device.isElectron)return d.D({environment:t,url:n,targetSelf:o});const{desktopProtocol:r}=m.default.calendar;if(!(await c.isProtocolRegistered(r)))return d.D({environment:t,url:n,targetSelf:o});const i=n.replace(/^https?:/,`${r}:`);c.openExternalUrl(i)}({environment:t,url:a.bf({url:l,query:u})})}async function b(e){const{environment:t,csrf:n,calendarCsrf:r,spaceId:i,integration:a,redirectUri:c,state:d}=e;if(!(await(0,g.Bs)({environment:t,csrf:n})))return void y({environment:t,redirectUri:c,query:o.GM({state:d},o.o8)});const u=await l.createOauthAuthorizationCode(t,{integrationId:a.id,spaceId:i,redirectUri:c,acceptedIntegrationCapabilities:a.capabilities});if("failed"===u.type)return void y({environment:t,redirectUri:c,query:o.GM({state:d},o.o8)});await s.dl(t);const p={code:u.data.code,calendarCsrf:r,state:d};y({environment:t,redirectUri:c,query:o.GM(p,o.o8)})}function y(e){const{environment:t,redirectUri:n,query:o}=e,r=a.bf({url:n,query:o});d.D({environment:t,url:r,targetSelf:!0})}async function _(e){const{environment:t,spaceStore:n,collectionViewStore:r,from:i}=e,a=await(0,f.cG)(t);if(!n&&!r)return{notionDeviceId:a,from:i};const s={env:"production",collection_view_id:null==r?void 0:r.id,workspace_id:null==n?void 0:n.id,notionDeviceId:a,from:i};return o.GM(s,o.o8)}function S(){h.Z.setState({isForceShowing:!0})}function w(e){const{environment:t,userSettingsStore:n}=e;u.createAndCommit({environment:t,userAction:"NotionCalendarLaunchModal.clickCancel",perform:e=>{p.d2({userSettingsStore:n,transaction:e,data:{notion_calendar_launch_modal_dismissed_at:Date.now(),notion_calendar_launch_modal_phase:"dismissed_modal"}})}})}function k(e,t){const{phase:n,transactionUserAction:o,userSettingsStore:r}=t;u.createAndCommit({environment:e,userAction:o,perform:e=>{p.d2({userSettingsStore:r,transaction:e,data:{notion_calendar_launch_modal_phase:n}})}})}function I(e){const{environment:t,transactionUserAction:n,userSettingsStore:o}=e;u.createAndCommit({environment:t,userAction:n,perform:e=>{p.d2({userSettingsStore:o,transaction:e,data:{seen_open_in_calendar_tooltip:!0}})}})}},71574:(e,t,n)=>{n.d(t,{Bs:()=>g,Iu:()=>h,PQ:()=>f,ZH:()=>u,tE:()=>p});var o=n(77657),r=n(4615),i=n(12955),a=n(18514),s=n(48779),l=n(80444),c=n(77080),d=n(30874);function u(e){const{environment:t}=e;return!!c.default.checkGate("notion_calendar")&&(!t.device.isMobile&&(!(0,a.Sr)()&&!s.Cx(l.default.state.currentSpaceStore)))}function p(){const{bots:e,externalAuthentications:t}=d.Z,n=e.state.find((e=>e.integration_id===o.Dv));if(!n)return!1;const r=t.state.find((e=>e.parent_id===n.id));return Boolean(r)}const m="notion_calendar_csrf";async function f(e){const{environment:t,csrf:n}=e;await(0,i.setCookie)(t,{name:m,value:n})}async function g(e){const{environment:t,csrf:n}=e,o=await(0,i.getCookie)(t,m),a=!!o&&(0,r.t)(o)&&o===n;return(0,i.removeCookie)(m),a}function h(e){const t=e.userSettingsStore.getSettings();return!(null==t||!t.signup_time)&&t.signup_time>17054892e5}},59110:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{}}}const i=new r},55081:(e,t,n)=>{n.d(t,{EV:()=>z,Ex:()=>U,I1:()=>L,Mf:()=>N,Qt:()=>H,VW:()=>q,lp:()=>j,xN:()=>V,yH:()=>Z,zJ:()=>F});n(67294);var o=n(79946),r=n(7406),i=n(68626),a=n(59730),s=n(15157),l=n(97213),c=n(89101),d=n(15047),u=n(77858),p=n(19889),m=n(9291),f=n(38208),g=n(47307),h=n(94273),v=n(92625),b=n(97977),y=n(9953),_=n(8055),S=n(1357),w=n(70782),k=n(64369),I=n(33954),C=n(24608),x=n(33929),T=n(48779),M=n(77907),P=n(74948),A=n(80444),R=n(79797),D=n(10929),E=n(75538),B=n(85893);async function F(e,t){if(!e.currentUser.id)return!1;const n=O(e);return!!D.BB(n)||(t||(t=new R.U6(e,{table:p.KJ,id:e.currentUser.id}),await t.awaitNonNullValue()),!t.getOnboardingCompleted())}function O(e){return{...s.Z.get({userId:e.currentUser.id,key:E.onboardingPreferenceKey}),currentUserId:e.currentUser.id}}async function Z(e,t){const{state:n}=E.default;if(n.isLoading||n.isOnboarding||!e.currentUser.id)return;const o=O(e);if(!o.isOnboarding)return;if(D.NT(o)&&t&&(null==t?void 0:t.id)!==o.spaceViewId)return;const{flow:r}=o,a="desktop_join_or_create_space"===r||"mobile_join_or_create_space"===r,s=await D.dD({environment:e,disableRedirects:a});s&&(o.onboardingData=s),E.default.setState(o);const{spaceId:l}=o;if(l&&(e.device.isMobileNative&&i.log({level:"info",from:"onboardingActions",type:"SpaceSwitchingDebug",data:{message:"onboardingActions.restoreOnboardingState setting space",spaceId:l}}),A.default.setState({...A.default.state,currentSpaceStore:new R.H2(e,{table:d.bx,id:l})})),o.isOnboarding&&"spaceViewId"in o&&o.spaceViewId){const t=new R.V9(e,{table:u.zU,id:o.spaceViewId});A.default.setState({...A.default.state,currentSpaceViewStore:t})}W(e,o)}async function V(e){await L(e,{type:"create-or-join"})}const U=function(e){const{userStore:t,transaction:n}=e;y.sW({store:t,data:{onboarding_completed:!0},transaction:n})},N=function(e){const{userStore:t,transaction:n}=e;y.sW({store:t,data:{mobile_onboarding_completed:!0},transaction:n})};async function L(e,t){try{_.c4({environment:e,url:c._j.onboarding});const n=await D.dD({environment:e,disableRedirects:Boolean(t.disableRedirectUrl)||"create-or-join"===t.type}),r=D.Pn(n),i=await M.deps.onboardingStateActions.loader(),a=await i.getInitialState({environment:e,startOnboardingArgs:t,onboardingData:n,redirectData:r});if(a&&a.isOnboarding){"invalid"===r.type&&(a.stage="error"),E.default.setState(a);const t=D.jn(a);f.NG(e,t),f.y6(e,t),W(e,a),a.isNewUser&&(o.I$(),o.j({device:e.device,event:{facebook:{eventName:"CompleteRegistration"},google:{eventName:"registration"}},cookieService:e.cookieService}))}}catch(n){const t=(0,r.tg)(n);!function(e,t,n){E.default.setState({...E.default.state,isLoading:!1}),f.Gk(e,{...D.jn(E.default.state),errorMessage:t.message}),i.log({level:"error",from:"onboardingActions",type:"handleError",error:{message:`Found onboarding error: ${t.message}`}});const o=n?async()=>await b.actuallyLogoutAndDeleteMostLocalData({environment:e,logoutOrigin:l.F.OnboardingError}):void 0;g.showMessage({message:t.message,onAccept:o})}(e,t,"WorkspaceCreationError"===t.name&&(0,a.Zw)(t)&&t.data.newUser)}}async function j(e,t){if(t.isOnboarding)try{const n=await M.deps.onboardingStateActions.loader(),o=await n.updateAndGetNextState(t,e);f.y6(e,D.jn(o)),E.default.setState(o),o.isOnboarding&&W(e,o)}catch(n){z(e,(0,r.tg)(n))}}async function z(e,t){if(E.default.setState({...E.default.state,isLoading:!1}),i.log({level:"error",from:"onboardingActions",type:"handleOnboardingError",error:{message:`Found onboarding error: ${t.message}`,stack:String(t.stack)}}),v.x(),t instanceof C.Gg&&(0,a.Rp)(t.data.responseBody)&&"UnauthorizedError"===t.data.responseBody.name)return void f.ho(e,{...D.jn(E.default.state),errorMessage:t.message,debugMessage:"UnauthorizedError"});let n;if(t instanceof C.Gg){var o;const e=null==t||null===(o=t.data)||void 0===o||null===(o=o.responseBody)||void 0===o?void 0:o.clientData;e&&(n=(0,I.XN)(x.default.getIntl(),e))}f.ho(e,{...D.jn(E.default.state),errorMessage:t.message,debugMessage:n||"undefined"});await g.confirmUserAction({message:(0,B.jsxs)("div",{children:[(0,B.jsx)(k.Z,{style:{fontSize:17,fontWeight:500,lineHeight:"24px",paddingBottom:8},children:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Oops, something went wrong.",id:"onboardingActions.onboardingErrorDialog.message"})}),(0,B.jsx)("div",{children:n??t.message})]}),acceptLabel:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Start over",id:"onboardingActions.onboardingErrorDialog.startOverButton.label"}),cancelLabel:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Close",id:"onboardingActions.onboardingErrorDialog.closeButton.label"})})&&function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:L;const o=E.default.state;D.n0(o)?n(e,{type:"new-user",disableRedirectUrl:!0}):D.y7(o)?n(e,{type:"create-or-join",disableRedirectUrl:!0}):e.device.isMobile?n(e,{type:"mobile-onboarding",disableRedirectUrl:!0}):i.log({level:"error",from:"onboardingActions",type:"handleOnboardingError",error:{message:`Could not redirect onboarding: ${t.message}`,stack:String(t.stack)}})}(e,t)}async function q(e){const{state:t}=E.default;if(D.n0(t)){if(!(await g.confirmUserAction({message:(0,B.jsxs)("div",{style:{display:"block"},children:[(0,B.jsx)("div",{style:{fontWeight:600},children:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Cancel new account setup?",id:"onboardingActions.closeOnboardingDialog.newUser.title"})}),(0,B.jsx)("div",{children:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"You'll be taken back to the Notion home page.",id:"onboardingActions.closeOnboardingDialog.newUser.subtitle"})})]}),acceptLabel:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Return to home page",id:"onboardingActions.closeOnboardingDialog.newUser.confirmCloseButton.label"}),cancelLabel:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Continue setup",id:"onboardingActions.closeOnboardingDialog.newUser.continueButton.label"})})))return;f.jw(e,D.jn(t)),await b.actuallyLogoutAndDeleteMostLocalData({environment:e,logoutOrigin:l.F.OnboardingExit})}else{if(!(await g.confirmUserAction({message:(0,B.jsxs)("div",{style:{display:"block"},children:[(0,B.jsxs)("div",{style:{fontWeight:600},children:[" ",(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Cancel new workspace setup?",id:"onboardingActions.closeOnboardingDialog.existingUser.title"})]}),(0,B.jsx)("div",{style:{wordBreak:"keep-all"},children:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"You'll be taken back to your previous workspace.",id:"onboardingActions.closeOnboardingDialog.existingUser.subtitle"})})]}),acceptLabel:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Back to previous workspace",id:"onboardingActions.closeOnboardingDialog.existingUser.confirmCloseButton.label"}),cancelLabel:(0,B.jsx)(m.FormattedMessage,{defaultMessage:"Continue setup",id:"onboardingActions.closeOnboardingDialog.existingUser.continueButton.label"})})))return;f.jw(e,D.jn(t));const{mainEditorCurrentBlockStore:o}=A.default.state,r=null==o?void 0:o.getSpaceId(),a=r&&(0,T.w3)(r);if(a){const t=a.getSpaceStore();e.device.isMobileNative&&i.log({level:"info",from:"onboardingActions",type:"SpaceSwitchingDebug",data:{message:"onboardingActions.handleCloseOnboarding set space",spaceId:null==t?void 0:t.id}}),A.default.setState({...A.default.state,currentSpaceStore:t,currentSpaceViewStore:a})}const{url:s,userId:l}=h.Vr(e);let c=e;if(l&&l!==e.currentUser.id&&(c=await w.x({environment:e,newCurrentUserId:l})),s){var n;P.close();const e=()=>{const e={isOnboarding:!1,isLoading:!1,currentUserId:l};E.default.setState(e)};_.c4({environment:c,url:s}),null!==(n=c.mobileNative)&&void 0!==n&&n.supportsNativeHomeOnPhone()?S.d(c,e):e()}}}function H(e){const{state:t}=E.default;f.J7(e,D.jn(t)),E.default.setState({isOnboarding:!1,isLoading:!1,currentUserId:e.currentUser.id})}function W(e,t){if(!t.isOnboarding)return;if(t.isOnboarding){const n=[...t.historicalStages||[],{stageName:t.stage,stageNumber:t.stageNumber,timestamp:Date.now()}];E.default.setState({...t,historicalStages:n.length>20?[{stageName:"truncated",stageNumber:-1,timestamp:Date.now()}]:n}),f.o7(e,"onboarding_stage",{...D.jn(t),historical_stages:n})}}},10929:(e,t,n)=>{n.d(t,{$U:()=>G,At:()=>W,BB:()=>B,Bu:()=>O,Fz:()=>ae,NT:()=>F,Pn:()=>q,SN:()=>K,Vb:()=>ie,WX:()=>$,YH:()=>ee,_J:()=>H,bM:()=>re,bN:()=>Q,bm:()=>oe,dD:()=>V,eW:()=>E,ey:()=>L,fz:()=>R,iF:()=>U,jF:()=>N,jn:()=>z,lr:()=>Z,n0:()=>A,og:()=>J,pd:()=>te,rT:()=>X,tr:()=>M,uO:()=>ne,vA:()=>Y,y7:()=>P});var o=n(8848),r=n(80994),i=n(33728),a=n(68626),s=n(72126),l=(n(4615),n(15047)),c=n(60949),d=n(97880),u=n(82990),p=n(9291),m=n(38208),f=n(54642),g=n(97977),h=n(76464),v=n(9953),b=n(29974),y=n(97627),_=n(82530),S=n(97978),w=n(33929),k=n(48779),I=n(80444),C=n(77080),x=n(79797),T=n(75538);function M(e,t){return`/tutorial/${e}${"dark"===t.state.mode?"-dark":""}.png`}function P(e){return e.isOnboarding&&("desktop_join_or_create_space"===e.flow||"mobile_join_or_create_space"===e.flow)}function A(e){return e.isOnboarding&&("desktop_cold_start"===e.flow||"mobile_cold_start"===e.flow||"desktop_joinable_spaces"===e.flow||"mobile_joinable_spaces"===e.flow||"desktop_redirect"===e.flow||"mobile_redirect"===e.flow)}function R(e){const{state:t}=e;return A(t)}const D=(0,p.defineMessages)({personalWorkspaceName:{defaultMessage:"{userName}'s Notion",id:"onboardingHelpers.personalWorkspaceName"}});function E(e,t){return t.formatMessage(D.personalWorkspaceName,{userName:e.trim()})}function B(e){return e.isOnboarding&&Boolean(T.InAppOnboardingStages.find((t=>t===e.stage)))}function F(e){return e.isOnboarding&&(Boolean(T.InAppOnboardingStages.find((t=>t===e.stage)))||"invite"===e.stage)}function O(e){return e.isOnboarding&&"template_optout"===e.stage}function Z(e){const t=e.userStore.getEmail();if(t&&e.isUserDomainJoinable)return(0,i.Gd)(t)}async function V(e){T.default.setState({...T.default.state,isLoading:!0});const{disableRedirects:t,environment:n}=e;a.log({level:"info",from:"onboardingHelpers",type:"loadOnboardingData",data:{message:"initializeOnboardingDataLoad"}});const[o,i,s,l,c,u,p]=await Promise.all([f.getJoinableSpaces(n,{}),(0,k.iX)({environment:n,disableRedirectUrl:t}),f.isUserDomainJoinable(n,{}),f.isEmailEducation(n,{}),f.validateUserCanCreateWorkspace(n,{}),f.getVerifiedEmailDomain(n,{}),f.getGeoIpLocation(n,{})]);a.log({level:"info",from:"onboardingHelpers",type:"loadOnboardingData",data:{message:"completedOnboardingDataLoad",miscDataToConvertToString:{joinableSpacesResponseType:o.type,joinableSpacesResponseStatus:o.status,userRedirectDataId:i.userRootStore.id,isUserDomainJoinableResponseType:s.type,isUserDomainJoinableResponseStatus:s.status,validateUserCanCreateWorkspaceStatus:c.status}}}),T.default.setState({...T.default.state,isLoading:!1});const m={isUserDomainJoinable:"success"===s.type&&s.data.isJoinable,isEducationPlanEligible:"success"===l.type&&l.data.isEligible,canUserCreateSpace:"success"!==c.type||c.data.canUserCreateSpace,isUserUsingVerifiedDomain:"success"===u.type&&(0,d.$K)(u.data.id),...i,countryCode:"success"===p.type&&(0,r.GC)(p.data.countryCodeFromIp)?p.data.countryCodeFromIp:void 0};return"success"===o.type?{joinableSpaceData:o.data,...m}:{joinableSpaceData:{results:[]},...m}}async function U(e){const t=await f.getGeoIpLocation(e,{});return"success"===t.type&&(0,r.GC)(t.data.countryCodeFromIp)?t.data.countryCodeFromIp:void 0}function N(e){if(P(e)){const{userRootStore:t}=e.onboardingData;if("timed_trial_upsell"===e.stage)return!1;const n=t.getSpaceViewPointers();if(n)return n.length>0}return!1}function L(e){const{onboardingData:t,isNewUserFlow:n}=e,{userRootStore:o}=t,{results:r}=t.joinableSpaceData,i=o.getSpaceViewStores().map((e=>e.getSpaceId()));return n?r:r.filter((e=>i.indexOf(e.id)<0))}function j(e){return e.isOnboarding&&"profile"!==e.stage&&"error"!==e.stage}function z(e){var t,n,o,r,i;const{currentUserSettingsStore:a,currentSpaceStore:s}=I.default.state;return{flow_name:e.isOnboarding?e.flow:"not_defined",flow_id:e.isOnboarding?e.flowId:void 0,stage:e.isOnboarding?e.stage:"not_defined",initial_workspace_type:j(e)?e.spaceJoinOrCreate:void 0,is_new_onboarding:X(e),is_create_or_join:P(e),stage_number:e.isOnboarding?e.stageNumber:void 0,num_of_joinable_spaces:e.isOnboarding&&"workspace_choose"===e.stage?(null===(t=e.joinableSpaces)||void 0===t?void 0:t.length)||0:void 0,historical_stages:e.isOnboarding?e.historicalStages:void 0,selectedPresets:e.isOnboarding&&"workspace_setup"===e.stage?e.selectedPresets:void 0,user_persona:null==a||null===(n=a.getSettings())||void 0===n?void 0:n.persona,user_team_role:null==a||null===(o=a.getSettings())||void 0===o?void 0:o.team_role,user_use_cases:null==a||null===(r=a.getSettings())||void 0===r?void 0:r.use_cases,user_company_size:null==a||null===(i=a.getSettings())||void 0===i?void 0:i.company_size,plan_type:null==s?void 0:s.getPlanType(),plan_selection:"planSelection"in e?e.planSelection:void 0}}function q(e){const{redirectSpaceId:t,redirectPageId:n,forkPageBlockId:o,hasExplicitAccessToRedirectPage:r,canJoinRedirectSpace:i,publicAccessPageId:a,oauthAuthorizationParams:s}=e;return s?{type:"oauth_authorization_redirect",...s}:o?{type:"fork_page",pageId:o}:!a||r||i?!t||r||i?t&&n&&r&&!i?{type:"guest_redirect",pageId:n,spaceId:t}:t&&n&&i?{type:"redirect_page",pageId:n,spaceId:t}:t&&i?{type:"redirect_space",spaceId:t}:{type:"getting_started_page"}:{type:"invalid"}:{type:"public_access_page_redirect",pageId:a}}async function H(e,t){const{onboardingData:n,name:o,profilePhoto:r,password:i,emailOptIn:a}=e,s=n.userStore;S.Zf(t,{email_optin_product_tips_and_news:a,email_optin_resources_and_events:a,email_optin_notion_for_startups:a}),_.createAndCommit({userAction:"onboardingHelpers.setProfileData",environment:t,perform:e=>{const t={...r&&{profile_photo:r}};t.name=o,v.sW({store:s,data:t,transaction:e})}});const l=await g.shouldCreatePassword(t)&&!Y();i&&l&&await f.setPassword(t,{newPassword:i,sendEmail:!1})}function W(e){if(!C.default.checkGate("survey_data_writes"))return;const{environment:t,state:n,spaceStore:o,spaceViewStore:r}=e,i=(new Date).getTime();if(r){const e=c.Dh({maybeFunction:n.userPersona,guessedFunctionVersion:4,maybeRole:n.userRole,guessedRoleVersion:2,collectedFrom:"onboarding",collectedAt:i});void 0!==e&&y.Q1(t,e,r)}if(o){const e=c.K0({maybeIntent:n.planSelection,guessedIntentVersion:1,maybeCompanySize:n.companySize,guessedCompanySizeVersion:2,maybeUseCases:n.useCases,guessedUseCasesVersion:3,collectedFrom:"onboarding",collectedAt:i});void 0!==e&&b.wg(t,e,o)}}async function K(e,t){const{spaceId:n,onboardingData:o}=e;if(!n)return;const r=x.H2.createChildStore(o.userRootStore,{table:l.bx,id:n});await async function(e,t,n){t.isChecked&&t.joinableUserEmailDomain&&await b.$F({environment:e,emailDomains:[t.joinableUserEmailDomain],spaceStore:n})}(t,e,r);const{emails:i}=e,a=s.jj(i).map((e=>({type:"newUser",value:{email:e},source:"email"})));i.length>0&&(await h.n_({environment:t,store:r,inviteTargets:a,inviteRole:"editor",isOnboarding:!0,invite:{inviteOrigin:"onboarding_invite"}}),m.qJ(t,{...z(e),emails:e.emails,auto_join_space:e.isChecked,is_bulk_invite:e.isBulkInvite}))}function G(e){const{userStore:t}=e,n=w.default.getIntl(),o=t.getFullName(n),r=t.getProfilePhoto()||null;if(o)return{name:o,profilePhoto:r,password:null,prefilled:!0}}const $="inviteCode";function Q(e){return(e.isBulkInvite?e.emailTokens:e.emailInputs.filter((e=>""!==e.sanitizedEmail))).length>0}function Y(){var e;const{currentUserSettingsStore:t}=I.default.state;return t&&t.isReady()&&"email-password"===(null===(e=t.getSettings())||void 0===e?void 0:e.mobile_ads_signup_variant)}function X(e){return e.isOnboarding&&e.isNewUser}function J(e){return e.device.isMobileBrowser}const ee={fontSize:12,color:o.ZP.mediumTextColor,fontWeight:u.Z.fontWeight.medium,lineHeight:"135%",marginTop:20,marginBottom:4},te={marginTop:14,marginBottom:14},ne={marginTop:8,marginBottom:8};function oe(e){return{color:e.mediumTextColor}}const re={width:60},ie={marginTop:14,marginBottom:8,fontSize:16,fontWeight:600},ae={boxShadow:`0 0 0 1px ${o.ZP.red}`}},75538:(e,t,n)=>{n.r(t),n.d(t,{InAppOnboardingStages:()=>a,default:()=>c,onboardingPreferenceKey:()=>s});var o=n(14577),r=n(49085),i=n(15157);const a=["template_optout","workspace_setup"],s="lastOnboardingStateKeyV1";class l extends r.default{setState(e){super.setState(e),function(e){if(e.isOnboarding)if("profile"===e.stage){const{onboardingData:t,isLoading:n,password:o,passwordErrorData:r,currentUserId:a,...l}=e;i.Z.set({userId:a,key:s,value:l})}else{const{onboardingData:t,isLoading:n,currentUserId:o,...r}=e;delete r.password,i.Z.set({userId:o,key:s,value:r})}else{const{currentUserId:t,...n}=e;i.Z.set({userId:t,key:s,value:n})}}(e)}constructor(){super(),this.isOnboarding=new o.Z((()=>this.state.isOnboarding),{debugName:"isOnboarding"});const e={isOnboarding:!1,isLoading:!1,currentUserId:void 0};super.setState(e)}}const c=new l},77282:(e,t,n)=>{n.d(t,{Z:()=>f});var o=n(16691),r=n(11799),i=n(82798),a=(n(30541),n(21703),n(57658),n(41432)),s=n(33147),l=n(72126),c=n(54843);class d extends s.Z{constructor(e){super(),this.blocks=void 0,this.liveBlocks=void 0,this.rootBlock=void 0,this.detachedRootBlocks=void 0,this.blocks=new Map,this.liveBlocks=new Map,this.rootBlock=this.createBlock(e,"page"),this.detachedRootBlocks=new Map}hasBlock(e){return this.blocks.has(e)}getBlock(e){return(0,i.TO)(this.blocks.get(e))}createBlock(e,t){(0,i.T)(!this.hasBlock(e.id));const n=new u({blockStore:e,tracker:this,reference:t,onCreated:e=>{this.blocks.set(e.getId(),e)}});return n.hasLiveReference()&&this.addLiveBlock(n),n}removeBlock(e){(0,i.T)(this.hasBlock(e)),(0,i.T)(!this.liveBlocks.has(e),"Should not be possible to remove a live block."),this.blocks.delete(e)}getLiveBlocks(){return[...this.liveBlocks.values()]}addLiveBlock(e){(0,i.T)(!this.liveBlocks.has(e.getId())),this.liveBlocks.set(e.getId(),e),this.emit({type:"add_block",blockStore:e.blockStore})}removeLiveBlock(e){this.liveBlocks.delete(e.getId()),this.emit({type:"remove_block",blockId:e.getId()})}destroy(){for(const e of this.blocks.values())e.destroy();this.blocks.clear(),this.liveBlocks.clear(),this.detachedRootBlocks.clear()}getClosestPageAndTransclusionReferenceAncestorIds(e){const t=this.liveBlocks.get(e);return t?t.getClosestPageAndTransclusionReferenceAncestors().map((e=>e.getId())):[]}getPathToBlock(e){const t=this.liveBlocks.get(e);if(!t)return;const n=[];let o=t;for(;o;){n.unshift(o.getId());const e=o.liveReferences.values().next().value;if("page"===e)return n;o=e}throw new Error("Block should have a page ancestor")}}class u{constructor(e){this.tracker=void 0,this.blockStore=void 0,this.liveReferences=void 0,this.detachedReferences=void 0,this.childBlocks=void 0,this.childBlocksList=void 0,this.contentStoreListener=void 0;const{blockStore:t,tracker:n,reference:o,onCreated:r}=e;this.tracker=n,this.blockStore=t,this.liveReferences=new Set,this.detachedReferences=new Set,"page"===o||o.hasLiveReference()?this.liveReferences.add(o):this.detachedReferences.add(o),this.childBlocks=new Map,this.childBlocksList=[],r(this),this.contentStoreListener=()=>this.handleContentStoreChange(),this.blockStore.getKeyStore("type").addListener(this.contentStoreListener),this.blockStore.getContentStore().addListener(this.contentStoreListener),this.blockStore.getFormatStore().getKeyStore("transclusion_reference_pointer").addListener(this.contentStoreListener),this.handleContentStoreChange()}handleContentStoreChange(){const e=[...this.childBlocks.keys()],t=new Map,n=this.blockStore.getType();if(this.liveReferences.has("page")||n&&!(0,a.S9)(n))for(const i of(0,c.y)(this.blockStore))t.set(i.id,i);const o=[...t.keys()],r=l.e5(o,e),s=l.e5(e,o);for(const a of r)if(this.tracker.hasBlock(a)){const e=this.tracker.getBlock(a);e.addReference(this),this.childBlocks.set(a,e)}else{const e=this.tracker.createBlock((0,i.TO)(t.get(a)),this);this.childBlocks.set(a,e)}for(const a of s){const e=(0,i.TO)(this.childBlocks.get(a));this.childBlocks.delete(a),e.removeReference(this)}this.childBlocksList=[...t.keys()].map((e=>(0,i.TO)(this.childBlocks.get(e))))}getId(){return this.blockStore.id}hasLiveReference(){return this.liveReferences.size>0}addReference(e){e.hasLiveReference()?this.addLiveReference(e):this.addDetachedReference(e)}addLiveReference(e){if((0,i.T)(!this.liveReferences.has(e)),this.liveReferences.add(e),1===this.liveReferences.size){this.tracker.addLiveBlock(this);for(const e of this.childBlocks.values())e.updateReference(this)}}addDetachedReference(e){this.detachedReferences.add(e)}removeReference(e){e.hasLiveReference()?this.removeLiveReference(e):this.removeDetachedReference(e)}removeLiveReference(e){if(this.liveReferences.delete(e),this.detachedReferences.add("detached"),this.tracker.detachedRootBlocks.set(this.getId(),this),0===this.liveReferences.size){this.tracker.removeLiveBlock(this);for(const e of this.childBlocks.values())e.updateReference(this)}return this}removeDetachedReference(e){if(this.detachedReferences.delete(e),0===this.liveReferences.size&&0===this.detachedReferences.size){for(const[e,t]of this.childBlocks.entries())this.childBlocks.delete(e),t.removeReference(this);this.tracker.removeBlock(this.getId()),this.destroy()}}updateReference(e){const t=this.hasLiveReference();this.liveReferences.has(e)&&!e.hasLiveReference()?(this.liveReferences.delete(e),this.detachedReferences.add(e)):this.detachedReferences.has(e)&&e.hasLiveReference()&&(this.liveReferences.add(e),this.detachedReferences.delete(e));const n=this.hasLiveReference();if(t!==n){n?this.tracker.addLiveBlock(this):this.tracker.removeLiveBlock(this);for(const e of this.childBlocks.values())e.updateReference(this)}return this}getClosestPageAndTransclusionReferenceAncestors(){if(0===this.liveReferences.size)return[];if(this===this.tracker.rootBlock)return[this];const e=new Set,t=new Set,n=[this];for(;n.length>0;){const o=(0,i.TO)(n.shift());if(t.has(o))continue;const r=o.liveReferences;for(const t of r)"page"===t?e.add(o):"transclusion_reference"===t.blockStore.getType()?e.add(t):n.push(t);t.add(o)}return(0,i.T)(e.size>0),[...e]}destroy(){this.contentStoreListener&&(this.blockStore.getKeyStore("type").removeListener(this.contentStoreListener),this.blockStore.getContentStore().removeListener(this.contentStoreListener),this.blockStore.getFormatStore().getKeyStore("transclusion_reference_pointer").removeListener(this.contentStoreListener),this.contentStoreListener=void 0)}}var p=n(97880);class m{constructor(e){this.blockTextInstanceMap=void 0,this.textInstanceBlockMap=void 0,this.blockTextClocksListenerMap=void 0,this.pageBlockTracker=void 0,this.pageBlockTrackerListener=void 0,this.blockTextInstanceMap=new Map,this.textInstanceBlockMap=new Map,this.blockTextClocksListenerMap=new Map,this.pageBlockTracker=e,this.pageBlockTrackerListener=e=>this.handlePageEvent(e),this.pageBlockTracker.addListener(this.pageBlockTrackerListener);for(const{blockStore:t}of e.getLiveBlocks())this.addBlock(t)}handlePageEvent(e){const t=e.type;switch(t){case"add_block":this.addBlock(e.blockStore);break;case"remove_block":this.removeBlock(e.blockId);break;default:(0,p.t1)(t)}}addBlock(e){const t=e.id;if(this.blockTextClocksListenerMap.has(t))return;const n=e=>{this.handleTextClocksChange(t,e.getValue())};e.getSerializedTextClocksStore().addListener(n),this.blockTextClocksListenerMap.set(t,{blockStore:e,textClocksListener:n});const o=e.getSerializedTextClocksStore().getValue();this.handleTextClocksChange(t,o)}removeBlock(e){this.removeMappingForBlock(e);const{blockStore:t,textClocksListener:n}=(0,i.TO)(this.blockTextClocksListenerMap.get(e));t.getSerializedTextClocksStore().removeListener(n),this.blockTextClocksListenerMap.delete(e)}handleTextClocksChange(e,t){this.removeMappingForBlock(e);const n=t?Object.keys(t):[];for(const o of n)this.addBlockTextInstanceMapping(e,o)}removeMappingForBlock(e){const t=this.blockTextInstanceMap.get(e);if(t)for(const n of t)this.removeBlockTextInstanceMapping(e,n)}addBlockTextInstanceMapping(e,t){const n=this.blockTextInstanceMap.get(e)??new Set;n.add(t),this.blockTextInstanceMap.set(e,n);const o=this.textInstanceBlockMap.get(t)??new Set;o.add(e),this.textInstanceBlockMap.set(t,o)}removeBlockTextInstanceMapping(e,t){const n=(0,i.TO)(this.blockTextInstanceMap.get(e));n.delete(t),0===n.size&&this.blockTextInstanceMap.delete(e);const o=(0,i.TO)(this.textInstanceBlockMap.get(t));o.delete(e),0===o.size&&this.textInstanceBlockMap.delete(t)}getTextInstanceIdsForBlock(e){return this.blockTextInstanceMap.has(e)?[...(0,i.TO)(this.blockTextInstanceMap.get(e))]:[]}getBlockIdsForTextInstance(e){return this.textInstanceBlockMap.has(e)?[...(0,i.TO)(this.textInstanceBlockMap.get(e))]:[]}getBlockIdForTextInstanceItemId(e,t,n){const o=this.getBlockIdsForTextInstance(e);for(const r of o){const o=(0,i.TO)(this.blockTextClocksListenerMap.get(r)).blockStore;if((0,i.TO)(o.getTextSliceTree()).findTextSliceTreeContainingItemWithId(e,t,n))return o.id}}destroy(){for(const e of this.blockTextClocksListenerMap.keys())this.removeBlock(e);this.pageBlockTracker.removeListener(this.pageBlockTrackerListener)}}const f=new class{constructor(){this.pageInfoMap=new r.Z({getKey:e=>(0,o.dn)(e)})}trackPage(e){if(this.pageInfoMap.has(e.pointer))return void(0,i.TO)(this.pageInfoMap.get(e.pointer)).pageStores.add(e);const t=new d(e),n=e.useCrdt()?new m(t):void 0,o=new Set([e]);this.pageInfoMap.set(e.pointer,{pageBlockTracker:t,pageTextInstanceTracker:n,pageStores:o})}untrackPage(e){const t=e.pointer,n=(0,i.TO)(this.pageInfoMap.get(t));var o;(n.pageStores.delete(e),0===n.pageStores.size)&&(n.pageBlockTracker.destroy(),null===(o=n.pageTextInstanceTracker)||void 0===o||o.destroy(),this.pageInfoMap.delete(t))}clear(){for(const[t,n]of this.pageInfoMap){var e;n.pageBlockTracker.destroy(),null===(e=n.pageTextInstanceTracker)||void 0===e||e.destroy(),this.pageInfoMap.delete(t)}}getPageStoreForBlockStore(e){for(const[t,n]of this.pageInfoMap)for(const o of n.pageStores)if(o.uiLocation.contains(e.uiLocation))return o;for(const[t,n]of this.pageInfoMap)for(const o of n.pageStores){const t=this.pageInfoMap.get(o.pointer);if(null!=t&&t.pageBlockTracker&&t.pageBlockTracker.hasBlock(e.pointer.id))return o}}getPageBlockTrackerForPage(e){var t;return null===(t=this.pageInfoMap.get(e))||void 0===t?void 0:t.pageBlockTracker}getPageTextInstanceTrackerForPage(e){var t;return null===(t=this.pageInfoMap.get(e))||void 0===t?void 0:t.pageTextInstanceTracker}}},54843:(e,t,n)=>{n.d(t,{y:()=>r});var o=n(97880);function r(e){const t=e.getType();if(!t)return[];const n=e.getRenderableContentStores();if(n.length>0)return n;switch(t){case"transclusion_reference":const n=e.getTransclusionReferenceTargetStore();return n?[n]:[];case"text":case"page":case"personal_home_page":case"bulleted_list":case"numbered_list":case"toggle":case"quote":case"factory":case"button":case"to_do":case"column_list":case"column":case"embed":case"framer":case"tweet":case"gist":case"drive":case"audio":case"maps":case"invision":case"mixpanel":case"image":case"video":case"file":case"bookmark":case"equation":case"code":case"header":case"sub_header":case"sub_sub_header":case"collection_view":case"collection_view_page":case"breadcrumb":case"copy_indicator":case"divider":case"link_to_page":case"link_to_collection":case"figma":case"loom":case"typeform":case"codepen":case"pdf":case"callout":case"table_of_contents":case"whimsical":case"miro":case"abstract":case"sketch":case"excalidraw":case"replit":case"alias":case"transclusion_container":case"external_object_instance":case"table":case"table_row":case"tab":case"external_object_instance_page":case"hex":case"deepnote":case"ai_block":case"drawing":return[];default:(0,o.t1)(t)}}},18245:(e,t,n)=>{n.r(t),n.d(t,{NotionPerformanceClass_TEST_ONLY:()=>_,default:()=>y});n(57658);var o=n(1302),r=n(5809),i=n(68626),a=(n(72126),n(12139)),s=n(97880),l=n(97978),c=n(53410),d=n(94134),u=n(85844),p=n(50112),m=n(77897),f=n(77080);const g=Object.entries(p.N);function h(e,t,n){if(!("memory"in(window.performance||{})))return;const o=Math.random();g.forEach((r=>{let[i,a]=r;if(!(i in window.performance.memory))return;const s=f.default.getConfigKey("event_trail_events",a),c=s&&"sampleRatesByMetric"in s&&"object"==typeof s.sampleRatesByMetric&&s.sampleRatesByMetric[t]||0;(0,m.aw)(c,(()=>o))&&function(e,t){const{type:n,bytes:o,data:r}=t;l.j(e,n,{bytes:o,...r})}(e,{type:a,bytes:window.performance.memory[i],data:{collected_during:t,...n}})}))}const v=new Set(["navigation_page_render","navigation_database_render","typing_lag"]);class b{constructor(){this.startTimesByMetricName={},this.lastVisibilityChange=0,u.Z.addListener((()=>{this.lastVisibilityChange=performance.now()}))}mark(e){var t;let n;if(Boolean(null===(t=performance)||void 0===t?void 0:t.mark)){const t=performance.mark(e);if(t)n=t.startTime;else{const t=performance.getEntriesByName(e);n=t[t.length-1].startTime}}else n=performance.now();const o="sentry"===d.getProfilingToolForSession()&&v.has(e)?a.Yr({name:e}):void 0;return this.startTimesByMetricName[e]={startTime:n,sentryTransaction:o},{metricName:e,startTime:n,sentryTransaction:o}}markAllOf(e){if(0===e.length)return;const t=performance.now();for(const n of e)this.startTimesByMetricName[n]={startTime:t,sentryTransaction:"sentry"===d.getProfilingToolForSession()&&v.has(n)?a.Yr({name:n}):void 0}}markEitherOf(e){if(0===e.length)return;const t=performance.now();for(const n of e)this.startTimesByMetricName[n]={startTime:t,sentryTransaction:"sentry"===d.getProfilingToolForSession()&&v.has(n)?a.Yr({name:n}):void 0,allMetricNamesMarked:e}}measure(e,t){this._measure(e,t)}measureAfterNextFlush(e,t){o.default.afterNextFlush((()=>{const n="getData"in t?t.getData():void 0;"getData"in t&&void 0===n||this._measure(e,{...t,data:n})}))}measureFromAppStart(e,t){const n="object"==typeof e?e.metricName:e,o=r.$();"number"==typeof o&&this.measure({metricName:n,startTime:o,..."object"==typeof e?{endTime:e.endTime}:{}},t)}measureFromAppStartAfterNextFlush(e,t){const n="object"==typeof e?e.metricName:e;o.default.afterNextFlush((()=>{const o="getData"in t?t.getData():void 0;if("getData"in t&&void 0===o)return;const i=r.$();"number"==typeof i&&this._measure({metricName:n,startTime:i,..."object"==typeof e?{endTime:e.endTime}:{}},{...t,data:o})}))}_measure(e,t){if("object"==typeof e){const{startTime:n,endTime:o,metricName:r,sentryTransaction:i}=e;this.startTimesByMetricName[r]=void 0;const a=this.getDuration({metricName:r,startTime:n,endTime:o});i&&i.finish(o),this.trackDuration({metricName:r,startTime:n,duration:a,options:t})}else if("string"==typeof e){const n=e,o=this.startTimesByMetricName[n];if(!o)return;const{startTime:r,allMetricNamesMarked:i,sentryTransaction:a}=o;if(i)for(const e of i)this.startTimesByMetricName[e]=void 0;else this.startTimesByMetricName[n]=void 0;const s=this.getDuration({metricName:n,startTime:r});a&&a.finish(),this.trackDuration({metricName:n,startTime:r,duration:s,options:t})}else(0,s.t1)(e)}getDuration(e){const{metricName:t,startTime:n,endTime:o}=e;try{return performance.measure(t,{start:n,..."number"==typeof o?{end:o}:{}}).duration}catch(r){return"number"==typeof o?o-n:performance.now()-n}}async trackDuration(e){const{metricName:t,duration:n,startTime:o,options:r}=e,{environment:a,data:s,preboot:d}=r;if(!document.hidden&&!("number"==typeof this.lastVisibilityChange&&o<this.lastVisibilityChange)&&await l.TA(t,r)){if(a.device.isElectron&&c.C&&c.C.windowIsVisible){if(!(await c.C.windowIsVisible()))return}"navigation_database_render"===t&&n>=6e4&&i.log({level:"info",from:"collections",type:"navigationPageRenderSlow",error:{message:`Got a slow navigation page render that took: ${n/1e3}s`},data:{miscDataToConvertToString:s}}),l.j(a,t,{time:n,...s},{preboot:d}),h(a,t,s)}}}const y=new b;class _ extends b{}},30806:(e,t,n)=>{n.d(t,{$X:()=>i,Ai:()=>g,Aq:()=>d,Ay:()=>c,BX:()=>l,PQ:()=>p,SJ:()=>u,cY:()=>s,g8:()=>m,gF:()=>h,lj:()=>a,uD:()=>f});var o=n(97978),r=n(24646);function i(e){let{environment:t,from:n}=e;(0,o.j)(t,"open_home",{from:n,...(0,r.UF)({environment:t})})}function a(e){let{environment:t}=e;(0,o.j)(t,"open_home_more_menu",{})}function s(e){const{environment:t,show:n,feature:r,from:i}=e;(0,o.j)(t,"toggle_home_feature",{show:n,feature:r,from:i})}function l(e){let{environment:t,oldValue:n,newValue:r,from:i}=e;(0,o.j)(t,"change_start_page",{old_value:n,new_value:r,from:i})}function c(e){let{environment:t,index:n,teamId:r}=e;(0,o.j)(t,"change_home_trending_source",{source_type:r?"team":"space",selected_index:n,selected_team_id:r})}function d(e){let{environment:t,from:n}=e;(0,o.j)(t,"click_empty_my_tasks",{from:n})}function u(e){let{environment:t,from:n}=e;(0,o.j)(t,"close_task_migration_modal",{from:n})}function p(e,t){(0,o.j)(e,"open_home_tip",t)}function m(e,t){(0,o.j)(e,"check_home_tip",t)}function f(e,t){(0,o.j)(e,"show_completed_home_tips",t)}function g(e,t){(0,o.j)(e,"home_tips_modal_error",t)}function h(e){let{environment:t}=e;(0,o.j)(t,"visit_home_help_page")}},14654:(e,t,n)=>{n.d(t,{ib:()=>s,t3:()=>l});var o=n(15145),r=n(97880),i=n(80444),a=n(94841);function s(e){let{blockOrCollectionId:t}=e;const n=l({blockOrCollectionId:t});switch(n){case"home":return o.tY.PersonalHomePage;case"home_tile_recents":return o.tY.PersonalHomeTileRecents;case"home_tile_trending":return o.tY.PersonalHomeTileTrending;case"home_tile_tips":return o.tY.PersonalHomeTileTips;case"home_tile_tasks":return o.tY.PersonalHomeTileTasks;case"home_tasks":return o.tY.PersonalHomePageTasks;case"home_tile_similar_users":return o.tY.PersonalHomeTileSimilarUsers;case"home_unknown":return o.tY.PersonalHomeUnknown;case"home_tile_notes":return o.tY.PersonalHomeNotes;case void 0:return;default:(0,r.t1)(n)}}function l(e){let{blockOrCollectionId:t}=e;const n=(0,a.G)({blockOrCollectionId:t}),{mainEditorCurrentBlockStore:o}=i.default.state;if(n)switch(n){case"main":return"home";case"myTasksAssignedToMeCollectionView":case"myTasks":return(0,a.WE)(o)?"home_tile_tasks":"home_tasks";case"trendingCollectionView":return"home_tile_trending";case"similarUsersCollectionView":return"home_tile_similar_users";case"trending":case"trendingCollection":case"myTasks":case"similarUsers":case"similarUsersCollection":return"home_unknown";default:(0,r.t1)(n)}}},94841:(e,t,n)=>{n.d(t,{Al:()=>S,Ep:()=>w,G:()=>b,J2:()=>k,Kj:()=>y,Vj:()=>I,WE:()=>_,aE:()=>x,pr:()=>C});var o=n(59308),r=n(60310),i=n(72126),a=n(21202),s=n(6287),l=n(13493),c=n(97880),d=(n(95477),n(18514)),u=n(95697),p=n(80444),m=n(77080),f=n(88923),g=n(79797);const h=(0,i.HP)(((e,t)=>r.hH({userId:e,spaceId:t})),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return JSON.stringify(t)})),v=(0,i.HP)(((e,t,n)=>{if(!e||!t||!n)return;const[o]=(0,c.qP)(h(t,n)).find((t=>{let[n,o]=t;return o===e}))??[];return o}),(function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return JSON.stringify(t)}));function b(e){var t,n;let{blockOrCollectionId:o}=e;const r=null===(t=p.default.state.currentUserStore)||void 0===t?void 0:t.id,i=null===(n=p.default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(r&&i&&o)return v(o,r,i)}function y(e){return(0,c.$K)(b({blockOrCollectionId:e}))}function _(e){return!!e&&"main"===b({blockOrCollectionId:e.id})}function S(e){const t=null==e?void 0:e.getParentId(),n=null==e?void 0:e.getSpaceId();if(!t||!n||!e)return;const o=h(t,n).main,r=e.getSpaceStore();return o&&r?g.G.createChildStore(r,{table:a.iU,id:o,spaceId:r.id}):void 0}function w(e){var t,n;const o=null===(t=p.default.state.currentUserStore)||void 0===t?void 0:t.id,r=null===(n=p.default.state.currentSpaceStore)||void 0===n?void 0:n.id;if(o&&r)return h(o,r)[e]}function k(e){const t=p.default.state.currentSpaceStore;if(!t)return;const n=t.id;switch(e){case"main":case"myTasks":case"trending":case"similarUsers":const o=w(e);return o?g.G.createChildStore(t,{table:a.iU,id:o,spaceId:n}):void 0;case"myTasksAssignedToMeCollectionView":case"similarUsersCollectionView":case"trendingCollectionView":const r=w(e);return r?g.Xr.createChildStore(t,{table:l.n,id:r,spaceId:n}):void 0;case"trendingCollection":case"similarUsersCollection":const i=w(e);return i?g.NW.createChildStore(t,{table:s.v,id:i,spaceId:n}):void 0;default:(0,c.t1)(e)}}function I(e,t){let n;switch(e){case"table":n=t.table_properties;break;case"board":n=t.board_properties;break;case"calendar":n=t.calendar_properties;break;case"list":n=t.list_properties;break;case"gallery":n=t.gallery_properties;break;case"timeline":n=t.timeline_properties}return{list_properties:(0,u.QI)("dev_only")?n:[{visible:!0,property:"title"},{width:200,visible:!0,property:o.Es.DueDate},{width:200,visible:!0,property:o.Es.Status,statusShowAs:"select"},{width:200,visible:!0,property:o.Es.Location},{visible:!1,property:o.Es.Assign,width:200},{visible:!1,property:o.Es.Reporter,width:200},{visible:!1,property:o.Es.CreatedTime,width:200},{visible:!1,property:o.Es.LastEditedTime,width:200},{visible:!1,property:o.Es.LastEditedBy,width:200}],collection_group_by:void 0,collection_peek_mode:f.PeekModeCenter,inline_collection_first_load_limit:{type:"load_limit",limit:20}}}function C(e){if(!(0,u.QI)())return!1;if(e.device.isMobile)return!1;const{currentUserSettingsStore:t}=p.default.state;if(!t||!t.isReady())return!1;const n=t.getSettings();if(!n)return!1;const o=new Date("Feb 20 2024 08:00:00 GMT+0000").getTime();return!(n.signup_time&&n.signup_time>o)&&!0!==n.seen_personal_home}function x(){return m.default.checkGate("sidebar_home_ga_gate")?(0,d.UY)("guides.taskDatabases"):"https://www.notion.so/notion/Sidebar-Home-Beta-Program-3819c5f8551141c3952f1031ab4f9034"}},58299:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(76796),r=n(78030);class i extends o.B{findBlockPropertyValue(e,t){return this.find((n=>n.getProps().store===e&&n.getProps().property===t&&n.getProps().format!==r.C.PropertyModule))}findBlockPropertyValueByBlockId(e,t){return this.find((n=>n.getProps().store.id===e&&n.getProps().property===t&&n.getProps().format!==r.C.PropertyModule))}getRect(e,t){const n=this.findBlockPropertyValue(e,t);if(n){const e=n.getNode();if(e&&e instanceof Element)return e.getBoundingClientRect()}}}const a=new i},58202:(e,t,n)=>{n.d(t,{R:()=>s});var o=n(35431),r=n(92595),i=n(53223);class a extends o.Z{findBlockFromStore(e){return this.find((t=>t.getBlockStore()===e))}findAllBlocksFromStore(e){return this.filter((t=>t.getBlockStore()===e))}findBlockFromStoreWithMethod(e,t){return this.find((n=>n.getBlockStore()===e&&"function"==typeof n[t]))}findBlockFromId(e){return this.find((t=>{const n=t.getBlockStore();return n&&n.id===e}))}findNodeFromStore(e){const t=this.findBlockFromStore(e);if(t)return t.getNode()}getRect(e){const t=this.findNodeFromStore(e);if(t&&t instanceof Element)return t.getBoundingClientRect()}findCollectionViewBlockFromStore(e){return this.find((t=>t.getBlockStore()===e&&(0,i.wA)(t)))}findCollectionViewBlockFromId(e){return this.find((t=>{var n;return Boolean((null===(n=t.getBlockStore())||void 0===n?void 0:n.id)===e&&(0,i.wA)(t))}))}}const s=new a;(0,r.exposeDebugValue)("GlobalBlockRegistry",s)},89574:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(35431);class r extends o.Z{}const i=new r},46351:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(35431);class r extends o.Z{}const i=new r},47372:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(35431);class r extends o.Z{}const i=new r},27406:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(35431),r=n(92595);class i extends o.Z{constructor(){super(...arguments),this.isDropTargetForKey=(e,t)=>e.props.dropTargetKey===t}findDropTargetFromKey(e){return this.find((t=>this.isDropTargetForKey(t,e)))}findDropTargetsFromKey(e){return this.filter((t=>this.isDropTargetForKey(t,e)))}}const a=new i;(0,r.exposeDebugValue)("GlobalDropTargetRegistry",a);const s=a},28685:(e,t,n)=>{n.d(t,{E:()=>i});var o=n(35431);class r extends o.Z{findEditableWithinSelectable(e){return this.find((t=>t.getContextClosestSelectable()===e))}findEditableWithStore(e){return this.find((t=>t.props.store===e))}findNodeFromStore(e){const t=this.findEditableWithStore(e);if(t)return t.getNode()}findStoreFromNode(e){const t=this.find((t=>t.getNode()===e));if(t)return t.props.store}}const i=new r},3994:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(76796);class r extends o.B{shouldPreventMobileAutoScroll(e){const t=this.find((t=>t.capture&&!(t.allowMobileAutoScroll&&e.device.isMobile)));return Boolean(t)}}const i=new r},75987:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(35431);class r extends o.Z{isInlineAutocompleteOpen(){const e=this.find((e=>e.props.isOpen));return Boolean(e)}}const i=new r},81844:(e,t,n)=>{n.d(t,{Z:()=>i});n(57658);var o=n(35431);class r extends o.Z{findOutlinerItemFromStore(e){if(e)return this.find((t=>t.store===e))}findOutlinerItemsFromId(e){const t=[];return this.forEach((n=>{n.store.id===e&&t.push(n)})),t}}const i=new r},49427:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(35431),r=n(85644),i=n(82136);class a extends o.Z{isBlockInFrame(e){const t=e.getRecordStoreUIRoot();return Boolean(this.find((e=>e.props.context===i.S.Frame&&e.props.store===t)))}isBlockInTemplate(e){const t=e.getRecordStoreUIRoot();return Boolean(this.find((e=>e.props.context===i.S.InAppTemplatePreview&&e.props.store===t)))}isBlockInPageSnapshot(e){const t=e.getRecordStoreUIRoot();return Boolean(this.find((e=>e.props.context===i.S.InPageSnapShot&&e.props.store===t)))}isBlockInWiki(e){const t=e.getRecordStoreUIRoot();return Boolean(this.find((e=>(0,r.A)(e.props.store)&&e.props.store===t)))}}const s=new a},64815:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(35431);class r extends o.Z{}const i=new r},16339:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(35431);class r extends o.Z{}const i=new r},95802:(e,t,n)=>{n.d(t,{C:()=>c});var o=n(35431),r=n(92595),i=n(72126),a=n(28685),s=n(27724);class l extends o.Z{getMembersByDOMOrder(e){let{filter:t}=e;return super.getMembersByDOMOrder({filter:e=>!e.props.isHoverMenu&&t(e)})}findSelectableFromStore(e){return this.find((t=>t.props.store===e))}findScrollToSelectableFromStore(e){return this.find((t=>t.props.store===e&&t.props.canSelect&&!t.props.disableScrollToReveal&&t.getContextSelectableContainer()===s.default.getCurrentDefaultContainer()))}findScrollToSelectablesFromIds(e){return this.filter((t=>e.includes(t.props.store.id)&&t.props.canSelect&&!t.props.disableScrollToReveal&&t.getContextSelectableContainer()===s.default.getCurrentDefaultContainer()))}findSelectablesFromStore(e){return this.filter((t=>t.props.store===e))}findNodeFromStore(e){const t=this.findSelectableFromStore(e);if(t)return t.getNode()}getRectFromStore(e){const t=this.findNodeFromStore(e);if(t&&t instanceof Element)return t.getBoundingClientRect()}findEditableStoreWithin(e){const t=this.findSelectableFromStore(e);if(t){const e=a.E.findEditableWithinSelectable(t);if(e)return e.props.store}}findSelectablesFromIds(e){const t=s.default.getCurrentDefaultContainer(),n=this.getMembersByDOMOrder({filter:()=>!0});return i.oA(e.map((e=>n.find((n=>{const o=n.props.store,r=n.getContextSelectableContainer();return Boolean(o&&o.id===e&&r===t)})))))}findAllSelectablesFromIds(e){const t=s.default.getCurrentDefaultContainer(),n=this.getMembersByDOMOrder({filter:()=>!0});return i.xH(e.map((e=>n.filter((n=>{const o=n.props.store,r=n.getContextSelectableContainer();return Boolean(o&&o.id===e&&r===t)})))))}findNodeFromBlockId(e){var t;const n=this.findSelectablesFromIds([e]);return null==n||null===(t=n[0])||void 0===t?void 0:t.getNode()}findSelectableFromChildNode(e){const t=this.getMembersByDOMOrder({filter:t=>{var n;return null===(n=t.getNode())||void 0===n?void 0:n.contains(e)}});return t[t.length-1]}}const c=new l;(0,r.exposeDebugValue)("GlobalSelectableRegistry",c)},75822:(e,t,n)=>{n.d(t,{E5:()=>r,rE:()=>i,vp:()=>o});const o=300,r=75,i=225},43759:(e,t,n)=>{n.d(t,{Q:()=>i,U:()=>c});var o=n(72126),r=n(77907);const i=3,a=new Set(["a","an","and","are","as","at","be","but","by","for","if","in","is","it","of","on","or","that","the","to","was","will","with"]),s=(e,t,n)=>e.length>=i,l=(e,t,n)=>e.length>=5&&.2;async function c(){const{default:e}=await r.deps.minisearch.loader(),t=new e({fields:["text","id","inits"],storeFields:["block"],searchOptions:{prefix:s,fuzzy:l},tokenize:(e,t)=>e.split(/\s/g),processTerm:(e,t)=>{const n=e.toLowerCase();if(!a.has(e))switch(t){case"text":{const t=n.split(/[^\w]+/g).filter((t=>t.length>i&&!a.has(e)));return(0,o.jj)([n,...t])}case"inits":return[...Array(e.length).keys()].slice(0,e.length-i+1).map(((e,t)=>n.slice(t)));default:return n}}});return{index:t,getAllBlocks:()=>t.search(e.wildcard)}}},96820:(e,t,n)=>{n.d(t,{S:()=>B});n(57658);var o=n(41432),r=n(80951),i=n(59753),a=n(21202),s=n(6287),l=n(70203),c=n(97880);const d={indexTimeMs:!0,title:!0,children_contents:!0,children_ids:!0,children_permissions:!0,children_fractional_index:!0,children_types:!0,alive:!0,created_by_id:!0,created_by_table:!0,created_time:!0,format:!0,id:!0,is_template:!0,last_edited_by_id:!0,last_edited_time:!0,parent_table:!0,permissions:!0,space_id:!0,team_id:!0,team_name:!0,team_is_archived:!0,auto_increment_id:!0,type:!0,version:!0,ancestors:!0,audience:!0,db_schema_source_partition:!0,depth:!0,is_path_alive:!0,is_top_level_page:!0,parent_id:!0,path_text:!0,search_permissions:!0,inherited_permissions:!0,parent_page_id:!0,collection_id:!0,parent_collection_id:!0,page_views:!0,unique_page_views:!0,collection_properties:!0,children_last_edited_times:!0,mentions_dictionary:!0},{audience:u,...p}=((0,c.Yd)(d),d);(0,c.Yd)(p);function m(e){const{getRecordValue:t,blockValue:n}=e;let c="";const d={user:new Map},u=i.kk.fromBlock(n),p=i.om.fromGetRecordValueFn(t);if(u.isCollectionView()){const e=function(e){const{getRecordModel:t,model:n}=e,o=n.getRenderFormatPointer(t);if(!o)return;const i=t(o);if(!i)return;if(i.table===a.iU)return(0,r.wS)(i,"title")||[];if(i.table===s.v)return i.getNormalizedName()}({model:u,getRecordModel:p});e&&e.length>0&&(c=l.Qh7(e,p,d).text)}else if(u.isType("file")){c=`${l.Qh7(u.getProperty("title"),p,d).text} ${l.Qh7(u.getProperty("caption"),p,d).text}`}else if(u.isType("bookmark")){c=`${l.Qh7(u.getProperty("title"),p,d).text} ${l.Qh7(u.getProperty("description"),p,d).text} ${l.Qh7(u.getProperty("caption"),p,d).text}`}else if(u.isType(o.Ok)){const e=u.getProperty("caption");c=l.Qh7(e,p,d).text}else if(u.isType(o.Ti.tableRow)){const e=function(e){const{blockModel:t,getRecordModel:n}=e,o=n({table:a.iU,id:t.getParentId(),spaceId:t.getSpaceId()});return null==o?void 0:o.getFormatValue("table_block_column_order")}({blockModel:u,getRecordModel:p});if(e){c=e.map((e=>l.Qh7(u.getProperty(e),p,d).text)).join(" ")}}else{const e=(0,r.wS)(n,"title");c=l.Qh7(e,p,d).text}return{text:c.trim()||void 0,mentions:d}}var f=n(72126),g=n(58203),h=n(63306),v=n(73360),b=n(74446),y=n(45953),_=n(33361),S=n(28020),w=n(45950),k=n(98165),I=n(48779),C=n(95697),x=n(77080),T=n(46735),M=n(69327),P=n(79797),A=n(42198),R=n(43759);const D=432e5,E=1e3;async function B(e){const{environment:t,currentSpaceStore:n,currentSpaceViewStore:r,excludeCurrentPage:s}=e,{id:l}=n,c=new Map,d=new Set;function u(e,t){var n;c.has(e)?null===(n=c.get(e))||void 0===n||n.add(t):c.set(e,new Set([t]))}const p=new Map,B=(new Date).getTime();if(r)for(const o of r.getBookmarkedPageIds())u(o,"bookmarkedPage");const F=M.Z.get(l);F&&F.forEach(((e,t)=>{let{pageId:n,visitedAt:o}=e;u(n,"recentVisit"),d.add(n),p.set(n,{index:t,timeSinceLastViewed:B-o})}));const O=(0,I.ns)(t,n);for(const o of O)u(o,"spacePage");const Z=(0,C.xo)();for(const o of Z)u(o,"teamPage");const V=t.currentUser.id;if(r){for(const{id:n}of(0,I.KA)(t,r))u(n,"sharedPage");const e=B-D;t.defaultRecordCache.inMemoryRecordCache.forEachRecord(V,(t=>{let{model:r}=t;if(r.table===a.iU&&l===n.id){const{id:t,last_edited_time:n,last_edited_by_id:i,type:a}=r;(0,o.S9)(a)&&i===V&&n&&n>e&&(u(t,"defaultRecordCache"),d.add(t))}}))}const U=T.Z.getVisitedIds(V);for(const o of U)u(o,"frecencyStore"),d.add(o);const N=V?x.default.getEligibleGroup({experimentId:"search-new-local-recall-v2",parameter:"userSignals",defaultGroup:[]})??[]:[],L=A.default.getUserSignals({spaceId:l,userId:V});var j,z,q,H;N.includes("sim_user_visits")&&(null==L||null===(j=L.similarUserRecentPages)||void 0===j||j.pagesMetadata.forEach(((e,t)=>{u(t,"similarUser1dRecentPages"),d.add(t)})));N.includes("popular_pages")&&(null==L||null===(z=L.topPages7dPageView)||void 0===z||z.forEach(((e,t)=>{u(t,"topPages7dPageView"),d.add(t)})));N.includes("user_edits")&&(null==L||null===(q=L.editedPages1d)||void 0===q||q.forEach(((e,t)=>{u(t,"editedPages1d"),d.add(t)})));N.includes("sim_user_edits")&&(null==L||null===(H=L.similarUsersEditedPages1d)||void 0===H||H.forEach(((e,t)=>{u(t,"similarUsersEditedPages1d"),d.add(t)})));if(s){const e=(0,S.np)();e&&c.delete(e.id)}const W=y.PF.create();await(0,_.uf)({recordPointers:Array.from(c.keys()).map((e=>({table:a.iU,id:e}))),recordMap:W,loadRecordModel:e=>(0,w.Ye)({environment:t,pointer:e}),recurFn:e=>f.oA([(0,v.tz)(e)&&e.getParentPointer(),e.table===a.iU&&e.getCollectionPointer()])});const K=b.mF.fromRecordMapWithRole(W),G=i.om.fromGetRecordValueFn(K),$=new Array;for(const[o,i]of c.entries()){const e={table:a.iU,id:o};let t,r;if(d.has(o)?(t=P.t1.createChildStore(n,e),r=t.getModel()):r=G(e),!r)continue;const s=(0,h.Wq)(e,W);if(0===s.length)continue;if(r.getSpaceId()!==n.id)continue;const l=(0,g.$B)(m({blockValue:r,getRecordValue:K}).text);if(!l)continue;if(!i)continue;const c=(0,k.KU)(s);if(c&&Boolean(c.value.archived_by))continue;const u=l.substring(0,E).trim(),f=p.get(o);$.push({blockModel:r,text:u,path:s,source:i,indexInRecentPages:f?f.index:void 0,timeSinceLastViewedMs:f?f.timeSinceLastViewed:void 0,blockStore:t})}const{index:Q,getAllBlocks:Y}=await(0,R.U)(),X=$.map((e=>({id:e.blockModel.id,text:e.text,inits:e.text.split(" ").map((e=>e[0])).join(""),block:e})));return Q.addAll(X),{spaceId:n.id,blocks:Q,getAllBlocks:Y,recordMap:W}}},40134:(e,t,n)=>{n.d(t,{B:()=>r});var o=n(51);function r(e){var t;let{blockId:n,setting:r}=e;const{publicPageData:i}=o.Z.state;if((null==i?void 0:i.pageId)!==n)return;return null===(t=i.securitySettings)||void 0===t?void 0:t[r]}},28578:(e,t,n)=>{n.d(t,{Sw:()=>l,T5:()=>s,XF:()=>i,ZP:()=>d,wV:()=>a});var o=n(49085),r=n(4615);let i=function(e){return e.Share="share",e.Publish="publish",e}({}),a=function(e){return e.MainShareMenu="mainShareMenu",e.Invite="invite",e.Publish="publish",e}({}),s=function(e){return e.Notion="notion",e.Slack="slack",e}({}),l=function(e){return e.Search="search",e.Message="message",e}({});class c extends o.default{getInitialState(){return{sessionId:(0,r.ZP)(),display:a.MainShareMenu,tab:i.Share}}}const d=new c},74948:(e,t,n)=>{n.r(t),n.d(t,{OnlyOneSidebarVisibleWidthThreshold:()=>ee,SidePeekCloseLeftSidebarFrameWidthThreshold:()=>te,bookmarkPage:()=>pe,cancelSidebarInitialRenderLog:()=>Me,close:()=>oe,handleSidebarButtonClick:()=>ie,initialize:()=>Ie,leaveBlocks:()=>ue,newPageMessages:()=>be,open:()=>ne,pinSharedPage:()=>fe,quickAddPage:()=>ve,setExpand:()=>re,setPeekWidth:()=>de,setUpdateExpand:()=>ae,setUpdateSidebarCommentsMode:()=>xe,setUpdateSidebarTab:()=>Ce,setUpdateWidth:()=>ce,setWidth:()=>le,toggleBothSidebars:()=>Te,toggleLeftSidebarByWindowSize:()=>se,unbookmarkPage:()=>me,unpinSharedPage:()=>ge});var o=n(1302),r=n(15145),i=n(23867),a=n(54153),s=n(9291),l=n(952),c=n(66324),d=n(54642),u=n(54564),p=n(98834),m=n(94419),f=n(11302),g=n(17659),h=n(89858),v=n(99553),b=n(9953),y=n(75754),_=n(26999),S=n(8055),w=n(82530),k=n(1742),I=n(37181),C=n(93827),x=n(75770),T=n(58239),M=n(45010),P=n(48779),A=n(18245),R=n(5162),D=n(80444),E=n(8949),B=n(66949),F=n(77080),O=n(3418),Z=n(475),V=n(42330),U=n(45325),N=n(79689),L=n(88923),j=n(24864),z=n(79797),q=n(69784),H=n(82187),W=n(62820),K=n(34583),G=n(24646),$=n(38676),Q=n(97852),Y=n(77999),X=n(36896),J=n(36391);const ee=1024,te=430;function ne(e){let{fromElectron:t}=e;$.sidebarOpenStore.state||q.default.state.isActive||B.Z.isOpen()||U.default.isOpen()||($.sidebarOpenStore.setState(!0),t&&$.sidebarElectronMousePeekStore.setState(!0))}function oe(){!$.sidebarOpenStore.state||Z.Z.state.open||W.Z.state.open||X.Z.state.open||Q.Z.state.open||E.Z.state.isActive||H.Z.state.clonedBlockStore||$.sidebarResizingStore.state.isResizing||!(0,N.c)()||O.Z.state.namedOpenPopups.has("team_more_actions")||O.Z.state.namedOpenPopups.has("teams_heading_actions")||($.sidebarMousePeekXStore.setState(0),$.sidebarOpenStore.setState(!1),$.sidebarElectronMousePeekStore.setState(!1))}function re(e){if((0,R.Y)("supportsNativeHome"))return;"inactive"===Y.default.state.type||e.isExpanded||Y.default.setState({type:"inactive"});const t=A.default.mark("sidebar.toggle_expanded_lag");$.sidebarExpandedStore.setState(e.isExpanded),we(),L.default.setSidebarExpandedStoreState(e.isExpanded),e.isExpanded&&e.environment.WindowSizeStore.state.width<ee&&(0,G.Sx)(e.environment)&&ae({environment:e.environment,isExpanded:!1,from:"close_for_space"}),e.isExpanded&&(0,G.$3)(e.environment)<te&&v.xv(e.environment,"sidebar_expand"),e.isExpanded?c.LM(e.environment):c.Qd(e.environment),A.default.measureAfterNextFlush(t,{environment:e.environment,getData:()=>({is_expanded:e.isExpanded,from:e.from})})}function ie(e,t,n,o){const i=L.default.state.open,{currentTab:a}=J.ZP.state,s=a!==n||a===n&&!(0,G.Sx)(e);J.ZP.setState({...J.ZP.state,currentTab:n}),i?(y._({environment:e,store:t,pageVisitSource:r.tY.Expand}),ae({environment:e,isExpanded:!0,from:o})):ae({environment:e,isExpanded:s,from:o})}function ae(e){var t;const{isExpanded:n,environment:o,from:r}=e;if(n||u.LZ(),n){o.WindowSizeStore.state.width<ee&&(0,G.in)(o)&&re({environment:o,isExpanded:!1,from:`set_update_expand_${e.from}`}),U.default.isOpen()&&g.qQ({open:!1,environment:o});const t=J.ZP.state.currentTab,n={origin:L.default.state.open?"peek_view":"page",from:r};t===J.gY.Comments?c.v$(o,n):t===J.gY.Updates&&c.ph(o,n)}J.ZP.setState({...J.ZP.state,expanded:n,mouseEntered:!!n||J.ZP.state.mouseEntered,openedOnBlockId:L.default.state.open&&L.default.state.target.id||(null===(t=D.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id),canRender:!0}),ke()}function se(e){L.default.state.savedSidebarExpandedStoreState&&!$.sidebarExpandedStore.state&&function(e){if($.sidebarExpandedStore.state||!L.default.state.savedSidebarExpandedStoreState)return;L.default.isSidePeekOpen()&&(0,G.$3)(e)-(0,G.qG)(e)>=te&&$.sidebarExpandedStore.setState(!0)}(e),$.sidebarExpandedStore.state&&function(e){const t=$.sidebarExpandedStore.state&&0===(0,G.Wk)(e),n=t?e.WindowSizeStore.state.width-$.sidebarWidthStore.state-(0,G.ll)(e,!1):(0,G.$3)(e);L.default.isSidePeekOpen()&&L.default.state.savedSidebarExpandedStoreState&&$.sidebarExpandedStore.state&&n<te&&($.sidebarExpandedStore.setState(!1),L.default.setSidebarExpandedStoreState(!0))}(e)}function le(e){$.sidebarWidthStore.setState(e.width),(0,G.$3)(e.environment)<te&&v.xv(e.environment,"sidebar_expand"),we()}function ce(e){J.ZP.setState({...J.ZP.state,width:e.width}),ke()}function de(e){L.default.state.open&&L.default.isSidePeekOpen()&&(L.default.setSidePeekWidth(e.width,e.environment.WindowSizeStore.state.width),function(){const{preferredSidePeekWidth:e}=L.default.state,t={width:e};a.Z.set(Se,t)}(),se(e.environment))}async function ue(e){const{blocks:t,transaction:n,environment:o}=e,{currentSpaceViewStore:r}=D.default.state;if(r)for(const i of t)m.Od({parent:r.getSharedPagesStore(),childToRemove:i,transaction:n});S.CZ({environment:o,blocks:t}),await Promise.all(t.map((e=>d.leaveBlock(o,{block:{id:e.id,spaceId:(0,i.C)(e.pointer.spaceId)}}))))}const pe=function(e){const{store:t,spaceViewStore:n,transaction:o}=e,r=n.getBookmarkedPagesStore(),i=z.G.createChildStore(r,t.pointer);F.default.checkGate("append_favorites")?m.R3({parent:r,append:i,transaction:o}):m.Ce({parent:r,prepend:i,transaction:o})},me=function(e){const{store:t,spaceViewStore:n,transaction:o}=e,r=n.getBookmarkedPagesStore(),i=z.G.createChildStore(r,t.pointer);m.Od({parent:r,childToRemove:i,transaction:o})},fe=function(e){const{store:t,spaceViewStore:n,transaction:o}=e;he(e);const r=n.getSharedPagesStore(),i=z.G.createChildStore(r,t.pointer);m.Ce({parent:r,prepend:i,transaction:o})},ge=function(e){const{store:t,spaceViewStore:n,transaction:o}=e;he(e);const r=n.getSharedPagesStore(),i=z.G.createChildStore(r,t.pointer);m.Od({parent:r,childToRemove:i,transaction:o})};function he(e){const{environment:t,spaceViewStore:n,userSettingsStore:o,transaction:r}=e,i=n.getSpaceId();if(!i||o.hasUserPinnedToOutliner({spaceId:i,type:"shared"}))return;const{visibleSharedPagesStores:a}=(0,P.k0)({environment:t,spaceViewStore:n,userSettingsStore:o}),s=a.map((e=>{let{id:t}=e;return t}));b.sW({store:n,data:{shared_pages:s},transaction:r}),I.Nb({userSettingsStore:o,spaceId:i,type:"shared",transaction:r})}async function ve(e){const{from:t,environment:n,redirect:i}=e,{currentSpaceStore:a,currentSpaceViewStore:s}=D.default.state,c=new k.sA(n,"quickAddPage");if(!(K.M_(n)&&a&&a.canEdit()&&s))return void c.fail("invalid_state");V.ZP.setState({...V.ZP.state,lastPageId:D.default.state.mainEditorCurrentBlockStore?D.default.state.mainEditorCurrentBlockStore.id:void 0});const d=await async function(e){const{newPageTracker:t,quickAddParentOverride:n,environment:o}=e,{currentSpaceStore:r}=D.default.state;if(!r)return void t.fail("invalid_state");const i=n||await(0,T.lX)({spaceStore:r,currentUserId:o.currentUser.id}),a=x.uw(i);if("space-private-pages"===i.type||a.canAdmin()){const e=await w.createAndCommitAsync({environment:o,userAction:"sidebarActions.quickAddPage.directMoveToAdd",waitForServerCommit:!1,perform:async e=>{const n=b.j4({environment:o,type:"page",inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:r.id,tracker:t,useCrdt:!1}),a=await f.Ws({environment:o,targets:[n],value:i,transaction:e});if(a&&"collection"===a.table){const t=a.getDefaultTemplatePageStore();t&&p.ob({title:"template",environment:o,store:n,templateStore:t,isKeyboard:!1,isCreateIn:!1,transaction:e,from:"sidebar_actions"})}return{createdPage:n}}});return e.performResult.createdPage}if(!a.canAdmin()&&a.canEdit()){const{performResult:{createdPage:e}}=await w.createAndCommitAsync({environment:o,userAction:"sidebarActions.quickAddPage.moveToAdd",waitForServerCommit:!1,perform:async e=>{const n=b.j4({environment:o,type:"page",inMemoryRecordCache:o.defaultRecordCache.inMemoryRecordCache,transaction:e,spaceId:r.id,useCrdt:!1});return t.track(n.pointer,e),await f.Ws({environment:o,targets:[n],value:{type:"space-private-pages",spaceId:r.id},transaction:e}),{createdPage:n}}});return await w.createAndCommitAsync({environment:o,userAction:"sidebarActions.quickAddPage.moveToMove",waitForServerCommit:!1,perform:async t=>{const n=await f.kj({environment:o,targets:[e],value:i,transaction:t});if(n&&"collection"===n.table){const r=n.getDefaultTemplatePageStore();r&&p.ob({title:"template",environment:o,store:e,templateStore:r,isKeyboard:!1,isCreateIn:!1,transaction:t,from:"sidebar_actions"})}}}),e}t.fail("invalid_state")}({...e,newPageTracker:c});return d?(n.device.isMobile?(y._({environment:n,store:d,showMoveTo:!0,saveParent:!0,redirect:i,pageVisitSource:r.tY.SidebarQuickAdd}),oe()):_.CH({environment:n,store:d,showMoveTo:!0,saveParent:!0,peekMode:void 0,resultsStore:void 0,collectionContextStore:void 0,pageVisitSource:r.tY.SidebarQuickAdd}),h.Eo({environment:n,spaceViewStore:s,type:"private",newIsHidden:!1,outlinerToggleButtonStore:j.Z,shouldPersistToggleState:!0}),l.W(n,{from:t,type:"page",new_page_id:d.id,creating_block_id:d.id}),o.default.afterNextFlush((()=>{M.Z.SidebarScroller&&M.Z.SidebarScroller.scrollToBottom()})),d):void 0}const be=(0,s.defineMessages)({label:{id:"sidebar.newPage.button",defaultMessage:"New page"},tooltip:{id:"sidebar.newPage.tooltip",defaultMessage:"Create a new page"}}),ye="sidebar",_e="updateSidebar",Se="sidePeek";function we(){const e={expanded:$.sidebarExpandedStore.state,width:$.sidebarWidthStore.state};a.Z.set(ye,e)}function ke(){const{expanded:e,width:t,openedOnBlockId:n,commentsMode:o,currentTab:r,currentSubTab:i}=J.ZP.state,s={expanded:e,width:t,openedOnBlockId:n,commentsMode:o,currentTab:r,currentSubTab:i};a.Z.set(_e,s)}function Ie(){const e=a.Z.get(ye),t=a.Z.get(_e),n=a.Z.get(Se);if((0,R.Y)("supportsNativeHome")?($.sidebarExpandedStore.setState(!1),$.sidebarWidthStore.setState(0)):e?(void 0!==e.expanded&&$.sidebarExpandedStore.setState(e.expanded),void 0!==e.width&&e.width>=$.SidebarMinWidth&&$.sidebarWidthStore.setState(e.width)):(0,C.C)()&&$.sidebarExpandedStore.setState(!1),t){const e=t.width&&t.width>=J.AO?t.width:J.AO;J.ZP.setState({...J.ZP.state,...t,width:e}),window.innerWidth<ee&&$.sidebarExpandedStore.setState(!1)}n&&L.default.setSidePeekWidth(n.width,window.innerWidth)}function Ce(e){J.ZP.setState({...J.ZP.state,currentTab:e})}function xe(e){J.ZP.setState({...J.ZP.state,commentsMode:e}),ke()}function Te(e){(0,G.Sx)(e)||$.sidebarExpandedStore.state?(re({environment:e,isExpanded:!1,from:"toggle_both_sidebars"}),ae({environment:e,isExpanded:!1,from:"keyboard_default"})):(ae({environment:e,isExpanded:!0,from:"keyboard_default"}),re({environment:e,isExpanded:!0,from:"toggle_both_sidebars"}))}function Me(){$.sidebarShouldLogInitialRenderStore.setState(!1)}},24646:(e,t,n)=>{n.d(t,{$3:()=>I,Bb:()=>D,Fl:()=>V,GD:()=>F,J5:()=>w,Jr:()=>y,Nc:()=>v,Sx:()=>k,U8:()=>E,UF:()=>N,Wk:()=>x,YR:()=>P,_c:()=>b,em:()=>R,in:()=>_,js:()=>A,ll:()=>T,qG:()=>C,vF:()=>Z,vG:()=>O,vJ:()=>M,vK:()=>S,wE:()=>B});var o=n(15157),r=n(80503),i=n(9291),a=n(28020),s=n(93827),l=n(48779),c=n(41549),d=n(80444),u=n(45325),p=n(88923),m=n(38676),f=n(36391),g=n(21853);const h=320,v=800;function b(e){return!1}function y(e){return!!e.device.isDesktop||!!e.device.isTablet&&e.WindowSizeStore.isLandscape()}function _(e){return((0,s.C)()||e.currentUser.isLoggedIn())&&m.sidebarExpandedStore.state}function S(e){return k(e)&&f.ZP.state.currentTab===f.gY.Comments}function w(e){return k(e)&&f.ZP.state.currentTab===f.gY.Updates}function k(e){var t;return(null===(t=d.default.state.mainEditorCurrentBlockStore)||void 0===t?void 0:t.id)===f.ZP.state.openedOnBlockId&&(e.currentUser.isLoggedIn()&&!e.device.isMobile&&f.ZP.state.expanded||g.Z.state.open)}function I(e){return e.WindowSizeStore.state.width-x(e)-T(e,!1)}function C(e){const{isDesktop:t,isMobile:n,isTablet:o}=e.device,{WindowSizeStore:r}=e,i=r.isLandscape(),a=n&&!o&&i;return t?m.sidebarWidthStore.state:o||a?Math.min(h,.87*e.WindowSizeStore.state.width):.87*e.WindowSizeStore.state.width}function x(e){const{shouldShowSidebar:t}=(0,a.h1)(e),n=_(e);return t&&n&&y(e)?C(e)+c.VV():t&&!n&&u.default.isOpen()?c.VV():0}function T(e,t){return t&&p.default.state.open?0:function(e){0;if(e.device.isMobile)return 0;if(M(e)>0)return 0;return k(e)?f.ZP.state.width:0}(e)+M(e)}function M(e){return p.default.isSidePeekOpen()?p.default.getSidePeekWidth(e.WindowSizeStore.state.width):0}function P(e){return e.device.isAndroid&&!e.device.isTablet||e.device.isTablet&&e.WindowSizeStore.isPortrait()}const A=(0,i.defineMessages)({createOrJoinWorkspace:{defaultMessage:"Create or join workspace",id:"sidebarSwitcher.createOrJoinWorkspaceButton.prompt"},personalPlan:{defaultMessage:"Personal Plan",id:"sidebarSwitcher.personalPlan.label"},proPlan:{defaultMessage:"Personal Pro Plan",id:"sidebarSwitcher.proPlan.label"},educationPlan:{defaultMessage:"Personal Pro Plan (Education)",id:"educationPlan.title"},educationPlusPlan:{defaultMessage:"Education Plus Plan",id:"sidebarSwitcher.educationPlusPlan.label"},freePlan:{defaultMessage:"Free Plan",id:"sidebarSwitcher.freePlan.label"},teamTrialPlan:{defaultMessage:"Team Plan (Trial)",id:"teamTrialPlan.title"},teamPlan:{defaultMessage:"Team Plan",id:"teamPlan.title"},plusPlan:{defaultMessage:"Plus Plan",id:"plusPlan.title"},businessPlan:{id:"businessPlan.title",defaultMessage:"Business Plan"},enterprisePlan:{defaultMessage:"Enterprise Plan",id:"sidebarSwitcher.enterprisePlan.label"},legacyPlan:{defaultMessage:"Legacy Plan",id:"sidebarSwitcher.legacyPlan.label"},workspaceSubtitleWithMembers:{id:"sidebarSwitcher.workspaceSubtitleWithMembers.label",defaultMessage:"{planType} · {numberOfWorkspaceMembers, plural, one {{numberOfWorkspaceMembers} member} other {{numberOfWorkspaceMembers} members}}"},workspaceSubtitleWithoutMembers:{id:"sidebarSwitcher.workspaceSubtitleWithoutMembers.label",defaultMessage:"{planType}"}});function R(e){switch(e){case"team_free":case"personal_free":case"free":return A.freePlan;case"personal":case"plus":return A.plusPlan;case"student":return A.educationPlusPlan;case"business":return A.businessPlan;case"enterprise":return A.enterprisePlan;default:return A.legacyPlan}}function D(e){return e.canRead()&&"copy_indicator"!==e.getType()}function E(e){let{isElectronMac:t,isExpanded:n,isFullScreenDesktop:o}=e;return t&&n&&!o}function B(e){let{isElectronMac:t,isExpanded:n,isFullScreenDesktop:o,isShowingTabBar:r}=e;return!r&&E({isElectronMac:t,isExpanded:n,isFullScreenDesktop:o})}function F(e){let{isElectronMac:t,isExpanded:n,isFullScreenDesktop:o,isShowingTabBar:r}=e;return n&&!r&&!B({isElectronMac:t,isExpanded:n,isFullScreenDesktop:o,isShowingTabBar:r})}function O(e){var t;let{environment:n}=e;const o=null===(t=(0,a.k_)(n).state)||void 0===t?void 0:t.showTeamSection,r=d.default.state.currentSpaceStore,i=n.device.isMobile;return!(!o||!r||i)&&!(0,l.Cx)(r)}function Z(e){return r.R6(e.device.isElectronMac)+15}function V(e,t){return`${e.id}:${t}`}function U(e){let{environment:t,section:n,isSectionShown:r,spaceViewId:i}=e;if(!r)return null;return!0!==o.Z.get({userId:t.currentUser.id,key:V({id:i},n)})}function N(e){var t;let{environment:n}=e;const o=null===(t=d.default.state.currentSpaceViewStore)||void 0===t?void 0:t.id,r=(0,a.k_)(n).state;if(!o||!r)return{is_open:_(n)};const{showBookmarksSection:i,showSharedSection:s,showTeamSection:l,showOnlyPrivateSection:c,showPrivateSection:u}=r;return{sidebar_state:{is_open:_(n),is_bookmark_expanded:U({environment:n,isSectionShown:i,section:"bookmarks",spaceViewId:o}),is_team_expanded:U({environment:n,isSectionShown:l,section:"teamSidebar",spaceViewId:o}),is_shared_expanded:U({environment:n,isSectionShown:s,section:"shared",spaceViewId:o}),is_private_expanded:U({environment:n,isSectionShown:u&&!c,section:"private",spaceViewId:o})}}}},88310:(e,t,n)=>{n.d(t,{$L:()=>s,As:()=>c,hV:()=>d,ls:()=>u});var o=n(5809),r=n(72126),i=n(83055);const a={};function s(e){void 0===a[e]&&(a[e]=performance.now())}const l={};function c(e){Object.assign(l,e)}function d(){return l}function u(){const{app_start_to_main_start:e,main_start_to_prefetch_initiated:t,prefetch_initiated_to_render_start:n,render_start_to_render_end:s}=(0,i.IN)().sub_metrics,l=(0,o.$)(),c={app_start_to_await_get_spaces_start:p(l,a.await_get_spaces_start),app_start_to_await_get_spaces_end:p(l,a.await_get_spaces_end),app_start_to_browser_repaint_start:p(l,a.browser_repaint_start),app_start_to_browser_repaint_end:p(l,a.browser_repaint_end)},d=r.GM({app_start_to_main_start:e,main_start_to_prefetch_initiated:t,prefetch_initiated_to_render_start:n,render_start_to_render_end:s,...c},r.o8),u=[e,t,n,s];return u.some(r.o8)||(d.app_start_to_render_end=r.Sm(u)),d}function p(e,t){return void 0===e||void 0===t?void 0:t-e}},68418:(e,t,n)=>{n.d(t,{F:()=>i,Z:()=>s});var o=n(49085),r=n(4615);let i=function(e){return e[e.Team=0]="Team",e[e.Members=1]="Members",e}({});class a extends o.default{getInitialState(){return{open:!1,screen:i.Team,description:"",accessLevel:"open",isDefault:!1,name:"",icon:void 0,flowId:(0,r.ZP)(),pageNumber:1,onClose:void 0}}}const s=new a},97799:(e,t,n)=>{n.d(t,{Y:()=>r,Z:()=>i});var o=n(61766);let r=function(e){return e.Updates="updates",e.Home="home",e}({});const i=new o.Z},55521:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{touching:!1,swiping:!1}}}const i=new r},19034:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),r=n(80444);class i extends o.default{getInitialState(){return{results:[]}}getUnreadCountForCurrentSpace(){const{currentSpaceStore:e}=r.default.state,{results:t}=this.state;if(e){const n=t.find((t=>t.spaceId===e.id));if(n)return n.unread}return{mentions:0,following:0,highPriority:0}}getUnreadMentionsCountForOtherSpaces(){const{currentSpaceStore:e}=r.default.state,t=e&&e.id,{results:n}=this.state;let o=0;for(const r of n)r.spaceId!==t&&(o+=r.unread.mentions);return o}getTotalUnreadMentionsCount(){const{results:e}=this.state;let t=0;for(const n of e)t+=n.unread.mentions;return t}}const a=new i},38676:(e,t,n)=>{n.r(t),n.d(t,{SidebarMinWidth:()=>f,sidebarElectronMousePeekStore:()=>h,sidebarExpandedStore:()=>d,sidebarMouseEnterYStore:()=>c,sidebarMouseEnteredStore:()=>u,sidebarMousePeekXStore:()=>l,sidebarOpenStore:()=>a,sidebarResizingStore:()=>p,sidebarShouldLogInitialRenderStore:()=>g,sidebarShowTeamBrowserStore:()=>s,sidebarSizeObserver:()=>m,sidebarWidthStore:()=>i});var o=n(49085),r=n(77794);const i=o.default.createValue(240),a=o.default.createValue(!1),s=o.default.createValue(!1),l=o.default.createValue(0),c=o.default.createValue(0),d=o.default.createValue(!0),u=o.default.createValue(!1),p=o.default.createValue({isResizing:!1,isResizerHovered:!1}),m=new r.E,f=220,g=o.default.createValue(!0),h=o.default.createValue(!1)},97852:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},78861:(e,t,n)=>{n.d(t,{Z:()=>u});var o=n(49085),r=n(72126),i=n(19889),a=n(66079),s=n(63143),l=n(81236),c=n(79797);class d extends o.default{getInitialState(){return{createType:void 0}}getAllSpaceViewStores(e){return e.currentUser.loggedInUserIds.reduce(((t,n)=>[...t,...this.getSpaceViewStores(e,n)]),[])}hasAtLeastOneTeamPlan(e){return this.getAllSpaceViewStores(e).map((e=>{const t=e.getSpaceStore();if(t)return t.getPlanType()})).some((e=>"team"===e))}getSpaceViewStores(e,t){const n=new c.r9(e,{table:a.dx,id:t},{userId:t}).getSpaceViewStores();return r.mN(n,(e=>e.isDefined()&&e.getSpaceId())).filter((t=>Boolean(t.isDefined())&&Boolean(t.getAlive())&&!this.isSpaceDeleted(e,t)))}isSpaceDeleted(e,t){const n=t.getSpaceId()||"",o=l.Z.getPublicSpaceData(e,n);return(0,s.z4)(o)}getUserEmailAddress(e,t){return new c.U6(e,{table:i.KJ,id:t},{userId:t}).getEmail()}}const u=new d},55838:(e,t,n)=>{n.d(t,{Z:()=>a,a:()=>r});var o=n(49085);let r=function(e){return e[e.General=0]="General",e[e.Members=1]="Members",e[e.Security=2]="Security",e}({});class i extends o.default{getInitialState(){return{open:!1,limitMembers:!0,memberFilterQuery:"",tab:void 0}}getTeamStore(){return this.state.open?this.state.viewingUnjoinedPrivateTeamAsEnterpriseAdmin?this.state.unjoinedPrivateTeamStore:this.state.teamStore:void 0}}const a=new i},77999:(e,t,n)=>{n.r(t),n.d(t,{default:()=>a,orderedTeamSidebarTourSteps:()=>r});var o=n(49085);const r=["welcome","actions","teamspaces","prebuilt_templates","private","explore_templates"];class i extends o.default{getInitialState(){return{type:"inactive"}}}const a=new i},36896:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},44604:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{constructor(){super(...arguments),this.loadMoreOffset=200,this.startLimit=20,this.limitIncrement=20}getInitialState(){return{filter:"",currentTab:"all_pages",loading:!0,limit:this.startLimit,excludePages:new Set}}}const i=new r},36391:(e,t,n)=>{n.d(t,{AO:()=>l,F7:()=>i,ZP:()=>u,gY:()=>a,uF:()=>s});var o=n(49085),r=n(92595);let i=function(e){return e[e.Resolved=0]="Resolved",e[e.Unresolved=1]="Unresolved",e}({}),a=function(e){return e[e.Comments=0]="Comments",e[e.Updates=1]="Updates",e[e.AiContext=2]="AiContext",e[e.Info=3]="Info",e}({}),s=function(e){return e[e.Updates=0]="Updates",e[e.Analytics=1]="Analytics",e}({});const l=385;class c extends o.default{getInitialState(){return{width:l,expanded:!1,isResizerHovered:!1,isResizing:!1,mouseEntered:!1,currentTab:a.Comments,currentSubTab:s.Updates,commentsMode:i.Unresolved,isAnimating:!1,canRender:!0}}}const d=new c;(0,r.exposeDebugValue)("UpdateSidebarStore",d);const u=d},21853:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},98794:(e,t,n)=>{n.r(t),n.d(t,{annotateSimpleTableSelection:()=>oe,appendRow:()=>he,cancelReorder:()=>Me,clearHover:()=>se,clearSelectedCell:()=>Ze,clearSelection:()=>Q,clearSelectionContents:()=>Ve,completeReorder:()=>Pe,continueReorder:()=>Te,contractColumns:()=>Re,contractRows:()=>Be,deleteColumns:()=>Ae,deleteRows:()=>Ee,duplicateColumns:()=>ve,duplicateRows:()=>be,expandCellSelection:()=>K,extendColumns:()=>ce,extendRows:()=>fe,fitToPage:()=>He,handleDelete:()=>ee,handleDuplicate:()=>ne,handleKeypress:()=>te,handleLeftRightKey:()=>Y,handleUpDownKey:()=>J,hoverCell:()=>re,hoverResizer:()=>ae,hoverRowColumn:()=>ie,insertColumnLeft:()=>le,insertColumnRight:()=>de,insertRow:()=>ge,insertRowAbove:()=>pe,insertRowBelow:()=>me,messages:()=>j,resizeColumn:()=>ke,selectCell:()=>H,selectCellAndSetCursor:()=>G,selectColumn:()=>q,selectMultiCell:()=>W,selectRow:()=>z,setColor:()=>qe,setResizing:()=>Se,showResizeBar:()=>_e,startReorder:()=>xe,toggleHeaderColumn:()=>ze,toggleHeaderRow:()=>je,turnIntoCollection:()=>Ne,turnIntoSimpleTable:()=>Le,updateCellSelectionFromTextSelection:()=>$,updateColumnSelectionOnResize:()=>Ce,updateRowSelectionOnResize:()=>Ie});n(57658),n(21703);var o=n(50361),r=n.n(o),i=n(1302),a=n(41432),s=n(90559),l=n(99036),c=n(80951),d=n(4615),u=n(71644),p=n(21202),m=n(6287),f=n(13493),g=n(23867),h=n(70203),v=n(63143),b=n(9291),y=n(952),_=n(54532),S=n(96802),w=n(94419),k=n(19785),I=n(9953),C=n(24677),x=n(993),T=n(98104),M=n(82530),P=n(95477),A=n(14976),R=n(33929),D=n(65598),E=n(22294),B=n(79797),F=n(27724),O=n(24666),Z=n(27534),V=n(84139),U=n(64359),N=n(5676),L=n(63208);const j=(0,b.defineMessages)({turnIntoCollectionTitle:{defaultMessage:"Title",id:"simpleTableActions.collectionTitle"},turnIntoCollectionColumnTitle:{defaultMessage:"Column {columnIndex}",id:"simpleTableActions.collectionColumnTitle"}});function z(e){const{environment:t,index:n,simpleTableStore:o}=e,r=Z.getNumberOfRows(o);if(0===r)return Q(),void T.ZH(t);const i=(0,v.uZ)(n,0,r-1);L.Z.setState({isActive:!0,simpleTableStore:o,selection:{start:{col:0,row:i},end:{col:Z.getNumberOfColumns(o)-1,row:i},type:"row"}}),C.Z5({environment:t,stores:[o],phase:F.SelectionPhase.Editing}),T.ZH(t)}function q(e){const{environment:t,index:n,simpleTableStore:o}=e,r=Z.getNumberOfColumns(o);if(0===r)return Q(),void T.ZH(t);const i=(0,v.uZ)(n,0,r-1);L.Z.setState({isActive:!0,simpleTableStore:o,selection:{start:{col:i,row:0},end:{col:i,row:Z.getNumberOfRows(o)-1},type:"column"}}),C.Z5({environment:t,stores:[o],phase:F.SelectionPhase.Editing}),T.ZH(t)}function H(e){const{environment:t,rowIndex:n,columnIndex:o,simpleTableStore:r}=e;L.Z.setState({isActive:!0,simpleTableStore:r,selection:{start:{col:o,row:n},end:{col:o,row:n},type:"cell"}}),C.Z5({environment:t,stores:[r],phase:F.SelectionPhase.Editing})}function W(e){const{environment:t,start:n,end:o,simpleTableStore:r}=e;L.Z.setState({isActive:!0,simpleTableStore:r,selection:{start:n,end:o,type:"cell"}}),C.Z5({environment:t,stores:[r],phase:F.SelectionPhase.Editing}),T.ZH(t)}function K(e){const{environment:t,rowIndex:n,columnIndex:o,simpleTableStore:r}=e;W({environment:t,start:L.Z.state.isActive?L.Z.state.selection.start:{col:o,row:n},end:{col:o,row:n},simpleTableStore:r})}function G(e){H(e);const t=Z.getCellTextStore(e);t&&T.NX({store:t})}function $(){if("editing"!==O.default.state.mode)return;const e=Z.getSimpleTableCellFromTextSelection();if(!e)return void Q();const{columnIndex:t,rowIndex:n,simpleTableStore:o}=e.getProps(),r=L.Z.state;if(r.isActive){const{start:e,end:i}=r.selection;!(e.col===i.col&&e.row===i.row)||e.col===t&&e.row===n&&r.simpleTableStore===o||H({environment:o.environment,rowIndex:n,columnIndex:t,simpleTableStore:o})}else H({environment:o.environment,rowIndex:n,columnIndex:t,simpleTableStore:o})}function Q(){L.Z.setState({isActive:!1})}function Y(e){const{environment:t,direction:n,bypassExistingTextSelection:o,expandSelection:r}=e;if(!o&&Z.getSimpleTableCellFromTextSelection())return;const i=L.Z.state;if(i.isActive){const{selection:e,simpleTableStore:a}=i;if(r){const{rowIndex:o,columnIndex:r}=X({selection:e,simpleTableStore:a,direction:n,wrapRow:!1});return void K({environment:t,rowIndex:o,columnIndex:r,simpleTableStore:a})}if(Z.isColumnSelected({selection:e,columnIndex:e.start.col,simpleTableStore:a})){const{columnIndex:o}=X({selection:e,simpleTableStore:a,direction:n,wrapRow:!1});q({environment:t,index:o,simpleTableStore:a})}else{const r="editing"===O.default.state.mode;o&&T.ZH(t);const{rowIndex:i,columnIndex:s}=X({selection:e,simpleTableStore:a,direction:n,wrapRow:!0});if(r)return void G({environment:t,rowIndex:i,columnIndex:s,simpleTableStore:a});H({environment:t,rowIndex:i,columnIndex:s,simpleTableStore:a})}}E.Z.setKeyboardMode(!0)}function X(e){const{selection:t,simpleTableStore:n,direction:o,wrapRow:r}=e,i=Z.getNumberOfColumns(n)-1,a=Z.getNumberOfRows(n)-1,{col:s,row:l}=t.end;return"right"===o?s===i&&l===a?{columnIndex:i,rowIndex:a}:s===i?r?{columnIndex:0,rowIndex:l+1}:{columnIndex:s,rowIndex:l}:{columnIndex:s+1,rowIndex:l}:0===s&&0===l?{columnIndex:0,rowIndex:0}:0===s?r?{columnIndex:i,rowIndex:l-1}:{columnIndex:s,rowIndex:l}:{columnIndex:s-1,rowIndex:l}}function J(e){const{environment:t,direction:n,bypassExistingTextSelection:o,expandSelection:r}=e;if(!o&&Z.getSimpleTableCellFromTextSelection())return;const i=L.Z.state;if(i.isActive){const{selection:e,simpleTableStore:a}=i,{rowIndex:s,columnIndex:l}=function(e){const{selection:t,simpleTableStore:n,direction:o}=e,r=Z.getNumberOfRows(n)-1,{col:i,row:a}=t.end,s="down"===o?Math.min(r,a+1):Math.max(0,a-1);return{columnIndex:i,rowIndex:s}}({selection:e,simpleTableStore:a,direction:n});if(r)return void K({environment:t,rowIndex:s,columnIndex:l,simpleTableStore:a});Z.isRowSelected({selection:e,rowIndex:e.start.row,simpleTableStore:a})?z({environment:t,index:s,simpleTableStore:a}):(o&&T.ZH(t),H({environment:t,rowIndex:s,columnIndex:l,simpleTableStore:a}))}E.Z.setKeyboardMode(!0)}function ee(e){if(Z.getSimpleTableCellFromTextSelection())return;const t=L.Z.state;if(!t.isActive)return;const{environment:n,transaction:o}=e,{selection:r,simpleTableStore:i}=t;if(Z.isColumnSelected({selection:r,columnIndex:r.start.col,simpleTableStore:i}))Ve(e),De({index:r.start.col,simpleTableStore:i,transaction:o}),q({environment:n,index:r.start.col,simpleTableStore:i});else if(Z.isRowSelected({selection:r,rowIndex:r.start.row,simpleTableStore:i})){Fe({rowID:i.getRenderableContentIds()[r.start.row],simpleTableStore:i,transaction:o}),z({environment:n,index:r.start.row,simpleTableStore:i})}else Z.isSingleCellSelected(r)?Ze({environment:n,transaction:o}):Ve({environment:n,transaction:o})}function te(e){if(Z.getSimpleTableCellFromTextSelection())return;const t=L.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,r=o.getContentStores()[n.end.row],i=Z.getColumnOrder(o);if(!i)return;const{environment:a,transaction:s,key:l}=e,c=r.getPropertyStore(i[n.end.col]);if(l&&1===l.length){const e=c.getValue(),t=h.TPx(l);x.sO({environment:a,store:c,value:e?e.concat(t):t,transaction:s}),T.NX({store:c})}}function ne(e){if(Z.getSimpleTableCellFromTextSelection())return;const t=L.Z.state;if(!t.isActive)return;const{environment:n,transaction:o}=e,{selection:r,simpleTableStore:i}=t;Z.isColumnSelected({selection:r,columnIndex:r.start.col,simpleTableStore:i})?ve({transaction:o}):Z.isRowSelected({selection:r,rowIndex:r.start.row,simpleTableStore:i})&&be({environment:n,transaction:o})}function oe(e){const{simpleTableStore:t,annotation:n}=e,o=L.Z.state;if(!o.isActive||o.simpleTableStore!==t)return;const{selection:r}=o,i=[],a=Math.min(r.start.row,r.end.row),s=Math.max(r.start.row,r.end.row),l=Math.min(r.start.col,r.end.col),c=Math.max(r.start.col,r.end.col);for(let p=a;p<=s;p++)for(let e=l;e<=c;e++){const n=Z.getCellTextStore({simpleTableStore:t,rowIndex:p,columnIndex:e}),o=null==n?void 0:n.getValue();n&&o&&i.push({textStore:n,textValue:o})}const d=h.J7s(n),u=i.every((e=>{let{textValue:t}=e;return t.every((e=>h.hDy(e).some((e=>h.J7s(e)===d))))}));for(const{textStore:p}of i)x.QT({...e,textStore:p,action:u?"removeAnnotationType":"annotate"})}function re(e){if(we())return;const{x:t,y:n,simpleTableStore:o}=e;U.Z.setState({isActive:!0,simpleTableStore:o,hover:{x:t,y:n,showResizer:!1,resizing:!1,type:"cell"}})}function ie(e){if(we())return;const{type:t,simpleTableStore:n,index:o}=e;U.Z.setState({isActive:!0,simpleTableStore:n,hover:{type:t,index:o}})}function ae(e){const{simpleTableStore:t,resizer:n}=e;U.Z.setState({isActive:!0,simpleTableStore:t,hover:{type:"resizer",resizer:n}})}function se(){we()||U.Z.setState({isActive:!1})}function le(e){const t=L.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,{environment:r,transaction:i}=e;ue({index:n.start.col,simpleTableStore:o,transaction:i}),G({environment:r,rowIndex:0,columnIndex:n.start.col,simpleTableStore:o})}function ce(e){const{count:t,simpleTableStore:n,transaction:o}=e;if(t<1)return;const r=Z.getNumberOfColumns(n);for(let i=0;i<t;i++)ue({index:r+i,simpleTableStore:n,transaction:o})}function de(e){const t=L.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,{environment:r,transaction:i}=e;ue({index:n.end.col+1,simpleTableStore:o,transaction:i}),G({environment:r,rowIndex:0,columnIndex:n.end.col+1,simpleTableStore:o})}function ue(e){const{index:t,simpleTableStore:n,transaction:o,columnID:r,format:i}=e,a=Z.getColumnOrder(n)||[],s=Z.getColumnFormat(n),l=r||(0,u.ZP)(),c=[...a.slice(0,t),l,...a.slice(t)],d=i?{...s,[l]:i}:s;S.FH({stores:[n],update:{table_block_column_order:c,table_block_column_format:d},transaction:o})}function pe(e){const t=L.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,{environment:r,transaction:i}=e;ge({environment:r,index:n.start.row,simpleTableStore:o,transaction:i}),G({environment:r,rowIndex:n.start.row,columnIndex:0,simpleTableStore:o})}function me(e){const t=L.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,{environment:r,transaction:i}=e;ge({environment:r,index:n.end.row+1,simpleTableStore:o,transaction:i}),G({environment:r,rowIndex:n.end.row+1,columnIndex:0,simpleTableStore:o})}function fe(e){const{environment:t,count:n,simpleTableStore:o,transaction:r,analyticsFrom:i}=e;if(n<1)return;const a=Z.getNumberOfRows(o);for(let s=0;s<n;s++)ge({environment:t,index:a+s,simpleTableStore:o,transaction:r,analyticsFrom:i})}function ge(e){const{environment:t,index:n,simpleTableStore:o,transaction:r,analyticsFrom:i}=e,a=o.getContentStore();if(!(0,D.dz)(a))throw new Error("Block has an invalid parent.");const s=I.j4({environment:t,type:"table_row",properties:{},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:r,spaceId:o.pointer.spaceId,useCrdt:o.useCrdt()}),l=B.G.createChildStore(a,s.pointer);if(i&&y.W(t,{from:i,type:"table_row",creating_block_id:s.id}),n<=0)k.SH({parentStore:a,childStore:l,transaction:r});else{const e=o.getContentStores();k.jG({parentStore:a,childStore:l,transaction:r,after:e[n-1].id})}return l}function he(e){const{environment:t,simpleTableStore:n,transaction:o}=e,r=n.getContentStore();if(!(0,D.dz)(r))throw new Error("Block has an invalid parent.");const i=I.j4({environment:t,type:"table_row",properties:{},inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:o,spaceId:n.pointer.spaceId,useCrdt:n.useCrdt()}),a=B.G.createChildStore(r,i.pointer);return k.jG({parentStore:r,childStore:a,transaction:o}),a}function ve(e){const t=L.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,r=Z.getColumnOrder(o),i=Z.getColumnFormat(o);if(!r)return;const a=r.slice(n.start.col,n.end.col+1);if(!a)return;const s=[],{transaction:l}=e;for(let c=n.start.col;c<=n.end.col;c++){const e=a[c-n.start.col],t=(0,u.ZP)();s.push(t),ue({index:n.end.col+1,simpleTableStore:o,transaction:l,columnID:t,format:i?i[e]:void 0})}for(const c of o.getContentStores())ye({rowStore:c,columnIDs:a,newColumnIDs:s,transaction:l})}function be(e){const t=L.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,r=o.getRenderableContentIds(),{environment:i,transaction:a}=e;for(let s=n.start.row;s<=n.end.row;s++){const e=B.G.createChildStore(o,{table:p.iU,id:r[s]}),[t]=_.Qi({environment:i,stores:[e],addCopyName:!1,transaction:a,deepCopyTransclusionContainers:!0,resolveTemplateVariables:!1,targetSpaceId:(0,g.C)(e.pointer.spaceId),baseUrl:P.default.domainBaseUrl,publicDomainName:P.default.publicDomainName,preferDuplicateLocation:"local",useCrdt:o.useCrdt()}),n=t[0];w.BE({parent:o.getContentStore(),insert:n,after:e,transaction:a})}}function ye(e){const{rowStore:t,columnIDs:n,newColumnIDs:o,transaction:r}=e,i=t.getPropertiesStore(),a={...i.getValue(),...(0,v.m8)(o.map(((e,o)=>[e,t.getPropertyValue(n[o])])))};I.sO({store:i,value:a,transaction:r})}function _e(e){const t=U.Z.state;if(!t.isActive)return;const{hover:n}=t;"cell"===n.type&&U.Z.setState({...t,hover:{...n,showResizer:e}})}function Se(e){const t=U.Z.state;if(!t.isActive)return;const{hover:n}=t;"cell"===n.type&&U.Z.setState({...t,hover:{...n,resizing:e}})}function we(){const e=U.Z.state;return e.isActive&&"resizing"in e.hover&&e.hover.resizing}function ke(e){const{tableBlockColumnFormat:t,simpleTableStore:n,transaction:o}=e;S.FH({stores:[n],update:{table_block_column_format:t},transaction:o})}function Ie(e){const t=L.Z.state;if(!t.isActive||"row"!==t.selection.type)return;const{selection:n}=t;L.Z.setState({...t,selection:{...n,end:{col:e,row:n.end.row}}})}function Ce(e){const t=L.Z.state;if(!t.isActive||"column"!==t.selection.type)return;const{selection:n}=t;L.Z.setState({...t,selection:{...n,end:{col:n.end.col,row:e}}})}function xe(e){const{environment:t,simpleTableStore:n,id:o,index:r,type:i,rowStore:a,theme:s,selectorStartPx:l,mouseOffsetPx:c}=e;let d=[];"column"===i?(q({environment:t,index:r,simpleTableStore:n}),d=V.Z.findCellsInColumnFromStore(n,o)):(z({environment:t,index:r,simpleTableStore:n}),d=V.Z.findCellsInRowFromStore(a));const u=Z.cloneCellsForDragOverlay({cells:d,type:i,theme:s});N.Z.setState({isActive:!0,simpleTableStore:n,source:{id:o,type:i,index:r,draggedCells:u,selectorStartPx:l,mouseOffsetPx:c},destIndex:r,selectorDragPx:l,moved:!1})}function Te(e){const{destIndex:t,selectorDragPx:n}=e,o=N.Z.state;o.isActive&&N.Z.setState({...o,destIndex:t,selectorDragPx:n,moved:!0})}function Me(){N.Z.reset()}function Pe(e){const{event:t,environment:n,format:o,simpleTableStore:r,transaction:a,type:s,onNoChange:l}=e,c=N.Z.state;if(!c.isActive)return;const{source:d,destIndex:u}=c;d.type===s&&c.simpleTableStore===r&&("column"===s?function(e){const{environment:t,columnOrder:n,source:o,destIndex:r,simpleTableStore:a,transaction:s}=e;if(!n)return;Q();const l=[...n.slice(0,o.index),...n.slice(o.index+1)],c=[...l.slice(0,r),o.id,...l.slice(r)];S.FH({stores:[a],update:{table_block_column_order:c},transaction:s}),i.default.afterNextFlush((()=>{q({environment:t,index:r,simpleTableStore:a})}))}({environment:n,columnOrder:o.table_block_column_order,source:d,destIndex:u,simpleTableStore:r,transaction:a}):function(e){const{environment:t,source:n,destIndex:o,simpleTableStore:r,transaction:a}=e,s=r.getRenderableContentIds(),l=o>n.index?o:o-1;let c=o>0?s[l]:void 0;c===n.id&&(c=s[l+1]);Q();const d=r.getContentStores().find((e=>e.id===n.id)),u=r.getContentStores().find((e=>e.id===c));if(d){const e=r;u?k.jG({parentStore:e,after:u.id,childStore:d,transaction:a}):k.SH({parentStore:e,childStore:d,transaction:a}),i.default.afterNextFlush((()=>{z({environment:t,index:o,simpleTableStore:r})}))}}({environment:n,source:d,destIndex:u,simpleTableStore:r,transaction:a}),d.index===u&&(null==l||l(t)))}function Ae(e){const t=L.Z.state;if(!t.isActive)return;Ve(e);const{selection:n,simpleTableStore:o}=t,{environment:r,transaction:i}=e;for(let a=n.start.col;a<=n.end.col;a++)De({index:a,simpleTableStore:o,transaction:i});q({environment:r,index:n.start.col,simpleTableStore:o})}function Re(e){const{simpleTableStore:t,columnOrder:n,transaction:o}=e;S.FH({stores:[t],update:{table_block_column_order:n},transaction:o})}function De(e){const{index:t,simpleTableStore:n,transaction:o}=e,r=Z.getColumnOrder(n);if(!r||1===r.length)return;const i=[...r.slice(0,t),...r.slice(t+1)];S.FH({stores:[n],update:{table_block_column_order:i},transaction:o})}function Ee(e){const t=L.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,r=o.getRenderableContentIds(),{environment:i,transaction:a}=e;for(let s=n.start.row;s<=n.end.row;s++)Fe({rowID:r[s],simpleTableStore:o,transaction:a});z({environment:i,index:n.start.row,simpleTableStore:o})}function Be(e){const{simpleTableStore:t,numRowsToDelete:n,transaction:o}=e,r=t.getRenderableContentIds();for(let i=r.length-n;i<r.length;i++)Fe({rowID:r[i],simpleTableStore:t,transaction:o})}function Fe(e){const{rowID:t,simpleTableStore:n,transaction:o}=e,r=n.getContentStore();if(!(0,D.dz)(r))throw new Error("Block has an invalid parent.");if(Z.getNumberOfRows(n)<=1)return;const i={table:p.iU,id:t};Oe({rowStore:B.G.createChildStore(r,i),simpleTableStore:n,transaction:o})}function Oe(e){const{rowStore:t,simpleTableStore:n,transaction:o}=e,r=n.getContentStore();k.hr({parentStore:r,childStore:t,transaction:o})}function Ze(e){const t=L.Z.state;if(!t.isActive)return;const{selection:n}=t;if(!Z.isSingleCellSelected(n))return;const{environment:o,transaction:r}=e;Ve({environment:o,transaction:r})}function Ve(e){const t=L.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:o}=t,r=Z.getColumnOrder(o);if(!r)return;const i=o.getContentStores(),{environment:a,transaction:s}=e,l=Math.min(n.start.row,n.end.row),c=Math.max(n.start.row,n.end.row),d=Math.min(n.start.col,n.end.col),u=Math.max(n.start.col,n.end.col);for(let p=l;p<=c;p++)Ue({rowStore:i[p],startIndex:d,endIndex:u,columnOrder:r,transaction:s});T.ZH(a)}function Ue(e){const{rowStore:t,startIndex:n,endIndex:o,columnOrder:r,transaction:i}=e,a=r.slice(n,o+1);if(!a)return;const s=t.getPropertiesStore(),l=(0,v.m8)(Object.entries(s.getValue()||{}).filter((e=>{let[t,n]=e;return!a.includes(t)})));I.sO({store:s,value:l,transaction:i})}function Ne(e){const{environment:t,simpleTableStore:n,transaction:o}=e,r=Z.getColumnOrder(n)||[],i=Z.getColumnFormat(n)||{},{headerRow:s}=Z.getHeadersEnabled(n),c=n.getContentStores();if(!r.length)return;const u=r[0],g=n.getSpaceId(),h=(0,d.ZP)(),b=(0,d.ZP)(),y=s?c[0]:void 0,_=(0,v.m8)(r.map(((e,t)=>function(e){const{columnID:t,columnIndex:n,titleColumnID:o,headerRowStore:r}=e;let i=t,a="text",s=j.turnIntoCollectionColumnTitle;t===o&&(i="title",a="title",s=j.turnIntoCollectionTitle);const l=R.default.getIntl();return[i,{name:r?A.Xh(r.getPropertyValue(t),r):l.formatMessage(s,{columnIndex:n}),type:a}]}({columnID:e,columnIndex:t,titleColumnID:u,headerRowStore:y})))),S={id:h,version:0,parent_table:p.iU,parent_id:n.id,space_id:g,name:void 0,schema:_,alive:!0},w=I.ae({environment:t,table:"collection",value:S,inMemoryRecordCache:t.defaultRecordCache.inMemoryRecordCache,transaction:o});I.sW({store:n,data:{type:a.Ti.collectionView,view_ids:[b],collection_id:h},transaction:o}),I.sW({store:n.getFormatStore(),data:{collection_pointer:{table:m.v,id:h,spaceId:g}},transaction:o}),c.map(((e,r)=>{if(s&&0===r)return void Oe({rowStore:e,simpleTableStore:n,transaction:o});const i=e.getProperties();I.sW({store:e,data:{type:a.Ti.page},transaction:o}),x.sO({environment:t,store:e.getBlockTitleStore(),value:i[u],transaction:o}),I.sW({store:e.getPropertiesStore(),data:{[u]:void 0},transaction:o}),k.zw({childStore:e,parentStore:w,transaction:o})}));const C={id:b,version:0,type:"table",name:void 0,parent_id:n.id,parent_table:"block",space_id:g,format:{table_properties:r.map((e=>({visible:!0,property:e===u?"title":e,width:i&&e in i?i[e].width:void 0})))},page_sort:c.map((e=>e.id)).slice(0,l.gq),alive:!0},T={table:f.n,id:b,spaceId:g};M.applyOperation({store:(0,B.Kv)(n,T),operation:{pointer:T,command:"set",path:[],args:C},transaction:o})}function Le(e){var t;const{environment:n,collectionViewBlockStore:o,pageStores:r,transaction:i}=e,l=o.getCollectionViewSourceCollectionStore();if(!l)return;if(r.length>Z.simpleTableTransformPageLimit||r.some((e=>e.hasContent())))return;const[d]=o.getCollectionViewStores(),p=l.getSchema(),m=(d.getFormat().table_properties||[]).filter((e=>e.visible&&e.property in p));if(!m)return;const f=o.getContentStore(),g=(0,u.ZP)();I.sW({store:o,data:{type:a.Ti.table,collection_id:null},transaction:i}),I.sW({store:o.getFormatStore(),data:{table_block_column_order:m.map((e=>"title"===e.property?g:e.property)),table_block_column_format:(0,v.m8)(m.map((e=>["title"===e.property?g:e.property,{width:e.width}]))),table_block_column_header:!0,collection_pointer:null},transaction:i});const h=I.j4({environment:n,type:"table_row",properties:(0,v.m8)(m.map((e=>{const t=e.property,n=t in p?p[t]:void 0;return["title"===t?g:t,n?[[n.name]]:[]]}))),inMemoryRecordCache:n.defaultRecordCache.inMemoryRecordCache,transaction:i,spaceId:o.pointer.spaceId,useCrdt:o.useCrdt()}),b=B.G.createChildStore(f,h.pointer);k.SH({parentStore:f,childStore:b,transaction:i});const y=(0,s.$z)(p),_=y.length>0?null===(t=l.getRecordKeyStore())||void 0===t?void 0:t.getRecordKey():void 0;r.map(((e,t)=>{const o=B.G.createChildStore(f,e.pointer),r=e.getProperties(),l=y.reduce((function(e,t){const n=(0,s.wf)(_,c.ah(r[t]));return e[t]=[[n]],e}),{});I.sW({store:o,data:{type:a.Ti.tableRow},transaction:i}),I.sW({store:o.getPropertiesStore(),data:{...l,[g]:o.getBlockTitleStore().getValue()},transaction:i}),x.sO({environment:n,store:o.getBlockTitleStore(),value:void 0,transaction:i}),k.jG({parentStore:f,childStore:o,transaction:i})})),I.sW({store:l,data:{alive:!1},transaction:i}),I.sW({store:d,data:{alive:!1},transaction:i})}function je(e){const{simpleTableStore:t,transaction:n}=e,o=t.getFormat(),r=!Boolean(o.table_block_column_header);S.FH({stores:[t],update:{table_block_column_header:r},transaction:n})}function ze(e){const{simpleTableStore:t,transaction:n}=e,o=t.getFormat(),r=!Boolean(o.table_block_row_header);S.FH({stores:[t],update:{table_block_row_header:r},transaction:n})}function qe(e,t,n){const o=L.Z.state;if(!o.isActive)return;const i="default"===t?void 0:t,{selection:a,simpleTableStore:s}=o;if("row"===a.type){const e=s.getContentStores()[a.start.row];S.FH({stores:[e],update:{block_color:i},transaction:n})}if("column"===a.type){const e=Z.getColumnOrder(s),t=r()(Z.getColumnFormat(s)||{});if(!e)return;const o=e[a.start.col];o in t?t[o].color=i:t[o]={color:i},S.FH({stores:[s],update:{table_block_column_format:t},transaction:n})}F.default.state.phase!==F.SelectionPhase.Selected||e.device.isMobile||C.ZH(e)}function He(e){const{simpleTableStore:t,parentWidth:n,transaction:o}=e,r=Z.getColumnOrder(t);if(!r)return;const i=Z.getColumnFormat(t),a=(n-18)/r.length,s=(0,v.m8)(r.map((e=>[e,{width:a,color:i&&i[e]?i[e].color:void 0}])));S.FH({stores:[t],update:{table_block_column_format:s},transaction:o})}},27534:(e,t,n)=>{n.r(t),n.d(t,{blockSelectionInSimpleTable:()=>x,cloneCellsForDragOverlay:()=>D,columnsHaveData:()=>Z,getCellTextStore:()=>R,getColumnFormat:()=>I,getColumnOrder:()=>S,getHeadersEnabled:()=>C,getNextEditableStoreForSimpleTable:()=>j,getNumberOfColumns:()=>w,getNumberOfRows:()=>k,getNumberOfUnresolvedComments:()=>F,getPagesInCollectionForSimpleTableTransform:()=>N,getPreviousEditableStoreForSimpleTable:()=>L,getSimpleTableCellFromTextSelection:()=>A,getTableResizeState:()=>E,isColumnSelected:()=>T,isPropertyTypeConvertableToSimpleTable:()=>V,isRowSelected:()=>M,isSingleCellSelected:()=>P,renderCellValueForActivity:()=>B,rowsHaveData:()=>O,simpleTableTransformPageLimit:()=>U});var o=n(8848),r=n(42875),i=n(29477),a=n(21202),s=n(23867),l=n(97880),c=n(54642),d=n(42239),u=n(60682),p=n(43250),m=n(14976),f=n(65598),g=n(89086),h=n(24646),v=n(79797),b=n(24666),y=n(84139),_=n(29574);function S(e){var t;return null===(t=e.getFormat())||void 0===t?void 0:t.table_block_column_order}function w(e){var t;return(null===(t=S(e))||void 0===t?void 0:t.length)||0}function k(e){return e.getContentLength()}function I(e){var t;return null===(t=e.getFormat())||void 0===t?void 0:t.table_block_column_format}function C(e){var t,n;return{headerColumn:null==e||null===(t=e.getFormat())||void 0===t?void 0:t.table_block_row_header,headerRow:null==e||null===(n=e.getFormat())||void 0===n?void 0:n.table_block_column_header}}function x(e){const t=["table","table_row"];return e.map((e=>e.getType())).some((e=>e&&t.includes(e)))}function T(e){const{selection:t,columnIndex:n,simpleTableStore:o}=e,r=t.start.col<=n&&n<=t.end.col;return"column"===t.type&&r&&0===t.start.row&&t.end.row===k(o)-1}function M(e){const{selection:t,rowIndex:n,simpleTableStore:o}=e,r=t.start.row<=n&&n<=t.end.row;return"row"===t.type&&r&&0===t.start.col&&t.end.col===w(o)-1}function P(e){return e.start.col===e.end.col&&e.start.row===e.end.row}function A(){const e="editing"===b.default.state.mode&&b.default.state.multiSelection;if(e)return y.Z.findCellFromTextStore(e.start.store)}function R(e){const{simpleTableStore:t,rowIndex:n,columnIndex:o}=e,r=t.getContentStores()[n];if(!r)return;const i=S(t);if(!i)return;const a=i[o];return a?r.getPropertyStore(a):void 0}function D(e){const{cells:t,type:n,theme:r}=e;return t.map((e=>function(e){const{cell:t,type:n,theme:r}=e,i=t.getNode();if(!i)return;const a=d.eN(t.getNode()),s=a.cloned.querySelector(`.${p.Apy}`),l=a.cloned.querySelector(`.${p.f0e}`);"column"===n?(s&&(s.style.left="calc(50% - 15px)",s.style.fill=o.ZP.white,s.style.background=r.simpleTableSelectionBorder),l&&(l.style.visibility="hidden")):(l&&(l.style.top="calc(50% - 15px)",l.style.left="-7px",l.style.fill=o.ZP.white,l.style.background=r.simpleTableSelectionBorder),s&&(s.style.visibility="hidden"));return{cloned:a.cloned,rect:DOMRect.fromRect(a.rect)}}({cell:e,type:n,theme:r}))).filter(l.$K)}function E(e,t){const n=_.Z.state;if(n.isActive&&n.simpleTableStore===e&&(!t||n.resize===t))return n}function B(e){const{environment:t,cellValue:n,spaceId:o,parentStore:r,theme:i}=e;return m.IY({environment:t,textValue:n?{value:n,spaceId:o}:void 0,parentStore:r,disableStyleAnnotations:!0,disableInsertedDeletedAnnotations:!0,disableDateStyleAnnotations:!0,disableHover:!0,disabled:!0,theme:i,emojiType:(0,u.e_)(t),katex:t.KatexStore.getKatex(),formulaValueTypes:[]})}function F(e){const{simpleTableStore:t,environment:n,includeInline:o}=e;return f.Xp(t,{recursivelyLoadAllDiscussions:o,onlyIncludeBlockLevelDiscussions:(0,h.Sx)(n)})}function O(e){const{simpleTableStore:t,lastN:n}=e,o=t.getContentStores(),r=S(t);if(!o||!r)return!1;for(let i=o.length-1;i>Math.max(o.length-1-n,0);i--){const e=o[i].getProperties();if(e&&r.some((t=>t in e&&e[t])))return!0}return!1}function Z(e){const{simpleTableStore:t,lastN:n}=e,o=t.getContentStores(),r=S(t);if(!o||!r)return!1;const i=r.slice(-n);return o.some((e=>{const t=e.getProperties();return t&&i.some((e=>e in t&&t[e]))}))}const V={title:!0,text:!0,url:!0,email:!0,person:!0,number:!0,date:!0,phone_number:!0,select:!0,multi_select:!0,status:!0,auto_increment_id:!0,file:!1,checkbox:!1,relation:!1,rollup:!1,formula:!1,created_by:!1,created_time:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,button:!1,location:!1,verification:!1},U=200;async function N(e){const{environment:t,collectionViewBlockStore:n}=e,o=n.getCollectionViewSourceCollectionStore();if(!o)return[];const[l]=n.getCollectionViewStores(),d={source:{type:"collection",id:o.id,spaceId:(0,s.C)(o.pointer.spaceId)},collectionView:{id:l.id,spaceId:(0,s.C)(l.pointer.spaceId)},loader:{reducers:{results:{type:"results",limit:U+1,loadContentCover:!1}},searchQuery:void 0,userId:t.currentUser.id,userTimeZone:(0,r.r)()}},u=c.queryCollection(t,d,void 0,{src:"simple_tbl_transform"}),p=await(0,i.OI)(1e4,u);if(!p.timeout){const{result:e}=p;if("success"===e.type){const t=e.data.result.reducerResults.results;return(t&&"results"===t.type?t.blockIds:[]).map((e=>v.G.createChildStore(o,{id:e,table:a.iU})))}}return[]}function L(e){let t;if(0===e.getProps().rowIndex){const n=R({simpleTableStore:e.getProps().simpleTableStore,rowIndex:0,columnIndex:0});n&&(t=(0,g.mK)(n))}else t=R({simpleTableStore:e.getProps().simpleTableStore,rowIndex:e.getProps().rowIndex-1,columnIndex:e.getProps().columnIndex});return t}function j(e){let t;const n=k(e.getProps().simpleTableStore);if(e.getProps().rowIndex===n-1){const o=w(e.getProps().simpleTableStore),r=R({simpleTableStore:e.getProps().simpleTableStore,rowIndex:n-1,columnIndex:o-1});r&&(t=(0,g.hn)(r))}else t=R({simpleTableStore:e.getProps().simpleTableStore,rowIndex:e.getProps().rowIndex+1,columnIndex:e.getProps().columnIndex});return t}},50694:(e,t,n)=>{n.d(t,{Wv:()=>_t,fZ:()=>He,HM:()=>r,g$:()=>o});var o=n(27534),r=n(98794),i=n(45697),a=n.n(i),s=n(67294),l=n(83355),c=n(1302),d=n(12137),u=n(52989),p=n(61045),m=n(10906),f=n(23864),g=n(68709),h=n(53336),v=n(79954),b=n(95645),y=n(43250),_=n(12534),S=n(48779),w=n(24646),k=n(34859),I=n(77794);const C=18;var x=n(49085);class T extends x.default{getInitialState(){return{}}setTemporaryFormat(e){this.update((t=>({...t,temporaryFormat:e})))}updateColumnOrder(e){this.update((t=>({...t,temporaryFormat:{...t.temporaryFormat,table_block_column_order:e}})))}}const M=T;var P=n(64359),A=n(5676),R=n(63208),D=n(13991),E=n(480),B=n(86628),F=n(24405),O=n(8848),Z=n(45238),V=n(85893);const U=(0,Z.I)("arrowsOut",{viewBox:"0 0 30 30",svg:(0,V.jsx)("path",{d:"M7.09101 20.6434C7.50813 20.2263 7.49239 19.6124 7.07527 19.1953L6.41418 18.5342L3.51009 15.9449L7.75998 16.0551L12.6237 16.0709C12.8992 16.0787 13.1353 15.9685 13.3242 15.7797C13.7728 15.3311 13.8121 14.7093 13.3714 14.2686C13.1589 14.0561 12.8992 13.938 12.6159 13.938L7.75998 13.9459L3.51009 14.0561L6.42205 11.4589L7.07527 10.8057C7.49239 10.3886 7.52387 9.77473 7.09888 9.34974C6.6739 8.92476 6.06002 8.9405 5.63503 9.36548L1.2671 13.7334C0.464339 14.5362 0.464339 15.4649 1.2671 16.2676L5.63503 20.6356C6.04428 21.0448 6.6739 21.0605 7.09101 20.6434ZM24.3739 20.6592L28.7418 16.2912C29.5446 15.4885 29.5524 14.5519 28.7497 13.7492L24.3818 9.38123C23.9725 8.97198 23.3429 8.95624 22.9179 9.38123C22.5087 9.79047 22.5165 10.4122 22.9336 10.8293L23.5947 11.4904L26.5067 14.0718L22.2489 13.9695L17.3931 13.9459C17.1176 13.938 16.8736 14.0561 16.6847 14.245C16.244 14.6857 16.1968 15.3153 16.6375 15.7561C16.85 15.9685 17.1176 16.0787 17.4009 16.0787L22.2489 16.0787L26.5067 15.9607L23.5947 18.5578L22.9336 19.2189C22.5165 19.636 22.485 20.2499 22.91 20.6749C23.335 21.0999 23.9568 21.0763 24.3739 20.6592Z"})});var N=n(42853),L=n(77734),j=n(73599),z=n(82990),q=n(51454),H=n(9291),W=n(82530),K=n(13966),G=n(23063),$=n(64921),Q=n(52275),Y=n(31945),X=n(78140),J=n(32163),ee=n(72495),te=n(24006),ne=n(26388),oe=n(87279),re=n(95802),ie=n(22294),ae=n(27724),se=n(29574);function le(e){var t;window.__c={n:"ActionBarContent"};const{simpleTableStore:n,rootSizeObserver:o,offset:i,hoverSizeObserver:a}=e,s=(0,E.O7)(),l=(0,F.Fg)(),c=(0,B.VK)((()=>re.C.findScrollToSelectableFromStore(n)),[n]),d=null==c||null===(t=c.getNode())||void 0===t?void 0:t.getBoundingClientRect(),u=(0,B.VK)((()=>o.rect.state.width),[o]),p=(0,B.VK)((()=>a.rect.state.width),[a]),m=(0,B.VK)((()=>Math.min((null==d?void 0:d.width)||0,u,p)+i),[d,u,p,i]);return d?(0,V.jsx)("div",{style:{width:0,position:"absolute",left:m,zIndex:q.t8},onMouseDown:_.$0,children:(0,V.jsx)("div",{style:{position:"relative"},children:(0,V.jsxs)("div",{style:de(l),children:[(0,V.jsx)(ne.ZP,{placement:ne.ug.Top,render:e=>(0,V.jsx)($.Z,{...e,style:ue(l),onClick:()=>{W.createAndCommit({userAction:"SimpleTableActionBar.ActionBarContent",environment:s,perform:e=>{r.fitToPage({simpleTableStore:n,parentWidth:a.rect.state.width,transaction:e})}})},children:U({width:20,fill:l.regularIconColor})}),renderTooltip:()=>(0,V.jsx)(H.FormattedMessage,{defaultMessage:"Fit table to page width",id:"simpleTable.actionBar.fitToPage"})}),(0,V.jsx)(Y.ZP,{popupType:Y.Z4.Popup,originGap:4,renderOrigin:e=>(0,V.jsxs)($.Z,{style:ue(l),...e,children:[(0,V.jsx)(H.FormattedMessage,{id:"simpleTable.actionBar.options",defaultMessage:"Options"}),(0,N.i)({width:10,fill:l.mediumIconColor,marginLeft:4})]}),render:()=>(0,V.jsx)(ce,{simpleTableStore:n})}),(0,V.jsx)(K.Z,{store:n,fadeIn:!1,style:{display:"flex",justifyContent:"center",alignSelf:"center",width:30,height:void 0,padding:"9px 8px"},iconStyle:{fill:l.regularTextColor}})]})})}):null}function ce(e){window.__c={n:"OptionsMenu"};const{simpleTableStore:t}=e,n=(0,E.O7)(),i=(0,F.Fg)(),a=[{key:"header row",action:()=>{W.createAndCommit({userAction:"SimpleTableActionBar.menuItems",environment:n,perform:e=>{r.toggleHeaderRow({simpleTableStore:t,transaction:e})}})},render:e=>(0,V.jsx)(Q.Z,{...e,icon:(0,j.f)({width:16,fill:i.regularIconColor}),title:(0,V.jsx)(H.FormattedMessage,{id:"action.columnHeader.title",defaultMessage:"Header row"}),right:(0,V.jsx)(te.Z,{on:o.getHeadersEnabled(t).headerRow||!1,onClick:e.onClick})})},{key:"header column",action:()=>{W.createAndCommit({userAction:"SimpleTableActionBar.menuItems",environment:n,perform:e=>{r.toggleHeaderColumn({simpleTableStore:t,transaction:e})}})},render:e=>(0,V.jsx)(Q.Z,{...e,icon:(0,L.s)({width:16,fill:i.regularIconColor}),title:(0,V.jsx)(H.FormattedMessage,{id:"SimpleTableActionBar.action.rowHeader.title",defaultMessage:"Header column"}),right:(0,V.jsx)(te.Z,{on:o.getHeadersEnabled(t).headerColumn||!1,onClick:e.onClick})})}];return(0,V.jsx)(X.Z,{menuType:oe.og.Popup,width:240,maxHeight:n.device.isMobile?70:void 0,children:(0,V.jsx)(J.Z,{type:J.i.Vertical,sections:[{key:"appearance section",render:e=>(0,V.jsx)(ee.Z,{...e}),items:a}],initialFocus:void 0})})}function de(e){return{position:"absolute",top:-40,right:0,borderRadius:4,height:32,fontSize:14,lineHeight:1.2,display:"flex",whiteSpace:"nowrap",fontFamily:z.Z.getCompositeFontFamily(D.SP).sans,background:e.popoverBackground,boxShadow:e.mediumBoxShadow}}function ue(e){return{display:"flex",alignItems:"center",padding:"0 8px",borderRight:`1px solid ${O.ZP.whiteWithAlpha(.2)}`,boxShadow:`1px 0 0 ${e.regularDividerColor}`}}const pe=function(e){window.__c={n:"SimpleTableActionBar"};const{disabled:t,canEdit:n,simpleTableStore:o}=e,r=(0,B.VK)((()=>{const e=R.Z.state,t=P.Z.state,n=se.Z.state,r=ie.Z.state,i=ae.default.state,a=e.isActive&&e.simpleTableStore===o,s=1===i.stores.length&&i.stores[0]===o,l=t.isActive&&t.simpleTableStore===o&&"cell"===t.hover.type&&t.hover.resizing,c=n.isActive&&n.simpleTableStore===o;return(a||s)&&!l&&!c&&!r.isKeyboardMode}),[o]);return t||!n?null:(0,V.jsx)(G.Z,{isVisible:r,enterAnimationStyle:{opacity:0},animationStyle:{opacity:1},exitAnimationStyle:{opacity:0},render:()=>(0,V.jsx)(le,{...e})})};var me=n(78429),fe=n(33125),ge=n(893),he=n(80402),ve=n(993),be=n(98104),ye=n(21407),_e=n(68056),Se=n(77907),we=n(24666),ke=n(84139),Ie=n(6695),Ce=n(72126),xe=n(6685),Te=n(89224);const Me=function(e){window.__c={n:"SimpleTableColumnResizer"};const t=(0,s.useRef)(),n=(0,E.O7)(),i=(0,B.VK)((()=>Boolean(o.getTableResizeState(e.simpleTableStore))),[e.simpleTableStore]),{columnIndex:a,simpleTableStore:l,columnID:c,getWidth:d,onTemporaryResize:u,onAccept:p,onCancel:m}=e,f=(0,B.VK)((()=>{const e=P.Z.state;return!!e.isActive&&(e.simpleTableStore===l&&("cell"===e.hover.type&&(!i&&(e.hover.x===a&&(e.hover.showResizer||e.hover.resizing)))))}),[a,i,l]),g=(0,F.yK)((e=>({wrapper:{position:"absolute",right:0,width:0,top:0,flexGrow:0,height:"100%",zIndex:1},innerStyle:{position:"absolute",width:3,marginLeft:-1,marginTop:-1,height:"calc(100% + 2px)",transition:"background 150ms ease 50ms",cursor:i?void 0:"col-resize",background:f?e.simpleTableSelectionBorder:O.ZP.blueWithAlpha(0)}})),[i,f]),h=(0,s.useCallback)((e=>{e.preventDefault();const n=o.getColumnFormat(l);t.current=n&&c in n?n[c]:{},t.current.width=d(),r.setResizing(!0)}),[c,d,l]),v=(0,s.useCallback)((e=>{const t=w(e);t&&u(t)}),[u]),b=(0,s.useCallback)((e=>{const t=w(e);t&&p(t),r.setResizing(!1)}),[p]),_=(0,s.useCallback)((()=>{m(),t.current=void 0,r.setResizing(!1)}),[m]),S=(0,s.useCallback)((()=>{const t=ke.Z.findCellsInColumnFromStore(e.simpleTableStore,e.columnId),o=Ce.oA(t.map((e=>{var t;const n=null===(t=e.getNode())||void 0===t?void 0:t.querySelector(`.${y.Iiy}`);if(n)return function(e){const t=window.getComputedStyle(e),n=e.cloneNode(!0),o=n;o.id="notion-table-cell-shadow",Array.from(t).forEach((e=>o.style.setProperty(e,t.getPropertyValue(e),t.getPropertyPriority(e)))),o.style.opacity="0",o.style.width="100%",o.style.pointerEvents="none",document.body.appendChild(n);const r=o.querySelector(`.${y.qnV}`);if(!r)return void o.remove();r.style.width="",r.style.display="inline-block";const i=window.document.createRange();i.selectNode(r);const a=Te.getRect(i);return o.remove(),null!=a&&a.width?a.width+je:void 0}(n)})));W.createAndCommit({userAction:"SimpleTableColumnResizer.handleDoubleClick",environment:n,perform:t=>{r.resizeColumn({tableBlockColumnFormat:{...Pe(e.format,e.formatStore).table_block_column_format,[e.columnId]:{width:Math.max(...o)}},simpleTableStore:e.simpleTableStore,transaction:t})}})}),[n,e.columnId,e.format,e.formatStore,e.simpleTableStore]);function w(e){var n;if(null!==(n=t.current)&&void 0!==n&&n.width){const n=Math.max(t.current.width+e.diffX,Ie.lw);return{...t.current,width:n}}}return(0,V.jsx)("div",{style:g.wrapper,onMouseMove:()=>r.showResizeBar(!0),onMouseLeave:()=>r.showResizeBar(!1),children:(0,V.jsx)(xe.Z,{onDraggableDragStart:h,onDraggableDragMove:v,onDraggableDragEnd:b,onDraggableDragCancel:_,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:e=>(0,V.jsx)("div",{style:g.innerStyle,onDoubleClick:S,...e})})})};function Pe(e,t){const{temporaryFormat:n}=t;return n||e}const Ae=function(e){window.__c={n:"SimpleTableReorderDropZone"};const{rowIndex:t,columnIndex:n,simpleTableStore:o}=e,r=(0,B.VK)((()=>{const e=A.Z.state;if(e.isActive&&e.simpleTableStore===o&&e.moved&&e.source.index!==e.destIndex)return{destIndex:e.destIndex,sourceIndex:e.source.index,type:e.source.type}}),[o],{useDeepEqual:!0}),{destIndex:i,sourceIndex:a,type:s}=r||{destIndex:0,sourceIndex:0},l=(0,F.yK)((e=>({sharedStyle:{position:"absolute",flexGrow:0,zIndex:2,background:e.simpleTableSelectionBorder},rowStyle:{top:a>i?0:void 0,bottom:a<i?0:void 0,left:-1,width:"calc(100% + 2px)",height:3},columnStyle:{top:-1,left:a>i?0:void 0,right:a<i?0:void 0,width:3,height:"calc(100% + 2px)"}})),[a,i]);return r?"row"===s&&i===t?(0,V.jsx)("div",{style:{...l.sharedStyle,...l.rowStyle}}):"column"===s&&i===n?(0,V.jsx)("div",{style:{...l.sharedStyle,...l.columnStyle}}):null:null};var Re=n(12217),De=n(97880),Ee=n(36610),Be=n(6404),Fe=n(8949),Oe=n(35431);class Ze extends Oe.Z{findSelectorsOfTypeFromStore(e,t){return this.filter((n=>{const o=n.getProps();return o.simpleTableStore===t&&o.type===e}))}}const Ve=new Ze;const Ue=function(e){window.__c={n:"SimpleTableRowColumnSelector"};const t=(0,E.O7)(),n=(0,s.useRef)(),i=(0,s.useRef)(null),a=(0,F.Fg)();(0,fe.c)(Ve,(()=>({getProps:()=>e,getNode:()=>{var e;return(null===(e=i.current)||void 0===e?void 0:e.getNode())??null}})),[e]);const l=()=>{n.current=void 0,r.cancelReorder()},c=n=>{Be.Qn({environment:t,stores:[e.simpleTableStore],left:n.startX,top:n.startY,showInput:!0,actionSectionGroupKey:"simple_table",analyticsFrom:"simple_table_menu"})},d=(0,B.VK)((()=>{const{isMobile:n}=t.device;if(n)return function(e,t,n){const r=R.Z.state;if(!r.isActive)return!1;if(r.simpleTableStore!==e)return!1;const{selection:i}=r;if(o.isSingleCellSelected(i)){if("column"===t)return i.start.col===n;if("row"===t)return i.start.row===n}return!1}(e.simpleTableStore,e.type,e.index);const{isKeyboardMode:r}=ie.Z.state;if(r)return!1;const{simpleTableStore:i,type:a,index:s}=e;if(A.Z.state.isActive)return!1;const l=P.Z.state;if(!l.isActive)return!1;if(l.simpleTableStore!==i)return!1;if(o.getTableResizeState(i))return!1;const c=ae.default.state;if(c.stores[0]===i&&c.phase===ae.SelectionPhase.Selected)return!1;const d=l.hover;return"cell"!==d.type?d.type===a&&d.index===s:"column"===a?d.x===s:"row"===a&&d.y===s}),[t.device,e],{useDeepEqual:!0}),u=e.isSelected||d;return(0,V.jsx)(xe.Z,{ref:i,allowDragWhileTextEditing:!0,onDraggableDragStart:u?o=>{var s;const{type:l}=e;o.preventDefault();const c=null===(s=i.current)||void 0===s||null===(s=s.getNode())||void 0===s?void 0:s.parentNode;if(!(c&&c instanceof Element))return;const d=c.getBoundingClientRect();n.current="column"===l?d.x:d.y;const u="column"===l?o.startX-d.x:o.startY-d.y;r.startReorder({...e,environment:t,theme:a,selectorStartPx:n.current,mouseOffsetPx:u})}:void 0,onDraggableDragMove:u?t=>{const{type:o}=e;if(!n.current)return;const i=A.Z.state;if(!i.isActive)return;const a="column"===o?t.diffX:t.diffY;if(0!==a){const t=n.current+a,o=function(e,t,n){const{delta:o,selectorDragPx:r}=e,i=Ve.findSelectorsOfTypeFromStore(n,t);if(o>0){const e=i.map((e=>{var t;const o=null===(t=e.getNode())||void 0===t?void 0:t.parentNode;if(!(o&&o instanceof Element))return;const r=o.getBoundingClientRect();return"column"===n?null==r?void 0:r.x:null==r?void 0:r.y})).filter(De.$K);e.sort(((e,t)=>e-t));for(let t=e.length-1;t>=0;t--)if(r>e[t])return t;return 0}const a=i.map((e=>{var t;const o=null===(t=e.getNode())||void 0===t?void 0:t.parentNode;if(!(o&&o instanceof Element))return;const r=o.getBoundingClientRect();return"column"===n?r.x+r.width:r.y+r.height})).filter(De.$K);return a.sort(((e,t)=>e-t)),a.filter(De.$K).findIndex((e=>r<e))}({delta:a,selectorDragPx:t+i.source.mouseOffsetPx},e.simpleTableStore,e.type);r.continueReorder({destIndex:o,selectorDragPx:t})}}:void 0,onDraggableDragEnd:u?n=>{const{isMobile:o}=t.device,{simpleTableStore:i,type:a,format:s}=e;W.createAndCommit({userAction:"SimpleTableRowColumnSelector.handleDragEnd",environment:t,perform:e=>{r.completeReorder({event:n,environment:t,simpleTableStore:i,transaction:e,format:s,type:a,onNoChange:o?void 0:c})}}),"row"===a&&Ee.RO(t,{from:"selection_menu",draggedTypes:["table_row"],asCopy:!1}),l()}:void 0,onDraggableDragCancel:u?()=>{l()}:void 0,disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:t=>(0,V.jsx)(Ne,{enabled:u,isSelected:e.isSelected,draggableEvents:t,type:e.type,index:e.index,simpleTableStore:e.simpleTableStore})})};function Ne(e){window.__c={n:"SimpleTableButton"};const{type:t,enabled:n,isSelected:o,draggableEvents:i}=e,a=(0,E.O7)(),s=(0,B.VK)((()=>A.Z.state.isActive),[],{useDeepEqual:!0}),l=()=>{const{simpleTableStore:t,type:n,index:o}=e;r.hoverRowColumn({type:n,simpleTableStore:t,index:o})},c=()=>{r.clearHover()},d=(0,F.yK)((t=>({base:{opacity:n?1:0,pointerEvents:n?void 0:"none",transition:"opacity 150ms ease",fill:t.lightIconColor,position:"absolute",display:"flex",alignItems:"center",cursor:s?"grab":"pointer",justifyContent:"center",borderRadius:4,background:t.whiteButtonBackground,boxShadow:e.isSelected?void 0:t.lightBoxShadow,zIndex:4},column:{...Le(e.isSelected,t),top:-8,left:"calc(50% - 13px)",height:16,width:26,padding:"2px 4px"},row:{...Le(e.isSelected,t),top:"calc(50% - 13px)",left:-8,width:16,height:26,padding:"4px 2px"},hovered:{background:t.whiteButtonHoveredBackground,...Le(e.isSelected,t)},pressed:{...Le(e.isSelected,t,!0)}})),[n,s,e.isSelected]);return(0,V.jsx)($.Z,{className:"column"===t?y.Apy:y.f0e,style:{...d.base,...d[t]},hoveredStyle:d.hovered,pressedStyle:d.pressed,onClick:t=>function(e,t,n,o,i){const{isMobile:a}=i.device;Fe.Z.state.isActive||Be.Qn({environment:i,stores:[o],left:e.clientX,top:e.clientY,showInput:!0,actionSectionGroupKey:"simple_table",analyticsFrom:"simple_table_menu"});a&&("column"===t?r.selectColumn({environment:i,index:n,simpleTableStore:o}):r.selectRow({environment:i,index:n,simpleTableStore:o}))}(t,e.type,e.index,e.simpleTableStore,a),onTouchStart:l,onTouchEnd:c,onMouseEnter:l,onMouseLeave:c,...i,disallowTabbing:!0,children:(0,Re.D)({fill:o?O.ZP.white:void 0,width:14,height:14,transform:"column"===t?"rotate(90deg)":void 0})})}function Le(e,t){return e||arguments.length>2&&void 0!==arguments[2]&&arguments[2]?{background:t.simpleTableSelectionBorder}:void 0}const je=1;function ze(e){window.__c={n:"SimpleTableCell"};const t=(0,s.useRef)(null),n=(0,s.useRef)(null);(0,fe.c)(ke.Z,(()=>({getProps:()=>e,getNode:()=>t.current})),[e,t.current]);const{value:i}=(0,Se.useDependency)(Se.deps.exportJsxRenderer),{value:a}=(0,Se.useDependency)(Se.deps.markdownLinkifyIt),{columnID:l,columnIndex:c,simpleTableStore:d,rowIndex:u,textStore:p,store:m,format:f,disabled:g,canEdit:h,legacyTransclusionParent:v,selection:b}=e,S=(0,E.Fy)(),w=(0,E.O7)(),k=!g&&h,I=(0,B.VK)((()=>e.formatStore.state.temporaryFormat||e.format),[e.format,e.formatStore]),C=e=>{const t=R.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:r}=t,s=o.getColumnOrder(r);if(!s)return;ge.JG({environment:w,event:e,markdownLinkifyIt:a});const l="editing"===we.default.state.mode&&we.default.state.multiSelection;l&&!(0,_e.iG)(l)||he.qn({environment:w,simpleTableStore:r,selection:n,currentRows:r.getContentStores(),columnOrder:s,event:e,exportJsxRenderer:i})},x=(0,B.VK)((()=>{if(!m)return!1;const e=A.Z.state;if(!e.isActive||e.simpleTableStore!==d||!e.moved)return!1;const{type:t,id:n}=e.source;return"column"===t?n===l:n===m.id}),[l,d,m]),{headerColumn:T,headerRow:M}=(0,B.VK)((()=>function(e){return o.getHeadersEnabled(e)}(e.simpleTableStore)),[e.simpleTableStore]),{blockColor:P,columnFormat:D}=(0,B.VK)((()=>({blockColor:null==m?void 0:m.getFormat().block_color,columnFormat:o.getColumnFormat(d)})),[m,d]),Z=(0,F.yK)((e=>{var t,n;const o=function(e){const{columnFormat:t,rowIndex:n,columnIndex:o,columnID:r,theme:i,headerColumn:a,headerRow:s,blockColor:l}=e;let c=l||"default";if(t&&r in t){var d;const e=null===(d=t[r])||void 0===d?void 0:d.color;e&&(c=e)}if(0===n&&s||0===o&&a)return"default"!==c?{...(0,O.fi)(c,i),fontWeight:z.Z.fontWeight.medium}:{background:i.tableHeaderRowColumnBackground,fontWeight:z.Z.fontWeight.medium};return(0,O.fi)(c,i)}({columnFormat:D,rowIndex:u,columnIndex:c,headerColumn:T,headerRow:M,columnID:l,blockColor:P,theme:e}),r=I.table_block_column_format;return{cell:{...o,border:`${je}px solid ${e.tableDividerColor}`,position:"relative",verticalAlign:"top",textAlign:"start",minWidth:(null==r||null===(t=r[l])||void 0===t?void 0:t.width)??120,maxWidth:(null==r||null===(n=r[l])||void 0===n?void 0:n.width)??240,minHeight:32},contents:{width:"100%",height:"100%",...o},text:{padding:"7px 9px",backgroundColor:"transparent",fontSize:14,lineHeight:"20px"}}}),[P,D,l,c,I.table_block_column_format,T,M,u]),{isColumnSelected:U,isRowSelected:N}=(0,B.VK)((()=>b?{isColumnSelected:o.isColumnSelected({selection:b,columnIndex:c,simpleTableStore:d}),isRowSelected:o.isRowSelected({selection:b,rowIndex:u,simpleTableStore:d})}:{isColumnSelected:!1,isRowSelected:!1}),[c,u,b,d]),L=(0,V.jsxs)(V.Fragment,{children:[x&&(0,V.jsx)("div",{style:Z.contents}),(0,V.jsxs)("div",{className:y.Iiy,style:{visibility:x?"hidden":void 0},children:[m&&0===u&&k&&(0,V.jsx)(Ue,{index:c,type:"column",simpleTableStore:d,isSelected:U,id:l,format:f,rowStore:m}),m&&0===c&&k&&(0,V.jsx)(Ue,{index:u,type:"row",simpleTableStore:d,isSelected:N,id:m.id,format:f,rowStore:m}),p?(0,V.jsx)(ye.Z,{ref:n,disabled:g,store:p,disableSlashCommands:!0,onClick:t=>{const{rowIndex:n,columnIndex:o,simpleTableStore:i,disabled:a,canEdit:s}=e;a||s&&t.shiftKey&&r.expandCellSelection({environment:w,rowIndex:n,columnIndex:o,simpleTableStore:i})},onEnter:t=>{var o;if(t.preventDefault(),null===(o=n.current)||void 0===o||!o.isComposing())if(S.isMobile){const{disabled:t,canEdit:n}=e;if(t||!n)return;const o=we.default.state;"editing"===o.mode&&W.createAndCommit({userAction:"SimpleTableCell.mobileEnter",environment:w,perform:e=>{ve.hJ({environment:w,string:"\n",multiSelection:o.multiSelection,disableMentions:!0,disableDateMentions:!0,disableDateReminderMentions:!0,disableSlashCommands:!0,disableEmojiCommands:!0,transaction:e})}})}else{"editing"===we.default.state.mode&&r.handleUpDownKey({environment:w,direction:"down",bypassExistingTextSelection:!0})}},onTab:e=>{e.preventDefault(),r.handleLeftRightKey({environment:w,direction:"right",bypassExistingTextSelection:!0})},onUntab:e=>{e.preventDefault(),r.handleLeftRightKey({environment:w,direction:"left",bypassExistingTextSelection:!0})},onEsc:t=>{e.disabled||(t.preventDefault(),be.ZH(w))},onCut:t=>{const{disabled:n,canEdit:o}=e;if(n||!o)return;C(t);const i="editing"===we.default.state.mode&&we.default.state.multiSelection;i&&!(0,_e.iG)(i)?W.createAndCommit({userAction:"SimpleTableCell.handleCut",environment:w,perform:e=>{ve.pz({environment:w,multiSelection:i,transaction:e})}}):W.createAndCommit({userAction:"SimpleTableCell.handleCut",environment:w,perform:e=>{r.clearSelectedCell({environment:w,transaction:e})}})},onCopy:C,style:Z.text,pasteBehavior:"inline",className:y.qnV,disableDrag:!0,legacyTransclusionParent:v}):(0,V.jsx)("div",{style:Z.text,children:" "}),!S.isMobile&&k&&(0,V.jsx)(Me,{format:e.format,formatStore:e.formatStore,columnId:e.columnID,columnIndex:c,columnID:l,simpleTableStore:d,getWidth:()=>{var e;return(null===(e=t.current)||void 0===e?void 0:e.getBoundingClientRect().width)||0},onTemporaryResize:t=>{const{formatStore:n}=e;n.setTemporaryFormat({...I,table_block_column_format:{...f.table_block_column_format,[l]:t}})},onAccept:()=>{const{simpleTableStore:t,formatStore:n}=e,o=I.table_block_column_format;W.createAndCommit({userAction:"SimpleTableCell.handleColumnResizeAccept",environment:w,perform:e=>{r.resizeColumn({tableBlockColumnFormat:o||{},simpleTableStore:t,transaction:e})}}),n.setTemporaryFormat(void 0)},onCancel:()=>{const{formatStore:t}=e;t.setTemporaryFormat(void 0)}}),!S.isMobile&&k&&(0,V.jsx)(Ae,{simpleTableStore:d,rowIndex:u,columnIndex:c})]})]}),j={style:Z.cell,onClick:t=>{const{columnIndex:n,simpleTableStore:o,rowIndex:i,disabled:a,canEdit:s}=e;a||(0,_.ZP)({event:t,context:_.Af.EditorClick,callback:()=>{s&&t.shiftKey?r.expandCellSelection({environment:w,rowIndex:i,columnIndex:n,simpleTableStore:o}):s?r.selectCellAndSetCursor({environment:w,rowIndex:i,columnIndex:n,simpleTableStore:o}):r.selectCell({environment:w,rowIndex:i,columnIndex:n,simpleTableStore:o})}})},onContextMenu:t=>{const{columnIndex:n,simpleTableStore:o,rowIndex:i,disabled:a}=e;a||(0,_.ZP)({event:t,context:_.Af.EditorContextMenu,callback:()=>{r.selectCell({environment:w,rowIndex:i,columnIndex:n,simpleTableStore:o})}})},onMouseEnter:()=>{const{rowIndex:t,columnIndex:n,simpleTableStore:o,disabled:i}=e;i||r.hoverCell({x:n,y:t,simpleTableStore:o})},onMouseLeave:()=>{e.disabled||r.clearHover()}};return M&&0===u?(0,V.jsx)("th",{ref:t,scope:"col",...j,children:L}):T&&0===c?(0,V.jsx)("th",{ref:t,scope:"row",...j,children:L}):(0,V.jsx)("td",{ref:t,...j,children:L})}class qe extends b.Z{constructor(){super(...arguments),this.isLegacyTransclusionStore=this.createComputedStore((()=>Boolean(this.props.rowStore)&&this.props.rowStore.getParentId()!==this.props.store.id)),this.styleStore=this.createComputedStore((()=>(0,me.H)()&&this.isLegacyTransclusionStore.state?{border:"3px dashed deeppink"}:{}))}renderPersisted(){const{columnOrder:e,store:t,rowIndex:n,rowStore:o,selection:r,formatStore:i,disabled:a}=this.props;return e?(0,V.jsx)("tr",{className:y.M_0,style:this.styleStore.state,children:e.map(((e,s)=>(0,V.jsx)(ze,{disabled:a,canEdit:this.canEdit(),columnID:e,columnIndex:s,rowIndex:n,store:o,simpleTableStore:t,selection:r,formatStore:i,format:t.getFormat(),textStore:null==o?void 0:o.getPropertyStore(e),legacyTransclusionParent:this.isLegacyTransclusionStore.state?this.props.store:void 0},e)))}):null}}const He=qe;var We=n(37524),Ke=n(8958),Ge=n(55367),$e=n(24677),Qe=n(3386),Ye=n(52689);function Xe(e){window.__c={n:"SimpleTableKeyboardArea"};const{store:t,children:n,selection:i,disabled:a,canEdit:l}=e,c=(0,E.O7)(),d=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault(),r.handleLeftRightKey({environment:c,direction:"left",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[c]),u=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault(),r.handleLeftRightKey({environment:c,direction:"right",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[c]),p=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault(),r.handleUpDownKey({environment:c,direction:"up",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[c]),m=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault(),r.handleUpDownKey({environment:c,direction:"down",bypassExistingTextSelection:!1,expandSelection:e.shiftKey})}),[c]),f=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault();const t=R.Z.state;if(t.isActive){const{selection:e,simpleTableStore:n}=t;o.isSingleCellSelected(e)&&r.selectCellAndSetCursor({environment:c,rowIndex:e.start.row,columnIndex:e.start.col,simpleTableStore:n})}}),[c]),g=(0,s.useCallback)((e=>{var t;null===(t=e.preventDefault)||void 0===t||t.call(e);const n=R.Z.state;if(!n.isActive)return;const{selection:i,simpleTableStore:a}=n;o.isSingleCellSelected(i)&&i.end.row===o.getNumberOfRows(a)-1&&W.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleShiftEnter",environment:c,perform:e=>{const t=i.end.row+1;r.insertRow({environment:c,transaction:e,index:t,simpleTableStore:a}),r.selectCellAndSetCursor({environment:c,rowIndex:t,columnIndex:i.start.col,simpleTableStore:a})}})}),[c]),h=(0,s.useCallback)((e=>{e.preventDefault&&e.preventDefault();const n=R.Z.state;if(!n.isActive)return;const{selection:i,simpleTableStore:a}=n;o.getSimpleTableCellFromTextSelection()?be.ZH(c):o.isSingleCellSelected(i)?r.selectRow({environment:c,index:i.start.row,simpleTableStore:a}):(r.clearSelection(),$e.Z5({environment:c,stores:[t]}))}),[c,t]),v=(0,s.useCallback)((e=>{W.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleDelete",environment:c,perform:e=>{r.handleDelete({environment:c,transaction:e})}})}),[c]),b=(0,s.useCallback)((e=>{!e.key||e.metaKey||e.ctrlKey||(ie.Z.setKeyboardMode(!0),W.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleKeypress",environment:c,perform:t=>{r.handleKeypress({environment:c,transaction:t,key:e.key})}}))}),[c]),{value:y}=(0,Se.useDependency)(Se.deps.exportJsxRenderer),_=(0,s.useCallback)((e=>{const t=R.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:r}=t,i=o.getColumnOrder(r);i&&he.qn({environment:c,simpleTableStore:r,selection:n,currentRows:r.getContentStores(),columnOrder:i,event:e,exportJsxRenderer:y})}),[c,y]),S=(0,s.useCallback)((e=>{!a&&l&&(_(e),W.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleCut",environment:c,perform:e=>{r.clearSelectionContents({environment:c,transaction:e})}}))}),[c,a,l,_]),{value:w}=(0,Se.useDependency)(Se.deps.markdownLinkifyIt),{value:k}=(0,Se.useDependency)(Se.deps.tinyMceMicrosoftWordPasteFilter),I=(0,s.useCallback)((e=>{if(a||!l)return;const t=R.Z.state;if(!t.isActive)return;const{selection:n,simpleTableStore:r}=t,i=o.getColumnOrder(r);i&&W.createAndCommit({userAction:"SimpleTableSelectionOverlay.handlePaste",environment:c,perform:t=>{he.j0({environment:c,simpleTableStore:r,selection:n,currentRows:r.getContentStores(),columnOrder:i,event:e,transaction:t,markdownLinkifyIt:w,tinyMceMicrosoftWordPasteFilter:k})}})}),[c,a,l,w,k]),C=(0,s.useCallback)((e=>{e.preventDefault(),W.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleDuplicate",environment:c,perform:e=>{r.handleDuplicate({environment:c,transaction:e})}})}),[c]),x=(0,s.useCallback)(((e,n)=>{!a&&l&&(n.preventDefault(),W.createAndCommit({userAction:"SimpleTableSelectionOverlay.handleAnnotation",environment:c,perform:n=>{r.annotateSimpleTableSelection({environment:c,simpleTableStore:t,annotation:e,transaction:n})}}))}),[c,a,l,t]),T=(0,s.useCallback)((e=>x(["h",Ye.Z.state.color],e)),[x]),M=(0,s.useCallback)((e=>x(["b"],e)),[x]),P=(0,s.useCallback)((e=>x(["i"],e)),[x]),A=(0,s.useCallback)((e=>x(["s"],e)),[x]),D=(0,s.useCallback)((e=>x(["_"],e)),[x]),B=(0,s.useCallback)((e=>x(["c"],e)),[x]);return(0,V.jsx)(Qe.Z,{debugName:"SimpleTableKeyboardArea",capture:Boolean(i)&&!a&&l,onLeft:d,onRight:u,onUntab:d,onTab:u,onUp:p,onDown:m,onEnter:f,onShiftEnter:g,onEsc:h,onDelete:v,onBackspace:v,onKeypress:b,onCut:S,onCopy:_,onPaste:I,onDuplicate:C,onToggleHighlight:T,onToggleBold:M,onToggleItalics:P,onToggleStrike:A,onToggleUnderline:D,onToggleCode:B,children:n})}var Je=n(6740),et=n(47453),tt=n(71644);const nt=(0,H.defineMessages)({tooltipContent:{id:"simpleTable.resizer.dimensions",defaultMessage:"{num_columns} × {num_rows}"}});const ot=function(e){window.__c={n:"SimpleTableResizer"};const t=(0,s.useRef)(null),n=(0,E.O7)(),{store:i,type:a,formatStore:l}=e,[c,d]=(0,s.useState)(!1),u=()=>{W.createAndCommit({userAction:"SimpleTableResizer.handleResizeClick",environment:n,perform:e=>{"row"!==a&&r.extendColumns({count:1,simpleTableStore:i,transaction:e}),"column"!==a&&r.extendRows({environment:n,count:1,simpleTableStore:i,transaction:e,analyticsFrom:"resize_click"})}})},p=(0,B.VK)((()=>Boolean(o.getTableResizeState(i,a))),[i,a]),m=(0,B.VK)((()=>{const e=o.getTableResizeState(i,a);return null==e?void 0:e.tooltipOriginRect}),[i,a]),f=(0,B.VK)((()=>{const e=i.getFormat(),{temporaryFormat:t}=l.state;return(t||e).table_block_column_order}),[l,i]),g=(0,B.VK)((()=>{const t=o.getTableResizeState(e.store);return t?t.rowsDelta:0}),[e.store]),h=(0,B.VK)((()=>{const t=P.Z.state,n=o.getTableResizeState(e.store,e.type);return!ie.Z.state.isKeyboardMode&&(function(e,t,n){if(!e.isActive||e.simpleTableStore!==n)return!1;const{hover:r}=e;if("cell"===r.type){const e=r.y===o.getNumberOfRows(n)-1,i=r.x===o.getNumberOfColumns(n)-1;return"row"===t?e:("column"===t||e)&&i}return"resizer"===r.type&&r.resizer===t}(t,e.type,e.store)||Boolean(n))||c}),[c,e.store,e.type]),v=(0,F.yK)((e=>({button:{height:"100%",width:"100%",display:"flex",alignItems:"center",justifyContent:"center",background:p?e.simpleTableSelectionBorder:e.lightDividerColor},plusIcon:{width:12,height:12,fill:p?O.ZP.white:e.mediumIconColor,padding:"auto"},outer:{},inner:{display:"flex",flexDirection:"row"===a?"row":void 0,width:"100%",height:"100%",opacity:h?1:0,pointerEvents:h?void 0:"none",transition:"opacity 150ms ease 50ms"}})),[p,h,a]);return(0,V.jsx)("div",{style:at(e.type),onFocus:e=>{const t=e.target;t instanceof HTMLElement&&(0,Je.E)(t)&&d(!0)},onBlur:()=>{d(!1)},onMouseEnter:()=>{const{store:t,type:n}=e;r.hoverResizer({simpleTableStore:t,resizer:n})},onMouseLeave:()=>{r.clearHover()},ref:t,children:(0,V.jsx)(xe.Z,{onDraggableDragStart:e=>{var n;e.preventDefault();const o=null===(n=t.current)||void 0===n?void 0:n.getBoundingClientRect();se.Z.setState({isActive:!0,simpleTableStore:i,resize:a,rowsDelta:0,columnsDelta:0,tooltipOriginRect:o}),l.setTemporaryFormat(i.getFormat())},onDraggableDragMove:n=>{var s;const c=o.getTableResizeState(i,a);if(!c)return;const d=null===(s=t.current)||void 0===s?void 0:s.getBoundingClientRect();if("row"!==a){const t=n.diffX>0?Math.ceil((n.diffX-30)/120):Math.floor((n.diffX+30)/120);if(t<0&&o.columnsHaveData({simpleTableStore:i,lastN:Math.abs(t)}))return;se.Z.setState({...c,columnsDelta:t,tooltipOriginRect:d});const a=function(t){const{store:n}=e,r=f||[],i=o.getColumnOrder(n)||[];if(t>0){const e=t-(r.length-i.length);if(e>0){const t=[...Array(e).keys()].map((e=>(0,tt.ZP)()));return[...r,...t]}return r.slice(0,r.length+e)}return i.slice(0,Math.max(1,i.length-Math.abs(t)))}(t);l.updateColumnOrder(a),r.updateRowSelectionOnResize(a.length-1)}if("column"!==a){const e=n.diffY>0?Math.ceil((n.diffY-8)/32):Math.max(-(o.getNumberOfRows(i)-1),Math.floor((n.diffY+8)/32));if(e<0&&o.rowsHaveData({simpleTableStore:i,lastN:Math.abs(e)}))return;se.Z.setState({...c,rowsDelta:e,tooltipOriginRect:d}),r.updateColumnSelectionOnResize(o.getNumberOfRows(i)+e-1)}},onDraggableDragEnd:t=>{const s=o.getNumberOfColumns(i);W.createAndCommit({userAction:"SimpleTableResizer.handleDragEnd",environment:n,perform:e=>{"row"!==a&&f&&(f.length>s?r.extendColumns({count:f.length-s,simpleTableStore:i,transaction:e}):f.length<s&&r.contractColumns({simpleTableStore:i,columnOrder:f,transaction:e})),"column"!==a&&(g>0?r.extendRows({environment:n,count:g,simpleTableStore:i,transaction:e,analyticsFrom:"resize_drag"}):g<0&&r.contractRows({numRowsToDelete:Math.abs(g),simpleTableStore:i,transaction:e}))}}),it(e.formatStore)},onDraggableDragCancel:()=>{it(e.formatStore)},disableVerticalEdgeScroll:!0,disableHorizontalEdgeScroll:!0,render:t=>(0,V.jsx)("div",{style:v.inner,...t,children:(0,V.jsx)(ne.ZP,{renderTooltip:()=>(0,V.jsx)(rt,{type:a,isResizing:p,columnOrder:f||[],rowCount:o.getNumberOfRows(i)+g}),placement:ne.ug.Bottom,delayThreshold:0,originRect:m,forceVisibleState:!0===p||void 0,render:t=>(0,V.jsx)($.Z,{onClick:u,style:st(!0,e.type),hoveredStyle:st(!0,e.type),...t,children:(0,V.jsx)("div",{style:v.button,children:(0,et.R)(v.plusIcon)})})})})})})};function rt(e){window.__c={n:"ResizerTooltip"};const t=(0,H.useIntl)(),{type:n,isResizing:o,columnOrder:r,rowCount:i}=e,a=(0,F.yK)((e=>({wrapper:{display:"flex",flexDirection:"column",alignItems:"center",color:e.mediumInvertedTextColor},boldText:{color:e.regularInvertedTextColor}})),[]);if(!o){const e=e=>(0,V.jsx)("b",{style:a.boldText,children:e});return(0,V.jsxs)("div",{style:a.wrapper,children:[(0,V.jsxs)("div",{children:["row"===n&&(0,V.jsx)(H.FormattedMessage,{id:"simpleTable.resizer.tooltipRow",defaultMessage:"<b>Click</b> to add a new row",values:{b:e}}),"column"===n&&(0,V.jsx)(H.FormattedMessage,{id:"simpleTable.resizer.tooltipColumn",defaultMessage:"<b>Click</b> to add a new column",values:{b:e}}),"corner"===n&&(0,V.jsx)(H.FormattedMessage,{id:"simpleTable.resizer.tooltipCorner",defaultMessage:"<b>Click</b> to add a new row and column",values:{b:e}})]}),(0,V.jsxs)("div",{children:["row"===n&&(0,V.jsx)(H.FormattedMessage,{id:"simpleTable.resizer.tooltipSubtitleRow",defaultMessage:"<b>Drag</b> to quickly add or remove rows",values:{b:e}}),"column"===n&&(0,V.jsx)(H.FormattedMessage,{id:"simpleTable.resizer.tooltipSubtitleColumn",defaultMessage:"<b>Drag</b> to quickly add or remove columns",values:{b:e}}),"corner"===n&&(0,V.jsx)(H.FormattedMessage,{id:"simpleTable.resizer.tooltipSubtitleCorner",defaultMessage:"<b>Drag</b> to quickly add or remove rows and columns",values:{b:e}})]})]})}const s=r||[],l=t.formatMessage(nt.tooltipContent,{num_columns:s.length,num_rows:i});return(0,V.jsx)("div",{children:l})}function it(e){e.reset(),se.Z.reset()}function at(e){const t={position:"absolute",display:"flex"};return"row"===e?{...t,flexDirection:"row",bottom:-C,left:0,right:0}:"column"===e?{...t,right:-C,top:0,bottom:0}:{...t,bottom:-C,right:-C}}function st(e,t){const n=e?16:20,o="100%";return"column"===t?{flex:1,width:n,height:o,cursor:"col-resize",borderRadius:4,overflow:"hidden"}:"row"===t?{flex:1,width:o,height:n,cursor:"row-resize",borderRadius:4,overflow:"hidden"}:{flex:1,width:n,height:n,cursor:"nwse-resize",borderRadius:"50%",overflow:"hidden"}}const lt=9,ct=26;function dt(e){window.__c={n:"SimpleTableSelectionDragHandle"};const{position:t,onDraggableDragStart:n,onDraggableDragMove:o,onDraggableDragEnd:r,onDraggableDragCancel:i}=e,a=(0,E.Fy)().isMobile?ct:lt,s=(0,F.yK)((e=>({tapArea:{position:"absolute",top:"top-left"===t?-a/2:void 0,left:"top-left"===t?-a/2:void 0,bottom:"bottom-right"===t?-a/2:void 0,right:"bottom-right"===t?-a/2:void 0,width:a,height:a,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",background:"transparent",pointerEvents:"auto",cursor:"nwse-resize",zIndex:10},dragHandle:{width:lt,height:lt,border:`2px solid ${O.ZP.blueWithAlpha(.57)}`,background:e.contentBackground,borderRadius:"50%"}})),[t,a]);return(0,V.jsx)(xe.Z,{allowDragWhileTextEditing:!0,onDraggableDragStart:n,onDraggableDragMove:o,onDraggableDragEnd:r,onDraggableDragCancel:i,render:e=>(0,V.jsx)("div",{...e,style:s.tapArea,children:(0,V.jsx)("div",{style:s.dragHandle})})})}const ut=function(e){window.__c={n:"SimpleTableSelectionOverlay"};const t=(0,E.O7)(),n=(0,s.useRef)(null),o=(0,s.useRef)(void 0),{children:i,store:a,selection:l,formatStore:c,disabled:u,canEdit:p,columnOrder:m}=e,f=(0,B.VK)((()=>{const{disabled:n,canEdit:o}=e,{device:r}=t;return!(n||!o||r.isMobile)&&!(Ge.ZP.state.isDragging||function(e){const t=P.Z.state;if(!t.isActive)return!1;if(t.simpleTableStore!==e)return!1;if("cell"!==t.hover.type)return!1;return t.hover.resizing}(e.store)||function(e){const t=A.Z.state;return t.isActive&&t.simpleTableStore===e}(e.store))}),[t,e]),g=(0,B.SI)((()=>{if(l&&n.current&&m)return pt({cell:l.start,tableElement:n.current,store:a,columnOrder:m})}),[m,l,a],{useDeepEqual:!0}),h=(0,B.SI)((()=>{if(l&&n.current&&m)return pt({cell:l.end,tableElement:n.current,store:a,columnOrder:m})}),[m,l,a],{useDeepEqual:!0}),v=(0,B.Kw)(g),b=(0,B.Kw)(h);(0,s.useEffect)((()=>{const e=()=>{g.enqueueRecompute(),h.enqueueRecompute()};if(n.current){const t=new MutationObserver(e);return t.observe(n.current,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),()=>t.disconnect()}}),[h,g]);const y=(0,B.VK)((()=>{const t=A.Z.state;if(!t.isActive)return;if(t.simpleTableStore!==e.store)return;if(!n.current)return;const{source:o,selectorDragPx:r,moved:i}=t;if(o.selectorStartPx===r&&!i)return;if(!o.draggedCells[0])return;const a=o.draggedCells[0].rect,s=n.current.getBoundingClientRect(),l="column"===o.type?0:(0,d.Z)(r-s.top,-8,s.height-32);return{left:"column"===o.type?(0,d.Z)(r-s.left,-a.width/3,s.width-2/3*a.width):0,top:l,draggedCells:o.draggedCells,type:o.type}}),[e.store]),_=(0,B.VK)((()=>!e.disabled&&(v&&b||y)),[y,e.disabled,b,v]);return(0,V.jsx)(Xe,{store:a,selection:l,disabled:u,canEdit:p,children:(0,V.jsx)(xe.Z,{ref:e=>n.current=null==e?void 0:e.getNode(),onDraggableDragStart:t=>{e.canEdit&&(t.shiftKey&&e.selection?o.current=e.selection.start:o.current=vt(t.startX,t.startY,e.store))},onDraggableDragMove:n=>{if(!e.canEdit||!o.current)return;const i=o.current,a=vt(n.currentX,n.currentY,e.store);(0,We.bp)(i,a)?r.selectCell({environment:t,rowIndex:i.row,columnIndex:i.col,simpleTableStore:e.store}):r.selectMultiCell({environment:t,start:i,end:a,simpleTableStore:e.store})},render:e=>(0,V.jsxs)("div",{style:{position:l||f?"relative":void 0},...e,children:[i,_&&(0,V.jsxs)("div",{style:{position:"absolute",top:0,left:0,pointerEvents:"none"},children:[(0,V.jsx)(mt,{store:a,dragState:y,tableElement:n.current}),v&&b&&(0,V.jsx)(ft,{startRect:v,endRect:b,dragState:y,canEdit:p,selection:l,store:a})]}),f&&(0,V.jsxs)(V.Fragment,{children:[(0,V.jsx)(ot,{store:a,type:"column",formatStore:c},"column"),(0,V.jsx)(ot,{store:a,type:"row",formatStore:c},"row"),(0,V.jsx)(ot,{store:a,type:"corner",formatStore:c},"corner")]})]})})})};function pt(e){const{cell:t,tableElement:n,store:o,columnOrder:r}=e,i=o.getContentStores()[t.row],a=ke.Z.findCellsInRowFromStore(i,o,t.row),s=(l=a,c=r[t.col],null===(d=l.find((e=>e.getProps().columnID===c)))||void 0===d||null===(d=d.getNode())||void 0===d?void 0:d.getBoundingClientRect());var l,c,d;if(!s)return;const u=n.getBoundingClientRect(),p=s.top-u.top,m=s.left-u.left,f=s.width,g=function(e){return Math.max(...e.map((e=>{var t;return(null===(t=e.getNode())||void 0===t||null===(t=t.getBoundingClientRect())||void 0===t?void 0:t.height)||0})))}(a);return new DOMRect(m-2,p-2,f+4,g+4)}function mt(e){const{store:t,tableElement:n,dragState:o}=e;if(!o||!n)return null;const r=n.getBoundingClientRect(),{draggedCells:i,type:a,left:s,top:l}=o;for(const c of i)c.rect="column"===a?new DOMRect(0,c.rect.top-r.top,c.rect.width,c.rect.height):new DOMRect(c.rect.left-r.left,0,c.rect.width,c.rect.height);return(0,V.jsx)("div",{style:{position:"absolute",left:s,top:l,zIndex:5},children:(0,V.jsx)(Ke.Z,{store:t,ghostElement:i,opacity:.9},"simple_table_drag")})}function ft(e){window.__c={n:"SelectionOverlay"};const{startRect:t,endRect:n,dragState:o,selection:i,store:a}=e,l=(0,E.O7)(),c=(0,E.Fy)(),d=Math.min(t.left,n.left),u=Math.min(t.top,n.top),p=Math.max(t.right,n.right),m=Math.max(t.top+t.height,n.top+n.height),f=(0,s.useRef)(void 0);function g(e){if(!i)return;const{start:t,end:n}=i;f.current={col:"top-left"===e?Math.max(t.col,n.col):Math.min(t.col,n.col),row:"top-left"===e?Math.max(t.row,n.row):Math.min(t.row,n.row)}}const h=t=>{if(!f.current)return;const n=vt(t.currentX,t.currentY,a);r.selectMultiCell({environment:l,start:f.current,end:n,simpleTableStore:e.store})},v=(0,F.yK)((e=>({base:{position:"absolute",left:o&&"column"===o.type?o.left:d+1.5,top:o&&"row"===o.type?o.top:u+1.5,width:p-d-3,height:m-u-3},wrapper:{zIndex:o?4:2,backgroundColor:o?e.contentBackground:void 0,opacity:o?.9:void 0,boxShadow:o?e.mediumBoxShadow:void 0,borderRadius:2},inner:{border:`solid ${e.simpleTableSelectionBorder}`,borderWidth:2,borderRadius:2,zIndex:o?5:3}})),[3,o,m,p,d,u]);return t&&n?(0,V.jsxs)("div",{className:y.y4j,children:[(0,V.jsx)("div",{style:{...v.base,...v.wrapper}}),(0,V.jsx)("div",{style:{...v.base,...v.inner},children:e.canEdit&&(0,V.jsxs)(V.Fragment,{children:[!c.isMobile&&(0,V.jsx)(dt,{position:"top-left",onDraggableDragStart:()=>g("top-left"),onDraggableDragMove:h}),(0,V.jsx)(dt,{position:"bottom-right",onDraggableDragStart:()=>g("bottom-right"),onDraggableDragMove:h})]})})]}):null}function gt(e,t){const n=ke.Z.findCellsInRowFromStore(void 0,t,0).sort(((e,t)=>e.getProps().columnIndex-t.getProps().columnIndex));for(let o=0;o<n.length;o++){if(e<=n[o].getNode().getBoundingClientRect().right)return o}return n.length-1}function ht(e,t){const n=ke.Z.findCellsInColumnFromStore(t,0).sort(((e,t)=>e.getProps().rowIndex-t.getProps().rowIndex));for(let o=0;o<n.length;o++){if(e<=n[o].getNode().getBoundingClientRect().bottom)return o}return n.length-1}function vt(e,t,n){return{col:gt(e,n),row:ht(t,n)}}const bt=C;class yt extends b.Z{constructor(){super(...arguments),this.storeTypes={formatStore:M},this.rootSizeObserver=new I.E,this.hoverSizeObserver=new I.E,this.nodeRef=s.createRef(),this.handleMount=e=>{e&&this.rootSizeObserver.observe(e)},this.handleHoverMount=e=>{const t=null==e?void 0:e.getNode();t&&this.hoverSizeObserver.observe(t)},this.getSelectableStyle=this.createComputedStore((()=>{const{device:e}=this.environment,t={width:"100%",position:"relative",alignSelf:"center"};return(e.isMobile||this.isInColumnList()||!this.isRootOrDirectChild())&&(t.maxWidth=this.numberOfComments.state?"calc(100% - 40px)":"100%"),t})),this.columnOrder=this.createComputedStore((()=>{const{store:e}=this.props,t=e.getFormat(),{temporaryFormat:n}=this.stores.formatStore.state;return(n||t).table_block_column_order})),this.simpleTableSelection=this.createComputedStore((()=>{const e=R.Z.state,{store:t}=this.props;if(e.isActive&&e.simpleTableStore===t){var n;const r=(null===(n=this.columnOrder.state)||void 0===n?void 0:n.length)||o.getNumberOfColumns(t),i=o.getNumberOfRows(t)+this.numTempRows.state,{selection:a}=e;return{start:{col:(0,d.Z)(a.start.col,0,r-1),row:(0,d.Z)(a.start.row,0,i-1)},end:{col:(0,d.Z)(a.end.col,0,r-1),row:(0,d.Z)(a.end.row,0,i-1)},type:a.type}}}),!0),this.numTempRows=this.createComputedStore((()=>{const e=o.getTableResizeState(this.props.store);return e?e.rowsDelta:0})),this.resizeCursor=this.createComputedStore((()=>{const{store:e}=this.props,t=P.Z.state;if(t.isActive&&t.simpleTableStore===e){const{hover:e}=t;if("cell"===e.type&&e.resizing)return"col-resize"}const n=o.getTableResizeState(e);if(n){if("column"===n.resize)return"col-resize";if("row"===n.resize)return"row-resize";if("corner"===n.resize)return"nwse-resize"}const r=A.Z.state;if(r.isActive&&r.simpleTableStore===e)return"grab"})),this.numberOfBlockComments=this.createComputedStore((()=>o.getNumberOfUnresolvedComments({simpleTableStore:this.props.store,environment:this.environment,includeInline:!1})),!0),this.numberOfComments=this.createComputedStore((()=>o.getNumberOfUnresolvedComments({simpleTableStore:this.props.store,environment:this.environment,includeInline:!0})),!0)}willUnmount(){this.rootSizeObserver.destroy(),this.hoverSizeObserver.destroy()}renderPersisted(){var e,t;const{store:n,disabled:o,disableHoverMenu:r}=this.props,i=this.numberOfComments.state,a=this.numberOfBlockComments.state,s=i>0&&0===a,l=(0,V.jsx)(f.Z,{disableCommentMenu:this.props.disableCommentMenu,hideContent:this.props.hideContent,store:this.props.store,recursivelyLoadAllDiscussions:!this.marginCommentsVisible.state,hideIfSidebarOrMarginCommentsVisible:s}),c=Boolean(l)&&i>0||this.isInColumnList(),d=(0,V.jsx)(h.Z,{type:k.Z.X,preventType:p.Q7(this.environment),style:{flexGrow:1,marginLeft:-8},showLeftRightOverlay:!0,leftOverlayStyle:{left:c?-8:-8-((null===(e=this.getLeftRightPadding())||void 0===e?void 0:e.paddingLeft)||0),top:8,bottom:bt},rightOverlayStyle:{top:8,bottom:bt},children:this.renderContent(c)}),m=(0,S.Fn)(this.environment),b=!o&&("comment_only"===this.props.store.getRole()||"comment"===(null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state.permission))&&this.environment.currentUser.isLoggedIn();return(0,V.jsxs)(g.p,{allowSelectionWithin:!0,style:this.getStyle(),ref:this.handleMount,onMouseDown:e=>function(e,t){const{device:n}=t;n.isMobile||(0,_.ZP)({event:e,context:_.Af.EditorMouseDown,callback:()=>{e.preventDefault(),u.AI({environment:t,target:e.target,startX:e.clientX,startY:e.clientY,showSelectionRect:!0,preventSelectStores:[],allowVerticalEdgeScroll:!0,allowHorizontalEdgeScroll:!0})}})}(e,this.environment),children:[c?(0,V.jsx)(v.Z,{store:n,shouldShowHoverMenu:!r&&(this.canEdit()||m),shouldShowCommentMenu:b,style:this.getSelectableStyle.state,analyticsName:"page_content",ref:this.handleHoverMount,children:d}):d,l,(0,V.jsx)(pe,{disabled:o,canEdit:this.canEdit(),simpleTableStore:n,rootSizeObserver:this.rootSizeObserver,offset:c?0:this.getOffset()||0,hoverSizeObserver:this.hoverSizeObserver})]})}renderContent(e){var t;const{store:n,disabled:r,disableHoverMenu:i}=this.props,a=n.getContentStores(),s=this.columnOrder.state;if(!s)return;const l=this.numTempRows.state,c=l<0?a.length+l:a.length,d=this.simpleTableSelection.state,{device:u}=this.environment,p=!u.isPhone,m=!r&&("comment_only"===this.props.store.getRole()||"comment"===(null===(t=this.pageContext)||void 0===t?void 0:t.publicEditModeStore.state.permission))&&this.environment.currentUser.isLoggedIn(),f=(0,V.jsx)("div",{style:{display:"flex"},children:(0,V.jsx)("div",{style:{paddingTop:8,paddingLeft:8,paddingBottom:bt,paddingRight:bt},children:(0,V.jsx)(v.Z,{store:n,shouldShowHalo:!0,canSelect:!0,canDropLeft:p,canDropRight:p,canDropAbove:!1,canDropBelow:!1,aboveDropZoneMargin:4,belowDropZoneMargin:4,analyticsName:"page_content",shouldShowDropZone:!0,style:{position:"relative"},className:y.OE$,shouldShowCommentMenu:m,nodeRef:this.nodeRef??void 0,children:(0,V.jsx)(ut,{store:n,selection:d,columnOrder:s,formatStore:this.stores.formatStore,disabled:r,canEdit:this.canEdit(),children:(0,V.jsx)("table",{children:(0,V.jsxs)("tbody",{ref:this.nodeRef,children:[a.slice(0,c).map(((e,t)=>(0,V.jsx)(He,{rowIndex:t,rowStore:e,store:n,disabled:r,columnOrder:s,selection:d,formatStore:this.stores.formatStore},e.id))),l>0&&[...Array(l).keys()].map(((e,t)=>(0,V.jsx)(He,{rowIndex:o.getNumberOfRows(n)+t,store:n,rowStore:void 0,disabled:r,columnOrder:s,selection:d,formatStore:this.stores.formatStore},t)))]})})})})})}),g=(0,S.Fn)(this.environment);return(0,V.jsx)("div",{className:y.fOh,style:{cursor:this.resizeCursor.state,...e?{paddingRight:20}:this.getLeftRightPadding()},children:e?f:(0,V.jsx)(v.Z,{store:n,shouldShowCommentMenu:m,shouldShowHoverMenu:!i&&(this.canEdit()||g),style:this.getSelectableStyle.state,analyticsName:"page_content",ref:this.handleHoverMount,children:f})})}handleCreated(){c.default.afterNextFlush((()=>{r.selectCellAndSetCursor({environment:this.environment,rowIndex:0,columnIndex:0,simpleTableStore:this.props.store})}))}getStyle(){const{store:e}=this.props;return{...this.getBlockColorStyle(),...this.props.style,position:"relative",display:"flex",...(0,m.Ks)(e)&&{width:(0,w.$3)(this.environment),position:"sticky",left:0}}}isInColumnList(){return this.context.isInColumnList}getLeftRightPadding(){const{store:e}=this.props;return(0,m.Bs)({environment:this.environment,store:e,isFullScreen:!1,sizeObserver:this.rootSizeObserver})}getOffset(){var e;return null===(e=this.getLeftRightPadding())||void 0===e?void 0:e.paddingLeft}}yt.contextTypes={...l.w,isInColumnList:a().any};const _t=yt},84139:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(35431);class r extends o.Z{findCellsInRowFromStore(e,t,n){return this.filter((o=>{const r=o.getProps();return e?r.store===e:r.simpleTableStore===t&&r.rowIndex===n}))}findCellsInColumnFromStore(e,t){return this.filter((n=>{const o=n.getProps();return o.simpleTableStore===e&&("number"==typeof t&&o.columnIndex===t||"string"==typeof t&&o.columnID===t)}))}findCellFromTextStore(e){return this.find((t=>t.getProps().textStore===e))}findCellFromElement(e,t){return this.find((n=>n.getProps().simpleTableStore===t&&n.getNode()===e))}}const i=new r},64359:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),r=n(72126);class i extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return r.d9(this.state)}}const a=new i},5676:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),r=n(72126);class i extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return r.d9(this.state)}}const a=new i},29574:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),r=n(72126);class i extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return r.d9(this.state)}}const a=new i},63208:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),r=n(72126);class i extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return r.d9(this.state)}}const a=new i},84693:(e,t,n)=>{n.d(t,{Y3:()=>Z,y6:()=>T,G$:()=>V,lR:()=>F,GF:()=>O,Q6:()=>B});n(21703),n(57658);var o=n(72126),r=n(73360),i=n(606),a=n(21202),s=n(80873),l=n(35092),c=n(24681),d=n(97880);const u={table:a.iU,recordColumnTypes:{id:s.Z.UUID,space_id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,type:s.Z.String,properties:s.Z.JSON,content:s.Z.StringArray,discussions:s.Z.StringArray,view_ids:s.Z.StringArray,collection_id:s.Z.UUID,permissions:s.Z.JSON,created_time:s.Z.Number,last_edited_time:s.Z.Number,copied_from:s.Z.UUID,file_ids:s.Z.StringArray,ignore_block_count:s.Z.Boolean,is_template:s.Z.Boolean,parent_id:s.Z.UUID,parent_table:s.Z.String,alive:s.Z.Boolean,moved:s.Z.JSON,format:s.Z.JSON,created_by:s.Z.UUID,last_edited_by:s.Z.UUID,created_by_table:s.Z.String,created_by_id:s.Z.UUID,last_edited_by_table:s.Z.String,last_edited_by_id:s.Z.UUID,content_classification:s.Z.String},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_last_access_timestamp:s.Z.Number,meta_role:s.Z.String}};const p={table:n(6287).v,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,name:s.Z.JSON,description:s.Z.JSON,icon:s.Z.String,cover:s.Z.String,schema:s.Z.JSON,format:s.Z.JSON,parent_id:s.Z.UUID,parent_table:s.Z.String,alive:s.Z.Boolean,file_ids:s.Z.StringArray,template_pages:s.Z.StringArray,copied_from:s.Z.UUID,migrated:s.Z.Boolean,space_id:s.Z.UUID,deleted_schema:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const m={table:n(13493).n,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,type:s.Z.String,name:s.Z.String,page_sort:s.Z.UUIDArray,parent_id:s.Z.UUID,parent_table:s.Z.String,alive:s.Z.Boolean,format:s.Z.JSON,query2:s.Z.JSON,space_id:s.Z.UUID},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const f={table:n(70279).x_,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,parent_id:s.Z.UUID,parent_table:s.Z.String,text:s.Z.JSON,created_time:s.Z.Number,last_edited_time:s.Z.Number,alive:s.Z.Boolean,created_by_table:s.Z.String,created_by_id:s.Z.UUID,space_id:s.Z.UUID,content:s.Z.UUIDArray,reactions:s.Z.UUIDArray},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const g={table:n(33709).qF,recordColumnTypes:{id:s.Z.UUID,type:s.Z.String,version:s.Z.Number,last_version:s.Z.Number,parent_id:s.Z.UUID,parent_table:s.Z.String,context:s.Z.JSON,resolved:s.Z.Boolean,comments:s.Z.StringArray,space_id:s.Z.UUID},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const h={table:n(65311).uX,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,user_id:s.Z.UUID,activity_id:s.Z.UUID,received:s.Z.Boolean,read:s.Z.Boolean,visited:s.Z.Boolean,emailed:s.Z.Boolean,invalid:s.Z.Boolean,space_id:s.Z.UUID,navigable_block_id:s.Z.UUID,collection_id:s.Z.UUID,discussion_id:s.Z.UUID,type:s.Z.String,end_time:s.Z.String,channel:s.Z.String,archived_at:s.Z.Number},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const v={table:n(19889).KJ,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,email:s.Z.String,given_name:s.Z.String,family_name:s.Z.String,profile_photo:s.Z.String,onboarding_completed:s.Z.Boolean,mobile_onboarding_completed:s.Z.Boolean,clipper_onboarding_completed:s.Z.Boolean,reverify:s.Z.Boolean,name:s.Z.String,is_banned:s.Z.Boolean,suspended_time:s.Z.Number},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const b={table:n(80396).yo,recordColumnTypes:{id:s.Z.UUID,space_id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,created_time:s.Z.Number,parent_id:s.Z.UUID,parent_table:s.Z.String,icon:s.Z.String,actors:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const y={table:n(15047).bx,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,name:s.Z.String,permissions:s.Z.JSON,permission_groups:s.Z.JSON,email_domains:s.Z.StringArray,pages:s.Z.StringArray,icon:s.Z.String,disable_public_access:s.Z.Boolean,disable_public_access_requests:s.Z.Boolean,disable_guests:s.Z.Boolean,disable_move_to_space:s.Z.Boolean,disable_export:s.Z.Boolean,disable_space_page_edits:s.Z.Boolean,beta_enabled:s.Z.Boolean,created_time:s.Z.Number,last_edited_time:s.Z.Number,deleted_by:s.Z.UUID,created_by_table:s.Z.String,created_by_id:s.Z.UUID,last_edited_by_table:s.Z.String,last_edited_by_id:s.Z.UUID,admin_disable_public_access:s.Z.Boolean,space_pages:s.Z.UUIDArray,plan_type:s.Z.String,invite_link_enabled:s.Z.Boolean,initial_use_cases:s.Z.String,public_home_page:s.Z.String,bot_settings:s.Z.JSON,settings:s.Z.JSON,subscription_tier:s.Z.String,disable_team_creation:s.Z.Boolean,overdue_subscription:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const _={table:n(77858).zU,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,space_id:s.Z.UUID,bookmarked_pages:s.Z.StringArray,shared_pages:s.Z.StringArray,visited_templates:s.Z.StringArray,sidebar_hidden_templates:s.Z.StringArray,notify_mobile:s.Z.Boolean,notify_desktop:s.Z.Boolean,notify_email:s.Z.Boolean,notify_email_always:s.Z.Boolean,created_getting_started:s.Z.Boolean,parent_id:s.Z.UUID,parent_table:s.Z.String,alive:s.Z.Boolean,created_onboarding_templates:s.Z.Boolean,private_pages:s.Z.UUIDArray,joined:s.Z.Boolean,joined_teams:s.Z.UUIDArray,settings:s.Z.JSON,ai_suggestions:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const S={table:n(29369).e0,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,space_id:s.Z.UUID,name:s.Z.String,description:s.Z.String,icon:s.Z.String,created_time:s.Z.Number,created_by_table:s.Z.String,created_by_id:s.Z.UUID,last_edited_time:s.Z.Number,last_edited_by_table:s.Z.String,last_edited_by_id:s.Z.UUID,archived_by:s.Z.UUID,archived_at:s.Z.Number,team_pages:s.Z.UUIDArray,pinned_pages:s.Z.UUIDArray,parent_id:s.Z.UUID,parent_table:s.Z.String,settings:s.Z.JSON,is_default:s.Z.Boolean,membership:s.Z.JSON,permissions:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const w={table:n(66079).dx,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,space_views:s.Z.StringArray,space_view_pointers:s.Z.JSON,left_spaces:s.Z.StringArray,deleted_email:s.Z.String},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}};const k={table:n(28182).Sr,recordColumnTypes:{id:s.Z.UUID,version:s.Z.Number,last_version:s.Z.Number,settings:s.Z.JSON},metaColumnTypes:{meta_user_id:s.Z.UUID,meta_role:s.Z.String}},I=[u,y,_,w,v,m,p,S,k,h,f,g,b],C=new Set(I.map((e=>e.table))),x=Object.keys({record_table:!0,record_id:!0,record_value:!0,space_id:!0,timestamp:!0,parent_table:!0,parent_id:!0,importance:!0,user_id:!0});async function T(e,t){await(0,l.G$)({connection:e,statements:[{sql:"\n\t\t\t\tUPDATE records SET user_id = ? WHERE user_id is null\n\t\t\t\t",args:[t]}],queryName:"backfillRecordsWithUserId"})}function M(e){const t=o.vM(e.records,(e=>e.pointer.table)),n=[];return Object.entries(t).forEach((t=>{let[r,i]=t;const a=I.find((e=>e.table===r));if(!a)return;const s=(0,d.Yd)(a.recordColumnTypes),c=(0,d.Yd)(a.metaColumnTypes),u=[...s,...c];o.yo(i,Math.floor(l.mz/u.length)).forEach((t=>{const i=`(${u.join(",")})`,a=Array(t.length).fill(`(${"?, ".repeat(u.length-1)}?)`).join(",");let l;l=e.maybeStaleRecords&&u.includes("version")?`INSERT INTO ${r} ${i} VALUES ${a}`.concat("ON CONFLICT (id, meta_user_id) DO UPDATE SET").concat("\n").concat(u.map((e=>`${e} = excluded.${e}`)).join(",")).concat("\n").concat(`WHERE excluded.version > ${r}.version`):`INSERT OR REPLACE INTO ${r} ${i} VALUES ${a}`;const p=o.xH(t.map((e=>{let{value:t,timestamp:n,userId:o}=e;if(!t)return[];const r=t.value;if(!r)return[];const i=s.map((e=>function(e){if(null==e)return null;if("string"==typeof e||"number"==typeof e)return e;if("boolean"==typeof e)return e?1:0;return JSON.stringify(e)}((0,d.qg)(r,e)?r[e]:void 0))),a=c.map((e=>{switch(e){case"meta_user_id":return o;case"meta_role":return t.role;case"meta_last_access_timestamp":return n;default:throw new Error(`Unknown meta column ${e}`)}}));return i.concat(a)})));n.push({sql:l,args:p})}))})),n}function P(e){const[t,n]=o.uK(e.records,(e=>U(e))),i=M({records:t,maybeStaleRecords:e.maybeStaleRecords}),a=function(e){const{records:t,maybeStaleRecords:n}=e;return o.yo(t,Math.floor(l.mz/x.length)).map((e=>{let t=`\n\t\t\tINSERT INTO records\n\t\t\t(\n\t\t\t\trecord_table,\n\t\t\t\trecord_id,\n\t\t\t\trecord_value,\n\t\t\t\ttimestamp,\n\t\t\t\tparent_table,\n\t\t\t\tparent_id,\n\t\t\t\timportance,\n\t\t\t\tuser_id,\n\t\t\t\tspace_id\n\t\t\t)\n\t\t\tVALUES ${Array(e.length).fill("(?, ?, ?, ?, ?, ?, ?, ?, ?)").join(",")}`;return t=n?t.concat("\n\t\t\t\tON CONFLICT (record_table, record_id, user_id) DO UPDATE SET\n\t\t\t\t\trecord_value =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.record_value\n\t\t\t\t\t\tELSE records.record_value\n\t\t\t\t\t\tEND,\n\t\t\t\t\ttimestamp =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.timestamp\n\t\t\t\t\t\tELSE records.timestamp\n\t\t\t\t\t\tEND,\n\t\t\t\t\tparent_table =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.parent_table\n\t\t\t\t\t\tELSE records.parent_table\n\t\t\t\t\t\tEND,\n\t\t\t\t\tparent_id =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.parent_id\n\t\t\t\t\t\tELSE records.parent_id\n\t\t\t\t\t\tEND,\n\t\t\t\t\timportance =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.importance\n\t\t\t\t\t\tELSE records.importance\n\t\t\t\t\t\tEND,\n\t\t\t\t\tuser_id =\n\t\t\t\t\t\tCASE WHEN json_extract(excluded.record_value, '$.value.version') > json_extract(records.record_value, '$.value.version')\n\t\t\t\t\t\tTHEN excluded.user_id\n\t\t\t\t\t\tELSE excluded.user_id\n\t\t\t\t\t\tEND,\n\t\t\t\t\t-- space_id never changes.\n\t\t\t\t\tspace_id = COALESCE(records.space_id, excluded.space_id)"):t.concat("\n\t\t\t\tON CONFLICT (record_table, record_id, user_id) DO UPDATE SET\n\t\t\t\t\trecord_value = excluded.record_value,\n\t\t\t\t\ttimestamp = excluded.timestamp,\n\t\t\t\t\tparent_table = excluded.parent_table,\n\t\t\t\t\tparent_id = excluded.parent_id,\n\t\t\t\t\timportance = excluded.importance,\n\t\t\t\t\tuser_id = excluded.user_id,\n\t\t\t\t\t-- space_id never changes.\n\t\t\t\t\tspace_id = COALESCE(records.space_id, excluded.space_id)"),{sql:t,args:o.xH(e.map((e=>{let{pointer:t,value:n,timestamp:o,importance:i,userId:a}=e,s=null,c=null;return n&&n.value&&(0,r.oK)(n.value)&&(s=n.value.parent_id,c=n.value.parent_table),[t.table,t.id,(0,l.gI)(n),o,c,s,"number"==typeof i?i:null,a,t.spaceId||null]})))}}))}({records:n,maybeStaleRecords:e.maybeStaleRecords});return[...A(t),...R(n.filter((e=>C.has(e.pointer.table)))),...i,...a]}function A(e){return o.yo(e,Math.floor(l.mz/(2*e.length))).map((e=>{const t=c.v.or(e.map((e=>c.v`(records.record_id = ${e.pointer.id} AND records.user_id = ${e.userId})`)));return c.v`DELETE FROM records WHERE ${t}`.asWrite()}))}function R(e){const t=o.vM(e,(e=>e.pointer.table)),n=[];return Object.entries(t).forEach((e=>{let[t,r]=e;o.yo(r,Math.floor(l.mz/(2*r.length))).forEach((e=>{const o=c.v.or(e.map((e=>c.v`(id = ${e.pointer.id} AND meta_user_id = ${e.userId})`)));n.push(c.v`DELETE FROM ${c.v.ident(t)} WHERE ${o}`.asWrite())}))})),n}async function D(e,t){if(0===t.length)return[];const n=o.vM(t,(e=>e.pointer.table)),r=[];Object.entries(n).forEach((t=>{let[n,a]=t;const s=I.find((e=>e.table===n));if(!s)return;const c=Array(a.length).fill("(id = ? AND meta_user_id = ?)").join(" OR "),d=o.VS(a,(e=>{let{pointer:{table:t,id:n},userId:o}=e;return[n,o]}));r.push(async function(){const[t]=await(0,l.G$)({connection:e,statements:[{sql:`\n\t\t\t\tSELECT * FROM ${n}\n\t\t\t\tWHERE ${c}`,args:d,getData:!0}],queryName:"getRecordsFromSeparateTables"});return t.data.map((e=>function(e,t,n){return{pointer:i.dr.fromPointerLike({table:e,id:t.id,spaceId:t.space_id||void 0}),value:{role:t.meta_role,value:E(t,n)},timestamp:t.meta_last_access_timestamp,importance:0,userId:t.meta_user_id}}(n,e,s)))}())}));const a=await Promise.all(r);return o.xH(a)}function E(e,t){const n={};return(0,d.Yd)(t.recordColumnTypes).forEach((o=>{const r=t.recordColumnTypes[o];if(null!==e[o])switch(r){case s.Z.UUID:case s.Z.String:case s.Z.Number:n[o]=e[o];break;case s.Z.StringArray:case s.Z.JSON:n[o]=JSON.parse(e[o]);break;case s.Z.XML:n[o]=e[o];break;case s.Z.UUIDArray:n[o]=JSON.parse(e[o]);break;case s.Z.Boolean:n[o]=1===e[o];break;case s.Z.CIDR:n[o]=e[o];break;case s.Z.NumberArray:n[o]=JSON.parse(e[o]);break;default:(0,d.t1)(r)}})),n}async function B(e,t){const[n,r]=o.uK(t,(e=>C.has(e.pointer.table))),a=await D(e,n),s=new Set(a.map((e=>i.P2.toKey({pointer:e.pointer,userId:e.userId})))),c=n.filter((e=>!s.has(i.P2.toKey(e)))),d=await async function(e,t){if(0===t.length)return[];const n=Array(t.length).fill("(record_table = ? AND record_id = ? AND user_id = ?)").join(" OR "),r=o.VS(t,(e=>{let{pointer:{table:t,id:n},userId:o}=e;return[t,n,o]})),[a]=await(0,l.G$)({connection:e,statements:[{sql:`\n\t\t\t\tSELECT * FROM records\n\t\t\t\tWHERE ${n}`,args:r,getData:!0}],queryName:"getRecordsFromRecordsTable"});return a.data.map((e=>({pointer:i.dr.fromPointerLike({table:e.record_table,id:e.record_id,spaceId:e.space_id||void 0}),value:JSON.parse(e.record_value),timestamp:e.timestamp,importance:"number"==typeof e.importance?e.importance:void 0,userId:e.user_id})))}(e,r.concat(c)),u=d.filter((e=>!U(e)));return a.concat(u)}async function F(e,t){const n=c.v`
  SELECT * FROM block
  WHERE parent_table = ${t.parent.table}
  AND parent_id = ${t.parent.id}
  AND meta_user_id = ${t.userId}
  `.asRead(),o=c.v`
  UPDATE block
  SET meta_last_access_timestamp = ${t.timestamp}
  WHERE parent_table = ${t.parent.table}
  AND parent_id = ${t.parent.id}
  AND meta_user_id = ${t.userId}
  `.asWrite(),[r]=await(0,l.G$)({connection:e,statements:[n,o],queryName:"getBlocksWithParent"});return r.data.map((e=>({pointer:i.dr.fromPointerLike({table:a.iU,id:e.id,spaceId:e.space_id||void 0}),value:{role:e.meta_role,value:E(e,u)},userId:t.userId})))}async function O(e,t){const n=c.v`
    WITH RECURSIVE page_blocks AS (
      SELECT * FROM block
      WHERE id = ${t.page.id}
      AND meta_user_id = ${t.userId}

      UNION

      SELECT block.*
      FROM
        block INDEXED BY block_parent_id,
        page_blocks
      WHERE
      (
        page_blocks.id = ${t.page.id}
        OR page_blocks.type NOT IN ('page', 'toggle')
      )
      AND block.parent_table = 'block'
      AND block.parent_id = page_blocks.id
      AND block.meta_user_id = ${t.userId}
    )
    SELECT * FROM page_blocks
    `,o=await n.all(e,"getPageBlocksByParent");return 0===o.length?[]:o.map((e=>({pointer:i.dr.fromPointerLike({table:a.iU,id:e.id,spaceId:e.space_id||void 0}),value:{role:e.meta_role,value:E(e,u)},userId:t.userId})))}async function Z(e,t,n){const o=n.filter((e=>"set"===e.type&&!e.maybeStaleRecord)),r=n.filter((e=>"set"===e.type&&e.maybeStaleRecord)),i=n.filter((e=>{let{type:t}=e;return"access"===t})),s=n.filter((e=>{let{type:t}=e;return"delete"===t})),d=[];if(i.forEach((e=>{const t=e.record.pointer.table;U(e.record)?t===a.iU&&d.push(c.v`
	        UPDATE block
	        SET meta_last_access_timestamp = ${e.record.timestamp}
	        WHERE id = ${e.record.pointer.id}
	        AND meta_user_id = ${e.record.userId}
	        `.asWrite()):d.push({sql:"UPDATE records\n          SET timestamp = ?\n          WHERE record_table = ?\n          AND record_id = ?\n          AND user_id = ?",args:[e.record.timestamp,t,e.record.pointer.id,e.record.userId]})})),o.length>0||r.length>0){if(o.length>0){const e=o.map((e=>e.record));d.push(...P({records:e,maybeStaleRecords:!1}))}if(r.length>0){const e=r.map((e=>e.record));d.push(...P({records:e,maybeStaleRecords:!0}))}d.push(c.v`
			DELETE FROM records
			WHERE rowid IN (
				SELECT rowid FROM records
				ORDER BY importance DESC, timestamp DESC
				LIMIT -1
				OFFSET ${t}
			)
			`.asWrite()),d.push(c.v`
			DELETE FROM block
			WHERE rowid in (
				SELECT rowid FROM block
				ORDER BY meta_last_access_timestamp DESC
				LIMIT -1
				OFFSET ${t}
			)
			`.asWrite())}if(s.length>0){const e=s.map((e=>e.record));d.push(...function(e){const t=R(e.filter((e=>C.has(e.pointer.table)))),n=A(e);return t.concat(n)}(e))}0!==d.length&&await(0,l.G$)({connection:e,statements:d,queryName:"applyRecordCacheOperations"})}async function V(e){await async function(e){const t=[];C.forEach((e=>{t.push(c.v`DELETE FROM ${c.v.ident(e)}`.asWrite())})),await(0,l.G$)({connection:e,statements:t,queryName:"deleteAllCachedRecordsFromSeparateTables"})}(e),await async function(e){await(0,l.sf)({connection:e,sql:"DELETE FROM records",queryName:"deleteAllCachedRecordsFromRecordsTable"})}(e)}function U(e){return C.has(e.pointer.table)&&void 0!==e.value&&void 0!==e.value.value}},4023:(e,t,n)=>{n.d(t,{u:()=>o,v:()=>r});let o=function(e){return e[e.Top=0]="Top",e[e.Bottom=1]="Bottom",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Center=4]="Center",e}({}),r=function(e){return e[e.Start=0]="Start",e[e.Center=1]="Center",e[e.End=2]="End",e}({})},70726:(e,t,n)=>{n.d(t,{Z:()=>r});var o=function(e){return e[e.Preview=0]="Preview",e[e.Mention=1]="Mention",e[e.Link=2]="Link",e}(o||{});const r=o},34859:(e,t,n)=>{n.d(t,{Z:()=>r});var o=function(e){return e[e.All=0]="All",e[e.X=1]="X",e[e.Y=2]="Y",e[e.None=3]="None",e}(o||{});const r=o},83960:(e,t,n)=>{n.d(t,{T:()=>o,l:()=>r});const o={localLanguagePreferenceKey:"CodeBlockDefaultLanguage",localCodeWrapPreferenceKey:"CodeBlockDefaultCodeWrap",defaultLanguage:"JavaScript",defaultCodePreviewFormat:"code"},r={localSizePreferenceKey:"QuoteBlockDefaultSize"}},96198:(e,t,n)=>{n.d(t,{O:()=>o});const o=44},15723:(e,t,n)=>{n.d(t,{Ep:()=>a,Kr:()=>u,MU:()=>f,TF:()=>l,bM:()=>i,dQ:()=>p,iL:()=>r,jn:()=>m,kK:()=>d,kL:()=>c,uh:()=>s});var o=n(72126);class r{static from(e){return new r(e.left,e.top,e.width,e.height)}constructor(e,t,n,o){this.x=e,this.y=t,this.width=n,this.height=o,this.top=this.height<0?this.y+this.height:this.y,this.bottom=this.height<0?this.y:this.y+this.height,this.left=this.width<0?this.x+this.width:this.x,this.right=this.width<0?this.x:this.x+this.width}toJSON(){return{...this}}}const i=new r(0,0,0,0);function a(e){return Boolean(e&&(o.hj(e.top)||o.hj(e.left)))}function s(e,t,n){return e.left<=t&&t<=e.right&&e.top<=n&&n<=e.bottom}function l(e,t){return e.left<=t.left&&e.right>=t.right}function c(e,t){return e.top<=t.top&&e.bottom>=t.bottom}function d(e,t){return!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)}function u(e,t){return!(e.right<=t.left||t.right<=e.left)}function p(e,t){return!(e.bottom<=t.top||t.bottom<=e.top)}function m(e,t){return new r(e.left-t,e.top-t,e.width+2*t,e.height+2*t)}function f(e){const t=e.top+e.height/2,n=e.left+e.width/2;return new r(n,t,0,0)}},12252:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),r=n(72126);class i extends o.default{constructor(){super(...arguments),this.pause=()=>{this.setState({active:!1,onActive:[]})},this.resume=()=>{this.state.onActive.map((e=>e())),this.setState({active:!0,onActive:[]})}}getInitialState(){return{active:!0,onActive:[]}}whenActive(e){this.state.active?e():this.setState({...this.state,onActive:r.jj([...this.state.onActive,e])})}}const a=new i},80736:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{loaded:!1,loading:!1}}}const i=new r},58455:(e,t,n)=>{n.r(t),n.d(t,{default:()=>s});var o=n(49085),r=n(4615),i=n(95477);class a extends o.default{constructor(){super(...arguments),this.verboseAnalytics=i.default.isAdminMode||false}getInitialState(){return{isLoaded:!1,isLoggingEnabled:!1,isAmplitudeEnabled:!1,isSegmentEnabled:!1,isZendeskEnabled:!1,isIntercomEnabled:!1,intercomAppId:void 0,intercomUserHash:void 0,noIntercomUserId:!1,isSprigEnabled:!1,zendeskToken:void 0}}shouldRefresh(e){return!this.state.isLoaded||Boolean(e)!==Boolean(this.state.user_id)||Boolean(e&&this.state.user_id&&(0,r.cj)(this.state.user_id)!==(0,r.cj)(e))}}const s=new a},51:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{}}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state.publicPageData)))}}const i=new r},92425:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{}}getSharedPagesState(e){const{userId:t,spaceId:n}=e;let o=this.state[t];o||(o={},this.state[t]=o);return o[n]}setSharedPagesState(e){const{userId:t,spaceId:n,state:o}=e;let r=this.state[t];r||(r={},this.state[t]=r),r[n]=o,this.emit()}}const i=new r},30021:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(53809),r=n(30548);const i=new o.D({key:"appearanceSettingStorageKey",namespace:r.$p,important:!0,trackingType:"necessary"})},21273:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),r=n(38823),i=(n(95477),n(77080));class a extends o.default{getInitialState(){return new r.m({getEligibleGroup:()=>"control",isAiEnabled:()=>!1,getIsWorkspaceVectorEmbeddingsComplete:()=>!1,checkGate:()=>!1})}isAiEnabled(){return this.state.isAiEnabled()}isContextEnabled(){return this.state.isContextEnabled()}isMobileWebExperienceEnabled(){return this.modeIsAtMost("beta")}isAssistantExperienceQna(){return this.state.isAssistantExperienceQna()}isQnaRightSideDeeplinkEnabled(){return this.isMode("beta")||this.isMode("alpha")||this.isMode("development")}isQnATooltipsVisible(e,t){if(!t||!t.isReady())return!1;if(e.isMobile)return!1;const n=t.getSettings();return!!n&&"tooltip"===n.ai_qna_intro_onboarding_phase}shouldShowQnaInSearchOnly(){return this.modeIsAtMost("beta")}shouldDisableForMobileBrowser(e){return e.isMobileBrowser&&!this.isMobileWebExperienceEnabled()}shouldShowSearchMenuItemAskAI(e){return this.modeIsAtMost("beta")&&!this.shouldDisableForMobileBrowser(e)}shouldShowAssistantInCorner(e){return!(e.isMobileNative&&e.isPhone)&&(this.modeIsAtMost("beta")&&!this.shouldDisableForMobileBrowser(e))}isShowingAssistantInsteadOfHelpCenterInBottomRight(){return this.modeIsAtMost("beta")}isShowingQNAOnMobile(){return this.modeIsAtMost("beta")}showAiQnaOnboardingModalForBetaLaunch(){return this.modeIsAtMost("beta")}showSearchAiFeatures(){return this.modeIsAtMost("beta")}showRemindersToUseQnA(){return this.state.showRemindersToUseQnA()}showScopedSearch(){return this.modeIsAtMost("alpha")}canScopeToPublicWorkspace(){return this.showScopedSearch()&&this.modeIsAtMost("exploratory")}canScopeToDatabases(){return this.showScopedSearch()&&this.modeIsAtMost("development")}canSeeWaitlistModal(){return!!this.isAiEnabled()&&(!(this.state.isWorkspaceVectorEmbeddingsComplete()&&!this.state.isQnAExplicitlyDisabled())&&!this.state.isQnAExplicitlyDisabled())}shouldShowAssistantUpsellInCorner(e){return!(e.isMobileNative&&e.isPhone)&&(!!this.isAiEnabled()&&(!this.state.isQnAExplicitlyDisabled()&&(this.isMode("control")&&!this.shouldDisableForMobileBrowser(e))))}showAtMentionMenu(){return this.modeIsAtMost("development")}canAddPageLoadsToTranscript(){return this.modeIsAtMost("exploratory")}showCustomSkills(){return!1}shouldShowSuggestedQuestions(){return this.modeIsAtMost("beta")}shouldShowGroupedEdits(){return this.modeIsAtMost("wild_west")}isSuggestedQuestionsExperimentOn(){return!1}isQnaPageSuggestedQuestionRemindersEnabledForUser(){return"on"===i.default.getEligibleGroup({experimentId:"qna_show_page_suggested_questions",defaultGroup:"unassigned"})}isInPageFindQnaOptionEnabledForUser(){return this.modeIsAtMost("development")}shouldAttributeChangesToAI(){return this.modeIsAtMost("wild_west")}isXMLAssistantEnabled(e){return!1}isFullPageAssistantChatEnabled(){return!1}isJSAssistantEnabled(){return!1}isAssistantInWriterEnabled(){return!1}isChatHistoryEnabled(){return this.state.isChatHistoryEnabled()}isBlockCitationsEnabled(){return this.state.isBlockCitationsEnabled()}isAiContextSuggestionsEnabled(){return this.modeIsAtMost("development")}getMode(){return this.state.getMode()}isMode(e){return this.state.isMode(e)}modeIsAtMost(e){return this.state.modeIsAtMost(e)}}const s=new a},62740:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),r=n(92595);class i extends o.default{getInitialState(){return{edits:[],hoveredEditId:null}}getHoveredEdit(){return this.state.hoveredEditId?this.state.edits.find((e=>e.editId===this.state.hoveredEditId))??null:null}}const a=new i,s=a;(0,r.exposeDebugValue)("AssistantHoverStore",a)},98180:(e,t,n)=>{n.d(t,{Z:()=>l});n(21703);var o=n(49085),r=n(92595);const i=10*n(63143).hM;class a extends o.default{getInitialState(){return{activeAiSessionId:void 0,sessions:{},lastSessionInitializedUnixEpochTime:Date.now()}}clearAllSessions(){this.reset()}getActiveSessionId(){return this.state.activeAiSessionId}getActiveSession(){const e=this.state.activeAiSessionId;if(e)return this.state.sessions[e]}getActiveAssistantRuntimeStore(){var e;return null===(e=this.getActiveSession())||void 0===e?void 0:e.assistantRuntimeStore}getActiveAssistantRuntimeState(){var e;return null===(e=this.getActiveAssistantRuntimeStore())||void 0===e?void 0:e.state}getActiveAssistantConfigurationStore(){var e;return null===(e=this.getActiveSession())||void 0===e?void 0:e.assistantConfigurationStore}getActiveAssistantConfigurationState(){var e;return null===(e=this.getActiveAssistantConfigurationStore())||void 0===e?void 0:e.state}getSessionContext(e){return this.state.sessions[e]}getSessionContextOrThrow(e){const t=this.getSessionContext(e);if(!t)throw new Error("No assistant context for given session");return t}setActiveSessionId(e){this.update((t=>({...t,activeAiSessionId:e})))}setNewActiveSession(e){const{sessionId:t,context:n}=e;this.update((e=>({...e,activeAiSessionId:t,sessions:{...e.sessions,[t]:n},lastSessionInitializedUnixEpochTime:Date.now()})))}addNewSession(e){const{sessionId:t,context:n}=e;this.update((e=>({...e,sessions:{...e.sessions,[t]:n}})))}endCurrentSession(){this.update((e=>({...e,activeAiSessionId:void 0})))}setLastSessionInitializedUnixEpochTime(){this.update((e=>({...e,lastSessionInitializedUnixEpochTime:Date.now()})))}wasActiveSessionLastOpenedOutsideOfHistorySavedWindow(){const e=this.state.lastSessionInitializedUnixEpochTime;return!e||Date.now()-e>=i}}const s=new a,l=s;(0,r.exposeDebugValue)("AssistantRegistryStore",s),(0,r.exposeDebugValue)("getTranscript",(()=>{var e;const t=(null===(e=s.getActiveSession())||void 0===e||null===(e=e.assistantRuntimeStore.state)||void 0===e?void 0:e.evaluator.getTranscript())??[];return JSON.stringify(t)}))},58454:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),r=n(92595);class i extends o.default{getInitialState(){return{open:!1}}}const a=new i;(0,r.exposeDebugValue)("AutomationModalStore",a);const s=a},8297:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{banners:[]}}}const i=r},24229:(e,t,n)=>{n.d(t,{Z:()=>d,u:()=>s});var o=n(49085),r=n(92595),i=n(49427),a=n(15723);let s=function(e){return e[e.Open=0]="Open",e[e.Resolved=1]="Resolved",e[e.NewThread=2]="NewThread",e}({});class l extends o.default{getInitialState(){return{open:!1,rect:a.bM,recursivelyLoadAllDiscussions:!1}}getFramePageFirstSelectedDiscussionId(){var e;return this.state.open&&i.Z.isBlockInFrame(this.state.blockStore)?null===(e=this.state.discussionIds)||void 0===e?void 0:e[0]:void 0}}const c=new l;(0,r.exposeDebugValue)("BlockDiscussionMenuStore",c);const d=c},8949:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{isActive:!1}}}const i=new r},61207:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},58484:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{isOpen:!1}}}const i=r},68859:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{dragging:!1}}}const i=r},61766:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=r},17746:(e,t,n)=>{n.d(t,{Z:()=>s,t:()=>i});var o=n(49085),r=n(15157);let i=function(e){return e[e.Left=0]="Left",e[e.Right=1]="Right",e}({});class a extends o.default{getInitialState(){return{dayStoreMap:new Map,isDragging:!1,startingMonth:0}}static getLocalViewPreferenceKey(e){return`CalendarView:${e}`}static getLocalPreferences(e){let{collectionViewId:t,currentUserId:n}=e;return r.Z.get({userId:n,key:a.getLocalViewPreferenceKey(t)})}static getLocalDateRangeStart(e){let{collectionViewId:t,currentUserId:n}=e;const o=this.getLocalPreferences({collectionViewId:t,currentUserId:n});return o&&o.dateRangeStart?o.dateRangeStart:Date.now()}static setLocalDateRangeStart(e){let{collectionViewId:t,dateRangeStart:n,currentUserId:o}=e;const i=this.getLocalPreferences({collectionViewId:t,currentUserId:o})||{},s=a.getLocalViewPreferenceKey(t),l={...i,dateRangeStart:n};r.Z.set({userId:o,key:s,value:l})}static clearLocalDateRangeStart(e){let{collectionViewId:t,currentUserId:n}=e;const o=a.getLocalViewPreferenceKey(t);r.Z.remove({userId:n,key:o})}}const s=a},4926:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(49085).default.createValue(0)},87143:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{active:!1,stringValue:""}}}const i=new r},77556:(e,t,n)=>{n.d(t,{Z:()=>z});n(57658);var o=n(14577),r=n(49085),i=n(92996),a=n(41432),s=n(76205),l=n(14714),c=n(99036),d=n(43690),u=n(10070),p=n(28155),m=n(8848),f=n(33147),g=n(6695),h=n(72126),v=n(4615),b=n(96367),y=n(21202),_=n(6287),S=n(97880),w=n(23924),k=n(75330),I=n(10906),C=n(97978),x=n(28020),T=n(97004),M=n(75079),P=n(92918),A=n(26991),R=n(65742),D=n(77181),E=n(33929),B=n(98165);class F{constructor(e){this.supportsLongTask=void 0,this.entriesObserved=void 0,this.observer=void 0,this.observing=!1,this.supportsLongTask=PerformanceObserver.supportedEntryTypes.includes("longtask"),this.entriesObserved=[],this.observer=new PerformanceObserver((t=>{this.entriesObserved.push(...t.getEntries()),e&&e(t,this.observer)}))}observe(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.supportsLongTask&&(this.observer.observe({type:"longtask",buffered:e}),this.observing=!0)}get isObserving(){return this.observing}disconnect(){this.observer.disconnect(),this.observing=!1}takeRecords(){const e=this.entriesObserved;return this.entriesObserved=[],e}}var O=n(94841),Z=n(79797);class V extends r.default{constructor(e){super(),this.collectionContextStore=e}getInitialState(){return new Map}getGroupState(e){const t=Array.isArray(e)?e:void 0!==e?[e]:[],n=(0,l.KW)(t),i=this.state.get(n);if(i)return i;const a=function(e,t){const n=r.default.createValue(void 0),i=e.collectionViewBlockStore();if(!i)return;let a;t.length>0?(a=i.clone(),a.setRecordStoreUIParent(i)):a=i;const s=I.bd(e),l=new o.Z((()=>{const e=n.state;return(e&&"results"===e.type?e.blockIds:[]).map((e=>Z.G.createChildStore(a,{id:e,table:y.iU})))}),{debugName:"resultsStore"});return{groupsPointer:t,groupUiParentStore:a,reducerResultStore:n,resultsStore:l,currentLimit:r.default.createValue(s),toggleStateStore:r.default.createValue(!1)}}(this.collectionContextStore,t);return a?(this.state.set(n,a),this.emit(),a):void 0}getAllGroupStates(){return[...this.state.values()]}anyGroupHasResults(){for(const e of this.state.values())if(e.reducerResultStore.state)return!0;return!1}anyGroupHasNonEmptyResults(){for(const t of this.state.values()){var e;if(null!==(e=t.reducerResultStore.state)&&void 0!==e&&null!==(e=e.blockIds)&&void 0!==e&&e.length)return!0}return!1}anySpecifiedGroupHasResults(e){for(const t of e){const e=this.getGroupState(t);if(null!=e&&e.reducerResultStore.state)return!0}return!1}resetAllLimits(){const e=I.bd(this.collectionContextStore);for(const t of this.state.values())t.currentLimit.setState(e)}setLimitIfGreater(e,t){const n=this.getGroupState(e),o=null==n?void 0:n.currentLimit;o&&t>o.state&&o.setState(t)}incrementLimit(e){const{isFullScreen:t,currentResultCount:n,groupsPointer:o,incrementLimitsInRelatedGroups:r}=e,i=this.collectionContextStore.collectionViewStore();if(!i)return;const a=this.getGroupState(o);if(!a)return;const s=r?[...this.state.values()].filter((e=>1===o.length?1===e.groupsPointer.length:2===o.length&&(0,l.ZH)(o[0],e.groupsPointer[0]))):[a];for(const l of s){const e=l.currentLimit,o=e.state+I.NG({collectionViewStore:i,isFullScreen:t,currentResultCount:n});e.setState(o)}}}class U extends r.default{getInitialState(){return{hasLocalUpdates:!1,blockIds:new Set}}addLocalChange(e){const t=this.state.blockIds.size;for(const n of e)this.state.blockIds.add(n);t!==this.state.blockIds.size&&(this.state.hasLocalUpdates=!0,this.emit())}resetWithRemote(){const e=this.getInitialState();for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];e.blockIds=new Set(...n),this.setState(e)}}var N=n(77080),L=n(83212);class j{static getLocalViewPreferenceKey(e){return`${j.PREFERENCE_KEY_PREFIX}${e}`}constructor(e){this.context=r.default.createValue(void 0),this.reducers=r.default.createValue({}),this.reducerDependencies=new Map,this.resultSet=new U,this.remoteResult=r.default.createValue(void 0),this.remoteCollectionIds=r.default.createValue([]),this.lastRemoteRequest=r.default.createValue(void 0),this.searchOpen=r.default.createValue(!1),this.searchQuery=r.default.createValue(""),this.isLoading=r.default.createValue(!1),this.isLoaded=r.default.createValue(!1),this.loadingDetails=r.default.createValue({type:"load_general"}),this.wasCreatedThisSession=r.default.createValue(!1),this.isFullScreen=r.default.createValue(!1),this.isRootChild=r.default.createValue(!1),this.isInPeekRenderer=r.default.createValue(!1),this.relativeVariables=r.default.createValue({}),this.groupsStore=new V(this),this.groupsLimit=r.default.createValue(P.XD),this.boardColumnsLimitStore=r.default.createValue(P.XD),this.settingsStore=r.default.createValue({open:!1,stack:[]}),this.filtersBarOpen=r.default.createValue(void 0),this.temporaryState=r.default.createValue({}),this.filterBarItemSettingsStoreMap=new Map,this.frozoneStore=r.default.createValue({isScrolled:!1,scrollerWidth:void 0,scrollerLeftOffset:void 0,frozenIndex:void 0,tryShowHiddenFrozenColumn:!1}),this.filterBarSortSettingsStore=r.default.createValue({open:!1,stack:[]}),this.filterBarCombinatorFilterSettingsStore=r.default.createValue({open:!1,stack:[]}),this.filterOptionsItemSettingsStoreMap=new Map,this.filterOptionsCombinatorFilterSettingsStore=r.default.createValue({open:!1,stack:[]}),this.dateRangeStart=r.default.createValue(Date.now()),this.dateRangeEnd=r.default.createValue(Date.now()),this.calendarByMenuOpen=r.default.createValue(!1),this.timelineByMenuOpen=r.default.createValue(!1),this.subitemExpandedStore=r.default.createValue(new Map),this.numberChildrenReceived=r.default.createValue(0),this.numberChildrenUnfurled=r.default.createValue(0),this.renderEmitter=new f.Z,this.remoteRequestStoreCallback=void 0,this.localResultStoreCallback=void 0,this.updateCounter=0,this.isClientModeEnabled=r.default.createValue(!1),this.isViewSpecificClientModeEnabled=r.default.createValue(!1),this.asyncAggregationStatus=r.default.createValue({calculating:!1,aggregation:void 0,changingType:!1}),this.infiniteScrollLongTaskObserver=new F,this.visitSessionId=(0,v.ZP)(),this.collectionStoresStore=new o.Z((()=>{const e=this.collectionViewBlockStore();if(!e)return[];const t=this.collectionStore();return t?[t]:this.remoteCollectionIds.state.map((t=>Z.NW.createChildStore(e,{table:_.v,id:t})))}),{debugName:"collectionStoresStore"}),this.localResultStore=new o.Z((()=>k.pi(this.environment,this)),{useDeepEqual:!0,debugName:"localResultStore"}),this.isEmptyStore=new o.Z((()=>{var e;const t=this.reducers.state;if(this.isLoading.state||this.shouldShowSpinner.state||h.xb(t))return!1;const n=this.localResultStore.state,o=this.remoteResult.state,r=this.wasCreatedThisSession.state;if(!n&&o&&0===this.collectionStoresStore.state.length)return!0;if(this.collectionStoresStore.state.length>0&&"calendar"===this.getViewType())return!1;if((0,p.nx)(null===(e=this.collectionViewStore())||void 0===e?void 0:e.getCollectionSource())&&o){if(Object.values(o.reducerResults).every((e=>"results"===e.type&&0===e.blockIds.length)))return!0}if(!n||"reducer"!==n.type||!o||"reducer"!==o.type)return!1;const i=Object.values(n.reducerResults).filter((e=>"results"===e.type)),a=Object.values(o.reducerResults).filter((e=>"results"===e.type));return!(!r&&0===a.length)&&(0!==i.length&&i.every((e=>"results"===e.type&&0===e.blockIds.length)))}),{debugName:"isEmptyStore"}),this.remoteRequestStore=new o.Z((()=>k.oh(this.environment,this)),{debugName:"remoteRequestStore"}),this.normalizedFormatStore=new o.Z((()=>{const e=this.collectionViewBlockStore(),t=this.collectionViewStore();if(!e||!t)return{};const n=t.getType(),o=this.normalizedQueryStore.state;if(!n||!o)return{};const r=this.normalizedSchemaStore.state,i=t.getNormalizedFormat(r);if(!i)return{};const a=N.default.checkGate("home_compact_view");return(0,x.qG)(e.id)&&this.isCompactView.state&&!a?{...i,...(0,O.Vj)(n,i)}:i}),{useDeepEqual:!0,debugName:"normalizedFormatStore"}),this.normalizedSchemaStore=new o.Z((()=>{const e=this.context.state;switch(null==e?void 0:e.type){case"collectionTypedView":const t=e.databaseType===i.iS?(0,i.uV)(E.default.getIntl()):{};if(!this.collectionViewBlockStore())return t;const n=this.collectionStoresStore.state;if(0===n.length)return t;const o=(0,u.jf)({schemas:[...n.map(w.gD),t],onlyPropertyIds:Object.keys(t),prioritizeLooserLimitRule:!0});return o.error?t:o.value;case"collectionVirtualView":case"collectionView":case"collectionPage":case"collectionViewBlock":case void 0:const r=this.collectionStore();return r?r.getSchema():c.Kc(E.default.getIntl());default:(0,S.t1)(e)}}),{useDeepEqual:!0,debugName:"normalizedSchemaStore"}),this.normalizedDeletedSchemaStore=new o.Z((()=>{const e=this.collectionStore();return e?e.getDeletedSchema():c.Kc(E.default.getIntl())}),{useDeepEqual:!0,debugName:"normalizedDeletedSchemaStore"}),this.normalizedQueryStore=new o.Z((()=>{const e=this.collectionViewStore();if(e){const t=e.getType();if(t){const n=this.normalizedSchemaStore.state;return(0,d.Qo)({type:t,query2:e.getQueryStore().getValue()},n)}}}),{useDeepEqual:!0,debugName:"normalizedQueryStore"}),this.subitemTreeStore=new o.Z((()=>(0,D.yr)(this,this.environment.currentUser.id)),{debugName:"subitemTreeStore"}),this.shouldShowSpinner=new o.Z((()=>{var e,t,n,o;if(!this.isLoading.state)return!1;const r=null===(e=this.lastRemoteRequest.state)||void 0===e?void 0:e.loader,i=null===(t=this.remoteRequestStore.state)||void 0===t?void 0:t.loader;if(!h.Xy(null==r?void 0:r.filter,null==i?void 0:i.filter))return!0;if(!h.Xy(null==r?void 0:r.sort,null==i?void 0:i.sort))return!0;if(!h.Xy(null==r?void 0:r.searchQuery,null==i?void 0:i.searchQuery))return!0;if(!h.Xy(null===(n=this.lastRemoteRequest.state)||void 0===n?void 0:n.source,null===(o=this.remoteRequestStore.state)||void 0===o?void 0:o.source))return!0;const a=(null==r?void 0:r.reducers)||{},s=(null==i?void 0:i.reducers)||{};for(const l in s){const e=s[l],t=a[l];if(!h.Xy(e,t))return!0}return!1}),{debugName:"shouldShowSpinner"}),this.shouldShowSource=new o.Z((()=>{const e=this.collectionViewBlockStore(),t=this.collectionViewStore(),n=this.collectionStore();if(!e||!t||!n)return!1;return!(e.getCollectionViewSourceCollectionStore()&&this.isFullScreen.state||t.getFormat().hide_linked_collection_name)}),{debugName:"shouldShowSource"}),this.isCompactView=new o.Z((()=>{if(this.isFullScreen.state)return!1;const e=this.collectionViewBlockStore(),t=this.collectionViewStore();if(!e||!t)return!1;const n=N.default.checkGate("collections_compact_view");return t.isCompactView()&&(n||(0,x.YO)(this.isInPeekRenderer.state))}),{debugName:"isCompactView"}),this.permissionScopes=new o.Z((()=>{const e=this.collectionStore(),t=this.collectionViewStore(),n=this.collectionViewBlockStore(),o=this.isFullScreen.state,r=I.eD({collectionStore:e,collectionViewBlockStore:n,checkNavigableAncestorLocked:!o}),i=Boolean(null==n?void 0:n.isLocked()),a=Boolean(null==e?void 0:e.isSyncedCollection());if(!t||!n)return{canConfigureCollection:r,canConfigureBlock:Boolean((null==n?void 0:n.canEditCollection())&&!n.isLocked()),canEditContent:Boolean((null==n?void 0:n.canEditCollection())||(null==n?void 0:n.canEditContentOnly())),isLocked:i,isSyncedCollection:a};const s=!o&&n.isNavigableAncestorLocked(),l=Boolean(n.inMemoryRecordCache.snapshotData),c=L.Z.getMode(this.environment,n);if(s||l||"comment"===(null==c?void 0:c.permission)||"view"===(null==c?void 0:c.permission))return{canConfigureCollection:r,canConfigureBlock:!1,canEditContent:!1,isLocked:i,isSyncedCollection:a};const d=n.canEditCollection();return{canConfigureCollection:r,canConfigureBlock:Boolean(d&&!i),canEditContent:Boolean(e&&e.canEdit()),isLocked:i,isSyncedCollection:a}}),{debugName:"permissionScopes"}),this.filtersBarOpenStore=new o.Z((()=>{if(this.environment.device.isPhone)return!0;const e=this.filtersBarOpen.state;if(void 0!==e)return e;return this.currentPropertyFiltersStore.state.some((e=>{const t=e.filter;return(0,s.Oo)(t)}))||(0,T.Nq)(this)}),{debugName:"filtersBarOpenStore"}),this.localStateDiffStore=new o.Z((()=>(0,T.Zh)(this,"normalized")),{useDeepEqual:!0,debugName:"localStateDiffStore"}),this.currentCombinatorFilterStore=new o.Z((()=>{var e;const t=this.temporaryState.state.combinatorFilter;return t?t.value:null===(e=this.normalizedQueryStore.state)||void 0===e?void 0:e.filter}),{useDeepEqual:!0,debugName:"currentCombinatorFilterStore"}),this.currentSubitemFormatStoreForUiDisplay=new o.Z((()=>{var e,t;const n=null===(e=this.collectionViewStore())||void 0===e?void 0:e.getFormat().subitem_display_mode;if("flattened"===n||"hidden"===n)return;const o=(0,D.wf)(this),r=null===(t=this.collectionViewStore())||void 0===t?void 0:t.getType(),i=(0,T.RL)({collectionContextStore:this,applySubitemFilter:!1,filterOutHideSubitemsQuickFilter:!1}),a=(0,s.kk)(i);return a&&(0,s.SH)(a,(e=>!!(0,s.aN)(e)&&(e.property===(null==o?void 0:o.property)||e.property===(null==o?void 0:o.inverse))))&&r&&!(0,D.Av)(r)?void 0:o}),{useDeepEqual:!0,debugName:"currentSubitemFormatStoreForUiDisplay"}),this.currentSubitemFormatStoreForCollection=new o.Z((()=>(0,D.wf)(this)),{useDeepEqual:!0,debugName:"currentSubitemFormatStoreForCollection"}),this.currentArrowsByFormatStore=new o.Z((()=>(0,R.H5)(this)),{useDeepEqual:!0,debugName:"currentArrowsByFormatStore"}),this.currentPropertyFiltersStore=new o.Z((()=>{const e=this.normalizedSchemaStore.state,t=this.temporaryState.state.propertyFilters;return(t?t.value||[]:this.normalizedFormatStore.state.property_filters||[]).map((t=>{const n=(0,d.dN)(t.filter,e),o=this.collectionViewBlockStore();if(e[t.filter.property]&&n&&(0,s.J5)(e,t.filter.property,n.filter,null==o?void 0:o.getRecordModel))return n&&{id:t.id,filter:n}})).filter(S.$K)}),{useDeepEqual:!0,debugName:"currentPropertyFiltersStore"}),this.currentSortsStore=new o.Z((()=>{var e;const t=this.temporaryState.state.sorts;return t?t.value||[]:(null===(e=this.normalizedQueryStore.state)||void 0===e?void 0:e.sort)||[]}),{useDeepEqual:!0,debugName:"currentSortsStore"}),this.blockIsPrivateStore=new o.Z((()=>{const e=this.collectionViewBlockStore();if(e)return(0,B.RC)({environment:this.environment,store:e})}),{debugName:"blockIsPrivateStore"}),this.inheritedBlockColorStore=new o.Z((()=>{const e=this.collectionViewBlockStore(),{ThemeModeStore:t}=this.environment;if(!e)return;const n=e.findRecordStoreUIAncestor((e=>Boolean(e instanceof Z.G&&e.getRecordStoreUIParent()&&e.getFormat().block_color&&!e.isCollectionView()))).ancestor;if(n&&n instanceof Z.G){const e=n.getType(),o=n.getFormat().block_color;if(o){const n=(0,m.gh)({theme:t.state});return e===a.Ti.callout?(0,m.x7)(o,n):(0,m.fi)(o,n)}}}),{useDeepEqual:!0,debugName:"inheritedBlockColorStore"}),this.defaultPageTemplateStore=new o.Z((()=>{var e,t;const n=this.collectionStore(),o=this.collectionViewStore(),r=h.oA([null==o||null===(e=o.getFormat())||void 0===e?void 0:e.collection_view_default_template,null==n||null===(t=n.getFormat())||void 0===t?void 0:t.collection_default_template]),i=null==n?void 0:n.getTemplatePageStores();for(const a of r){if("empty"===a)return;const e=null==i?void 0:i.find((e=>e.id===a.template_page_id));if(null!=e&&e.getAlive())return e}}),{debugName:"defaultPageTemplateStore"}),this.relativeVariableStore=new o.Z((()=>{const e=this.context.state;if(!e)return;const t=e.collectionViewBlockStore;if(!t)return;const n={},o=this.relativeVariables.state;for(const[r,i]of(0,S.qP)(o)){const e=Z.NW.createChildStore(t,{id:r,table:_.v}),o=e.getSchema(),a=null==e?void 0:e.getFormat().app_config_uri;if(a&&(0,b.oN)(o,a)){n[r]={};for(const[t,s]of(0,S.qP)(i)){const i=Z.G.createChildStore(e,{id:s,table:y.iU});i.isDefined()&&((0,A.iL)({blockStore:i,collectionId:r,appConfigUri:a,variable:t,schema:o})&&(n[r][t]=s))}}}return n}),{useDeepEqual:!0,debugName:"relativeVariableStore"}),this.relativeVariablesAreStale=new o.Z((()=>{const e=this.context.state;if(!e)return!1;const t=e.collectionViewBlockStore;if(!t)return!1;const n=this.relativeVariables.state;for(const[o,r]of(0,S.qP)(n)){const e=Z.NW.createChildStore(t,{id:o,table:_.v}),n=e.getSchema(),i=null==e?void 0:e.getFormat().app_config_uri;if(i&&(0,b.oN)(n,i))for(const[t,a]of(0,S.qP)(r)){const r=Z.G.createChildStore(e,{id:a,table:y.iU});if(r.isDefined()&&!(0,A.iL)({blockStore:r,collectionId:o,appConfigUri:i,variable:t,schema:n}))return!0}}return!1}),{debugName:"relativeVariablesAreStale"}),this.aliveAutomationCount=new o.Z((()=>{const e=this.collectionStore();if(!e)return 0;const t=e.getAutomationStores();let n=0;for(const o of t)(o.isTriggerType("notification_event")||o.isTriggerType("event"))&&o.getAlive()&&(n+=1);return n}),{debugName:"aliceAutomationCount"}),this.aliveSlackAutomationCount=new o.Z((()=>{const e=this.collectionStore();if(!e)return 0;const t=e.getAutomationStores();let n=0;for(const o of t)o.isTriggerType("notification_event")&&o.getAlive()&&(n+=1);return n}),{debugName:"aliveSlackAutomationCount"}),this.getCompleteSprintButtonContext=new o.Z((()=>{var e,t;const n=N.default.checkGate("recurring_sprints");if((null===(e=this.collectionViewStore())||void 0===e?void 0:e.getFormatStore().getKeyStore("app_config_uri").getValue())!==i.g3)return;const o=this.sprintSettingsContextStore.state;if(!o||!o.sprintCollectionStore)return;if(n&&!o.automationContext)return;const{sprintCollectionStore:r,taskCollectionStore:a,automationContext:s}=o,l=this.getAutomationCollectionValue(a),c=this.getAutomationCollectionValue(r),d=null==c||null===(t=c.format)||void 0===t?void 0:t.app_config_uri,u=r.getSchema();return d&&b.qB[d]&&(0,b.oN)(u,d)&&l&&c?{...o,sprintCollectionStore:r,taskCollectionValue:l,sprintCollectionValue:c,sprintCollectionSchema:u,automationContext:s}:void 0}),{useDeepEqual:!0,debugName:"getCompleteSprintButtonContext"}),this.sprintSettingsContextStore=new o.Z((()=>{const e=(()=>{const e=this.collectionStore(),t=this.collectionViewBlockStore();if(!t||!e)return;const n=e.getParentBlockStore();if(!n||!Boolean(n.pathIsAccessibleAndAlive()))return;const o=e.getDatabaseType();if(o!==i.p$&&o!==i.iS)return;let r,a,s,l;if(o===i.iS){var d;r=e,a=n;const o=null===(d=r.getFormatStore().getKeyStore("app_uri_map").getValue())||void 0===d?void 0:d[i.Es.TaskToSprintRelation];if(!o)return{currentCollectionViewBlockStore:t,taskCollectionStore:r,taskCollectionViewBlockStore:a,sprintCollectionStore:void 0,sprintCollectionViewBlockStore:void 0,automationContext:void 0};const u=r.getSchemaStore().getKeyStore(o).getValue();if(!u||!c.p_(u))return;const p=c.j0(u);if(!p)return{currentCollectionViewBlockStore:t,taskCollectionStore:r,taskCollectionViewBlockStore:a,sprintCollectionStore:void 0,sprintCollectionViewBlockStore:void 0,automationContext:void 0};if(s=Z.NW.createChildStore(t,p),l=s.getParentBlockStore(),!l)return{currentCollectionViewBlockStore:t,taskCollectionStore:r,taskCollectionViewBlockStore:a,sprintCollectionStore:void 0,sprintCollectionViewBlockStore:void 0,automationContext:void 0};if(s.getDatabaseType()!==i.p$)return}else if(o===i.p$){var u;s=e,l=n;const o=null===(u=s.getFormatStore().getKeyStore("app_uri_map").getValue())||void 0===u?void 0:u[i.b0.SprintToTaskRelation];if(!o)return;const d=s.getSchemaStore().getKeyStore(o).getValue();if(!d||!c.p_(d))return;const p=c.j0(d);if(!p)return;if(r=Z.NW.createChildStore(t,p),a=r.getParentBlockStore(),r.getDatabaseType()!==i.iS||!a)return}else(0,S.t1)(o);const p=s?h.Ps(h.oA(s.getAutomationStores().map((e=>{if(!Boolean(e.getAlive()))return;const t=e.getActionStores();return e.isTriggerType("recurrence")&&1===t.length&&Boolean(t[0].getAlive())&&t[0].isType("complete_sprint")?{automationStore:e,automationActionStore:t[0]}:void 0})))):void 0;return Boolean(r.getAlive())&&a.pathIsAccessibleAndAlive()?Boolean(s.getAlive())&&l.pathIsAccessibleAndAlive()?{currentCollectionViewBlockStore:t,taskCollectionStore:r,taskCollectionViewBlockStore:a,sprintCollectionStore:s,sprintCollectionViewBlockStore:l,automationContext:p}:{currentCollectionViewBlockStore:t,taskCollectionStore:r,taskCollectionViewBlockStore:a,sprintCollectionStore:void 0,sprintCollectionViewBlockStore:void 0,automationContext:void 0}:void 0})(),t=(e=>{var t;if(!e)return;if(!e.taskCollectionViewBlockStore.canEditCollection())return{canEdit:!1};const n=e.sprintCollectionViewBlockStore,o=Boolean(null===(t=e.sprintCollectionViewBlockStore)||void 0===t?void 0:t.canEditCollection());return n&&!o?{canEdit:!1}:!e.sprintCollectionViewBlockStore||o&&!e.automationContext?{canEdit:!0,sprintsEnabled:!1}:o&&e.automationContext?{canEdit:!0,sprintsEnabled:!0}:void 0})(e);return e&&t?{...e,permissionsContext:t}:void 0}),{useDeepEqual:!0,debugName:"sprintSettingsContextStore"}),this.initialDatabaseItemsVisibleTracker=void 0,this.onItemMount=()=>{var e;null===(e=this.initialDatabaseItemsVisibleTracker)||void 0===e||e.handleItemMount(),this.trackInfiniteScrollLongTasksDebounced()},this.trackInfiniteScrollLongTasksDebounced=h.Ds(this.trackInfiniteScrollLongTasks,1e3),this.environment=e}setContext(e){this.context.setState(e)}get contextType(){var e;return null===(e=this.context.state)||void 0===e?void 0:e.type}get databaseType(){const e=this.context.state;if(e){if("collectionTypedView"===e.type)return e.databaseType;if("collectionView"===e.type){const t=e.collectionStore;return null==t?void 0:t.getDatabaseType()}}}collectionViewStore(){const e=this.context.state,t=null==e?void 0:e.type;if(t)switch(t){case"collectionTypedView":case"collectionView":case"collectionVirtualView":return e.collectionViewStore;case"collectionPage":case"collectionViewBlock":return;default:(0,S.t1)(t)}}collectionStore(){const e=this.context.state;if(e&&"collectionTypedView"!==e.type)return"collectionVirtualView"===e.type||"collectionView"===(null==e?void 0:e.type)||"collectionPage"===(null==e?void 0:e.type)?e.collectionStore:void("collectionViewBlock"!==(null==e?void 0:e.type)&&(0,S.t1)(e))}hasSingleCollection(){switch(this.contextType){case"collectionTypedView":case"collectionVirtualView":return!1;case"collectionPage":case"collectionViewBlock":case"collectionView":case void 0:return!0;default:(0,S.t1)(this.contextType)}}collectionViewBlockStore(){const e=this.context.state;return null==e?void 0:e.collectionViewBlockStore}formatStore(){const e=this.context.state;if(e)return"collectionPage"===e.type?e.collectionStore:"collectionView"===e.type||"collectionTypedView"===e.type||"collectionVirtualView"===e.type?e.collectionViewStore:void("collectionViewBlock"!==e.type&&(0,S.t1)(e))}getPropertyFormatKey(){const e=this.context.state;if("collectionPage"===(null==e?void 0:e.type))return"collection_page_properties";if("collectionView"===(null==e?void 0:e.type)||"collectionTypedView"===(null==e?void 0:e.type)){const t=e.collectionViewStore.getType();if(!t)return;return g.oz(t)}}getPropertyFormat(e){var t;const n=null===(t=this.formatStore())||void 0===t?void 0:t.getFormat(),o=null==this?void 0:this.getPropertyFormatKey();if(!n||!o)return;return(n[o]??[]).find((t=>t.property===e))}createUpdateCounter(){return this.updateCounter++,this.updateCounter}shouldUpdate(e){return this.updateCounter===e}getCurrentUserId(){return this.environment.currentUser.id}getViewType(){const e=this.collectionViewStore();if(null!=e&&e.isDefined())return e.getType();const t=this.context.state;return"collectionPage"===(null==t?void 0:t.type)?"page":void 0}currentViewHasSort(){const e=this.normalizedQueryStore.state;return Boolean(e&&e.sort&&e.sort.length>0)}resetLoadingState(){this.isLoading.setState(!1),this.loadingDetails.reset()}getCollectionViewBlockSourceState(){const e=this.collectionViewBlockStore();if(!e)return"uninitialized";if(e.getCollectionViewSourceCollectionStore())return"source";return e.getCollectionViewStores().some((e=>Boolean(e.getCollectionStore())))?"linked":"uninitialized"}getFilterBarItemSettingsStore(e){let t=this.filterBarItemSettingsStoreMap.get(e.id);return t||(t=r.default.createValue({open:!1,stack:[]}),this.filterBarItemSettingsStoreMap.set(e.id,t)),t}getFilterOptionsItemSettingsStore(e){let t=this.filterOptionsItemSettingsStoreMap.get(e.id);return t||(t=r.default.createValue({open:!1,stack:[]}),this.filterOptionsItemSettingsStoreMap.set(e.id,t)),t}viewIsFlushToTopbar(){if(!this.collectionStore())return!1;if(this.shouldShowSource.state)return!1;if(this.filtersBarOpenStore.state)return!1;return void 0===this.getCompleteSprintButtonContext.state}shouldAllowNewItemCreation(e){const t=this.permissionScopes.state,n="collectionTypedView"===this.contextType;return!t.isSyncedCollection&&(t.canEditContent||n&&(null==e?void 0:e.overrideAllowForTypedViews))}shouldShowPageIcon(){var e;return(null===(e=this.collectionViewStore())||void 0===e?void 0:e.shouldShowPageIcon())??!0}getAutomationCollectionValue(e){if(e.isDefined())return{id:e.id,space_id:e.getSpaceId(),schema:e.getSchema(),format:e.getFormat()}}async trackInfiniteScrollLongTasks(){if(!this.infiniteScrollLongTaskObserver.isObserving)return;this.infiniteScrollLongTaskObserver.disconnect();const e=this.infiniteScrollLongTaskObserver.takeRecords();if(!(await C.TA("collections.infinite_scroll_long_tasks.max_duration")))return;const t=e.reduce(((e,t)=>(e.entryCount++,e.maxDuration=Math.max(e.maxDuration,t.duration),e)),{maxDuration:0,entryCount:0}),n=M.Pn(this);C.j(this.environment,"collections.infinite_scroll_long_tasks.count",{count:t.entryCount,...n}),t.entryCount>0&&C.j(this.environment,"collections.infinite_scroll_long_tasks.max_duration",{time:t.maxDuration,...n})}getPageVisitSourceOverride(){var e;switch(null===(e=this.context.state)||void 0===e?void 0:e.type){case"collectionTypedView":case"collectionVirtualView":return this.context.state.pageVisitSourceOverride;case"collectionPage":case"collectionView":case"collectionViewBlock":case void 0:return;default:(0,S.t1)(this.context.state)}}resultsInViewOrder(e){var t;const n=this.collectionViewBlockStore(),o=this.collectionViewStore(),r=this.collectionStoresStore.state;if(!n||!o||!r.length)return[];const i=this.normalizedFormatStore.state,a="board"===this.getViewType()?{groupByKey:"board_columns_by",groupsFormatKey:"board_columns"}:{groupByKey:"collection_group_by",groupsFormatKey:"collection_groups"},s=this.normalizedSchemaStore.state,c=i[a.groupByKey],d=(0,S.$K)(c)?(0,l.Qq)({schema:s,groupBy:c}):[],u=Object.values((null===(t=this.localResultStore.state)||void 0===t?void 0:t.reducerResults)??{}).find((e=>"groups"===e.type)),p=(0,P.Cz)({getRecordModel:n.getRecordModel,schema:s,groupBy:c,formatGroups:i[a.groupsFormatKey]??[],schemaGroups:d,reducerResults:(null==u?void 0:u.results)??[],relativeVariableResult:this.relativeVariableStore.state,viewAppConfigUri:o.getFormat().app_config_uri});let m,f;if(0===p.length){const e=this.localResultStore.state;if(e){const t=Object.values(e.reducerResults).find((e=>"results"===e.type));m=((null==t?void 0:t.blockIds)??[]).map((e=>Z.G.createChildStore(o,{table:"block",id:e})))}else m=[]}else{m=[];for(const e of p){const t=this.groupsStore.getGroupState(e),n=null==t?void 0:t.resultsStore.state;m.push(...n??[])}}if(m=h.mN(m,(e=>e.id)),this.currentSubitemFormatStoreForUiDisplay.state){f=[];const t=this.subitemTreeStore.state;for(const n of m){if(void 0!==e&&f.length>=e)break;const o=t.children.find((e=>e.value.store.id===n.id));if(o){const e=[];(0,D.yU)({results:e,tree:o}),f.push(...e)}}}else f=m;return void 0!==e?f.slice(0,e):f}collectionStoreResultsInViewOrder(){if("collectionTypedView"!==this.contextType){const e=this.collectionStore();return e?[e]:[]}const e=this.resultsInViewOrder(void 0);return h.oA(h.mN(e.map((e=>e.getAssociatedCollectionStore())),"id"))}}j.PREFERENCE_KEY_PREFIX="CollectionView:",j.incrementScrollOffset=600;const z=j},58421:(e,t,n)=>{n.d(t,{n:()=>r});var o=n(72126);function r(e){const t=e.state;return o.Z$(t.stack)}},6776:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),r=n(72126);class i extends o.default{getInitialState(){return{editMode:void 0,store:void 0}}cloneState(){return r.d9(this.state)}}const a=new i},19511:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),r=n(72126);class i extends o.default{getInitialState(){return{isActive:!1}}cloneState(){return r.d9(this.state)}}const a=new i},16772:(e,t,n)=>{n.r(t),n.d(t,{default:()=>l});n(21703);var o=n(49085),r=n(92595),i=n(12139);class a extends o.default{constructor(){super(...arguments),this.lastUpdater=0}getInitialState(){return{type:"closed"}}setState(e){if("completionPopup"===this.state.type&&"results"===this.state.stage&&("completionPopup"!==e.type||"results"!==e.stage)){const{inMemoryRecordCache:e,context:t}=this.state;if(e.cacheUsingThisInstanceAsAnOverride){const n=`CompletionsStore transitioning away from completionPopup results while inMemoryRecord cache is still overriding ${e.cacheUsingThisInstanceAsAnOverride===t.currentPage.inMemoryRecordCache?"page's in-memory cache":"an unknown cache"}!`;i.rn(new Error(n),{from:"CompletionsStore",type:"dangerousStateTransition"})}}super.setState(e)}createUpdater(){const e=++this.lastUpdater;return t=>{if(e===this.lastUpdater)return t()}}invalidateLastUpdater(){this.lastUpdater+=1}resetStore(e){const{environment:t}=e;this.invalidateLastUpdater();const n=this.state;"completionPopup"!==n.type&&"assistantCompletionPopup"!==n.type||("completionPopup"===n.type&&"initialPromptForAIBlock"!==n.stage&&"initialPrompt"!==n.stage&&t.defaultRecordCache.inMemoryRecordCache.removeCacheOverride(n.inMemoryRecordCache),this.setState({type:"closed"}))}getExistingSessionId(){return"closed"!==this.state.type?this.state.sessionId:void 0}isEditingEmptyBlock(){var e;const t=this.state;return Boolean(("completionPopup"===t.type||"assistantCompletionPopup"===t.type)&&"initialPrompt"===t.stage&&"cursor"===t.context.type&&(null===(e=t.context.currentBlock)||void 0===e?void 0:e.isEmptyEditableBlock()))}}const s=new a;(0,r.exposeDebugValue)("CompletionsStore",s);const l=s},72371:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(14577),r=n(49085),i=n(92595);class a extends r.default{constructor(){super(...arguments),this.integrations=new o.Z((()=>{const e=this.state;return e.loaded?e.integrations:[]}),{debugName:"ComplianceIntegrationStore.integrations"}),this.webhookSubscriptions=new o.Z((()=>{const e=this.state;return e.loaded?e.webhookSubscriptions:[]}),{debugName:"ComplianceIntegrationStore.webhookSubscriptions"})}getInitialState(){return{loaded:!1,loading:!1}}}const s=new a;(0,i.exposeDebugValue)("ComplianceIntegrationStore",s);const l=s},81700:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},80641:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{bypassedPageIds:new Set}}bypassedPage(e){return this.state.bypassedPageIds.has(e)}bypassPage(e){this.state.bypassedPageIds.add(e),this.emit()}}const i=new r},61893:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),r=n(86658),i=n(12955);class a extends o.default{getInitialState(){return{permission:r.UE}}getId(){return this.getState().id}getPermission(){return this.getState().permission}setPermission(e){this.setState({...this.state,permission:e})}async setCookieConsent(e,t){this.setState(t),await(0,i.setCookieConsentCookie)(e,t)}clearCookieConsent(){this.reset(),(0,i.removeCookieConsentCookie)()}}const s=new a},45293:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},56681:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{pageId:void 0,lastInteractionTimes:{}}}}const i=new r},28748:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},30581:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{constructor(){super(...arguments),this.containerDomNodeStore=o.default.createValue(null)}getInitialState(){return{overlays:new Set}}}const i=new r},55367:(e,t,n)=>{n.d(t,{Dl:()=>i,ZP:()=>s,vh:()=>r});var o=n(49085);let r=function(e){return e[e.Above=0]="Above",e[e.Below=1]="Below",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Onto=4]="Onto",e}({}),i=function(e){return e[e.Selectable=0]="Selectable",e[e.DropTarget=1]="DropTarget",e}({});class a extends o.default{getInitialState(){return{isDragging:!1}}}const s=new a},45452:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{isDragging:!1,willDrag:!1}}}const i=r},10084:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),r=n(72126);class i extends o.default{getInitialState(){return{initiator:"none",dragging:!1,waiting:!1}}hasDragged(){return this.state.dragging&&!r.Xy(this.state.startingPoint,this.state.currentPoint)}}const a=i},80796:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{initiator:"none",isDragging:!1,disableVerticalEdgeScroll:!1,disableHorizontalEdgeScroll:!1}}}const i=new r},12211:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),r=n(92595);class i extends o.default{getInitialState(){return{dropTargetRectMap:new Map}}}const a=new i;(0,r.exposeDebugValue)("GlobalDropTargetRectStore",a);const s=a},807:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{blockStoreMode:{}}}getMode(e){let t=e.id;if(!e.isNavigableBlock()){const n=e.getNavigableBlockStore();n&&(t=n.id)}return this.state.blockStoreMode[t]??"default"}}const i=new r},24042:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{isTabsFeatureEnabled:!1}}}const i=new r},64233:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},66949:(e,t,n)=>{n.d(t,{P:()=>i,Z:()=>l});var o=n(49085),r=n(92595);let i=function(e){return e.Forward="Forward",e.Backward="Backward",e}({});class a extends o.default{getInitialState(){return{open:!1}}isOpen(){if(this.state.open){this.state;return!0}return!1}}const s=new a;r.exposeDebugValue("EquationAnnotationStore",s);const l=s},77080:(e,t,n)=>{n.r(t),n.d(t,{default:()=>b,localExperimentsV2Key:()=>h});var o=n(14577),r=n(49085);var i=n(12174),a=n(68626),s=n(15157),l=n(72126),c=n(97715),d=n(34886),u=n(97880),p=n(95477),m=n(64496),f=n(80444),g=n(7339);const h="experimentsSettingsV2";class v extends r.default{getInitialState(){return{isLoaded:!1}}updateState(e,t){!e.test&&this.state.isLoaded&&this.state.test||(this.setState(e),(0,m._3)(t)||s.Z.set({userId:e.userId,key:h,value:e}))}setState(e){super.setState(e)}getExperimentsForCurrentSpace(){if(!this.state.isLoaded)return[];if(this.state.test)return this.state.experiments;const e=f.default.state.currentSpaceStore;return e&&this.state.experimentsBySpace[e.id]||this.state.experimentsWithoutSpace}getGroup(e){if(i.TS.has(e))return c.Le;let t;if(this.state.isLoaded){const n=this.getExperimentsForCurrentSpace().find((t=>t.experimentId===e));if(!n)return c.Le;t=n.group}return t||c.Le}getExperimentsMap(){const e={};return this.state.isLoaded&&this.getExperimentsForCurrentSpace().forEach((t=>{e[t.experimentId]=t.group})),e}getExperiments(){const e={};return this.state.isLoaded&&this.getExperimentsForCurrentSpace().forEach((t=>{e[t.experimentId]=t})),Object.values(e)}getUsedNonControlExperimentsMap(){const e={};return this.state.isLoaded&&this.getExperimentsForCurrentSpace().forEach((t=>{"control"!==t.group&&(0,i.DP)(t.experimentId)&&(e[t.experimentId]=t.group)})),e}getAcceptLanguageHeader(){if(this.state.isLoaded)return this.state.acceptLanguageHeader}}const b=new class extends v{constructor(){super(),this.statsigExposureCacheForAnalytics={},this.computedStoreMap=new Map,this.isStatsigEnabled()&&g.C.addListener((()=>{this.recomputeAllGroupStores()}))}isStatsigEnabled(){var e;return Boolean(null===(e=p.default.statsig)||void 0===e?void 0:e.apiKey)}isStatsigEnabledAndInitialized(){return this.isStatsigEnabled()&&g.C.isInitialized()}isLoaded(){return this.state.isLoaded}getGroup(e,t){if(!(0,i.YY)(e)){return this.createComputedGroupStore(`group-${e}`,(()=>super.getGroup(e))).state.group||c.Le}return this.getEligibleGroup({experimentId:e,defaultGroup:c.Le,disableExposureLogging:null==t?void 0:t.disableExposureLogging})}getEligibleGroup(e){const{experimentId:t,defaultGroup:n,parameter:o=g.Z,disableExposureLogging:r=!1}=e,i=o===g.Z;this.state.isLoaded;const a=`eligible-group-${t}-${o}`;return this.createComputedGroupStore(a,(()=>{if(!this.isStatsigEnabledAndInitialized())return;const e=this.validateGroupIsString(g.C.getGroup(t,r));return void 0!==e&&(this.statsigExposureCacheForAnalytics[`statsig-${t}`]=e),i?e:g.C.getGroup(t,r,o,n)})).state.group??n}manuallyLogExperimentExposure(e){g.C.manuallyLogExperimentExposure(e)}checkGate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=this.getFeatureGateOverrideForBrowserTest(e);if((0,u.$K)(n))return n;const o=this.getFeatureGateOverrideForUnitTest(e);if((0,u.$K)(o))return o;return this.createComputedGateStore(e,(()=>{if(!this.isStatsigEnabledAndInitialized())return!1;const n=g.C.checkGate(e,t);return this.statsigExposureCacheForAnalytics[`statsig-${e}`]=n,n})).state.gate}getConfigKey(e,t,n){const o=i.LI[e][t];return this.createComputedDynamicConfigKeyStore(e,t,(()=>{var r;return this.isStatsigEnabledAndInitialized()&&(null===(r=g.C.getConfig(e,n))||void 0===r?void 0:r.get(String(t),o))||o})).state.value}logEvent(e,t,n){return this.isStatsigEnabledAndInitialized()?g.C.logEvent(e,t,(0,d.R)(n)):(a.log({level:"error",from:"ExperimentStore.ts",type:"statsigIsNotInitialized",data:{miscDataToConvertToString:{eventName:e,value:t,metadata:(0,d.R)(n),isStatsigEnabled:this.isStatsigEnabled(),isInitialized:g.C.isInitialized()}}}),!1)}getExperimentsMap(){return{...super.getExperimentsMap(),...this.statsigExposureCacheForAnalytics}}getStatsigExperimentsMap(){return this.statsigExposureCacheForAnalytics}updateState(e,t){(void 0===e.userId||this.state.isLoaded&&this.state.userId!==e.userId)&&(this.statsigExposureCacheForAnalytics={}),super.updateState(e,t)}reset(){super.reset(),this.statsigExposureCacheForAnalytics={},this.recomputeAllGroupStores()}async waitUntilStatsigReady(){this.isStatsigEnabled()&&await g.C.waitUntil((()=>g.C.state.ready))}createComputedGroupStore(e,t){return this.createComputedStore(e,(()=>({group:t(),lastUpdatedMinute:(new Date).getMinutes()})))}createComputedGateStore(e,t){return this.createComputedStore(`gate-${e}`,(()=>({gate:t(),lastUpdatedMinute:(new Date).getMinutes()})))}createComputedDynamicConfigKeyStore(e,t,n){return this.createComputedStore(`config-${e}-${String(t)}`,(()=>({value:n(),lastUpdatedMinute:(new Date).getMinutes()})))}createComputedStore(e,t){const n=(new Date).getMinutes();let r=this.computedStoreMap.get(e);return r?r.state.lastUpdatedMinute!==n&&r.setShouldRecompute():(r=new o.Z(t,{debugName:`ExperimentStore.${e}`}),r.addListener(l.yR),this.computedStoreMap.set(e,r)),r}recomputeAllGroupStores(){this.computedStoreMap.forEach((e=>{e.enqueueRecompute()}))}getFeatureGateOverrideForBrowserTest(e){}getFeatureGateOverrideForUnitTest(e){}validateGroupIsString(e){return"string"==typeof e?e:void 0}}},30874:(e,t,n)=>{n.d(t,{Z:()=>u});var o=n(14577),r=n(49085),i=n(92595),a=n(45953),s=n(77420),l=n(9844);class c extends r.default{constructor(){super(...arguments),this.integrations=new o.Z((()=>{const e=this.state;return e.loaded?e.integrations:[]}),{debugName:"ExternalIntegrationStore.integrations"}),this.bots=new o.Z((()=>{const e=this.state;return e.loaded?e.bots:[]}),{debugName:"ExternalIntegrationStore.bots"}),this.externalAuthentications=new o.Z((()=>{const e=this.state;return e.loaded?e.externalAuthentications:[]}),{debugName:"ExternalIntegrationStore.externalAuthentications"}),this.completeSlackAuthentications=new o.Z((()=>{const e=this.state;return e.loaded?e.completeSlackAuthentications:[]}),{debugName:"ExternalIntegrationStore.completeSlackAuthentications"})}getInitialState(){return{loaded:!1,loading:!1}}getIntegrationsAsRecordMap(){const e=a.Ak.create();return this.integrations.state.forEach((t=>e.setValue({table:l.K2,id:t.id},t))),e}getBotsAsRecordMap(){const e=a.Ak.create();return this.bots.state.forEach((t=>e.setValue({table:s.cZ,id:t.id},t))),e}}const d=new c;(0,i.exposeDebugValue)("ExternalIntegrationStore",d);const u=d},79167:(e,t,n)=>{n.d(t,{Z:()=>g});var o=n(49085),r=n(41432),i=n(77657),a=n(72126),s=n(45953),l=n(21202),c=n(77420),d=n(6287),u=n(97880),p=n(63143),m=n(30874);class f extends o.default{getInitialState(){return{externalObjectInstanceBlockPointersMap:{},externalCollectionInstancePointersMap:{}}}addFromRecordMapWithRoleJson(e){this.addFromRecordMapWithRole(s.PF.create(e))}addFromRecordMapWithRole(e){const t=e.getByTable(d.v).filter((e=>{var t;let{value:n}=e;return null==n||null===(t=n.value)||void 0===t||null===(t=t.format)||void 0===t?void 0:t.external_object_id})).map((e=>{let{value:t}=e;return(null==t?void 0:t.value)&&{id:t.value.id,table:d.v,spaceId:t.value.space_id}})).filter(u.$K),n=m.Z.getBotsAsRecordMap(),o=e.getByTable(l.iU).filter((e=>{let{value:t}=e;if(!(t&&t.value&&t.value.format&&t.value.format.external_object_id))return!1;if(t.value.type!==r.Ti.externalObjectInstancePage&&t.value.type!==r.Ti.externalObjectInstance)return!1;const o=t.value.format.bot_id;if(!o)return!1;if(!0===m.Z.state.loaded){const e=n.getValue({table:c.cZ,id:o});if(e&&e.integration_id&&e.integration_id===i.U9)return!1}return!0})).map((e=>{let{value:t}=e;return null==t?void 0:t.value})).filter(u.$K),s=a.oA(o.map((e=>{if(e.type===r.Ti.externalObjectInstancePage&&e.parent_table===d.v)return{id:e.parent_id,table:e.parent_table,spaceId:e.space_id}}))),f=(0,p.m8)(o.map((e=>{const t={id:e.id,table:l.iU,spaceId:e.space_id};return[e.id,t]}))),g=(0,p.m8)([...t,...s].map((e=>[e.id,e])));this.setState({externalObjectInstanceBlockPointersMap:{...this.state.externalObjectInstanceBlockPointersMap,...f},externalCollectionInstancePointersMap:{...this.state.externalCollectionInstancePointersMap,...g}})}reset(){this.setState({externalObjectInstanceBlockPointersMap:{},externalCollectionInstancePointersMap:{}})}isEmpty(){return 0===Object.keys(this.state.externalCollectionInstancePointersMap).length&&0===Object.keys(this.state.externalObjectInstanceBlockPointersMap).length}}const g=new f},83279:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{isLoading:!1,progressPercent:0}}}const i=r},69316:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1,findQuery:"",focused:!1,currentFocusedResult:void 0,autoSelectFirstMatch:!1,shouldSelectAllInput:!1}}isOpen(){return this.state.open}hasFindQuery(){return this.state.findQuery.length>0}isFocused(){return this.state.focused}}const i=new r},89256:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},73329:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(8297).Z)},17903:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(92595);const r=new(n(45589).Z);(0,o.exposeDebugValue)("FrameScrollerStore",r);const i=r},46735:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(50475),r=n(92595),i=n(35683),a=n(80444);const s=new class{constructor(){this.frecencyStore=void 0,this.spaceId=void 0,this.userId=void 0}get(e){const{currentSpaceStore:t}=a.default.state,n=t&&t.id;return void 0===n||void 0===e?(this.userId=void 0,this.spaceId=void 0,void(this.frecencyStore=void 0)):(this.spaceId===n&&this.userId===e||(this.spaceId=n,this.userId=e,this.frecencyStore=new i._R({store:localStorage,prefix:`BlockFrecency:${e}:${n}`,maxBlocks:100,maxStoredVisits:10,version:i.uP}),this.frecencyStore.initialize()),this.frecencyStore)}};const l={lazyFrecencyStore:s,recordVisit:e=>{const{id:t,type:n,timestampForTestingOnly:r,currentUserId:i,systemBlockType:a}=e;if((0,o.EW)(a))return;const l=s.get(i);return l?l.recordVisit({id:t,type:n,timestampForTestingOnly:r}):void 0},sortFrecencyHighToLow:function(e){const{currentUserId:t,items:n,now:o,recordFrecency:r}=e,i=s.get(t);return i?i.sortFrecencyHighToLow({items:n,now:o,recordFrecency:r}):n},getVisitedIds:e=>{const t=s.get(e);return t?t.getVisitedIds():[]},clearForUser:function(e){for(let t=0;t<localStorage.length;t++){const n=localStorage.key(t);n&&n.startsWith(`BlockFrecency:${e}`)&&localStorage.removeItem(n)}}};(0,r.exposeDebugValue)("FrecencyStore",l);const c=l},38302:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),r=n(92595);class i extends o.default{getInitialState(){return{isOpen:!1,backgroundAnimationComplete:!0,fullscreenNodeAnimationComplete:!0,startScrollTop:0,skipAnimations:!1,isSaving:!1,zoomScale:1,panStartPosition:{x:0,y:0},panOffset:{x:0,y:0}}}}const a=new i;(0,r.exposeDebugValue)("GlobalFullScreenStore",a);const s=a},81258:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},73796:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},27411:(e,t,n)=>{n.r(t),n.d(t,{GlobalFileUploadStore:()=>r,default:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{}}getKeyState(e){return this.state[e]}setKeyState(e,t){const n=this.state;let o;if(t){var r;const a=t.file.type.indexOf("image")>=0;var i;if(t.file!==(null===(r=n[e])||void 0===r?void 0:r.file)&&a)o=null===(i=n[e])||void 0===i?void 0:i.dataURL,t.dataURL=URL.createObjectURL(t.file);n[e]={...t,dataURL:t.dataURL}}else{var a;o=null===(a=n[e])||void 0===a?void 0:a.dataURL,delete n[e]}if(o){const e=o;setTimeout((()=>{URL.revokeObjectURL(e)}),1e3)}this.emit()}isUploading(){const e=this.state,t=Object.keys(e);for(const n of t){if(e[n])return!0}return!1}getBlockKey(e){return e}}const i=new r},96049:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(14577),r=n(55367),i=n(80796),a=n(69784),s=n(59238);const l=new o.Z((()=>i.Z.state.isDragging||r.ZP.state.isDragging||s.Z.state.isDragging||a.default.state.isActive),{debugName:"GlobalIsDraggingStore"})},45483:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),r=n(92595);class i extends o.default{getInitialState(){return{openModals:new Set}}}const a=new i,s=a;(0,r.exposeDebugValue)("GlobalModalStore",a)},3418:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{openPopups:new Set,namedOpenPopups:new Set}}hasOpenPopups(){const{openPopups:e,namedOpenPopups:t}=this.getState();return e.size>0||t.size>0}hasOpenMobileSlideUps(){const{openPopups:e,namedOpenPopups:t}=this.getState();if(t.size>0)return!0;for(const n of e){if(n.props.hidesMobileNativeBottomBar)return!0;if(n.isSlideUp(n.props)&&!n.props.preventSlideUpTransition)return!0}return!1}hasOpenMouseCapturePopup(){const{openPopups:e}=this.state;return e.size>0&&Array.from(e.values()).some((e=>!e.props.disableMouseCapture))}closeAll(){for(const n of this.state.openPopups){var e,t;null===(e=(t=n.props).onDismiss)||void 0===e||e.call(t,null)}}addNamedPopup(e){this.state.namedOpenPopups.add(e),this.emit()}removeNamedPopup(e){this.state.namedOpenPopups.delete(e),this.emit()}}const i=new r},69327:(e,t,n)=>{n.d(t,{Z:()=>f});var o=n(18466),r=n(49085),i=n(72126),a=n(44615),s=n(21202),l=n(63143),c=n(15447),d=n(2688),u=n(80444),p=n(79797);class m extends r.default{constructor(){super(...arguments),this.userPageVisitListenerReference=void 0,this.recentPageRefreshTimer=void 0,this.isInitialized=!1,this.reinitializeState=async(e,t,n)=>{this.cleanup(e),await(0,c.h_)({environment:e,userId:t,spaceId:n}),this.isInitialized=!0;const o=5*l.hM;this.recentPageRefreshTimer=window.setTimeout((()=>{(0,c.h_)({environment:e,userId:t,spaceId:n})}),o),this.userPageVisitListenerReference=d.ZP.addListener((0,a.Ns)(t),i.P2(((e,n)=>(0,c.rw)(t,n)),100),void 0,e)}}getInitialState(){return{recentPages:new Map}}cleanup(e){this.userPageVisitListenerReference&&(d.ZP.removeListener(this.userPageVisitListenerReference,e),this.userPageVisitListenerReference=void 0),this.recentPageRefreshTimer&&(clearTimeout(this.recentPageRefreshTimer),this.recentPageRefreshTimer=void 0)}getRecentPagesWithStores(e,t){const n=u.default.state.currentSpaceStore;return n?t.map((t=>({...t,store:p.G.createChildStore(n.getPagesStore(),{table:s.iU,id:t.pageId,spaceId:e})}))):[]}set(e,t){const n=this.getRecentPagesWithStores(e,t);this.update((t=>(t.recentPages.set(e,n),t))),this.emit()}get(e){return this.state.recentPages.get(e)}getWithoutSubscribing(e){return o.Z.withListenerIgnored((()=>this.get(e)))||[]}mergeRecentPages(e,t){const n=this.getRecentPagesWithStores(t,e),o=(this.state.recentPages.get(t)??[]).concat(n),r=i.mN(o,"pageId");this.set(t,r)}}const f=new m},7844:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},475:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},52689:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),r=n(54153);const i="currentHighlightColor";class a extends o.default{getInitialState(){return{color:Boolean(localStorage)&&r.Z.get(i)||"yellow_background"}}setHighlightColor(e){r.Z.set(i,e),this.setState({color:e})}}const s=new a},42653:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{isPinned:!1}}}const i=new r},20144:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{}}}const i=new r},65686:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),r=n(34859);class i extends o.default{getInitialState(){return{capturingAreas:new Set}}getPreventScrollType(){let e=!1,t=!1,n=!1;return this.state.capturingAreas.forEach((o=>{o.preventType===r.Z.All?e=!0:o.preventType===r.Z.X?t=!0:o.preventType===r.Z.Y&&(n=!0)})),e||t&&n?r.Z.All:t?r.Z.X:n?r.Z.Y:r.Z.None}}const a=new i},41577:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{loaded:!1,error:!1}}}const i=r},94416:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},95424:(e,t,n)=>{n.d(t,{H:()=>a});var o=n(92595),r=n(54153),i=n(63143);class a{static getNumber(e){const t=r.Z.get(e);if("number"==typeof t&&!isNaN(t))return t}static getLatest(){return this.getNumber(this.LAST_TIMEOUT_STORAGE_KEY)}static trackPersistently(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();r.Z.set(this.LAST_TIMEOUT_STORAGE_KEY,e);const t=this.getTotal()??0;r.Z.set(this.TOTAL_TIMEOUTS_STORAGE_KEY,t+1)}static getTotal(){return this.getNumber(this.TOTAL_TIMEOUTS_STORAGE_KEY)}static clear(){r.Z.remove(this.LAST_TIMEOUT_STORAGE_KEY),r.Z.remove(this.TOTAL_TIMEOUTS_STORAGE_KEY)}static hasOccurredRecently(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Date.now();const t=this.getLatest();return"number"==typeof t&&e-t<this.RECENT_TIME_WINDOW_MS}}a.LAST_TIMEOUT_STORAGE_KEY="latestNotionTransactionTimeout",a.TOTAL_TIMEOUTS_STORAGE_KEY="totalNotionTransactionTimeouts",a.RECENT_TIME_WINDOW_MS=7*i.A0,(0,o.exposeDebugValue)("IndexedDBTimeoutTracker",a)},96826:(e,t,n)=>{n.d(t,{Z:()=>k});var o,r=n(54064),i=n(68626),a=n(72126),s=n(91155),l=n(29477),c=n(606),d=n(12139),u=n(63143),p=(n(95477),n(21830)),m=n(15517),f=n(2414),g=n(63037),h=n(88632),v=n(77080),b=n(99757),y=n(26634),_=n(9425);class S{constructor(e){this.debug=!1,this.shouldStopLooping=!1,this.attemptedToClaimSessions=!1,this.isProcessingTask=!1,this.lastTaskTimestamp=0,this.events=new r.Z,this.waiter=void 0,this.transactionBackoffController=new f.h(y._W),this.retryReasonCounters={_total:0},this.errorCounts={},this.startTime=Date.now(),this.disableStorageManagerEstimate=!1,this.dependencies=void 0,this.transactionStore=void 0,this.sessionId=void 0,this.debugLogger=void 0,this.enableHeartbeatTimeout=void 0;const{dependencies:t,transactionStore:n,sessionId:o,debugLogger:a,enableHeartbeatTimeout:s}=e;this.dependencies=t,this.transactionStore=n,this.sessionId=o,this.debugLogger=a,this.enableHeartbeatTimeout=s,i.clientLogglyEnvironmentData.idbSessionId=this.sessionId,this.disableStorageManagerEstimate=v.default.checkGate("disable_storage_manager_estimate",!0),this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"createdIndexedDBTransactionQueue",data:{sessionId:this.sessionId}})}startLoop(){setTimeout((()=>{this.heartbeatLoop()}),1),setTimeout((()=>{this.txLoop()}),1),setTimeout((()=>{this.healthcheckLoop()}),1)}stopLoop(){this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"stopLoop",data:{message:"Stopping loop."}}),this.shouldStopLooping=!0}hasAttemptedToClaimSessions(){return this.attemptedToClaimSessions}logEmptyTaskForDebugging(e){this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"logEmptyTaskForDebugging",data:{message:`Task created by ${e} was empty.`}})}async enqueueTask(e){const t=await this.transactionStore.saveTask(this.sessionId,e,this.getIndexedDBTimeoutMs());if(this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp),t.error)throw this.incrementErrors(t.error,"enqueueTask"),this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"enqueueTask",error:(0,s.Ui)(t.error)}),t.error;this.clearErrors("enqueueTask"),this.getWaitable(!1).trigger()}unpause(){this.transactionBackoffController.reset(),this.getWaitable(!1).trigger()}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return!!this.transactionStore&&this.transactionStore.hasTasks()}async hasTasksForUser(e){const t=await this.transactionStore.hasTasksForUser(e,this.getIndexedDBTimeoutMs());return t.error?(this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.hasTasksForUser",error:(0,s.Ui)(t.error)}),!1):t.value}async anySessionHasTasks(){const e=await this.transactionStore.anySessionHasTasks(this.getIndexedDBTimeoutMs());return e.error?(this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.anySessionHasTasks",error:(0,s.Ui)(e.error)}),!1):e.value}async drain(){return this.hasTasks()||this.isProcessingTask?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return this.hasTask((t=>t.operations.some((t=>(0,c.qo)(t.pointer,e)))))}async reset(){await this.transactionStore.reset()}async clearForUser(e){await this.transactionStore.clearTasksForUser(e)}async checkObjectStores(){return await this.transactionStore.checkObjectStores()}async getTotalNumberOfTasks(){const e=await this.transactionStore.getTotalNumberOfTasks(this.getIndexedDBTimeoutMs());return e.error?(i.log({level:"error",from:"IndexedDBTransactionQueue",type:"getTotalNumberOfTasks",error:(0,s.Ui)(e.error)}),0):e.value}startSyncing(){h.Z.setState({...h.Z.state,syncing:!0})}updateDependencies(e){this.dependencies=e}DEV_ONLY_deadlockDb(e){return this.transactionStore.DEV_ONLY_deadlockDb(e)}debugLog(){if(this.debug){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];console.log("IndexedDBTransactionQueue:",...t)}}async wait(e,t){await this.getWaitable(!1).wait(e,t),this.getWaitable(!0)}async txLoop(){for(;!this.shouldStopLooping;)try{await this.txLoopIteration(),this.clearErrors("txLoop")}catch(e){this.incrementErrors(e,"txLoop"),(0,g.Os)(this.retryReasonCounters,"txLoopException"),this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"txLoopIteration",error:(0,s.Ui)(e)}),d.IE(e),await l.Vs(15e3)}}async txLoopIteration(){const e=await this.getTasks();if(!e)return this.events.emit("drain"),void(await this.wait(...this.getMinMaxLoopDelay(!1)));const{tasks:t,sessionId:n}=e;if(0===t.length){const e=await this.transactionStore.deleteSession({currentSessionId:this.sessionId,sessionId:n});return void(e.error&&(this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.deleteSession",data:{sessionId:n},error:(0,s.Ui)(e.error)})))}this.startSyncing(),this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handleSubmitTransactionAttempt",data:{message:`for session ${n}: attempt submitTransaction with ${t.length} tasks`,sessionId:n,taskIds:w(t)}}),await this.useSaveTransactionsApi(t,n);const o=this.hasTasks();o||(this.doneSyncing(),this.events.emit("drain")),await this.wait(...this.getMinMaxLoopDelay(o))}getMinMaxLoopDelay(e){const[t,n]=(0,_.Z)()?[g.xd,g.CE]:[g.V_,g.Ud];return Boolean(e)?[t,t]:[t,n]}async useSaveTransactionsApi(e,t){const n=await this.dependencies.handleSaveTransactions(e);if(n.error){const{savedTasks:e,failedTasks:o,message:r,retryDelay:a,retryReason:l}=n.error;l?(0,g.Os)(this.retryReasonCounters,l):this.retryReasonCounters={_total:0},e.length>0&&(this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handlePartialSaveTransactionsSuccess",data:{message:`for session ${t}: will delete ${e.length} saved tasks`,taskIds:w(e),sessionId:t}}),await this.cleanupTasks(e,void 0)),o.length>0?(this.debugLogger.flush(),i.log({level:"warning",from:"IndexedDBTransactionQueue",type:"handleSaveTransactionsError",data:{message:`for session ${t}: ${r}`,taskIds:w(o),sessionId:t},error:(0,s.Ui)(n.error)}),await this.cleanupTasks(o,n.error)):this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handleSaveTransactionsRetryableError",data:{message:`for session ${t}: ${r}`,sessionId:t}}),a>0?await this.transactionBackoffController.backOffOnFailure(a-g.V_,n.error.retryReason):this.transactionBackoffController.reset()}else{const e=n.value;this.retryReasonCounters={_total:0},this.debugLogger.log({level:"debug",from:"IndexedDBTransactionQueue",type:"handleSaveTransactionsSuccess",data:{message:`for session ${t}: will delete ${e.length} saved tasks`,taskIds:w(e),sessionId:t}}),await this.cleanupTasks(e,void 0),this.transactionBackoffController.reset()}}incrementErrors(e,t){this.debugLog("incrementErrors",e,t),void 0===this.errorCounts[t]?this.errorCounts[t]=1:this.errorCounts[t]+=1;const n=a.Fp(Object.values(this.errorCounts))||0;this.errorCounts[t]===S.maxErrors+1&&(this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:`maxErrors.${t}`,error:(0,s.Ui)(e)})),n>S.maxErrors&&b.Z.setState({...b.Z.state,transactionQueueError:e}),e.type===p.vZ&&this.events.emit("timeout")}clearErrors(e){this.errorCounts[e]&&delete this.errorCounts[e];(a.Fp(Object.values(this.errorCounts))||0)<=S.maxErrors&&b.Z.setState({...b.Z.state,transactionQueueError:void 0})}async heartbeatLoop(){for(;!this.shouldStopLooping;)try{await this.heartbeat(),await l.Vs(S.heartbeatInterval)}catch(e){this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"heartbeatLoopIteration",error:(0,s.Ui)(e)}),await l.Vs(S.heartbeatInterval)}}async heartbeat(){const e=this.enableHeartbeatTimeout?this.getIndexedDBTimeoutMs():void 0;{this.debugLog("heartbeat");const t=await this.transactionStore.heartbeat({currentSessionId:this.sessionId,isActive:!0,timeoutMs:e});if(t.error)return this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.heartbeat",error:(0,s.Ui)(t.error)}),void this.incrementErrors(t.error,"heartbeat");this.clearErrors("heartbeat")}{const t=Date.now()-S.claimSessionDelay,n=await this.transactionStore.claimSessions({currentSessionId:this.sessionId,staleSessionTimeoutMs:t,transactionTimeoutMs:e});if(n.error)return this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.claimSessions",error:(0,s.Ui)(n.error)}),void(n.error.type===p.vZ&&this.incrementErrors(n.error,"claimSessions"));this.clearErrors("claimSessions"),this.attemptedToClaimSessions=!0}this.checkStorageQuota()}async checkStorageQuota(){if(this.disableStorageManagerEstimate)return;const e=await(0,m.sK)();e&&(i.clientLogglyEnvironmentData.storageQuotaEstimate=e.quota,i.clientLogglyEnvironmentData.storageUsageEstimate=e.usage,b.Z.setState({...b.Z.state,storageUsageEstimate:e}))}doneSyncing(){h.Z.setState({...h.Z.state,syncing:!1})}hasTask(e){return this.transactionStore.hasTask(e)}async getTasks(){const e="on"===this.dependencies.getExperimentGroup("sort_indexeddb_tasks_by_index"),t=await this.transactionStore.getTasks(this.sessionId,e);if(t.error)throw t.error;return t.value}async cleanupTasks(e,t){for(const r of e)if(r.callback)try{r.callback(t)}catch(o){this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"cleanupTask",data:{taskId:r.id},error:(0,s.Ui)(o)})}const n=await this.transactionStore.deleteTasks(e);n.error&&(this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"IndexedDBTransactionStore.deleteTasks",error:(0,s.Ui)(n.error)}))}getWaitable(e){return this.waiter&&!e||(this.waiter=new l.a6),this.waiter}async healthcheckLoop(){for(;!this.shouldStopLooping;){try{var e;const t=await this.transactionStore.getTotalNumberOfTasks(S.defaultIndexedDBTimeoutMs),n={queue_type:"IndexedDBTransactionQueue",uptime:Date.now()-this.startTime,queue_size:t.error?void 0:t.value,error_type:null===(e=t.error)||void 0===e?void 0:e.type,is_considered_online:h.Z.state.online,retry_reasons:this.retryReasonCounters};(n.queue_size&&n.queue_size>S.transactionSizeHealthcheckThreshold||n.error_type)&&(this.debugLogger.flush(),i.log({level:"info",from:"IndexedDBTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:n}}),this.dependencies.handleHealthcheck(n))}catch(t){this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionQueue",type:"healthcheckLoopIteration",error:(0,s.Ui)(t)}),d.IE(t)}await l.Vs(S.healthcheckInterval)}}getIndexedDBTimeoutMs(){if("on"===this.dependencies.getExperimentGroup("indexeddb-transaction-timeout-v2"))return S.defaultIndexedDBTimeoutMs}}function w(e){return e.map((e=>{var t;return null!==(t=e.debug)&&void 0!==t&&t.userAction?`${e.id} (${e.debug.userAction})`:e.id}))}o=S,S.heartbeatInterval=2.5*u.C0,S.claimSessionDelay=5*o.heartbeatInterval,S.healthcheckInterval=15*u.hM,S.transactionSizeHealthcheckThreshold=1e3,S.defaultIndexedDBTimeoutMs=180*u.C0,S.maxErrors=5;const k=S},50619:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(68626),r=n(82798),i=n(96826),a=n(99757);class s{constructor(e,t){this.activeQueue=void 0,this.inMemoryTransactionQueue=void 0,this.handleIndexedDbTimeout=()=>{const e=(0,r.R9)(this.activeQueue,i.Z);e.hasTasks()||(e.stopLoop(),e.events.removeListener("timeout",this.handleIndexedDbTimeout),a.Z.reset(),this.inMemoryTransactionQueue.startLoop(),this.activeQueue=this.inMemoryTransactionQueue,o.log({level:"warning",from:"IndexedDBWithInMemoryFallbackTransactionQueue",type:"handleIndexedDbTimeout",data:{message:"IndexedDB timeout occurred while the transaction queue is empty. Switching over to InMemoryTransactionQueue."}}))},this.activeQueue=e,this.inMemoryTransactionQueue=t,e.events.addListener("timeout",this.handleIndexedDbTimeout)}startLoop(){this.activeQueue.startLoop()}logEmptyTaskForDebugging(e){var t,n;null===(t=(n=this.activeQueue).logEmptyTaskForDebugging)||void 0===t||t.call(n,e)}enqueueTask(e){return this.activeQueue.enqueueTask(e)}unpause(){this.activeQueue.unpause()}pause(){this.activeQueue.pause()}getLastTaskTimestamp(){return this.activeQueue.getLastTaskTimestamp()}hasTasks(){return this.activeQueue.hasTasks()}anySessionHasTasks(){return this.activeQueue.anySessionHasTasks()}getTotalNumberOfTasks(){return this.activeQueue.getTotalNumberOfTasks()}hasTasksForUser(e){return this.activeQueue.hasTasksForUser(e)}drain(){return this.activeQueue.drain()}awaitRecordTransaction(e){return this.activeQueue.awaitRecordTransaction(e)}isPendingTransactionForRecord(e){return this.activeQueue.isPendingTransactionForRecord(e)}reset(){return this.activeQueue.reset()}clearForUser(e){return this.activeQueue.clearForUser(e)}updateDependencies(e){this.activeQueue.updateDependencies(e),this.inMemoryTransactionQueue!==this.activeQueue&&this.inMemoryTransactionQueue.updateDependencies(e)}getIndexedDBTransactionQueue(){if(this.activeQueue instanceof i.Z)return this.activeQueue}}},64113:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{focused:!1}}}const i=r},48863:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},22294:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{isEnabled:!0,isKeyboardMode:!1}}setEnabled(e){this.setState({...this.state,isEnabled:e})}setKeyboardMode(e){this.state.isEnabled&&this.setState({isEnabled:!0,isKeyboardMode:e})}}const i=new r},23178:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},23883:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{limitParents:new WeakMap}}setLimitParents(e,t){this.state.limitParents.set(e,t),this.emit()}removeLimitParents(e){this.state.limitParents.delete(e),this.emit()}}const i=new r},31104:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},37598:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{}}getEditedBlocksForCollection(e){const t=this.state[e];if(t)return t;{const t=new Set;return this.state[e]=t,t}}setEditedBlock(e,t){this.getEditedBlocksForCollection(e).add(t),this.emit()}}const i=new r},84166:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{}const i=new r},91390:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{isActive:!1}}}const i=new r},19111:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),r=n(72087);class i extends o.default{getInitialState(){return{open:!1,userRequestStore:new r.Z,botRequestStore:new r.Z,pageRequestStore:new r.Z,mentionTypes:{page:!1,heading:!1,createPage:!1,user:!1,inviteUser:!1,bot:!1,date:!1,reminder:!1,templateVariable:!1,group:!1}}}}const a=new i},29798:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{focus:{section:void 0,indexLocal:void 0,indexGlobal:void 0,isInitialized:!1}}}setState(e){super.setState({...e,focus:{...e.focus,isInitialized:!0}})}update(e){this.setState(e({...this.state}))}unsetFocus(){this.setState({...this.state,focus:{section:void 0,indexLocal:void 0,indexGlobal:void 0}})}}const i=r},69454:(e,t,n)=>{n.d(t,{Z:()=>c,i:()=>s});var o=n(49085),r=n(72126),i=n(5162),a=n(3418);let s=function(e){return e[e.willHide=0]="willHide",e[e.hidden=1]="hidden",e[e.willShow=2]="willShow",e[e.shown=3]="shown",e}({});class l extends o.default{constructor(){var e;super(...arguments),e=this,this.updateKeyboardPhaseDebounced=r.Ds(((e,t)=>{this.setState({...this.state,phase:e,estimatedKeyboardWebViewOverlap:t})}),300),this.updateKeyboardPhase=(e,t,n)=>{const{device:o,RouterStore:r}=e,i="page"===r.state.route.name,a=o.isAndroid&&o.isMobileNative;i&&a?this.updateKeyboardPhaseDebounced(t,n):this.setState({...this.state,phase:t,estimatedKeyboardWebViewOverlap:n})},this.updateShouldResizeWebview=function(t,n){let o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"v2";const{mobileNative:r}=t;switch(o){case"v1":const t=null==r?void 0:r.api.setShouldResizeWebView;t&&t(n);break;case"v2":const o=null==r?void 0:r.api.setShouldResizeWebViewV2;(0,i.Y)("supportsWebViewResizingOnSelection")&&o&&(e.setState({...e.state,shouldResizeWebView:n}),o(n).then((t=>{t.length>0&&e.setState({...e.state,shouldResizeWebView:t[0]})})))}},this.mobileNativeBottomPadding=e=>this.estimatedNativeWebBottomOverlapInternal(e),this.estimatedNativeWebBottomOverlap=()=>this.estimatedNativeWebBottomOverlapInternal(void 0),this.estimatedNativeWebBottomOverlapInternal=e=>{const t=(null==e?void 0:e.WindowSizeStore.state.paddingBottom)??0;if((0,i.Y)("supportsNativeBottomBarOverlappingWebView")){const n=a.Z.hasOpenMobileSlideUps()?t:t+48;return Math.max(this.estimatedKeyboardWebViewOverlap(e),n)}return this.estimatedKeyboardWebViewOverlap(e)},this.estimatedKeyboardWebViewOverlap=e=>{let t;return t=(0,i.Y)("supportsFixedSizeWebView")?(0,i.Y)("supportsWebViewResizingOnSelection")&&this.state.shouldResizeWebView?0:this.state.estimatedKeyboardWebViewOverlap:0,t>0?t:(null==e?void 0:e.WindowSizeStore.state.paddingBottom)??0}}getInitialState(){return{phase:s.hidden,estimatedKeyboardWebViewOverlap:0,shouldResizeWebView:!1}}async onShow(e){await this.waitUntil((()=>this.state.phase===s.shown)),e()}async onHide(e){await this.waitUntil((()=>this.state.phase===s.hidden)),e()}}const c=new l},17294:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{}}}const i=new r},42330:(e,t,n)=>{n.d(t,{ZP:()=>s,o1:()=>r,rJ:()=>a});var o=n(49085);const r=["page","space","team","space-private-pages"];class i extends o.default{getInitialState(){return{isOpen:!1,lastPageId:void 0}}getVariant(){if(this.state.isOpen)return this.state.variant}getTargetsDatabaseType(){if(this.state.isOpen)return a(this.state.targets)}}function a(e){var t;if(0===e.length)return;const n=null===(t=e[0].getAssociatedCollectionStore())||void 0===t?void 0:t.getDatabaseType();if(n){for(const t of e){var o;if(n!==(null===(o=t.getAssociatedCollectionStore())||void 0===o?void 0:o.getDatabaseType()))return}return n}}const s=new i},53730:(e,t,n)=>{n.r(t),n.d(t,{TEST_ONLY__setTransactionQueue:()=>oe,isIndexedDbGracefulFallbackToInMemoryEnabled:()=>J,setupTransactionQueue:()=>ne,transactionQueue:()=>te});n(57658),n(21703);var o=n(36769),r=n(7406),i=n(68626),a=n(72126),s=n(91155),l=n(29477),c=n(4615),d=n(63143),u=n(482),p=n(97880),m=n(99757),f=n(21830);const g="Transaction",h="bySessionId",v="byTimestamp",b="byId",y="byUserId",_="Session",S="bySessionId",w="byUpdatedAt",k="byOwnerSessionId";const I=45*d.C0;class C{constructor(e,t){this.db=void 0,this.debugLogger=void 0,this.runOptimizedScans=!0,this.activeTasks=new Map,this.ownedSessionIds=new Set,this.db=new f.pz(t,"TransactionStore",2,{upgrade(e,t,n,o){if(t<1&&function(e){const t=e.createObjectStore(_,{keyPath:p.MN("index"),autoIncrement:!0});t.createIndex(w,p.MN("updatedAt"),{unique:!1}),t.createIndex(k,p.MN("ownerSessionId"),{unique:!1}),t.createIndex(S,p.MN("sessionId"),{unique:!0});const n=e.createObjectStore(g,{keyPath:p.MN("index"),autoIncrement:!0});n.createIndex(v,p.MN("timestamp"),{unique:!1}),n.createIndex(h,[p.MN("sessionId"),p.MN("timestamp")],{unique:!1}),n.createIndex(b,p.MN("id"),{unique:!0})}(e),t<2){o.objectStore(g).createIndex(y,p.MN("userId"))}}}),this.debugLogger=e,this.runOptimizedScans=!t.device.isEdgeHTML}async DEV_ONLY_deadlockDb(e){throw new Error("This function is only available in development builds.")}async heartbeat(e){const{currentSessionId:t,isActive:n,timeoutMs:o}=e,r=n?[_,g]:[_],a=await this.db.startTransaction({storeNames:r,mode:"readwrite",name:"IndexedDBTransactionStore.heartbeat",timeoutMs:o},(async(e,o)=>{const r=new Set,a=e.objectStore(_);let l=await a.index(k).openCursor(t);o("Obtained session cursor.");let c=0;for(;l;){c+=1;const e=l.value;e.sessionId!==t&&r.add(e.sessionId);const n={...e,updatedAt:Date.now()};l.update(n),l=await l.continue()}if(o(`Finished processing ${c} sessions.`),n){const t=e.objectStore(g).index(b),n=Date.now()-I;o(`Processing ${this.activeTasks.size} active tasks.`),this.activeTasks.forEach((async e=>{if(e.timestamp>=n)return;if(!(await t.get(e.id))){if(e.callback)try{e.callback(void 0)}catch(o){this.debugLogger.flush(),i.log({level:"error",from:"IndexedDBTransactionStore",type:"activeTaskGarbageCollectCleanupError",error:(0,s.Ui)(o)})}this.debugLogger.flush(),i.log({level:"warning",from:"IndexedDBTransactionStore",type:"activeTaskGarbageCollect",data:{miscDataToConvertToString:{task:e,expireTime:n}}}),this.activeTasks.delete(e.id)}}))}return{value:r}}));return a.error?a:(this.ownedSessionIds=a.value,{value:void 0})}async claimSessions(e){const{currentSessionId:t,staleSessionTimeoutMs:n,transactionTimeoutMs:o}=e,r=await this.db.startTransaction({storeNames:[_],mode:"readwrite",name:"IndexedDBTransactionStore.claimSessions",timeoutMs:o},(async(e,o)=>{const r=[],i=e.objectStore(_);let a=await i.index(w).openCursor(IDBKeyRange.upperBound(n));for(o("Obtained session cursor.");a;){const e=a.value,n={...e,ownerSessionId:t,updatedAt:Date.now()};r.push(e.sessionId),o(`Taking ownership of session ${e.sessionId}.`);const i=Date.now()-e.updatedAt;this.debugLogger.log({from:"IndexedDBTransactionStore",level:"debug",type:"claimSession",data:{message:`claimed ${e.sessionId} updated ${i}ms ago`,sessionId:e.sessionId,sinceLastUpdate:i}}),a.update(n),a=await a.continue()}return{value:r}}));if(r.error)return r;for(const i of r.value)this.ownedSessionIds.add(i);return{value:void 0}}getTasks(e,t){return this.db.startTransaction({storeNames:[_,g],mode:"readonly",name:"IndexedDBTransactionStore.getTasks",timeoutMs:void 0},(async(n,o)=>{let r;const i=[],a=n.objectStore(_);let s=await a.index(k).openCursor(e);for(o("Obtained session cursor.");s;){const e=s.value;i.push(e),s=await s.continue()}if(o(`Found ${i.length} owned sessions.`),0===i.length)return{value:void 0};i.sort(((e,t)=>e.index-t.index));const l=i[0].sessionId,c=[];let d=await this.createTransactionCursor(n,l);for(;d;){const e=d.value;(0,u.d)(e.operations);const t=this.activeTasks.get(e.id);e.sessionId===l&&c.push({...e,callback:t&&t.callback}),d=await d.continue()}return o(`Found ${c.length} tasks.`),r={sessionId:l,tasks:c},t?r.tasks.sort(((e,t)=>e.index&&t.index?e.index-t.index:e.timestamp-t.timestamp)):r.tasks.sort(((e,t)=>e.timestamp-t.timestamp)),{value:r}}))}saveTask(e,t,n){const o={id:t.id,userId:t.userId,spaceId:t.spaceId,sessionId:e,timestamp:t.timestamp,debug:t.debug,operations:t.operations,useSudoMode:t.useSudoMode};return m.Z.setOrIncTotal(this.activeTasks.size+1),this.activeTasks.set(o.id,t),this.db.startTransaction({storeNames:[_,g],mode:"readwrite",name:"IndexedDBTransactionStore.saveTask",timeoutMs:n},(async(t,n)=>{const i=t.objectStore(_),a=await i.index(S).get(e);if(n("Obtained session cursor."),!a){const t={sessionId:e,updatedAt:Date.now(),ownerSessionId:e};n(`Adding session ${t.sessionId}.`);try{await i.add(t)}catch(s){throw(0,f.XH)((0,r.tg)(s),`session ${t.sessionId}`)}}try{await t.objectStore(g).add(o)}catch(s){throw(0,f.XH)((0,r.tg)(s),`task ${o.id}`)}return this.debugLogger.log({from:"IndexedDBTransactionStore",type:"saveTask",level:"debug",data:{message:`create task ${o.id} in ${a?"existing":"NEW"} session ${e}`,sessionId:e,taskId:o.id,isNewSession:!Boolean(a)}}),{value:void 0}}))}async deleteSession(e){const{currentSessionId:t,sessionId:n}=e,o=await this.db.startTransaction({storeNames:[_,g],mode:"readwrite",name:"IndexedDBTransactionStore.deleteSession",timeoutMs:void 0},(async(e,o)=>{let r=await this.createTransactionCursor(e,n);for(o("Obtained transaction cursor.");r;){if(r.value.sessionId===n)return{value:`Attempt to delete non-empty session: has task ${r.value.id}`,abort:!0};r=await r.continue()}const i=e.objectStore(_),a=await i.index(S).get(n);if(!a)return{value:"Session is missing",abort:!0};const s=a;return s.ownerSessionId!==t?{value:`Attempt to delete another tab's session: owned by ${s.ownerSessionId}`,abort:!0}:(i.delete(s.index),{value:void 0})}));return o.error?o:o.value?{error:{type:"LogicalError",message:o.value,userDetails:"Could not perform an operation due to a logical error."}}:{value:void 0}}hasTasks(){return this.activeTasks.size>0||this.ownedSessionIds.size>0}getTotalNumberOfTasks(e){return this.db.startTransaction({storeNames:[g],mode:"readonly",name:"IndexedDBTransactionStore.getTotalNumberOfTasks",timeoutMs:e},(async e=>{const t=e.objectStore(g);return{value:await t.count()}}))}getTotalNumberOfTasksForUser(e,t){return this.db.startTransaction({storeNames:[g],mode:"readonly",name:"IndexedDBTransactionStore.getTotalNumberOfTasksForUser",timeoutMs:t},(async t=>{const n=t.objectStore(g).index(y);return{value:await n.count(e)}}))}async anySessionHasTasks(e){const t=await this.getTotalNumberOfTasks(e);return t.error?t:{value:t.value>0}}async hasTasksForUser(e,t){const n=await this.getTotalNumberOfTasksForUser(e,t);return n.error?n:{value:n.value>0}}hasTask(e){for(const[,t]of this.activeTasks)if(e(t))return!0;return!1}async deleteTasks(e){const t=await this.db.startTransaction({storeNames:[g,_],mode:"readwrite",name:"IndexedDBTransactionStore.deleteTasks",timeoutMs:void 0},(async(t,n)=>{const o=[],r=[],a=new Set,s=t.objectStore(g),l=s.index(b),c=t.objectStore(_);await(0,f.qv)(e.map((0,f.zp)((async e=>{o.push(e.id);const t=await l.openCursor(e.id);if(n(`Obtained transaction cursor for task ${e.id}.`),t){a.add(t.value.sessionId),await t.delete(),n(`Deleted task ${e.id}.`);const o=String(e.id);this.debugLogger.log({from:"IndexedDBTransactionStore",type:"deleteTasksDeleteTask",level:"debug",data:{message:`delete task ${e.id}`,taskId:o}})}else this.debugLogger.flush(),i.log({from:"IndexedDBTransactionStore",type:"deleteTasksTaskNotExist",level:"warning",data:{message:`could not delete task not stored in indexeddb ${e.id}`,taskId:e.id}})}))));const d=s.index(h);return a.forEach((async e=>{let n=0;if(this.runOptimizedScans)n=await d.count(this.getTransactionRange(e));else{let o=await this.createTransactionCursor(t,e);for(;o;){if(o.value.sessionId===e){n++;break}o=await o.continue()}}if(0===n){const t=await c.index(S).openCursor(e);t&&(r.push(t.value.sessionId),t.delete(),this.debugLogger.log({from:"IndexedDBTransactionStore",type:"deleteTasksDeleteSession",level:"debug",data:{message:`delete empty session ${e}`,sessionId:e}}))}})),{value:{deletedTaskIds:o,deletedSessionIds:r}}}));if(t.error)return t;const{deletedTaskIds:n,deletedSessionIds:o}=t.value;for(const r of n)this.activeTasks.delete(r);for(const r of o)this.ownedSessionIds.delete(r);return m.Z.updateRemaining(this.activeTasks.size),{value:void 0}}async checkObjectStores(){const e="IndexedDBTransactionStore.checkObjectStores",t=this.db.startTransaction({storeNames:["Session"],mode:"readonly",name:`${e}: read from Session object store`,timeoutMs:void 0},(async()=>Promise.resolve({value:"created IndexedDB transaction"}))),n=this.db.startTransaction({storeNames:["Transaction"],mode:"readonly",name:`${e}: read from Transaction object store`,timeoutMs:void 0},(async()=>Promise.resolve({value:"created IndexedDB transaction"}))),[o,r]=await Promise.all([t,n]);return{session:o,transaction:r}}async reset(){await this.db.reset(),this.activeTasks.clear(),this.ownedSessionIds.clear(),m.Z.updateRemaining(0)}async clearTasksForUser(e){const t=await this.db.startTransaction({storeNames:[g],mode:"readwrite",name:"IndexedDBTransactionStore.clearTasksForUser",timeoutMs:void 0},(async(t,n)=>{const o=[],r=t.objectStore(g);let i=await r.index(y).openCursor(IDBKeyRange.only(e));for(n("Obtained transaction cursor.");i;)o.push(i.value.id),await i.delete(),i=await i.continue();return{value:{deletedTaskIds:o}}}));if(t.error)return t;const{deletedTaskIds:n}=t.value;for(const o of n)this.activeTasks.delete(o);m.Z.updateRemaining(this.activeTasks.size)}getTransactionRange(e){return IDBKeyRange.bound([e,0],[e,Number.MAX_VALUE],!0,!0)}createTransactionCursor(e,t){const n=e.objectStore("Transaction");return this.runOptimizedScans?n.index(h).openCursor(this.getTransactionRange(t),"next"):n.openCursor()}}var x=n(15517),T=n(97448),M=n(54064),P=n(606),A=n(12139),R=n(63037),D=n(88632),E=n(26634),B=n(35092),F=n(24681);const O="NativeBackedTransactionQueue";class Z{constructor(e,t,n){this.lastTaskTimestamp=0,this.tasks=new Map,this.sessionId="00000000-0000-0000-0000-000000000000",this.events=new M.Z,this.retryReasonCounters={_total:0},this.startTime=Date.now(),this.debugLogger=new i.BatchedLogger({from:O,type:"BulkDebug",level:"info",maxLength:250}),this.connection=e,this.dependencies=t,i.log({from:O,level:"debug",type:"NativeBackedTransactionQueueCreated"}),n.subscribeToUpdateTransactionState((e=>this.updateTransactionState(e)))}async enqueueTask(e){this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp);const t=0===this.tasks.size;var n;(this.tasks.set(e.id,{...e,sessionId:this.sessionId}),this.hasTooManyOperations(e))&&i.log({from:O,type:"enqueueTask",level:"warning",data:{message:`enqueing task with operation count > ${Z.operationCountWarningThreshold}`,sessionId:this.sessionId,taskId:e.id,isNewSession:t,userAction:null===(n=e.debug)||void 0===n?void 0:n.userAction,miscDataToConvertToString:{operationsCount:e.operations.length}}});const o=JSON.stringify(e.operations).length;var r;this.stringifiedOperationSizeIsTooLarge(o)&&i.log({from:O,type:"enqueueTask",level:"warning",data:{message:`enqueing task with stringified operation count > ${Z.stringifiedOperationSizeByteThreshold} bytes`,sessionId:this.sessionId,taskId:e.id,isNewSession:t,userAction:null===(r=e.debug)||void 0===r?void 0:r.userAction,miscDataToConvertToString:{operationsCount:e.operations.length,stringifiedOperationsSize:o}}});await async function(e,t){await F.v`
		INSERT OR REPLACE INTO transactions (
		    id,
		    user_id,
		    space_id,
		    operations,
		    timestamp,
			debug
		)
		VALUES (
		    ${t.id},
		    ${t.userId||null},
		    ${t.spaceId||null},
		    ${JSON.stringify(t.operations)},
		    ${t.timestamp},
			${t.debug?JSON.stringify(t.debug):null}
		)
	`.run(e)}(this.connection,e),this.debugLogger.log({from:O,type:"enqueueTask",level:"debug",data:{message:`save task ${e.id} in memory (${this.tasks.size} total now)`,sessionId:this.sessionId,taskId:e.id,isNewSession:t}})}startLoop(){this.dependencies.timeSource.setTimeout((()=>this.healthcheckLoop()),1)}unpause(){}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return this.tasks.size>0}async hasTasksForUser(e){const t=await async function(e,t){return(await(0,B.gU)({connection:e,sql:"SELECT COUNT(*) AS count FROM transactions WHERE user_id = ?",args:[t]}))[0].count}(this.connection,e);return t>0}async getTotalNumberOfTasks(){return await async function(e){return(await(0,B.gU)({connection:e,sql:"SELECT COUNT(*) AS count FROM transactions"}))[0].count}(this.connection)}async anySessionHasTasks(){return await this.getTotalNumberOfTasks()>0}async reset(){await async function(e){await F.v`DELETE FROM transactions`.run(e)}(this.connection),this.tasks.clear()}async clearForUser(e){const t=await async function(e,t){const[n]=await(0,B.G$)({connection:e,statements:[{sql:"SELECT * FROM transactions WHERE user_id = ?",args:[t],getData:!0},{sql:"DELETE FROM transactions WHERE user_id = ?",args:[t]}],queryName:"deleteTransactionsForUser"});return n.data.map((e=>e.id))}(this.connection,e);for(const n of t)this.tasks.delete(n)}updateDependencies(e){this.dependencies=e}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return Array.from(this.tasks.values()).some((t=>t.operations.some((t=>(0,P.qo)(t.pointer,e)))))}hasTooManyOperations(e){return e.operations.length>=Z.operationCountWarningThreshold}stringifiedOperationSizeIsTooLarge(e){return e>=Z.stringifiedOperationSizeByteThreshold}async drain(){return this.tasks.size>0?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async healthcheckLoop(){for(;;){try{const e=await this.getTotalNumberOfTasks();e>Z.transactionSizeHealthcheckThreshold&&(this.debugLogger.flush(),i.log({level:"info",from:"NativeBackedSqliteTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:{queueSize:e}}}),this.dependencies.handleHealthcheck({queue_type:"NativeBackedSqliteTransactionQueue",uptime:Date.now()-this.startTime,queue_size:e,error_type:void 0,is_considered_online:D.Z.state.online,retry_reasons:this.retryReasonCounters}))}catch(e){this.debugLogger.flush(),i.log({level:"error",from:"NativeBackedSqliteTransactionQueue",type:"healthcheckLoopIteration",error:(0,s.Ui)(e)}),A.IE(e)}await l.Vs(Z.healthcheckInterval,this.dependencies.timeSource)}}updateTransactionState(e){(e.syncing||this.hasTasks())&&D.Z.setState({...D.Z.state,syncing:!0});let t=[],n=[];if(e.saveTransactionResult)if(e.saveTransactionResult.error){const{retryReason:o}=e.saveTransactionResult.error;o?(0,R.Os)(this.retryReasonCounters,o):this.retryReasonCounters={_total:0},t=e.saveTransactionResult.error.savedTasks.map((e=>this.tasks.get(e.id))).filter(p.$K),n=e.saveTransactionResult.error.failedTasks.map((e=>this.tasks.get(e.id))).filter(p.$K),(0,E.o)({backoffEstimate:void 0,retryReason:o})}else this.retryReasonCounters={_total:0},t=e.saveTransactionResult.value.map((e=>this.tasks.get(e.id))).filter(p.$K),n=[],(0,E.Om)();t.forEach((e=>{if(e.callback)try{e.callback(void 0)}catch(t){this.debugLogger.flush(),i.log({level:"error",from:"NativeBackedTransactionQueue",type:"updateTransactionStateSavedTask",data:{taskId:e.id},error:(0,s.Ui)(t)})}this.tasks.delete(e.id)})),n.forEach((e=>{if(e.callback)try{e.callback(new Error(`Failed to save transaction with id: ${e.id}`))}catch(t){this.debugLogger.flush(),i.log({level:"error",from:"NativeBackedTransactionQueue",type:"updateTransactionStateFailedTask",data:{taskId:e.id},error:(0,s.Ui)(t)})}this.tasks.delete(e.id),this.dependencies.rollbackTask(e)})),e.syncing||this.hasTasks()||(D.Z.setState({...D.Z.state,syncing:!1}),this.events.emit("drain"))}}Z.healthcheckInterval=5*d.hM,Z.transactionSizeHealthcheckThreshold=1e3,Z.operationCountWarningThreshold=500,Z.stringifiedOperationSizeByteThreshold=1e5;var V=n(77080),U=n(95424),N=n(82798),L=n(96826);class j{constructor(e,t){this.activeQueue=void 0,this.inMemoryTransactionQueue=void 0,this.indexedDBDrainListener=void 0,this.debugLogger=void 0,this.activeQueue=e,this.inMemoryTransactionQueue=t,this.indexedDBDrainListener=()=>this.handleIndexedDBQueueDrain(),this.debugLogger=new i.BatchedLogger({from:"IndexedDBToInMemoryTransactionQueue",type:"BulkDebug",level:"info",maxLength:250}),setTimeout((()=>{this.activeQueue instanceof L.Z&&(this.debugLogger.log({level:"error",from:"IndexedDBToInMemoryTransactionQueue",type:"constructor",data:{message:"IndexedDBTransactionQueue has not drained after 5 minutes."}}),this.debugLogger.flush())}),5*d.hM)}startLoop(){if(this.activeQueue instanceof L.Z){this.activeQueue.events.addListener("drain",this.indexedDBDrainListener)}this.activeQueue.startLoop()}handleIndexedDBQueueDrain(){const e=(0,N.R9)(this.activeQueue,L.Z);e.hasAttemptedToClaimSessions()&&(e.stopLoop(),e.events.removeListener("drain",this.indexedDBDrainListener),this.inMemoryTransactionQueue.startLoop(),this.activeQueue=this.inMemoryTransactionQueue,this.debugLogger.log({level:"info",from:"IndexedDBToInMemoryTransactionQueue",type:"constructor",data:{message:"Switching over from IndexedDBTransactionQueue to InMemoryTransactionQueue."}}))}logEmptyTaskForDebugging(e){var t,n;null===(t=(n=this.activeQueue).logEmptyTaskForDebugging)||void 0===t||t.call(n,e)}enqueueTask(e){return this.activeQueue.enqueueTask(e)}unpause(){this.activeQueue.unpause()}pause(){this.activeQueue.pause()}getLastTaskTimestamp(){return this.activeQueue.getLastTaskTimestamp()}hasTasks(){return this.activeQueue.hasTasks()}anySessionHasTasks(){return this.activeQueue.anySessionHasTasks()}getTotalNumberOfTasks(){return this.activeQueue.getTotalNumberOfTasks()}hasTasksForUser(e){return this.activeQueue.hasTasksForUser(e)}drain(){return this.activeQueue.drain()}awaitRecordTransaction(e){return this.activeQueue.awaitRecordTransaction(e)}isPendingTransactionForRecord(e){return this.activeQueue.isPendingTransactionForRecord(e)}reset(){return this.activeQueue.reset()}clearForUser(e){return this.activeQueue.clearForUser(e)}updateDependencies(e){this.activeQueue.updateDependencies(e),this.inMemoryTransactionQueue!==this.activeQueue&&this.inMemoryTransactionQueue.updateDependencies(e)}}var z=n(50619),q=n(2414),H=n(9425);const W="InMemoryTransactionQueue";class K{constructor(e){this.isProcessingTask=!1,this.lastTaskTimestamp=0,this.tasks=new Map,this.events=new M.Z,this.waiter=void 0,this.transactionBackoffController=new q.h(E._W),this.sessionId="00000000-0000-0000-0000-000000000000",this.retryReasonCounters={_total:0},this.startTime=Date.now(),this.debugLogger=new i.BatchedLogger({from:W,type:"BulkDebug",level:"info",maxLength:250}),this.dependencies=e}startLoop(){setTimeout((()=>this.txLoop()),1),setTimeout((()=>this.healthcheckLoop()),1)}enqueueTask(e){this.lastTaskTimestamp=Math.max(e.timestamp,this.lastTaskTimestamp);const t=0===this.tasks.size;return this.tasks.set(e.id,{...e,sessionId:this.sessionId}),m.Z.setOrIncTotal(this.tasks.size),this.debugLogger.log({from:W,type:"saveTask",level:"debug",data:{message:`save task ${e.id} in memory (${this.tasks.size} total now)`,sessionId:this.sessionId,taskId:e.id,isNewSession:t}}),this.getWaitable(!1).trigger(),Promise.resolve()}unpause(){this.transactionBackoffController.reset(),this.getWaitable(!1).trigger()}pause(){}getLastTaskTimestamp(){return this.lastTaskTimestamp}hasTasks(){return this.tasks.size>0}async hasTasksForUser(e){return Promise.resolve(Array.from(this.tasks.values()).some((t=>t.userId===e)))}updateDependencies(e){this.dependencies=e}async getTotalNumberOfTasks(){return Promise.resolve(this.tasks.size)}async anySessionHasTasks(){return Promise.resolve(this.hasTasks())}async drain(){return this.hasTasks()||this.isProcessingTask?new Promise((e=>{this.events.addOnceListener("drain",e)})):void 0}async awaitRecordTransaction(e){this.isPendingTransactionForRecord(e)&&await this.drain()}isPendingTransactionForRecord(e){return Array.from(this.tasks.values()).some((t=>t.operations.some((t=>(0,P.qo)(t.pointer,e)))))}async reset(){return this.tasks=new Map,m.Z.updateRemaining(0),Promise.resolve()}async clearForUser(e){const t=Array.from(this.tasks.values()).filter((t=>t.userId===e));for(const n of t)this.tasks.delete(n.id);return m.Z.updateRemaining(this.tasks.size),Promise.resolve()}async txLoop(){for(;;)try{await this.txLoopIteration()}catch(e){(0,R.Os)(this.retryReasonCounters,"txLoopException"),this.debugLogger.flush(),i.log({level:"error",from:W,type:"txLoopIteration",error:(0,s.Ui)(e)}),A.IE(e),await l.Vs(15e3)}}async txLoopIteration(){const e=this.hasTasks();e||(this.doneSyncing(),this.events.emit("drain"));const[t,n]=(0,H.Z)()?[R.xd,R.CE]:[R.V_,R.Ud];await this.wait(t,e?t:n);const o=Array.from(this.tasks.values()),r=Array.from(o).sort(((e,t)=>e.timestamp-t.timestamp));if(0===r.length)return;const a=[];for(let i=0;i<r.length;i++)r[i]!==o[i]&&a.push(i);a.length>0&&i.log({from:W,level:"warning",type:"TasksNotOrdered",data:{miscDataToConvertToString:{unsortedTaskIds:o.map((e=>e.id)),mismatch:a},taskIds:r.map((e=>e.id))}}),this.startSyncing(),await this.useSaveTransactionsApi(r)}async useSaveTransactionsApi(e){const t=await this.dependencies.handleSaveTransactions(e);if(t.error){const{savedTasks:e,failedTasks:o,message:r,retryDelay:a,retryReason:l}=t.error;var n;if(l?(0,R.Os)(this.retryReasonCounters,l):this.retryReasonCounters={_total:0},e.length>0&&(this.debugLogger.log({level:"debug",from:W,type:"handlePartialSaveTransactionsSuccess",data:{message:`will delete ${e.length} saved tasks`,taskIds:e.map((e=>e.id))}}),await this.cleanupTasks(e,void 0)),o.length>0?(this.debugLogger.flush(),i.log({level:"warning",from:W,type:"handleSaveTransactionsError",data:{message:r,taskIds:o.map((e=>e.id))},error:(0,s.Ui)(t.error)}),await this.cleanupTasks(o,t.error)):this.debugLogger.log({level:"debug",from:W,type:"handleSaveTransactionsRetryableError",data:{message:r}}),a>0)await this.transactionBackoffController.backOffOnFailure(a-R.V_,null===(n=t.error)||void 0===n?void 0:n.retryReason);else this.transactionBackoffController.reset()}else{const e=t.value;this.retryReasonCounters={_total:0},this.debugLogger.log({level:"debug",from:W,type:"handleSaveTransactionsSuccess",data:{message:`will clean up ${e.length} submitted tasks`,taskIds:e.map((e=>e.id))}}),this.transactionBackoffController.reset(),await this.cleanupTasks(e,void 0)}}async cleanupTasks(e,t){for(const o of e)if(o.callback)try{o.callback(t)}catch(n){this.debugLogger.flush(),i.log({level:"error",from:"InMemoryTransactionQueue",type:"cleanupTask",data:{taskId:o.id},error:(0,s.Ui)(n)})}for(const o of e)this.debugLogger.log({from:W,type:"deleteTasksDeleteTask",level:"debug",data:{message:`delete task ${o.id}`,taskId:o.id}}),this.tasks.delete(o.id);return m.Z.updateRemaining(this.tasks.size),Promise.resolve()}getWaitable(e){return this.waiter&&!e||(this.waiter=new l.a6),this.waiter}async wait(e,t){await this.getWaitable(!1).wait(e,t),this.getWaitable(!0)}startSyncing(){D.Z.setState({...D.Z.state,syncing:!0})}doneSyncing(){D.Z.setState({...D.Z.state,syncing:!1})}async healthcheckLoop(){for(;;){try{const e=await this.getTotalNumberOfTasks();if(e>K.transactionSizeHealthcheckThreshold){const t={queue_type:"InMemoryTransactionQueue",uptime:Date.now()-this.startTime,queue_size:e,error_type:void 0,is_considered_online:D.Z.state.online,retry_reasons:this.retryReasonCounters};this.debugLogger.flush(),i.log({level:"info",from:"InMemoryTransactionQueue",type:"transactionSizeHealthcheck",data:{miscDataToConvertToString:{queueSize:e}}}),this.dependencies.handleHealthcheck(t)}}catch(e){this.debugLogger.flush(),i.log({level:"error",from:"InMemoryTransactionQueue",type:"healthcheckLoopIteration",error:(0,s.Ui)(e)}),A.IE(e)}await l.Vs(K.healthcheckInterval)}}}K.healthcheckInterval=15*d.hM,K.transactionSizeHealthcheckThreshold=1e3;const G=K;var $=n(68026);const Q="FeatureFlagTransactionQueue",Y="00000000-0000-0000-0000-000000000000";async function X(e){if(!window.indexedDB)return{available:!1,message:"The IndexedDB API is missing or disabled on this platform."};if(e.device.isFirefox){const e="FirefoxFeatureCheck";if(!(await new Promise((t=>{const n=window.indexedDB.open(e);n.onerror=()=>t(!1),n.onsuccess=()=>{t(!0),window.indexedDB.deleteDatabase(e)}}))))return{available:!1,message:"IndexedDB is disabled in Firefox Private Browsing."}}if(e.device.isChrome&&parseInt(e.device.browserVersion,10)>=99){const e="Chrome99FeatureCheck";let n=!1;try{if(n=await new Promise((t=>{const n=window.indexedDB.open(e);n.onerror=()=>t(!1),n.onsuccess=()=>{t(!0),window.indexedDB.deleteDatabase(e)}})),!n)return{available:!1,message:"IndexedDB is unstable in Chrome 99."}}catch(t){return{available:!1,message:(0,r.tg)(t).message}}}return J()&&U.H.hasOccurredRecently()?{available:!1,message:"A NotionTransactionTimeout has happened recently, avoiding use of IndexedDB.",previousTimeouts:U.H.getTotal()}:{available:!0}}const J=a.HP((()=>"on"===(0,T.fastGetGroup)("indexeddb_graceful_fallback_to_in_memory_queue")));async function ee(e){const t=new $.TransactionQueueDependenciesImpl(e);async function n(){const n=await X(e);if(!n.available)return i.log({from:Q,level:"warning",type:"preferIndexedDBUnavailable",data:{previousTimeouts:n.previousTimeouts,miscDataToConvertToString:{message:n.message,userAgent:navigator.userAgent}}}),o();i.log({from:Q,type:"preferIndexedDB",level:"info"});const r=function(e,t){const n="react-native"===e.device.platform?Y:(0,c.ZP)(),o=new i.BatchedLogger({from:"IndexedDBTransactionQueue",type:"BulkDebug",level:"info",maxLength:250}),r=new C(o,e);return new L.Z({dependencies:t,transactionStore:r,sessionId:n,debugLogger:o,enableHeartbeatTimeout:J()})}(e,t),l=await(0,x.sK)();if(l&&!(0,x.mn)(l)){let e=!1;try{e=await r.anySessionHasTasks(),i.log({from:Q,type:"indexedDBStorageVeryFull",level:"warning",data:{storage:{hasTasks:e,...l}}})}catch(d){i.log({from:Q,level:"error",type:"indexedDBStorageReadError",data:{storage:l},error:(0,s.Ui)(d)})}if(!e)return new G(t)}if(e.device.isFirefox)try{const e=await r.checkObjectStores(),n=a.oA([e.transaction,e.session].map((e=>e.error)));if(n.length>0){const o=[];return e.transaction.error&&o.push("Transaction"),e.session.error&&o.push("Session"),i.log({from:Q,level:"error",type:"FirefoxHealthCheckFailed",error:{miscErrorString:(0,s.LK)(n)},data:{message:`Can't read ${o}. Using InMemoryTransactionQueue instead.`}}),new G(t)}}catch(d){return i.log({from:Q,level:"error",type:"indexedDBHealthCheckError",error:(0,s.Ui)(d)}),new G(t)}return J()?(r.events.addListener("timeout",(()=>{U.H.trackPersistently()})),new z.Z(r,new G(t))):r}function o(){return i.log({from:Q,type:"preferInMemory",level:"info"}),new G(t)}const{device:r,mobileNative:u}=e;if(r.isBrowser&&r.isDesktop){if(r.isChrome||r.isFirefox)return n();if(r.isSafari){if(parseInt(r.browserVersion,10)<17)return n();const e=(0,T.fastGetGroup)("safari_17_transaction_queue")??V.default.getGroup("safari_17_transaction_queue");if("force_in_memory"===e)return i.log({from:Q,type:"Safari17.forceInMemoryTransactionQueue",level:"info"}),o();const t=await n();if(t instanceof L.Z){if("prefer_indexed_db"===e)return i.log({from:Q,type:"Safari17.usingIndexedDBTransactionQueue",level:"info"}),t;if((await l.OI(15*d.C0,t.anySessionHasTasks())).result)return i.log({from:Q,type:"Safari17.usingIndexedDBToInMemoryTransactionQueue",level:"info"}),new j(t,o())}return i.log({from:Q,type:"Safari17.usingInMemoryTransactionQueue",level:"info"}),o()}return o()}return r.isBrowser&&r.isMobile?o():r.isElectron?n():r.isMobileNative&&u&&u.sqliteConnection?new Z(u.sqliteConnection,t,u):o()}(0,o.exposeDebugEnvironmentValue)("getIndexedDBAvailability",(e=>()=>X(e)));let te=new class{constructor(e,t){this.getActiveQueueName=void 0,this.queues=void 0,this.createQueues=void 0,this.getActiveQueueName=e,this.createQueues=t}getQueues(){const e=this.queues?this.queues:this.createQueues();return this.queues=e,e}applyToAllQueues(e){return Object.values(this.getQueues()).map(e)}applyToActiveQueue(e){return e(this.getQueues()[this.getActiveQueueName()])}startLoop(){this.applyToAllQueues((e=>e.startLoop()))}enqueueTask(e){return this.applyToActiveQueue((t=>t.enqueueTask(e)))}unpause(){this.applyToAllQueues((e=>e.unpause()))}pause(){this.applyToAllQueues((e=>e.pause()))}getLastTaskTimestamp(){return this.applyToActiveQueue((e=>e.getLastTaskTimestamp()))}hasTasks(){return this.applyToAllQueues((e=>e.hasTasks())).some(Boolean)}async hasTasksForUser(e){return(await Promise.all(this.applyToAllQueues((t=>t.hasTasksForUser(e))))).some((e=>e))}updateDependencies(e){this.applyToAllQueues((t=>t.updateDependencies(e)))}async anySessionHasTasks(){for(const e of this.applyToAllQueues((e=>e.anySessionHasTasks())))if(await e)return!0;return!1}async getTotalNumberOfTasks(){return a.Sm(await Promise.all(this.applyToAllQueues((e=>e.getTotalNumberOfTasks()))))}async drain(){await Promise.all(this.applyToAllQueues((e=>e.drain())))}awaitRecordTransaction(e){return this.applyToActiveQueue((t=>t.awaitRecordTransaction(e)))}isPendingTransactionForRecord(e){return this.applyToAllQueues((t=>t.isPendingTransactionForRecord(e))).some(Boolean)}async reset(){await Promise.all(this.applyToAllQueues((e=>e.reset())))}async clearForUser(e){await Promise.all(this.applyToAllQueues((t=>t.clearForUser(e))))}}((()=>"error"),(()=>{throw new Error("Need to await setupTransactionQueue")}));const ne=async e=>(te=await ee(e),te),oe=e=>{te=e}},66353:(e,t,n)=>{n.d(t,{RJ:()=>s,Rx:()=>a,Ve:()=>c,ZP:()=>p,fK:()=>i,uZ:()=>l});var o=n(49085),r=n(54153);const i=320,a=470,s=390,l="unread_and_read",c={filter:l,width:s},d="notification_inbox_panel";const u=o.default.createValue(function(){const e=r.Z.get(d);return{...c,...e}}());u.addListener((e=>{try{t=e.state,r.Z.set(d,t)}catch{}var t}));const p=u},45325:(e,t,n)=>{n.r(t),n.d(t,{NotificationInboxFilterOptions:()=>i,default:()=>s});var o=n(49085),r=n(97880);const i=["unread_and_read","unread_only","archived_only","all_updates"];class a extends o.default{getInitialState(){return{openState:"closed",mode:"panel",isResizerHovered:!1,isResizing:!1,discussionIdToExpansionStartPointMap:{}}}isOpen(){const{openState:e}=this.state;switch(e){case"open":case"opening":return!0;case"closed":case"closing":return!1;default:(0,r.t1)(e)}}isTransitioningOpenState(){const{openState:e}=this.state;switch(e){case"opening":case"closing":return!0;case"open":case"closed":return!1;default:(0,r.t1)(e)}}}const s=new a},45946:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(53809),r=n(30548);const i=new o.D({key:"openInDesktopApp",namespace:r.$p,important:!0,trackingType:"necessary"})},64970:(e,t,n)=>{n.d(t,{m:()=>o});const o=n(49085).default.createValue(!1)},70704:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{isHidden:!1}}}const i=r},79689:(e,t,n)=>{n.d(t,{L:()=>i,c:()=>a});var o=n(49085);const r=new Map;function i(e){const t="shared"===e.type?e.type:`${e.type}${e.teamId}${e.teamOutlinerType}`,n=r.get(t);if(n)return n;{const e=o.default.createValue(!1);return r.set(t,e),e}}function a(){const e=Array.from(r.entries());return 0===e.length||e.every((e=>!e[1].state))}},19671:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(58484).Z)},93220:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{ready:!1,initialRequestCompleted:!1,loading:!1,endOfResultsReached:!1,error:void 0,currentCursor:void 0,currentChunkNumber:void 0}}}const i=r},85526:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{forceShowProperties:!1,searchOpen:!1,searchQuery:""}}}const i=new r},94896:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{pages:new Set}}setStatus(e,t){t?this.state.pages.add(e):this.state.pages.delete(e),this.emit()}}const i=new r},82136:(e,t,n)=>{n.d(t,{S:()=>r,Z:()=>a});var o=n(49085);let r=function(e){return e[e.Frame=0]="Frame",e[e.PeekView=1]="PeekView",e[e.InAppTemplatePreview=2]="InAppTemplatePreview",e[e.InPageSnapShot=3]="InPageSnapShot",e[e.CollectionPageView=4]="CollectionPageView",e}({});class i extends o.default{getInitialState(){return{forceDiscussionOpen:!1}}}const a=i},85844:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{isVisible:!0}}}const i=new r},72014:(e,t,n)=>{n.d(t,{$g:()=>a,jx:()=>s});var o=n(49085),r=n(4615);class i extends o.default{getInitialState(){}initializeNewPageVisitId(){this.setState((0,r.ZP)())}getCurrentPageVisitId(){return this.getState()}}const a=new i,s=new i},69503:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1,hasPassword:!1}}isSetNewPasswordModal(){const e=this.state;return!0===e.setNewPassword&&!1===e.isSet}isPasswordSetModal(){const e=this.state;return!0===e.setNewPassword&&!0===e.isSet}isRemovePasswordModal(){const e=this.state;return!0===e.removePassword&&!1===e.isSuccess}isRemovePasswordSuccessModal(){const e=this.state;return!0===e.removePassword&&!0===e.isSuccess}isVerifyIdentityWithMfaModal(){return!0===this.state.verifyIdentity}isPasswordModalClosed(){return!this.state.open}}const i=new r},91551:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(8297).Z)},13023:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(58484).Z)},88923:(e,t,n)=>{n.r(t),n.d(t,{CenterPeekModeOuterWidth:()=>c,PeekModeCenter:()=>i,PeekModeOuterPadding:()=>l,PeekModePadding:()=>s,PeekModeSide:()=>a,default:()=>v,getPeekModeFromCollectionPeekModeFormat:()=>u,getPeekModeFromUrlParam:()=>d,getUrlParamFromPeekMode:()=>p,sidePeekInitialMaxWidth:()=>m,sidePeekMinWidth:()=>g,sidePeekNoColumnWidth:()=>f});var o=n(14577),r=n(49085);const i="center_peek",a="side_peek",s={horizontal:{center_peek:126,side_peek:48}},l=72,c=708+2*s.horizontal[i];function d(e){switch(e){case"s":return a;case"c":return i}}function u(e){switch(e){case"side_peek":return a;case"center_peek":return i}}function p(e){switch(e){case a:return"s";case i:return"c"}}const m=980,f=640,g=430;class h extends r.default{constructor(){super(...arguments),this.isSidePeekOpening=new o.Z((()=>this.state.open&&this.isSidePeekOpen()&&this.state.isOpening),{debugName:"isSidePeekOpening"}),this.isSidePeekClosing=new o.Z((()=>this.state.open&&this.state.isClosing),{debugName:"isSidePeekClosing"}),this.peekTarget=new o.Z((()=>this.state.open?this.state.target:void 0),{debugName:"peekTarget"})}getInitialState(){return{open:!1,mode:i,preferredSidePeekWidth:0,savedSidebarExpandedStoreState:!1}}getCollectionModeFormat(){switch(this.state.mode){case a:return"side_peek";case i:return"center_peek"}}getPeekMode(){return this.state.open?this.state.mode:a}getPeekModeWidth(e){return this.isCenterPeekOpen()?c:this.getSidePeekWidth(e)}getSidePeekWidth(e){const t=Math.min(e/2,m),n=this.state.preferredSidePeekWidth||t;return Math.min(Math.max(n,g),e)}setSidePeekWidth(e,t){const n=Math.min(Math.max(e,g),t);this.setState({...this.state,preferredSidePeekWidth:n})}isCenterPeekOpen(){return this.state.open&&this.state.mode===i}isSidePeekOpen(){return this.state.open&&this.state.mode===a&&!this.state.isClosing}setSidebarExpandedStoreState(e){this.setState({...this.state,savedSidebarExpandedStoreState:e})}}const v=new h},98452:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},99332:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},24612:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},42057:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(92595),r=n(45589);const i=(0,o.exposeDebugValue)("PeekViewScrollerStore",new r.Z)},29677:(e,t,n)=>{n.d(t,{Db:()=>a,cl:()=>r,fZ:()=>o,ow:()=>i});n(49085),n(21202);function o(e){return"existingUser"===e.type}function r(e){return"newUser"===e.type}function i(e){const t=e.inviteTargets[0];return!(!t||"bot"!==t.type)}function a(e){return e.inviteTargets.every((e=>"existingUser"===e.type||"newUser"===e.type||"group"===e.type))}},60709:(e,t,n)=>{n.d(t,{FJ:()=>m,Iw:()=>u,ZP:()=>g,lU:()=>p});var o=n(49085),r=n(4023),i=n(15723);const{Top:a,Bottom:s,Left:l,Right:c,Center:d}=r.u,u=r.u,p=r.v,m=e=>{switch(e){case a:return s;case s:return a;case l:return c;case c:return l;case d:return d}};class f extends o.default{getInitialState(){return{open:!1,placementFlipped:!1,offsetX:0,offsetY:0,originRect:i.bM}}}const g=f},24864:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(70704).Z)},83212:(e,t,n)=>{n.d(t,{Z:()=>l,m:()=>a});var o=n(49085),r=n(72141),i=n(46654);const a={disabled:{hasPublicPermission:!1},view:{hasPublicPermission:!0,permission:"view"},comment:{hasPublicPermission:!0,permission:"comment"},edit:{hasPublicPermission:!0,permission:"edit"}};Object.freeze(a),Object.freeze(a.disabled),Object.freeze(a.view),Object.freeze(a.comment),Object.freeze(a.edit);class s extends o.default{getInitialState(){return{editing:!1,commenting:!1}}getMode(e,t){const n=this.getModeType(e,t)||"disabled";return a[n]}getModeType(e,t){if(!t.isDefaultRecordCache()||!(0,i.IJ)(e,t))return;const n=t.getRole(),o=!n||(0,r.J5)(n),a=!n||(0,r.RF)(n),s=e.currentUser.isLoggedIn();return o&&s&&this.state.editing?"edit":a&&s?"comment":"view"}}const l=new s},81236:(e,t,n)=>{n.d(t,{Z:()=>l});var o=n(49085),r=n(92595),i=n(15157);class a extends o.default{constructor(){super(...arguments),this.promiseMap={},this.fetch=async(e,t,n)=>{const o=await this.fetchInner(e,t,n);return this.state.dataMap[t]=o,this.emit(),o},this.fetchInner=async(e,t,o)=>{const r=await Promise.resolve().then(n.bind(n,54642)),a=e.currentUser.id,s=`{PublicSpaceData}:${t}`;o&&i.Z.set({userId:e.currentUser.id,key:s,value:null});const l=i.Z.get({userId:a,key:s});if(l)return l;const c=await r.getPublicSpaceData(e,{type:"space-ids",spaceIds:[t]}),d="success"===c.type?c.data.results[0]??null:null;return i.Z.set({userId:e.currentUser.id,key:s,value:d}),d}}getInitialState(){return{dataMap:{}}}getPublicSpaceData(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n&&(this.promiseMap[t]=null),this.promiseMap[t]??=this.fetch(e,t,n),this.state.dataMap[t]}async awaitPublicSpaceData(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return n&&(this.promiseMap[t]=null),this.promiseMap[t]??=this.fetch(e,t,n),this.promiseMap[t]}TEST_ONLY__setPublicSpaceData(e,t){this.promiseMap[e]=Promise.resolve(t),this.state.dataMap[e]=t,this.emit()}}const s=new a;r.exposeDebugValue("PublicSpaceDataStore",s);const l=s},69784:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{isActive:!1}}}const i=new r},13105:(e,t,n)=>{n.d(t,{P:()=>i});var o=n(14577),r=n(92595);class i{constructor(e){this.memo=new WeakMap,this.debugName=void 0,this.hits=0,this.misses=0,this.getStateFor=e=>this.computeMemo(e),this.computeMemo=e=>{let t=this.memo.get(e);return t?this.hits++:(this.misses++,t=new o.Z((()=>this.options.compute(e,this.options.memoizeRecursion?this.computeMemo:this.computeNonMemo)),{debugName:this.debugName}),this.memo.set(e,t)),t.getState()},this.computeNonMemo=e=>this.options.compute(e,this.computeNonMemo),this.options=e,this.debugName=`RecursiveComputedStore.${e.debugName}`,(0,r.exposeDebugInstance)(this.debugName,this)}}},64951:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{}}isActive(){return Boolean(this.state.blockStore)}}const i=new r},82187:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{}}isActive(){return Boolean(this.state.clonedBlockStore)}}const i=new r},72087:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{ready:!1,loading:!1}}}const i=r},91681:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{isResizing:!1}}}const i=new r},70354:(e,t,n)=>{n.r(t),n.d(t,{default:()=>u,groupIntervalMs:()=>c});var o=n(49085),r=n(72126),i=n(11799),a=n(97880),s=n(82798);class l{constructor(){this.idMap=new i.Z({getKey:e=>{let{textInstanceId:t,opId:n}=e;return`${t},${n[0]},${n[1]}`}})}remapIdsForReinsertedText(e,t){(0,s.T)(t.args.textInstanceId===e.args.textInstanceId),(0,s.T)(r.Xy(t.args.originId,e.args.originId)),(0,s.T)(t.args.content.length===e.args.deletedIds.length);const n=t.args.id,o=t.args.content;for(let r=0;r<o.length;r++)this.addMapping({textInstanceId:e.args.textInstanceId,opId:e.args.deletedIds[r]},{textInstanceId:t.args.textInstanceId,opId:[n[0],n[1]+r]})}addMapping(e,t){(0,s.T)(!this.idMap.has(e)),(0,s.T)(!this.idMap.has(t)),(0,s.T)(e.textInstanceId===t.textInstanceId,"IDs can only be remapped within the same text instance"),this.idMap.set(e,t)}getMappedId(e){let t,n=e;for(;n=this.idMap.get(n);)t=n;return t}getInvertedTextOperationWithMaybeRemappedIds(e){switch(e.command){case"invertedInsertText":{var t,n;const o=null===(t=this.getMappedId({textInstanceId:e.args.textInstanceId,opId:e.args.startId}))||void 0===t?void 0:t.opId,r=null===(n=this.getMappedId({textInstanceId:e.args.textInstanceId,opId:e.args.endId}))||void 0===n?void 0:n.opId;return o||r?{...e,args:{...e.args,startId:o??e.args.startId,endId:r??e.args.endId}}:e}case"invertedAddAnnotation":case"invertedRemoveAnnotation":{var o,r;const t=null===(o=this.getMappedId({textInstanceId:e.args.startTextInstanceId,opId:e.args.startId}))||void 0===o?void 0:o.opId,n=null===(r=this.getMappedId({textInstanceId:e.args.endTextInstanceId,opId:e.args.endId}))||void 0===r?void 0:r.opId;if("invertedAddAnnotation"===e.command)return t||n?{...e,args:{...e.args,startId:t??e.args.startId,endId:n??e.args.endId}}:e;if("invertedRemoveAnnotation"===e.command)return t||n?{...e,args:{...e.args,startId:t??e.args.startId,endId:n??e.args.endId}}:e;(0,a.t1)(e);break}case"invertedDeleteText":{var i;const t=null===(i=this.getMappedId({textInstanceId:e.args.textInstanceId,opId:e.args.originId}))||void 0===i?void 0:i.opId;return t?{...e,args:{...e.args,originId:t??e.args.originId}}:e}case"invertedMoveTextSlice":return e;default:(0,a.t1)(e)}}}const c=700;class d extends o.default{getInitialState(){return{undoStack:[],redoStack:[],invertedTextOperationIdMapper:new l}}}const u=new d},49557:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),r=n(92595);class i extends o.default{getInitialState(){return{isActive:!1,isAnimatingClosed:!1,top:0,left:0}}}const a=(0,r.exposeDebugValue)("RichTextMenuStore",new i)},4935:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},45589:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{isScrolling:!1,scrollTop:0,scrollHeight:0,scrollLeft:0,scrollWidth:0,clientWidth:0}}}const i=r},32470:(e,t,n)=>{n.d(t,{BJ:()=>m,ZP:()=>h,gq:()=>g,lO:()=>f,v_:()=>p});var o=n(49085),r=n(15157),i=n(72126),a=n(53772),s=n(95477);const l="SearchDebugStorePersistenceKey";class c extends o.default{setState(e){super.setState(e),function(e){let{newState:t,key:n}=e;r.Z.set({userId:"global",key:n,value:t})}({newState:e,key:this.getPersistenceKey()})}setStateWithoutPersisting(e){super.setState(e)}reloadFromDisk(){const e=r.Z.get({userId:"global",key:this.getPersistenceKey()});super.setState({...this.getInitialState(),...e})}}class d extends c{constructor(e){super(),this.column=void 0,this.getPersistenceKey=()=>`${l}:${this.column}`,this.updateForcedClusterPattern=e=>{this.setState({...this.state,forcedClusterPattern:e})},this.updateForcedBlockIds=e=>{this.setState({...this.state,forcedBlockIds:e})},this.column=e}getInitialState(){return{forcedClusterPattern:void 0,forcedBlockIds:void 0,searchExperimentOverrides:{},visible:!0}}hasDebugOverrides(){return!i.xb(this.state.forcedClusterPattern)||!i.xb(this.state.searchExperimentOverrides)||!i.xb(this.state.forcedBlockIds)}}const u=new class extends c{constructor(){super(...arguments),this.getPersistenceKey=()=>l}getInitialState(){return{showDebugInfo:!1,debug:void 0}}getDebugLevel(){return this.state.debug??(this.state.showDebugInfo?"explain":void 0)}},p=new d("left"),m=new d("right");function f(){u.reloadFromDisk(),p.reloadFromDisk(),m.reloadFromDisk()}function g(e){let{device:t}=e;return(0,a.x)(s.default)&&!t.isMobile&&(p.hasDebugOverrides()||m.hasDebugOverrides()||p.state.forcedClusterPattern||m.state.forcedClusterPattern)&&m.state.visible}const h=u},55320:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1,openAsPage:!1,openedTimeMs:void 0,sessionId:void 0,isPublicPageSearch:!1,preferSidePeekOpen:!0}}closeAndResetMetricsState(){this.update((e=>({...e,open:!1,openAsPage:!1,openedTimeMs:void 0,sessionId:void 0})))}isOpen(){return this.state.open||this.state.openAsPage}}const i=new r},87956:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){}}const i=new r},29026:(e,t,n)=>{n.d(t,{Xv:()=>l,ZP:()=>u});var o=n(49085),r=n(15157),i=n(94804),a=n(92338),s=n(80444);const l=20;let c=function(e){return e.Default="Default",e.Results="Results",e}({});class d extends o.default{constructor(){super(...arguments),this.resetQuery=e=>{let{resetFilters:t}=e;this.setState({...this.state,query:{...this.state.query,text:"",...t&&{filters:(0,a.u4)()}},limit:l,source:"quick_find_input_change"})},this.resetFilters=()=>{this.update((e=>({...e,query:{...e.query,filters:(0,a.u4)()}})))},this.updateFilters=e=>{const t=this.state.query.filters,n=(0,a.jl)(t,e);this.setState({...this.state,query:{...this.state.query,filters:n},limit:l,source:"quick_find_filters"})},this.setIsAnyPopupOpen=e=>{this.update((t=>({...t,isPopupOpen:e})))},this.expandFilterBar=()=>{this.updateFilterBarVisibilityState(!0)},this.collapseFilterBar=()=>{this.updateFilterBarVisibilityState(!1)},this.updateFilterBarVisibilityState=e=>{var t;const n=null===(t=s.default.state.currentUserStore)||void 0===t?void 0:t.id;n&&(r.Z.set({userId:n,key:i.rE,value:e}),this.update((t=>({...t,filterBar:{...t.filterBar,show:e}}))))},this.updateQueryText=e=>{this.setState({...this.state,query:{...this.state.query,text:e},limit:l,source:"quick_find_input_change"})},this.switchToSearchPane=()=>{this.setState({...this.state,mode:"search"})}}getInitialState(){return{mode:"search",isSidePeekPanelOpen:!1,isDebugSidebarOpen:!1,query:{text:"",filters:(0,a.u4)(),sort:{field:"relevance"}},limit:l,source:"quick_find",hasScrolled:!1,filterBar:{order:["titleToggle","personFilter","teamsFilter","pageFilter","dateFilter","dev_notInPageFilter","dev_notInTeamFilter"],show:!0},isPopupOpen:!1}}updateFilterOrder(e){this.setState({...this.state,filterBar:{...this.state.filterBar,order:e}})}hasQuery(){return Boolean(this.state.query.text)}isDebugSidebarOpen(){return this.state.isDebugSidebarOpen}}d.Mode=c;const u=new d},86486:(e,t,n)=>{n.r(t),n.d(t,{default:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{isOpen:!1}}}const i=new r},50628:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),r=n(92595);class i extends o.default{getInitialState(){return{selectableRectMap:new Map,selectableContainerRectMap:new Map,selectableElementRectMap:new Map,lastUpdate:0}}hasBeenUpdatedSince(e){return this.state.lastUpdate>e}}const a=new i;(0,r.exposeDebugValue)("SelectableRectStore",a);const s=a},27724:(e,t,n)=>{n.r(t),n.d(t,{SelectionPhase:()=>c,default:()=>u});var o=n(49085),r=n(97880),i=n(16339),a=n(95802),s=n(88923),l=n(79797);let c=function(e){return e[e.Selected=0]="Selected",e[e.Editing=1]="Editing",e}({});class d extends o.default{getInitialState(){return{stores:[],phase:c.Selected}}cloneState(){return{stores:[...this.state.stores],phase:this.state.phase}}getEditing(){if(this.state.phase===c.Editing)return this.state.stores[0]}isSelected(){return this.state.stores.length>0&&this.state.phase===c.Selected}getNodes(){return this.state.stores.map((e=>a.C.findNodeFromStore(e)||void 0)).filter(r.$K)}getCurrentRootStore(){var e,t;const n=null===(e=this.getCurrentDefaultContainer())||void 0===e?void 0:e.props.store;return n&&n instanceof l.G?n:null===(t=this.getDefaultContainer())||void 0===t||null===(t=t.props)||void 0===t?void 0:t.store}getCurrentRecordCache(){const e=this.getCurrentRootStore();if(e)return e.inMemoryRecordCache}getDefaultContainerFromTarget(e){return i.Z.find((t=>{const n=t.getNode();return Boolean(n&&n.contains(e))}))}getCurrentDefaultContainer(){const e=this.state.anchorContainer;return e||this.getDefaultContainer()}getDefaultContainer(){const e=this.state.defaultContainerStack;if(e&&e.length>0)return e[e.length-1]}isInPeekRenderer(){if(this.state.anchorContainer)return Boolean(this.state.anchorContainer.isPeekRenderer());{var e;const t=Boolean(null===(e=this.state.anchor)||void 0===e?void 0:e.isPageBlock()),n=s.default.state.open&&this.state.anchor===s.default.state.target;return t&&n}}}const u=new d},77794:(e,t,n)=>{n.d(t,{E:()=>a});var o=n(49085),r=n(72126),i=n(15723);class a{constructor(e){this.rect=o.default.createValue(i.bM),this.el=void 0,this.resizeObserver=void 0,this.options=void 0,this.recomputeThrottled=void 0,this.recompute=()=>{var e;const t=(null===(e=this.el)||void 0===e?void 0:e.getBoundingClientRect())??i.bM;return this.rect.setState(t),t},this.options=e||{},this.options.throttleMs&&(this.recomputeThrottled=r.P2(this.recompute,this.options.throttleMs))}observe(e){this.el=e,"undefined"!=typeof ResizeObserver&&(this.resizeObserver=new ResizeObserver(this.getRecomputeFn()),this.resizeObserver.observe(this.el)),this.recompute()}destroy(){this.resizeObserver&&this.resizeObserver.disconnect()}getRecomputeFn(){return this.recomputeThrottled||this.recompute}}},10743:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},1310:(e,t,n)=>{n.d(t,{JY:()=>i,Ty:()=>r,ZP:()=>s});var o=n(49085);const r=5e3,i=1e4;class a extends o.default{getInitialState(){return{currentItem:void 0,shouldReset:!0}}}const s=new a},64404:(e,t,n)=>{n.d(t,{Q:()=>r,Z:()=>a});var o=n(49085);let r=function(e){return e.Members="members",e.Groups="groups",e.Guests="guests",e.Reprovisioning="reprovisioning",e.Requests="requests",e}({});class i extends o.default{getInitialState(){return{currentTab:r.Members,limitMembers:!0,limitGuests:!0,limitTeamGuests:!0,membersFilter:"",guestsFilter:"",teamGuestsFilter:"",groupsFilter:"",groupNameInputValue:"",upsellModalOpen:!1,sorts:{members:{group:"members",by:"role",asc:!1},guests:void 0,team_guests:void 0}}}}const a=i},92083:(e,t,n)=>{n.d(t,{R:()=>r,Z:()=>a});var o=n(49085);let r=function(e){return e[e.OpenInDesktopApp=0]="OpenInDesktopApp",e[e.TwoStepVerification=1]="TwoStepVerification",e}({});class i extends o.default{getInitialState(){return{open:!1,currentTab:"settings",defaultSubtab:void 0,highlightedSetting:void 0,openedFrom:void 0}}}const a=new i},27242:(e,t,n)=>{n.d(t,{U:()=>r,Z:()=>a});var o=n(49085);let r=function(e){return e.CurrentSpace="current-space",e.TargetSpace="domain-claim-upgrade-team-plan-workspace",e}({});class i extends o.default{getInitialState(){return{open:!1,type:r.CurrentSpace}}closeWithSuccess(){this.setState({open:!1,succeeded:!0})}closeWithFailure(){this.setState({open:!1,succeeded:!1})}open(e){const{subscriptionTier:t,addOnFeature:n,billingInterval:o,coupon:i,isTrial:a,sessionId:s}=e;this.setState({open:!0,temporaryBillingInterval:o,temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},appliedPromo:void 0,error:void 0,subscriptionTier:t,vatApplicable:!1,calculatingTax:!1,payButtonState:"enabled",type:r.CurrentSpace,addOnFeature:n,onlyShowAddOn:void 0!==n,sessionId:s,coupon:i,isTrial:a})}setAddressField(e){this.state.open&&this.setState({...this.state,temporaryAddress:{...this.state.temporaryAddress,...e},taxCalculationError:void 0})}setValidationErrorState(e,t){const n=this.state;if(!n.open)return;const o=n.validationErrors??{};o[e]=t,this.setState({...n,validationErrors:o})}clearValidationErrorState(e){const t=this.state;t.open&&t.validationErrors&&e in t.validationErrors&&(delete t.validationErrors[e],this.setState({...t}))}}const a=new i},9209:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},99757:(e,t,n)=>{n.d(t,{Z:()=>l,n:()=>s});var o=n(14577),r=n(49085);class i extends r.default{constructor(){super(...arguments),this.updateRemaining=e=>{this.state.remainingPending!==e&&(0===e?this.setState({...this.state,totalPending:0,remainingPending:0}):this.setState({...this.state,remainingPending:e}))}}getInitialState(){return{totalPending:0,remainingPending:0,transactionQueueError:void 0,storageUsageEstimate:void 0,connectionError:void 0}}percentComplete(e){if(this.state.totalPending>0){const t=1-this.state.remainingPending/this.state.totalPending;return e.formatNumber(t,{style:"percent",maximumFractionDigits:0})}return e.formatNumber(1,{style:"percent"})}setOrIncTotal(e){this.state.totalPending>e?this.setState({...this.state,totalPending:this.state.totalPending+1}):this.setState({...this.state,totalPending:e})}}const a=new i,s=new o.Z((()=>Boolean(a.state.transactionQueueError)),{debugName:"transactionQueueUnhealthyStore"}),l=a},26634:(e,t,n)=>{n.d(t,{Om:()=>r,_W:()=>a,o:()=>i});var o=n(99757);function r(){o.Z.setState({...o.Z.state,connectionError:void 0})}function i(e){const{connectionError:t}=o.Z.state,n=Date.now(),r=void 0===e.backoffEstimate?void 0:e.backoffEstimate+n;o.Z.setState({...o.Z.state,connectionError:{startTime:(null==t?void 0:t.startTime)??n,numAttempts:t?t.numAttempts+1:1,approximateBackoffDelayEndTime:r,retryReason:e.retryReason??(null==t?void 0:t.retryReason)}})}const a={onReset:r,onBackoff(e,t){i({backoffEstimate:e,retryReason:t})}}},42185:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(49085).default.createValue(void 0)},30397:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{teams:[],lastEmitData:{value:"no value saved yet",spaceId:void 0,userId:void 0}}}shouldRefetchTeamsInSpace(e){let{currentUserId:t,currentSpaceId:n,emitValue:o}=e;const{spaceId:r,userId:i,value:a}=this.state.lastEmitData;return n!==r||(t!==i||o!==a)}}const i=new r},24666:(e,t,n)=>{n.r(t),n.d(t,{TextSelectionStore:()=>l,default:()=>c});var o=n(14577),r=n(49085),i=n(72126),a=n(62965),s=n(68056);class l extends r.default{constructor(){super(...arguments),this.isEditingStore=new o.Z((()=>"editing"===this.state.mode),{debugName:"isEditingStore"}),this.isExpandedStore=new o.Z((()=>"empty"!==this.state.mode&&!(0,s.iG)(this.state.multiSelection)),{debugName:"isExpandedStore"})}getInitialState(){return{mode:"empty"}}setState(e){if("empty"===e.mode||"empty"===this.instanceState.mode)return super.setState(e);if(!(0,a.Z)(this.instanceState,e)){const{savedSelectionXPosition:t,...n}=this.instanceState,{savedSelectionXPosition:o,...r}=e;this.instanceState=e,(0,a.Z)(n,r)||this.emit()}}cloneState(){return"editing"===this.state.mode?{mode:"editing",multiSelection:(0,s.k_)(this.state.multiSelection),savedSelectionXPosition:this.state.savedSelectionXPosition,forceExtendAnnotations:i.Xh(this.state.forceExtendAnnotations)}:"readOnly"===this.state.mode?{mode:"readOnly",multiSelection:(0,s.k_)(this.state.multiSelection),savedSelectionXPosition:this.state.savedSelectionXPosition}:{mode:"empty"}}isEmptySelection(){if("empty"===this.state.mode)return!0;const{multiSelection:e}=this.state;return(0,s.iG)(e)}isEditingComment(){return"editing"===this.state.mode&&("comment"===this.state.multiSelection.start.store.table||"comment"===this.state.multiSelection.end.store.table)}isEditingCaption(){return"editing"===this.state.mode&&(i.Xy(this.state.multiSelection.start.store.path,["properties","caption"])||i.Xy(this.state.multiSelection.end.store.path,["properties","caption"]))}hasSelection(){return"empty"!==this.state.mode}isEditingEmptyBlock(){return!("empty"===this.state.mode||!this.isEmptySelection())&&!this.state.multiSelection.start.store.isDefined()}}const c=new l},45131:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{}}setOpen(e,t){this.setState({...this.state,[e]:t})}toggle(e){this.setState({...this.state,[e]:!this.isOpen(e)})}isOpen(e){return!!this.state[e]}}const i=new r},48588:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),r=n(92595);class i extends o.default{getInitialState(){}}const a=new i;(0,r.exposeDebugValue)("TokenHoverStore",a);const s=a},58948:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{focused:!1,hovered:!1}}}const i=r},16194:(e,t,n)=>{n.d(t,{Z:()=>o});const o=n(49085).default.createValue(!1)},52258:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},66708:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},77503:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},59238:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{isDragging:!1}}}const i=new r},68026:(e,t,n)=>{n.r(t),n.d(t,{TransactionQueueDependenciesImpl:()=>F});var o=n(68626),r=n(91155),i=n(21051),a=n(3022),s=(n(21703),n(57658),n(92595)),l=n(59730),c=n(72126),d=n(4615),u=n(97880),p=n(9291),m=n(54642),f=n(47307),g=n(77080),h=n(56518),v=n(33954),b=n(24608),y=n(33929),_=n(44133),S=n(482),w=n(4408);async function k(e,t){const n=c.mN(t.operations.flatMap((e=>[e.pointer,...(0,S.S)(e)?e.additionalUpdatedPointers??[]:[]])),(e=>e.id));await Promise.all(n.map((n=>w.HB({environment:e,inMemoryRecordCache:e.defaultRecordCache.inMemoryRecordCache,pointer:n,userId:t.userId}))))}var I=n(99341);let C=0;const x=(0,p.defineMessages)({requestTooLarge:{id:"transactionHelpers.requestTooLargeError.message",defaultMessage:"Sorry, that request was too large."},requestTooLargeTryImportInstead:{id:"transactionHelpers.requestTooLargeError.message.tryImportInstead",defaultMessage:"Sorry, that request was too large. Try import instead?"}});let T=!1;(0,s.exposeDebugValue)("toggleTransactionQueue",(()=>{T=!T,console.info(T?"Transactions paused":"Transactions resumed")}));class M extends Error{constructor(e){super(e.message),this.retryDelay=void 0,this.retryReason=void 0,this.savedTasks=void 0,this.failedTasks=void 0,this.clientData=void 0,this.name="HandleSaveTransactionsError",this.retryDelay=e.retryDelay,this.retryReason=e.retryReason,this.savedTasks=e.savedTasks,this.failedTasks=e.failedTasks,this.clientData=e.clientData}}function P(e){if(1===e.subTasks.length)return e.task.debug;const t=new Map;for(const o of e.subTasks){var n;const e=null===(n=o.debug)||void 0===n?void 0:n.userAction;if(e){const n=t.get(e)??0;t.set(e,n+1)}}return{...e.task.debug,squashedUserActions:Object.fromEntries(t)}}async function A(e){if(T)return{value:[]};const{environment:t,tasks:n}=e,i=function(e,t){const n=new Set(t.map((e=>e.timestamp))),o=t.length-n.size;return o>0&&a.LA(e,{collision_count:o}),o}(t,n),{userId:s,squashedTasks:p}=I.Vm(n,{allowSquashing:!0}),S=p.map((e=>({id:e.task.id,spaceId:e.task.spaceId,debug:P(e),operations:e.task.operations,inSudoMode:e.task.useSudoMode}))),w=(0,d.ZP)(),k=g.default.checkGate("client_http_gzip")?"gzip":void 0,A=await m.saveTransactions(t,{requestId:w,transactions:S},s,void 0,void 0,void 0,k);if("success"===A.type)return C=0,{value:p.flatMap((e=>e.subTasks))};const F="Notion is unavailable, please try again later."===A.error.message;if(!F&&!A.error.data.offline||Math.random()<.01){const e=[...new Set(S.map((e=>e.spaceId??"NO_SPACE_ID")))];o.log({level:"error",from:"transactionActions",type:"ClientTransactionError",error:{miscErrorString:(0,r.LK)(A)},data:{requestId:w,miscDataToConvertToString:{transactions:S},userId:t.currentUser.id,spaceIds:e}})}if(413===A.status){let e,n,r=0;p.forEach((t=>{var o,i;null!==(o=t.task.debug)&&void 0!==o&&o.userAction&&(e=t.task.debug.userAction),null!==(i=t.task.debug)&&void 0!==i&&i.userFlow&&(n=t.task.debug.userFlow),r+=t.subTasks.length})),o.log({level:"error",from:"transactionActions",type:"ClientTransaction413Error",data:{totalTaskCount:r,userId:t.currentUser.id,requestId:w,userAction:e,userFlow:n}});const i=JSON.stringify(S);a.F4(t,{totalTaskCount:r,payloadLength:i.length,userAction:e});const s=Math.ceil(i.length/I._V);for(let a=0;a<s;a++)o.log({level:"error",from:"transactionActions",type:"ClientTransaction413ErrorRecovery",data:{userId:t.currentUser.id,totalTaskCount:r,requestId:w,miscDataToConvertToString:{chunkTotal:s,chunkIndex:a,operationChunk:i.slice(a*I._V,(a+1)*I._V)}}});f.showErrorMessage(y.default.formatMessage(e===h.xF?x.requestTooLargeTryImportInstead:x.requestTooLarge))}const O=e=>{const n=C;if(e.failedTasks.length>0&&(C+=1),!F&&!A.error.data.offline){var s,l;const c=e.failedTasks.length>0?e.failedTasks[0]:void 0;c&&"space_not_found_in_record_path"===(null===(s=e.clientData)||void 0===s?void 0:s.type)&&o.log({level:"error",from:"transactionActions",type:"ClientTransactionSpaceNotFoundError",error:(0,r.Ui)(e),data:{userId:t.currentUser.id,requestId:w,miscDataToConvertToString:(0,_.getDebugSourcesForIdsInOperations)(t,c.operations)}}),a.mc(t,{status:A.status,message:(0,b.pO)(A),previous_consecutive_rollbacks:n,saved_tasks:e.savedTasks.length,failed_tasks:e.failedTasks.length,first_failed_task_user_action:null==c||null===(l=c.debug)||void 0===l?void 0:l.userAction,will_retry:e.retryDelay>0,retry_reason:e.retryReason,timestamp_collision_count:i})}return{error:e}};if((0,l.Rp)(A.body)){if((0,l.oE)(A.body.clientData)){const{errors:e}=A.body.clientData,n=e[0],o=p.findIndex((e=>e.task.id===n.id));if(o<0)return D(t,w,n),O(new M({message:n.name,clientData:n.clientData,retryDelay:0,retryReason:void 0,savedTasks:[],failedTasks:[]}));const r=p.slice(0,o),i=r.flatMap((e=>e.subTasks)),a=[],s=[],l=[];let c=o,d=0,m=0;for(const u of e){const e=p[c];u.id===e.task.id?(u.retryable?(s.push({error:u,squashedTask:e}),m+=1):(d+=1,await R(t,e.task,w),e.subTasks.forEach((e=>a.push(e))),l.push({error:u,squashedTask:e})),c++):D(t,w,u)}const f=[`${r.length} successful`,d>0?`${d} failed unretryable (data loss)`:void 0,m>0?`${m} retryable`:void 0].filter(u.$K).join(", "),g=[`API error for ${p.length} transactions: ${f}.`,E(l,"unretryable"),E(s,"retryable")].filter(u.$K).join(" ");let h,v=0;return s.length>0&&(v=2e3,h=s[0].error.name),O(new M({savedTasks:i,failedTasks:a,message:g,retryDelay:v,retryReason:h,clientData:n.clientData}))}if(c.q9(B,A.status))return await Promise.all(p.map((e=>R(t,e.task,w)))),O(new M({savedTasks:[],failedTasks:p.flatMap((e=>e.subTasks)),message:(0,v.wf)(y.default.getIntl(),A),retryDelay:0,retryReason:void 0}))}let Z=`http${A.status}`;return A.error.data.offline?Z="offline":F&&(Z="notionUnavailable"),O(new M({savedTasks:[],failedTasks:[],message:(0,v.wf)(y.default.getIntl(),A),retryDelay:5e3,retryReason:Z}))}async function R(e,t,n){try{await k(e,t)}catch(i){o.log({level:"error",from:"transactionActions",type:"ClientTransactionCleanupError",error:(0,r.Ui)(i),data:{userId:e.currentUser.id,requestId:n}})}}function D(e,t,n){o.log({level:"error",from:"transactionActions",type:"ClientTransactionNotFoundError",error:(0,r.Ui)(n),data:{userId:e.currentUser.id,requestId:t}})}function E(e,t){if(e.length>0){var n;const{error:o,squashedTask:{task:r}}=e[0];return`First ${t} error: ${o.name} for transaction ${r.id} created by ${null===(n=r.debug)||void 0===n?void 0:n.userAction}.`}}const B=[400,413];class F{constructor(e){this.timeSource=i.O,this.environment=e}getExperimentGroup(e){return g.default.getGroup(e)}handleSaveTransactions(e){return A({environment:this.environment,tasks:e})}handleHealthcheck(e){a.h2(this.environment,e)}async rollbackTask(e){try{await k(this.environment,e)}catch(t){o.log({level:"error",from:"TransactionQueueDependencies",type:"ClientTransactionCleanupError",error:(0,r.Ui)(t),data:{userId:this.environment.currentUser.id}})}}}},9425:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(88893),r=n(88280),i=n(77080);function a(){const e=r.subscriptionDataStoreInstance.state;return!(!e||(0,o.CM)(e).length>1)&&i.default.checkGate("optimize_single_workspace")}},1634:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},80064:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},40671:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{updatingUrls:new Set}}add(e){this.state.updatingUrls.add(e),this.emit()}delete(e){this.state.updatingUrls.delete(e),this.emit()}}const i=new r},85703:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{}}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state.data)))}}const i=new r},62820:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(61766).Z)},4761:(e,t,n)=>{n.d(t,{ZP:()=>l,g0:()=>a,n_:()=>c});var o=n(49085),r=n(4615),i=n(97880);function a(e){return"mentions"===e||"allPages"!==e&&"archive"!==e&&void(0,i.t1)(e)}class s extends o.default{getInitialState(){return{currentTab:"mentions",isCurrentTabEmpty:!0,containsBothReadAndUnreadNotifications:!1,containsUnreadNotifications:!1,loadingId:void 0,sessionId:void 0,showOnlyUnreadNotifications:!1,unreadNotificationIds:[]}}startSession(){let{forceRestart:e=!1}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(void 0===this.state.sessionId||e)&&this.setState({...this.state,sessionId:(0,r.ZP)()})}endSession(){this.setState({...this.state,sessionId:void 0})}startLoading(){const e=Math.random().toString();return this.setState({...this.state,loadingId:e}),e}endLoading(e){e===this.state.loadingId&&this.setState({...this.state,loadingId:void 0})}isFilteredToUnreadOnly(){if("mentions"===this.state.currentTab)return this.state.showOnlyUnreadNotifications}}const l=new s,c=o.default.createValue(!0)},29226:(e,t,n)=>{n.d(t,{Z:()=>a});var o=n(49085),r=n(29477);class i extends o.default{getInitialState(){return{readyPromise:(0,r.UZ)(),localSpaceInaccessiblePages:void 0,remoteSpaceInaccessiblePages:void 0}}getSpaceInaccessiblePages(e,t){const n=this.state;return n.remoteSpaceInaccessiblePages&&n.remoteSpaceInaccessiblePages[t]?n.remoteSpaceInaccessiblePages[t][e]:n.localSpaceInaccessiblePages&&n.localSpaceInaccessiblePages[t]?n.localSpaceInaccessiblePages[t][e]:void 0}}const a=new i},76117:(e,t,n)=>{n.d(t,{p:()=>i});var o=n(49085);class r extends o.default{getInitialState(){}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state)))}}const i=new r},17963:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{pageMap:{}}}setStatus(e,t){const{pageMap:n}=this.state;t?n[e]=!0:delete n[e],this.emit()}}const i=new r},33759:(e,t,n)=>{n.d(t,{Z:()=>o});const o=new(n(85974).Z)},89403:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{}}}const i=new r},85974:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{loginType:"email",email:"",password:"",hasAccount:!1,showPassword:!1,signUpLinkSent:!1,hiddenPasscode:!1,forceAdminSamlLogin:!1}}isGoogle(){return"google"===this.state.loginType}isEmail(){return"email"===this.state.loginType}isReverifying(){return"reverify"===this.state.loginType}isTemporaryPasscode(){return"temporary"===this.state.loginType}isExclusiveLoginLinkTemporaryPasscode(){return"temporary"===this.state.loginType&&Boolean(this.state.hiddenPasscode)}isPassword(){return"password"===this.state.loginType}isForgotPassword(){return"forgot"===this.state.loginType}isPasswordResetSent(){return"reset"===this.state.loginType}isSaml(){return"saml"===this.state.loginType}isMfa(){return"mfa"===this.state.loginType}}const i=r},7339:(e,t,n)=>{n.d(t,{C:()=>S,Z:()=>b});n(21703);var o=n(30120),r=n(41351),i=n.n(r),a=n(49085),s=n(7406),l=n(68626),c=n(91155),d=n(90965),u=n(34886),p=n(97880),m=n(97978),f=n(12955),g=n(97448),h=n(35057),v=n(80444);const b="group";class y extends a.default{constructor(){super(...arguments),this.environment=void 0}getInitialState(){return{currentUserId:void 0,currentSpaceId:void 0,ready:!1}}isInitialized(){return g.StatsigInitializer.isComplete}async initialize(e){const t=Date.now();this.environment=e;const{userId:n,spaceId:o}=_(e);if(this.isInitialized()&&void 0!==n)await this.updateUserAndSpace(e);else try{this.setStateBeforeInitOrUpdate(n,o),await this.confirmInitializeDidSucceed(),await this.updateStatsigUserWithAllKnownFields({environment:e,stage:"initialize"}),this.setStateAfterInitOrUpdate(n,o),this.trackMetric("statsig_client_init_success")}catch(r){this.logError("initialize",r,{nextUserId:n}),this.trackMetric("statsig_client_init_error")}finally{this.trackMetric("statsig_client_init_duration",{time:Date.now()-t})}}async updateUserAndSpace(e){const{userId:t,spaceId:n}=_(e);this.state.currentUserId===t&&this.state.currentSpaceId===n||(this.setStateBeforeInitOrUpdate(t,n),await this.updateStatsigUserWithAllKnownFields({environment:e,stage:"updateUserAndSpace"}),this.setStateAfterInitOrUpdate(t,n))}async confirmInitializeDidSucceed(){if(!g.StatsigInitializer.initializePromise)throw new Error("`statsig.initialize` was not called on app bootstrap");if(await g.StatsigInitializer.initializePromise,g.StatsigInitializer.error)throw g.StatsigInitializer.error}async updateStatsigUserWithAllKnownFields(e){let{environment:t,stage:n}=e;const o=Date.now();try{const e=await this.createStatsigUser(t);await i().updateUser(e),this.trackMetric("statsig_client_update_user_success")}catch(r){this.logError("updateUser",r,{nextUserId:t.currentUser.id,err:(0,s.tg)(r).message,stage:n}),this.trackMetric("statsig_client_update_user_error")}finally{this.trackMetric("statsig_client_update_user_duration",{time:Date.now()-o})}}setStateBeforeInitOrUpdate(e,t){super.setState({currentUserId:e,currentSpaceId:t,ready:!1})}setStateAfterInitOrUpdate(e,t){const{currentSpaceId:n,currentUserId:o}=super.getState();n===t&&o===e&&super.setState({currentUserId:e,currentSpaceId:t,ready:!0})}getGroup(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b,o=arguments.length>3?arguments[3]:void 0;const r=Date.now();if(!this.isInitialized())return;let a;try{return a=t?i().getExperimentWithExposureLoggingDisabled(e):i().getExperiment(e),this.trackMetric("statsig_client_get_group_success",{experiment_id:e}),a.get(n,o)}catch(s){this.trackMetric("statsig_client_get_group_error",{experiment_id:e}),this.logError("getGroup",s,{experimentId:e,expConfig:JSON.stringify(a)})}finally{this.trackMetric("statsig_client_get_group_duration",{time:Date.now()-r})}}manuallyLogExperimentExposure(e){i().manuallyLogExperimentExposure(e)}checkGate(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Date.now();if(!this.isInitialized())return!1;let o;try{return o=t?i().checkGateWithExposureLoggingDisabled(e):i().checkGate(e),this.trackMetric("statsig_client_check_gate_success",{gate_name:e}),o}catch(r){const t=r instanceof Error?r.message:void 0;return this.logError("checkGate",r,{gateName:e,...t&&{errorMessage:t}}),this.trackMetric("statsig_client_check_gate_error",{gate_name:e}),!1}finally{this.trackMetric("statsig_client_check_gate_duration",{time:Date.now()-n})}}getConfig(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Date.now();if(!this.isInitialized())return;let o;try{return o=t?i().getConfig(e):i().getConfigWithExposureLoggingDisabled(e),this.trackMetric("statsig_client_get_config_success",{config_name:e}),o}catch(r){const t=r instanceof Error?r.message:void 0;return this.logError("getConfig",r,{dynamicConfigName:e,...t&&{errorMessage:t}}),void this.trackMetric("statsig_client_get_config_error",{config_name:e})}finally{this.trackMetric("statsig_client_get_config_duration",{time:Date.now()-n})}}logEvent(e,t,n){const o=Date.now();if(!this.isInitialized())return!1;try{return i().logEvent(e,t,n),this.trackMetric("statsig_client_log_event_success",{event_name:e}),!0}catch(r){const o=r instanceof Error?r.message:void 0;return this.logError("logEvent",r,{eventName:e,value:String(t),...n,...o&&{errorMessage:o}}),this.trackMetric("statsig_client_log_event_error",{event_name:e}),!1}finally{this.trackMetric("statsig_client_log_event_duration",{time:Date.now()-o})}}getLocalOverride(e){if(!this.isInitialized())return;const t=i().getAllOverrides().configs[e];return null==t?void 0:t[b]}updateLocalOverrideConfig(e,t){this.isInitialized()&&(i().overrideConfig(e,{[b]:t}),super.emit())}updateLocalOverrideGate(e,t){this.isInitialized()&&(i().overrideGate(e,"true"===t),super.emit())}removeAllLocalOverrides(){if(!this.isInitialized())return;const e=i().getAllOverrides();(0,p.Yd)(e.configs).forEach((e=>i().removeConfigOverride(e))),(0,p.Yd)(e.gates).forEach((e=>i().removeGateOverride(e))),super.emit()}async createStatsigUser(e){var t,n,r,i,a,s,l;const{device:c}=e,{currentUserSettingsStore:p,currentSpaceStore:m}=v.default.getState(),{userId:b,userEmail:y,spaceId:S}=_(e),w=await f.getBrowserId(e),k=await f.getExperimentDeviceId(e);return(0,g.createStatsigUser)({userId:b,device:c,spaceId:S,userEmail:y,deviceId:k,browserId:w,locale:null==p||null===(t=p.getSettings())||void 0===t?void 0:t.preferred_locale,spaceMemberCount:(0,u.F)((0,d.t5)(null==m?void 0:m.getPermissionItems())),spaceCreatedTime:null==m?void 0:m.getCreatedTime(),spaceCreatedDate:null!=m&&m.getCreatedTime()?o.ou.fromMillis(null==m?void 0:m.getCreatedTime()).toFormat("yyyy-MM-dd"):void 0,subscriptionTier:(0,h.zt)(),planType:null==m?void 0:m.getPlanType(),signupTime:null==p||null===(n=p.getSettings())||void 0===n?void 0:n.signup_time,domainType:null==p||null===(r=p.getSettings())||void 0===r?void 0:r.domain_type,persona:null==p||null===(i=p.getSettings())||void 0===i?void 0:i.persona,teamRole:null==p||null===(a=p.getSettings())||void 0===a?void 0:a.team_role,useCases:null==p||null===(s=p.getSettings())||void 0===s?void 0:s.use_cases,companySize:null==p||null===(l=p.getSettings())||void 0===l?void 0:l.company_size})}logError(e,t,n){l.log({level:"error",from:"statsig",type:e,error:(0,c.Ui)(t),data:{miscDataToConvertToString:{...n,...this.state}}})}trackMetric(e,t){this.environment&&e.endsWith("_error")&&m.j(this.environment,e,t)}}function _(e){const{currentUser:t}=e,{currentSpaceStore:n,currentUserStore:o}=v.default.getState(),r=t.id,i=null==o?void 0:o.getEmail();return{userId:r,spaceId:null==n?void 0:n.id,userEmail:i}}const S=new y},22616:(e,t,n)=>{n.d(t,{Zz:()=>s,aQ:()=>c,yD:()=>l});n(21703);var o=n(64793),r=n(12139),i=n(54642),a=(n(95477),n(70060),n(33493));async function s(e){const{environment:t,spaceId:n}=e;if("init"!==a.Z.state.status)return;a.Z.didStartLoading();const s=await i.listPrices(t,{spaceId:n});if("success"!==s.type)return void a.Z.resetExceptSelectedCurrencyCode();const l=s.data.prices;l&&0!==l.length||r.IE(new Error("Received empty price list")),a.Z.setPrices(l.map((e=>new o.tA(e))))}function l(e){a.Z.availableCurrencyCodes.includes(e)&&a.Z.update((t=>({...t,selectedCurrencyCode:e})))}async function c(e){let{environment:t,spaceId:n}=e;return await s({environment:t,spaceId:n}),a.Z.state.prices}},34583:(e,t,n)=>{n.d(t,{$B:()=>se,EO:()=>te,Fp:()=>ge,I0:()=>fe,KD:()=>_e,M_:()=>me,Mg:()=>X,OR:()=>le,TV:()=>J,Xb:()=>he,bi:()=>ce,px:()=>de,r7:()=>ae,sv:()=>ye,y3:()=>ee,zb:()=>ue});n(21703);var o=n(30120),r=(n(67294),n(41892),n(68626)),i=(n(65454),n(15157)),a=n(4615),s=n(9182),l=n(26929),c=n(2438),d=n(9291),u=n(86572),p=n(54642),m=n(35253),f=n(47307),g=n(92625),h=n(97977),v=n(72899),b=n(91754),y=(n(95477),n(15010)),_=n(33929),S=n(78873),w=n(95697),k=n(80444),I=n(77080),C=n(73329),x=n(53730),T=n(81236),M=n(79797),P=n(92083),A=n(27242),R=n(9209),D=n(85703),E=n(76117),B=n(70060),F=n(28517),O=n(60027),Z=n(42198),V=n(22616),U=n(5682),N=n(58333),L=n(88893),j=n(35057),z=n(62142),q=n(33493),H=n(88280),W=n(64891),K=n(85893);const G="SubscriptionData",$="UpcomingInvoiceData";let Q;const Y=(0,d.defineMessages)({updatingSubscription:{id:"subscriptionSettings.updatingSubscriptionMessage",defaultMessage:"Updating your subscription…"},updatingPaymentMethod:{id:"subscriptionSettings.updatingPaymentMethodMessage",defaultMessage:"Updating your payment method…"},verifyingEligibility:{id:"subscriptionSettings.verifyingEligibilityMessage",defaultMessage:"Verifying eligibility…"},personalFree:{id:"subscriptionSettings.personalFreeMessage",defaultMessage:"You are now subscribed to Notion’s Personal Pro Plan for free."},educationPlusFree:{id:"subscriptionSettings.educationPlusFreeMessage",defaultMessage:"You are now subscribed to Notion's Education plan for free"},finishingUp:{id:"subscription.upgrade.finishing",defaultMessage:"Finishing up..."}});async function X(e){const{from:t,environment:n,spaceStore:o,billingEmail:r,paymentData:i,vatId:a,coupon:l,customerName:c,businessName:d,addressLine1:h,addressZip:v,addressCity:b,addressState:_,addressCountry:S,promoCodeId:w,useTestClock:k,sessionId:I,inAppOffer:x,desiredState:T,trialData:M}=e;m.Js({bannerStore:C.Z}),g.j({message:Y.updatingSubscription});const P=H.subscriptionDataStoreInstance.state;if(!P)throw new Error("Subscription data not loaded.");const A=await V.aQ({environment:n,spaceId:o.id}),R=(0,U.P)(A,P),D=(0,s.iv)(R),{plan:E,addOns:B,isTrial:F}=(0,N.ug)(D,T),Z=await p.updateSubscription(n,{spaceId:o.id,plan:E,addOns:B,billingEmail:r,stripeToken:ve(i),paymentMethodId:be(i),vatId:a,coupon:l,customerName:c,businessName:d,addressLine1:h,addressZip:v,addressCity:b,addressState:_,addressCountry:S,promoCodeId:w,useTestClock:k,modalSessionId:I,inAppOffer:x,isTrial:F,clientVersion:n.device.version,trialData:M});if(g.x(),"failed"===Z.type)throw f.showError(Z),new Error("An error occurred while updating subscription");await ie({environment:n,spaceStore:o,newDefaultTeamId:Z.data.newDefaultTeamId});const L=H.subscriptionDataStoreInstance.state,j=o.id,z=o.getPlanType(),q=(0,U.P)(A,L);if(function(e){var t;let{environment:n,context:o,oldData:r,newData:i,desiredState:a}=e;const l=(0,s.F6)(r.subscription),c=(0,s.zt)(r.subscription),d=(0,s.xi)(r.subscription),p=(0,s.Hw)(r.subscription),m=(0,s.bs)(r.subscription),f=r.email,g=(0,s.F6)(a),h=(0,s.zt)(a),v=(0,s.xi)(a),b=(0,s.Hw)(a),_=(0,s.bs)(a),S=Boolean(null==a?void 0:a.trialEnd),w=i.email,k=r.subscription,I=!(0,s.YK)(k)&&(0,s.YK)(a),C=(0,s.YK)(k)&&(0,s.YK)(a),x=(0,s.YK)(k)&&!(0,s.YK)(a);I&&g?u.k6(n,{plan:g,credit_amount:0}):C?u.wl(n,{billing_email_changed:f!==w,plan_changed:g!==l,plan_current:g,plan_old:l,currency_code:_,billing_address_changed:!1}):x&&l&&u.rx(n,{plan:l});u._j(n,{from:o.from,action:x?"cancel":"update",spaceId:o.spaceId,isMmOrEnt:o.isMmOrEnt,planType:o.planType,addressCountry:null===(t=i.address)||void 0===t?void 0:t.country,oldSubscriptionTier:c,newSubscriptionTier:h,oldCurrency:m,newCurrency:_,oldPriceId:l,newPriceId:g,oldAddOns:d,newAddOns:v,oldBillingInterval:p,newBillingInterval:b,creditAmount:0,isProfessionalTeamUser:(0,y.QZ)(),isTrial:S,trialData:o.trialData})}({environment:n,context:{spaceId:j,planType:z,from:t,isMmOrEnt:await(0,O.n)(n),trialData:M},oldData:R,newData:q,desiredState:T}),!L)throw new Error("Subscription data not loaded.");return Z.data}async function J(e){const{environment:t,spaceStore:n,paymentMethodId:o}=e;g.j({message:Y.updatingPaymentMethod});const r=await p.updatePaymentMethod(t,{spaceId:n.id,paymentMethodId:o});if(g.x(),"failed"!==r.type)return await ce(t),r.data;f.showError(r)}async function ee(e){const{environment:t,spaceStore:n,address:o}=e;m.Js({bannerStore:C.Z}),g.j({message:Y.updatingSubscription});const r=await p.updateSubscription(t,{spaceId:n.id,customerName:o.name,businessName:o.businessName,addressLine1:o.addressLine1,addressLine2:o.addressLine2,addressZip:o.zipCode,addressCity:o.city,addressState:o.state,addressCountry:o.country});if("failed"===r.type)throw g.x(),f.showError(r),r.error;u.wl(t,{billing_email_changed:!1,plan_changed:!1,billing_address_changed:!0}),await ce(t),await de(t),g.x()}async function te(e){const{environment:t,spaceStore:n,planType:o,from:r}=e,i=H.subscriptionDataStoreInstance.state;if(!i)throw new Error("Subscription data not loaded.");m.Js({bannerStore:C.Z}),g.j({message:Y.updatingSubscription});const a=ne(t,i),s=i.addOns,l=L.XX(i),d=null==l?void 0:l.plan,h=await V.aQ({environment:t,spaceId:n.id}),v=d?(0,c.qH)(h,d):void 0,b=await p.cancelSubscription(t,{spaceId:n.id,planType:o,cancelImmediately:e.cancelImmediately});if("failed"===b.type)return g.x(),void f.showError(b);const _=L.XX(i);let S;"subscribed_admin"===i.type&&_&&(S=!0,u.rx(t,{plan:_.plan})),await ie({environment:t,spaceStore:n,newDefaultTeamId:void 0});const w=H.subscriptionDataStoreInstance.state;if(!w)throw new Error("Subscription data not loaded.");return u._j(t,{from:r,action:"cancel",spaceId:n.id,oldSubscriptionTier:a,newSubscriptionTier:ne(t,w),oldPriceId:oe(i,_),oldCurrency:re(i),newCurrency:re(w),oldAddOns:s.map((e=>e.feature)),oldBillingInterval:v,newBillingInterval:void 0,isCancelSubscription:S,isProfessionalTeamUser:(0,y.QZ)()}),g.x(),!0}function ne(e,t){const n=(0,j.zt)();if(!t)return n;return(0,L.DH)(t)?"free":n}function oe(e,t){if(!e)return;return(0,L.DH)(e)||null==t?void 0:t.plan}function re(e){if(e)return"currencyCode"in e?e.currencyCode:void 0}async function ie(e){let{environment:t,newDefaultTeamId:n,spaceStore:o}=e;if(await ce(t),await de(t),q.Z.reset(),(0,w.bq)()&&t.currentUser.id&&void 0!==n){await F.m({userId:t.currentUser.id,spaceId:o.id,environment:t});const e=M.zX.createChildStore(o,{table:"team",id:n,spaceId:o.id});await e.load()}}async function ae(e){const{environment:t,spaceStore:n,code:o}=e;g.j({message:Y.verifyingEligibility});const r=H.subscriptionDataStoreInstance.state;if(!r)throw new Error("Subscription data not loaded.");const i=await p.updateSubscriptionToEducationPlan(t,{spaceId:n.id,code:o});"failed"===i.type?f.showError(i):i.data.isEligible?pe(r,t):R.Z.setState({open:!0,handlePromoCode:async e=>{g.j({message:Y.updatingSubscription});const o=await p.updateSubscriptionToEducationPlan(t,{spaceId:n.id,code:e});"failed"===o.type?f.showError(o):o.data.isEligible?pe(r,t):f.showErrorMessage((0,K.jsx)(d.FormattedMessage,{id:"subscriptionSettings.invalidPromoCodeError.message",defaultMessage:"This promo code is not valid."})),g.x()}}),g.x()}function se(){Q&&Q.close()}async function le(e){const{environment:t,spaceId:n,isNewlyCreatedSpace:o}=e,r=H.subscriptionDataStoreInstance.spaceId;if(!t.currentUser.isLoggedIn()||r&&r===n)await H.subscriptionDataStoreInstance.waitUntilLoaded();else if(D.Z.setState({...D.Z.state,spaceId:n}),o){const e={type:"unsubscribed_admin",users:[],bots:[],joinedMemberIds:[],blockUsage:0,hasPaidNonzero:!1,accountBalance:0,timelineViewUsage:0,inviteLinkCode:"",userSimilarity:{},spaceUsers:[],members:[],customerData:void 0,revenueCatEnabled:!1,addOns:[],currencyCode:void 0};H.subscriptionDataStoreInstance.setState(e),H.subscriptionDataStoreInstance.spaceId=n,E.p.setState(e.userSimilarity),ce(t)}else ce(t),de(t)}async function ce(e){var t;const n=null===(t=k.default.state.currentSpaceStore)||void 0===t?void 0:t.id,o=e.currentUser.id;if(!n)throw new Error("No spaceId.");{const t=`${G}:${n}:v2`,a=i.Z.get({userId:o,key:t});a&&(H.subscriptionDataStoreInstance.setState(a),H.subscriptionDataStoreInstance.spaceId=n,E.p.setState(a.userSimilarity)),await async function(e){let{environment:t,spaceId:n,currentUserId:o,localKey:a}=e;o&&Z.default.initializeAndLoadAllUserSignals({environment:t,userId:o,spaceId:n});await x.transactionQueue.drain();const[s,l]=await Promise.all([p.getSubscriptionData(t,{spaceId:n}),p.getVisibleUsers(t,{spaceId:n})]);if("success"===s.type&&"success"===l.type){var c;const e={...s.data,...l.data};i.Z.set({userId:o,key:a,value:e}),(null===(c=k.default.state.currentSpaceStore)||void 0===c?void 0:c.id)===n&&(H.subscriptionDataStoreInstance.setState(e),H.subscriptionDataStoreInstance.spaceId=n,E.p.setState(e.userSimilarity),L.YK(e)&&u.jw(t))}else r.log({level:"error",from:"subscriptionActions",type:"fetchSubscriptionDataFailed",data:{miscDataToConvertToString:{getSubscriptionDataResponseType:s.type,getSubscriptionDataResponseStatus:s.status,getVisibleUserResponseType:l.type,getVisibleUserResponseStatus:l.status}}});await Promise.all([T.Z.awaitPublicSpaceData(t,n,!0),v.E0.loader().then((e=>{let{completionActions:o}=e;return o.updateAiEligibility(t,n)}))])}({environment:e,spaceId:n,currentUserId:o,localKey:t})}}async function de(e){var t;const n=null===(t=k.default.state.currentSpaceStore)||void 0===t?void 0:t.id,o=e.currentUser.id;if(!n)throw new Error("No spaceId.");{const t=`${$}:${n}:v2`,a=i.Z.get({userId:o,key:t});a&&D.Z.setState({spaceId:n,data:a}),await x.transactionQueue.drain();const s=await p.getInvoiceData(e,{spaceId:n,type:"upcoming"});if("success"===s.type){const{data:e}=s;i.Z.set({userId:o,key:t,value:e.invoiceData}),D.Z.state.spaceId===n&&D.Z.setState({spaceId:n,data:e.invoiceData})}else r.log({level:"error",from:"subscriptionActions",type:"fetchUpcomingInvoiceCall",data:{miscDataToConvertToString:{upcomingInvoiceResponse:s}}})}}async function ue(e,t){const n=k.default.state.currentSpaceStore;if(!n)return;const o=await p.getBillingHistory(e,{spaceId:n.id,limit:t.state.billingEventsLimit});"success"===o.type&&t.update((e=>({...e,billingEvents:o.data.events})))}async function pe(e,t){await ce(t),de(t),q.Z.reset();const n=()=>{f.showMessage({message:_.default.formatMessage(Y.educationPlusFree)}),P.Z.setState({...P.Z.state,currentTab:"billing",defaultSubtab:void 0});const n=L.XX(e);u.jh(t,{plan:"student_free",old_plan:n?n.plan:void 0})};await h.shouldCreatePassword(t)?S.E({environment:t,onSubmit:n,onCancel:n}):n()}function me(e){const t=H.subscriptionDataStoreInstance.state;if(e.device.isMobileNative&&e.device.isIOS)return!0;if(e.device.isMobileNative&&e.device.isAndroid&&!I.default.checkGate("android_native_blocks"))return!0;if(t){if((0,B.du)())return!0;if(L.Ln(e,t))return u.lj(e),function(e){if((0,B.du)())return;m.Bw({id:"SubscriptionEditingBlocker",bannerStore:C.Z,styleKey:b.v.Red,contentKey:"over_free_block_limit"})}(),!1;L.XZ(e,t)&&u.z2(e)}if((0,B.e0)()){var n,r;const e=null===(n=k.default.state.currentSpaceStore)||void 0===n?void 0:n.getOverdueSubscription(),t=L.aS(H.subscriptionDataStoreInstance.state),i=null==t||null===(r=t.testClock)||void 0===r?void 0:r.frozen_time,a=i?o.ou.fromSeconds(i):o.ou.now(),{paymentStatus:s}=l.cS({now:a,overdueSubscription:e});if("unpaid"===s)return!1}return m.qL({bannerStore:C.Z,id:"SubscriptionEditingBlocker"}),!0}function fe(e,t){const{subscriptionTier:n,from:o,addOnFeature:r,coupon:i,isTrial:s}=t,l=(0,a.ZP)();u.Lc(e,{subscriptionTier:n,from:o,addOnFeature:r,currency_code:q.Z.state.selectedCurrencyCode,isTrial:s,modal_id:l});const c=r||s||!B.F4()?"month":"year";A.Z.open({subscriptionTier:n,billingInterval:c,addOnFeature:r,coupon:i,isTrial:s,sessionId:l})}function ge(e){const t=A.Z.state;t.open&&(u.LY(e,{modal_id:t.sessionId}),A.Z.setState({open:!1}))}function he(e){z.Z.open(e)}function ve(e){return"stripeToken"===(null==e?void 0:e.type)?e.value:void 0}function be(e){return"paymentMethodId"===(null==e?void 0:e.type)?e.value:void 0}async function ye(e){const{environment:t,product:n,spaceStore:o,spaceSubscriptionPlansStore:r,data:i,from:a,pageSection:l}=e,c=await V.aQ({environment:t,spaceId:o.id}),d=(0,U.P)(c,i),u=d.subscription;if(!u||!L.MM(i))return void fe(t,{subscriptionTier:n,from:a});const p=(0,B.bU)()?(0,s.Lg)(d):(0,s.iv)(d),m=(0,s.bs)(u),f=(0,s.Hw)(p),g=(0,s.Hw)(u),h=f??g,v=(0,s.Pc)(p),b=(0,s.Pc)(u),y=v??b;let _;if("free"===n)_=(0,N.t4)(p,"plan");else{if(!(m&&h&&y))throw new Error("Trying to update plan on a subscription with no items");{const e={product:n,currency:m,interval:h,quantity:y};_=(0,N.dP)(c,p,e)}}return(0,N._D)(p,_)?async function(e){const{environment:t,from:n,spaceSubscriptionPlansStore:o,spaceStore:r,desiredState:i,product:a}=e;let s="churn_by_end_of_billing_period";o&&(s=await new Promise((e=>{o.setState({...o.state,churnType:a,churnSurveyModalOpen:!0,onAccept:t=>{e(t?"churn_immediately":"churn_by_end_of_billing_period")},onClose:()=>e("no_churn")})})));if("no_churn"===s)return;0===i.items.length?await te({environment:t,spaceStore:r,planType:"personal",from:n,cancelImmediately:"churn_immediately"===s}):await X({environment:t,spaceStore:r,desiredState:i,from:n})}({environment:t,from:a,spaceStore:o,spaceSubscriptionPlansStore:r,desiredState:_,product:n}):W.af({environment:t,from:a,view:"plans",temporarySubscriptionTier:n,billingInterval:h,pageSection:l})}async function _e(e){g.j({message:Y.finishingUp});const{paymentIntentData:t,stripe:n,onSuccess:o,onFailure:r}=e,i=t.paymentIntentClientSecret;let a=t.paymentIntentStatus;if(i&&"requires_action"===a){const{paymentIntent:e,error:t}=await n.handleNextAction({clientSecret:i});e?a=e.status:null!=t&&t.payment_intent&&(a=t.payment_intent.status)}"succeeded"===a||"processing"===a?null==o||o():l.Ym({status:a})&&(null==r||r()),g.x()}},40469:(e,t,n)=>{n.d(t,{SP:()=>v,W_:()=>f,l_:()=>g,nf:()=>h});var o=n(19234),r=n(31919),i=n(47425),a=n(54642),s=n(27242),l=n(88893),c=n(63423),d=n(62142),u=n(33493),p=n(25692),m=n(88280);async function f(e){const t=s.Z.state,n=m.subscriptionDataStoreInstance.state;if(!t.open||!n)return;const r=t.temporaryAddress;if(!(0,o.A)(r))return;s.Z.update((e=>({...e,calculatingTax:!0})));const{planAmount:i,promoInfo:c,accountBalance:d}=(0,l.uN)({promo:t.appliedPromo,currencyCode:u.Z.selectedCurrencyCode,data:n,addOnFeature:t.addOnFeature,onlyShowAddOn:t.onlyShowAddOn,subscriptionTier:t.subscriptionTier,taxAmount:t.taxAmount,calculatingTax:t.calculatingTax,billingInterval:t.temporaryBillingInterval??"year",coupon:t.coupon}),p=Math.max(0,i-c.amount+d),f=await a.calculateTax(e,{address:r,price:p,vatId:t.vatApplicable?t.temporaryVatCode:void 0,customerId:"subscribed_admin"===n.type?n.customerData.stripe.customerId:void 0});if("failed"===f.type)s.Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=f.data;e.valid?s.Z.update((t=>({...t,taxAmount:e.taxAmount,calculatingTax:!1,taxCalculationError:void 0}))):s.Z.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function g(e){var t;const n=d.Z.state,i=m.subscriptionDataStoreInstance.state;if(!n.open||!i)return;const s=n.temporaryAddress;if(!(0,o.A)(s))return;d.Z.update((e=>({...e,calculatingTax:!0})));const l=(null===(t=n.totalUpgradeCost)||void 0===t?void 0:t.amount)||0,c=await a.calculateTax(e,{address:s,price:l,vatId:n.vatApplicable?n.temporaryVatCode:void 0,customerId:"subscribed_admin"===i.type?i.customerData.stripe.customerId:void 0});if("failed"===c.type)d.Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})));else{const e=c.data;e.valid?d.Z.update((t=>({...t,taxAmount:r.n.fromValue({amount:e.taxAmount,currencyCode:u.Z.selectedCurrencyCode}),calculatingTax:!1,taxCalculationError:void 0}))):d.Z.update((t=>({...t,taxAmount:void 0,calculatingTax:!1,taxCalculationError:e.error})))}}async function h(e){const{environment:t,priceForTaxCalculation:n,address:o,customerId:r,vatId:i}=e,s=c.Z.state,l=await a.calculateTax(t,{address:o,customerId:r,vatId:i,price:n});if("failed"===l.type);else{const e=l.data;e.valid&&s.open&&c.Z.update((t=>({...t,tax:Math.max(0,e.taxAmount)})))}}async function v(e){var t;const n=p.Z.state,r=m.subscriptionDataStoreInstance.state;if(!n.open||!r)return;if("subscribed_admin"!==r.type&&"unsubscribed_admin"!==r.type)return;const s=null===(t=r.customerData)||void 0===t?void 0:t.stripe;if(!s)return;const c=s.address;if(!c||!(0,o.A)(c))return;p.Z.update((e=>({...e,calculatingTax:!0})));const d=n.temporarySubscriptionTier??n.subscriptionTier,f=(0,i.QM)(d)&&n.addOnFeature?"month":"year",g=n.temporaryBillingInterval??n.billingInterval??f,h=!(0,i.QM)(d)&&Boolean(n.addOnFeature),{payAmount:v}=(0,l.uN)({promo:void 0,currencyCode:u.Z.selectedCurrencyCode,data:r,addOnFeature:n.addOnFeature,onlyShowAddOn:h,subscriptionTier:d,taxAmount:n.taxAmount,calculatingTax:n.calculatingTax,billingInterval:g,coupon:n.coupon}),b=await a.calculateTax(e,{address:c,price:v.amount,vatId:s.vatId,customerId:s.customerId});if("failed"===b.type)return void p.Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1,taxCalculationError:b.error})));const y=b.data;y.valid?p.Z.update((e=>({...e,taxAmount:y.taxAmount,calculatingTax:!1}))):p.Z.update((e=>({...e,taxAmount:void 0,calculatingTax:!1})))}},64891:(e,t,n)=>{n.d(t,{Mg:()=>P,OT:()=>M,Zo:()=>R,af:()=>C,bX:()=>T,cM:()=>x,y5:()=>A});var o=n(4615),r=n(9182),i=n(86572),a=n(54642),s=n(47307),l=n(92625),c=n(91376),d=n(64964),u=n(80444),p=n(70060),m=n(5682),f=n(40670),g=n(58333),h=n(88893),v=n(35057),b=n(87598),y=n(33493),_=n(25692),S=n(88280),w=n(22616),k=n(34583),I=n(40469);function C(e){const{environment:t,from:n,view:r,temporarySubscriptionTier:a,temporaryBillingInterval:s,billingInterval:l,addOnFeature:c,pageSection:d,onSuccess:u}=e,p=(0,o.ZP)();i.YT(t,{from:n,pageSection:d,view:r,modal_id:p,currency_code:y.Z.selectedCurrencyCode}),_.Z.setState({open:!0,modalId:p,view:r,subscriptionTier:(0,v.zt)(),temporarySubscriptionTier:a,billingInterval:l,temporaryBillingInterval:s,calculatingTax:!1,isExpandedView:!1,addOnFeature:c,onSuccess:u}),I.SP(t)}function x(e){const t=_.Z.state;t.open&&(i.q7(e,{state:t}),_.Z.setState({open:!1}))}function T(e){const t=_.Z.state;t.open&&(i.y$(e,{state:t}),_.Z.setState({...t,isExpandedView:!0}))}function M(e){const t=_.Z.state;t.open&&(i.k1(e,{state:t}),_.Z.setState({...t,isExpandedView:!1}))}async function P(e,t,n){const o=u.default.state.currentSpaceStore;if(!o)return;const a=_.Z.state;if(!a.open)return;i.nd(e,{state:a});const{view:s,onSuccess:l}=a,c=S.subscriptionDataStoreInstance.state,v=await w.aQ({spaceId:o.id,environment:e}),b=(0,m.P)(v,c),I=(0,p.bU)()?(0,r.Lg)(b):(0,r.iv)(b),C=a.temporarySubscriptionTier,T=a.addOnFeature,M=a.temporaryBillingInterval??"year",P=(0,r.Hw)(I)??"year",A=y.Z.selectedCurrencyCode,R=c?(0,h.su)(c):1;let D,E=I;if("add_ons"===s&&T){const e={product:T,interval:P,currency:A,quantity:R};E=(0,g.dP)(v,E,e),D=f.aQ({addOnFeature:T})}else if("billing_interval"===s)E=(0,g.Zl)(v,E,M),D=f.Nj({billingInterval:M});else{if("plans"!==s||!C)return void x(e);{const e={product:C,interval:P,currency:A,quantity:R};E=(0,g.dP)(v,E,e),D=f.s6({newTier:C})}}const B=await k.Mg({environment:e,from:"space_settings-plans_tab",spaceStore:o,desiredState:E,inAppOffer:n});await k.KD({paymentIntentData:B,stripe:t,onSuccess:l}),x(e),D&&d.oV(D)}async function A(e){var t;const{environment:n,customerData:o}=e,i=u.default.state.currentSpaceStore;if(!i)return;const l=await w.aQ({spaceId:i.id,environment:n}),c=(0,m.P)(l,o);if(null===(t=c.subscription)||void 0===t||!t.pending)return s.showErrorMessage((0,f.iS)());if(!i)return s.showErrorMessage((0,f.iS)());const p=(0,f.dY)(o);let g;if(o.willCancelAt){const e=(0,r.iv)(c);await k.Mg({environment:n,from:"space_settings-billing_tab",spaceStore:i,desiredState:e}),g={type:"success"}}else{if(!p)return s.showErrorMessage((0,f.iS)());g=await a.releaseSubscriptionSchedule(n,{id:p})}return"success"===g.type?(d.oV({label:(0,f.UW)()}),await k.bi(n)):s.showErrorMessage((0,f.iS)())}async function R(e){const t=u.default.state.currentSpaceStore;t&&(l.j({message:b.z.cancellingTrial}),await k.EO({environment:e,spaceStore:t,planType:t.getPlanType()??"personal",from:"space_settings-plans_tab"}),l.x(),c.r$({currentTab:"billing"}))}},5682:(e,t,n)=>{n.d(t,{P:()=>s});n(21703);var o=n(30120),r=n(72126),i=n(97880),a=n(88893);function s(e,t){var n;const r=c(t),a=null==r?void 0:r.customerId,s=null==r||null===(n=r.testClock)||void 0===n?void 0:n.frozen_time,d=s?o.ou.fromSeconds(s):o.ou.now(),u=null==r?void 0:r.billingEmail,p=null==r?void 0:r.address,m=function(e,t,n){if(!n)return;const r=n.subscriptionId,a="trialEnd"in n?n.trialEnd:void 0,s=a&&a>t.toSeconds()?o.ou.fromSeconds(a):void 0,c="periodEnd"in n?n.periodEnd??0:0,d=o.ou.fromSeconds(c),u=function(e,t,n){var r;if(n.willCancelAt){return{items:[],startDate:o.ou.fromMillis(n.willCancelAt)}}if("trialEnd"in n&&n.trialEnd){return{items:l(e,n),startDate:o.ou.fromSeconds(n.trialEnd)}}if(!(0,i.$K)(n.schedule))return;const a=(null==n||null===(r=n.schedule)||void 0===r?void 0:r.phases)??[],s=a.find((e=>o.ou.fromSeconds(e.start_date)>t));if(!(0,i.$K)(s))return;const c=s.items.map((t=>{const n=e.find((e=>e.externalId===t.price.id));if(!n)throw new Error(`Unable to find price for priceId: ${t.price.id}`);return{quantity:t.quantity,price:n}}));return{items:c,startDate:o.ou.fromSeconds(s.start_date)}}(e,t,n),p=l(e,n);if(!n.isSubscribed&&0===p.length)return;return{externalId:r,trialEnd:s,currentPeriodEnd:d,items:p,pending:u}}(e,d,r);return{externalId:a,now:d,email:u,address:p,subscription:m}}function l(e,t){const n=t.quantity??1,o="plan"in t?t.plan:void 0,i=o?e.find((e=>e.externalId===o)):void 0,a=i?{price:i,quantity:n}:void 0;if(o&&!a)throw new Error(`Unable to find price for plan priceId: ${o}`);return t.addOns.map((t=>{const o=e.find((e=>e.externalId===t.priceId));if(!o)throw new Error(`Unable to find price for addOn priceId: ${t.priceId}`);return{price:o,quantity:n}})).concat((0,r.oA)([a]))}function c(e){return(0,i.$K)(e)?"type"in e?(0,a.aS)(e):e:void 0}},40670:(e,t,n)=>{n.d(t,{Nj:()=>P,Tg:()=>w,UW:()=>_,YZ:()=>C,Z_:()=>k,aQ:()=>A,bQ:()=>x,dY:()=>S,iS:()=>y,rO:()=>I,s6:()=>M});n(57658),n(67294);var o=n(13991),r=n(7057),i=n(36591),a=n(9182),s=n(47425),l=n(97880),c=n(9291),d=n(33929),u=n(88893),p=n(85893);const m=(0,c.defineMessages)({cancellationError:{id:"midtermSubscriptionHelpers.cancellationFailed",defaultMessage:"There was an error attempting to cancel your pending changes. Please try again."},unableToCancelError:{id:"midtermSubscriptionHelpers.unableToCancel",defaultMessage:"We cannot cancel your scheduled changes right now. Please contact support for more help."},cancellationSuccess:{id:"midtermSubscriptionHelpers.cancellationSucceeded",defaultMessage:"Pending changes have been canceled"},invalidSubscriptionId:{id:"midtermSubscriptionHelpers.invalidSubscriptionId",defaultMessage:"Unable to cancel your pending changes. Something was wrong with your pending subscription changes."}});function f(e){return(0,s.QM)(e)?"free":(0,s.iJ)(e)?"education":(0,s.Aw)(e)?"singlePlayerPlus":(0,s.eR)(e)?"plus":(0,s.NG)(e)?"business":(0,u.gG)(e)?"enterprise":"legacy"}const g=(0,c.defineMessages)({personalFreePlan:{defaultMessage:"Personal Plan",id:"personalFreePlan.title"},personalFree:{defaultMessage:"Personal",id:"personalFree.title"},teamTrialPlan:{defaultMessage:"Team Plan (Trial)",id:"teamTrialPlan.title"},freePlan:{defaultMessage:"Free Plan",id:"freePlan.title"},free:{defaultMessage:"Free",id:"free.title"},personalPlan:{defaultMessage:"Personal Pro Plan",id:"personalPlan.label"},personal:{defaultMessage:"Personal Pro",id:"personal.label"},singlePlayerPlusPlan:{defaultMessage:"Plus Plan with a 1-member limit",id:"singlePlayerPlusPlan.title"},educationPlan:{defaultMessage:"Personal Pro Plan (Education)",id:"personalEducationPlan.title"},educationPlusPlan:{defaultMessage:"Education Plus Plan",id:"educationPlusPlan.title"},teamPlan:{defaultMessage:"Team Plan",id:"teamPlan.title"},team:{defaultMessage:"Team",id:"team.title"},plusPlan:{defaultMessage:"Plus Plan",id:"plusPlan.title"},plus:{defaultMessage:"Plus",id:"plus.title"},businessPlan:{id:"businessPlan.title",defaultMessage:"Business Plan"},business:{id:"business.title",defaultMessage:"Business"},enterprisePlan:{defaultMessage:"Enterprise Plan",id:"enterprisePlan.label"},enterprise:{defaultMessage:"Enterprise",id:"enterprise.label"},legacyPlan:{defaultMessage:"Legacy Plan",id:"legacyPlan.label"}}),h={free:{planTitle:g.freePlan},singlePlayerPlus:{planTitle:g.plusPlan},education:{planTitle:g.educationPlusPlan},plus:{planTitle:g.plusPlan},business:{planTitle:g.businessPlan},enterprise:{planTitle:g.enterprisePlan},legacy:{planTitle:g.legacyPlan}},v=(0,c.defineMessages)({notionAI:{defaultMessage:"Notion AI",id:"notionAI.title"},removeAI:{defaultMessage:"Remove AI",id:"notionAI.remove.title"}}),b=(0,c.defineMessages)({month:{defaultMessage:"Monthly billing",id:"billingInterval.monthly"},year:{defaultMessage:"Annual billing",id:"billingInterval.annual"}});function y(){return d.default.formatMessage(m.unableToCancelError)}function _(){return d.default.formatMessage(m.cancellationSuccess)}function S(e){var t;return null===(t=e.schedule)||void 0===t?void 0:t.id}function w(e){const t=function(e){var t;const n=null==e||null===(t=e.subscription)||void 0===t?void 0:t.pending;if(!n)return;const o=(0,a.iv)(e),r=(0,a.Lg)(e);return{oldTier:(0,a.zt)(o)??"free",newTier:(0,a.zt)(r)??"free",oldAddOn:(0,a.xi)(o)[0],newAddOn:(0,a.xi)(r)[0],oldInterval:(0,a.Hw)(o),newInterval:(0,a.Hw)(r),phaseOneEndDate:n.startDate}}(e),n=[];if(!t)return{scheduledChanges:n,periodEndDate:null};const{newTier:o,oldTier:r,oldAddOn:i,newAddOn:s,oldInterval:l,newInterval:c,phaseOneEndDate:u}=t;return r!==o&&n.push(function(e,t){const n=f(e),o=d.default.formatMessage(h[n].planTitle);if(!t)return"";const r=f(t);return`${o} → ${d.default.formatMessage(h[r].planTitle)}`}(r,o)),i!==s&&n.push(function(e,t){return`${d.default.formatMessage(e?v.notionAI:v.removeAI)} → ${d.default.formatMessage(t?v.notionAI:v.removeAI)}`}(i,s)),l!==c&&n.push(function(e,t){return e&&t?`${d.default.formatMessage("month"===e?b.month:b.year)} → ${d.default.formatMessage("month"===t?b.month:b.year)}`:""}(l,c)),{scheduledChanges:n,periodEndDate:u}}function k(e,t,n){return"billing_interval"===e&&"year"===t&&"month"===n}function I(e,t,n){return"plans"===e||"add_ons"===e||"billing_interval"===e&&"month"===t&&"year"===n}function C(e,t){if(!e)return;const n=(0,a.iv)(e).items,o=(0,a.Lg)(e).items;var r;return(0,a.dK)(n,o).some((e=>{let[n,o]=e;return(0,a.tw)(n??o)===t&&n&&!o}))?null===(r=e.subscription)||void 0===r||null===(r=r.pending)||void 0===r?void 0:r.startDate:void 0}function x(e){if(!e)return;var t;return 0===(0,a.Lg)(e).items.length?null===(t=e.subscription)||void 0===t||null===(t=t.pending)||void 0===t?void 0:t.startDate:void 0}function T(e){return(0,p.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,i.e)({width:12}),e.children]})}function M(e){const{newTier:t}=e;switch(t){case"plus":return{label:(0,p.jsx)(T,{children:(0,p.jsx)(c.FormattedMessage,{id:"midtermChangeHelpers.snackbar.upgradePlan.plus",defaultMessage:"You have successfully upgraded to the Plus plan"})})};case"business":return{label:(0,p.jsx)(T,{children:(0,p.jsx)(c.FormattedMessage,{id:"midtermChangeHelpers.snackbar.upgradePlan.business",defaultMessage:"You have successfully upgraded to the Business plan"})})};case"enterprise":return{label:(0,p.jsx)(T,{children:(0,p.jsx)(c.FormattedMessage,{id:"midtermChangeHelpers.snackbar.upgradePlan.enterprise",defaultMessage:"You have successfully upgraded to the Enterprise plan"})})};case"student":return{label:(0,p.jsx)(T,{children:(0,p.jsx)(c.FormattedMessage,{id:"midtermChangeHelpers.snackbar.upgradePlan.student",defaultMessage:"You have successfully upgraded to the Student plan"})})};case"free":case"personal":case"personal_free":case"team_free":return;default:(0,l.t1)(t)}}function P(e){const{billingInterval:t,effectiveDateEpochMs:n}=e,i=n?(0,r.Yx)(n,"medium",o.SP):void 0;return i?{label:(0,p.jsx)(c.FormattedMessage,{id:"midtermChangeHelpers.snackbar.billingInterval.future",defaultMessage:"{billingInterval, select, year {Yearly} other {Monthly}} billling will be effective {date}",values:{billingInterval:t,date:i}})}:{label:(0,p.jsx)(T,{children:(0,p.jsx)(c.FormattedMessage,{id:"midtermChangeHelpers.snackbar.billingInterval.success",defaultMessage:"You have successfully changed to {billingInterval, select, year {yearly} other {monthly}} billing",values:{billingInterval:t}})})}}function A(e){const{addOnFeature:t}=e;if("ai"===t)return{label:(0,p.jsx)(T,{children:(0,p.jsx)(c.FormattedMessage,{id:"midtermChangeHelpers.snackbar.purchaseAddOn.ai",defaultMessage:"You have successfully added Notion AI"})})};(0,l.t1)(t)}},70060:(e,t,n)=>{n.d(t,{F4:()=>C,G2:()=>M,Gb:()=>d,IC:()=>x,KC:()=>p,Pw:()=>D,R$:()=>B,XA:()=>E,Xg:()=>h,bP:()=>R,bQ:()=>w,bU:()=>F,du:()=>v,e0:()=>T,fQ:()=>y,fX:()=>A,fc:()=>Z,fw:()=>b,i4:()=>k,lF:()=>u,oP:()=>_,px:()=>S,rq:()=>I,uO:()=>O,zS:()=>P});var o=n(44317),r=n(47425),i=n(80444),a=n(77080),s=n(88280),l=n(88893),c=n(35057);function d(){return Boolean(a.default.checkGate("ai_annual"))}function u(){return a.default.getEligibleGroup({experimentId:"block_limit_cta_earlier",defaultGroup:"unassigned"})}function p(){return a.default.getEligibleGroup({experimentId:"block_limit_increase"})}const m=7,f=-1;function g(){const{currentSpaceStore:e}=i.default.state,t=null==e?void 0:e.getSettings().first_invited_member_time;return t?(0,o.O5)(t):null}function h(){return a.default.getEligibleGroup({experimentId:"block_limit_cta_earlier",defaultGroup:"unassigned"})}function v(){const e=g();return null!==e&&(!(null!==e&&e>m)&&"on"===a.default.getEligibleGroup({experimentId:"block_limit_delay",defaultGroup:"control"}))}function b(){var e;const t=null===(e=i.default.state.currentSpaceStore)||void 0===e?void 0:e.getSettings();return null!=t&&t.seen_block_limit_reduction_v2&&"on"===a.default.getEligibleGroup({experimentId:"block_limit_reduction"})?"decrease":null!=t&&t.seen_block_limit_increase&&"on"===a.default.getEligibleGroup({experimentId:"block_limit_increase"})?"increase":"normal"}function y(){const e=g();return null!==e&&m-e>0?m-e:f}function _(){return Boolean("on"===a.default.getGroup("churn_nudge"))}function S(e,t){var n;if(e.device.isMobile)return!1;const o=s.subscriptionDataStoreInstance.state;if(!o)return!1;if(("subscribed_admin"===o.type||"unsubscribed_admin"===o.type)&&null!==(n=o.customerData)&&void 0!==n&&n.stripe&&Boolean(o.customerData.stripe.promo))return!1;const i=t??(0,c.zt)();return!!((0,r.mq)(i)&&(0,l.su)(o)<100&&Boolean("on"===a.default.getGroup("largesse")))}function w(){return Boolean("on"===a.default.getGroup("mobile_web_subscriptions"))}function k(){return!((0,l.DB)(s.subscriptionDataStoreInstance.state)||!(0,c.QM)())&&Boolean("on"===a.default.getGroup("plans_page_refresh"))}function I(){return Boolean(a.default.checkGate("sepa_debit"))}function C(){return Boolean("on"===a.default.getGroup("subscription_default_annual"))}function x(){const e=a.default.getGroup("subscription_payment_status");return Boolean("on"===e||"message_only"===e)}function T(){return Boolean("on"===a.default.getGroup("subscription_payment_status"))}function M(){return Boolean(a.default.checkGate("test_clocks"))}function P(e,t){switch(e){case"affiliates":return function(e){return!e.device.isMobile&&Boolean(a.default.checkGate("tt_affiliates"))}(t);case"marketing":return function(e){return!e.device.isMobile&&Boolean(a.default.checkGate("tt_marketing"))}(t);case"upwork":return function(e){return!e.device.isMobile&&Boolean(a.default.checkGate("tt_upwork"))}(t);case"plus":case"business":return!0}}function A(){return Boolean(a.default.checkGate("advanced_security_in_enterprise"))}function R(e){return!e.device.isMobile&&Boolean("on"===a.default.getGroup("checkout_name_required"))}function D(e){return!e.device.isMobile&&Boolean("on"===a.default.getGroup("checkout_refresh"))}function E(e){return!e.device.isMobile&&Boolean("on"===a.default.getGroup("upsell_to_plans_page"))}function B(){return Boolean("on"===a.default.getGroup("upsell_colors"))}function F(){return Boolean(a.default.checkGate("use_mp2_update_subscription_path",!0))}function O(){const e=F(),t=Boolean(a.default.checkGate("can_remove_plan_without_removing_addon",!0));return e&&t}function Z(){return Boolean(a.default.checkGate("low_guest_limit"))}},58333:(e,t,n)=>{n.d(t,{AI:()=>u,Zl:()=>c,_D:()=>l,dP:()=>p,t4:()=>d,ug:()=>s});n(21703);var o=n(9182),r=n(47425),i=n(63143),a=n(70060);function s(e,t){if(!t)return{plan:void 0,addOns:[],isTrial:void 0};const n=e.items.find((e=>"plan"===(0,o.tw)(e))),r=e.items.filter((e=>"plan"!==(0,o.tw)(e))),i=t.items.find((e=>"plan"===(0,o.tw)(e))),s=t.items.filter((e=>"plan"!==(0,o.tw)(e))),l=n&&!i&&s.length>0,c=(0,a.uO)();if(l&&!c)throw new Error("Cancelling plan while updating addOns is not support by api.updateSubscription");return{isTrial:Boolean(t.trialEnd),plan:null==i?void 0:i.price.externalId,addOns:m(r,s).map((e=>{let[t,n]=e;return{isCancellation:!n,priceId:(n??t).price.externalId}}))}}function l(e,t){return m(e.items,t.items).some((e=>{let[t,n]=e;return function(e,t){if(!e)return!1;if(!t)return!0;const n=(0,o.H6)(e),i=(0,o.H6)(t);if(!n||!i)return!1;return r.rC[n]>r.rC[i]}(t,n)}))}function c(e,t,n){let{trialEnd:o,items:r}=t;return{trialEnd:o,items:r.map((t=>{const o=t.price.product,r=t.price.unitAmount.currencyCode,i=f(e,{interval:n,product:o,currency:r});return{...t,price:i}}))}}function d(e,t){const n=(0,a.uO)();if("plan"===t&&!n)return{...e,items:[]};const r=e.items.filter((e=>(0,o.tw)(e)!==t));return{...e,items:r}}function u(e,t){const n=e.items.filter((e=>(0,o.tw)(e)!==(0,o.tw)(t)));return{...e,items:n.concat([t])}}function p(e,t,n){const{quantity:r,product:i,interval:a,currency:s}=n,l=function(e){if("personal_free"===e||"team_free"===e)return"free";return e}(i),c=t.items.filter((e=>(0,o.tw)(e)!==(0,o.h_)(l))),d={quantity:r,price:f(e,{interval:a,product:l,currency:s})};return{...t,items:c.concat([d])}}function m(e,t){return(0,i.UV)(e,(e=>(0,o.tw)(e)),t,(e=>(0,o.tw)(e)))}function f(e,t){let{interval:n,product:o,currency:r}=t;return function(e,t){if(null==e)throw new Error(t);return e}(e.find((e=>"current"===e.state&&e.product===o&&e.billingInterval===n&&e.unitAmount.currencyValue.currencyCode===r)),`Unable to find price with interval: ${n}, product: ${o}, currency: ${r}`)}},88893:(e,t,n)=>{n.d(t,{A7:()=>de,AX:()=>Y,AY:()=>I,Bu:()=>O,CM:()=>me,DB:()=>F,DH:()=>E,Et:()=>H,Fu:()=>be,GD:()=>Q,GJ:()=>M,Gh:()=>z,Io:()=>pe,KU:()=>T,Ln:()=>he,Lz:()=>K,M9:()=>X,MM:()=>q,Md:()=>G,ND:()=>ie,NM:()=>ne,NW:()=>ee,Nf:()=>ke,Ns:()=>ue,Q6:()=>fe,SX:()=>L,Tj:()=>k,XX:()=>C,XZ:()=>j,YK:()=>B,_9:()=>ge,aS:()=>x,cA:()=>oe,gG:()=>A,hn:()=>se,lk:()=>ae,m_:()=>ve,o9:()=>ye,pu:()=>$,qF:()=>Z,qX:()=>ce,qb:()=>N,ri:()=>D,su:()=>le,t1:()=>Se,uN:()=>te,wY:()=>R,wl:()=>P,xR:()=>W,y$:()=>_e,ye:()=>U,zl:()=>re});n(57658),n(67294);var o=n(72126),r=n(72141),i=n(3791),a=n(31919),s=n(2438),l=n(47425),c=n(97880),d=n(9291),u=n(95477),p=n(52533),m=n(80444),f=n(81236),g=(n(27242),n(88280)),h=n(70060),v=n(33941),b=n(35057),y=n(85893);const _=.75,S=.5,w=.25,k=.9;function I(e){var t;if(M(e))return null===(t=e.customerData)||void 0===t||null===(t=t.stripe)||void 0===t?void 0:t.paymentMethodTrustLevel}function C(e){if(e&&"subscribed_admin"===e.type&&function(e){return void 0!==e.billing}(e.customerData.stripe))return e.customerData.stripe}function x(e){var t;if(M(e))return null===(t=e.customerData)||void 0===t?void 0:t.stripe}function T(e){const t=x(e);return null==t?void 0:t.customerId}function M(e){return"subscribed_admin"===(null==e?void 0:e.type)||"unsubscribed_admin"===(null==e?void 0:e.type)}function P(e){return e&&function(e){const t=C(e);if(t)return t.productId}(e)===u.default.pricing.student.productId}function A(e){return e.startsWith("enterprise")}function R(e){return Boolean(e&&"subscribed_admin"===e.type&&e.customerData&&"revenueCat"===e.customerData.activeSubscriptionPlatform&&e.customerData.revenueCat&&!0===e.customerData.revenueCat.isSubscribed)}function D(e){return"verifying"===I(e)}function E(e){const t=C(e);return t&&"number"==typeof t.canceledAt&&"number"==typeof t.willCancelAt}function B(e){return Boolean(e&&"unsubscribed_admin"!==e.type&&"unsubscribed_member"!==e.type&&"unsubscribed_guest"!==e.type)}function F(e){return!!e&&(B(e)||(0,i.E3)(e.addOns))}function O(e){return!B(e)}function Z(e){return!we(e,["personal","student","personal_free"])}function V(e){return(0,b.QM)()}function U(){return(0,b.mq)()}function N(e,t){return t===(0,b.zt)()}function L(e,t){const n=(0,h.Xg)();let o=_;return"25"===n?o=w:"50"===n&&(o=S),re(e,t)>=o}function j(e,t){return re(e,t)>=_}async function z(e){const{environment:t,userRootStore:n}=e;if(!n)return;const r=n.getAdminSpaceIds().map((async e=>{const n=await f.Z.awaitPublicSpaceData(t,e);return n&&n.productId})),i=await Promise.all(r);return o.oA(i)}function q(e){var t;const n="subscribed_admin"===(null==e?void 0:e.type)||"unsubscribed_admin"===(null==e?void 0:e.type)?null===(t=e.customerData)||void 0===t?void 0:t.stripe:void 0;return Boolean(null==n?void 0:n.paymentMethodType)}function H(e){const t=C(e);return"unsubscribed_admin"===e.type||"unsubscribed_member"===e.type?e.accountBalance:t?t.accountBalance:0}function W(e){const{environment:t,userRootStore:n}=e;if(!n)return;const r=n.getAdminSpaceIds().map((e=>{const n=f.Z.getPublicSpaceData(t,e);return n&&n.productId}));return o.oA(r)}function K(e,t){const n=le(t)>1;return O(t)&&V()&&n?t.blockUsage:0}function G(e,t){const{currentUserStore:n}=m.default.state,o=C(t),r=null!=n&&n.isDefined()?n.getEmail():void 0;return e.temporaryBillingEmail||("subscribed_admin"===t.type&&o?o.billingEmail:void 0)||r}function $(){const e=g.subscriptionDataStoreInstance.state,{currentUserStore:t}=m.default.state,n=null!=t&&t.isDefined()?null==t?void 0:t.getEmail():void 0;if(!e)return n;const o=C(e);return"subscribed_admin"===e.type&&null!=o&&o.billing?o.billingEmail:n}function Q(e){return e||"month"}function Y(e){var t;return(null===(t=C(e))||void 0===t?void 0:t.interval)??"year"}function X(e){return!!(0,b.QM)()&&((0,p.S$)({environment:e})?"personal":"plus")}function J(e){const{memberCount:t,subscriptionTier:n,addOnFeature:o,isAddOnFeature:r,billingInterval:i,coupon:a}=e,s=function(e){const{subscriptionTier:t,addOnFeature:n,isAddOnFeature:o}=e;if(!u.default.pricing)return;if(o&&void 0!==n)return u.default.pricing[n].productId;const r=u.default.pricing[t];if("productId"in r)return r.productId}({subscriptionTier:n,addOnFeature:o,isAddOnFeature:r});let l,c,d;return s===u.default.pricing.ai.productId?(l=u.default.pricing.ai.yearlyPricePerMember,c=u.default.pricing.ai.monthlyPricePerMember,"ai_fifty_percent"===a&&(l-=4800,c-=500),d="year"===i?l*t:c*t):s===u.default.pricing.personal.productId?(l=u.default.pricing.personal.yearlyPrice,c=u.default.pricing.personal.monthlyPrice,d="year"===i?l:c):s===u.default.pricing.plus.productId?(l=u.default.pricing.plus.yearlyPricePerMember,c=u.default.pricing.plus.monthlyPricePerMember,d="year"===i?l*t:c*t):s===u.default.pricing.business.productId?(l=u.default.pricing.business.yearlyPricePerMember,c=u.default.pricing.business.monthlyPricePerMember,d="year"===i?l*t:c*t):(l=u.default.pricing.enterprise.yearlyPricePerMember,c=u.default.pricing.enterprise.monthlyPricePerMember,d="year"===i?l*t:c*t),{yearlyUnitPrice:l,monthlyUnitPrice:c,planAmount:d}}function ee(e){const t=g.subscriptionDataStoreInstance.state;return e===u.default.pricing.personal.productId||R(t)?"personal":e===u.default.pricing.student.productId?"personal_education":e===u.default.pricing.plus.productId?"plus":e===u.default.pricing.business.productId?"business":e===u.default.pricing.enterprise.productId?"enterprise":e===u.default.pricing.ai.productId?"ai":"legacy"}function te(e){const{subscriptionTier:t,currencyCode:n,promo:o,data:r,onlyShowAddOn:i,calculatingTax:l,taxAmount:c,addOnFeature:u,billingInterval:p,coupon:m}=e,f=le(r),g=Math.min(0,H(r));let h=0,v=0,b=0;const _=void 0!==u;if(!i){const e=J({subscriptionTier:t,memberCount:f,isAddOnFeature:!1,billingInterval:p});h+=e.yearlyUnitPrice,v+=e.monthlyUnitPrice,b+=e.planAmount}if(_){const e=J({subscriptionTier:t,memberCount:f,isAddOnFeature:!0,addOnFeature:u,billingInterval:p,coupon:m});h+=e.yearlyUnitPrice,v+=e.monthlyUnitPrice,b+=e.planAmount}const S=(0,s.uN)(b,o),w=a.n.fromValue({amount:b-S.amount+g+(c&&!l?c:0),currencyCode:n}).zeroIfNegative(),k=[{type:"standard",name:(0,y.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.subTotal",defaultMessage:"Subtotal"}),price:a.n.fromValue({amount:b,currencyCode:n})}];return k.push({type:l?"calculating":"standard",name:(0,y.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.taxIfApplicable.title",defaultMessage:"Tax if applicable"}),price:a.n.fromValue({amount:b,currencyCode:n})}),0!==S.amount&&k.push({type:"promotion",name:(0,y.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.promo",defaultMessage:"Coupon"}),price:a.n.fromValue({amount:S.amount,currencyCode:n}),subtitle:S.monthsRemaining?(0,y.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.promo.subtitle",defaultMessage:"Valid for {durationInMonths} months",values:{durationInMonths:S.monthsRemaining}}):void 0}),g<0&&k.push({type:"promotion",name:(0,y.jsx)(d.FormattedMessage,{id:"subscriptionHelpers.lineItems.balance",defaultMessage:"Balance"}),price:a.n.fromValue({amount:-g,currencyCode:n})}),{yearlyUnitPrice:h,monthlyUnitPrice:v,planAmount:b,payAmount:w,accountBalance:g,lineItems:k,promoInfo:S}}function ne(e){return"bots"in e?e.bots:[]}function oe(e,t){if((0,h.du)()&&he(e,t)){const e=(0,h.fQ)(),t=0===e?(0,y.jsx)(d.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.gracePeriodBlockLimitToday",defaultMessage:"to upgrade today"}):(0,y.jsx)(d.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.gracePeriodBlockLimitNumDays",defaultMessage:"{remainingDays, plural, one {1 day to upgrade} other {{remainingDays} days to upgrade}}",values:{remainingDays:e}});return(0,y.jsx)(d.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.gracePeriodBlockLimit",defaultMessage:"You've hit Notion's trial block limit, and you have {remainingDaysMessage} before we limit new content creation.",values:{remainingDaysMessage:t}})}return(0,y.jsx)(d.FormattedMessage,{id:"subscriptionSettings.subscriptionStatus.reachedFreeBlockLimit",defaultMessage:"This workspace has used {usedBlocks} of its {freeBlockLimit} block storage limit ({utilizationPercentage}).",values:{usedBlocks:K(0,t),freeBlockLimit:(0,l.v5)((0,h.fw)()),utilizationPercentage:(0,y.jsx)(d.FormattedNumber,{value:re(e,t),style:"percent",maximumSignificantDigits:2,maximumFractionDigits:0})}})}function re(e,t){return K(0,t)/(0,l.v5)((0,h.fw)())}function ie(e){return me(e).filter((e=>!(0,r.Jy)(e.role)))}function ae(e){return ie(e).length}function se(e){return me(e).filter((e=>(0,r.Jy)(e.role)))}function le(e){return se(e).length}function ce(){const e=g.subscriptionDataStoreInstance.state;return e?le(e):1}function de(){const e=g.subscriptionDataStoreInstance.state;return e?ie(e):[]}function ue(){const e=ce();return e<=99?"SMB":e<=1999?"Mid-Market":"Enterprise"}function pe(){const e=g.subscriptionDataStoreInstance.state;return e?se(e):[]}function me(e){return"visibleUsers"in e?e.visibleUsers:e.users}function fe(e){return Boolean(e&&"subscribed_admin"===e.type&&e.customerData&&e.customerData.stripe.isSubscribed&&("enterprise_free"===e.customerData.stripe.plan||"business_sales_assisted"===e.customerData.stripe.plan||"plus_sales_assisted"===e.customerData.stripe.plan))}function ge(e){return"unsubscribed_member"===e.type||"unsubscribed_admin"===e.type||"subscribed_member"===e.type||"subscribed_admin"===e.type||"subscribed_membership_admin"===e.type}function he(e,t){return K(0,t)>=(0,l.v5)((0,h.fw)())}function ve(e){return l.wP(e)?"setup_enterprise_trial":l.NG(e)?"setup_business_trial":void 0}function be(e){return!1}function ye(e){return l.QM(e)}function _e(e){return!V()}function Se(e,t){switch(e){case"personal_free":case"team_free":case"free":return t.formatMessage(v.a.free);case"personal":return t.formatMessage(v.a.personal);case"student":return t.formatMessage(v.a.educationPlan);case"plus":return t.formatMessage(v.a.plusPlan);case"business":return t.formatMessage(v.a.business);case"enterprise":return t.formatMessage(v.a.enterprise);default:(0,c.t1)(e)}}function we(e,t){const n=(0,b.zt)();return!!n&&t.includes(n)}function ke(e){const{subscriptionData:t,spaceStore:n}=e;return!R(t)&&((null==n?void 0:n.canAdmin())??!1)}},33941:(e,t,n)=>{n.d(t,{D:()=>i,a:()=>r});var o=n(9291);const r=(0,o.defineMessages)({ai:{defaultMessage:"AI",id:"ai.title"},personalFreePlan:{defaultMessage:"Personal Plan",id:"personalFreePlan.title"},personalFree:{defaultMessage:"Personal",id:"personalFree.title"},teamTrialPlan:{defaultMessage:"Team Plan (Trial)",id:"teamTrialPlan.title"},freePlan:{defaultMessage:"Free Plan",id:"freePlan.title"},free:{defaultMessage:"Free",id:"free.title"},personalPlan:{defaultMessage:"Personal Pro Plan",id:"personalPlan.label"},personal:{defaultMessage:"Personal Pro",id:"personal.label"},singlePlayerPlusPlan:{defaultMessage:"Plus Plan with a 1-member limit",id:"singlePlayerPlusPlan.title"},educationPlan:{defaultMessage:"Personal Pro Plan (Education)",id:"personalEducationPlan.title"},educationPlusPlan:{defaultMessage:"Education Plus Plan",id:"educationPlusPlan.title"},teamPlan:{defaultMessage:"Team Plan",id:"teamPlan.title"},team:{defaultMessage:"Team",id:"team.title"},plusPlan:{defaultMessage:"Plus Plan",id:"plusPlan.title"},plus:{defaultMessage:"Plus",id:"plus.title"},businessPlan:{id:"businessPlan.title",defaultMessage:"Business Plan"},business:{id:"business.title",defaultMessage:"Business"},enterprisePlan:{defaultMessage:"Enterprise Plan",id:"enterprisePlan.label"},enterprise:{defaultMessage:"Enterprise",id:"enterprise.label"},legacyPlan:{defaultMessage:"Legacy Plan",id:"legacyPlan.label"}}),i=(0,o.defineMessages)({ai:{defaultMessage:"Notion AI",id:"spaceSubscriptionUpgradeModal.orderSummary.ai.addOn"},personal:{defaultMessage:"Plus plan with a 1-member limit",id:"spaceSubscriptionUpgradeModal.orderSummary.singlePlayerPlusPlan"},plus:{defaultMessage:"Plus plan",id:"spaceSubscriptionUpgradeModal.orderSummary.plusPlan"},business:{defaultMessage:"Business plan",id:"spaceSubscriptionUpgradeModal.orderSummary.businessPlan"},enterprise:{defaultMessage:"Enterprise plan",id:"spaceSubscriptionUpgradeModal.orderSummary.enterprisePlan"}})},35057:(e,t,n)=>{n.d(t,{Aw:()=>m,Mk:()=>u,QM:()=>d,Rs:()=>l,c4:()=>h,iJ:()=>f,mq:()=>p,p4:()=>g,sX:()=>s,wP:()=>c,zt:()=>a});var o=n(47425),r=n(88280),i=n(70060);function a(){var e;return o.O9(null===(e=r.subscriptionDataStoreInstance.state)||void 0===e?void 0:e.subscriptionTier)}function s(){return o.sX(a())}function l(){return o.Rs(a())}function c(){return o.wP(a())}function d(){return o.QM(a())}function u(){return o.Mk(a())}function p(){return o.mq(a())}function m(){return o.Aw(a())}function f(){return o.iJ(a())}function g(e){return o.eZ(a(),e)}function h(e){return e?(0,i.fc)()?o.lu:o.kE(e.subscriptionTier??"free"):0}},87598:(e,t,n)=>{n.d(t,{z:()=>o});const o=(0,n(9291).defineMessages)({cancellingTrial:{defaultMessage:"Cancelling your trial.",id:"cancelTrial.error.message"},cancellationConfirmationMessage:{defaultMessage:"Are you sure you want to cancel your trial?",id:"cancelTrial.confirmation.message"},yes:{defaultMessage:"Yes, cancel my trial",id:"cancelTrial.yes.confirmation.message"}})},63423:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},62142:(e,t,n)=>{n.d(t,{Z:()=>s});var o=n(49085),r=n(4615),i=n(27242);class a extends o.default{getInitialState(){return{open:!1,succeeded:!1}}close(){this.setState({open:!1,succeeded:!1})}closeWithSuccess(){this.setState({open:!1,succeeded:!0})}open(e){this.setState({open:!0,temporaryBillingInterval:"month",temporaryAddress:{name:"",businessName:"",addressLine1:"",addressLine2:"",zipCode:"",city:"",state:"",country:""},appliedPromo:void 0,error:void 0,vatApplicable:!1,calculatingTax:!1,payButtonState:"disabled",subscriptionTier:"enterprise",targetPlan:void 0,targetSpace:e,totalUpgradeCost:void 0,onlyShowAddOn:!1,sessionId:(0,r.ZP)(),type:i.U.TargetSpace})}setAddressField(e){this.state.open&&this.setState({...this.state,temporaryAddress:{...this.state.temporaryAddress,...e},taxCalculationError:void 0})}}const s=new a},33493:(e,t,n)=>{n.d(t,{Z:()=>d});n(21703);var o=n(49085),r=n(92595),i=n(64793),a=n(12139),s=n(80444),l=n(22616);class c extends o.default{constructor(){var e;let t,n;super(),e=this;const o=()=>{if("ready"!==this.state.status)return;const e=this.state.prices.map((e=>{const t=Math.floor(100*Math.random()),n=Math.floor(e.unitAmount.amount/100);return new i.tA({external_id:e.externalId,product:e.product,billing_interval:e.billingInterval,currency:e.currencyCode,state:e.state,regions:e.regions,unit_amount:100*n+t})}));this.setPrices(e)};(0,r.exposeDebugValue)("randomizePrices",(function(){let r=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if("ready"!==e.state.status)return;r!==Boolean(n)&&(n&&(clearInterval(n),n=void 0),r?(t=e.state.prices,n=setInterval(o,1e3),o()):t&&e.setPrices(t))}))}getInitialState(){return{status:"init",prices:[],availableCurrencyCodes:["USD"],selectedCurrencyCode:void 0}}resetExceptSelectedCurrencyCode(){this.update((e=>({...this.getInitialState(),selectedCurrencyCode:e.selectedCurrencyCode})))}waitUntilReady(){return this.waitUntil((()=>"ready"===this.state.status))}setPrices(e){this.update((t=>{const n=Array.from(new Set(e.map((e=>e.currencyCode))));n.sort();const o=t.selectedCurrencyCode&&n.includes(t.selectedCurrencyCode)?t.selectedCurrencyCode:n.find((e=>"USD"!==e))??"USD";return{...t,status:"ready",prices:e,availableCurrencyCodes:n,selectedCurrencyCode:o}}))}didStartLoading(){this.update((e=>({...e,status:"loading"})))}getPrice(e,t){const{status:n,selectedCurrencyCode:o}=this.state;if("init"===n){var r;const t=null===(r=s.default.state.currentSpaceStore)||void 0===r?void 0:r.id;t&&l.Zz({environment:e,spaceId:t})}if("ready"!==n)return{isLoaded:!1,result:void 0};const i=this.state.prices,c=i.filter((e=>e.currencyCode===o)),d=c.find(t);return d||a.IE(new Error("No matching price found in PriceStore.getPrice"),{extra:{allPriceCount:i.length,selectedCurrencyCode:o,selectedCurrencyPriceCount:c.length}}),{isLoaded:!0,result:d}}get selectedCurrencyCode(){return this.state.selectedCurrencyCode??"USD"}get availableCurrencyCodes(){return this.state.availableCurrencyCodes}get prices(){return this.state.prices}}const d=new c},25692:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},88280:(e,t,n)=>{n.r(t),n.d(t,{SubscriptionDataStore:()=>r,subscriptionDataStoreInstance:()=>i});var o=n(49085);class r extends o.default{constructor(){super(...arguments),this.spaceId=void 0}getInitialState(){}waitUntilLoaded(){return this.waitUntil((()=>Boolean(this.state)))}}const i=new r},99334:(e,t,n)=>{let o;function r(e){o=e}function i(){return o}n.d(t,{$:()=>r,K:()=>i})},9867:(e,t,n)=>{n.d(t,{wT:()=>se,aQ:()=>ye,ED:()=>xe,mX:()=>J,w6:()=>me,Ui:()=>we,Xy:()=>Te,Uj:()=>pe,Cj:()=>ue,um:()=>ce,s:()=>he,Dv:()=>ge,lo:()=>ae,tn:()=>Ce,hI:()=>Ie,mN:()=>be,WO:()=>ve,X0:()=>oe,YH:()=>_e,JX:()=>ke,Ju:()=>re,$J:()=>X,jg:()=>ie,xI:()=>Y,lH:()=>$,fs:()=>K,$x:()=>G,d:()=>Se,W8:()=>te,Ce:()=>ee,RF:()=>fe});n(21703),n(57658);var o=n(15145),r=n(5220),i=n(68626),a=n(91155),s=n(87479),l=n(72141),c=n(15047),d=n(29369),u=n(19889),p=n(64684),m=n(97880),f=n(63143),g=n(91536),h=n(17224),v=n(54642),b=n(47307),y=n(76464),_=n(9953),S=n(75754),w=n(29974),k=n(150),I=n(82530),C=n(65452),x=n(28020),T=n(33929),M=n(46654),P=n(45010),A=n(78122),R=n(21115),D=n(27406),E=n(68418),B=n(38676),F=n(55838),O=n(77999),Z=n(80444),V=n(3418),U=n(79797),N=n(42185),L=n(30397),j=n(34583),z=n(35057),q=n(30297),H=n(60396),W=n(36225);function K(e){const{store:t,update:n,transaction:o}=e;_.sW({store:t,data:(0,f.Q2)(n),transaction:o})}function G(e){let{environment:t,store:n,update:o,transaction:r}=e;const i=function(e){let{store:t,update:n}=e;const o=t.getSettingsStore().getValue();if(!o)return{};const r={};for(const i in n)r[i]=o[i];return r}({store:n,update:o});_.sW({store:n.getSettingsStore(),data:(0,f.Q2)(o),transaction:r}),h.OR(t,{store:n,old_settings:i,updated_settings:o})}async function $(e){let{environment:t,spaceStore:n,addedStores:o,removedStores:r,createNewTeamFlowId:i,from:a}=e;const s=t.currentUser.id;if(!s||o.some((e=>!e.isDefined())))return!1;const l=n.getSpaceUserStore(s);if(await l.load(),!l.isWorkspaceOwner())throw new Error("Only admins can update default teams");const{performResult:{results:c},serverCommitResult:d}=I.createAndCommit({environment:t,userAction:"teamActions.updateDefaultTeams",perform:e=>{const n=[];for(const r of o){const o=Q({environment:t,transaction:e,teamStore:r,isDefault:!0,from:a,createNewTeamFlowId:i});n.push(o)}for(const o of r){const r=Q({environment:t,transaction:e,teamStore:o,isDefault:!1,from:a,createNewTeamFlowId:i});n.push(r)}return{results:n}}});return await d,await j.bi(t),c.every((e=>e))}function Q(e){let{environment:t,transaction:n,teamStore:o,isDefault:r,from:i,createNewTeamFlowId:a}=e;return o.isDefault()===r||(_.sW({store:o,data:{is_default:r},transaction:n}),n.postSubmitCallbacks.push((e=>{e||h.cX(t,{store:o,is_default_team:r,create_new_team_flow_id:a,from:i})}))),!0}function Y(e){var t;const{environment:n,teamStore:o,newRole:r,transaction:i,permissionsToClear:a}=e,s=a.map((e=>({...e,role:"none"}))),c=(null===(t=o.getTeamPermission())||void 0===t?void 0:t.role)??"none",d={type:"explicit_team_permission",team_id:o.id,role:r};s.push(d),y.ep({environment:n,store:o,permissionItems:s,transaction:i}),o.isDefault()&&y.ep({environment:n,store:o,permissionItems:[{type:"space_permission",role:r}],transaction:i}),(0,l.J5)(c)||!(0,l.J5)(r)||o.getDisableTeamPageEdits()||G({environment:n,store:o,update:{disable_team_page_edits:!0},transaction:i})}function X(e){const{environment:t,teamStore:n,newRole:o,transaction:r,permissionsToClear:i}=e,a=i.map((e=>({...e,role:"none"}))),s={type:"explicit_team_guest_permission",team_id:n.id,role:o};a.push(s),y.ep({environment:t,store:n,permissionItems:a,transaction:r})}function J(e){let{userId:t,teamStore:n,transaction:o,environment:r,permissionRole:i}=e;const a=n.getMembershipDefinedOnTeam(),l=a.find((e=>"user"===e.entity_type&&e.user_id===t));if(!l)throw new Error("Specified user is not on the team");if("member"===l.type)return!1;if(!n.isDefined())return!1;const c=n.getPermissionItems(),d=n.id;if(i&&(0,s.bk)({teamValue:{id:d,permissions:c},permissionRole:i}))throw new Error("Cannot set member's permission to be lower than default team permission.");if(!(0,p.XO)({membership:a}).includes(t))throw new Error("Specified user is not an owner of the team");let u=!1;if(a.length>0){const e=a.filter((e=>!("user"===e.entity_type&&e.user_id===t)));u=a.length!==e.length;const i=[{entity_type:"user",type:"member",user_id:t},...e];I.applyOperation({store:n,operation:{pointer:n.pointer,path:["membership"],command:"set",args:i},transaction:o}),g.Pd(r,{store:n,permission_user_id:t,team_role:"member"})}let m=i||"none";const f=(0,p.xC)({id:d,permissions:c});f&&i===f&&(m="none");const h={type:"user_permission",role:m,user_id:t};return y.ep({environment:r,store:n,permissionItems:[h],transaction:o,skipAnalytics:u})}function ee(e){let{environment:t,userId:n,teamStore:o,spaceStore:r,transaction:i,newTeamRole:a}=e;if(!o.isDefined())return!1;const s=o.getMembers().find((e=>"user"===e.entity_type&&e.user_id===n));return!!s&&(s.type!==a&&(I.applyOperation({store:o,operation:{pointer:o.pointer,path:["membership"],command:"setTeamMembershipItem",args:{entity_type:"user",type:a,user_id:n}},transaction:i}),y.ep({environment:t,store:r,permissionItems:[{type:"user_permission",role:"read_and_write",user_id:n}],transaction:i}),oe({environment:t,memberInfo:s,teamStore:o,transaction:i}),!0))}function te(e){let{environment:t,userId:n,teamStore:o,transaction:r}=e;const i=o.getMembers().find((e=>"user"===e.entity_type&&e.user_id===n));if(!i)throw new Error("Specified user is not on the team");if("owner"===i.type)return!1;if(!o.isDefined())return!1;const a=o.getMembershipDefinedOnTeam().filter((e=>!("user"===e.entity_type&&e.user_id===n))),s=[{entity_type:"user",type:"owner",user_id:n},...a];return I.applyOperation({store:o,operation:{pointer:o.pointer,path:["membership"],command:"set",args:s},transaction:r}),g.Pd(t,{store:o,permission_user_id:n,team_role:"owner"}),oe({environment:t,memberInfo:i,teamStore:o,transaction:r}),!0}function ne(e){let{memberInfo:t,newRole:n}=e;return"user"===t.entity_type?{type:"user_permission",user_id:t.user_id,role:n}:{type:"group_permission",group_id:t.group_id,role:n}}function oe(e){let{environment:t,memberInfo:n,teamStore:o,transaction:r}=e;return!!o.getPermissionItems()&&(y.ep({environment:t,store:o,permissionItems:[ne({memberInfo:n,newRole:"none"})],transaction:r}),!0)}async function re(e){let{store:t,environment:n,accessLevel:o,teamName:r,from:i,isDefault:a}=e;const{currentSpaceStore:s}=Z.default.getState();if(!s)throw new Error("currentSpaceStore does not exist");const l=t.isDefault()??!1,c=t.getTeamAccessLevel(),d=(0,p.Hf)({membership:t.getRawMembership()}).length;if(o===c&&a===l)return!1;if(!(await A.hL({teamName:r,accessLevel:o,currentIsDefault:l,isDefault:a,numberOfTeamGuests:d})))return!1;const u=t.getPermissionItems(),m=t.getSettingsStore().getValue();if(!m||!u)return!1;const f=(0,p.AW)({teamValue:{id:t.id,permissions:u,settings:m},accessLevel:o,isDefault:a}),{performResult:{result:g}}=I.createAndCommit({userAction:"teamActions.setTeamAccessLevel",environment:n,perform:e=>{Q({environment:n,transaction:e,teamStore:t,isDefault:"invite_only"!==f.settings.space_member_join_access&&a,from:i,createNewTeamFlowId:void 0});const o=y.ep({environment:n,store:t,permissionItems:f.permissions,transaction:e});return _.sW({store:t.getSettingsStore(),data:f.settings,transaction:e}),{result:o}}});return g&&h.BW(n,{store:t,old_access_level:c,new_access_level:o,from:i}),g}function ie(e){let{memberInfo:t,teamStore:n,transaction:o,environment:r,permissionRole:i}=e;if("owner"===t.type)return J({userId:t.user_id,teamStore:n,transaction:o,environment:r,permissionRole:i});if(!n.isDefined())return!1;const a=n.id,l=n.getPermissionItems(),c=n.getMembers();if(i&&(0,s.bk)({teamValue:{id:a,permissions:l},permissionRole:i}))throw new Error("Cannot set member's permission to be lower than default team permission.");const d=(0,p.hY)({membership:c});if("user"===t.entity_type&&!d.find((e=>"user"===e.entity_type&&e.user_id===t.user_id))||"group"===t.entity_type&&!d.find((e=>"group"===e.entity_type&&e.group_id===t.group_id)))throw new Error("Specified memberInfo not found on team");let u=i||"none";const m=(0,p.xC)({id:a,permissions:l});return m&&i===m&&(u="none"),y.ep({environment:r,store:n,permissionItems:[ne({memberInfo:t,newRole:u})],transaction:o})}function ae(e,t){E.Z.setState({...E.Z.state,open:!0,from:e}),E.Z.state.onClose=null==t?void 0:t.onClose}async function se(e){let{environment:t,currentSpaceStore:n,teamStore:o,from:r,action:i}=e;const a=t.currentUser.id;if(!a||!n||!(0,q.o)({userId:a,spaceStore:n,entrypoint:r}))return!1;if(!(await async function(e){return!W.Z.state.open&&await new Promise((t=>{W.Z.setState({open:!0,type:e,onAccept:()=>t(!0),onCancel:()=>t(!1)})}))}(i)))return!1;const s=await v.setAdminPrivilegedTeamMembership(t,{spaceId:n.id,teamId:o.id,teamRole:le(i)});if("failed"===s.type)return Te(s),!1;switch(i){case"joinTeamAsOwner":case"joinClosedOrPrivateTeamAsMember":de({environment:t,teamStore:o,from:r,newRole:"joinTeamAsOwner"===i?"owner":"member",usingAdminPrivileges:!0,andNavigateToTeamHome:!1});break;case"upgradeToOwner":g.Pd(t,{permission_user_id:a,team_role:"owner",store:o});const e=o.getName();e&&(0,R._t)(e);break;default:(0,m.t1)(i)}return!0}function le(e){switch(e){case"joinTeamAsOwner":case"upgradeToOwner":return"owner";case"joinClosedOrPrivateTeamAsMember":return"member";default:(0,m.t1)(e)}}async function ce(e){let{environment:t,currentSpaceStore:n,teamStore:o,from:r,andNavigateToTeamHome:i}=e;const a=t.currentUser.id;if(!a)return!1;const s=await v.updateTeamMembers(t,{spaceId:n.id,teamId:o.id,newMembersOrGuestsToAdd:[{type:"member",entity_type:"user",user_id:a}]});return"failed"===s.type?(Te(s),!1):(de({environment:t,teamStore:o,from:r,newRole:"member",usingAdminPrivileges:!1,andNavigateToTeamHome:i}),!0)}function de(e){let{environment:t,teamStore:n,from:o,newRole:r,usingAdminPrivileges:i,andNavigateToTeamHome:a}=e;const s=t.currentUser.id,l=Z.default.state.currentSpaceStore,c=Z.default.state.currentSpaceViewStore;if(!s||!l||!c)return!1;!function(e){var t;let{environment:n,currentSpaceViewStore:o,teamId:r}=e;const i=null===(t=(0,x.k_)(n).state)||void 0===t?void 0:t.userJoinedTeamsStores;if(!i||!o)return!1;const a=[...i.map((e=>{let{id:t}=e;return t})).filter((e=>e!==r)),r];k.Ct({environment:n,currentSpaceViewStore:o,orderedTeamIds:a,userAction:"TeamBrowserOutliner",isExplicitUserAction:!1})}({environment:t,currentSpaceViewStore:c,teamId:n.id}),h.UD(t,{store:n,joined_role:r,from:o}),C.l({environment:t,userId:s,spaceId:l.id});const d=n.getName();a?(Ie({environment:t,teamStore:n,shouldScroll:!1}),d&&new Promise((e=>setTimeout(e,500))).then((()=>{(0,R.$$)({teamName:d,usingAdminPrivileges:i})}))):d&&(0,R.$$)({teamName:d,usingAdminPrivileges:i})}async function ue(e){let{environment:t,teamId:n,spaceId:o,teamMemberInfos:r,isSettingDefaultTeam:i,inviterId:a}=e;const s=t.currentUser.id;if(!o||!s)return!1;return"failed"!==(await v.updateTeamMembers(t,{spaceId:o,teamId:n,newMembersOrGuestsToAdd:r,isSettingDefaultTeam:i,addNewMembersToSpace:!1},a)).type}async function pe(e){let{environment:t,teamStore:n,teamMemberInfos:o,isSettingDefaultTeam:r,createNewTeamFlowId:i}=e;const a=n.getSpaceId();if(!a)return!1;const s=t.currentUser.id;if(!a||!s)return!1;if("failed"===(await v.updateTeamMembers(t,{spaceId:a,teamId:n.id,newMembersOrGuestsToAdd:o,isSettingDefaultTeam:r,addNewMembersToSpace:(0,z.Mk)()},s)).type)return!1;if(!r){const e=o.flatMap((e=>"user"!==e.entity_type?[]:e.user_id)),r=e.length,a=o.filter((e=>"group"===e.entity_type)).length;r>0&&h.ix(t,{store:n,num_members_invited:r,create_new_team_flow_id:i,members_invited:e}),a>0&&h.$1(t,{store:n,num_groups_invited:a,create_new_team_flow_id:i})}return!0}function me(e){switch(e){case"team_browser":case"duplicate_team":case"create_team_from_page":case"permission_item":case"teams_dropdown_for_team_guest":case"teams_dropdown_for_team_member":case"teams_dropdown_for_group":case"teamSidebar":case"teamBrowserSearch":case"teamBrowserUnjoinedTeams":case"teamBrowserJoinedTeams":case"team_breadcrumb_popup":case"team_menu_header":case"sidebar_team_modal":case"team_invite_link":case"teams_dropdown_space_settings_people":return!1;case"manage_teams_table":return!0;default:(0,m.t1)(e)}}function fe(e){let{environment:t,teamId:n,tab:o,from:r,buttonPopupStore:i}=e;const a=Z.default.state.currentSpaceStore;if(!a)return;const s=U.zX.createChildStore(a,{table:d.e0,id:n});if(s.canRead())F.Z.update((e=>({...e,open:!0,tab:o,teamStore:s,viewingUnjoinedPrivateTeamAsEnterpriseAdmin:!1})));else{const e=ge({environment:t,spaceStore:a,teamId:n,from:r});if(!e)return;F.Z.update((t=>({...t,open:!0,tab:o,unjoinedPrivateTeamStore:e,viewingUnjoinedPrivateTeamAsEnterpriseAdmin:!0})))}i&&(V.Z.removeNamedPopup("team_more_actions"),i.setState({...i.state,open:!1}))}function ge(e){var t;let{environment:n,spaceStore:o,teamId:i,from:a}=e;if(!me(a))return;const s=o.getModel(),l=null===(t=Z.default.state.currentUserStore)||void 0===t?void 0:t.id;if(!(0,r.Hx)({spaceModel:s,userId:l}))return;const c=H.Z.createTeamStoreFromCache({environment:n,teamId:i,spaceId:o.id,userId:l}),d=null==c?void 0:c.getModel();return null!=c&&c.canRead()&&d&&(0,p.Ei)({userId:l,teamModel:d,spaceModel:s})?c:void 0}async function he(e){let{environment:t,teamStore:n,currentSpaceStore:o,from:r}=e;const i=t.currentUser.id;return!!i&&await ve({environment:t,teamStore:n,currentSpaceStore:o,userId:i,from:r})}async function ve(e){let{environment:t,teamStore:n,currentSpaceStore:o,userId:r,from:i}=e;const a=n.getSpaceId();if(!(n.isDefined()&&null!=o&&o.isDefined()&&t.currentUser.id&&a))return!1;const s=n.getMembers(),l=(0,p.XO)({membership:s}),c=l.some((e=>e===r));if(c&&1===l.length)return A.ZH(),!1;const d=(0,p.x4)({members:s,groups:o.getPermissionGroups()}).filter((e=>{var t;return null===(t=e.user_ids)||void 0===t?void 0:t.includes(r)}));if(!n.getMembers().find((e=>"user"===e.entity_type&&e.user_id===r)))return A.T0(d),!1;const m=U.t1.createChildStore(n,{table:u.KJ,id:r}),f=r===t.currentUser.id,g=n.getName()??"",b=m.getDisplayName(T.default.getIntl());if(!(await A.A8({isCurrentUser:f,teamName:g,memberName:b})))return!1;const y=[{entity_type:"user",type:c?"owner":"member",user_id:r}],_=await v.updateTeamMembers(t,{spaceId:a,teamId:n.id,existingMembersOrGuestsToRemove:y});return"failed"===_.type?(Te(_),!1):(h.$(t,{store:n,is_leaving_team:f,num_members_removed:y.length,from:i}),d.length>0?f?(0,R.K9)(g,d):(0,R.zs)(b,g,d):f&&(0,R.e6)(g),C.l({environment:t,userId:r,spaceId:a}),!0)}function be(e){let{environment:t,teamStore:n,group:o}=e;const r=n.getSpaceId();if(!r)return;const i=n.getMembers().find((e=>"group"===e.entity_type&&e.group_id===o.id));i&&A.iT({group:o,onAccept:async()=>{const e=[i],o=await v.updateTeamMembers(t,{spaceId:r,teamId:n.id,existingMembersOrGuestsToRemove:e});"failed"!==o.type?h.mi(t,{store:n,num_groups_removed:e.length}):Te(o)}})}async function ye(e){const{currentSpaceStore:t}=Z.default.getState();if(!t)throw new Error("currentSpaceStore does not exist");const{environment:n,teamStore:o,from:r}=e,i=n.currentUser.id,a=o.getName()||"",d=t.getSettingsStore();if(!i)return;const u=L.Z.state.teams.map((e=>({membership:e.getMembers(),id:e.id,archived_by:e.getArchivedBy(),is_default:e.isDefault()}))),p={permissions:t.getPermissionItems(),permission_groups:t.getPermissionGroups()},m=(0,s.wN)({spaceValue:p,spaceMembers:(0,M.aG)(p),teamsInSpace:u,currentUserId:i});if(await A.Fy(a,m)){if(m){const e=await A.wG(a);I.createAndCommit({userAction:"teamsHelpers.archiveLastTeam",environment:n,perform:n=>{if(K({store:o,update:{archived_by:i,archived_at:Date.now()},transaction:n}),_.sW({store:d,data:{is_teams_enabled:!1},transaction:n}),w.oy({planType:"personal",spaceStore:t,transaction:n}),e){const e=o.getTeamPagesStores()??[];for(const o of e){const e=o.getRole();if(!e)continue;const r={type:"user_permission",user_id:i,role:e},a=[...o.getPermissionItems().filter((e=>!l.fG(e)&&!l.Le(e)&&!l.ix(e))),r];_.sW({store:o,data:{parent_id:t.id,parent_table:c.bx,permissions:a},transaction:n})}_.sW({store:o,data:{team_pages:[]},transaction:n})}}}),h.mF(n,{store:o,from:r})}else I.createAndCommit({userAction:"teamsHelpers.archiveTeam",environment:n,perform:e=>{K({store:o,update:{archived_by:i,archived_at:Date.now()},transaction:e})}});h.Gp(n,{store:o,from:r}),"inactive"!==O.default.state.type&&O.default.setState({type:"inactive"}),F.Z.setState({open:!1,limitMembers:!0,memberFilterQuery:"",tab:void 0}),(0,R.CC)(a)}}function _e(e){let{environment:t,teamStore:n,teamName:o,from:r}=e;I.createAndCommit({userAction:"teamsHelpers.restoreArchivedTeam",environment:t,perform:e=>{K({store:n,update:{archived_by:void 0,archived_at:void 0},transaction:e})}}),h.IW(t,{store:n,from:r}),(0,R.JB)(o)}async function Se(e){let{settingName:t,newTeamSettingValue:n,spaceSettingValue:o,environment:r,store:i}=e;let a=!0;return"disable"===o&&"allow"===n?a=await A.hC(t):"disable"===n&&(a=await A.Bj(t)),!!a&&(I.createAndCommit({userAction:"teamsHelpers.changeTeamSetting",environment:r,perform:e=>{G({environment:r,store:i,update:{[t]:"disable"===n},transaction:e})}}),!0)}function we(e){return`TeamToggle_${e.id}`}function ke(e){let{teamStore:t,environment:n}=e;if(n.device.isMobile)return;const o=we(t),r=D.Z.findDropTargetFromKey(o);if(r){const e=r.getNode();if(!(e instanceof HTMLElement))return;if(P.Z.SidebarScroller){var i;const n=(null===(i=P.Z.SidebarScroller.scrollerEl())||void 0===i?void 0:i.offsetTop)||0;P.Z.SidebarScroller.scrollTo(e.offsetTop-n,0,{animate:!0}),N.Z.setState(t.id),setTimeout((()=>{N.Z.state===t.id&&N.Z.setState(void 0)}),1500)}}}function Ie(e){const{environment:t,teamStore:n,shouldScroll:r}=e;r&&ke({teamStore:n,environment:t});const i=n.getTeamPagesStores();!i||i.length<1||(S._({environment:t,store:i[0],pageVisitSource:o.tY.JoinTeam}),h.SJ(t,{store:n}))}function Ce(e,t){let{from:n}=t;h.pi(e,{from:n}),B.sidebarShowTeamBrowserStore.setState(!B.sidebarShowTeamBrowserStore.state)}function xe(e){let{environment:t,from:n,teamStore:o}=e;const{state:r}=E.Z;var i,a;(h.Pr(t,{screen:r.screen,team_id:r.teamId,team_has_icon:Boolean(r.icon),team_has_name:Boolean(r.name),team_has_description:Boolean(r.description),team_access_level:r.accessLevel,flow_id:r.flowId,from:n,store:o}),r.teamId)&&(null===(i=(a=E.Z.state).onClose)||void 0===i||i.call(a,r.teamId));E.Z.reset()}function Te(e){b.showError(e),i.log({level:"error",from:"teamActions",type:"TeamApiError",error:(0,a.Ui)(e.error),data:{miscDataToConvertToString:{body:e.body,status:e.status}}})}},73292:(e,t,n)=>{n.d(t,{RW:()=>l,k7:()=>s,oO:()=>c});var o=n(15157),r=n(66324),i=n(77999),a=n(70704);function s(e){const{environment:t,spaceViewStore:n,teamStore:a,outlinerToggleButtonStore:s,newIsHidden:c,shouldPersistToggleState:d,isExplicitUserAction:u}=e;s.setState({...s.state,isHidden:c}),u&&r.MR(t,{store:a,is_toggled:!c,outliner_type:e.teamOutlinerType}),d&&o.Z.set({userId:n.environment.currentUser.id,key:l(n,a.id),value:c}),c&&i.default.setState({type:"inactive"})}function l(e,t){return`Team_Outliner_Item_${e.id}:${t}`}function c(e){let{oldState:t,teamIds:n,spaceId:r,userId:i}=e;return n.reduce(((e,n)=>{if(n in e)return e;if(n in t)return e[n]=t[n],e;const s=l({id:r},n),c=o.Z.get({userId:i,key:s});return e[n]=new a.Z,e[n].setState({isHidden:c??!1}),e}),{})}},28517:(e,t,n)=>{n.d(t,{I:()=>s,m:()=>l});n(21703);var o=n(72126),r=n(54642),i=n(95697),a=n(69911);async function s(e){let{environment:t,spaceId:n,userId:o}=e;if(!t.currentUser.loggedInUserIds.includes(o))throw new Error("Must be logged in user.");(0,i.bq)()&&(a.Z.getUserJoinedTeamsState({userId:o,spaceId:n})||await l({environment:t,spaceId:n,userId:o}))}async function l(e){var t;let{environment:n,spaceId:i,userId:s,emitValue:l}=e;if(!n.currentUser.loggedInUserIds.includes(s))throw new Error("Must be logged in user.");a.Z.setHasFetched({userId:s,spaceId:i});const c=await r.getTeams(n,{spaceId:i,onlyJoined:!0},s);if("failed"===c.type)return;const d=c.data.teamIds,u=(null===(t=a.Z.getUserJoinedTeamsState({userId:s,spaceId:i}))||void 0===t?void 0:t.joinedTeamsIds)||[];d.length===u.length&&0===o.e5(d,u).length&&0===o.e5(u,d).length||a.Z.setUserJoinedTeamsState({userId:s,spaceId:i,state:{joinedTeamsIds:d,lastEmitValue:l}})}},74016:(e,t,n)=>{n.d(t,{p:()=>m});n(67294);var o=n(480),r=n(86628),i=n(24405),a=n(79362),s=n(22808),l=n(31278),c=n(48779),d=n(80444),u=n(79797),p=n(85893);function m(e){window.__c={n:"TeamSpaceIcon"};const{store:t,size:n=16,style:m,disabled:f=!1,onChange:g=(()=>{})}=e,h=(0,o.O7)(),{name:v,icon:b}=(0,r.VK)((()=>{const n=d.default.state.currentSpaceStore;return t?t instanceof u.zX?{name:t.getName(),icon:e.icon??t.getIcon()}:{name:(0,c.rn)(h,t),icon:e.icon??(0,c.Wd)(h,t)}:{name:n&&`team-icon-${n.id}`,icon:e.icon}}),[t,h,e.icon]),y=(0,i.yK)((e=>({backgroundContainer:{background:b&&(0,a.V2)(b.icon)?(0,a.Pk)(b.icon,e.mode):e.regularDividerColor,width:n,height:n}})),[b,n]),_=b&&b.icon&&((0,a.V2)(b.icon)||(0,s.Z)(b.icon)),S=e.iconLoggingData||t&&{recordTable:t.table,source:"team_settings"};return(0,p.jsx)(l.Z,{title:v,icon:b,size:_?.9*n:n,emojiSize:_?.78*n:n,isEmptyPage:!1,style:_?{...m,...y.backgroundContainer}:m,isLarge:!0,largeIcon:!0,iconLoggingData:S,...f?{disabled:!0}:{disabled:!1,onChange:g,bucket:"public"}})}},30297:(e,t,n)=>{n.d(t,{o:()=>l,r:()=>c});var o=n(480),r=n(86628),i=n(5220),a=n(80444),s=n(9867);function l(e){let{entrypoint:t,userId:n,spaceStore:o}=e;return(0,i.Hx)({spaceModel:null==o?void 0:o.getModel(),userId:n})&&s.w6(t)}function c(e){const t=(0,o.O7)().currentUser.id;return(0,r.VK)((()=>{const{currentSpaceStore:n}=a.default.state;return l({entrypoint:e,spaceStore:n,userId:t})}),[t,e])}},60396:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(26263),r=n(49085),i=n(29369),a=n(97880),s=n(20431);class l extends r.default{getInitialState(){return{initialized:!1}}createTeamStoreFromCache(e){let{environment:t,teamId:n,spaceId:o,userId:r}=e;if(this.state.initialized&&o&&r&&this.state.spaceId===o&&this.state.userId===r)return new s.z(t,{table:i.e0,id:n},{inMemoryRecordCache:this.state.inMemoryCache})}initialize(e){let{environment:t,userId:n,spaceId:r,teamIds:s,getRecordWithRole:l}=e;const c=new o.Z({name:"GlobalEnterpriseAdminTeamsStore"});for(const o of s){const e={table:i.e0,id:o};c.setRecord({pointer:e,userId:n},l(e))}return this.setState({initialized:!0,spaceId:r,userId:n,inMemoryCache:c}),s.map((e=>this.createTeamStoreFromCache({environment:t,teamId:e,spaceId:r,userId:n}))).filter(a.$K)}}const c=new l},36225:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{open:!1}}}const i=new r},75769:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{hasShownTooltip:!1}}hasShownTootlip(e){return this.state.hasShownTooltip&&this.state.teamId===e}}const i=new r},69911:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{joinedTeamsStates:{},hasFetched:new Set}}getKey(e){let{userId:t,spaceId:n}=e;return`${t}:${n}`}getUserJoinedTeamsState(e){let{userId:t,spaceId:n}=e;const o=this.getKey({userId:t,spaceId:n});return this.state.joinedTeamsStates[o]}setUserJoinedTeamsState(e){let{userId:t,spaceId:n,state:o}=e;const r=this.getKey({userId:t,spaceId:n});this.state.joinedTeamsStates[r]=o,this.emit()}getHasFetched(e){let{userId:t,spaceId:n}=e;const o=this.getKey({userId:t,spaceId:n});return this.state.hasFetched.has(o)}setHasFetched(e){let{userId:t,spaceId:n}=e;const o=this.getKey({userId:t,spaceId:n});this.state.hasFetched.add(o)}}const i=new r},83941:(e,t,n)=>{n.d(t,{M:()=>r});var o=n(77080);function r(e){return"on"===o.default.getEligibleGroup({experimentId:"duplication_workspace_selection_modal3",defaultGroup:"control",...e})}},51247:(e,t,n)=>{n.d(t,{E2:()=>r,YQ:()=>o,dm:()=>i,wN:()=>a});const o=90,r=90,i=275,a=32},29949:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(49085);class r extends o.default{getInitialState(){return{status:"closed"}}open(e){const{analyticsFrom:t,cloneTo:n,selectedTemplate:o,selectedTeam:r}=e;this.setState({...this.state,status:"opening",analyticsFrom:t,cloneTo:n,selectedTemplate:o,selectedTeam:r})}}const i=new r},24161:(e,t,n)=>{n.d(t,{N:()=>a,v:()=>i});var o=n(97880);const r={invertedInsertText:!0,invertedDeleteText:!0,invertedMoveTextSlice:!0,invertedAddAnnotation:!0,invertedRemoveAnnotation:!0};function i(e){return Boolean(r[e.command])}function a(e){const{pointer:t,invertedCrdtOperation:n}=e,r=n.type;switch(r){case"invertedInsertText":return{command:"invertedInsertText",pointer:t,path:[],args:n};case"invertedDeleteText":return{command:"invertedDeleteText",pointer:t,path:[],args:n};case"invertedAddAnnotation":return{command:"invertedAddAnnotation",pointer:t,path:[],args:n};case"invertedRemoveAnnotation":return{command:"invertedRemoveAnnotation",pointer:t,path:[],args:n};default:(0,o.t1)(r)}}},65663:(e,t,n)=>{n.d(t,{F:()=>a});var o=n(67175),r=n(82530),i=n(24161);function a(e){const{transaction:t,store:n,crdtOperations:a,invertedOperations:s}=e;r.applyCrdtTextOperations({transaction:t,store:n,operations:a.map((e=>(0,o.W5)({pointer:n.pointer,crdtOperation:e}))),invertedOperations:s.map((e=>(0,i.N)({pointer:n.pointer,invertedCrdtOperation:e})))})}},60027:(e,t,n)=>{n.d(t,{T:()=>_,n:()=>S});var o=n(30120),r=(n(67294),n(68626)),i=n(9182),a=n(9291),s=n(86572),l=n(54642),c=n(47307),d=n(80444),u=n(22616),p=n(34583),m=n(5682),f=n(58333),g=n(88893),h=n(33493),v=n(88280),b=n(22500),y=n(85893);async function _(e){const{environment:t,stripe:n,elements:l,trialData:_,trialDays:S}=e,w=v.subscriptionDataStoreInstance.state;if(!w)return void r.log({level:"error",from:"trialUpsellActions",type:"StripeError",error:{miscDataString:"Unable to get subscription data."}});if(!l||!n)return void r.log({level:"error",from:"trialUpsellActions",type:"StripeError",error:{miscDataString:"Stripe elements not initialized when user tried to upgrade"}});const{error:k}=await l.submit();if(k)return void s.iL(t,{error:"could not submit form",error_type:"payment_method"});const I=await n.createPaymentMethod({elements:l});if(I.error)return void s.iL(t,{error:I.error.message,error_type:"payment_method"});if(!I.paymentMethod)return void s.iL(t,{error:"could not create token",error_type:"payment_method"});const C={type:"paymentMethodId",value:I.paymentMethod.id},x=d.default.state.currentSpaceStore;if(!x)return;const T=x.id,M=await u.aQ({environment:t,spaceId:T}),P=(0,m.P)(M,w),A=(0,i.Lg)(P),R=h.Z.state.selectedCurrencyCode??"USD",D={product:(0,b.Hy)(),interval:"month",currency:R,quantity:1},E=(0,f.dP)(M,A,D),B=o.ou.now().plus({days:S});return await async function(e){const{environment:t,spaceStore:n,paymentData:o,desiredState:r,stripe:i,trialData:l}=e;try{const e=await p.Mg({environment:t,spaceStore:n,desiredState:r,paymentData:o,from:"onboarding",trialData:l,billingEmail:(0,g.pu)()}),s=e.paymentIntentClientSecret,d=e.paymentIntentStatus;if(s&&"requires_action"===d){const{error:e}=await i.handleNextAction({clientSecret:s});e&&(await p.EO({environment:t,spaceStore:n,planType:n.getPlanType()??"personal",from:"subscription_upgrade_onboarding_failed_payment"}),c.showErrorMessage((0,y.jsx)(a.FormattedMessage,{id:"subscription.upgrade.payment_failed",defaultMessage:"Your payment could not be processed. Please provide an alternate payment method or you will lose access to Notion."})))}return"success"}catch{return void s.Bg(t)}}({environment:t,spaceStore:x,desiredState:{...E,trialEnd:B},paymentData:C,stripe:n,subscriptionTier:(0,b.Hy)(),trialData:_})}async function S(e){const t=await l.getExternalOrgData(e,{});if("failed"===t.type)return!1;const n=t.data;return"company_employee_count"in n&&parseInt(n.company_employee_count)>99}},22500:(e,t,n)=>{n.d(t,{Hy:()=>f,yt:()=>g,O1:()=>d,XG:()=>p,zQ:()=>u});var o=n(9852),r=n(18212),i=n(64002),a=n(70060),s=n(53809),l=n(30548);const c=new s.D({key:"trialUpsell",namespace:l.$p,important:!1,trackingType:"preference"});function d(e){return Boolean(e&&["affiliates","marketing","upwork"].includes(e))}function u(e,t){(0,a.zS)(e,t)&&c.setState(e)}function p(){const e=(0,i.nx)(new URL(window.location.href).toString(),(0,o.x6)());null!=e&&e.trial_source&&(e.trial_source=void 0,(0,o.NW)(e)),c.setState(void 0)}function m(){var e;const t=null===(e=(0,o.x6)())||void 0===e?void 0:e.trial_source;return t&&d(t)?t:c.getState()??"plus"}function f(){return"business"===m()?"business":"plus"}function g(e){const t=m(),n=(0,r.Rk)();if(e&&"upwork"!==t)return n.enterprise;if(!t)return n.default;switch(t){case"affiliates":return n.affiliates;case"marketing":return n.marketing;case"upwork":return n.upwork;default:return n.default}}},42198:(e,t,n)=>{n.r(t),n.d(t,{default:()=>m});var o=n(49085),r=n(72126),i=n(63143),a=n(77080),s=(n(57658),n(97880)),l=n(54642),c=n(98730);async function d(e){const{spaceId:t,userId:n,environment:o}=e,r=await l.getUserSignals(o,{spaceId:t,signals:[{name:"similarUserRecentPages",includeRecords:!0},{name:"topPages7dPageView",includeRecords:!0},{name:"editedPages1d",includeRecords:!0},{name:"similarUsersEditedPages1d",includeRecords:!0}]});if("success"===r.type){const e={};r.data.signals.forEach((t=>{if("error"===t.status)return;const n=t.name;"similarUserRecentPages"===n?e[n]=function(e){const t=new Map,n=new Map;return e.forEach((e=>{let{userId:t,similarity:o}=e;n.set(t,o)})),e.forEach((e=>{const{userId:o,similarity:r}=e;e.recentPages.forEach((i=>{let{visitedAt:a,pageId:s}=i;const l=t.get(s);if(l){l.userIds.push(o),l.mostRecentlyVisitedAt<a&&(l.mostRecentlyVisitedUser=e.userId,l.mostRecentlyVisitedAt=a);const t=n.get(l.mostSimilarUser);t&&t<r&&(l.mostSimilarUser=o)}else t.set(s,{userIds:[o],mostRecentlyVisitedUser:o,mostRecentlyVisitedAt:a,mostSimilarUser:o})}))})),{pagesMetadata:t,userSimilarityScores:n}}(t.data):"topPages7dPageView"===n?e[n]=function(e){const t=new Map;return e.forEach((e=>{t.set(e.pageId,e.pageAuthorityV1)})),t}(t.data):"editedPages1d"===n||"similarUsersEditedPages1d"===n?e[n]=function(e){const t=new Map;return e.forEach((e=>{t.set(e.pageId,e.editedAt)})),t}(t.data):(0,s.t1)(n)})),m.update((o=>({...o,userSignals:o.userSignals.set(m.getKey(t,n),e)}))),c.S(o)}}const u=5*i.hM;class p extends o.default{constructor(){super(...arguments),this.refreshTimer=void 0,this.getKeyMemoized=(0,r.HP)(this.getKey)}getInitialState(){return{userSignals:new Map}}getKey(e,t){return`${e}:${t}`}getUserSignals(e){let{spaceId:t,userId:n}=e;if(!t||!n)return;const o=this.getKeyMemoized(t,n),r=this.state.userSignals.get(o);return r||void 0}initializeAndLoadAllUserSignals(e){this.refreshTimer&&window.clearTimeout(this.refreshTimer);(a.default.getEligibleGroup({experimentId:"search-new-local-recall-v2",parameter:"userSignals",defaultGroup:[]})??[]).length>0&&(d(e),this.refreshTimer=window.setTimeout((()=>{d(e)}),u))}isSimilarUsersRecentPages(e){var t;const{userId:n,spaceId:o,pageId:r}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t?void 0:t.has(r)}getNumSimilarUsersVisitedPage(e){var t;const{userId:n,spaceId:o,pageId:r}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t||null===(t=t.get(r))||void 0===t||null===(t=t.userIds)||void 0===t?void 0:t.length}getSimilarUsersMostRecentVisitTimeForPage(e){var t;const{userId:n,spaceId:o,pageId:r}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t||null===(t=t.get(r))||void 0===t?void 0:t.mostRecentlyVisitedAt}getHighestViewerSimilarityScoreForPage(e){var t,n;const{userId:o,spaceId:r,pageId:i}=e,a=this.getUserSignals({userId:o,spaceId:r}),s=null==a||null===(t=a.similarUserRecentPages)||void 0===t||null===(t=t.pagesMetadata)||void 0===t||null===(t=t.get(i))||void 0===t?void 0:t.mostSimilarUser;if(s)return null==a||null===(n=a.similarUserRecentPages)||void 0===n||null===(n=n.userSimilarityScores)||void 0===n?void 0:n.get(s)}isTopPages7dPageView(e){var t;const{userId:n,spaceId:o,pageId:r}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.topPages7dPageView)||void 0===t?void 0:t.has(r)}getPageAuthorityV1ForPage(e){var t;const{userId:n,spaceId:o,pageId:r}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.topPages7dPageView)||void 0===t?void 0:t.get(r)}isRecentlyEdited(e){var t;const{userId:n,spaceId:o,pageId:r}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.editedPages1d)||void 0===t?void 0:t.has(r)}getUserLastEditedTimeForPage(e){var t;const{userId:n,spaceId:o,pageId:r}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.editedPages1d)||void 0===t?void 0:t.get(r)}isSimilarUsersRecentlyEdited(e){var t;const{userId:n,spaceId:o,pageId:r}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUsersEditedPages1d)||void 0===t?void 0:t.has(r)}getSimilarUserLastEditedTimeForPage(e){var t;const{userId:n,spaceId:o,pageId:r}=e;return null===(t=this.getUserSignals({userId:n,spaceId:o}))||void 0===t||null===(t=t.similarUsersEditedPages1d)||void 0===t?void 0:t.get(r)}}const m=new p},74994:(e,t,n)=>{n.d(t,{u:()=>s});n(57658);class o extends Map{constructor(e,t){super(t),this.defaultFactory=void 0,this.defaultFactory=e}get(e){if(!super.has(e)){const t=this.defaultFactory(e);super.set(e,t)}return super.get(e)}}var r=n(72126),i=n(70203);let a;a=Symbol.iterator;class s{constructor(){this.unique=new Map,this.multi=new o((()=>[]))}static fromArray(e){const t=new this;for(const n of e)(0,i.Pb$)(n)?t.add(n):t.findFirstOfType((0,i.J7s)(n))||t.add(n);return t}static normalize(e){return this.fromArray(e).toArray()}*[a](){for(const[,e]of this.unique)yield e;for(const[,e]of this.multi)for(const t of e)yield t}toArray(){return Array(...this)}findFirstOfType(e){if((0,i.WU4)(e)){return this.multi.get(e)[0]??void 0}return this.unique.get(e)??void 0}findType(e){if((0,i.WU4)(e))return this.multi.get(e);{const t=this.unique.get(e);return t?[t]:[]}}find(e){const t=[];for(const n of this)e(n)&&t.push(n);return t}add(e){(0,i.Pb$)(e)?this.multi.get((0,i.J7s)(e)).push(e):this.unique.set((0,i.J7s)(e),e)}removeType(e){if((0,i.WU4)(e)){const t=this.multi.get(e);return this.multi.delete(e),t.length>0}return this.unique.delete(e)}remove(e){if((0,i.Pb$)(e)){const t=(0,i.J7s)(e),n=this.multi.get(t),o=n.filter((t=>!r.Xy(t,e)));return this.multi.set(t,o),o.length<n.length}{const t=(0,i.J7s)(e),n=this.unique.get(t);return!(!n||!r.Xy(n,e))&&(this.unique.delete(t),!0)}}}},28084:(e,t,n)=>{n.d(t,{Z:()=>i});n(21703),n(57658);var o=n(7406),r=n(29477);const i=class{constructor(e){this.performRequests=void 0,this.batchSize=void 0,this.maxWorkers=void 0,this.requestDelayMs=void 0,this.requestTimeoutMs=void 0,this.queue=[],this.currentWorkers=0,this.currentSetTimeouts=0,this.dequeue=async()=>{if(this.currentSetTimeouts=0,this.currentWorkers>=this.maxWorkers||0===this.queue.length)return;this.currentWorkers++;const e=this.queue.splice(0,this.batchSize),t=e.map((e=>e.request));let n,i;try{if(this.requestTimeoutMs){const e=await r.OI(this.requestTimeoutMs,this.performRequests(t));if(e.timeout)throw new Error("Timed out.");n=e.result}else n=await this.performRequests(t)}catch(a){i=(0,o.tg)(a)}try{if(i)for(let t=0;t<e.length;t++){e[t].deferred.reject(i)}else if(n)for(let t=0;t<e.length;t++){const o=e[t],r=n[t];o.deferred.resolve(r)}}catch(s){}this.currentWorkers--,this.queue.length>=this.batchSize?this.dequeue():this.dequeueAfterTimeout()};const{performRequests:t,batchSize:n,maxWorkers:i,requestDelayMs:a,requestTimeoutMs:s}=e;this.performRequests=t,this.batchSize=n,this.maxWorkers=i,this.requestDelayMs=a||0,this.requestTimeoutMs=s}getQueueSize(){return this.queue.length}updateBatchSize(e){this.batchSize=e}updateRequestDelayMs(e){this.requestDelayMs=e}getMaxWorkers(){return this.maxWorkers}updateMaxWorkers(e){this.maxWorkers=e,this.dequeueAfterTimeout()}enqueue(e){const t=r.UZ();return this.queue.push({request:e,deferred:t}),this.dequeueAfterTimeout(),t.promise}dequeueAfterTimeout(){this.currentSetTimeouts<this.maxWorkers&&(this.currentSetTimeouts++,setTimeout(this.dequeue,this.requestDelayMs))}}},54064:(e,t,n)=>{n.d(t,{Z:()=>o});const o=class{constructor(){this.listeners={}}addListener(e,t){let n=this.listeners[e];n||(n=new Set,this.listeners[e]=n),n.add(t)}addOnceListener(e,t){var n=this;const o=function(){n.removeListener(e,o),t(...arguments)};this.addListener(e,o)}removeListener(e,t){const n=this.listeners[e];n&&(n.delete(t),0===n.size&&delete this.listeners[e])}emit(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),o=1;o<t;o++)n[o-1]=arguments[o];const r=this.listeners[e];r&&r.forEach((e=>e(...n)))}listenerCount(e){const t=this.listeners[e];return t?t.size:0}}},55652:(e,t,n)=>{n.d(t,{s:()=>r});n(57658);var o=n(97880);class r{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:()=>{};this.buckets={},this.count=0,this.total=0,this.unique=0,this.startedAt=new Map,this.logger=e}async measureErrors(e,t,n,o){const r=`${e} ${++this.unique}`;this.start(r);try{const e=await o();return this.end(r,t),e}catch(i){throw this.end(r,n,i),i}}get average(){return Math.floor(this.total/this.count)}get summary(){const e=[];e.push(`avg ${this.average}ms for ${this.count} calls`);for(const[t,n]of(0,o.qP)(this.buckets)){if(!n)continue;const o=Math.floor(n.total/n.count),r=(n.count/this.count*100).toFixed(2);e.push(`[${t}: ${r}% avg ${o}ms]`)}return e.join(" ")}start(e){this.startedAt.set(e,"object"==typeof performance?performance.now():Date.now())}end(e,t){const n=this.startedAt.get(e);if(!n)return;this.startedAt.delete(e);const o=("object"==typeof performance?performance.now():Date.now())-n;this.count++,this.total=this.total+o;let r=this.buckets[t];r||(r={count:0,total:0},this.buckets[t]=r),r.count++,r.total=r.total+o;for(var i=arguments.length,a=new Array(i>2?i-2:0),s=2;s<i;s++)a[s-2]=arguments[s];this.logger(`end ${e} ${t}: ${o}ms`,...a)}}},15157:(e,t,n)=>{n.d(t,{Z:()=>r});var o=n(30548);const r=new class{constructor(e,t){this.localStorageStore=void 0,this.localStorageStore=new o.ZP(e,t,"necessary")}get(e){let{userId:t,key:n}=e;return this.localStorageStore.get(this.makeUserKey(t,n))}set(e){let{userId:t,key:n,value:o}=e;return this.localStorageStore.set(this.makeUserKey(t,n),o)}remove(e){let{userId:t,key:n}=e;return this.localStorageStore.remove(this.makeUserKey(t,n))}clearStorageForUser(e){this.localStorageStore.scan((t=>{t.startsWith(e)&&this.remove({userId:e,key:t})}))}scan(e){this.localStorageStore.scan(e)}makeUserKey(e,t){return`${e||"guest"}:${t}`}}(o.TA,!1)},75189:(e,t,n)=>{n.d(t,{uP:()=>P,yx:()=>M});var o=n(74487);const r=o.union([o.number(),o.string(),o.boolean(),o.isNull(),o.array(o.string())]),i=o.undefinable(r),a=o.union([r,o.record(o.string(),r)]),s=o.union([i,o.record(o.string(),i)]),l=o.union([s,o.record(o.string(),s)]),c=l,d=o.without(o.without(o.nonEmpty(o.string()),"{"),"}");o.object({required:{key:d,value:a,ttl:o.undefinable(o.number())},optional:{}}),o.object({required:{key:d,value:s,version:o.number()},optional:{}}),o.object({required:{key:d,value:o.number(),ttl:o.undefinable(o.number())},optional:{}}),o.object({required:{key:d,value:o.number(),version:o.number()},optional:{}}),o.object({required:{key:d,amount:o.number(),ttl:o.undefinable(o.number())},optional:{passThroughData:c}}),o.object({required:{key:d,value:o.number(),version:o.number()},optional:{}}),o.object({required:{key:d,field:o.string(),value:s,ttl:o.undefinable(o.number())},optional:{}}),o.object({required:{key:d,field:o.string(),value:l,version:o.number()},optional:{}}),o.object({required:{id:o.string()},optional:{}}),o.object({required:{setValueTime:o.number()},optional:{}}),o.object({required:{key:d,field:o.string(),updates:o.record(o.string(),i),ttl:o.undefinable(o.number())},optional:{}}),o.object({required:{key:d,field:o.string(),value:l,version:o.number()},optional:{}});const u=o.object({required:{blockId:o.string(),userId:o.string(),spaceId:o.string(),operation:o.literal("logPageExit"),pageVisitId:o.undefinable(o.string()),ts:o.number()},optional:{}}),p=(o.object({required:{},optional:{}}),o.object({required:{key:d},optional:{}}),o.object({required:{key:d,value:s,version:o.number()},optional:{}}),o.object({required:{operation:o.literal("setValue"),key:d,value:o.string(),ttl:o.undefinable(o.number())},optional:{}})),m=o.object({required:{operation:o.literal("setValue"),key:d,value:s,version:o.number()},optional:{}}),f=o.object({required:{operation:o.literal("increment"),key:d,amount:o.number(),ttl:o.undefinable(o.number())},optional:{passThroughData:c}}),g=o.object({required:{operation:o.literal("increment"),key:d,value:o.number(),version:o.number()},optional:{}}),h=o.object({required:{operation:o.literal("setIfGreater"),key:d,value:o.number(),ttl:o.undefinable(o.number())},optional:{}}),v=o.object({required:{operation:o.literal("setIfGreater"),key:d,value:o.number(),version:o.number()},optional:{}}),b=o.object({required:{operation:o.literal("setField"),key:d,field:o.string(),value:s,ttl:o.undefinable(o.number())},optional:{}}),y=o.object({required:{operation:o.literal("setField"),key:d,field:o.string(),value:l,version:o.number()},optional:{}}),_=o.object({required:{operation:o.literal("updateField"),key:d,field:o.string(),updates:o.record(o.string(),i),ttl:o.undefinable(o.number())},optional:{}}),S=o.object({required:{operation:o.literal("updateField"),key:d,field:o.string(),value:l,version:o.number()},optional:{}}),w=o.object({required:{operation:o.literal("logPageExit"),spaceId:o.string(),userId:o.string(),blockId:o.string(),pageVisitId:o.undefinable(o.string())},optional:{}}),k=o.object({required:{operation:o.literal("logPageExit")},optional:{}}),I={setValue:p,increment:f,setIfGreater:h,setField:b,updateField:_,logPageExit:w},C=o.union(Object.values(I)),x={setValue:m,increment:g,setIfGreater:v,setField:y,updateField:S,logPageExit:k},T=o.union(Object.values(x)),M=(o.object({required:{operations:o.array(C)},optional:{}}),o.object({required:{responses:o.array(T)},optional:{}}),o.object({required:{subscriptions:o.array(o.object({required:{key:d,version:o.number()},optional:{}}))},optional:{}}),o.object({required:{responses:o.array(o.object({required:{key:d,wasNotified:o.boolean()},optional:{}})),internalProcessingTimeMs:o.number()},optional:{}}),o.object({required:{key:d,version:o.number()},optional:{}}),o.object({required:{key:d,wasNotified:o.boolean()},optional:{}}),o.object({required:{keys:o.array(d)},optional:{}}),o.object({required:{keys:o.array(d),internalProcessingTimeMs:o.number()},optional:{}}),o.object({required:{key:d},optional:{}}),o.object({required:{key:d},optional:{}}),o.object({required:{disconnectId:o.string(),operations:o.array(C)},optional:{}}),o.object({required:{disconnectId:o.string(),hadDisconnect:o.boolean()},optional:{}}),o.object({required:{disconnectId:o.string()},optional:{}}),o.object({required:{disconnectId:o.string(),wasRemoved:o.boolean()},optional:{}}),o.union([o.object({required:{type:o.literal("notification"),key:d,value:l,version:o.number()},optional:{passThroughData:c}}),o.object({required:{type:o.literal("response"),status:o.literals("ok","error"),requestId:o.string(),result:o.any()},optional:{}})])),P=o.object({required:{userId:o.string(),present:o.boolean()},optional:{activityTimestamp:o.number(),blockId:o.union([o.isNull(),o.string()])}});o.object({required:{max_records:o.number()},optional:{}}),o.object({required:{values:o.array(u)},optional:{}}),o.object({required:{last_length:o.number(),new_length:o.number(),added:o.boolean()},optional:{}})},11799:(e,t,n)=>{n.d(t,{Z:()=>c});var o=n(67266),r=n.n(o),i=n(72126);let a;const s=new WeakMap;function l(e){let t=s.get(e);return void 0!==t||(t=r()(e),s.set(e,t)),t}a=Symbol.iterator;class c{constructor(){let{getKey:e=l,from:t}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.map=new Map,this.getKey=void 0,this.getKey=e,t)for(const[n,o]of t)this.set(n,o)}get size(){return this.map.size}set(e,t){return this.map.set(this.getKey(e),[e,t])}get(e){const t=this.map.get(this.getKey(e));if(t)return t[1]}has(e){return this.map.has(this.getKey(e))}delete(e){return this.map.delete(this.getKey(e))}*entries(){for(const e of this.map.values())yield e}[a](){return this.entries()}*keys(){for(const e of this.map.keys())yield JSON.parse(e)}*values(){for(const[e,t]of this.map.values())yield t}valuesArray(){return Array.from(this.values())}compactedValuesArray(){return i.oA(Array.from(this.values()))}}},91627:(e,t,n)=>{n.d(t,{X:()=>a});var o=n(16691),r=n(61158);let i;i=Symbol.iterator;class a{constructor(e){if(this.internalState=void 0,this.internalState=new r.Z(o.dn),e)for(const t of e)this.add(t)}size(){return this.internalState.size}add(e){this.internalState.add(e)}delete(e){this.internalState.delete(e)}has(e){return this.internalState.has(e)}*[i](){for(const e of this.internalState)yield e}}},95371:(e,t,n)=>{n.d(t,{CY:()=>m,DG:()=>r,DY:()=>c,MW:()=>s,Sr:()=>d,Xf:()=>u,YL:()=>p,Yc:()=>l,Yz:()=>a,lj:()=>f,mp:()=>i,qF:()=>v,si:()=>g,ub:()=>h});n(57658);var o=n(97880);class r{constructor(e){this.children=e}map(e){const t=this.children.map((t=>t.map(e)));return new r(t)}toString(){return`DetachedTreeRoots([${this.children}])`}}class i{constructor(e,t){this.value=e,this.children=t}map(e){return s(this,(t=>({value:e(t.value),children:t.children})))}toString(){return`Tree(${this.value}, [${this.children}])`}}function a(e,t){return t(e.value)||e.children.some((e=>a(e,t)))}function s(e,t){const n=t(e);if(!n)return;const{value:r,children:a}=n,l=a?a.map((e=>s(e,t))).filter(o.$K):[];return new i(r,l)}function l(e){const{values:t,isAncestor:n,compareOrder:o}=e;if(0===t.length)return;const a=(e,t)=>{for(const o of e)if(n(o.value,t))return void a(o.children,t);e.push(new i(t,[]))},s=t.slice().sort(o),l=[];for(const r of s)a(l,r);return new r(l)}function c(e,t){for(const n of e){if(t(n))return[n];{const e=c(n.children,t);if(e)return[n,...e]}}}function d(e,t){if(t&&t.length>0){const n=t[t.length-1],o=t[t.length-2]||e,r=o.children.findIndex((e=>e===n));if(r>0)return{prev:o.children[r-1]};if(o!==e)return{parent:o}}return{}}function u(e,t){if(t&&t.length>0){const n=t[t.length-1],o=t[t.length-2]||e,r=o.children.findIndex((e=>e===n));return r<o.children.length-1?{next:o.children[r+1]}:u(e,t.slice(0,t.length-1))}return{}}function p(e,t){if(t&&t.length>0){const n=t[t.length-1],o=t[t.length-2]||e,r=o.children.findIndex((e=>e===n));if(r>0){return{prev:m(o.children[r-1])}}if(o!==e)return{parent:o}}return{}}function m(e){for(;e.children.length>0;)e=e.children[e.children.length-1];return e}function f(e,t){if(t&&t.length>0){const n=t[t.length-1];if(n.children.length>0){return{next:n.children[0]}}const{next:o}=u(e,t);return{next:o}}return{}}function g(e){if(e&&e.length>0){const t=e[e.length-1];if(t.children.length>0)return t.children[0]}}function h(e){if(e&&e.length>1)return e[e.length-2]}function v(e,t){if(0===e.length||0===t.length)return-1;for(let n=Math.min(e.length,t.length)-1;n>-1;n--){if(e[n]===t[n])return n}return-1}},39721:(e,t,n)=>{n.d(t,{F:()=>a,o:()=>s});n(21703),n(57658);var o=n(95371),r=n(73597),i=n(97880);const a={applyMutable:function(e,t){const n=(0,o.DY)(e.children,(e=>e===t.target));if(void 0===n)return!1;if(0===n.length)throw new Error("findPathInTree: empty path");const r=1===n.length?e.children:n[n.length-2].children,a=r.indexOf(t.target);if(-1===a)throw new Error("findPathInTree: cannot find node");switch(t.operation){case"indentSelf":return function(e,t){if(0===t)return!1;const n=e[t],o=e[t-1];return e.splice(t,1),o.children.push(n,...n.children),n.children=[],!0}(r,a);case"indentSelfAndSubtree":return function(e,t){if(0===t)return!1;const n=e[t],o=e[t-1];return e.splice(t,1),o.children.push(n),!0}(r,a);case"unindentSelf":{if(1===n.length)return!1;const t=2===n.length?e.children:n[n.length-3].children,o=n[n.length-2],r=t.indexOf(o);if(-1===r)throw new Error("findPathInTree: cannot find node");return function(e,t,n){const o=e[t],r=o.children[n];return o.children.splice(n,1),e.splice(t+1,0,r),!0}(t,r,a)}case"unindentSelfAndUpdateSiblings":{if(1===n.length)return!1;const t=2===n.length?e.children:n[n.length-3].children,o=n[n.length-2],r=t.indexOf(o);if(-1===r)throw new Error("findPathInTree: cannot find node");return function(e,t,n){const o=e[t],r=o.children[n],i=o.children.splice(n+1,o.children.length-n-1);return r.children.push(...i),o.children.splice(n,1),e.splice(t+1,0,r),!0}(t,r,a)}default:(0,i.t1)(t.operation)}}};const s={getIndentOperationsFromTreeRange:(e,t)=>"indent"===t?function(e){const t=[];for(const n of(0,r.bu)(e))t.push({operation:"indentSelf",target:n});return t}(e):"indentSelfAndSubtree"===t?function(e){const t=[];for(const n of(0,r.bu)(e))t.push({operation:"indentSelfAndSubtree",target:n});return t}(e):"unindent"===t?function(e){const t=[];for(const n of(0,r.bu)(e))t.push({operation:"unindentSelfAndUpdateSiblings",target:n});return t.reverse()}(e):"unindentSelf"===t?function(e){const t=[];for(const n of(0,r.bu)(e))t.push({operation:"unindentSelf",target:n});return t.reverse()}(e):void(0,i.t1)(t)}},73597:(e,t,n)=>{n.d(t,{JK:()=>r,bu:()=>a,tL:()=>i});n(21703);var o=n(97880);function*r(e){yield e;for(const t of e.children)yield*r(t)}function*i(e){for(let t=e.startPath.length-1;t>=0;t--){const n=e.getStartBoundary(t);if(!n)throw new Error("Start boundary must be defined");t===e.startPath.length-1?yield n.parent:yield*n.childrenInsideRange}}function*a(e){for(const{position:t,tree:n}of function*(e){for(let t=e.startPath.length-1;t>=0;t--){const n=e.getStartBoundary(t);if(n&&(t===e.startPath.length-1&&(yield{position:"start",tree:n.parent}),t>0))for(const e of n.childrenInsideRange)yield{position:"within",tree:e}}for(let t=0;t<e.endPath.length;t++){const n=e.getEndBoundary(t);if(n)for(const t of n.childrenInsideRange)e.isInEndPath(t)?yield{position:"endPath",tree:t}:yield{position:"within",tree:t}}}(e))switch(t){case"start":case"endPath":yield n;break;case"within":yield*r(n);break;default:(0,o.t1)(t)}}},374:(e,t,n)=>{n.d(t,{Z:()=>r,f:()=>i});var o=n(97880);function r(e){return[{operation:"delete",deleteFromParent:e.moveFromParent,deletingChildren:e.movingChildren,debug:e.debug},{operation:"insert",insertIntoParent:e.moveToParent,insertChildren:e.movingChildren,adjacentSibling:e.moveToAdjacentSibling,direction:e.moveToDirection,debug:e.debug}]}const i={applyMutable:function(e){switch(e.operation){case"delete":return a(e);case"insert":return s(e);case"move":const[t,n]=r(e),i=a(t),l=s(n);return i||l;default:(0,o.t1)(e)}}};function a(e){const{deleteFromParent:t,deletingChildren:n}=e;if(0===n.length)return!1;const o=new Set(n),r=t.children.filter((e=>!o.has(e)));return r.length!==t.children.length&&(t.children=r,!0)}function s(e){const{direction:t,insertChildren:n,insertIntoParent:r,adjacentSibling:i}=e;if(0===n.length)return!1;const a=i?r.children.indexOf(i):-1,s=(()=>{switch(t){case"listBefore":return Math.max(0,a);case"listAfter":return-1===a?r.children.length:a+1;default:(0,o.t1)(t)}})();return r.children.splice(s,0,...n),!0}},70842:(e,t,n)=>{n.d(t,{T:()=>r});n(21703),n(57658);var o=n(95371);class r{constructor(e,t,n){if(this.maxDepth=void 0,this.start=void 0,this.end=void 0,this.startPathSet=void 0,this.endPathSet=void 0,this.isInStartPath=e=>this.startPathSet.has(e),this.isInEndPath=e=>this.endPathSet.has(e),this.commonAncestor=e,this.startPath=t,this.endPath=n,0===this.startPath.length||0===this.endPath.length)throw new Error(`Cannot create TreeRange with empty path: ${this.startPath} ${this.endPath}`);this.start=this.startPath[this.startPath.length-1],this.end=this.endPath[this.endPath.length-1],this.startPathSet=new Set(t),this.endPathSet=new Set(n),this.maxDepth=Math.max(this.startPath.length,this.endPath.length)}static fromNearestCommonAncestor(e,t){const n=(0,o.qF)(e,t);if(!(n<0))return new this(e[n],e.slice(n),t.slice(n))}getStartBoundary(e){if(e>=this.startPath.length||e<0)return;const t=this.startPath[e];if(0===e&&this.startPath.length<=1&&this.endPath.length<=1)return{parentType:"commonAncestor",parent:t,childrenBeforeRange:[],childrenInsideRange:[],childrenAfterRange:t.children.slice()};const n=t.children.findIndex(this.isInStartPath)+1,o=t.children.findIndex(this.isInEndPath),r=t.children.slice(0,n),i=t.children.slice(n,-1===o?void 0:o+1),a=-1===o?[]:t.children.slice(o+1);return 0===e?{parentType:"commonAncestor",parent:t,childrenBeforeRange:r,childrenInsideRange:i,childrenAfterRange:a}:{parentType:"startPath",parent:t,childrenBeforeRange:r,childrenInsideRange:i}}getEndBoundary(e){if(e>=this.endPath.length||e<0)return;if(0===e)return this.getStartBoundary(0);const t=this.endPath[e],n=t.children.findIndex(this.isInStartPath)+1,o=t.children.findIndex(this.isInEndPath)+1,r=t.children.slice(n,o),i=t.children.slice(o);return{parentType:"endPath",parent:t,childrenInsideRange:r,childrenAfterRange:i}}getAnalagousNodesAtOffset(e){const t=this.startPath.length-1-e,n=this.endPath.length-1-e;return{start:this.getStartBoundary(t),end:this.getEndBoundary(n)}}*iterateAnalogousNodes(){for(let e=0;e<this.maxDepth;e++)yield this.getAnalagousNodesAtOffset(e)}getDeletionAtOffset(e){const{start:t,end:n}=this.getAnalagousNodesAtOffset(e),o=[];t&&t.childrenInsideRange.length>0&&o.push({operation:"delete",deleteFromParent:t.parent,deletingChildren:t.childrenInsideRange});const r=(null==t?void 0:t.parent)||this.commonAncestor;if(r&&n&&n.parent!==this.commonAncestor&&n.parent!==r&&n.childrenAfterRange.length>0){const e=r.children.find(this.isInStartPath);o.push({operation:"move",moveFromParent:n.parent,movingChildren:n.childrenAfterRange,moveToParent:r,moveToAdjacentSibling:e,moveToDirection:e?"listAfter":"listBefore"})}return o}*iterateDeletion(){for(let e=0;e<this.maxDepth;e++)yield*this.getDeletionAtOffset(e)}getInsertionAtOffset(e,t,n){const o=Math.max(0,e.length-1-t),r=e[o],i=e[o+1],{start:a,end:s}=this.getAnalagousNodesAtOffset(t),l=[];if(a&&a.childrenInsideRange.length>0){const e=n.get(r)||i;l.push({operation:"move",moveFromParent:a.parent,movingChildren:a.childrenInsideRange,moveToParent:r,moveToAdjacentSibling:e,moveToDirection:e?"listAfter":"listBefore"});const t=a.childrenInsideRange[a.childrenInsideRange.length-1];n.set(r,t)}const c=this.startPath.length-1-t,d=Math.min(c,this.endPath.length-1),u=this.getEndBoundary(d);if(u&&u.parent!==this.commonAncestor&&r!==e[0]){const e=r.children.indexOf(i)+1,t=r.children.slice(e);if(t.length){const e=0===u.childrenInsideRange.length&&u.childrenAfterRange.length>0,n=e?u.childrenAfterRange[0]:u.childrenInsideRange[u.childrenInsideRange.length-1];l.push({operation:"move",moveFromParent:r,movingChildren:t,moveToParent:u.parent,moveToAdjacentSibling:n,moveToDirection:e?"listBefore":"listAfter"})}}return s&&s.parent!==this.commonAncestor&&s.childrenAfterRange.length>0&&l.push({operation:"delete",deleteFromParent:s.parent,deletingChildren:s.childrenAfterRange}),l}*iterateInsertionAt(e){const t=new Map,n=[];for(let o=0;o<this.maxDepth;o++)n.push(...this.getInsertionAtOffset(e,o,t));yield*n}}},66504:(e,t,n)=>{n.d(t,{I:()=>a,o:()=>s});var o=n(45953),r=n(97880);let i;const a="guest";i=Symbol.iterator;class s{constructor(e){this.data=void 0,this.data=e??{}}getUserRecordMap(e){const t=e??a;let n=this.data[t];return n||(n=o.PF.create(),this.data[t]=n),n}getValue(e){return this.getUserRecordMap(e.userId).getValue(e.pointer)}getRole(e){return this.getUserRecordMap(e.userId).getRole(e.pointer)}setValueAndRole(e,t,n){return this.getUserRecordMap(e.userId).setValueAndRole(e.pointer,t,n),this}setModelAndRole(e,t,n){return this.getUserRecordMap(e.userId).setModelAndRole(e.pointer,t,n),this}delete(e){this.getUserRecordMap(e.userId).delete(e.pointer)}*[i](){for(const[e,t]of(0,r.qP)(this.data))for(const{pointer:n,model:o,role:r}of t)void 0!==o&&(yield{pointer:n,model:o,role:r,userId:e===a?void 0:e})}}},40902:(e,t,n)=>{n.d(t,{B9:()=>A,BX:()=>C,Dn:()=>x,Fb:()=>Z,KN:()=>U,OC:()=>w,OS:()=>T,Yr:()=>M,Z3:()=>E,fc:()=>B,gg:()=>D,hY:()=>O,j4:()=>R,lv:()=>F,md:()=>V,n_:()=>N,tR:()=>S});n(57658);var o=n(41432),r=n(99036),i=(n(80951),n(72126)),a=n(59753),s=n(72141),l=n(4615),c=n(70921),d=n(21202),u=n(6287),p=(n(13493),n(33709)),m=n(65311),f=n(15047),g=n(29369),h=n(19889),v=n(99108),b=n(70203),y=n(97880),_=n(63143);_.hM;function S(e,t){const n=a.kk.fromValue(c.TY,t),{edits:o,index:r}=e,s=[...n&&n.getEdits()||[],...o],m=v.VR(s),h=m[0],b=h&&h.timestamp.toString()||n&&n.start_time||o[0].timestamp,y=i.Z$(m),_=y&&y.timestamp.toString()||n&&n.end_time||b,S=k(o[0]),w=function(e){const{space_id:t,navigable_block_id:n,collection_id:o,collection_row_id:r,top_level_block_id:i,discussion_id:a,team_id:s,access_request_type:l}=e;return n?"guest_invite_request"===l?{parent_table:f.bx,parent_id:t}:{parent_table:d.iU,parent_id:n}:i?{parent_table:d.iU,parent_id:i}:r?{parent_table:d.iU,parent_id:r}:a?{parent_table:p.qF,parent_id:a}:o?{parent_table:u.v,parent_id:o}:s?{parent_table:g.e0,parent_id:s}:{parent_table:f.bx,parent_id:t}}(o[0]);return{type:c.L8[o[0].type],index:r,start_time:b.toString(),end_time:_.toString(),edits:m.slice(0,1e3),invalid:I(m),shard_id:(0,l.bm)(S.space_id),context_id:c.rH(S),...S,...w}}function w(e){if("collection-changed"===e.type&&e.collection_data){if(!e.collection_data.before&&!e.collection_data.after)return!1;if(!e.collection_data.before||!e.collection_data.after)return!0;return x(e.collection_data.before.description,e.collection_data.after.description)}if("collection-created"===e.type&&e.collection_data){const t=e.collection_data.description;return Boolean(t)}return!1}function k(e){return _.ei(e,c.uJ)}function I(e){if(0===v.hI(e).length)return!0;{const t=e[0];if("mention-deleted"===t.type)return!0;if("mention-created"===t.type){if(t.authors&&t.authors.some((e=>e.table===h.KJ&&e.id===t.mentioned_user_id)))return!0}else if(e.every((e=>"comment-deleted"===e.type)))return!0}return!1}function C(e,t){const n=function(e){const t=a.kk.fromValue(c.TY,e),n=t&&t.getEdits()||[];return _.cf(i.xH(n.map((e=>e.authors||[]))))}(a.kk.fromValue(c.TY,e));return n.some((e=>e.table===h.KJ&&e.id===t))}function x(e,t){const n=b.OAI(e||[]),o=b.OAI(t||[]);return!i.Xy(n,o)}function T(e){const{before:t,after:n,schema:o}=e,i=[];return(o?Object.keys(o):r.qF).forEach((e=>{x(t&&t.properties&&t.properties[e],n&&n.properties&&n.properties[e])&&i.push(e)})),i}function M(e){const{before:t,after:n}=e,o=[];return new Set((0,y.Yd)(t.properties||{}).concat((0,y.Yd)(n.properties||{}))).forEach((e=>{x(t&&t.properties&&t.properties[e],n&&n.properties&&n.properties[e])&&o.push(e)})),o}const P=["page_icon","is_placeholder"];function A(e){const{before:t,after:n}=e,o=[];return P.forEach((e=>{(t.format&&t.format[e])!==(n.format&&n.format[e])&&o.push(e)})),o}function R(e){const{before:t,after:n,property:o}=e;return x(t&&t.properties&&t.properties[o],n&&n.properties&&n.properties[o])}function D(e){return T(e).length>0}function E(e){return e.after.type===o.Ti.tableRow&&M(e).length>0}function B(e){return A(e).length>0}function F(e){const{before:t,after:n}=e,o=a.kk.fromBlock(t),r=a.kk.fromBlock(n),i=o.type,s=r.type,l=o.isNavigableBlock()&&r.isNavigableBlock();return i&&s&&i!==s&&!l}function O(e){const{activity:t,getRecordModel:n,baseUrl:o,pageVisitSource:r}=e;if(t.isType("top-level-block-created")||t.isType("top-level-block-deleted")){const e=n(t.getTopLevelBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:r})}else if(t.isType("commented")){const e=n(t.getDiscussionPointer());if(e){const t=n(e.getParentPointer());if(t)return t.getRenderUrl({getRecordModel:n,baseUrl:o,discussionId:e.id,pageVisitSource:r})}}else if(t.isType("collection-row-created")||t.isType("collection-row-deleted")){const e=n(t.getCollectionRowPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:r})}else if(t.isType("permissions-edited")){const e=t.getNavigableBlockPointer();if(e){const t=n(e);if(t)return t.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:r})}else{const e=n(t.getSpacePointer());if(e)return e.getRenderUrl({baseUrl:o})}}else if(t.isType("block-edited")){const e=n(t.getNavigableBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:r})}else if(t.isType("user-mentioned")){const e=n(t.getMentionedBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:r})}else if(t.isType("reminder")){const e=n(t.getReminderBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:r})}else if(t.isType("user-invited")){const e=t.getNavigableBlockPointer();if(e){const t=n(e);if(t)return t.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:r})}else{const e=n(t.getSpacePointer());if(e)return e.getRenderUrl({baseUrl:o})}}else if(t.isType("block-property-edited")){const e=n(t.getNavigableBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:r})}else if(t.isType("private-content-transferred")){const e=n(t.getNavigableBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:r})}else if(t.isType("access-request-resolved")){const e=n(t.getNavigableBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:r})}else if(t.isType("verification-expired")){const e=n(t.getNavigableBlockPointer());if(e)return e.getRenderUrl({getRecordModel:n,baseUrl:o,pageVisitSource:r})}return o||"/"}function Z(e){switch(e){case"top-level-block-created":return"activity_top_level_block_created";case"top-level-block-deleted":return"activity_top_level_block_deleted";case"collection-row-created":return"activity_collection_row_created";case"collection-row-deleted":return"activity_collection_row_deleted";case"block-edited":return"activity_block_edited";case"block-property-edited":return"activity_block_property_edited";case"permissions-edited":return"activity_permissions_edited";case"user-mentioned":return"activity_mention";case"commented":return"activity_comment";case"user-invited":return"activity_invited";case"collection-edited":return"collection_edited";case"collection-view-edited":return"collection_view_edited";case"collection-property-edited":return"collection_property_edited";case"reminder":return"activity_reminder";case"permission-group-edited":return"activity_permission_group_edited";case"page-locked":return"activity_page_locked";case"page-unlocked":return"activity_page_unlocked";case"email-edited":return"activity_email_edited";case"access-requested":return"activity_access_requested";case"access-request-resolved":return"activity_access_request_resolved";case"page-deleted":return"activity_page_deleted";case"page-restored":return"activity_page_restored";case"page-permanently-deleted":return"activity_page_permanently_deleted";case"team-membership-edited":return"activity_team_membership_edited";case"private-content-transferred":return"activity_private_content_transferred";case"permission-group-mentioned":return"activity_permission_group_mentioned";case"verification-expired":return"activity_verification_expired";case"import-completed":return"activity_import_completed";case"export-completed":return"activity_export_completed"}}function V(e){const t=[],n=[],o=[];return e.forEach((e=>{!function(e){if("permission-created"===e.type){const t=e.permission_data;if("user_permission"===t.type&&s.YX(t.role)&&e.authors&&1===e.authors.length&&e.authors[0].table===h.KJ&&e.authors[0].id===t.user_id)return!0}return!1}(e)?"permission-restriction-created"===e.type||"permission-restriction-deleted"===e.type?n.push(e):o.push(e):t.push(e)})),{autojoinEdits:t,inheritanceEdits:n,otherEdits:o}}function U(e){return"commented"===e||"following"===m.hE[e]}function N(e){return"mentions"===m.hE[e]}},19234:(e,t,n)=>{n.d(t,{A:()=>i});n(72126);const o=/^\d{5}(-\d{4})?$/,r=/^[ABCEGHJKLMNPRSTVXY]\d[ABCEGHJKLMNPRSTVWXYZ] ?\d[ABCEGHJKLMNPRSTVWXYZ]\d$/i;function i(e){if(!e.country)return!1;switch(e.country){case"US":return o.test(e.zipCode);case"CA":return r.test(e.zipCode);default:return!0}}},79946:(e,t,n)=>{n.d(t,{iI:()=>_,HR:()=>w,SY:()=>y,Q3:()=>S,rQ:()=>f,xx:()=>b,j:()=>g,VT:()=>x,dG:()=>k,k3:()=>D,PL:()=>P,L1:()=>T,Dq:()=>R,I$:()=>C,T1:()=>I,tO:()=>M,kd:()=>A});n(57658);var o=n(74686),r=n(68626),i=n(91155),a=n(54153),s=n(46637),l=n(97880),c=n(64002);let d,u,p=[],m="/";async function f(e){const{device:t,config:n,cookieService:r}=e;u=!["staging","production"].includes(n.env),await o.vO({trackingType:"targeting",cookieService:r})&&(t.isNative||t.doNotTrackEnabled||(m=function(e){if(e.isLocalhost)return"http://localhost:3000";return"https://aif.notion.so"}(n),function(e){if(!m)return;const t=document.createElement("iframe");t.setAttribute("sandbox","allow-scripts allow-same-origin"),t.setAttribute("style","position: absolute; opacity: 0; width: 1px; height: 1px; top: 0; left: 0; border: none; display: block; z-index: -1;"),t.setAttribute("aria-hidden","true"),t.setAttribute("tabindex","-1"),t.setAttribute("referrerpolicy","no-referrer"),t.setAttribute("src",e.aif.url),document.body.appendChild(t),t.addEventListener("load",(()=>{d=t;for(const e of p)v(t,e);p=[]}))}(n)))}async function g(e){const{device:t,event:n,cookieService:a}=e;if(await o.vO({trackingType:"targeting",cookieService:a}))if(t.isNative||t.doNotTrackEnabled)h(n)&&r.log({level:"info",from:"adAnalyticsHelpers",type:"analyticsTrackSignupDoNotTrackEnabled"});else try{d?v(d,n):p.push(n)}catch(s){r.log({level:"error",from:"adAnalyticsHelpers",type:"analyticsTrack",error:(0,i.Ui)(s)})}}function h(e){var t,n;return"CompleteRegistration"===(null===(t=e.facebook)||void 0===t?void 0:t.eventName)||"registration"===(null===(n=e.google)||void 0===n?void 0:n.eventName)}function v(e,t){h(t)&&r.log({level:"info",from:"adAnalyticsHelpers",type:"analyticsTrackSignupIFramePostCall"}),e.contentWindow&&e.contentWindow.postMessage(t,m)}function b(e){if("facebook"===e.type){const t=`fb.1.${Date.now()}.${e.id}`;s.Z.set("adClick",{type:"facebook",id:t})}else"google"===e.type?s.Z.set("adClick",{type:"google",id:e.id}):(0,l.t1)(e)}function y(){return s.Z.get("adClick")}function _(){s.Z.remove("adClick")}function S(){return s.Z.get("fbp")}function w(){a.Z.remove("fbp")}function k(e){const{eventType:t,source:n,eventData:o}=e;if(u)console.debug(`track GTM event:%c ${t}`,"font-weight: bold;",o);else if("front"===n){(window.dataLayer=window.dataLayer||[]).push({event:t,data:o})}else{const e={google:{eventName:"custom",data:{event:t,data:o}}};d&&d.contentWindow?d.contentWindow.postMessage(e,m):p.push(e)}}function I(){k({eventType:"sign_up_flow_start",source:"client"})}function C(){k({eventType:"sign_up_flow_complete",source:"client"})}function x(e){let{planType:t,subscriptionTier:n,domainType:o}=e;t&&"team"===t?k({eventType:"create_space",source:"client",eventData:{planType:t}}):n&&k({eventType:"create_space",source:"client",eventData:{subscriptionTier:n,domainType:o}})}function T(e){let{planType:t,subscriptionTier:n}=e;k({eventType:"professional_workspace_created",source:"client",eventData:{planType:t,subscriptionTier:n}})}function M(e){let{planType:t,subscriptionTier:n}=e;k({eventType:"team_workspace_created",source:"client",eventData:{planType:t,subscriptionTier:n}})}function P(){k({eventType:"onboarding_complete",source:"client"})}function A(e,t){k({eventType:"workspace_first_invite_sent",source:"client",eventData:{subscriptionTier:e,domainType:t}})}function R(){k({eventType:"professional_workspace_first_invite_sent",source:"client"})}async function D(e){var t;const{device:n,email:o,cookieService:r}=e,i=(0,c.DP)(null===(t=document.location)||void 0===t?void 0:t.href),a=null==i?void 0:i.get("cid"),s=null==i?void 0:i.get("metadata_cid");var l;if(s)return g({device:n,event:{metadataio:{eventName:"sign_up",data:{email:o,cid:a,mcid:s,url:null===(l=document.location)||void 0===l?void 0:l.href}}},cookieService:r})}},93214:(e,t,n)=>{n.d(t,{l$:()=>s,yN:()=>l});var o=n(64002);const r="tid",i=new Set(["visit","page_visit","landing_page_visit","login_success"]);let a;function s(e){if(i.has(e))return a}function l(e){if(a)return;const t=(0,o.Ph)(e,r);if(!t)return;a=t;const n=(0,o.iO)(e,r);window.history.replaceState(window.history.state,"",n)}},82813:(e,t,n)=>{n.d(t,{e:()=>r});var o=n(97880);function r(e,t){const{notificationId:n,activityId:r,sessionId:i,from:a,alreadyRead:s}=t,l=function(e){const{alreadyRead:t,from:n}=e;switch(n){case"mark_as_unread":return t?"unread":"no_change";case"read_on_page":case"email":case"mark_as_read":case"add_reaction":case"title":case"body":case"frame":case"archive":case"unarchive":case"open_reply_menu":case"mark_all_as_read":case"main":return t?"no_change":"read";default:return(0,o.t1)(n)}}({alreadyRead:s,from:a});if("no_change"===l)return;const c={notificationId:n,activityId:r,sessionId:i,from:a,target:l};e.trackEvent({eventName:"mark_notification_as_read",properties:c})}},5809:(e,t,n)=>{n.d(t,{$:()=>i});n(21703);var o=n(12139);const r="__webStartTime";function i(){if(!0===window.__mobileAppBackgroundLaunch)return;const e=window[r];if("number"==typeof e)return e;{const e=new Error("App Start Time not found. It should be in index.html.");o.IE(e)}}},94568:(e,t,n)=>{n.d(t,{vj:()=>o});const o="5ee0e0b5-7f0a-4788-a438-f37644514636"},37167:(e,t,n)=>{n.d(t,{t:()=>s});var o=n(15145),r=n(80310),i=n(4615),a=n(64002);function s(e){const{blockId:t,pageVisitSource:n}=e,s={};return s[r.UJ]=(0,i.cj)(t),n&&(s[o.$X]=String(n)),(0,a.bf)({url:"/chat",query:s})}},38823:(e,t,n)=>{n.d(t,{m:()=>r});var o=n(12174);class r{constructor(e){this.getEligibleGroup=void 0,this.isAiEnabledFn=void 0,this.getIsWorkspaceVectorEmbeddingsComplete=void 0,this.checkGate=void 0,this.getEligibleGroup=e.getEligibleGroup,this.isAiEnabledFn=e.isAiEnabled,this.getIsWorkspaceVectorEmbeddingsComplete=e.getIsWorkspaceVectorEmbeddingsComplete,this.checkGate=e.checkGate}isAiEnabled(){return this.isAiEnabledFn()}isQnAExplicitlyDisabled(){return this.checkGate("disable_qna_for_workspace")}isXMLAssistantEnabled(){return this.modeIsAtMost("exploratory")}isJSAssistantEnabled(){return this.modeIsAtMost("wild_west")}isAssistantInWriterEnabled(){return this.isXMLAssistantEnabled()||this.isJSAssistantEnabled()}isContextEnabled(){return this.modeIsAtMost("exploratory")}isAssistantExperienceQna(){return this.isMode("beta")||this.isMode("alpha")||this.isMode("development")}showRemindersToUseQnA(){return this.modeIsAtMost("beta")&&this.checkGate("qna_enable_reminders")}isChatHistoryEnabled(){return this.modeIsAtMost("alpha")}isBlockCitationsEnabled(){return this.modeIsAtMost("development")}isWorkspaceVectorEmbeddingsComplete(){return this.getIsWorkspaceVectorEmbeddingsComplete()}getMode(){if(!this.isAiEnabledFn())return"control";if(this.isQnAExplicitlyDisabled())return"control";const e=this.getEligibleGroup("assistant_variant");return e&&o.KM.find((t=>t===e))?e:this.getIsWorkspaceVectorEmbeddingsComplete()?"beta":"control"}isMode(e){return this.getMode()===e}modeIsAtMost(e){const t=["control",...o.KM],n=this.getMode();return t.indexOf(e)<=t.indexOf(n)}}},63362:(e,t,n)=>{function o(e,t){e.trackEvent({eventName:"automation_triggered",properties:t})}function r(e,t){e.trackEvent({eventName:"add_automation_step",properties:t})}function i(e,t){e.trackEvent({eventName:"delete_automation_step",properties:t})}function a(e,t){e.trackEvent({eventName:"click_configure_button",properties:t})}function s(e,t){e.trackEvent({eventName:"click_configure_button_done",properties:t})}function l(e,t){e.trackEvent({eventName:"click_automation_modal_option",properties:t})}function c(e,t){e.trackEvent({eventName:"automation_execution_success",properties:t})}function d(e,t){e.trackEvent({eventName:"automation_execution_fail",properties:t})}function u(e,t){e.trackEvent({eventName:"automation_create",properties:t})}function p(e,t){e.trackEvent({eventName:"automation_update",properties:t})}function m(e,t){e.trackEvent({eventName:"automation_delete",properties:t})}function f(e,t){e.trackEvent({eventName:"automation_enable",properties:t})}function g(e,t){e.trackEvent({eventName:"automation_disable",properties:t})}function h(e,t){e.trackEvent({eventName:"automation_trigger_create",properties:t})}function v(e,t){e.trackEvent({eventName:"automation_trigger_delete",properties:t})}function b(e,t){e.trackEvent({eventName:"automation_action_create",properties:t})}function y(e,t){e.trackEvent({eventName:"automation_action_delete",properties:t})}function _(e,t){e.trackEvent({eventName:"automation_configure_view",properties:t})}function S(e,t){e.trackEvent({eventName:"automation_configure_view",properties:t})}function w(e,t){e.trackEvent({eventName:"automation_learn_click",properties:t})}n.d(t,{A2:()=>b,By:()=>d,Cz:()=>c,Ey:()=>v,OK:()=>y,Rt:()=>f,T0:()=>u,W5:()=>l,ai:()=>g,co:()=>i,d:()=>S,eI:()=>r,lN:()=>s,nC:()=>_,nK:()=>h,qu:()=>w,r4:()=>p,rg:()=>o,uO:()=>m,yK:()=>a})},3865:(e,t,n)=>{n.d(t,{$M:()=>A,AQ:()=>C,Cf:()=>O,Q9:()=>y,SF:()=>S,TX:()=>F,Vd:()=>b,XO:()=>h,Ym:()=>P,_X:()=>R,bD:()=>E,cO:()=>w,g9:()=>k,gq:()=>g,n6:()=>T,nl:()=>v,rX:()=>M,vp:()=>x});n(57658);var o=n(9291),r=n(81730),i=n(23290),a=n(99036),s=n(6695),l=n(35102),c=n(76218),d=n(72126),u=n(482),p=n(149),m=n(97880);const f=(0,o.defineMessages)({slackAutomationDefaultName:{id:"automationStore.slackAutomation.defaultName",defaultMessage:"{hasCreatorName, select, true {{creatorName}'s notifications} other {Notifications}}"},automationDefaultName:{id:"automatonStore.automation.defaultName",defaultMessage:"{hasCreatorName, select, true {{creatorName}'s automation} other {Automation}}"}});function g(e,t){return e.formatMessage(f.slackAutomationDefaultName,{hasCreatorName:Boolean(t),creatorName:t})}function h(e,t){return e.formatMessage(f.automationDefaultName,{hasCreatorName:Boolean(t),creatorName:t})}function v(e){return"notification_event"===e.trigger.type}function b(e){return"event"===e.trigger.type}function y(e){return"recurrence"===e.trigger.type}(0,m.AO)((e=>(0,m.$K)(e)&&(0,m.$K)(e.target)&&(0,m.$K)(e.external_bot_id)?{true:{external_bot_id:e.external_bot_id,target:e.target}}:{false:e}));const _={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1};function S(e){return Boolean(_[e.type]&&!(0,a.NK)(e)&&(!(0,a.qQ)(e)||void 0===(0,a.q3)(e)))}function w(e){const{collectionFormat:t,collectionSchema:n,filter:o,sort:r,sourcePropertyIds:i}=e,a=(i??(0,m.Yd)(n)).filter(((e,t,r)=>{const i=n[e];return!(!i||!S(i))&&(!o||o([e,i],t,n))}));if(0===a.length)return[];if(!t||!1===r)return a;const l=(0,s.iB)(t,n,void 0,s.j5.Page).collection_page_properties||[];return d.MR(a,(e=>l.findIndex((t=>t.property===e))))}async function k(e){const{config:t,collectionPointer:n,collectionSchema:o,actionId:a,context:s,getCurrentPropertyValue:d}=e,u={};for(const f of t.properties||[]){var m;const e=null===(m=t.values)||void 0===m?void 0:m[f],g=null==o?void 0:o[f];if(!g||!S(g))continue;const h=(0,c.H0)(n,f,g);if(!h)return{error:new r.Ox({actionId:a,property:f,collectionPointer:n})};const v=await(0,c.OH)({value:(null==e?void 0:e.value)||{type:"simple",value:void 0},context:{...s,returnType:h},executeFormula:s.executeContextualFormula});if(p.x.isFail(v))return{error:new r.x6({actionId:a,cause:v.error})};const b=(0,l.bw)({result:v.value,action:(0,i.o9)(e),currentPropertyValue:null==d?void 0:d(f),propertySchema:g});u[f]=b}return{value:u}}function I(e,t){"replace"===e.type?t(e.value):"keep"===e.type||(0,m.t1)(e)}function C(e){const{pointer:t,target:n,visitor:o}=e,r=[];return I(o.visitVariableOutsideOfFormula(n.id),(e=>{(0,m.$K)(e)?r.push(u.op.update({pointer:t,path:["config","target"],args:{id:e}})):r.push(u.op.update({pointer:t,path:["config"],args:{target:null}}))})),r}function x(e){const{pointer:t,config:{properties:n,values:o},visitor:r}=e;if(!n||!o)return[];const i=[];for(const a of n){const e=o[a];null!=e&&e.value&&I(r.visitFormula(e.value),(n=>{i.push(u.op.update({pointer:t,path:["config","values"],args:{[a]:n?{...e,value:n}:null}}))}))}return i}function T(e){const{fieldName:t,pointer:n,config:o,visitor:r}=e,i=[],a=o[t];return a&&I(r.visitFormula(a),(e=>{i.push(u.op.update({pointer:n,path:["config"],args:{[t]:e??null}}))})),i}function M(e){const{formulaValueTypes:t,minimumRole:n,targetId:o}=e,r=(0,l.vx)(t,o);if(r){const e=r.type;if("array"===e.type&&"block"===e.of.type&&e.of.collection)return[{type:"record_permission",pointer:e.of.collection,minimumRole:n??"reader"}]}return[]}const P={checkbox:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,button:!1,file:!1,verification:!1,auto_increment_id:!1,created_by:!1,created_time:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,rollup:!1};function A(e){return Boolean(P[e.type])}function R(e){const{collectionFormat:t,collectionSchema:n,filter:o,sort:r}=e,i=(0,m.Yd)(n).filter(((e,t,r)=>{var i;const s=n[e];return!(!s||!P[s.type])&&((!(0,a.qQ)(s)||null===(i=(0,a.q3)(s))||void 0===i||!i.auto_update_on_edit)&&(!o||o([e,s],t,n)))}));if(0===i.length)return[];if(!t||!1===r)return i;const l=(0,s.iB)(t,n,void 0,s.j5.Page).collection_page_properties||[];return d.MR(i,(e=>l.findIndex((t=>t.property===e))))}const D={checkbox:!0,multi_select:!0,select:!0,status:!0,auto_increment_id:!1,button:!1,created_by:!1,created_time:!1,date:!1,email:!1,file:!1,formula:!1,last_edited_by:!1,last_edited_time:!1,last_visited_time:!1,location:!1,number:!1,person:!1,phone_number:!1,relation:!1,rollup:!1,text:!1,title:!1,url:!1,verification:!1};function E(e){return D[e.type]}const B={checkbox:!0,created_by:!0,created_time:!0,date:!0,email:!0,multi_select:!0,number:!0,person:!0,phone_number:!0,relation:!0,select:!0,status:!0,text:!0,title:!0,url:!0,last_edited_by:!0,last_edited_time:!0,auto_increment_id:!1,button:!1,file:!1,formula:!1,last_visited_time:!1,location:!1,rollup:!1,verification:!1};function F(e){return B[e.type]}function O(e){const{tab:t}=e;return"automationSettings"===(null==t?void 0:t.type)||"automationCreateSettings"===(null==t?void 0:t.type)||"automationEditSettings"===(null==t?void 0:t.type)}},48777:(e,t,n)=>{n.d(t,{L:()=>w,Y:()=>_});n(57658),n(21703);var o=n(9291),r=n(3865),i=n(41432),a=n(73110),s=n(35102),l=n(45681),c=n(47453),d=n(482),u=n(63306),p=n(4615),m=n(149),f=n(18844),g=n(21202),h=n(6287),v=n(97880),b=n(81730);const y=(0,o.defineMessages)({createPage:{id:"automations.actions.createPage",defaultMessage:"Add page to…"},createPageDefaultVariableName:{id:"automations.actions.createPageDefaultVariableName",defaultMessage:"New page added"},createPageVariableNameWithDatabase:{id:"automations.actions.createPageVariableNameWithDatabase",defaultMessage:"New page added in {databaseName}"},createPageVariableNameWithDatabaseAndStepNumber:{id:"automations.actions.createPageVariableNameWithDatabaseAndStepNumber",defaultMessage:"New page added in {databaseName} from step {stepNumber}"},createPageDescription:{id:"automations.actions.createPageDescription",defaultMessage:"Adds a new page to a database."}}),_={relation:!0,person:!0,multi_select:!0,title:!1,text:!1,url:!1,email:!1,phone_number:!1,checkbox:!1,created_by:!1,last_edited_by:!1,file:!1,select:!1,status:!1,number:!1,date:!1,created_time:!1,last_edited_time:!1,last_visited_time:!1,formula:!1,rollup:!1,button:!1,auto_increment_id:!1,location:!1,verification:!1},S=new Set(["button","event","recurrence"]),w={type:"create_page",display:{icon:c.R,name:y.createPage,description:y.createPageDescription,hasSideEffects:!0},isAvailableForContext:async e=>{let t=e.automation.getTriggerType();return"notification_event"===t&&(t="event"),"event"===t?await e.checkSubscribed():S.has(t)},getExecutionDependencies:(e,t)=>{const n=[],o=t.getConfig();return null!=o&&o.collection&&(n.push({type:"record_permission",pointer:o.collection,minimumRole:"content_only_editor"},{type:"collection_default_template_record_permission",pointer:o.collection,minimumRole:"none"}),null!=o&&o.template_page_id&&n.push({type:"record_permission",pointer:{id:o.template_page_id,spaceId:o.collection.spaceId,table:g.iU},minimumRole:"reader"})),n},typecheck:(e,t)=>{const n=t.getConfig();if(null==n||!n.collection)return{value:{validationFailures:[{type:"missing_required_config",actionType:"create_page",key:"collection"}]}};const o=e.getRecordModel(n.collection);if(!o)return{value:{validationFailures:[{type:"missing_required_config",actionType:"create_page",key:"collection"}]}};if(!n.collection.spaceId)return{error:new b.MO("Collection missing space ID")};if(n.template_page_id){const t=e.getRecordModel({id:n.template_page_id,table:g.iU});if(!t)return{value:{validationFailures:[{type:"invalid_optional_config",actionType:"create_page",key:"template"}]}};if(!t.isTemplate())return{value:{validationFailures:[{type:"invalid_optional_config",actionType:"create_page",key:"template"}]}};if(t.getParentId()!==n.collection.id)return{value:{validationFailures:[{type:"invalid_optional_config",actionType:"create_page",key:"template"}]}}}let r=!1,i=!1;for(const a of e.automationModel.getActionIds()){if(a===t.id)continue;const o=e.getRecordModel({id:a,spaceId:e.automationModel.getSpaceId(),table:f.Xj});var l;if("create_page"===(null==o?void 0:o.type))r=!0,(null===(l=o.getConfig())||void 0===l||null===(l=l.collection)||void 0===l?void 0:l.id)===n.collection.id&&(i=!0)}const c=(0,s.Kd)({source:"action",action_id:t.id,action_output_type:"page"}),d=e.automationModel.getActionIds().indexOf(t.id)??-1,u=o.getRenderTitle({getRecordModel:e.getRecordModel,userTimeZone:e.userTimeZone,intl:e.intl}),p=i?e.intl.formatMessage(y.createPageVariableNameWithDatabaseAndStepNumber,{databaseName:u,stepNumber:d+1}):r?e.intl.formatMessage(y.createPageVariableNameWithDatabase,{databaseName:u}):e.intl.formatMessage(y.createPageDefaultVariableName);return{value:{valueTypes:[{kind:a.yp.ContextValue,id:c,name:p,type:{type:"block",collection:n.collection}}]}}},execute:async(e,t)=>{const n=t.getConfig();if(null==n||!n.collection||!n.collection.spaceId)return{error:new b.mK({pointer:null==n?void 0:n.collection,actionId:t.id})};const o=await e.loadRecordModel(n.collection);if(!o)return{value:{values:[]}};const c=o.getSpaceShardedPointer(),u=o.getNormalizedSchema();let f,y,_;if(u){const o=await(0,r.g9)({config:n,collectionPointer:c,collectionSchema:u,actionId:t.id,context:e});if(m.x.isFail(o))return o;f=o.value}else f={};if(n.template_page_id){const t={id:n.template_page_id,spaceId:n.collection.spaceId,table:g.iU};k({getRecordModel:(await e.handleDataRequest({recordPointers:[t]})).getRecordModel,pointer:t})&&(y=n.template_page_id)}if(!(0,v.$K)(y)){const t=(await e.handleDataRequest({recordPointers:[n.collection]})).getRecordModel(n.collection),o=null==t?void 0:t.getDefaultTemplatePagePointer();if(o){k({getRecordModel:(await e.handleDataRequest({recordPointers:[o]})).getRecordModel,pointer:o})&&(y=o.id)}}const S=[];if(y){const t=await e.executeEffectMap.initializeTemplateInDatabase({templateId:y,collection:n.collection,propertyUpdates:f});if(m.x.isFail(t))return t;_=t.value.pageId}else{_=(0,p.ZP)();const t={created_time:Date.now(),last_edited_time:Date.now(),id:_,type:i.Ti.page,version:0,parent_id:n.collection.id,parent_table:h.v,alive:!0,space_id:n.collection.spaceId,properties:f,...e.author?{created_by_table:e.author.table}:{},...e.author?{created_by_id:e.author.id}:{}};S.push(d.op.set({pointer:{table:g.iU,id:t.id,spaceId:t.space_id},path:[],args:t})),e.author&&S.push(d.op.update({pointer:{table:g.iU,id:_,spaceId:c.spaceId},path:[],args:{last_edited_time:Date.now(),last_edited_by_table:e.author.table,last_edited_by_id:e.author.id}}))}const w=o.isPageTreeCollection(),I=o.getRootPagePointer();if(w&&I){const e=(0,l.A6)(I.table,g.iU);if(!e)throw new Error(`Could not find child path for parent table ${I.table} and child table ${g.iU}`);S.push({pointer:I,path:e,command:"insertChildrenAfter",args:{ids:[_]}})}if(S.length>0){const n=await e.executeEffectMap.saveTransaction({actionId:t.id,info:{type:"create_page",collection:c,pageId:_},operations:S});if(n.error)return n}const C=(0,s.Kd)({source:"action",action_id:t.id,action_output_type:"page"});return{value:{values:[{kind:a.yp.ContextValue,id:C,value:{type:"block",value:{table:g.iU,id:_,spaceId:c.spaceId}}}]}}},acceptFormulaVisitor:e=>{const{action:t,visitor:n}=e,o=t.getConfig();return o?(0,r.vp)({pointer:t.pointer,config:o,visitor:n}):[]}};function k(e){const{getRecordModel:t,pointer:n}=e,o=u.DW(n,t);return u.Zg(o)}},28751:(e,t,n)=>{n.d(t,{z:()=>de,P:()=>ue});var o=n(23290),r=n(9291),i=n(11751);const a=(0,r.defineMessages)({assistant:{id:"automations.actions.assistant",defaultMessage:"Notion AI"},assistantDescription:{id:"automations.actions.assistantDescription",defaultMessage:"Uses Notion AI to execute a task."}}),s={type:"assistant",display:{icon:i.t,name:a.assistant,description:a.assistantDescription,hasSideEffects:!0},isAvailableForContext:async e=>"wild_west"===await e.checkExperimentGroup("assistant_variant"),getExecutionDependencies:(e,t)=>[],typecheck:(e,t)=>({value:{valueTypes:[]}}),execute:(e,t)=>({value:{values:[]}}),acceptFormulaVisitor:e=>[]};n(57658);var l=n(92996),c=n(40506),d=n(73110),u=n(45953),p=n(149),m=n(98963),f=n(94438),g=n(70203),h=n(81730),v=n(41432),b=n(72126),y=n(59753),_=n(482),S=n(4615),w=n(96367),k=n(21202),I=n(6287),C=n(39927);async function x(e){const{completeSprintAction:t,completeSprintExecutionContext:n}=e,o=await async function(e){const{sprintCollectionSchema:t,sprintCollectionPointer:n}=e.sprintCollectionContext,{context:o,action:r}=e.automationContext,i=w.qB[l.p$].current.reducer.getCombinatorFilter(t);return await A((()=>o.executeEffectMap.queryCollection({actionId:r.id,collection:n,userTimeZone:o.userTimeZone,filter:i,limit:1})),e)}(n);if(p.x.isFail(o))return o;const r=o.value.blockIds[0],i=await async function(e){const{sprintCollectionSchema:t,sprintCollectionPointer:n}=e.sprintCollectionContext,{context:o,action:r}=e.automationContext,i=w.qB[l.p$].next.reducer.getCombinatorFilter(t);return await A((()=>o.executeEffectMap.queryCollection({actionId:r.id,collection:n,userTimeZone:o.userTimeZone,filter:i,limit:1})),e)}(n);if(p.x.isFail(i))return i;const a=b.Ps(i.value.blockIds),[s,c]=await Promise.all([T(n),M(n)]),d=function(e){const{incompleteTasksResult:t,completeTasksResult:n}=e;if(p.x.isFail(t)||p.x.isFail(n))return;const o=t.value.blockIds.length,r=n.value.blockIds.length,i=o+r;return{completedTaskCount:r,incompleteTaskCount:o,totalTaskCount:i,completedTaskPercent:0===i?0:r/i}}({incompleteTasksResult:s,completeTasksResult:c}),u="active"===n.automationContext.context.automationModel.getStatus()?"recurrence_automation":"button_automation";let m,f;if((0,C.$)({eventTracker:n.automationContext.context.eventTracker,properties:{action:"complete_sprint",from:u,completeSprintActionType:t,nextSprintDateRange:n.sprintCollectionContext.nextSprintDateRange,nextSprintInput:a?{type:"pointer",pointer:{id:a,table:k.iU,spaceId:n.spaceId}}:{type:"actionId"},currentSprintTaskSummary:d}}),a)f=a,m=1;else{const e=await async function(e){const{completeSprintExecutionContext:t,currentSprintPageId:n}=e,{sprintStatusNextOptionName:o,sprintStatusPropertyId:r}=t.sprintCollectionContext,{context:i,action:a}=t.automationContext,{recordMap:s,spaceId:l}=t,c={id:n,table:k.iU,spaceId:l},d=s.getModel(c);if(!d)return{error:new h.Do({actionId:a.id,pointer:c})};const u=B({intl:i.intl,userTimeZone:i.userTimeZone,getRecordModel:y.om.fromRecordMap(s),incrementSprintIdAmount:1,sourceSprintPageModel:d}),p={title:(0,g.TPx)(u),[r]:[[o]]};return await D({completeSprintExecutionContext:t,pageProperties:p})}({completeSprintExecutionContext:n,currentSprintPageId:r});if(p.x.isFail(e))return e;f=e.value.blockId,m=2}const v=await async function(e){const{sprintUniqueIdPropertyId:t,sprintStatusPropertyId:n,sprintStatusFutureOptionName:o,sprintCollectionPointer:r}=e.sprintCollectionContext,{context:i,action:a}=e.automationContext,s={operator:"and",filters:[{property:n,filter:{operator:"status_is",value:{type:"is_option",value:o}}}]};return await A((()=>i.executeEffectMap.queryCollection({actionId:a.id,collection:r,filter:s,userTimeZone:i.userTimeZone,sort:[{property:t,direction:"ascending"}],limit:1})),e)}(n);if(p.x.isFail(v))return v;let S=v.value.blockIds[0];if(!S){const e=await R({completeSprintExecutionContext:n,sprintPageWithLargestUniqueId:f,incrementFutureSprintIdAmount:1});if(m=1===m?2:3,p.x.isFail(e))return e;S=e.value.blockId}const I=await async function(e){const{sprintUniqueIdPropertyId:t,sprintCollectionPointer:n}=e.sprintCollectionContext,{context:o,action:r}=e.automationContext;return await A((()=>o.executeEffectMap.queryCollection({actionId:r.id,collection:n,userTimeZone:o.userTimeZone,sort:[{property:t,direction:"descending"}],limit:1})),e)}(n);if(p.x.isFail(I))return I;const x=I.value.blockIds[0];if(function(e){var t;const{sprintStatusPropertySchema:n}=e.sprintCollectionContext;return(null===(t=n.options)||void 0===t?void 0:t.some((e=>e.id===l.Rw)))??!1}(n)){const e=await async function(e){const{sprintCollectionSchema:t,sprintCollectionPointer:n}=e.sprintCollectionContext,{context:o,action:r}=e.automationContext,i=w.qB[l.p$].last.reducer.getCombinatorFilter(t);return await A((()=>o.executeEffectMap.queryCollection({actionId:r.id,collection:n,userTimeZone:o.userTimeZone,filter:i,limit:1})),e)}(n);if(p.x.isFail(e))return e;const t=e.value.blockIds[0],o=await async function(e){const{completeSprintExecutionContext:t,currentSprintPageId:n}=e,{sprintStatusLastOptionName:o,sprintStatusPropertyId:r,sprintCollectionPointer:i}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{spaceId:l}=t,c=[];o&&c.push(_.op.update({pointer:{id:n,table:k.iU,spaceId:l},path:["properties"],args:{[r]:[[o]]}}));return await a.executeEffectMap.saveTransaction({actionId:s.id,operations:c,info:{type:"update_pages",collection:i,editedProperties:[{id:r,type:"status"}],pageIds:[n]}})}({completeSprintExecutionContext:n,currentSprintPageId:r});if(p.x.isFail(o))return o;if(t){const e=await async function(e){const{completeSprintExecutionContext:t,lastSprintPageId:n}=e,{sprintStatusPastOptionName:o,sprintStatusPropertyId:r,sprintCollectionPointer:i}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{spaceId:l}=t,c=[_.op.update({pointer:{id:n,table:k.iU,spaceId:l},path:["properties"],args:{[r]:[[o]]}})];return await a.executeEffectMap.saveTransaction({actionId:s.id,operations:c,info:{type:"update_pages",collection:i,editedProperties:[{id:r,type:"status"}],pageIds:[n]}})}({completeSprintExecutionContext:n,lastSprintPageId:t});if(p.x.isFail(e))return e}}else{const e=await async function(e){const{completeSprintExecutionContext:t,currentSprintPageId:n}=e,{sprintStatusPastOptionName:o,sprintStatusPropertyId:r,sprintCollectionPointer:i}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{spaceId:l}=t,c=[_.op.update({pointer:{id:n,table:k.iU,spaceId:l},path:["properties"],args:{[r]:[[o]]}})];return await a.executeEffectMap.saveTransaction({actionId:s.id,operations:c,info:{type:"update_pages",collection:i,editedProperties:[{id:r,type:"status"}],pageIds:[n]}})}({completeSprintExecutionContext:n,currentSprintPageId:r});if(p.x.isFail(e))return e}const P=await async function(e){const{completeSprintExecutionContext:t,nextSprintPageId:n}=e,{sprintStatusCurrentOptionName:o,sprintStatusPropertyId:r,sprintCollectionPointer:i,nextSprintDateRange:a,sprintDatePropertyId:s}=t.sprintCollectionContext,{context:l,action:c}=t.automationContext,{spaceId:d}=t,u=[_.op.update({pointer:{id:n,table:k.iU,spaceId:d},path:["properties"],args:{[r]:[[o]],[s]:[(0,g.YCD)(["d",a])]}})];return await l.executeEffectMap.saveTransaction({actionId:c.id,operations:u,info:{type:"update_pages",collection:i,editedProperties:[{id:r,type:"status"}],pageIds:[n]}})}({completeSprintExecutionContext:n,nextSprintPageId:f});if(p.x.isFail(P))return P;const E=await async function(e){const{completeSprintExecutionContext:t,nextFutureSprintPageId:n}=e,{sprintStatusNextOptionName:o,sprintStatusPropertyId:r,sprintCollectionPointer:i}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{recordMap:l,spaceId:c}=t,d={id:n,table:k.iU,spaceId:c},u=l.getModel(d);if(!u)return{error:new h.Do({actionId:s.id,pointer:d})};l.addModel(u);const p=[_.op.update({pointer:u.pointer,path:["properties"],args:{[r]:[[o]]}})];return await a.executeEffectMap.saveTransaction({actionId:s.id,operations:p,info:{type:"update_pages",collection:i,editedProperties:[{id:r,type:"status"}],pageIds:[n]}})}({completeSprintExecutionContext:n,nextFutureSprintPageId:S});if(p.x.isFail(E))return E;const F=await R({completeSprintExecutionContext:n,sprintPageWithLargestUniqueId:x,incrementFutureSprintIdAmount:m});if(p.x.isFail(F))return F;if("complete_sprint_and_move_incomplete_tasks_to_next_sprint"===t){const e=await async function(e){const{completeSprintExecutionContext:t,incompleteTasksResult:n,nextSprintPageId:o}=e,{taskSprintRelationPropertyId:r,taskCollectionPointer:i}=t.taskCollectionContext,{context:a,action:s}=t.automationContext,{spaceId:l}=t;if(p.x.isFail(n))return n;const c=n.value.blockIds,d=c.map((e=>_.op.update({pointer:{id:e,table:k.iU,spaceId:l},path:["properties"],args:{[r]:[(0,g.YCD)((0,g.$0A)(o,l))]}})));return await a.executeEffectMap.saveTransaction({actionId:s.id,operations:d,info:{type:"update_pages",collection:i,editedProperties:[{id:r,type:"relation"}],pageIds:c}})}({completeSprintExecutionContext:n,incompleteTasksResult:s,nextSprintPageId:f});if(p.x.isFail(e))return e}else if("complete_sprint_and_move_incomplete_tasks_to_backlog"===t){const e=await async function(e,t){const{taskSprintRelationPropertyId:n,taskCollectionPointer:o}=e.taskCollectionContext,{context:r,action:i}=e.automationContext,{spaceId:a}=e;if(p.x.isFail(t))return t;const s=t.value.blockIds,l=s.map((e=>_.op.update({pointer:{id:e,table:k.iU,spaceId:a},path:["properties"],args:{[n]:void 0}})));return await r.executeEffectMap.saveTransaction({actionId:i.id,operations:l,info:{type:"update_pages",collection:o,editedProperties:[{id:n,type:"relation"}],pageIds:s}})}(n,s);if(p.x.isFail(e))return e}return{value:{}}}async function T(e){const{taskStatusCompleteGroupName:t}=e.taskCollectionContext;return await P({statusFilter:{operator:"status_is_not",value:{type:"is_group",value:t}},completeSprintExecutionContext:e})}async function M(e){const{taskStatusCompleteGroupName:t}=e.taskCollectionContext;return await P({statusFilter:{operator:"status_is",value:{type:"is_group",value:t}},completeSprintExecutionContext:e})}async function P(e){const{statusFilter:t,completeSprintExecutionContext:n}=e,{taskStatusPropertyId:o,taskSprintRelationPropertyId:r,taskCollectionPointer:i}=n.taskCollectionContext,{context:a,action:s}=n.automationContext,l={operator:"and",filters:[{property:o,filter:t},{filter:{operator:"relation_contains",value:{type:"relative",value:{type:"builtin",variable:"current"}}},property:r}]};return await A((()=>a.executeEffectMap.queryCollection({actionId:s.id,collection:i,userTimeZone:a.userTimeZone,filter:l})),n)}async function A(e,t){const{spaceId:n,recordMap:o}=t,{context:r}=t.automationContext,i=await e();if(p.x.isFail(i))return i;const a=i.value;if(a.recordMap)o.assign(a.recordMap.toRecordMap());else{const e=a.blockIds.map((e=>({id:e,table:k.iU,spaceId:n}))),t=await r.loadRecordModel(e);o.assign(t)}return{value:{blockIds:a.blockIds}}}async function R(e){const{completeSprintExecutionContext:t,sprintPageWithLargestUniqueId:n,incrementFutureSprintIdAmount:o}=e,{sprintStatusFutureOptionName:r,sprintStatusPropertyId:i}=t.sprintCollectionContext,{context:a,action:s}=t.automationContext,{recordMap:l,spaceId:c}=t,d={id:n,table:k.iU,spaceId:c},u=l.getModel(d);if(!u)return{error:new h.Do({actionId:s.id,pointer:d})};const p=B({intl:a.intl,userTimeZone:a.userTimeZone,getRecordModel:y.om.fromRecordMap(l),incrementSprintIdAmount:o,sourceSprintPageModel:u}),m={title:(0,g.TPx)(p),[i]:[[r]]};return await D({completeSprintExecutionContext:t,pageProperties:m})}async function D(e){const{completeSprintExecutionContext:t,pageProperties:n}=e,{recordMap:o,sprintCollectionContext:r,automationContext:i,spaceId:a}=t,{context:s,action:l}=i,c=r.sprintCollectionPointer,d=o.getModel(c);if(!d)return{error:new h.fH("invalid_record",`Could not find collection record: ${c.id}`)};let u;const m=d.getDefaultTemplatePagePointer();if(m){const e=await s.executeEffectMap.initializeTemplateInDatabase({templateId:m.id,collection:d.getSpaceShardedPointer(),propertyUpdates:n});if(p.x.isFail(e))return e;u=e.value.pageId;const t={id:u,table:k.iU,spaceId:a},r=await s.loadRecordModel(t);if(!r)return{error:new h.fH("invalid_record",`Could not find new sprint page: ${t.id}`)};o.addModel(r)}else{u=(0,S.ZP)();const e={created_time:Date.now(),last_edited_time:Date.now(),id:u,type:v.Ti.page,version:0,parent_id:c.id,parent_table:I.v,alive:!0,space_id:a,properties:n,...s.author?{created_by_table:s.author.table}:{},...s.author?{created_by_id:s.author.id}:{}},t=[_.op.set({pointer:{id:u,table:k.iU,spaceId:a},path:[],args:e})],r=await s.executeEffectMap.saveTransaction({actionId:l.id,operations:t,info:{type:"create_page",collection:c,pageId:u}});if(p.x.isFail(r))return r;o.setValue({id:u,table:k.iU,spaceId:a},e)}return{value:{blockId:u}}}const E=(0,r.defineMessages)({defaultSprintName:{id:"completeSprint.newSprint.defaultName",defaultMessage:"Sprint"},sprintNameWithId:{id:"completeSprint.newSprintWithId.name",defaultMessage:"Sprint {sprintId}"}});function B(e){const{intl:t,userTimeZone:n,getRecordModel:o,sourceSprintPageModel:r,incrementSprintIdAmount:i}=e,a=r.getRenderTitle({intl:t,userTimeZone:n,getRecordModel:o}),s=b.Z$(null==a?void 0:a.trim().split(" "));let l;if(s){const e=parseInt(s);isNaN(e)||(l=e+i)}return void 0!==l?t.formatMessage(E.sprintNameWithId,{sprintId:l}):t.formatMessage(E.defaultSprintName)}const F={type:"complete_sprint",isAvailableForContext:async e=>Promise.resolve("recurrence"===e.automation.getTriggerType()),getExecutionDependencies:(e,t)=>{const n=t.getConfig(),o=[];return null!=n&&n.sprint_collection&&o.push({type:"record_permission",pointer:n.sprint_collection,minimumRole:"editor"}),null!=n&&n.task_collection&&o.push({type:"record_permission",pointer:n.task_collection,minimumRole:"editor"}),o},typecheck:(e,t)=>({value:{valueTypes:[]}}),execute:async(e,t)=>{var n,r,i,a,s,v,b,y,_,S,w;const k=t.getConfig();if(!k)return{error:new h.Qq({actionId:t.id})};const I=u.Ak.create(),C=await e.loadRecordModel(k.sprint_collection);if(!C)return{error:new h.Do({actionId:t.id,pointer:k.sprint_collection})};I.addModel(C);const T=C.getNormalizedSchema(),M=null===(n=C.getFormat())||void 0===n||null===(n=n.app_uri_map)||void 0===n?void 0:n[l.b0.StatusV2];if(!M)return{error:new h.Ox({actionId:t.id,collectionPointer:k.task_collection,property:l.b0.StatusV2})};const P=null===(r=C.getFormat())||void 0===r||null===(r=r.app_uri_map)||void 0===r?void 0:r[l.b0.UniqueId];if(!P)return{error:new h.Ox({actionId:t.id,collectionPointer:k.task_collection,property:l.b0.UniqueId})};const A=null===(i=C.getFormat())||void 0===i||null===(i=i.app_uri_map)||void 0===i?void 0:i[l.b0.Dates];if(!A)return{error:new h.Ox({actionId:t.id,collectionPointer:k.task_collection,property:l.b0.Dates})};const R=T[M];if(!R||"status"!==R.type)return{error:new h.Ox({actionId:t.id,collectionPointer:k.task_collection,property:l.b0.StatusV2})};const D=null===(a=R.options)||void 0===a||null===(a=a.find((e=>e.id===l.df)))||void 0===a?void 0:a.value,E=null===(s=R.options)||void 0===s||null===(s=s.find((e=>e.id===l.Rw)))||void 0===s?void 0:s.value,B=null===(v=R.options)||void 0===v||null===(v=v.find((e=>e.id===l.SF)))||void 0===v?void 0:v.value,F=null===(b=R.options)||void 0===b||null===(b=b.find((e=>e.id===l.YE)))||void 0===b?void 0:b.value,O=null===(y=R.options)||void 0===y||null===(y=y.find((e=>e.id===l.eH)))||void 0===y?void 0:y.value;if(!(D&&B&&F&&O))return{error:new h.fH("invalid_property_schema",`Could not find required options for ${l.b0.StatusV2}.`)};const Z={id:e.automationModel.id,table:m.cv,spaceId:C.id},V=await e.loadRecordModel(Z);if(!V||!V.isType("recurrence"))return{error:new h.Do({actionId:t.id,pointer:Z})};const U=await e.loadRecordModel(k.task_collection);if(!U)return{error:new h.Do({actionId:t.id,pointer:k.task_collection})};I.addModel(U);const N=null===(_=U.getFormat())||void 0===_||null===(_=_.app_uri_map)||void 0===_?void 0:_[l.Es.Status];if(!N)return{error:new h.Ox({actionId:t.id,collectionPointer:k.task_collection,property:l.Es.Status})};const L=null===(S=U.getFormat())||void 0===S||null===(S=S.app_uri_map)||void 0===S?void 0:S[l.Es.TaskToSprintRelation];if(!L)return{error:new h.Ox({actionId:t.id,collectionPointer:k.task_collection,property:l.Es.TaskToSprintRelation})};const j=U.getNormalizedSchema(),z=j[N];if(!z||"status"!==z.type)return{error:new h.Ox({actionId:t.id,collectionPointer:k.task_collection,property:l.Es.Status})};const q=null===(w=z.groups)||void 0===w||null===(w=w.find((e=>e.id===l.uS)))||void 0===w?void 0:w.name;if(!q)return{error:new h.fH("invalid_property_schema",`Could not find required group for ${l.Es.Status}.`)};const H=function(e){let t,n;if(e.forEach((e=>{e.kind===d.yp.ContextValue&&(e.id===o.Pv&&"date"===e.value.type&&(0,c.h)(e.value.value)?t=e.value.value:e.id===o.JL&&"text"===e.value.type&&(n=(0,g.QaF)(e.value.value)))})),!(t&&n))return;return{nextSprintDateRange:t,completeSprintActionType:n}}(e.values);let W,K;if(H)W=H.completeSprintActionType,K=H.nextSprintDateRange;else{const t=V.getTrigger().recurrence,n=(0,f.Su)(t);if(!n)return{error:new h.fH("misc",`Invalid recurrence for sprint recurrence automation: ${V.id}`)};K=(0,f.IX)({userTimeZone:e.userTimeZone,sprintSchedule:n}),W=k.complete_sprint_action}const G={spaceId:C.space_id,automationContext:{action:t,context:e},sprintCollectionContext:{sprintCollectionPointer:k.sprint_collection,sprintCollectionSchema:T,nextSprintDateRange:K,sprintDatePropertyId:A,sprintStatusCurrentOptionName:B,sprintStatusFutureOptionName:O,sprintStatusNextOptionName:F,sprintStatusPastOptionName:D,sprintStatusLastOptionName:E,sprintStatusPropertyId:M,sprintStatusPropertySchema:R,sprintUniqueIdPropertyId:P},taskCollectionContext:{taskCollectionPointer:k.task_collection,taskCollectionSchema:j,taskSprintRelationPropertyId:L,taskStatusCompleteGroupName:q,taskStatusPropertyId:N,taskStatusPropertySchema:z},recordMap:I},$=await x({completeSprintAction:W,completeSprintExecutionContext:G});return p.x.isFail($)?$:{value:{values:[]}}},acceptFormulaVisitor:e=>[]};var O=n(48777),Z=n(88437),V=n(97880);const U=(0,r.defineMessages)({duplicateBlocks:{id:"automations.actions.duplicateBlocks",defaultMessage:"Insert blocks"},duplicateBlocksDescription:{id:"automations.actions.duplicateBlocksDescription",defaultMessage:"Insert text or blocks on this page."}}),N={type:"duplicate_blocks",display:{icon:Z.a,name:U.duplicateBlocks,description:U.duplicateBlocksDescription,hasSideEffects:!0},isAvailableForContext:async e=>Promise.resolve("button_block"===e.contextType),getExecutionDependencies:(e,t)=>[{type:"record_permission",pointer:e.automationModel.getParentPointer(),minimumRole:"content_only_editor"}],typecheck:()=>({value:{valueTypes:[]}}),execute:async(e,t)=>{var n;const o=b.Ps(t.getBlocks()??[]),r=(null===(n=t.getConfig())||void 0===n?void 0:n.insertion_point)??y.IN.DEFAULT_INSERTION_POINT;return(0,V.$K)(o)&&await e.executeEffectMap.duplicateBlockChildren({blockPointer:{table:k.iU,id:o,spaceId:e.automationModel.getSpaceId()},insertionPoint:r}),{value:{values:[]}}},acceptFormulaVisitor:e=>[]};var L=n(3865),j=n(35102),z=n(76218),q=n(84169);const H=(0,r.defineMessages)({modalConfirmation:{id:"automations.actions.modalConfirmation",defaultMessage:"Show confirmation"},modalConfirmationDescription:{id:"automations.actions.modalConfirmationDescription",defaultMessage:"Shows a confirmation window before proceeding."}}),W={type:"modal_confirmation",display:{icon:q.m,name:H.modalConfirmation,description:H.modalConfirmationDescription,hasSideEffects:!1},isAvailableForContext:async e=>Promise.resolve("button"===e.automation.getTriggerType()),getExecutionDependencies:(e,t)=>[],typecheck:()=>({value:{valueTypes:[]}}),execute:async(e,t)=>{var n,o,r;const i=t.getConfig();let a=[];if(null!=i&&i.text){const n=await(0,z.OH)({value:i.text,context:{...e,returnType:{type:"text"}},executeFormula:e.executeContextualFormula});if(p.x.isFail(n))return{error:new h.x6({actionId:t.id,cause:n.error})};a=(0,j.j4)(n.value)}(0,g.VrM)(a)>m.tb&&(a=(0,g.Zdj)(a,m.tb),a.push((0,g.V3y)("…")));return"cancel"===await e.executeEffectMap.displayModal({format:{icon:null===(n=e.automationModel.getProperties())||void 0===n?void 0:n.icon,text:a,continueButtonText:(null==i||null===(o=i.continue_button)||void 0===o?void 0:o.text)??"",cancelButtonText:(null==i||null===(r=i.cancel_button)||void 0===r?void 0:r.text)??""}})?{error:new h.nQ}:{value:{values:[]}}},acceptFormulaVisitor:e=>{const{action:t,visitor:n}=e,o=t.getConfig();return o?(0,L.n6)({fieldName:"text",config:o,pointer:t.pointer,visitor:n}):[]}};var K=n(9999);const G=(0,r.defineMessages)({openPage:{id:"automations.actions.openPage",defaultMessage:"Open page"},openPageDescription:{id:"automations.actions.openPageDescription",defaultMessage:"Opens a specified page."}}),$={type:"open_page",display:{icon:K.J,name:G.openPage,description:G.openPageDescription,hasSideEffects:!1},isAvailableForContext:async e=>Promise.resolve("button"===e.automation.getTriggerType()),getExecutionDependencies:(e,t)=>{var n,o;const r=t.getConfig();return"page"===(null==r||null===(n=r.target)||void 0===n?void 0:n.type)?[{type:"record_permission",pointer:null==r?void 0:r.target.page,minimumRole:"reader"}]:"variable"===(null==r||null===(o=r.target)||void 0===o?void 0:o.type)?[{id:r.target.id,minimumRole:"reader",type:"formula_value_permission"}]:[]},typecheck:(e,t)=>{const n=t.getConfig();return null!=n&&n.target?{value:{valueTypes:[]}}:{value:{validationFailures:[{type:"missing_required_config",actionType:"open_page",key:"target"}]}}},execute:(e,t)=>{const n=t.getConfig();if(null==n||!n.target)return{error:new h.mK({pointer:null==n?void 0:n.target,actionId:t.id})};let o;if("page"===n.target.type)o=n.target.page;else if("variable"===n.target.type){const r=(0,j.dh)(e.values,n.target.id);if(!r)return{error:new h.Hb({actionId:t.id,source:"action",variable:r})};if("block"===r.value.type)o=r.value.value;else{if("array"!==r.value.type)return{error:new h.Hb({actionId:t.id,source:"action",variable:r.value})};{const e=r.value.values[0];if(!e||"block"!==e.type)return{error:new h.Hb({actionId:t.id,source:"action",variable:r.value})};o=e.value}}}else(0,V.t1)(n.target);return e.executeEffectMap.navigateToPage({actionId:t.id,page:o,openIn:t.getOpenPageIn()}),{value:{values:[]}}},acceptFormulaVisitor:e=>{var t;const{action:n,visitor:o}=e,r=n.getConfig();if(!r)return[];const i=[];return"variable"===(null==r||null===(t=r.target)||void 0===t?void 0:t.type)&&i.push(...(0,L.AQ)({pointer:n.pointer,target:r.target,visitor:o})),i}};var Q=n(49019);const Y=(0,r.defineMessages)({queryCollection:{id:"automations.actions.queryCollection",defaultMessage:"Get pages"},queryCollectionDescription:{id:"automations.actions.queryCollectionDescription",defaultMessage:"Get a list of pages from a database with optional filters and sorts, to be used in a subsequent automation step."},queryCollectionPages:{id:"automations.actions.queryCollectionPages",defaultMessage:"Pages from step {stepNumber}"}}),X={type:"query_collection",display:{icon:Q.e,name:Y.queryCollection,description:Y.queryCollectionDescription,hasSideEffects:!1},isAvailableForContext:async()=>Promise.resolve(!1),getExecutionDependencies:(e,t)=>{const n=t.getConfig();return null!=n&&n.collection?[{type:"record_permission",pointer:null==n?void 0:n.collection,minimumRole:"reader"}]:[]},typecheck:(e,t)=>{const n=t.getConfig();if(null==n||!n.collection)return{value:{valueTypes:[]}};const o=(0,j.Kd)({source:"action",action_id:t.id,action_output_type:"pages"}),r=e.automationModel.getActionIds().indexOf(t.id)??-1;return{value:{valueTypes:[{kind:d.yp.ContextValue,id:o,name:e.intl.formatMessage(Y.queryCollectionPages,{stepNumber:r+1}),type:{type:"array",of:{type:"block",collection:n.collection}}}]}}},execute:async(e,t)=>{const n=t.getConfig();if(null==n||!n.collection)return{value:{values:[]}};if(null==n||!n.collection.spaceId)return{error:new h.mK({pointer:null==n?void 0:n.collection,actionId:t.id})};const o={table:I.v,id:null==n?void 0:n.collection.id,spaceId:null==n?void 0:n.collection.spaceId},r=await e.executeEffectMap.queryCollection({actionId:t.id,collection:o,userTimeZone:e.userTimeZone,filter:null==n?void 0:n.filter,sort:null==n?void 0:n.sort,limit:null==n?void 0:n.limit});if(r.error)return r;const i=(0,j.Kd)({source:"action",action_id:t.id,action_output_type:"pages"});return{value:{values:[{kind:d.yp.ContextValue,id:i,value:{type:"array",values:r.value.blockIds.map((e=>({type:"block",value:{table:k.iU,id:e,spaceId:o.spaceId}})))}}]}}},acceptFormulaVisitor:e=>[]};var J=n(24600),ee=n(77420);const te=(0,r.defineMessages)({slackNotification:{defaultMessage:"Send Slack notification to…",id:"automations.actions.slackNotification"},slackNotificationDescription:{defaultMessage:"Sends a Slack notification to a user or channel.",id:"automations.actions.slackNotificationDescription"}}),ne={type:"slack_notification",display:{icon:J.P,name:te.slackNotification,description:te.slackNotificationDescription,hasSideEffects:!1},isAvailableForContext:async e=>{const t=e.automationActions.filter((e=>e.isType("slack_notification"))),n="canAddAction"===e.checkType?t.length<1:t.length<=1;return Promise.resolve("event"===e.contextType&&n)},getExecutionDependencies:(e,t)=>{const n=t.getConfig();return null!=n&&n.external_bot_id?[{minimumRole:"editor",pointer:{id:n.external_bot_id,table:ee.cZ},type:"record_permission"}]:[]},typecheck:(e,t)=>{const n=t.getConfig();if(null==n||!n.external_bot_id)return{value:{validationFailures:[{type:"missing_required_config",actionType:"slack_notification",key:"external_bot_id"}]}};return e.getRecordModel({id:n.external_bot_id,table:ee.cZ})?n.target?{value:{valueTypes:[]}}:{value:{validationFailures:[{type:"missing_required_config",actionType:"slack_notification",key:"target"}]}}:{value:{validationFailures:[{type:"missing_required_value",actionType:"slack_notification",key:"external_bot_id"}]}}},execute:(e,t)=>({value:{values:[]}}),acceptFormulaVisitor:e=>[]};var oe=n(38297),re=n(25651);const ie=(0,r.defineMessages)({updatePages:{id:"automations.actions.updatePages",defaultMessage:"Edit pages in…"},updatePagesDescription:{id:"automations.actions.updatePagesDescription",defaultMessage:"Edits the properties of specified pages in a database."}}),ae=new Set(["button","event"]);async function se(e){const{pointer:t,context:n,actionId:o}=e,r=await n.loadRecordModel(t);if(!r)return{error:new h.Do({pointer:t,actionId:o})};const i=await(0,oe.Rd)({block:r,loadRecordModel:n.loadRecordModel});return i?{value:i.getSpaceShardedPointer()}:{error:new h.Do({pointer:t,actionId:o})}}const le={type:"update_pages",display:{icon:re.R,name:ie.updatePages,description:ie.updatePagesDescription,hasSideEffects:!0},isAvailableForContext:async e=>{let t=e.automation.getTriggerType();if("notification_event"===t&&(t="event"),"event"===t){if(!(await e.checkSubscribed()))return!1;const t=e.automationActions.filter((e=>{var t;return e.isType("update_pages")&&"collection"===(null===(t=e.getConfig())||void 0===t||null===(t=t.target)||void 0===t?void 0:t.type)}));return"canAddAction"===e.checkType?t.length<5:t.length<=5}return ae.has(t)},getExecutionDependencies:(e,t)=>{var n,o;const r=t.getConfig();return"collection"===(null==r||null===(n=r.target)||void 0===n?void 0:n.type)?[{type:"record_permission",pointer:null==r?void 0:r.target.collection,minimumRole:"content_only_editor"}]:"variable"===(null==r||null===(o=r.target)||void 0===o?void 0:o.type)?[{id:r.target.id,minimumRole:"read_and_write",type:"formula_value_permission"}]:[]},typecheck:(e,t)=>{const n=t.getConfig();return null!=n&&n.target?{value:{valueTypes:[]}}:{value:{validationFailures:[{type:"missing_required_config",actionType:"update_pages",key:"target"}]}}},execute:async(e,t)=>{const n=t.getConfig();if(null==n||!n.target)return{error:new h.mK({pointer:null==n?void 0:n.target,actionId:t.id})};let o,r,i,a=e.loadRecordModel;if("collection"===(null==n?void 0:n.target.type)){const s=await a(n.target.collection);if(!s)return{error:new h.Do({pointer:n.target.collection,actionId:t.id})};const l=await e.executeEffectMap.queryCollection({actionId:t.id,collection:n.target.collection,userTimeZone:e.userTimeZone,filter:n.target.filter,limit:n.target.limit,sort:n.target.sort});if(p.x.isFail(l))return l;i=l.value.blockIds,o=s.getNormalizedSchema(),r=n.target.collection,l.value.recordMap&&(a=y.s8.tryUntilFound(a,y.s8.fromRecordMapWithRole(l.value.recordMap)))}else if("variable"===n.target.type){const s=(0,j.dh)(e.values,n.target.id);if(!s)return{error:new h.L({actionId:t.id,contextValueId:n.target.id})};if("block"===s.value.type){let n=await se({pointer:s.value.value,context:e,actionId:t.id});if(p.x.isFail(n)){const t=function(e){var t;const{actionModels:n,contextValue:o}=e,r=(0,j.MY)(o.id);if("action"!==r.source)return{error:new h.Hb({source:"global",variable:o.value})};const i=n.find((e=>e.id===r.action_id));if(!i||"create_page"!==i.getType())return{error:new h.Hb({actionId:r.action_id,source:"action",variable:o.value})};const a=null===(t=i.getConfig())||void 0===t?void 0:t.collection;return a?{value:a}:{error:new h.Hb({actionId:r.action_id,source:"action",variable:o.value})}}({actionModels:e.actionModels,contextValue:s});if(p.x.isFail(t))return n;n=t}i=[s.value.value.id],r=n.value;const a=await e.executeEffectMap.getCollectionSchema({actionId:t.id,pointer:r});if(p.x.isFail(a))return a;o=a.value.collectionSchema}else{if("array"!==s.value.type)return{error:new h.Hb({actionId:t.id,source:"action",variable:s.value})};{const n=s.value.values[0];if(!n||"block"!==n.type)return{error:new h.Hb({actionId:t.id,source:"action",variable:n})};const l=await a(n.value),c=l?await(0,oe.Rd)({block:l,loadRecordModel:a}):void 0;if(!c)return{error:new h.Do({pointer:n.value,actionId:t.id})};const d=c.getSpaceShardedPointer();i=b.oA(s.value.values.map((e=>"block"===e.type?e.value.id:void 0)));const u=await e.executeEffectMap.getCollectionSchema({actionId:t.id,pointer:d});if(p.x.isFail(u))return u;o=u.value.collectionSchema,r=d}}}else if("page"===n.target.type){const a=n.target.page,s=await se({pointer:a,context:e,actionId:t.id});if(p.x.isFail(s))return s;i=[a.id],r=s.value;const l=await e.executeEffectMap.getCollectionSchema({actionId:t.id,pointer:r});if(p.x.isFail(l))return l;o=l.value.collectionSchema}else(0,V.t1)(n.target);const s=[];for(const l of i){const i=await a({table:k.iU,id:l,spaceId:r.spaceId});let c;if(o){const a=null==i?void 0:i.getProperties(),s=await(0,L.g9)({config:n,collectionPointer:r,collectionSchema:o,actionId:t.id,context:e,getCurrentPropertyValue:e=>null==a?void 0:a[e]});if(p.x.isFail(s))return s;c=s.value}else c={};s.push({pointer:{table:k.iU,id:l,spaceId:r.spaceId},command:"update",path:["properties"],args:c}),e.author&&s.push(_.op.update({pointer:{table:k.iU,id:l,spaceId:r.spaceId},path:[],args:{last_edited_time:Date.now(),last_edited_by_table:e.author.table,last_edited_by_id:e.author.id}}))}if(s.length>0){const a=(n.properties??[]).map((e=>{var t;const n=null===(t=o)||void 0===t?void 0:t[e];if(n)return{id:e,type:n.type}})).filter(V.$K),l=await e.executeEffectMap.saveTransaction({actionId:t.id,info:{type:"update_pages",pageIds:i,collection:r,editedProperties:a},operations:s});if(p.x.isFail(l))return l}return{value:{values:[]}}},acceptFormulaVisitor:e=>{var t;const{action:n,visitor:o}=e,r=n.getConfig();if(!r)return[];const i=[];if("variable"===(null==r||null===(t=r.target)||void 0===t?void 0:t.type)){const e=(0,L.AQ)({pointer:n.pointer,target:r.target,visitor:o});i.push(...e)}return i.push(...(0,L.vp)({pointer:n.pointer,config:r,visitor:o})),i}},ce={query_collection:X,create_page:O.L,update_pages:le,open_page:$,slack_notification:ne,duplicate_blocks:N,modal_confirmation:W,complete_sprint:F,assistant:s};function de(e){return ce[e]}function ue(e){return(0,o.FP)(e).map((e=>de(e)))}},81730:(e,t,n)=>{n.d(t,{Do:()=>a,Hb:()=>s,L:()=>p,MO:()=>o,Ox:()=>c,Pn:()=>l,Qq:()=>f,fH:()=>r,iR:()=>d,mK:()=>i,nQ:()=>m,x6:()=>u});n(21703);class o extends Error{}class r extends Error{constructor(e,t){super(t),this.type=e}}class i extends r{constructor(e){super("invalid_record_pointer","Invalid record pointer"),this.data=e}}class a extends r{constructor(e){super("invalid_record","Invalid record"),this.data=e}}class s extends r{constructor(e){super("invalid_variable_type","Invalid variable type"),this.data=e}}class l extends r{constructor(e){super(e.type,e.message),this.data=e}}class c extends r{constructor(e){super("invalid_property_schema","Invalid property schema"),this.data=e}}class d extends r{constructor(e){super("unsupported_context","Unsupported context"),this.data=e}}class u extends r{constructor(e){super("formula_execution_failed","Formula execution failed"),this.data=e}}class p extends r{constructor(e){super("missing_context_value","Missing context value"),this.data=e}}class m extends r{constructor(){super("user_cancelled","User cancelled")}}class f extends r{constructor(e){super("missing_action_config","Missing automation action config"),this.data=e}}Error},94412:(e,t,n)=>{n.d(t,{X:()=>i,e:()=>a});var o=n(59753),r=n(18844);class i{constructor(e){this.triggerType=void 0,this.actions=void 0,this.spaceId=void 0,this.parentPointer=void 0,this.triggerType=e.triggerType,this.actions=e.actions,this.spaceId=e.spaceId,this.parentPointer=e.parentPointer}get id(){return"structured-automation-id"}getSpaceId(){return this.spaceId}getActionIds(){return this.actions.map((e=>e.id))}getProperties(){}getTriggerType(){return this.triggerType}getParentPointer(){return this.parentPointer}}class a{constructor(e,t){this.underlying=e,this.spaceId=t}get id(){return this.underlying.id}get pointer(){return{id:this.underlying.id,table:r.Xj,spaceId:this.spaceId}}getType(){return this.underlying.type}getConfig(){return this.underlying.config}getBlocks(){return this.underlying.blocks??[]}getOpenPageIn(){var e;return(null===(e=this.underlying.config)||void 0===e?void 0:e.open_in)??o.th.DEFAULT_PEEK_MODE_FORMAT}}},61202:(e,t,n)=>{n.d(t,{Ps:()=>s,TD:()=>l});n(57658);var o=n(3865),r=n(77492),i=n(72126),a=n(97880);function*s(e){const{permissions:t,typecheckContextValues:n}=e,s=[];for(const l of t)if("record_permission"===l.type)s.push((0,i.Xh)(l));else if("collection_default_template_record_permission"===l.type){const e=yield*r.R.fetchRecord(l.pointer),t=null==e?void 0:e.getDefaultTemplatePagePointer();(0,a.$K)(t)&&s.push({minimumRole:l.minimumRole,pointer:t,type:"record_permission"})}else if("formula_value_permission"===l.type){const e=(0,o.rX)({formulaValueTypes:n,minimumRole:l.minimumRole,targetId:l.id});e.length>0&&s.push(...e)}else(0,a.t1)(l);return s}const{sync:l,async:c}=r.R.makeRunners(s)},10450:(e,t,n)=>{n.d(t,{E$:()=>S,J0:()=>p,NG:()=>C,R4:()=>w,W7:()=>I,ZF:()=>k,Zy:()=>x,dG:()=>b,io:()=>_,rb:()=>y,rj:()=>T,zW:()=>v});var o=n(9291),r=n(53877),i=n(73110),a=n(35102),s=n(72126),l=n(19889),c=n(70203),d=n(23290);const u=(0,o.defineMessages)({buttonPage:{id:"automations.triggers.button.page.label",defaultMessage:"This page"},currentUser:{id:"automations.triggers.currentUser.label",defaultMessage:"Person who clicked button"},now:{id:"automations.triggers.now.label",defaultMessage:"Now"},today:{id:"automations.triggers.today.label",defaultMessage:"Today"}});function p(){return(0,a.Kd)({source:"global",global:"button_page"})}function m(){return(0,a.Kd)({source:"global",global:"current_user"})}function f(){return(0,a.Kd)({source:"global",global:"now"})}function g(){return(0,a.Kd)({source:"global",global:"today"})}function h(e){const{blockPointer:t,currentUserId:n}=e,o=p(),a=m(),c=f(),d=g();return{values:s.oA([{kind:i.yp.ContextValue,id:o,value:{type:"block",value:t}},n?{kind:i.yp.ContextValue,id:a,value:{type:"person",value:{table:l.KJ,id:n}}}:void 0,{kind:i.yp.ContextValue,id:c,value:{type:"date",value:(0,r.CQ)(Date.now(),e.userTimeZone)}},{kind:i.yp.ContextValue,id:d,value:{type:"date",value:(0,r.hT)(Date.now(),e.userTimeZone)}}])}}function v(e){const{collectionPointer:t}=e,n=p(),o=m(),r=f(),a=g();return{valueTypes:[{kind:i.yp.ContextValue,id:n,name:e.intl.formatMessage(u.buttonPage),type:{type:"block",collection:t}},{kind:i.yp.ContextValue,id:o,name:e.intl.formatMessage(u.currentUser),type:{type:"person"}},{kind:i.yp.ContextValue,id:r,name:e.intl.formatMessage(u.now),type:{type:"date"}},{kind:i.yp.ContextValue,id:a,name:e.intl.formatMessage(u.today),type:{type:"date"}}]}}function b(e){return h(e)}function y(e){const t=m(),n=f(),o=g(),r=p(),a={kind:i.yp.ContextValue,id:t,name:e.intl.formatMessage(u.currentUser),type:{type:"person"}},l={kind:i.yp.ContextValue,id:n,name:e.intl.formatMessage(u.now),type:{type:"date"}},c={kind:i.yp.ContextValue,id:o,name:e.intl.formatMessage(u.today),type:{type:"date"}},d=e.collectionPointer?{kind:i.yp.ContextValue,id:r,name:e.intl.formatMessage(u.buttonPage),type:{type:"block",collection:e.collectionPointer}}:void 0;return{valueTypes:s.oA([a,l,c,d])}}function _(e){const{currentUserId:t,pagePointer:n}=e,o=m(),a=f(),c=g(),d=p();return{values:s.oA([t?{kind:i.yp.ContextValue,id:o,value:{type:"person",value:{table:l.KJ,id:t}}}:void 0,{kind:i.yp.ContextValue,id:a,value:{type:"date",value:(0,r.CQ)(Date.now(),e.userTimeZone)}},{kind:i.yp.ContextValue,id:c,value:{type:"date",value:(0,r.hT)(Date.now(),e.userTimeZone)}},{kind:i.yp.ContextValue,id:d,value:{type:"block",value:n}}])}}function S(e){const t=f(),n=g(),o=p(),r={kind:i.yp.ContextValue,id:o,name:e.intl.formatMessage(u.buttonPage),type:{type:"block",collection:e.collectionPointer}};return{valueTypes:[{kind:i.yp.ContextValue,id:t,name:e.intl.formatMessage(u.now),type:{type:"date"}},{kind:i.yp.ContextValue,id:n,name:e.intl.formatMessage(u.today),type:{type:"date"}},r]}}function w(e){return h(e)}function k(){return{valueTypes:[]}}function I(){return{values:[]}}function C(e){const{nextSprintDateRange:t,completeSprintActionType:n}=e;return{values:[{kind:i.yp.ContextValue,id:d.Pv,value:{type:"date",value:t}},{kind:i.yp.ContextValue,id:d.JL,value:{type:"text",value:(0,c.TPx)(n)}}]}}function x(){return{valueTypes:[]}}function T(){return{values:[]}}},86433:(e,t,n)=>{n.d(t,{rS:()=>p});n(57658);var o=n(77492),r=n(35102),i=n(42875),a=n(72126),s=n(149),l=n(97880),c=n(28751),d=n(61202),u=n(10450);const{sync:p,async:m}=o.R.makeRunners((function*(e){let t=[];return"button_property"===e.contextType?t=(0,u.zW)({collectionPointer:e.collectionPointer,intl:e.intl}).valueTypes??[]:"button_block"===e.contextType?t=(0,u.rb)({collectionPointer:e.collectionPointer,intl:e.intl}).valueTypes??[]:"structured_automation"===e.contextType?t=(0,u.Zy)().valueTypes??[]:"event"===e.contextType?t=(0,u.E$)({collectionPointer:e.collectionPointer,intl:e.intl}).valueTypes??[]:"recurrence"===e.contextType?t=(0,u.ZF)().valueTypes??[]:"assistant"===e.contextType?t=[]:(0,l.t1)(e),yield*f({automationModel:e.automationModel,actionModels:e.actionModels,handleDataRequest:(0,r.yf)(e.getRecordModel,e.loadRecordModel),intl:e.intl,getRecordModel:e.getRecordModel,userTimeZone:e.userTimeZone||(0,i.r)(),valueTypes:t})}));function*f(e){const{actionModels:t,automationModel:n}=e,i={valueTypes:e.valueTypes,actionInputValueTypes:{},actionValidationFailures:{}};for(const l of t){const t=(0,c.z)(l.getType()),u=t.getExecutionDependencies({automationModel:n},l),p=yield*(0,d.Ps)({permissions:u,typecheckContextValues:i.valueTypes});yield*o.R.fetchRecords(p.map((e=>e.pointer)));const m=t.typecheck(e,l),f=a.d9(i.valueTypes);if(i.actionInputValueTypes[l.id]=f,s.x.isFail(m))return m;for(const e of m.value.valueTypes??[]){i.valueTypes.some((t=>(0,r.Fl)(e,t)))||i.valueTypes.push(e)}m.value.validationFailures&&(i.actionValidationFailures[l.id]=m.value.validationFailures)}return{value:i}}const{sync:g,async:h}=o.R.makeRunners(f)},23290:(e,t,n)=>{n.d(t,{E2:()=>c,FP:()=>s,Gl:()=>f,JL:()=>i,Pv:()=>r,Xp:()=>g,lK:()=>l,o9:()=>u,ss:()=>m,xZ:()=>p});var o=n(35102);const r=(0,o.Qc)("COMPLETE_SPRINT_NEXT_SPRINT_DATE_RANGE"),i=(0,o.Qc)("COMPLETE_SPRINT_ACTION_TYPE"),a={duplicate_blocks:{display:!0},create_page:{display:!0},modal_confirmation:{display:!0},open_page:{display:!0},query_collection:{display:!0},slack_notification:{display:!0},update_pages:{display:!0},assistant:{display:!0},complete_sprint:{display:!1}};function s(e){return Object.entries(a).filter((t=>{let[n,o]=t;return o[e]})).map((e=>{let[t]=e;return t}))}function l(e,t){return a[e][t]}const c=["replace","append","remove","toggle"],d="replace";function u(e){return(null==e?void 0:e.action)||d}const p=100,m=50,f={recurrence:{min:1,max:1},notification_event:{min:1,max:1},button:{min:0,max:"default_bound"},event:{min:1,max:"default_bound"},chat:{min:0,max:"default_bound"}};function g(e){return l(e.type,"display")}},36576:(e,t,n)=>{n.d(t,{sU:()=>I,xU:()=>y});n(57658);var o=n(41432),r=n(99036),i=n(14215),a=n(38297),s=n(72126),l=n(59753),c=n(63306),d=n(87479),u=n(606),p=n(21202),m=n(70279),f=n(33709),g=n(23867),h=n(62965),v=n(70203),b=n(97880);async function y(e){const{loadRecordValue:t,operationPointers:n,getInitialRecordModel:o,getFinalRecordModel:r}=e,a=[],c=[];return await Promise.all(n.map((async e=>{if((0,u.$O)(e,p.iU)){const n=o.getRecordValue(e),d=r.getRecordValue(e),u=null==d?void 0:d.space_id,m={...e,spaceId:(0,g.C)(u)},f=(0,i.E)(_(n),_(d));if(await Promise.all([...f.deleted.map((async n=>{const i=await async function(e){const t=e.getInitialRecordModel.getRecordValue({table:p.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0;const n=e.getFinalRecordModel.getRecordValue({table:p.iU,id:e.blockId});if(n&&n.parent_id!==e.parentId)return!0;if(!n){const t=await e.loadRecordValue({table:p.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0}return!1}({loadRecordValue:t,blockId:n,parentId:e.id,getInitialRecordModel:o,getFinalRecordModel:r});i&&c.push({block_id:n,mentioned_from:{type:"reference",parent_block_id:e.id,parent_pointer:m}})})),...f.created.map((async n=>{const o=await async function(e){const t=e.getFinalRecordModel.getRecordValue({table:p.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0;if(!t){const t=await e.loadRecordValue({table:p.iU,id:e.blockId});if(t&&t.parent_id!==e.parentId)return!0}return!1}({loadRecordValue:t,blockId:n,parentId:e.id,getFinalRecordModel:r});o&&a.push({block_id:n,mentioned_from:{type:"reference",parent_block_id:e.id,parent_pointer:m}})}))]),n&&d&&n.parent_id!==d.parent_id){if(n.parent_table===p.iU){let o=r.getRecordValue({table:p.iU,id:n.parent_id,spaceId:n.space_id});o||(o=await t({table:p.iU,id:n.parent_id,spaceId:n.space_id})),o&&o.content&&o.content.includes(e.id)&&a.push({block_id:e.id,mentioned_from:{type:"reference",parent_block_id:(0,b.xL)(n.parent_id),parent_pointer:m}})}if(d.parent_table===p.iU){let n=r.getRecordValue({table:p.iU,id:d.parent_id,spaceId:d.space_id});n||(n=await t({table:p.iU,id:d.parent_id})),n&&n.content&&!n.content.includes(e.id)&&a.push({block_id:e.id,mentioned_from:{type:"reference",parent_block_id:(0,b.xL)(d.parent_id),parent_pointer:{id:d.parent_id,table:p.iU,spaceId:d.space_id}}})}}let h;if(n&&(h=l.kk.fromBlock(n).getCollectionPointer()),(!n||!h)&&d){const e=l.kk.fromBlock(d).getCollectionPointer();if(e){let n=r.getRecordValue(e);n||(n=await t(e)),n&&n.parent_id!==d.id&&a.push({block_id:(0,b.xL)(n.parent_id),mentioned_from:{type:"collection_reference",block_id:d.id,pointer:{id:d.id,spaceId:d.space_id,table:p.iU}}})}}const v=(0,i.N)(w(n),w(d),S);for(const{blockId:t,propertyId:o}of v.created)a.push({block_id:t,mentioned_from:{type:"property_mention",block_id:e.id,property_id:o,pointer:m}});for(const{blockId:t,propertyId:o}of v.deleted)c.push({block_id:t,mentioned_from:{type:"property_mention",block_id:e.id,property_id:o,pointer:m}});const y=C(n),k=C(d);y&&!s.Xy(y,k)&&c.push({block_id:y.id,mentioned_from:{type:"alias",pointer:m}}),k&&!s.Xy(y,k)&&a.push({block_id:k.id,mentioned_from:{type:"alias",pointer:m}});const I=x(n),T=x(d);I&&!s.Xy(I,T)&&c.push({block_id:I.id,mentioned_from:{type:"transclusion_reference",pointer:m}}),T&&!s.Xy(I,T)&&a.push({block_id:T.id,mentioned_from:{type:"transclusion_reference",pointer:m}})}else if((0,u.$O)(e,m.x_)){const t=o.getRecordValue(e),n=r.getRecordValue(e),s=null==n?void 0:n.space_id,l={...e,spaceId:(0,g.C)(s)},d=(0,i.E)(k(t),k(n));for(const o of d.created)a.push({block_id:o,mentioned_from:{type:"comment_mention",comment_id:e.id,pointer:l}});for(const o of d.deleted)c.push({block_id:o,mentioned_from:{type:"comment_mention",comment_id:e.id,pointer:l}})}}))),{createdBacklinks:a,deletedBacklinks:c}}function _(e){const t=l.kk.fromValue(p.iU,e);return t?t.getContentIds():[]}function S(e){return`${e.blockId}${e.propertyId}`}function w(e){const t=l.kk.fromValue(p.iU,e),n=[];if(!t)return n;const o=t.getProperties();if(!o)return n;for(const r in o){const e=v.jDe(t.getProperty(r));for(const t of e)n.push({propertyId:r,blockId:t})}return n}function k(e){const t=l.kk.fromValue(m.x_,e);return t&&t.alive?v.jDe(t.getText()):[]}function I(e){window.__c={n:"filterBacklinksToHide"};const{actor:t,blockId:n,backlinks:i,getRecordModel:u}=e,v=(0,c.DW)({table:p.iU,id:n},u),y=s.Z$(v),_=v[0];if(!y||"block"!==_.table)return[];const S=(0,d.IJ)({actor:t,ancestors:v});return i.filter((e=>{const n=function(e){var t,n,o,r;return"comment_mention"===e.mentioned_from.type?{table:m.x_,id:e.mentioned_from.comment_id,spaceId:(0,g.C)(null===(t=e.mentioned_from.pointer)||void 0===t?void 0:t.spaceId)}:"reference"===e.mentioned_from.type?{table:p.iU,id:e.mentioned_from.parent_block_id,spaceId:(0,g.C)(null===(n=e.mentioned_from.parent_pointer)||void 0===n?void 0:n.spaceId)}:"property_mention"===e.mentioned_from.type?{table:p.iU,id:e.mentioned_from.block_id,spaceId:(0,g.C)(null===(o=e.mentioned_from.pointer)||void 0===o?void 0:o.spaceId)}:"collection_reference"===e.mentioned_from.type?{table:p.iU,id:e.mentioned_from.block_id,spaceId:(0,g.C)(null===(r=e.mentioned_from.pointer)||void 0===r?void 0:r.spaceId)}:"alias"===e.mentioned_from.type||"transclusion_reference"===e.mentioned_from.type?e.mentioned_from.pointer:void(0,b.t1)(e.mentioned_from)}(e),i=(0,c.DW)(n,u);if(!(0,c.Zg)(i))return!1;const s=(0,d.IJ)({actor:t,ancestors:i});if(s){if(!S)return!1;if(!(0,h.Z)(s.from,S.from))return!1}if(i.some((e=>e.table===f.qF&&e.resolved)))return!1;if("property_mention"===e.mentioned_from.type){var v;const t=u({table:p.iU,id:e.mentioned_from.block_id,spaceId:(0,g.C)(null===(v=e.mentioned_from.pointer)||void 0===v?void 0:v.spaceId)});if(!t)return!1;const n=(0,a.ky)({block:t,getRecordModel:u});if(n){const t=l.kk.fromCollection(n);if("title"!==e.mentioned_from.property_id){const o=r.oC(n),i=e.mentioned_from.property_id,s=o[i];if(!s)return!1;if("relation"===s.type){const e=(0,a.ky)({block:_,getRecordModel:u}),n=r.F0(s);if(!e||e.id!==n)return!1;if(r.EY({...t.pointer,propertyId:i,propertySchema:s},e))return!1}else if("title"!==s.type&&"text"!==s.type)return!1}}else if("title"===e.mentioned_from.property_id){if(!(0,o.XD)(t.type))return!1}else{if("caption"!==e.mentioned_from.property_id)return!1;if(!l.kk.fromBlock(t).isType(o.oe))return!1}}const y=(0,c.zN)(i)[0],w=(0,c.uJ)({table:p.iU,id:e.block_id},u)[1];return!y||!w||y.id!==w.id}))}function C(e){const t=l.kk.fromValue(p.iU,e);if(t&&"alias"===t.type)return t.getAliasTargetPointer()}function x(e){const t=l.kk.fromValue(p.iU,e);if(t&&"transclusion_reference"===t.type)return t.getTransclusionReferenceTargetPointer()}},49271:(e,t,n)=>{n.d(t,{N7:()=>i,ZD:()=>a});var o=n(8848),r=n(82990);function i(e){return{color:o.ZP.defaultText,fill:"currentColor",lineHeight:1.5,fontFamily:r.Z.getCompositeFontFamily(e).sans}}const a={paddingTop:3,paddingBottom:3,paddingLeft:2,paddingRight:2}},50475:(e,t,n)=>{n.d(t,{EW:()=>r,R5:()=>i,bv:()=>a,u7:()=>s});var o=n(97880);function r(e){switch(e){case"home_main":case"home_trending":case"home_similar_users":case"home_my_tasks":return!0;case void 0:return!1;default:(0,o.t1)(e)}}function i(e){const t=null==e?void 0:e.getSystemBlockType();switch(t){case"home_main":case"home_trending":case"home_similar_users":case"home_my_tasks":return!0;case void 0:return!1;default:(0,o.t1)(t)}}function a(e){switch(e){case"home_main":case"home_trending":case"home_similar_users":case"home_my_tasks":return!0;case void 0:return!1;default:(0,o.t1)(e)}}function s(e){switch(e){case"home_main":case"home_trending":case"home_similar_users":return!0;case"home_my_tasks":case void 0:return!1;default:(0,o.t1)(e)}}},47025:(e,t,n)=>{n.d(t,{Fs:()=>v,Gy:()=>h,II:()=>g,PL:()=>m,RG:()=>c,mk:()=>l,qV:()=>p,t2:()=>u});var o=n(14714),r=n(99036),i=n(80951),a=n(97880);const s=["date","created_time","last_edited_time","last_visited_time","relation"];function l(e){return s.includes(e)}function c(e){let{propertySchema:t,collectionPointer:n}=e;return!!l(t.type)&&(!(0,r.p_)(t)||n.id!==(null===(o=t.collection_pointer)||void 0===o?void 0:o.id));var o}function d(e){let{collectionSchema:t,collectionPointer:n}=e;return Object.keys(t).filter((e=>{const o=(0,i.Qm)({schema:t,property:e});return!!o&&c({propertySchema:o,collectionPointer:n})}))[0]}function u(e){let{xAxisProperty:t,collectionSchema:n}=e;const o=(0,i.Qm)({schema:n,property:t});if(o&&l(o.type))return"date"===o.type||"created_time"===o.type||"last_edited_time"===o.type||"last_visited_time"===o.type?{type:o.type,property:t,groupBy:"day",sort:{type:"ascending"}}:"relation"===o.type?{type:o.type,property:t,sort:{type:"ascending"}}:void(0,a.t1)(o.type)}function p(e){let{property:t,propertySchema:n,groupByOption:r}=e;const i=n.type;if(l(i))if("date"===i||"created_time"===i||"last_edited_time"===i||"last_visited_time"===i){if(r&&o.z8.includes(r))return{type:i,property:t,groupBy:r,sort:{type:"ascending"}}}else{if("relation"===i)return{type:i,property:t,sort:{type:"ascending"}};(0,a.t1)(i)}}function m(e){return(0,o.ib)(e)?e.groupBy:void 0}function f(e){let{}=e;return{type:"record_count",seriesFormat:{displayType:"bar"},stackOptions:void 0}}function g(e){let{collectionSchema:t,xAxisProperty:n}=e;const o=(0,i.Qm)({schema:t,property:n});return o&&l(o.type)?[{collectionAggregation:{aggregator:"count"}}]:[]}function h(e){let{collectionSchema:t,collectionPointer:n}=e;const o=d({collectionSchema:t,collectionPointer:n});if(!o)return;const r=u({xAxisProperty:o,collectionSchema:t});if(!r)return;return{type:"axis",dataConfig:{xAxis:{groupBy:r},series:[f({})]}}}function v(e){let{collectionPointer:t,chartConfig:n,collectionSchema:o}=e;if(!t)return{chartConfig:void 0,error:{type:"no_collection"}};if(!d({collectionSchema:o,collectionPointer:t}))return{chartConfig:void 0,error:{type:"no_valid_xAxis_in_schema"}};if(!n)return{chartConfig:n,error:{type:"no_data_configured"}};if("axis"===n.type){const e=n.dataConfig.xAxis,r=(0,i.Qm)({schema:o,property:e.groupBy.property});if(!r)return{chartConfig:n,error:{type:"xAxis_deleted_from_schema"}};if(!c({propertySchema:r,collectionPointer:t}))return{chartConfig:n,error:{type:"invalid_xAxis_propertyType"}};const a=g({collectionSchema:o,xAxisProperty:e.groupBy.property}).map((e=>e.collectionAggregation.aggregator));return"record_count"!==n.dataConfig.series[0].type||a.includes("count")?{chartConfig:n,error:void 0}:{chartConfig:n,error:{type:"invalid_aggregation"}}}return{chartConfig:n,error:void 0}}},14248:(e,t,n)=>{n.d(t,{Ko:()=>M,ND:()=>E,RA:()=>C,WL:()=>D,Xq:()=>U,hz:()=>N,r9:()=>z,wg:()=>L,zk:()=>x});n(57658);var o=n(76205),r=n(30823),i=n(14714),a=n(99036),s=n(80951),l=n(10070),c=n(40506),d=n(53877),u=n(76725),p=n(72126),m=n(59753),f=n(77337),g=n(4615),h=n(74446),v=n(606),b=n(21202),y=n(19889),_=n(70203),S=n(97880);function w(e){const t=[],n=[];for(const[o,r]of Object.entries(e))r&&((0,a.S4)(o)||("person"===r.type?t.push(o):"date"===r.type&&n.push(o)));return{date:n,person:t}}const k=_.V3y(", ");function I(e,t){const n={command:"update",args:t,pointer:{table:b.iU,id:e.id},path:["properties"]};return m.kk.fromValue(e.table,(0,f.lK)(n,e.__IM_SORRY__getValue()))}function C(e){const{block:t,schema:n,propertyMapping:r,filter:i,userFilterContext:a,groupsPointer:s,relativeVariableResult:l,getRecordModel:c,intl:d,resultCache:u}=e,{userId:f,userTimeZone:g,userStartOfWeek:v}=a;let y=t;const _=m.om.tryUntilFound(m.om.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:n}=e;if(t===b.iU&&n===y.id)return y}),h.mF.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:n}=e;if(t===b.iU&&n===y.id)return y.__IM_SORRY__getValue()}))),c),S={};for(const o of s)Object.assign(S,B({block:y,getRecordModel:_,schema:n,propertyMapping:r,group:o,intl:d,userFilterContext:a,relativeVariableResult:l,resultCache:u})),y=I(t,S);if(i){const e=Z({block:y,schema:n,filter:i,propertyMapping:r,userFilterContext:a,relativeVariableResult:l,getRecordModel:c,intl:d,resultCache:u}),o="failsFilter"===e.type||"coercedByFilter"===e.type?e.update??{}:{};Object.assign(S,o),y=I(t,S)}for(const o of s)Object.assign(S,B({block:y,getRecordModel:_,schema:n,propertyMapping:r,group:o,intl:d,userFilterContext:a,relativeVariableResult:l,resultCache:u})),y=I(t,S);const w=I(y,S),k=p.yW(s.map((e=>{const t=x({group:e,propertyMapping:r,schema:n,timeZone:g}),i=t?(0,o.q)({context:{schema:n,userId:f,userTimeZone:g,userStartOfWeek:v,relativeVariableResult:l,intl:d},propertyMapping:r,filter:t}):void 0;return Boolean(i&&i({block:w,getRecordModel:c,propertyMapping:r,resultCache:u}))}))),C=i?(0,o.q)({filter:i,propertyMapping:r,context:{schema:n,userId:f,userTimeZone:g,userStartOfWeek:v,relativeVariableResult:l,intl:d}}):void 0,T=!C||C({block:w,getRecordModel:c,propertyMapping:r,resultCache:u});return{coercionSucceeded:k&&T,update:S}}function x(e){const t=M(e);return t?(0,o.vA)(t)?t:{operator:"and",filters:[t]}:void 0}function T(e,t){var n;return t?(null===(n=l.aQ.fromViewPropertyIds([e.property],t))||void 0===n?void 0:n[0])??e.property:e.property}function M(e){const{schema:t,group:n,propertyMapping:o,timeZone:r}=e,a=T(n,o),s=t[a];if(!s)return;const l=n.value;if((0,i.LG)(s)&&l.type===s.type){if(void 0===l.value)return{property:a,filter:{operator:"is_empty"}};if("select"===s.type)return"string"==typeof l.value?{property:a,filter:{operator:"enum_is",value:{type:"exact",value:l.value}}}:void 0;if("status"===s.type)return void 0!==l.value&&"status"===l.type?{property:a,filter:{operator:"status_is",value:"by_group"===l.value.type?{type:"is_group",value:l.value.group}:{type:"is_option",value:l.value.option}}}:void 0;if((0,i.pd)(s.type))return"object"==typeof l.value&&l.type===s.type?{property:a,filter:{operator:"person_contains",value:{type:"exact",value:l.value}}}:void 0;if("relation"===s.type)return"object"==typeof l.value&&"relation"===l.type?function(e,t){if((0,i.RA)(t.value))return{property:e,filter:{operator:"relation_contains",value:{type:"exact",value:t.value.id}}};if((0,i.t2)(t.value))return{property:e,filter:{operator:"relation_contains",value:{type:"relative",value:{type:"builtin",variable:t.value.value.variable}}}}}(a,l):void 0;if("location"===s.type)return"object"==typeof l.value&&"location"===l.type?{property:a,filter:{operator:"location_is",value:{type:"exact",value:l.value.id}}}:void 0;if("multi_select"===s.type)return"string"==typeof l.value?{property:a,filter:{operator:"enum_contains",value:{type:"exact",value:l.value}}}:void 0;if((0,i.A1)(s.type)){if(l.type!==s.type)return;return P(l.value,a,r)}if((0,i.HB)(s.type)){if(l.type!==s.type)return;return A(l.value,a)}if("number"===s.type){if("number"!==l.type)return;return R(l.value,a)}if("checkbox"===s.type){if("checkbox"!==l.type)return;return{property:a,filter:{operator:"checkbox_is",value:{type:"exact",value:l.value}}}}if("formula"===s.type){if("formula"!==l.type)return;const e=l.value;if(void 0===e.value)return;if((0,i.R7)(e))return A(e.value,a);if("number"===e.type)return R(e.value,a);if("checkbox"===e.type)return{property:a,filter:{operator:"checkbox_is",value:{type:"exact",value:e.value}}};if((0,i.Mc)(e))return P(e.value,a,r);if((0,i.q6)(e))return function(e,t){return{property:e,filter:{operator:"person_contains",value:{type:"exact",value:t.value}}}}(a,e);if((0,i.tL)(e))return(0,i.RA)(e.value)?{property:a,filter:{operator:"relation_contains",value:{type:"exact",value:e.value.id}}}:void 0;(0,S.t1)(e)}(0,S.t1)(s.type)}}function P(e,t,n){const o=(0,i.Hk)(e,n);return{property:t,filter:{operator:"date_is_within",value:{type:"exact",value:d.OQ.toPersistedDateRange(o,n)}}}}function A(e,t){if("alphabet_prefix"===e.type){const n=e.value;return isNaN(parseInt(n))?{operator:"or",filters:[{property:t,filter:{operator:"string_starts_with",value:{type:"exact",value:e.value.toUpperCase()}}},{property:t,filter:{operator:"string_starts_with",value:{type:"exact",value:e.value.toLowerCase()}}}]}:{property:t,filter:{operator:"string_starts_with",value:{type:"exact",value:e.value}}}}return"other"===e.type?{property:t,filter:{operator:"string_has_no_alphabet_prefix"}}:"exact"===e.type?{property:t,filter:{operator:"string_is",value:{type:"exact",value:e.value}}}:void(0,S.t1)(e)}function R(e,t){if("range"===e.type){const{start:n,end:o}=e;return{operator:"and",filters:[{property:t,filter:{operator:"number_greater_than_or_equal_to",value:{type:"exact",value:n}}},{property:t,filter:{operator:"number_less_than",value:{type:"exact",value:o}}}]}}if("out_of_range"===e.type){const{start:n,end:o}=e;return{operator:"or",filters:[{property:t,filter:{operator:"number_less_than",value:{type:"exact",value:n}}},{property:t,filter:{operator:"number_greater_than_or_equal_to",value:{type:"exact",value:o}}}]}}(0,S.t1)(e)}function D(e,t){const n=e.property,o=null==t?void 0:t[n];if(null!=o&&o.derived_property_record_metadata)return!1;if(o&&s.A0(o))return!1;const r=e.value;return!r.value||("select"===r.type||"multi_select"===r.type||"status"===r.type||"person"===r.type||"checkbox"===r.type||"relation"===r.type||"date"===r.type||"number"===r.type||((0,i.R7)(r)?"exact"===r.value.type:"formula"!==r.type&&"created_by"!==r.type&&"last_edited_by"!==r.type&&"created_time"!==r.type&&"last_edited_time"!==r.type&&"location"!==r.type&&"last_visited_time"!==r.type&&void(0,S.t1)(r.type)))}function E(e){const{schema:t,propertyMapping:n,group:o,block:r,resultCache:a}=e;if(!D(o,t))return{};const s=function(e){const{schema:t,group:n,propertyMapping:o}=e,r=T(n,o),a=t[r];if(!a)return;const s=n.value;return(0,i.LG)(a)&&s.type===a.type&&void 0!==s.value?"person"===a.type?"object"==typeof s.value&&"person"===s.type?{property:r,filter:{operator:"person_does_not_contain",value:{type:"exact",value:s.value}}}:void 0:"relation"===a.type?"relation"===s.type&&(0,i.RA)(s.value)?{property:r,filter:{operator:"relation_does_not_contain",value:{type:"exact",value:s.value.id}}}:"relation"===s.type&&(0,i.t2)(s.value)?{property:r,filter:{operator:"relation_does_not_contain",value:{type:"relative",value:{type:"builtin",variable:s.value.value.variable}}}}:void 0:"location"===a.type?"object"==typeof s.value&&"location"===s.type?{property:r,filter:{operator:"location_is_not",value:{type:"exact",value:s.value.id}}}:void 0:"multi_select"===a.type?"string"==typeof s.value?{property:r,filter:{operator:"enum_does_not_contain",value:{type:"exact",value:s.value}}}:void 0:void("select"!==a.type&&"status"!==a.type&&"checkbox"!==a.type&&"date"!==a.type&&"text"!==a.type&&"title"!==a.type&&"url"!==a.type&&"email"!==a.type&&"phone_number"!==a.type&&"number"!==a.type&&"formula"!==a.type&&"created_by"!==a.type&&"last_edited_by"!==a.type&&"created_time"!==a.type&&"last_edited_time"!==a.type&&"last_visited_time"!==a.type&&(0,S.t1)(a)):void 0}({schema:t,group:o,propertyMapping:n});if(!s)return{};const l=V({...e,property:s.property,filter:s.filter,schema:t,block:r,resultCache:a});return("failsFilter"===l.type||"coercedByFilter"===l.type)&&l.update||{}}function B(e){const{schema:t,propertyMapping:n,group:r,block:i,userFilterContext:a}=e,{userTimeZone:s}=a;if(!D(r,t))return{};const l=M({schema:t,group:r,propertyMapping:n,timeZone:s});if(!l||!(0,o.aN)(l))return{};const c=V({...e,property:l.property,filter:l.filter,schema:t,block:i});return("failsFilter"===c.type||"coercedByFilter"===c.type)&&c.update||{}}function F(e){const{dateValue:t,timestamp:n,userTimeZone:o}=e;if("date"===t.type)return{...d.hT(n,o),reminder:t.reminder};if("datetime"===t.type)return{...d.CQ(n,o),reminder:t.reminder};if("daterange"===t.type){const e=d.DF(c.Nh(t),o).valueOf(),r=d.DF(c.v3(t),o).valueOf()-e;return{...d.fZ(n,n+r,o),reminder:t.reminder}}if("datetimerange"===t.type){const e=d.Sy(c.C1(t)).valueOf(),r=d.Sy(c.C1(t)).valueOf()-e;return{...d.iC(n,n+r,o),reminder:t.reminder}}(0,S.t1)(t)}const O={text:function(e){const{filter:t,value:n}=e;if("is_empty"===t.operator)return{type:"text",value:void 0};if("is_not_empty"===t.operator)return;if("string_has_no_alphabet_prefix"===t.operator)return;const o=(t.value.value||"").trim();return"string_is_not"===t.operator||"string_does_not_contain"===t.operator?{type:"text",value:void 0}:"string_is"===t.operator?{type:"text",value:o}:"string_contains"===t.operator||"string_ends_with"===t.operator?{type:"text",value:(n.value||"")+o}:"string_starts_with"===t.operator?{type:"text",value:o+(n.value||"")}:void(0,S.t1)(t.operator)},checkbox:function(e){const{filter:t}=e,n=t.value;return"checkbox_is"===t.operator?{type:"checkbox",value:Boolean(n.value)}:"checkbox_is_not"===t.operator?{type:"checkbox",value:!Boolean(n.value)}:void(0,S.t1)(t.operator)},select:function(e){var t;const{filter:n,propertySchema:r}=e;if("is_empty"===n.operator)return{type:"select",value:void 0};if("is_not_empty"===n.operator)return{type:"select",value:r.options&&r.options.length>0?r.options[0].value:void 0};const i=null===(t=(0,o.mg)(n)[0])||void 0===t?void 0:t.value;return void 0!==i?"enum_is"===n.operator?{type:"select",value:i}:"enum_is_not"===n.operator?{type:"select",value:void 0}:void(0,S.t1)(n.operator):void 0},multi_select:function(e){var t;const{filter:n,propertySchema:r,value:i}=e;if("is_empty"===n.operator)return{type:"multi_select",value:void 0};if("is_not_empty"===n.operator)return{type:"multi_select",value:r.options&&r.options.length>0?[r.options[0].value]:void 0};const a=null===(t=(0,o.qC)(n)[0])||void 0===t?void 0:t.value;if(void 0===a)return;const s=i.value||[];return"enum_contains"===n.operator?{type:"multi_select",value:[...s,a]}:"enum_does_not_contain"===n.operator?{type:"multi_select",value:s.filter((e=>e!==a))}:void(0,S.t1)(n.operator)},status:function(e){const{filter:t,propertySchema:n}=e,r=n.groups??[],i=n.options??[];if("is_empty"===t.operator)return{type:"status",option:void 0,group:void 0};if("is_not_empty"===t.operator)return{type:"status",option:n.options&&n.options.length>0?n.options[0].value:void 0,group:n.groups&&n.groups.length>0?n.groups[0].name:void 0};const a=(0,o.wB)(t);if(0===a.length)return;const s=r.map((e=>{const t=i.filter((t=>{var n;return null===(n=e.optionIds)||void 0===n?void 0:n.includes(t.id)}));return{group:e,groupOptions:t}}));if("status_is"===t.operator){const{type:e,value:t}=a[0];if("is_group"===e){var l;const e=r.findIndex((e=>e.name===t)),n=e>=0?s[e]:void 0;return{type:"status",group:null==n?void 0:n.group.name,option:null==n||null===(l=n.groupOptions[0])||void 0===l?void 0:l.value}}if("is_option"===e){const e=i.find((e=>e.value===t)),n=e&&r.find((t=>{var n;return null===(n=t.optionIds)||void 0===n?void 0:n.includes(e.id)}));return{type:"status",group:null==n?void 0:n.name,option:null==e?void 0:e.value}}(0,S.t1)(e)}if("status_is_not"===t.operator)return{type:"status",group:void 0,option:void 0};(0,S.t1)(t.operator)},relation:function(e){var t;const{filter:n,value:r,propertySchema:i,relativeVariableResult:a}=e;if("is_empty"===n.operator)return{type:"relation",value:void 0};if("is_not_empty"===n.operator)return;const s=(0,o.YO)(n),l=null===(t=s[0])||void 0===t?void 0:t.type;let c;var d;if("exact"===l)c=null===(d=s[0])||void 0===d?void 0:d.value;else if("relative"===l){var u,p;const e=null===(u=i.collection_pointer)||void 0===u?void 0:u.id;if(!e||!a)return;c=a[e][null===(p=s[0])||void 0===p?void 0:p.value.variable]}if(void 0===c)return;const m=r.value||[];return"relation_contains"===n.operator?{type:"relation",value:[...m,{id:c,table:b.iU,spaceId:0!==m.length?m[0].spaceId:void 0}]}:"relation_does_not_contain"===n.operator?{type:"relation",value:m.filter((e=>e.id!==c))}:void(0,S.t1)(n.operator)},person:function(e){const{filter:t,userFilterContext:n,value:r}=e,{userId:i}=n;if("is_empty"===t.operator)return{type:"person",value:void 0};if("is_not_empty"===t.operator)return i?{type:"person",value:[{table:y.KJ,id:i}]}:void 0;const a=(0,o.R8)(t)[0];if(!a)return;const s=(0,o.l$)({operatorValue:a,userId:i});if(void 0===s)return;const l=r.value||[];return"person_contains"===t.operator?{type:"person",value:[...l,s]}:"person_does_not_contain"===t.operator?{type:"person",value:l.filter((e=>!p.Xy(e,s)))}:void(0,S.t1)(t.operator)},number:function(e){const{filter:t}=e;if("is_empty"===t.operator)return{type:"number",value:void 0};if("is_not_empty"===t.operator)return{type:"number",value:0};const n=t.value.value;return void 0===n||p.i2(n)?void 0:"number_equals"===t.operator||"number_greater_than_or_equal_to"===t.operator||"number_less_than_or_equal_to"===t.operator?{type:"number",value:n}:"number_less_than"===t.operator?{type:"number",value:n-1}:"number_greater_than"===t.operator?{type:"number",value:n+1}:"number_does_not_equal"===t.operator?{type:"number",value:void 0}:void(0,S.t1)(t.operator)},date:function(e){const{filter:t,userFilterContext:n,value:r}=e,{userTimeZone:i,userStartOfWeek:a}=n;if("is_empty"===t.operator)return{type:"date",value:void 0};if("is_not_empty"===t.operator)return{type:"date",value:d.Lg(i)};const s=r.value;if((0,o.TQ)(t)){const e=(0,o.sw)({operatorValue:t.value,userTimeZone:i,userStartOfWeek:a});if(void 0===s){const t=d.Lg(i),n=d.NK(t,i).start.valueOf();return void 0!==e.start&&void 0!==e.end&&n>=e.start&&n<=e.end?{type:"date",value:t}:void 0!==e.start?{type:"date",value:d.hT(e.start,i)}:void 0!==e.end?{type:"date",value:d.hT(e.end,i)}:void 0}const n=d.NK(s,i).start.valueOf();return void 0!==e.end&&n>e.end?{type:"date",value:F({dateValue:s,timestamp:e.end,userTimeZone:i})}:void 0!==e.start&&n<e.start?{type:"date",value:F({dateValue:s,timestamp:e.start,userTimeZone:i})}:void 0}const l=t.value,c=(0,o.og)({operatorValue:l,userTimeZone:i});if(void 0!==c){if("date_is"===t.operator||"date_is_on_or_before"===t.operator||"date_is_on_or_after"===t.operator)return s?{type:"date",value:F({dateValue:s,timestamp:c,userTimeZone:i})}:{type:"date",value:d.hT(c,i)};if("date_is_before"===t.operator){const e=d.Xz({date:c,daysToAdd:-1});return s?{type:"date",value:F({dateValue:s,timestamp:e,userTimeZone:i})}:{type:"date",value:d.hT(e,i)}}if("date_is_after"===t.operator){const e=d.Xz({date:c,daysToAdd:1});return s?{type:"date",value:F({dateValue:s,timestamp:e,userTimeZone:i})}:{type:"date",value:d.hT(e,i)}}(0,S.t1)(t.operator)}},file:function(e){const{filter:t}=e;if("is_empty"===t.operator)return{type:"file",value:void 0};"is_not_empty"!==t.operator&&(0,S.t1)(t)},location:()=>{},verification:function(e){const{filter:t}=e;if("verification_is"===t.operator)return{type:"verification",value:void 0};"verification_is_not"!==t.operator&&(0,S.t1)(t.operator)}};function Z(e){const{filter:t,block:n,schema:r,propertyMapping:i,userFilterContext:a,relativeVariableResult:s,getRecordModel:l,intl:c,resultCache:d}=e,{userId:u,userTimeZone:p,userStartOfWeek:f}=a,g=t.filters||[];if(0===g.length)return{type:"passesFilter"};if((0,o.q)({context:{schema:r,userId:u,userTimeZone:p,userStartOfWeek:f,relativeVariableResult:s,intl:c},propertyMapping:i,filter:t})({block:n,getRecordModel:l,propertyMapping:i,resultCache:d}))return{type:"passesFilter"};if("or"===t.operator){const e=g.map((e=>(0,o.aN)(e)?V({intl:c,block:n,schema:r,propertyMapping:i,property:e.property,filter:e.filter,userFilterContext:a,getRecordModel:l,relativeVariableResult:s,resultCache:d}):(0,o.Mm)(e)?{type:"failsFilter"}:(0,o.vA)(e)?Z({filter:e,intl:c,block:n,schema:r,propertyMapping:i,userFilterContext:a,relativeVariableResult:s,getRecordModel:l,resultCache:d}):void(0,S.t1)(e)));if(e.some((e=>"passesFilter"===e.type)))return{type:"passesFilter"};const t=e.find((e=>"coercedByFilter"===e.type));return t||(e.find((e=>"failsFilter"===e.type))||{type:"failsFilter"})}const v=[...g];v.reverse();let y="passesFilter";const _={};let w=n;const k=m.om.tryUntilFound(m.om.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:n}=e;if(t===b.iU&&n===w.id)return w}),h.mF.fromMonomorphicFunctionUnsafe((e=>{let{table:t,id:n}=e;if(t===b.iU&&n===w.id)return w.__IM_SORRY__getValue()}))),l);for(const m of v){if((0,o.Mm)(m))continue;const e=(0,o.aN)(m)?V({intl:c,block:w,schema:r,propertyMapping:i,property:m.property,filter:m.filter,userFilterContext:a,getRecordModel:k,relativeVariableResult:s,resultCache:d}):Z({filter:m,intl:c,block:w,schema:r,propertyMapping:i,userFilterContext:a,relativeVariableResult:s,getRecordModel:k,resultCache:d});"coercedByFilter"===e.type&&"passesFilter"===y&&(y="coercedByFilter"),"failsFilter"===e.type&&(y="failsFilter"),("coercedByFilter"===e.type||"failsFilter"===e.type&&e.update)&&(Object.assign(_,e.update),w=I(n,_))}return"passesFilter"===y?{type:y}:{type:y,update:_}}function V(e){const{filter:t,block:n,property:i,schema:a,propertyMapping:l,userFilterContext:c,getRecordModel:d,relativeVariableResult:u,intl:p,resultCache:m}=e,{userId:f,userTimeZone:g,userStartOfWeek:h}=c;if((0,o.Y1)({context:{schema:a,userId:f,userTimeZone:g,userStartOfWeek:h,relativeVariableResult:u,intl:p},filter:t,property:i,propertyMapping:l,depth:0})({block:n,getRecordModel:d,propertyMapping:l,resultCache:m}))return{type:"passesFilter"};if((0,o.a_)(t))return{type:"failsFilter"};const v=a[i];if(!v)return{type:"failsFilter"};if(!(0,r.BJ)(v))return{type:"failsFilter"};const b=(0,r.vc)(v.type),y=(0,r.ML)({filterValueType:b,block:n,propertyValue:s.wS(n,i,d),propertySchema:v,getRecordModel:d,collectionRequestContext:{userId:f,userTimeZone:g,intl:p,depth:0,visitedProperties:new Set,resultCache:new Map}}),_=(0,O[b])({filter:t,value:y,propertySchema:v,userFilterContext:c,relativeVariableResult:u});if(void 0===_)return{type:"failsFilter"};const S=(0,r.qg)({propertyType:v.type,filterValue:_});return{type:"coercedByFilter",update:{[(null==l?void 0:l[i])??i]:S}}}function U(e){const{blockProperties:t,oldSchema:n,newSchema:o,typesMatch:r,oldPropertyMapping:i,newPropertyMapping:a}=e,s=Object.keys(n),c=Object.keys(o),d=function(e){const{blockProperties:t,oldSchema:n,newSchema:o}=e,r={},i=null==t?void 0:t.title,a=_.lcG(i),[s]=_.nai(i),{person:[l],date:[c]}=w(o),{person:[d],date:[p]}=w(n);if(l&&(null==t||!t[l])&&!d&&a.length>0){const e=Array.from(new Set(a));r[l]=(0,u.Z)(e.map((e=>_.YCD(_.tEo(e)))),(()=>k))}return!c||null!=t&&t[c]||p||!s||(r[c]=[_.YCD(_.pZr(s))]),r}({blockProperties:t,oldSchema:n,newSchema:o}),p={propertyUpdate:d,newSchema:o},m=["relation","auto_increment_id","verification"];for(const u of s){const e=n[u],s=null==t?void 0:t[u];if(e&&!m.includes(e.type)){if(r){const e=l.aQ.deriveTypeUri(u,i),n=e?null==a?void 0:a[e]:void 0;if(n&&n!==u){p.propertyUpdate[n]=(null==t?void 0:t[u])||null,p.propertyUpdate[u]=null;continue}}if(s){const r=c.find((e=>u===e))||c.find((t=>{const n=o[t];return Boolean(e&&n&&e.name.trim().toLowerCase()===n.name.trim().toLowerCase()&&e.type===n.type)}));if(r&&p.propertyUpdate)r!==u&&(p.propertyUpdate[r]=t[u]||null,p.propertyUpdate[u]=null);else{const e=(0,g.ZP)(),o=n[u];p.newSchema={...p.newSchema,[e]:o},p.propertyUpdate&&(p.propertyUpdate[e]=t[u]||null,p.propertyUpdate[u]=null)}}}}return p}function N(e){const{block:t,schema:n,property:o,oldValue:r,newValue:a}=e;if(void 0===r.value)return{};if(void 0===a.value)return{};const l=t.getProperties();if(!l)return{};const c=l[o];if(!c)return{};const d=n[o];if(!d)return{};if(!(0,i.LG)(d))return{};if("status"===d.type||"select"===d.type||"multi_select"===d.type||"checkbox"===d.type)return function(e){const{propertySchema:t,property:n,oldValue:o,newValue:r,propertyValue:a}=e;if(void 0===o.value)return{};if(void 0===r.value)return{};if(!(0,i.LG)(t))return{};if("select"===t.type){if("select"!==o.type||"select"!==r.type)return{};if(void 0===r.value)return{};const e=s.Ak(a);return 0===e.length&&void 0===o.value||e.some((e=>(e||"").trim().toLowerCase()===(o.value||"").trim().toLowerCase()))?{[n]:s.O2(r.value)}:{}}if("multi_select"===t.type){if("multi_select"!==o.type||"multi_select"!==r.type)return{};if(void 0===r.value)return{};const e=s.Ak(a);if(!e.some((e=>e.trim().toLowerCase()===(o.value||"").trim().toLowerCase())))return{};const t=r.value,i=e.map((e=>e.trim().toLowerCase()===(o.value||"").trim().toLowerCase()?t:e));return{[n]:s.zq(i)}}if("status"===t.type){const e=t.groups??[],i=t.options??[];if("checkbox"===o.type&&"status"===r.type){if(s.Ml(a)!==o.value)return{};let t;if("by_group"===r.value.type){const n=r.value.group,o=e.find((e=>e.name===n)),a=i.find((e=>{var t;return e.id===(null==o||null===(t=o.optionIds)||void 0===t?void 0:t[0])}));t=null==a?void 0:a.value}else t=r.value.option;if(t)return{[n]:s.Is(t)}}var l;return"status"===o.type&&"status"===r.type?"by_option"!==o.value.type||"by_option"!==r.value.type||(null===(l=s.Ak(a))||void 0===l?void 0:l[0])!==o.value.option?{}:{[n]:s.Is(r.value.option)}:{}}if("checkbox"===t.type)return"status"!==o.type||"checkbox"!==r.type||"by_option"!==o.value.type?{}:s.Ak(a).includes(o.value.option)?{[n]:s._I(r.value)}:{};(0,S.t1)(t)}({propertySchema:d,property:o,propertyValue:c,oldValue:r,newValue:a});if("person"===d.type){if("person"!==r.type||"person"!==a.type)return{};if(void 0===r.value)return{};if(void 0===a.value)return{};const e=a.value,n=r.value,i=m.kk.fromBlock(t),l=s.DW({textValue:c,propertySchema:d,blockCreatorPointer:i.getCreatedByPointer()});if(!l.some((e=>p.Xy(e,n))))return{};const u=l.map((t=>p.Xy(t,n)?e:t));return{[o]:s.C1(u)}}if("relation"===d.type){if("relation"!==r.type||"relation"!==a.type||void 0===r.value||void 0===a.value)return{};if((0,i.t2)(r.value)||(0,i.t2)(a.value))return{};const e=a.value,t=r.value,n=s.rq(c);if(!n.some((e=>(0,v.qo)(e,t))))return{};const l=n.map((n=>(0,v.qo)(n,t)?e:n));return{[o]:s.ow(l)}}if((0,i.HB)(d.type)){if(r.type!==d.type||a.type!==d.type||void 0===r.value||void 0===a.value||"exact"!==r.value.type||"exact"!==a.value.type)return{};return _.QaF(c)!==r.value.value?{}:{[o]:(0,_.TPx)(a.value.value)}}if("date"===d.type||"number"===d.type||"formula"===d.type||"created_by"===d.type||"last_edited_by"===d.type||"created_time"===d.type||"last_edited_time"===d.type||"location"===d.type||"last_visited_time"===d.type)return{};(0,S.t1)(d.type)}function L(e){const{block:t,schema:n,property:r,value:a,timeZone:s,intl:l,getRecordModel:c,resultCache:u}=e,p=n[r];if(!p||!(0,i.LG)(p)||t.is_template)return!1;const m=M({schema:n,propertyMapping:void 0,group:{property:r,value:a},timeZone:s});if(!m)return!1;return(0,o.q)({filter:{operator:"and",filters:[m]},propertyMapping:void 0,context:{schema:n,intl:l,userId:void 0,userTimeZone:"UTC",userStartOfWeek:(0,d.aN)(),relativeVariableResult:void 0}})({block:t,getRecordModel:c,propertyMapping:void 0,resultCache:u})}const j={Todo:"To-do","To-do":"To-do","To do":"To-do","Not started":"To-do",Backlog:"To-do",Incomplete:"To-do",Waiting:"To-do","On hold":"To-do",Later:"To-do",Blocked:"To-do","In progress":"In progress",Building:"In progress",Designing:"In progress",Research:"In progress",Scoping:"In progress",Planning:"In progress","Needs review":"In progress",Reviewed:"In progress",Review:"In progress",Pending:"In progress",Recurring:"In progress","Review needed":"In progress","Edits needed":"In progress",Editing:"In progress",Complete:"Complete",Completed:"Complete",Done:"Complete",Finished:"Complete",Archive:"Complete",Archived:"Complete",Deleted:"Complete",Published:"Complete",Reverted:"Complete"};function z(e,t,n){var o;const r=(0,a.I4)(e,n),i=r.groups??[],s=r.options??[],l=p.Cw(j,((e,t)=>t.toLowerCase())),c=new Set,d=new Set;for(const a of t){const e=s.findIndex((e=>e.value.toLowerCase()===a.value.toLowerCase()));if(e>-1){const t=s[e];if(!c.has(t.id)){d.add(a.id),c.add(t.id),s[e]={...a,id:t.id};continue}}const t=l[a.value.toLowerCase()],n=i.find((e=>e.name===t));var u;if(n)null===(u=n.optionIds)||void 0===u||u.push(a.id),d.add(a.id)}for(const[a,p]of i.entries()){var m;const e=null===(m=p.optionIds)||void 0===m?void 0:m.some((e=>d.has(e)));p.optionIds=(p.optionIds??[]).filter((t=>!(!d.has(t)&&!c.has(t))||!e))}null==i||null===(o=i[0].optionIds)||void 0===o||o.push(...t.filter((e=>!d.has(e.id))).map((e=>e.id)));const f=[...s,...t],g=[];for(const a of i)for(const e of a.optionIds??[]){const t=f.find((t=>t.id===e));t&&g.push(t)}return{type:"status",name:e,groups:i,options:g}}},34296:(e,t,n)=>{n.d(t,{S:()=>o});let o=function(e){return e[e.Source=0]="Source",e[e.Relation=1]="Relation",e[e.Automation=2]="Automation",e}({})},63144:(e,t,n)=>{n.d(t,{P:()=>r});var o=n(72126);function r(e,t){return t.getAlive()!==e.getAlive()||!o.Xy(t.getText(),e.getText())||!o.Xy(t.getContent(),e.getContent())}},1274:(e,t,n)=>{n.d(t,{IC:()=>c,bM:()=>u,fz:()=>d,o0:()=>p});n(57658);var o=n(21202),r=n(77420),i=n(6287),a=n(13493),s=n(15047),l=n(97880);function c(e){const{targetTriggerType:t,targetParentPointer:n,targetSpaceId:o}=e;return"notification_event"===t||"event"===t?[{pointer:n,minimumRequiredRole:"editor"},{pointer:{id:o,table:s.bx},minimumRequiredRole:"read_and_write"}]:"recurrence"===t||"button"===t||"chat"===t?[{pointer:n,minimumRequiredRole:"read_and_write"}]:void(0,l.t1)(t)}function d(e){const{automationValue:t,actionValues:n}=e,o=n.flatMap((e=>p(e))).filter(l.$K);return"notification_event"===t.trigger.type||"event"===t.trigger.type?(o.push({pointer:{id:t.parent_id,table:t.parent_table,spaceId:t.space_id},minimumRequiredRole:"editor"},{pointer:{id:t.space_id,table:s.bx},minimumRequiredRole:"read_and_write"}),(0,l.$K)(t.trigger.event.source)&&(t.trigger.event.source.type===a.n||t.trigger.event.source.type===i.v?o.push({pointer:t.trigger.event.source.pointer,minimumRequiredRole:"reader"}):"filter"===t.trigger.event.source.type||(0,l.t1)(t.trigger.event.source))):"recurrence"===t.trigger.type||"button"===t.trigger.type||"chat"===t.trigger.type?o.push({pointer:{id:t.parent_id,table:t.parent_table,spaceId:t.space_id},minimumRequiredRole:"read_and_write"}):(0,l.t1)(t.trigger),o}function u(e){return"notification_event"===e.trigger.type||"event"===e.trigger.type?[{pointer:{id:e.parent_id,table:e.parent_table,spaceId:e.space_id},minimumRequiredRole:"editor"},{pointer:{id:e.space_id,table:s.bx},minimumRequiredRole:"read_and_write"}]:"recurrence"===e.trigger.type||"button"===e.trigger.type||"chat"===e.trigger.type?[{pointer:{id:e.parent_id,table:e.parent_table,spaceId:e.space_id},minimumRequiredRole:"read_and_write"}]:void(0,l.t1)(e.trigger)}function p(e){if("create_page"===e.type){var t,n;const r=[];var i,a;if(null!==(t=e.config)&&void 0!==t&&t.collection)r.push({pointer:null===(i=e.config)||void 0===i?void 0:i.collection,minimumRequiredRole:"content_only_editor"});if(null!==(n=e.config)&&void 0!==n&&n.template_page_id)r.push({pointer:{id:null===(a=e.config)||void 0===a?void 0:a.template_page_id,table:o.iU,spaceId:e.space_id},minimumRequiredRole:"reader"});return r}var s,c;if("query_collection"===e.type){if(null!==(s=e.config)&&void 0!==s&&s.collection)return[{pointer:null===(c=e.config)||void 0===c?void 0:c.collection,minimumRequiredRole:"content_only_editor"}]}else if("update_pages"===e.type){var d;const t=null===(d=e.config)||void 0===d?void 0:d.target;if(!t)return[];if("collection"===t.type)return[{pointer:t.collection,minimumRequiredRole:"content_only_editor"}];if("page"===t.type)return[{pointer:t.page,minimumRequiredRole:"content_only_editor"}];if("variable"===t.type)return[];(0,l.t1)(t)}else if("open_page"===e.type){var u;const t=null===(u=e.config)||void 0===u?void 0:u.target;if(!t)return[];if("page"===t.type)return[{pointer:t.page,minimumRequiredRole:"reader"}];if("variable"===t.type)return[];(0,l.t1)(t)}else if("slack_notification"===e.type){var p;if(null!==(p=e.config)&&void 0!==p&&p.external_bot_id)return[{pointer:{id:e.config.external_bot_id,table:r.cZ},minimumRequiredRole:"editor"}]}else{if("duplicate_blocks"===e.type)return[];if("modal_confirmation"===e.type)return[];if("complete_sprint"===e.type){var m,f;const t=[];return null!==(m=e.config)&&void 0!==m&&m.sprint_collection&&t.push({pointer:e.config.sprint_collection,minimumRequiredRole:"editor"}),null!==(f=e.config)&&void 0!==f&&f.task_collection&&t.push({pointer:e.config.task_collection,minimumRequiredRole:"editor"}),t}if("assistant"===e.type)return[];(0,l.t1)(e)}}},86658:(e,t,n)=>{n.d(t,{Fd:()=>d,G_:()=>c,UE:()=>u,cW:()=>p,fV:()=>i,ze:()=>s});n(67294);var o=n(9291),r=n(85893);const i="v9",a="https://www.notion.so/Cookie-Notice-bc186044eed5488a8387a9e94b14e58c",s=(0,o.defineMessages)({cookieSettingsLabel:{id:"cookieConsent.settings.label",defaultMessage:"Cookie settings"},customizeCookiesHeader:{id:"cookieConsent.customizeCookies.header",defaultMessage:"Customize cookies"},trackingTypeNecessaryTitle:{id:"cookieConsent.trackingTypeNecessary.title",defaultMessage:"Strictly necessary"},trackingTypeNecessaryCaption:{id:"cookieConsent.trackingTypeNecessary.caption",defaultMessage:"Essential for the site to function. Always On."},trackingTypePreferenceTitle:{id:"cookieConsent.trackingTypePreference.title",defaultMessage:"Functional"},trackingTypePreferenceCaption:{id:"cookieConsent.trackingTypePreference.caption",defaultMessage:"Used to remember preference selections and provide enhanced features."},trackingTypePerformanceTitle:{id:"cookieConsent.trackingTypePerformance.title",defaultMessage:"Analytics"},trackingTypePerformanceCaption:{id:"cookieConsent.trackingTypePerformance.caption",defaultMessage:"Used to measure usage and improve your experience."},trackingTypeTargetingTitle:{id:"cookieConsent.trackingTypeTargeting.title",defaultMessage:"Marketing"},trackingTypeTargetingCaption:{id:"cookieConsent.trackingTypeTargeting.caption",defaultMessage:"Used for targeted advertising."},trackingTypeTargetingSubtitleiOS:{id:"cookieConsent.trackingTypeTargeting.subtitleiOS",defaultMessage:"Not collected nor used within the iOS app"},cookieDismissButtonLabel:{id:"cookieConsent.dismissButton.label",defaultMessage:"Done"},acceptAllButtonLabel:{id:"cookieConsent.acceptAllButton.label",defaultMessage:"Accept all"},rejectAllButtonLabel:{id:"cookieConsent.rejectAllButton.label",defaultMessage:"Reject all"},moreOptionsButtonLabel:{id:"cookieConsent.moreOptionsButton.label",defaultMessage:"More options"},reloadAfterSaveMessage:{id:"cookieConsent.reloadAfterSave.message",defaultMessage:"Notion will now reload to apply your cookie preferences. Click okay to continue."}}),l=(0,o.defineMessages)({banner:{id:"cookieConsent.bannerDisclaimer.message",defaultMessage:"Notion uses cookies to offer you a better experience. See<cookielink>Cookie Notice</cookielink>for details."},settings:{id:"cookieConsent.settingsDisclaimer.message",defaultMessage:"Customize cookies. See<cookielink>Cookie Notice</cookielink>for details."},snackbar:{id:"cookieConsent.snackbarDisclaimer.message",defaultMessage:"Notion uses cookies. See<cookielink>Cookie Notice</cookielink>for details."}});function c(e,t){switch(e){case"necessary":return{title:s.trackingTypeNecessaryTitle,caption:s.trackingTypeNecessaryCaption};case"preference":return{title:s.trackingTypePreferenceTitle,caption:s.trackingTypePreferenceCaption};case"performance":return{title:s.trackingTypePerformanceTitle,caption:s.trackingTypePerformanceCaption};case"targeting":const e=t?s.trackingTypeTargetingSubtitleiOS:void 0;return{title:s.trackingTypeTargetingTitle,subtitle:e,caption:s.trackingTypeTargetingCaption}}}function d(e,t){return(0,r.jsx)(o.FormattedMessage,{...l[t],values:{cookielink:t=>(0,r.jsxs)(r.Fragment,{children:[" ",e(a,t)," "]})}})}const u={necessary:!0,performance:!0,preference:!0,targeting:!0},p={necessary:!0,performance:!1,preference:!1,targeting:!1}},52936:(e,t,n)=>{n.d(t,{Bp:()=>m,yu:()=>g});n(57658),n(21703);var o=n(30120),r=n(80951),i=n(40506),a=n(53877),s=n(21768),l=n(482),c=n(72141),d=n(149),u=n(21202),p=n(97880);const m=["consume_gap","preserve_gap"];class f{constructor(){this.operations=[],this.numDependenciesUpdated=0,this.numCouldNotUpdateDueToPermissions=0}push(e){this.operations.push(...e.operations),this.numDependenciesUpdated+=e.numDependenciesUpdated,this.numCouldNotUpdateDueToPermissions+=e.numCouldNotUpdateDueToPermissions}pushUpdatedBlockDates(e,t){for(const[n,o]of e)this.operations.push(...t.toOperations(o,{id:n,table:u.iU}));this.numDependenciesUpdated+=e.size}}function g(e){const{block:t,options:n,blockingPropertyId:i,blockedByPropertyId:a,timeZone:s,locale:l,collectionSchema:c,getRecordRole:u,getRecordValue:m,dateProperty:g,endDateProperty:y}=e,_=function(e){return t=>{let{oldDateValue:n,newDateValue:r,dependencyDateValue:i}=t;const a=Boolean(e.avoid_weekends),s=e.mode;if(!s)return;const l=i.getStart(),c=r.getStart(),d=r.getEnd();let u;if("consume_gap"===s){if(d.valueOf()>=l.valueOf()){if(a)return k({dateShiftMode:s,newDateData:o.Xp.fromDateTimes(c,d),dependencyDateValue:i});u=d.plus(i.nudgeForDate("start"))}}else if("preserve_gap"===s)if(n){const e=n.getStart(),t=n.getEnd();if(a)return k({dateShiftMode:s,oldDateData:o.Xp.fromDateTimes(e,t),newDateData:o.Xp.fromDateTimes(c,d),dependencyDateValue:i});const r=d.diff(t);u=l.plus(r)}else d.valueOf()>=l.valueOf()&&(u=d.plus(i.nudgeForDate("start")));else(0,p.t1)(s);return u&&i.changeBoundary({type:"start",newValue:u})}}(n),S=function(e){return t=>{let{oldDateValue:n,newDateValue:r,dependencyDateValue:i}=t;const a=Boolean(e.avoid_weekends),s=e.mode;if(!s)return;const l=i.getEnd(),c=r.getStart(),d=r.getEnd();let u;if("consume_gap"===s){if(c.valueOf()<=l.valueOf()&&(u=c.minus(i.nudgeForDate("end")),a))return w({dateShiftMode:s,newDateData:o.Xp.fromDateTimes(c,d),dependencyDateValue:i})}else if("preserve_gap"===s)if(n){const e=n.getStart(),t=n.getEnd();if(a)return w({dateShiftMode:s,oldDateData:o.Xp.fromDateTimes(e,t),newDateData:o.Xp.fromDateTimes(c,d),dependencyDateValue:i});const r=e.diff(c);u=l.minus(r)}else c.valueOf()<=l.valueOf()&&(u=c.minus(i.nudgeForDate("end")));else(0,p.t1)(s);return u&&i.changeBoundary({type:"end",newValue:u})}}(n),I={timeZone:s,locale:l};let C,M;if((0,p.$K)(y)){const e=new T({convertArgs:I,startPropertyId:g.id,endPropertyId:y.id});C=e;const n=e.getFromBlock(t),o=(0,r.Gl)(g.newValue)??(null==n?void 0:n.startValue),i=(0,r.Gl)(y.newValue)??(null==n?void 0:n.endValue);if(!(0,p.$K)(o))return new f;M=new A({convertArgs:I,startValue:o,endValue:i})}else{C=new x({convertArgs:I,propertyId:g.id});const e=(0,r.Gl)(g.newValue);if(!(0,p.$K)(e))return new f;M=new P({convertArgs:I,value:e})}const R={startingBlock:t,startingNewDateValue:M,context:{collectionSchema:c,getRecordRole:u,getRecordValue:m,accessor:C}};if("consume_gap"===n.mode){const e=new f,t=b({...R,dependencyPropertyId:i,dateAdjuster:_,dateRangeIsFurtherThan:(e,t)=>e.getStart().valueOf()>t.getStart().valueOf()});if(d.x.isFail(t))return new f;e.push(t.value);const n=b({...R,dependencyPropertyId:a,dateAdjuster:S,dateRangeIsFurtherThan:(e,t)=>e.getEnd().valueOf()<t.getEnd().valueOf()});return d.x.isFail(n)?new f:(e.push(n.value),e)}if("preserve_gap"===n.mode)return function(e){const{startingBlock:t,startingNewDateValue:n,forwardConfig:o,backwardConfig:r,context:i}=e,{accessor:a}=i,s=new Set,l=[{block:t,newDateValue:n}],c=new Map,d=new f;for(;;){const e=l.shift();if(!e)break;const{block:n,newDateValue:u}=e;if(s.has(n.id))continue;s.add(n.id);const p=a.getFromBlock(n);for(const{dependencyPropertyId:a,dateAdjuster:s}of[o,r]){const e=v(i,n,a);for(const n of e)n.id!==t.id&&h({context:i,adjust:e=>s({oldDateValue:p,newDateValue:u,dependencyDateValue:e}),result:d,dependencyPointer:n,onDateUpdated:(e,t)=>{c.has(n.id)||c.set(n.id,t),l.push({block:e,newDateValue:t})}})}}return d.pushUpdatedBlockDates(c,a),d}({...R,forwardConfig:{dependencyPropertyId:i,dateAdjuster:_},backwardConfig:{dependencyPropertyId:a,dateAdjuster:S}});(0,p.t1)(n.mode)}function h(e){const{result:t,dependencyPointer:n,context:o,adjust:r,onDateUpdated:i}=e,{accessor:a,getRecordValue:s,getRecordRole:l}=o,d=l(n);if(d&&!(0,c.J5)(d))return void t.numCouldNotUpdateDueToPermissions++;const u=s(n);if(!u)return;const p=a.getFromBlock(u);if(!p)return;const m=r(p);m&&!m.equals(p)&&i(u,m)}function v(e,t,n){var o;const i=e.collectionSchema[n];return i&&"relation"===i.type?(0,r.j$)({propertySchema:i,getRecordModel:s.o.fromGetRecordValueFn(e.getRecordValue),relationValue:(0,r.rq)(null===(o=t.properties)||void 0===o?void 0:o[n])}):[]}function b(e){const{startingBlock:t,startingNewDateValue:n,context:o,dateAdjuster:r,dateRangeIsFurtherThan:i,dependencyPropertyId:a}=e,{accessor:s}=o,l=new Set,c=[{block:t,newDateValue:n,path:[]}],d=new Map,u=new f;for(;;){const e=c.shift();if(!e)break;const{block:t,newDateValue:n,path:p}=e;if(p.includes(t.id))return{error:"cycle_detected"};if(l.has(t.id))continue;l.add(t.id);const m=s.getFromBlock(t),f=[...p,t.id],g=v(o,t,a);for(const a of g)h({context:o,adjust:e=>r({oldDateValue:m,newDateValue:n,dependencyDateValue:e}),result:u,dependencyPointer:a,onDateUpdated:(e,t)=>{const n=d.get(a.id);n&&!i(t,n)||d.set(a.id,t),c.push({block:e,newDateValue:t,path:f})}})}return u.pushUpdatedBlockDates(d,s),{value:u}}function y(e){const{inputDate:t,dateShiftDirection:n}=e;return 6===t.weekday?t.plus({days:"right"===n?2:-1}):7===t.weekday?t.plus({days:"right"===n?1:-2}):t}function _(e,t){let n,o,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=0;if(e.valueOf()>t.valueOf())n=t,o=e;else{if(!(e.valueOf()<t.valueOf()))return 0;n=e,o=t}for(r&&(n=n.plus({days:1}),o=o.minus({days:1}));n.valueOf()<=o.valueOf();)S(n)||i++,n=n.plus({days:1});return i}function S(e){return 6===e.weekday||7===e.weekday}function w(e){const{newDateData:t,dependencyDateValue:n,dateShiftMode:o}=e,r=n.getStart(),i=n.getEnd(),a=_(r,i);let s=y({inputDate:t.start.minus({days:1}),dateShiftDirection:"left"});if("preserve_gap"===o){const n=_(e.oldDateData.start,i,!0);for(let e=_(t.start,s,!0);e<n;e++)s=s.minus({days:1}),S(s)&&(s=y({inputDate:s,dateShiftDirection:"left"}))}let l=s,c=1;for(;c<a;)l=l.minus({days:1}),S(l)||c++;return n.changeBoundaries({newStart:l,newEnd:s})}function k(e){const{dependencyDateValue:t,newDateData:n,dateShiftMode:o}=e,r=t.getStart(),i=_(r,t.getEnd());let a=y({inputDate:n.end.plus({days:1}),dateShiftDirection:"right"});if("preserve_gap"===o){const t=_(e.oldDateData.end,r,!0);for(let e=_(n.end,a,!0);e<t;e++)a=a.plus({days:1}),S(a)&&(a=y({inputDate:a,dateShiftDirection:"right"}))}let s=a,l=1;for(;l<i;)s=s.plus({days:1}),S(s)||l++;return t.changeBoundaries({newStart:a,newEnd:s})}function I(e,t){if(!(e instanceof t))throw new Error(`Expected ShiftableDate to be of type ${t}`)}class C{constructor(e){this.convertArgs=e}}class x extends C{constructor(e){super(e.convertArgs),this.propertyId=void 0,this.propertyId=e.propertyId}getFromBlock(e){var t;const n=(0,r.Gl)(null===(t=e.properties)||void 0===t?void 0:t[this.propertyId]);return n?new P({value:n,convertArgs:this.convertArgs}):void 0}toOperations(e,t){return I(e,P),[l.op.update({pointer:t,path:["properties"],args:{[this.propertyId]:(0,r.d7)(e.value)}})]}}class T extends C{constructor(e){super(e.convertArgs),this.startPropertyId=void 0,this.endPropertyId=void 0,this.startPropertyId=e.startPropertyId,this.endPropertyId=e.endPropertyId}getFromBlock(e){var t;const n=(0,r.Gl)(null===(t=e.properties)||void 0===t?void 0:t[this.startPropertyId]);if((0,p.$K)(n)){var o;const t=(0,r.Gl)(null===(o=e.properties)||void 0===o?void 0:o[this.endPropertyId]);return new A({startValue:n,endValue:t,convertArgs:this.convertArgs})}}toOperations(e,t){return I(e,A),[l.op.update({pointer:t,path:["properties"],args:{[this.startPropertyId]:(0,r.d7)(e.startValue),...e.endValue?{[this.endPropertyId]:(0,r.d7)(e.endValue)}:{}}})]}}class M{constructor(e){this.convertArgs=e}toLuxon(e){return a.OQ.notionDateOrDateTimeToLuxon(e,this.convertArgs)}}class P extends M{constructor(e){super(e.convertArgs),this.value=void 0,this.value=e.value}getStart(){return this.toLuxon(i.Ws(this.value))}getEnd(){return this.toLuxon(i.S$(this.value))}nudgeForDate(e){return"date"===this.value.type||"daterange"===this.value.type?{days:1}:"datetime"===this.value.type?{minutes:1}:"datetimerange"===this.value.type?{}:void(0,p.t1)(this.value)}equals(e){return I(e,P),i.AP(this.value,e.value)}changeBoundary(e){let t;if("daterange"===this.value.type||"datetimerange"===this.value.type){const n=a.NK(this.value,this.convertArgs.timeZone,this.convertArgs.locale),o=n.end.diff(n.start);t=("daterange"===this.value.type?a.OQ.toPersistedDateRange:a.OQ.toPersistedDateTimeRange)("start"===e.type?{start:e.newValue,end:e.newValue.plus(o)}:{start:e.newValue.minus(o),end:e.newValue},this.convertArgs.timeZone)}else if("date"===this.value.type||"datetime"===this.value.type){t=("date"===this.value.type?a.OQ.toPersistedDate:a.OQ.toPersistedDateTime)(e.newValue.valueOf(),this.convertArgs.timeZone)}else(0,p.t1)(this.value);return new P({value:t,convertArgs:this.convertArgs})}changeBoundaries(e){const{newStart:t,newEnd:n}=e;return new P({value:a.OQ.toPersistedDateWithType({start:t,end:n},this.value.type,this.convertArgs.timeZone),convertArgs:this.convertArgs})}}class A extends M{getMergedValue(){if(this._mergedValue===A.MergedValueNotCalculated){const e=a.rH(this.startValue,this.endValue);this._mergedValue=e?a.Qq(e):void 0}return this._mergedValue}constructor(e){super(e.convertArgs),this.startValue=void 0,this.endValue=void 0,this._mergedValue=void 0,this.startValue=e.startValue,this.endValue=e.endValue}getStart(){return this.toLuxon(i.Ws(this.getMergedValue()??this.startValue))}getEnd(){return this.toLuxon(i.S$(this.getMergedValue()??this.endValue??this.startValue))}equals(e){return I(e,A),i.AP(this.startValue,e.startValue)&&((0,p.$K)(this.endValue)?(0,p.$K)(e.endValue)&&i.AP(this.endValue,e.endValue):!(0,p.$K)(e.endValue))}nudgeForDate(e){const t="start"===e?this.startValue:this.endValue??this.startValue;return"date"===t.type?{days:1}:"datetime"===t.type||"datetimerange"===t.type||"daterange"===t.type?{}:void(0,p.t1)(t)}toPersistedDateDiscardingRange(e,t){return void 0===t||"date"===t||"daterange"===t?a.OQ.toPersistedDate(e.valueOf(),this.convertArgs.timeZone):"datetime"===t||"datetimerange"===t?a.OQ.toPersistedDateTime(e.valueOf(),this.convertArgs.timeZone):void(0,p.t1)(t)}changeBoundary(e){var t,n;const o=this.getEnd().diff(this.getStart());return new A({convertArgs:this.convertArgs,..."start"===e.type?{startValue:this.toPersistedDateDiscardingRange(e.newValue,this.startValue.type),endValue:this.toPersistedDateDiscardingRange(e.newValue.plus(o),null===(t=this.endValue)||void 0===t?void 0:t.type)}:{startValue:this.toPersistedDateDiscardingRange(e.newValue.minus(o),this.startValue.type),endValue:this.toPersistedDateDiscardingRange(e.newValue,null===(n=this.endValue)||void 0===n?void 0:n.type)}})}changeBoundaries(e){var t;const{newStart:n,newEnd:o}=e;return new A({startValue:this.toPersistedDateDiscardingRange(n,this.startValue.type),endValue:this.toPersistedDateDiscardingRange(o,null===(t=this.endValue)||void 0===t?void 0:t.type),convertArgs:this.convertArgs})}}A.MergedValueNotCalculated=Symbol("Merged value not calculated yet")},44317:(e,t,n)=>{n.d(t,{Ct:()=>a,O5:()=>s,eG:()=>i});var o=n(9291),r=n(63143);const i=(0,o.defineMessages)({year:{id:"timeUtils.durationDescriptor.intervalYear",defaultMessage:"{numYears, plural, one {1 year} other {{numYears} years}}"},week:{id:"timeUtils.durationDescriptor.intervalWeek",defaultMessage:"{numWeeks, plural, one {1 week} other {{numWeeks} weeks}}"},day:{id:"timeUtils.durationDescriptor.intervalDay",defaultMessage:"{numDays, plural, one {1 day} other {{numDays} days}}"},hour:{id:"timeUtils.durationDescriptor.intervalHour",defaultMessage:"{numHours, plural, one {1 hour} other {{numHours} hours}}"},minute:{id:"timeUtils.durationDescriptor.intervalMinute",defaultMessage:"{numMinutes, plural, one {1 minute} other {{numMinutes} minutes}}"},second:{id:"timeUtils.durationDescriptor.intervalSecond",defaultMessage:"{numSeconds, plural, one {1 second} other {{numSeconds} seconds}}"}});function a(e,t){const n=Math.floor(e/r._I),o=Math.floor(e/r.DS),a=Math.floor(e/r.A0),s=Math.floor(e/r.U6),l=Math.floor(e/r.hM),c=Math.floor(e/r.C0);return n>=1?t.formatMessage(i.year,{numYears:n}):o>=1?t.formatMessage(i.week,{numWeeks:o}):a>=1?t.formatMessage(i.day,{numDays:a}):s>=1?t.formatMessage(i.hour,{numHours:s}):l>=1?t.formatMessage(i.minute,{numMinutes:l}):t.formatMessage(i.second,{numSeconds:c})}function s(e){return Math.floor((Date.now()-e)/864e5)}},93824:(e,t,n)=>{n.d(t,{q:()=>r});n(57658);var o=n(35311);function r(e,t){const n=o.create({arrays:{detectMove:!1,includeValueOnMove:!0}}).diff(e,t);if(!n)return{beforeOps:{},removeOps:new Set};let r=[],i=[];for(const o in n)"_t"!==o&&("_"===o[0]?r.push(parseInt(o.slice(1),10)):1===n[o].length&&i.push({index:parseInt(o,10),value:n[o][0]}));const a={},s=new Set,l=[...e];r=r.sort(((e,t)=>e-t));for(let o=r.length-1;o>=0;o--){const e=r[o],t=l.splice(e,1)[0];s.add(t)}i=i.sort(((e,t)=>e.index-t.index));for(let o=0;o<i.length;o++){const e=i[o];a[e.value]=l[e.index],l.splice(e.index,0,e.value)}return{beforeOps:a,removeOps:s}}},76837:(e,t,n)=>{n.d(t,{XJ:()=>ne,J_:()=>te,PZ:()=>Y,nM:()=>W,eb:()=>$});n(57658),n(21703),n(92996);var o=n(3865),r=n(28751),i=n(41432),a=n(76205),s=n(14714),l=n(99036),c=n(1274),d=n(68955),u=n(46227);const p="415fc269-e68f-4da0-b3e3-b1273b741a7f";n(42509);var m=n(89789),f=n(59753),g=(n(482),n(4615)),h=n(98963),v=n(18844),b=n(21202),y=n(70203);function _(e){var t;const{blockValue:n,factoryButtonDeprecationContext:o,source:r}=e,i=function(e){return f.kk.fromValue(b.iU,e).getCreatedByPointer()??{id:m.P_.id,table:m.P_.table}}(n),a=n.space_id,s=(0,g.ZP)(),l=(0,g.ZP)(),c=o.isRootBlockFactoryBlock&&o.isCurrentBlockRootBlock?o.rootTextContainerId:(0,g.ZP)(),d=function(e){const{automationActionId:t,textContainerBlockId:n,creatorPointer:o,originalBlockValue:r,spaceId:i,blockContent:a}=e;return{table:b.iU,value:{id:n,space_id:i,alive:!0,parent_table:v.Xj,parent_id:t,type:"text",version:0,content:a,created_time:r.created_time,created_by_table:o.table,created_by_id:o.id}}}({automationActionId:l,textContainerBlockId:c,creatorPointer:i,originalBlockValue:n,blockContent:"duplication"===r?null===(t=n.content)||void 0===t?void 0:t.map((t=>e.pointerMapper({id:t,table:b.iU}).id)):n.content,spaceId:a}),u=function(e){const{automationId:t,automationActionId:n,spaceId:o,textContainerBlockId:r}=e;return{table:v.Xj,value:{id:n,space_id:o,alive:!0,parent_table:h.cv,parent_id:t,type:"duplicate_blocks",blocks:[r],version:0,config:void 0}}}({automationActionId:l,automationId:s,creatorPointer:i,originalBlockValue:n,spaceId:a,textContainerBlockId:c}),p=function(e){var t;const{creatorPointer:n,automationActionId:o,originalBlockValue:r,spaceId:i,automationId:a}=e,s=(0,g.ZP)(),l=Date.now();return{table:h.cv,value:{id:a,space_id:i,alive:!0,trigger:{id:s,type:"button"},parent_id:r.id,parent_table:b.iU,action_ids:[o],status:"active",properties:{name:(0,y.QaF)(null===(t=r.properties)||void 0===t?void 0:t.title)},created_by_id:n.id,created_by_table:n.table,created_time:r.created_time??l,last_edited_time:r.last_edited_time??l,version:0,last_edited_by_id:r.last_edited_by_id??n.id,last_edited_by_table:r.last_edited_by_table??n.table}}}({automationActionId:l,automationId:s,creatorPointer:i,originalBlockValue:n,spaceId:a});return{textContainerBlock:d,automation:p,automationAction:u}}var S=n(6695),w=n(35102),k=n(76218),I=n(68626),C=n(59730),x=n(64572),T=n(72126),M=n(77337),P=n(63306),A=n(87479),R=n(72141),D=n(71644),E=n(74446),B=n(45953),F=n(606),O=n(77420),Z=n(6287),V=n(13493),U=n(70279),N=n(33709),L=n(80396),j=n(23867),z=n(91644),q=n(97880),H=n(63143);function W(e){const t=$([y.V3y(e)]);return y.QaF(t)}function K(e){if(e.length<3||!e.startsWith("(")||!e.endsWith(")"))return;const t=e.substring(1,e.length-1),n=parseInt(t),o=!Number.isNaN(n)&&n>0&&function(e){return Boolean(e.match(/^[1-9][0-9]*$/))}(t);return o?n:void 0}function G(e){const t=e=>`(${e})`,{title:n,digit:o}=function(e){const t=e.trimEnd(),n=t.split(" "),o=K(n[n.length-1]);let r=t;if(void 0!==o){const e=n.slice(0,n.length-1).join(" ");r=e.length>0?e:void 0}return{title:r,digit:o}}(e[0]),r=void 0===n?"":`${n.trimEnd()} `,i=t(void 0===o?1:o+1);return y.V3y(`${r}${i}`)}function $(e){const t=y.QaF(e);if(0===t.trim().length||void 0===e)return[y.V3y(t)];const n=e[e.length-1];if(y.QJH(n)){return[...e.slice(0,e.length-1),G(n)]}return[...e,G([""])]}function Q(e){return(t=e.table)===b.iU||t===Z.v||t===V.n||t===N.qF||t===U.x_||t===L.yo||t===h.cv||t===v.Xj||t===z.AT;var t}function Y(e){const{sourceBlockId:t,targetBlockPointer:n,recordMap:o,options:r,baseUrl:i,publicDomainName:a,actor:s,getRecordRole:l}=e,c=e.recordPointerMap||B.Ao.create();for(const{pointer:f}of o){const e=f.id===t?n:c.get(f)||{spaceId:n.spaceId,table:f.table,id:(0,g.ZP)()};c.set(f,e)}const d=B.Ak.create(),u=e=>{let{requested:t}=e;return c.get(t)},p=o.getModel({id:t,table:b.iU}),m=p?function(e){const t="duplication",n=new Map;let o;return"factory"===e.type?(o={type:t,isRootBlockFactoryBlock:!0,isCurrentBlockRootBlock:!1,factoryBlockIdToNewTextContainerIdMap:n,rootTextContainerId:(0,g.ZP)()},o.factoryBlockIdToNewTextContainerIdMap.set(e.id,{id:o.rootTextContainerId,table:b.iU})):o={type:t,isRootBlockFactoryBlock:!1,factoryBlockIdToNewTextContainerIdMap:n},o}(p):void 0;for(const{pointer:f,model:g}of o){if(void 0===g)continue;if(!Q(g))continue;if(!(null!=r&&r.duplicateDiscussions||f.table!==N.qF&&f.table!==U.x_&&f.table!==L.yo))continue;const e=Boolean((null==r?void 0:r.resolveTemplateVariables)&&re({rootSourceBlockIds:[t],childSourcePointer:f,getSourceRecordValue:E.mF.fromRecordMap(o)}))?{...r,resolveTemplateVariables:!1}:r;null!=m&&m.isRootBlockFactoryBlock&&(m.isCurrentBlockRootBlock=g.id===t);const{duplicateRecord:c,additionalRecords:p}=J({table:g.table,record:g.__IM_SORRY__getValue(),mapper:u,options:e,rewiredUriMap:{},typedCollectionViewBlocks:[],originOptions:{baseUrl:i,publicDomainName:a},actor:s,getRecordRole:l,factoryButtonDeprecationContext:m});if(void 0!==c){if(g.table===b.iU&&c.id===n.id){const e=c;delete e.parent_id,delete e.parent_table,delete e.alive}X({duplicateRecordMap:d,duplicateRecordResult:{duplicateRecord:c,additionalRecords:p,duplicateRecordTable:g.table}})}}return{duplicateRecordMap:d,originalToDuplicate:c}}function X(e){const{duplicateRecordResult:t,duplicateRecordMap:n}=e,{additionalRecords:o,duplicateRecord:r,duplicateRecordTable:i}=t;n.setValue(F.dr.fromPointerLike({table:i,id:r.id}),r);for(const a of o)n.setValue(F.dr.fromPointerLike({id:a.value.id,table:a.table}),a.value)}function J(e){const{table:t,record:n,mapper:o,options:r,originOptions:a,actor:c,helperRecordMap:m,getRecordRole:k,rewiredUriMap:I,typedCollectionViewBlocks:x,factoryButtonDeprecationContext:M}=e,P=T.Xh(n),E=o({requested:F.dr.fromPointerLike({table:t,id:n.id,spaceId:n.space_id}),requester:F.dr.fromPointerLike({table:t,id:n.id})});if(void 0===E)throw new C.D3(`Failed to duplicate record ${n.id}`);P.id=E.id,P.space_id=(0,j.C)(E.spaceId);const B=[];if(t===b.iU){const e=P,{additionalRecords:t}=function(e){var t,n,o,r,a,s,l;const{originalBlock:c,duplicateBlock:m,mapper:v,options:w,originOptions:k,rewiredUriMap:I,typedCollectionViewBlocks:C,actor:x,helperRecordMap:M,factoryButtonDeprecationContext:P}=e;if(("transclusion_reference"===c.type||"transclusion_container"===c.type&&!w.deepCopyTransclusionContainers)&&Boolean(null===(t=c.format)||void 0===t?void 0:t.use_crdt)!==Boolean(w.blocksShouldUseCrdt)){const e=Boolean(w.blocksShouldUseCrdt),t=e=>e?"CRDT":"non-CRDT";m.type="callout",m.properties={title:[[`Cannot duplicate a ${t(!e)} ${c.type} block into a ${t(e)} parent`]]},m.format={block_color:"red_background",page_icon:"🚨"},delete m.content}const D={table:b.iU,id:c.id,spaceId:c.space_id};null!==(n=c.format)&&void 0!==n&&n.app_config_uri&&null!==(o=m.format)&&void 0!==o&&o.app_config_uri&&((0,S.iA)(c.format.app_config_uri)?m.format.app_config_uri=void 0:((0,i.dM)(m.type)&&C.push(m.id),I[c.id]=m.id));const E=[];if(null!==(r=m.format)&&void 0!==r&&r.use_crdt&&m.format.text_slice_tree&&m.format.text_clocks){const e=d.Z.deserialize(m.format.text_slice_tree).getTextValue();m.properties={...m.properties,title:e&&y.VrM(e)>0?e:void 0}}if(m.format){const{use_crdt:e,text_slice_tree:t,text_clocks:n,...o}=m.format;m.format=o}if("factory"===m.type&&P){const{automation:e,automationAction:t,textContainerBlock:n}=_({blockValue:m,source:"duplication",pointerMapper:e=>v({requested:e,requester:D})??e,factoryButtonDeprecationContext:P});E.push(e,t,n),P.factoryBlockIdToNewTextContainerIdMap.set(c.id,{id:n.value.id,table:b.iU});const o=m;o.type="button",o.content=[],o.format={...o.format,automation_id:e.value.id}}(0,g.e)(c.id)&&(m.format||(m.format={}),m.format.copied_from_pointer={table:b.iU,id:c.id,spaceId:c.space_id},m.copied_from=c.id);const B=(c.parent_table===b.iU?null==P?void 0:P.factoryBlockIdToNewTextContainerIdMap.get(c.parent_id):void 0)??v({requested:{table:m.parent_table,id:m.parent_id,spaceId:m.space_id},requester:D});B&&(m.parent_id=B.id);const U=m;if(U.content){var L;if(U.content=U.content.map((e=>{var t;return(null===(t=v({requested:{table:b.iU,id:e},requester:D}))||void 0===t?void 0:t.id)||e})),m.space_id===p&&null!==(L=m.properties)&&void 0!==L&&L.title){var z,W,K;const e=(0,y.lzi)(null===(z=m.properties)||void 0===z?void 0:z.title);e&&e.length>0&&e[0].length>0&&null!==(W=e[0][0])&&void 0!==W&&null!==(W=W.trim())&&void 0!==W&&W.startsWith("🎲")&&null!==(K=e[0][0])&&void 0!==K&&null!==(K=K.trim())&&void 0!==K&&K.endsWith("🎲")&&(U.content=T.TV(U.content))}}null!==(a=m.format)&&void 0!==a&&a.ai_instructions_page_pointer&&(m.format.ai_instructions_page_pointer=v({requested:m.format.ai_instructions_page_pointer,requester:D}));null!==(s=m.format)&&void 0!==s&&s.ai_skill_pointer&&(m.format.ai_skill_pointer=v({requested:m.format.ai_skill_pointer,requester:D}));const G=m;G.view_ids&&(G.view_ids=G.view_ids.map((e=>{var t;return(null===(t=v({requested:{table:V.n,id:e,spaceId:G.space_id},requester:D}))||void 0===t?void 0:t.id)||e})));const $=f.kk.fromBlock(G).getCollectionPointer();if($){var Q;if(null==M||null===(Q=M.getValue($))||void 0===Q||null===(Q=Q.format)||void 0===Q?void 0:Q.bot_id)G.collection_id=$.id,G.format={...G.format,collection_pointer:$};else{const e=v({requested:$,requester:D})||$;if(e.table!==Z.v)throw new Error(`Collection pointer for duplicate collection is invalid: ${JSON.stringify(e)}`);G.collection_id=e.id,G.format={...G.format,collection_pointer:e}}}m.discussions&&(w.duplicateDiscussions?m.discussions=m.discussions.map((e=>{var t;return(null===(t=v({requested:F.dr.fromPointerLike({table:N.qF,id:e,spaceId:m.space_id}),requester:D}))||void 0===t?void 0:t.id)||e})):delete m.discussions);if(m.permissions){var Y;if(w.duplicatePermissions)m.permissions=function(e){const{block:t,targetSpaceSettings:n,targetTeamSettings:o}=e;return(t.permissions||[]).filter((e=>!(0,R.FB)(e)&&(!(0,R.hV)(e)&&((!(!o&&n.disablePublicAccess||o&&o.disable_public_access)||!(0,R.$D)(e))&&!((!o&&n.disableGuests||o&&o.disable_guests)&&(0,R.jg)(e)&&!(0,A.RT)({spacePermissions:n.permissions||[],userId:e.user_id,botId:void 0}))))))}({block:m,targetSpaceSettings:w.duplicatePermissions.targetSpaceSettings,targetTeamSettings:null===(Y=w.duplicatePermissions)||void 0===Y?void 0:Y.targetTeamSettings});else delete m.permissions}m.content_classification&&delete m.content_classification;m.moved&&delete m.moved;m.properties||(m.properties={});for(const i in m.properties){const e=w.duplicateDiscussions?m.properties[i]:y.OAI(m.properties[i]);m.properties[i]=e}m.ignore_block_count&&delete m.ignore_block_count;if(m.properties)for(const i of Object.keys(m.properties)){const e=m.properties[i];e&&(m.properties[i]=oe({...k,text:{value:e,spaceId:(0,j.C)(m.space_id)},mapper:v,requester:D,resolveTemplateVariables:w.resolveTemplateVariables||!1}))}if("transclusion_reference"===m.type&&w.deepCopyTransclusionContainers){const e=m;if(e.format&&e.format.transclusion_reference_pointer){const t=e.format.transclusion_reference_pointer,n=v({requested:t,requester:D});n&&(e.format.transclusion_reference_pointer=n)}}if("transclusion_container"===m.type&&!w.deepCopyTransclusionContainers){const e=m;e.type="transclusion_reference",e.content=void 0;const t=e.format||{};t.transclusion_reference_pointer=D,e.format=t}if("alias"===m.type&&m.format&&m.format.alias_pointer){const e=m.format.alias_pointer,t=v({requested:e,requester:D});t&&(m.format.alias_pointer=t)}m.type===i.Ti.externalObjectInstancePage&&(m.type=i.Ti.externalObjectInstance);if(m.type===i.Ti.externalObjectInstance){var X,J,ee;if(null!==(X=m.format)&&void 0!==X&&X.related_external_object_uris_to_instance_ids&&(m.format.related_external_object_uris_to_instance_ids=(0,H.m8)((0,q.qP)(m.format.related_external_object_uris_to_instance_ids).map((e=>{var t;let[n,o]=e;return[n,(null===(t=v({requested:{table:b.iU,id:o,spaceId:G.space_id},requester:D}))||void 0===t?void 0:t.id)||o]})))),w.convertExternalObjectInstancesToPlaceholders&&(null===(J=m.format)||void 0===J||!J.is_placeholder)&&null!==(ee=m.format)&&void 0!==ee&&ee.bot_id){const e=null==M?void 0:M.getValue({table:O.cZ,id:m.format.bot_id}),t=null==e?void 0:e.integration_id;if(t){const e={is_placeholder:!0,integration_id:t};m.format=e}}}m.file_ids&&function(e){var t;const n=JSON.stringify(e.properties);e.file_ids=null==e||null===(t=e.file_ids)||void 0===t?void 0:t.filter((t=>{var o,r,i,a,s,l;return!(null===(o=e.format)||void 0===o||!o.display_source||-1===(null===(r=e.format)||void 0===r||null===(r=r.display_source)||void 0===r?void 0:r.indexOf(t)))||(!(null===(i=e.format)||void 0===i||!i.page_cover||-1===(null===(a=e.format)||void 0===a||null===(a=a.page_cover)||void 0===a?void 0:a.indexOf(t)))||(!(null===(s=e.format)||void 0===s||!s.page_icon||-1===(null===(l=e.format)||void 0===l||null===(l=l.page_icon)||void 0===l?void 0:l.indexOf(t)))||-1!==n.indexOf(t)))}))}(m);if(null!==(l=m.format)&&void 0!==l&&l.automation_id){const e=v({requested:{table:h.cv,id:m.format.automation_id,spaceId:m.space_id},requester:D});e&&(m.format.automation_id=e.id)}"collection"===c.parent_table&&c.type===i.Ti.copyIndicator&&m.properties&&(0,q.Yd)(m.properties).length>0&&(m.type=i.Ti.page);if(w.blocksShouldUseCrdt){const e=u.ZP.createEmpty(m.id);m.properties.title&&y.VrM(m.properties.title)>0&&(e.insertTextValue(0,m.properties.title),m.properties.title=e.getTextValue()),m.format={...m.format,use_crdt:!0,text_slice_tree:d.Z.serialize(e),text_clocks:d.Z.serializeClocks(e)}}if(!w.preserveSourceMetadataTimestamps){const e=Date.now();m.created_time=e,m.last_edited_time=e}x&&(m.last_edited_by_id=x.id,m.last_edited_by_table=x.table,m.created_by_id=x.id,m.created_by_table=x.table);return{duplicateRecord:m,additionalRecords:E}}({originalBlock:n,duplicateBlock:e,mapper:o,options:r??{},rewiredUriMap:I,typedCollectionViewBlocks:x,originOptions:a,actor:c,helperRecordMap:m,factoryButtonDeprecationContext:M});B.push(...t)}else if(t===Z.v){!function(e,t,n,o,r){var i,a,s,c;const d={table:Z.v,id:e.id,spaceId:e.space_id};null!==(i=e.format)&&void 0!==i&&i.app_config_uri&&(r[e.id]=t.id);if((0,g.e)(e.id)){if(t.format||(t.format={}),t.format.copied_from_pointer={table:Z.v,id:e.id,spaceId:e.space_id},void 0!==t.format.collection_default_template&&"empty"!==t.format.collection_default_template){const e=n({requested:{table:b.iU,id:t.format.collection_default_template.template_page_id},requester:d});e&&(t.format.collection_default_template={template_page_id:e.id})}t.copied_from=e.id}const u=n({requested:{table:t.parent_table,id:t.parent_id},requester:d});u&&(t.parent_id=u.id);const p=l.oC(t);for(const g in p){const r=p[g];if(r&&"relation"===r.type&&l.j0(r)){const e=n({requested:l.j0(r),requester:d});e?(r.collection_id=e.id,r.collection_pointer={id:e.id,table:Z.v,spaceId:(0,j.C)(e.spaceId)}):r.property&&(r.property=(0,D.ZP)())}var m;if(r&&"title"===r.type&&t.name&&(t.name=oe({...o,text:{value:t.name,spaceId:t.space_id},mapper:n,requester:d,resolveTemplateVariables:!1})),r&&"button"===r.type&&r.automation_id)r.automation_id=(null===(m=n({requested:{id:r.automation_id,spaceId:e.space_id,table:h.cv},requester:d}))||void 0===m?void 0:m.id)??r.automation_id}t.description&&(t.description=oe({...o,text:{value:t.description,spaceId:t.space_id},mapper:n,requester:d,resolveTemplateVariables:!1}));for(const l in p){const e=p[l];if(!e||"formula"!==e.type||"v2"!==e.version||!e.formula2)continue;const t=(0,w.Wo)(e.formula2.code,n,d);e.formula2.code=t}t.template_pages&&(t.template_pages=t.template_pages.map((e=>{var t;return(null===(t=n({requested:{table:b.iU,id:e},requester:d}))||void 0===t?void 0:t.id)||e})));if(null!==(a=t.format)&&void 0!==a&&a.collection_mode&&"page_tree"===t.format.collection_mode.type){var f;const e=t.format.collection_mode.root_page_pointer,o=(null===(f=n({requested:F.dr.fromPointerLike({table:"block",id:e.id,spaceId:t.space_id}),requester:d}))||void 0===f?void 0:f.id)||e.id;t.format.collection_mode={type:"page_tree",root_page_pointer:{id:o,table:"block",spaceId:t.space_id}}}null!==(s=t.format)&&void 0!==s&&s.related_external_object_uris_to_instance_ids&&(t.format.related_external_object_uris_to_instance_ids=(0,H.m8)((0,q.qP)(t.format.related_external_object_uris_to_instance_ids).map((e=>{var o;let[r,i]=e;return[r,(null===(o=n({requested:{table:Z.v,id:i,spaceId:t.space_id},requester:d}))||void 0===o?void 0:o.id)||i]}))));delete t.deleted_schema,null!==(c=t.format)&&void 0!==c&&c.automation_ids&&(t.format.automation_ids=t.format.automation_ids.map((e=>{var o;return null===(o=n({requested:{id:e,table:h.cv,spaceId:t.space_id},requester:d}))||void 0===o?void 0:o.id})).filter(q.$K))}(n,P,o,a,I)}else if(t===V.n){!function(e,t,n,o,r){var i,a,l,c,d,u;const p={table:V.n,id:e.id,spaceId:e.space_id};null!==(i=e.format)&&void 0!==i&&i.app_config_uri&&null!==(a=t.format)&&void 0!==a&&a.app_config_uri&&((0,S.iA)(e.format.app_config_uri)?t.format.app_config_uri=void 0:o[e.id]=t.id);const m=null===(l=t.format)||void 0===l?void 0:l.collection_pointer;if(m){const e=null==r?void 0:r.getModel(m);if(!Boolean(null==e?void 0:e.isSyncedCollection())){const e=n({requested:m,requester:p})||m;t.format={...t.format,collection_pointer:e}}}if(t.format){var f;const e=null===(f=t.format.collection_groups)||void 0===f?void 0:f.map((e=>{if("relation"===e.value.type&&(0,s.RA)(e.value.value)&&e.value.value){return{...e,value:{type:"relation",value:n({requested:e.value.value,requester:p})}}}return e}));if(t.format.collection_groups=e,void 0!==t.format.collection_view_default_template&&"empty"!==t.format.collection_view_default_template){const e=n({requested:{table:b.iU,id:t.format.collection_view_default_template.template_page_id},requester:p});e&&(t.format.collection_view_default_template={template_page_id:e.id})}}const g=n({requested:{table:t.parent_table,id:t.parent_id,spaceId:t.space_id},requester:p});g&&(t.parent_id=g.id);t.page_sort&&(t.page_sort=t.page_sort.map((e=>{var o;return(null===(o=n({requested:{table:b.iU,id:e,spaceId:t.space_id},requester:p}))||void 0===o?void 0:o.id)||e})));if("page"===t.type&&null!==(c=t.format)&&void 0!==c&&c.page_pointer){var h;const e=t.format.page_pointer,o=(null===(h=n({requested:F.dr.fromPointerLike({table:"block",id:e.id,spaceId:t.space_id}),requester:p}))||void 0===h?void 0:h.id)||e.id;t.format.page_pointer={table:"block",id:o,spaceId:t.space_id}}if(null!==(d=t.format)&&void 0!==d&&d.property_filters){const e=t.format.property_filters;for(const t of e)t.filter&&ee(t.filter,(e=>{var t;return null===(t=n({requested:e,requester:p}))||void 0===t?void 0:t.id}))}if(null!==(u=t.format)&&void 0!==u&&u.filters2){const e=t.format.filters2;for(const t of e)t.filter&&ee(t.filter,(e=>{var t;return null===(t=n({requested:e,requester:p}))||void 0===t?void 0:t.id}))}const v=t.query2;v&&v.filter&&ee(v.filter,(e=>{var t;return null===(t=n({requested:e,requester:p}))||void 0===t?void 0:t.id}))}(n,P,o,I,m)}else t===N.qF?function(e,t,n,o){const r={table:N.qF,id:e.id,spaceId:e.space_id},i=n({requested:{table:t.parent_table,id:t.parent_id,spaceId:t.space_id},requester:r});i&&(t.parent_id=i.id);t.comments&&(t.comments=t.comments.map((e=>{var o;return(null===(o=n({requested:{table:U.x_,id:e,spaceId:t.space_id},requester:r}))||void 0===o?void 0:o.id)||e})));t.context&&(t.context=oe({...o,text:{value:t.context,spaceId:t.space_id},mapper:n,requester:r,resolveTemplateVariables:!1}))}(n,P,o,a):t===U.x_?function(e,t,n,o){const r={table:U.x_,id:e.id,spaceId:e.space_id},i=n({requested:F.dr.fromPointerLike({table:t.parent_table,id:t.parent_id,spaceId:t.space_id}),requester:r});i&&(t.parent_id=i.id);t.text&&(t.text=oe({...o,text:{value:t.text,spaceId:t.space_id},mapper:n,requester:r,resolveTemplateVariables:!1}));if(t.content)for(const[s,l]of t.content.entries()){var a;const e=(null===(a=n({requested:F.dr.fromPointerLike({table:b.iU,id:l,spaceId:t.space_id}),requester:r}))||void 0===a?void 0:a.id)??l;t.content[s]=e}}(n,P,o,a):t===L.yo?function(e,t,n,o){const r={table:L.yo,id:e.id,spaceId:e.space_id},i=n({requested:F.dr.fromPointerLike({table:t.parent_table,id:t.parent_id,spaceId:t.space_id}),requester:r});i&&(t.parent_id=i.id)}(n,P,o):t===h.cv?te({originalRecord:n,duplicateRecord:P,mapper:o,options:r??{},actor:c}):t===v.Xj?ne({originalRecord:n,duplicateRecord:P,mapper:o,getRecordRole:k,options:r??{},originOptions:a}):t===z.AT?function(e){let{original:t,duplicate:n,mapper:o,originOptions:r}=e;const i={table:z.AT,id:t.id,spaceId:t.space_id},a=o({requested:F.dr.fromPointerLike({table:n.parent_table,id:n.parent_id,spaceId:n.space_id}),requester:i});a&&(n.parent_id=a.id)}({original:n,duplicate:P,mapper:o,originOptions:a}):(0,q.t1)(t);return{duplicateRecord:P,additionalRecords:B}}function ee(e,t){if(a.vA(e)){(e.filters||[]).forEach((e=>ee(e,t)))}if(a.aN(e)){if(a.e(e.filter)){const n=e.filter;if("relation_contains"===n.operator||"relation_does_not_contain"===n.operator)if(Array.isArray(n.value)){const e=n.value.map((e=>{const n=e.type;if("exact"===n){const n=e.value;return{type:"exact",value:n&&t({table:b.iU,id:n})||n}}if("relative"===n)return e;(0,q.t1)(n)}));n.value=e}else{const e=n.value.type;if("exact"===e){const e=n.value.value;n.value.value=e&&t({table:b.iU,id:e})||e}else{if("relative"===e)return;(0,q.t1)(e)}}}if(a.a_(e.filter)){const n=e.filter.subfilter;if(a.e(n)){const e=n;if("relation_contains"===e.operator||"relation_does_not_contain"===e.operator)if(Array.isArray(e.value)){const n=e.value.map((e=>{const n=e.type;if("exact"===n){const n=e.value;return{type:"exact",value:n&&t({table:b.iU,id:n})||n}}if("relative"===n)return e;(0,q.t1)(n)}));e.value=n}else{const n=e.value.type;if("exact"===n){const n=e.value.value;e.value.value=n&&t({table:b.iU,id:n})||n}else{if("relative"===n)return;(0,q.t1)(n)}}}}}}function te(e){var t;const{originalRecord:n,duplicateRecord:r,mapper:i,options:a,actor:s}=e,l=F.dr.fromSpaceShardRecordId({id:n.id,spaceId:n.space_id},h.cv),c=(null===(t=i({requested:F.dr.fromPointerLike({table:r.parent_table,id:r.parent_id,spaceId:r.space_id}),requester:l}))||void 0===t?void 0:t.id)??r.parent_id;r.parent_id=c;const d=(r.action_ids??[]).map((e=>{var t;return(null===(t=i({requested:F.dr.fromPointerLike({table:v.Xj,id:e,spaceId:r.space_id}),requester:l}))||void 0===t?void 0:t.id)??e}));r.action_ids=d;const u=Date.now();r.created_time=u,r.last_edited_time=u,(0,q.$K)(s)&&(r.created_by_id=s.id,r.created_by_table=s.table,r.last_edited_by_id=s.id,r.last_edited_by_table=s.table),(0,o.Q9)(r)&&a.shouldDisableRecurrenceAutomation&&(r.status="disabled"),(0,o.Vd)(r)&&function(e){var t;const{duplicateRecord:n,mapper:o,originalRecord:r}=e,i={id:r.id,spaceId:r.space_id,table:h.cv},a={sourceAutomationParentId:r.parent_id,sourceAutomationId:r.id,sourceAutomationName:(null===(t=r.properties)||void 0===t?void 0:t.name)??""},s=n.trigger.event.source;if((0,q.$K)(s))if("collection"===s.type){const e=o({requested:s.pointer,requester:i});e?e.table!==Z.v?(I.log({data:{miscDataToConvertToString:{...a,duplicateAutomationTriggerTable:e.table}},from:"duplicateHelpers.duplicateAutomationEventValueHelper",level:"info",type:"duplicateAutomationIncorrectTriggerTableCollection"}),n.trigger.event.source=void 0,n.status="disabled"):(0,q.$K)(e.spaceId)&&e.spaceId===n.space_id?s.pointer={...e,spaceId:n.space_id}:(I.log({data:{miscDataToConvertToString:{...a,duplicateAutomationTriggerSpaceId:e.spaceId,sourceAutomationSpaceId:n.space_id}},from:"duplicateHelpers.duplicateAutomationEventValueHelper",level:"info",type:"duplicateAutomationMissingTriggerCollectionSpaceId"}),n.trigger.event.source=void 0,n.status="disabled"):(I.log({data:{miscDataToConvertToString:{...a,sourceAutomationTriggerSourceId:s.pointer.id}},from:"duplicateHelpers.duplicateAutomationEventValueHelper",level:"info",type:"duplicateAutomationMissingTriggerCollectionSource"}),n.trigger.event.source=void 0,n.status="disabled")}else if("collection_view"===s.type){const e=o({requested:s.pointer,requester:i});e?e.table!==V.n?(I.log({data:{miscDataToConvertToString:{...a,duplicateAutomationTriggerTable:e.table}},from:"duplicateHelpers.duplicateAutomationEventValueHelper",level:"info",type:"duplicateAutomationIncorrectTriggerCollectionViewTable"}),n.trigger.event.source=void 0,n.status="disabled"):(0,q.$K)(e.spaceId)&&e.spaceId===n.space_id?s.pointer={...e,spaceId:n.space_id}:(I.log({data:{miscDataToConvertToString:{...a,duplicateAutomationTriggerSpaceId:e.spaceId,sourceAutomationSpaceId:n.space_id}},from:"duplicateHelpers.duplicateAutomationEventValueHelper",level:"info",type:"duplicateAutomationMissingTriggerCollectionSpaceId"}),n.trigger.event.source=void 0,n.status="disabled"):(I.log({data:{miscDataToConvertToString:{...a,sourceAutomationTriggerSourceId:s.pointer.id}},from:"duplicateHelpers.duplicateAutomationEventValueHelper",level:"info",type:"duplicateAutomationMissingTriggerCollectionView"}),n.trigger.event.source=void 0,n.status="disabled")}else"filter"===s.type||(0,q.t1)(s);else I.log({data:{miscDataToConvertToString:a},from:"duplicateHelpers.duplicateAutomationEventValueHelper",level:"info",type:"duplicateAutomationMissingTriggerSource"}),n.status="disabled"}({duplicateRecord:r,mapper:i,originalRecord:n})}function ne(e){const{originalRecord:t,duplicateRecord:n,mapper:o,getRecordRole:i,options:a,originOptions:s}=e,l=t.space_id!==n.space_id,d={table:v.Xj,id:t.id,spaceId:t.space_id},u=o({requested:F.dr.fromPointerLike({table:n.parent_table,id:n.parent_id,spaceId:n.space_id}),requester:d});let p=i;!function(e){const{automationAction:t,mapper:n,options:o}=e;if(!t.config)return;const r=(e,t)=>({spaceId:t.spaceId,...n({id:t.id,table:t.table,spaceId:t.spaceId}),table:e});if("create_page"===t.type){if(t.config.collection&&(t.config.collection=r(Z.v,t.config.collection)),t.config.template_page_id){(null==o?void 0:o.isTemplateInstantiation)&&o.sourceBlockIds.has(t.config.template_page_id)||(t.config.template_page_id=r(b.iU,{id:t.config.template_page_id,table:b.iU,spaceId:t.space_id}).id)}}else if("query_collection"===t.type)t.config.collection&&(t.config.collection=r(Z.v,t.config.collection));else if("update_pages"===t.type){const e=t.config.target;e&&("collection"===e.type?(e.collection=r(Z.v,e.collection),e.filter&&ee(e.filter,(e=>{var t;return null===(t=n(e))||void 0===t?void 0:t.id}))):"variable"===e.type||("page"===e.type?e.page=r(b.iU,e.page):(0,q.t1)(e)))}else if("open_page"===t.type){const e=t.config.target;e&&("page"===e.type?e.page=r(b.iU,e.page):"variable"===e.type||(0,q.t1)(e))}else"complete_sprint"===t.type||"duplicate_blocks"===t.type||"modal_confirmation"===t.type||"slack_notification"===t.type||"assistant"===t.type||(0,q.t1)(t)}({automationAction:n,mapper:e=>{const t=o({requester:d,requested:e});return t?(p=E.DH.tryUntilFound(E.DH.constantForPointer(t,"editor"),p),t):l?(p=E.DH.tryUntilFound(E.DH.constantForPointer(e,"none"),p),e):e},options:a.resolveAutomationConfig}),function(e){const{automationAction:t,requester:n,mapper:o,originOptions:i}=e,a=(0,r.z)(t.type);function s(e){const r=(0,w.MY)(e);if("action"===r.source){var i;const e=(null===(i=o({requester:n,requested:{id:r.action_id,table:v.Xj,spaceId:t.space_id}}))||void 0===i?void 0:i.id)??r.action_id;return(0,w.Kd)({...r,action_id:e})}if("global"===r.source)return e;(0,q.t1)(r)}const l=f.kk.fromValue(v.Xj,t),c=a.acceptFormulaVisitor({action:l,visitor:{visitFormula:e=>{const r=(0,k.Zw)(e,s);let a;return a=r.value?{...r,value:oe({...i,text:{value:r.value,spaceId:t.space_id},mapper:o,requester:n,resolveTemplateVariables:!1})}:r,{type:"replace",value:a}},visitVariableOutsideOfFormula:e=>({type:"replace",value:s(e)})}}),d=B.Ak.create();d.setValue(l.pointer,t),(0,M.FS)({recordMap:d,operations:c,updateOnly:!1});const u=d.getModel(l.pointer);if(!u)throw new Error("Updated automation action not found in record map");t.config=u.getConfig()}({automationAction:n,mapper:o,requester:d,originOptions:s});const m=(null==u?void 0:u.id)??n.parent_id;n.parent_id=m,l&&"slack_notification"===n.type&&(n.config={});const g=(0,c.o0)(n);if(g){g.some((e=>{const t=p(e.pointer);return!t||!(0,A.yY)(t,e.minimumRequiredRole)}))&&(n.config={})}const h=(n.blocks??[]).map((e=>{var t;return null===(t=o({requested:F.dr.fromPointerLike({table:b.iU,id:e,spaceId:n.space_id}),requester:d}))||void 0===t?void 0:t.id})).filter(q.$K);n.blocks=h.length>0?h:void 0}function oe(e){const{text:t,mapper:n,requester:o,resolveTemplateVariables:r,baseUrl:i,publicDomainName:a}=e;if(void 0!==t)return t.value.map((e=>function(e){const{token:t,mapper:n,requester:o,resolveTemplateVariables:r,baseUrl:i,publicDomainName:a}=e,s=y.hDy(t.token);let l;const c=s.map((e=>{if(y.STW(e)){const t=y.yrl(e);if(t){const e=n({requested:t,requester:o});if(e)return y.$0A(e.id,e.spaceId)}}if(y.j0F(e)){const t=y.zW$(e),r=(0,x.A5)({url:t,baseUrl:i,publicDomainName:a});if(r){const e=n({requested:{table:b.iU,id:r,spaceId:(0,j.C)(void 0)},requester:o});if(e)return y.edl((0,x.nR)({pageId:e.id}))}}if(y.nSN(e)){const t=y.frW(e);if(t){const e=n({requested:{table:b.iU,id:t,spaceId:(0,j.C)(void 0)},requester:o});if(e)return y.x36(e.id)}}if(y.xw5(e)){const r=y.h19(e),i=n({requested:{table:N.qF,id:r,spaceId:t.spaceId},requester:o});if(i)return y.jw(i.id)}if(y.aq(e)&&r){const t=y.x5L(e,r);if(t&&y.IWo(t)&&r){const e=y.zEN(t);if(e===r.currentUserId){if(l)return;l=e}}return t}if(y.IWo(e)&&r){const t=y.zEN(e);if(t===r.currentUserId){if(l)return;l=t}}return e})).filter(q.$K);return y.V3y(y.WiV(t.token),c)}({token:{token:e,spaceId:t.spaceId},mapper:n,requester:o,resolveTemplateVariables:r,baseUrl:i,publicDomainName:a})))}function re(e){const{rootSourceBlockIds:t,childSourcePointer:n,getSourceRecordValue:o}=e;for(const r of(0,P.BW)(n,o))if(ie({rootSourceBlockIds:t,recordWithTable:r}))return!0;return!1}function ie(e){const{recordWithTable:t,rootSourceBlockIds:n}=e;if(t.table!==b.iU)return t.table===v.Xj;if(n.includes(t.value.id))return!1;if(f.kk.fromBlock(t.value).isTemplateVariableContainerBlock())return!0}},40654:(e,t,n)=>{n.d(t,{A_:()=>i,XW:()=>l,lO:()=>s,to:()=>a,x_:()=>r});var o=n(72126);const r=.5,i=4.9,a=.1,s=1;function l(e){switch(o.uZ(o.NM(e,1),r,i)){case r:return 155;case.6:return 128;case.7:return 108;case.8:return 94;case.9:return 83;default:return 75}}},5220:(e,t,n)=>{n.d(t,{Hx:()=>a});var o=n(59730),r=n(90965),i=n(47425);function a(e){let{spaceModel:t,userId:n}=e;if(!t||!n)return!1;const i=function(e){const{spaceModel:t,userId:n}=e;if(!(0,r.wv)({permissions:t.getPermissionItems()},n))return new o.XV("You do not have permissions to this feature in the requested space.",{type:"generic_insufficient_permissions"});return s(t)}({spaceModel:t,userId:n});return void 0===i}function s(e){if(!(0,i.wP)(e.getSubscriptionTier()))return new o.XV("The feature is not available on your current plan type.",{type:"generic_insufficient_plan_type"})}},55632:(e,t,n)=>{n.d(t,{HX:()=>v,fK:()=>h,$A:()=>g,Jq:()=>b,j2:()=>p,Pv:()=>y,j:()=>_});var o=n(15145),r=n(74686);var i=n(68626),a=n(72126),s=n(91155),l=n(4615);var c=n(64002);const d=new o.nY((async e=>{const{config:t,deviceId:r,disableCookies:i}=e,a=await n.e(9543).then(n.t.bind(n,16791,23));return await new Promise((e=>{const n=t.amplitude&&t.amplitude.apiKey;if(!n)return e(void 0);const s=new URL(t.domainBaseUrl),d=`${s.host}${t.api.http}/teV1`;let u,p=!0;"http:"===s.protocol&&(p=!1),r&&(u=r.startsWith("w_")||r.startsWith("a_")?r.replaceAll("-",""):(0,l.XR)(r));const m=u;a.getInstance("eventTrailApi").init(n,"",{apiEndpoint:d,forceHttps:p,includeReferrer:!0,includeUtm:!0,includeFbclid:!0,includeGclid:!0,unsetParamsReferrerOnNewSession:!1,saveParamsReferrerOncePerSession:!1,storage:i?"none":"",saveEvents:!i,deviceId:m},(n=>{n&&n.setVersionName((t.env,"2023092001")),e(n),function(){const e=(0,c.gy)(window.location.href);if(!e)return;const t={utm_campaign:e.searchParams.get("utm_campaign")||o.cL,utm_content:e.searchParams.get("utm_content")||o.cL,utm_medium:e.searchParams.get("utm_medium")||o.cL,utm_source:e.searchParams.get("utm_source")||o.cL,utm_term:e.searchParams.get("utm_term")||o.cL};h({traits:(0,o.bt)({...t})})}()}))}))}));function u(e,t,n){return function(o,r,l){if(200===o&&"success"===r)return;const c=a.CE(t,"experiments"),d={data:{responseBody:r,eventName:e,eventData:c,groupData:n},statusCode:o,message:null==l?void 0:l.reason};i.log({level:"error",from:"eventTrailApiHelpers",type:"trackFailure",error:(0,s.Ui)(d)})}}async function p(e){const{config:t,isEnabled:n,deviceId:o,cookieService:a}=e,l=!(await r.ec({service:"amplitude",cookieService:a}));try{await d.load({config:t,isEnabled:n,deviceId:o,disableCookies:l})}catch(c){i.log({level:"error",from:"eventTrailApiHelpers",type:"initialize",error:(0,s.Ui)(c)})}}function m(e,t){const n=new e.Identify;if(t)for(const o of Object.keys(t)){const e=t[o];void 0!==e&&(Array.isArray(e)?n.append(o,e):n.set(o,e))}return n}function f(e,t,n){const o=t.userPropertiesOperations||{};n.logEvent(e,o,void 0,u(e,o))}async function g(e){const{userId:t,traits:n,spaceIds:o}=e,r=await d.getInstance();if(!r)return;r.setUserId((0,l.XR)(t));const i=m(r,n);o&&i.set("workspace",a.jj(o)),f("$identify_user",i,r)}async function h(e){const{traits:t}=e,n=await d.getInstance();if(!n)return;const o=new n.Identify;for(const r of t)"set"===r.operation?o.set(r.name,r.value):"setOnce"===r.operation&&o.setOnce(r.name,r.value);f("$identify_device",o,n)}async function v(){const e=await d.getInstance();null==e||e.setUserId(null)}async function b(e){const{spaceId:t,spaceData:n}=e;if(!t)return;const o=await d.getInstance();if(!o)return;const r=a.d9(n),i=Object.entries(r).filter((e=>{let[t,n]=e;return Array.isArray(n)}));i.forEach((e=>{let[t,n]=e;return delete r[t]}));var s=m(o,r);i.forEach((e=>{let[t,n]=e;return s=s.set(t,n)})),o.groupIdentify("workspace",t,s)}async function y(e){const t=await d.getInstance();t&&t.setDeviceId((0,l.XR)(e))}async function _(e){const{eventName:t,eventData:n,spaceId:o}=e,r=await d.getInstance();if(r)if(o){const e={workspace:o};r.logEventWithGroups(t,n,e,void 0,u(t,n,e))}else r.logEvent(t,n,void 0,u(t,n))}},12174:(e,t,n)=>{n.d(t,{DP:()=>h,KM:()=>m,LI:()=>w,TS:()=>v,XY:()=>y,YY:()=>I,_n:()=>C,b2:()=>_,dn:()=>S,g6:()=>r,l4:()=>b,nb:()=>x});var o=n(97880);const r={"search-vectors":["log-norm","min-max-norm","cohere-snippets"],"vector-search-vanilla-ltr":["on","force-disable"],"search-no-local-blending":["on"],"search-debug-only-no-recent-boosting":["on"],"search-shorten-inactive-timer":["0","10","30","60","90"],"search-debug-only-force-random-sample":["on"],"search-debug-force-log-signals":["on"],"search-more-recent-pages-in-local":["lazy-100","lazy-200","lazy-500","lazy-1000"],"search-intent-based-grouping-n-side-peek":["on"],"search-results-new-utilities":["on"],"search-new-local-recall-v2":["v1","v2","v3","v4"],"search-query-expansion":["prefix-completion","word-splitting","spell-correction","all"],"search-debug-force-no-rerank":["on","always-rerank"],"search-client-page-match-2":["minisearch","minisearch-frecency"],"search-rerank-new-recall":["on"],"dev-search-rerank-new-recall":["v1","v2"]},i={teams_invite_link:["on"],team_invite_link_ms2:["on"],expandable_permission_items:["on"]},a={request_edit_access:["on"]},s={simplified_email_subject_line:["on"],improved_product_notif_email_and_settings:["on"],mobile_push_notification_reply_action:["on"],inbox_2_0:["on","peek","time_grouping"],access_request_email_digest:["on"]},l={search_modal_suggested_templates:["on"],simplified_getting_started:["on"],acquisition_global_holdout_aa_testing:["on"],acq_simplify_enterprise_joiner_onboarding_flow_v1:["on"],page_invite_message:["control","variant_1","variant_2"],invitation_email_final_reminder:["on"],share_modal_placeholder:["on"],share_modal_pending_invite_status_ui:["on"],invitation_modal_guest_vs_member_tag:["on"],share_modal_guest_member_confirmation:["v1","v2"],page_invitation_email_selfserve_exp:["v1","v2","v3","v4"],space_invitation_email_selfserve_exp:["v1","v2","v3","v4"],share_modal_autofill_email:["control","v1"],humanize_page_invite_joiner_email_copy:["on"],acq_person_property_invite_v1:["on"],acq_slack_imports_invite_v1:["on"],blue_signup_buttons:["on"],space_setting_people_search_bar_expand:["on"],onboarding_language_picker:["on"],acq_simplify_joiner_onboarding_flow_v1:["on"]},c={in_app_contact_sales_cta_billing:["on"]},d={block_limit_cta_earlier:["25"],block_limit_increase:["on"],block_limit_reduction:["on"],checkout_name_required:["on"],checkout_refresh:["on"],churn_nudge:["on"],hide_block_limit:["on"],largesse:["on"],plans_page_refresh:["on"],mobile_web_subscriptions:["on"],quick_workspace_creation:["on"],subscription_payment_status:["message_only","on"],subscription_default_annual:["on"],subscription_elements:["payment_and_address","payment"],upsell_colors:["on"],upsell_to_plans_page:["on"],guest_limit_policy:["on"]},u={csv_adaptiveschema:["on"],csv_column_limit:["on"]},p={duplication_workspace_selection_modal3:["on"],show_student_org_sitebar_prompt:["on_default","on_blue"]},m=["beta","alpha","development","exploratory","wild_west"],f={assistant_variant:m},g={"indexeddb-transaction-timeout-v2":["on"],"product-page-length":["no-demo","short-scroll","shortest-scroll"],"remove-profile-photo-string":["on"],"template-checklist":["on"],mermaid:["on"],polyglot:["on"],rc:["on"],"ios-json-bridge-v2":["on"],"clear-record-cache-on-login":["on"],"await-update-user-id":["on"],aloha:["on"],"embed-previews":["on"],"beta-developers-external":["on"],"db-sync":["on"],janus:["on"],"mobile-drag-delay":["1000","600","700","800","900","1100","1200","1300","1400","1500"],"android-context-menu":["on"],"mobile-bottom-bar-ios-v4":["on"],"lucy-in-the-sky-with-tab-blocks":["on"],"messagestore-ios-v3":["on"],"home-ios":["on"],"home-ipad":["on"],"home-android":["on"],"txnqueue-ios-v6":["on"],"onboarding-emails":["generic","meeting-notes-focused"],patchExternalCollection:["on"],"emoji-apple-spritesheets":["enabled"],"default-new-page-property-to-hide-when-empty":["on"],"android-background-bridge-message-parsing":["on"],"columns-full-width":["on"],"notion-to-slack":["on"],"notion-mentions-to-slack":["on"],slash_menu_spaces_preceding:["on"],geo_ip_lookup_database:["on"],database_sync_for_google_calendar:["on"],database_sync_for_gitlab:["on"],database_sync_for_asana:["on"],enforce_enterprise_tier_for_scim:["on"],...r,...i,...a,...s,...l,...c,...d,...p,...u,"newer-primus":["on"],sort_indexeddb_tasks_by_index:["on"],marketing_home_page_hero_signup:["test","focus","work"],marketing_home_hero_text:["V1","V2","V3"],above_the_fold_product:["V1","V2","V3","V4"],marketing_contact_3_new_fields:["test"],template_gallery_web:["on"],invite_members_from_share_menu:["on"],statsig_space_id_debug:["on"],enforce_write_once_permissions_for_block_updates:["on"],"contextual-invite-on-select-focus":["on"],zendesk:["on"],collection_client_refetch_throttle_time_ms:["2000","3000","5000"],highlight_legacy_transclusions:["on"],lightbox_v2:["on"],user_similarity_debugging:["on"],log_iframely_results:["on"],iframely_switch:["on"],prompt_work_account_sidebar:["on"],request_membership:["on"],parallel_confluence_importer:["on"],parallel_confluence_importer_via_api:["on"],special_case_confluence_file_size:["on"],confluence_dynamic_batch_size_temp:["on"],confluence_server_allow_requests:["on"],confluence_logs:["on"],confluence_api_v2:["on"],confluence_search_api:["on"],send_notification_for_transfer_content:["on"],box_file_picker:["on"],guest_membership_request:["on"],link_preview_resizing:["on"],link_preview_resizing_api:["on"],google_external_integration_file_picker:["on"],enable_google_drive_external_integration:["on"],my_home:["on"],show_instruction_on_auth_popup_blocked:["on"],teamspace_guests:["on"],asana_max_task_limit:["on"],monday_importer:["on"],migrate_confluence_into_teamspace:["on"],generic_importer:["on"],slash_command_import:["on"],special_case_generic_file_size:["on"],asana_to_single_team_space:["on"],state_manangement_in_asana_importer:["on"],android_3rd_party_login_with_external_browser:["on"],ios_3rd_party_login_with_external_browser:["on"],block_limit_delay:["on"],asana_import_by_batch:["on"],intro_share_tooltip_condition:["d3","b200"],ignore_non_renderable_blocks_in_export:["on"],prioritize_slash_menu_block_placeholder:["on"],joiner_subject_line_v2:["variant_1","variant_2","variant_3"],joiner_email_facepile:["on"],slash_menu_tooltip:["on"],redirect_after_passcode_sent:["with_gmail_cta","without_gmail_cta"],wiki_education_convert_modal:["bottom_right"],avoid_empty_eoip_creation_unfurl_collection:["on"],jira_import_and_sync:["on"],block_property_item_indexing:["incremental","backfill"],block_property_item_query_prefilter:["on"],use_global_local_search_cache:["on"],...f,safari_17_transaction_queue:["force_in_memory","prefer_indexed_db"],indexeddb_graceful_fallback_to_in_memory_queue:["on"],ai_writer_autofill_gpt_4:["on"],allow_auth_with_app_browser_for_mobile:["on"],show_space_qna_suggested_questions:["on"],browser_sqlite:["on"],qna_show_page_suggested_questions:["on"],property_creation_tooltips_exp:["on"],monetizationExperiments:["on"],collection_querying:["sqlite","duckdb","eav"]};function h(e){return Boolean(g[e])}const v=new Set([]),b=["log_iframely_results","iframely_switch","database_sync_for_google_calendar","database_sync_for_gitlab","database_sync_for_asana","enforce_enterprise_tier_for_scim","slash_menu_spaces_preceding","geo_ip_lookup_database","sort_indexeddb_tasks_by_index","marketing_contact_3_new_fields","marketing_home_page_hero_signup","marketing_home_hero_text","above_the_fold_product","invite_members_from_share_menu","contextual-invite-on-select-focus","enforce_write_once_permissions_for_block_updates",...(0,o.Yd)(i),...(0,o.Yd)(a),"zendesk","highlight_legacy_transclusions","lightbox_v2","prompt_work_account_sidebar","request_membership","special_case_confluence_file_size","special_case_generic_file_size","confluence_dynamic_batch_size_temp","confluence_server_allow_requests","confluence_logs","user_similarity_debugging","send_notification_for_transfer_content","box_file_picker","google_external_integration_file_picker","guest_membership_request","link_preview_resizing","link_preview_resizing_api","enable_google_drive_external_integration","show_instruction_on_auth_popup_blocked","parallel_confluence_importer","parallel_confluence_importer_via_api","confluence_api_v2","confluence_search_api",...(0,o.Yd)(r),...(0,o.Yd)(l),...(0,o.Yd)(c),...(0,o.Yd)(d),...(0,o.Yd)(p),...(0,o.Yd)(u),"teamspace_guests","asana_max_task_limit","monday_importer","migrate_confluence_into_teamspace","generic_importer","slash_command_import","asana_to_single_team_space","state_manangement_in_asana_importer",...(0,o.Yd)(s),"android_3rd_party_login_with_external_browser","ios_3rd_party_login_with_external_browser","collection_client_refetch_throttle_time_ms","block_limit_delay","asana_import_by_batch","intro_share_tooltip_condition","ignore_non_renderable_blocks_in_export","prioritize_slash_menu_block_placeholder","joiner_subject_line_v2","joiner_email_facepile","slash_menu_tooltip","redirect_after_passcode_sent","wiki_education_convert_modal","avoid_empty_eoip_creation_unfurl_collection","jira_import_and_sync","block_property_item_indexing","block_property_item_query_prefilter","use_global_local_search_cache",...(0,o.Yd)(f),"safari_17_transaction_queue","indexeddb_graceful_fallback_to_in_memory_queue","ai_writer_autofill_gpt_4","allow_auth_with_app_browser_for_mobile","show_space_qna_suggested_questions","browser_sqlite","qna_show_page_suggested_questions","property_creation_tooltips_exp","collection_querying"],y=[...b].sort(),_=["polyglot","enforce_write_once_permissions_for_space_updates","person_vote","allow_dead_space_views_when_joining_space","throw_on_changing_unmanaged_scim_user","log_all_headers_for_unknown_scim_idp","enable_get_private_page_info_endpoint","log_saml_response_on_error","wiki_query_killswitch","fwd_wiki_to_collection_svc","debug_analytics","connected_relation","enable_search_team_filter","expiring_public_links","button_property","display_date_in_user_timezone","text_selection_completions","new_page_completions","completions_chat","triage_notification_can_read","admin_content_search_tab","japan_full_launch","event_trail_router_v2","ai_waitlist_in_app_popup","public_api_dev_mode","optimize_single_workspace","enabled_bev_default_audience_filter","sprig","ai_multi_level_undo","ai_favorites","settings_console_analytics","settings_console_content_search","autoretry_file_uploads","enable_secure_file_url_for_user","lock_on_scim_patch_group","prevent_saml_guest_login","developer_integration_form_redesign","log_on_save_transactions","return_scim_errors_to_client","use_secure_file_url_for_audit_log","use_secure_file_url_for_space_export","use_secure_file_url_for_block_export","return_404_on_scim_get_for_user_not_in_workspace","client-performance-profiler","react_18_concurrent_rendering","customerio","dev_only_show_updates_filters","property_updates_notifications","enable_notifications_processor","sidebar_pages_hide_toggles","prefetch_spaces","home_allow_change_home_enabled_flag_killswitch","sidebar_home_default_landing_gate","sidebar_home_dev_gate","sidebar_home_beta_gate","sidebar_home_ga_gate","home_redesigned_recents","home_cover_photo","team_add_app_template_tooltip","new_share_menu_tooltip","optimize_fetch_user_content_emit","space_settings_people_section","tips_inapp_modal","slack_bot_connection_message_revamp","onboarding_language_picker_feature_gate","allow_public_page_access_request","relation_menu_refactor","page_layouts","collections_relation_picker_require_edit_perms","typed_db_creation","formulas_dark_read","typed_db_migration","contact_sales_marketo_migration","collections_bulk_relation_sync_queue_enabled","collection_subitem_nested_operations","collections_shorten_url","use_collection_reducer_request_hook","collection_subitem_new_show_hide_options","collection_groups_functional","charts_mvp","better_database_text_sorts","home_compact_view","collections_compact_view","webhooks_beta","public_api_developer_survey","e_discovery","add_comments_on_blocks","install_dlp_integrations","public_api_use_secure_file_proxy","webhooks_enable_nightfall","inactive_webhook_subscription_ui","advanced_security_in_enterprise","ai_annual","android_native_blocks","can_remove_plan_without_removing_addon","deny_multiplayer_personal_plan_upgrade","enable_midterm_subscription_changes","estudiantes","prices_test_country","sepa_debit","test_clocks","tt_affiliates","tt_marketing","tt_upwork","upgrade_modal_ai_option","use_mp2_update_subscription_path","enable_new_creator_profile","template_submission_backend_v2","creator_platform_contentful_sync_m1","creator_platform_contentful_sync_m2","csv_schema_typed_merge","csv_validation_errors_fix","csv_relation_support","csv_twoway_relation_support","card_details_unified","trello_pagination_enabled","trello_media_queue","zip_importer_enabled","enable_text_crdt_server","enable_text_crdt_client","enable_default_create_crdt_page","button_block_colors","sites_multiple_domains","sites_settings_published_by","functional_text_component","block_attribution","workspace_consolidation_checkpoint","desktop_app_login_with_email_redirect","ai_property_autofill_v2","desktop_app_signup_hide_passcode","ios_app_signup_hide_passcode","better_asana_import_task_dependency","user_data_consent_admin_bypass","goodbye_credits","link_preview_auth_with_server_integration","formula_buttons","ai_onboarding_logging","enable_deleted_page_indicator","forethought","survey_data_writes","enable_refetch_eoi_blocks_on_retry","adding_extra_logs_in_eoi_retry_fg","snapshot_optional_collection_rollback_enabled","prevent_login_with_temporary_password","saml_throw_on_temporary_password_use_case_mismatch","saml_enforced_disallow_send_temporary_password","audit_log_aes_event_read","audit_log_permanently_deleted_filter_enable","audit_log_event_name_column","guest_invite_requests","drawing_block","log_identify_cross_domain_device_ids","duplcate_template_tracking_serverside","disable_ai_big_red_button","organization_is_source_of_truth","ai_data_sharing","convert_cut_paste_to_move","page_title_in_reranker","text_align","enable_giphy_feature_gate","dependency_date_shifting_by_space","admin_content_search_only_search_titles","legacy_slack_notifications","overlay_trap_focus","mobile_better_filing_eligibility","server_dispatch_recents_background_fetch","onetrust_onboarding_unsub_link","google_drive_connected_relation","figma_connected_relation","zendesk_connected_relation","cron_connected_relation","notion_calendar","notion_calendar_launch_modal","zendesk_ai_enabled","toggleable_transcript","use_assembly","use_iframely_cards","transcript_feedback_button","space_for_ai_tooltip_enabled","export_collections_v1","use_new_import_notification","message_store_client_send_request_metric_enabled","template_gallery_web","response_size_instrumentation","append_favorites","support_synced_database_automations","template_contentful_sync_job","mobile_bridge_performance_logging","ai_source_picker","client_http_gzip","is_visibility_enabled_for_db_sync","disable_poll_jobs_for_collection_entities","export_new_structure","embed_block_fallback","automation_update_pages_batching","update_pages_action_batching","topbar_connection_indicator_v2","delete_kvs","force_kvs_break","enable_guest_export","animated_use_css_transition","perform_get_latest_activity_queries_sequentially","autofill_translate","scim_post_user_version_conflict","scim_post_user_space_view_mismatch","collections_view_specific_client_mode_enabled","autofill_tags","autotag_ambient_trigger","autotag_ambient_trigger_space","enable_vector_search_in_autotag","dark_fetch_autotag","enable_ai_suggested_properties","typed_move_to_improved_search","typed_move_to_improved_default_results","first_party_links","search_index_collection_ranking_features","ios_enable_prefetching","mobile_browser_remove_bottom_padding_hack","hide_orphan_blocks","wiki_perf_improvement_local_enabled","show_keep_existing_guests_modal","export_content_analytics_stream","recover_space_view_on_readd","space_user_recovery_read","recover_user_content_in_product","export_admin_content_search_stream","export_puppeteer_upgrade","affiliates_s2s_routing","meeting_notes_transcript_consumer_setup","meeting_notes_transcript_new_consumer","meeting_notes_formatting_fix","enable_external_integration_auth_strict_access","student_form","native-find-in-page","assistant-labeler-mode","active_token_counter","qna_block_citations","2024_workspace_gpt4","qna-reranker-skipped","vector_db_search","vector-search-live-indexing","embeddings-enabled-for-spaceid","qna-slack-workspaces","qna_vector_search_reranker_using_decision_tree","people_profile_popup","collection_split_aggregation_v2","send_student_form_error_messages","recurrence_queue_task_improvements","enterprise_launch_modal","quick_search","search_toggle_side_peek","search-show-report-bad-search","search_operations_skip_local_search","update_space_permissions_if_no_records","improved_asana_importer_screens","disable_storage_manager_estimate","recurring_sprints","toc_nested_headings","mention_menu_page_headings","use_new_undo_redo_behavior","inline_mention_invites","disable_qna_for_workspace","derived_property_sync_processor","organization_audit_logs","enable_transcript_tab","wiki_query_perf_improve_enabled","autofill_turbo_traffic","filter_dependencies","enable-cron-job-updateembeddingindexedflags","mobile_native_external_link_fix","localized_parse_number","internal_communication_with_connections","qna_enable_reminders","inert_html_attribute","mint-device-id-cookie","send_new_device_login_email","remove_apostrophe_for_maps_url","last_sprint","student_form_v2","admin_console_enabled","settings_console_audit_log_enabled","settings_console_managed_accounts_enabled","use_hierarchy_in_zip_importer","cache_formulas2_filters","cache_date_filters","audit_log_guest_membership_request","qna_enable_suggested_questions_cron_job","is_evernote_authpopup_closing_fix_enabled","show_topbar_layout_info_button","enable_oauth_from_desktop_ux_v2","enable_public_content_scanning","inactive_webhook_subscriptions","should_extract_media_from_html","dark_read_block_property_item","profile_discoverability_setting_gate","docx_comment_importer_enable","csv_export_in_user_timezone","slack_token_specification","enable_server_integrations_proxy","page_property_search","comments_density_image_handling","hover_menu_requires_target","markdown_support_for_slack","enable_custom_siem_integration","social_media_preview_image_uploader_enabled","social_media_preview_image_render_page_metadata","include_nonindexed_public_content_for_scanning","human_suggested_edits","use_organization_on_read","enable_notion_ai_unfurl_in_slack","use_full_location_name","low_guest_limit","presence_avatar_tooltips","slack_bot_enable_slack_oauth_v2","notion_ai_assistant_continuous_eval_sample_rate","partitioned_universal_importer","input_padding","collections_virtualization","qna_generate_reranker_label"],S=[..._].sort(),w={event_trail_events:{},page_tree_query_strategy:{strategy:"postgres_recursion"},event_trail_routing:{},collection_request_settings:{clientFormulaTimeoutMs:3e5},sentry:{errorsSampleRate:0,"tracesSampleRate-v0":0,"replaysSessionSampleRate-v0":0,"replaysOnErrorSampleRate-v0":0,profilesSessionSampleRate:0,profilesSampleRate:0},gtm_ai_favorites:{space_id:void 0,collection_id:void 0},palette:{"sessionSampleRate-v4":0,pageLoadSampleIntervalMs:10,interactionSampleIntervalMs:10,maxBufferSize:1e5},permanently_delete_tree_queue_task_override:{queue_task_kill_switch_on:!1,task_delay_override_seconds:void 0,elastic_search_request_batch_size:200,s3_request_batch_size:200,redis_read_batch_size:1e4,tree_iteration_batch_size:1e4,tree_iteration_max_buffer_size:5e4,postgres_query_batch_size:1e5},load_test_simulator_configs:{commenter_interval_ms:1e3,page_viewer_interval_ms:100,editor_interval_ms:1e3,editor_typing_interval_ms:100,presence_interval_ms:1e3},education_free_submit_form_config:{},notion_people_block_id:{data:{}},template_ids_to_use_duplicate_block:{data:[]},csv_limits:{maxRelationPages:1e3,maxRows:1e5,maxColumns:500},model_overrides:{},slack_contacts_limit:{maxLimit:100,defaultLimit:100},automation_update_pages:{},assistant_error_message_override:{},inbox_2_0_shadow_traffic_testing:{getNotificationLogPassRate:0,getUserNotificationsPassRate:0},active_token_counter_config:{},text_crdt_config:{delete_merge_slice_tree_block_limit:100,crdt_page_banner_link:"https://dev.notion.so/notion/Conflict-Resolution-784929c697f54e1eb18d77ac782fc548"},default_create_crdt_page_config:{private:!1,team:!1,collection_table_view:!1,collection_non_table_view:!1,collection_instantiate_template:!1,other:!1},dev_ai_context:{suggestOnPageNavigationProbability:0},mobile_inbox_2_0_feedback:{},paste_event_logging:{samplePercentage:0,redactedHtmlMaxSize:4096},sqlite_record_cache_errors:{getRecordSampleRateSplunk:0,getRecordSampleRateSentry:0,flushWritesSampleRateSplunk:0,flushWritesSampleRateSentry:0}},k=new Set(b);function I(e){return k.has(e)}function C(e){return g[e]}const x="_unassigned_"},64962:(e,t,n)=>{n.d(t,{O:()=>F});n(57658);var o=n(66897),r=n(15145),i=n(15070),a=n(90559),s=n(35011),l=n(80951),c=n(34299),d=n(56373),u=n(1800),p=n(40506),m=n(7057),f=n(53877),g=n(61075),h=n(64572),v=n(72126),b=n(25718),y=n(59753),_=n(63306),S=n(21202),w=n(77420),k=n(6287),I=n(19889),C=n(70203),x=n(7928),T=n(63143),M=n(4308);const P=m.ZV;function A(e){return(0,g.hJ)({...e,fromString:e=>e}).join("")}function R(e){const{textValue:t}=e;if(t){const n=[];for(const o of t)C.QJH(o)||n.push(A({...e,textValue:[o]}));return n.join(", ")}return""}const D={[C.GKr.Page]:e=>{let{annotation:t,exportArgs:n}=e;const{getExportedPathToPage:o}=n,r=C.TOT(t),i=(0,g.Ho)({intl:n.intl,blockId:r,getRecordValue:n.getRecordValue,userTimeZone:n.userTimeZone}),a=o({toPageId:r});if(i&&a)return`${i} (${a})`},[C.GKr.Comment]:e=>{let{annotation:t,exportArgs:n}=e;const{getRecordValue:o,baseUrl:i}=n,a=y.om.fromGetRecordValueFn(o),s=C.$WM(t);if(!s)return;const l=a(s);if(!l)return;const c=l.getParentId(),d=l.getParentPointer(),p=(0,_.el)((0,_.DW)(d,o));if(!p)return;const m=a(d);let f;if(m){const e=a(m.getParentPointer());f=e&&"table_row"===e.getType()?e.getParentId():m.getParentId()}return(0,u.Z)({pageId:p.id,scrollToBlockId:f,pageValue:p,baseUrl:i,discussionId:c,pageVisitSource:r.tY.Export})},[C.GKr.Link]:e=>{let{annotation:t,exportArgs:n}=e;const{getExportedPathToFile:o,getExportedPathToPage:r,navigableBlockId:i,baseUrl:a,publicDomainName:s}=n,l=C.zW$(t),c=(0,h.A5)({url:l,baseUrl:a,publicDomainName:s});return c?r({toPageId:c}):o({fromBlockId:i,toFileURI:l})},[C.GKr.User]:e=>{let{annotation:t,exportArgs:n}=e;const{intl:o}=n,r=C.zEN(t),i=n.getRecordValue({table:I.KJ,id:r});if(i)return`@${(0,x.Nz)(o,i)}`},[C.GKr.Bot]:e=>{let{annotation:t,exportArgs:n}=e;const o=C._Rq(t),r=n.getRecordValue({table:w.cZ,id:o});if(r)return`@${(0,i.Mh)(r)}`},[C.GKr.Group]:e=>{let{annotation:t,exportArgs:n}=e;const o=(0,g.kF)({annotation:t,exportArgs:n});if(o)return o},[C.GKr.ExternalObjectInstance]:e=>{var t;let{annotation:n,exportArgs:o}=e;const r=C.frW(n);return null===(t=o.getRecordValue({table:S.iU,id:r,spaceId:o.root.spaceId}))||void 0===t||null===(t=t.format)||void 0===t?void 0:t.original_url},[C.GKr.Date]:e=>{let{annotation:t,exportArgs:n}=e;const{date_format:o,time_format:r,...i}=C.zyO(t);return`@${(0,m.ZV)({value:i,date_format:o,time_format:r,userTimeZone:n.userTimeZone,allowRelativeDates:!1,intl:n.intl})}`},[C.GKr.Equation]:e=>{let{annotation:t,exportArgs:n}=e;const o=(0,b.dx)(t),r=(0,b.wB)(t,n.getExportedPathToPage,n);return`${o}${C.xey(t)}${r}`},[C.GKr.Bold]:g.Hf,[C.GKr.Italic]:g.Hf,[C.GKr.Strike]:g.Hf,[C.GKr.Code]:g.Hf,[C.GKr.Highlight]:g.Hf,[C.GKr.Discussion]:g.Hf,[C.GKr.Underline]:g.Hf,[C.GKr.Inserted]:g.Hf,[C.GKr.Deleted]:g.Hf,[C.GKr.TemporaryComment]:g.Hf,[C.GKr.TemporaryCursor]:g.Hf,[C.GKr.TemporaryEquation]:g.Hf,[C.GKr.TemporaryPage]:g.Hf,[C.GKr.TemporaryInput]:g.Hf,[C.GKr.TemporarySelection]:g.Hf,[C.GKr.TemporaryFindHighlight]:g.Hf,[C.GKr.TemporarySelectedFindHighlight]:g.Hf,[C.GKr.TemplateVariable]:g.Hf,[C.GKr.FormulaPageProperty]:g.Hf,[C.GKr.FormulaContextValue]:g.Hf,[C.GKr.FormulaError]:g.Hf,[C.GKr.Citation]:g.Hf,[C.GKr.SuggestionInsertText]:g.Hf,[C.GKr.SuggestionRemoveText]:g.Hf},E=()=>{},B=()=>Promise.resolve(void 0),F={blockRenderers:{text:E,header:E,sub_header:E,sub_sub_header:E,quote:E,bulleted_list:E,toggle:E,to_do:E,numbered_list:E,code:E,page:E,image:E,video:E,embed:E,bookmark:E,file:E,tweet:E,maps:E,gist:E,framer:E,invision:E,mixpanel:E,drive:E,figma:E,loom:E,pdf:E,typeform:E,codepen:E,audio:E,divider:E,equation:E,collection_view:E,collection_view_page:E,column_list:E,column:E,factory:E,copy_indicator:E,breadcrumb:E,link_to_collection:E,link_to_page:E,table_of_contents:E,callout:E,whimsical:E,miro:E,abstract:E,sketch:E,excalidraw:E,replit:E,alias:E,transclusion_container:E,transclusion_reference:E,external_object_instance:E,table:E,table_row:E,tab:E,hex:E,deepnote:E,external_object_instance_page:E,button:E,ai_block:E,drawing:E,personal_home_page:E},asyncBlockRenderers:{text:B,header:B,sub_header:B,sub_sub_header:B,quote:B,bulleted_list:B,toggle:B,to_do:B,numbered_list:B,code:B,page:B,image:B,video:B,embed:B,bookmark:B,file:B,tweet:B,maps:B,gist:B,framer:B,invision:B,mixpanel:B,drive:B,figma:B,loom:B,pdf:B,typeform:B,codepen:B,audio:B,divider:B,equation:B,collection_view:B,collection_view_page:B,column_list:B,column:B,factory:B,copy_indicator:B,breadcrumb:B,link_to_collection:B,link_to_page:B,table_of_contents:B,callout:B,whimsical:B,miro:B,abstract:B,sketch:B,excalidraw:B,replit:B,alias:B,transclusion_container:B,transclusion_reference:B,external_object_instance:B,table:B,table_row:B,tab:B,hex:B,deepnote:B,external_object_instance_page:B,button:B,ai_block:B,drawing:B,personal_home_page:B},annotationRenderers:D,propertyRenderers:{title:e=>A(e),text:A,select:e=>{const{textValue:t,propertySchema:n}=e,o=n.options||[];return l.Sj(t,o)},multi_select:e=>{const{textValue:t,propertySchema:n}=e,o=n.options||[],r=l.uP(t,o);return r.sort(),r.join(", ")},status:e=>{const{textValue:t,propertySchema:n}=e;return l.ZG(t,n)},relation:e=>{const{textValue:t,propertySchema:n,exportArgs:o}=e;if("relation"!==n.type)return;const r=l.j$({relationValue:l.rq(t),getRecordModel:y.om.fromGetRecordValueFn(o.getRecordValue),propertySchema:n}),i=l.ow(r);return R({...e,textValue:i})},rollup:e=>{const t=e.exportArgs.getRecordValue,n=y.kk.fromValue(S.iU,e.block),o=y.om.fromGetRecordValueFn(t);return c.kJ({...e,block:n,getRecordModel:o,collectionRequestContext:{userId:void 0,userTimeZone:e.exportArgs.userTimeZone,depth:0,intl:e.exportArgs.intl,visitedProperties:new Set,resultCache:e.exportArgs.resultCache}})},url:e=>{let{textValue:t}=e;return l.zB(t)},email:e=>{let{textValue:t}=e;return l.zB(t)},phone_number:e=>{let{textValue:t}=e;return l.zB(t)},checkbox:e=>{let{textValue:t}=e;return l.Ml(t)?"Yes":"No"},person:e=>{let{textValue:t,exportArgs:n,propertySchema:o,block:r}=e;const{intl:i}=n,a=y.kk.fromBlock(r),s=l.DW({textValue:t,propertySchema:o,blockCreatorPointer:a.getCreatedByPointer()});return v.oA(s.map((e=>{const t=n.getRecordValue(e),o=t&&y.kk.fromValue(e.table,t);return null==o?void 0:o.getDisplayName(i)}))).join(", ")},number:e=>{let{textValue:t}=e;const n=l.VY(t);if(void 0!==n)return n.toString()},date:e=>{let{textValue:t,propertySchema:n,...o}=e;const r=o.exportArgs.userTimeZone,i=l.Gl(t),{date_format:a,time_format:s}=n;if(i)return(0,m.ZV)({allowRelativeDates:!1,value:i,date_format:a,time_format:s,userTimeZone:r,intl:o.exportArgs.intl,displayInUserTimezone:o.exportArgs.displayInUserTimezone??!1,alwaysIncludeTimezone:!0})},file:R,formula:e=>{const{property:t,schema:n,block:o,exportArgs:r}=e,{userTimeZone:i,getRecordValue:a,intl:l,resultCache:c}=r,d=(0,s.py)({schema:n,property:t,blockModel:y.kk.fromBlock(o),getRecordModel:y.om.fromGetRecordValueFn(a),intl:l,userTimeZone:i,depth:0,resultCache:c});return"boolean"==typeof d?d?"Yes":"No":(0,T.hj)(d)?d.toString():(0,p.U3)(d)?P({value:d,userTimeZone:i,allowRelativeDates:!1,intl:r.intl}):d},created_time:e=>{const{block:t,exportArgs:n}=e,{userTimeZone:o}=n;if(t.created_time)return P({allowRelativeDates:!1,value:(0,f.CQ)(t.created_time,o),userTimeZone:o,intl:n.intl})},last_edited_time:e=>{const{block:t,exportArgs:n}=e,{userTimeZone:o}=n;if(t.last_edited_time)return P({allowRelativeDates:!1,value:(0,f.CQ)(t.last_edited_time,o),userTimeZone:o,intl:n.intl})},created_by:e=>{const{block:t,exportArgs:n}=e,{getRecordValue:r,intl:i}=n;if(t.created_by_table&&t.created_by_id){const e=(0,o.Hl)({getRecordValue:r,pointer:{table:t.created_by_table,id:t.created_by_id,spaceId:t.space_id}});if(e.asActor)return(0,o.$4)(i,e)}},last_edited_by:e=>{const{block:t,exportArgs:n}=e,{getRecordValue:r,intl:i}=n;if(t.last_edited_by_table&&t.last_edited_by_id){const e=(0,o.Hl)({getRecordValue:r,pointer:{table:t.last_edited_by_table,id:t.last_edited_by_id,spaceId:t.space_id}});if(e.asActor)return(0,o.$4)(i,e)}},button:e=>"",auto_increment_id:e=>{let{textValue:t,block:n,exportArgs:o}=e;const r=l.ah(t),{getRecordValue:i}=o;if(void 0!==r){const e=y.kk.fromBlock(n),t=e.getParentTable();if(t!==k.v)return;const o=i((0,d.We)({spaceId:e.getSpaceId(),parentTable:t,parentId:e.getParentId()}));return(0,a.wf)(null==o?void 0:o.record_key,r)}},last_visited_time:e=>"",location:e=>"",verification:e=>{let{textValue:t,exportArgs:n}=e;const o=l._w(t);if(!o)return"";const r=M.WN(o);return n.intl.formatMessage(M.A3(r.type))}}}},42509:(e,t,n)=>{n.d(t,{Ev:()=>l,Gq:()=>s,OY:()=>u,hD:()=>c});var o=n(21202),r=n(6287),i=n(97880);(0,i.AO)((e=>e&&e.parent_table===o.iU&&a(e)&&e.format&&e.format.original_url&&!e.format.is_placeholder?{true:e}:{false:e})),(0,i.AO)((e=>{var t,n;return e&&e.parent_table===o.iU&&a(e)&&e.format&&void 0===e.format.original_url&&null!==(t=e.format)&&void 0!==t&&t.external_object_id&&null!==(n=e.format)&&void 0!==n&&n.uri&&!e.format.is_placeholder?{true:e}:{false:e}}));const a=(0,i.AO)((e=>d(e)&&"external_object_instance"===e.type?{true:e}:{false:e})),s=((0,i.AO)((e=>d(e)&&"external_object_instance_page"===e.type?{true:e}:{false:e})),(0,i.AO)((e=>e&&e.parent_table===r.v&&d(e)&&"external_object_instance_page"===e.type?{true:e}:{false:e})),(0,i.AO)((e=>{var t;return d(e)?{false:e}:e.parent_table===o.iU&&null!==(t=e.format)&&void 0!==t&&t.original_url&&e.format.external_object_id?{true:e}:{false:e}}))),l=(0,i.AO)((e=>{var t;return d(e)?{false:e}:e.parent_table===o.iU&&null!==(t=e.format)&&void 0!==t&&t.original_url&&!e.format.external_object_id?{true:e}:{false:e}})),c=((0,i.AO)((e=>{var t;return!e||d(e)?{false:e}:e.parent_table===r.v&&null!==(t=e.format)&&void 0!==t&&t.external_object_id?{true:e}:{false:e}})),(0,i.AO)((e=>{var t,n;return!e||d(e)?{false:e}:null!=e&&null!==(t=e.format)&&void 0!==t&&t.original_url||null!=e&&null!==(n=e.format)&&void 0!==n&&n.external_object_id||u(e)||p(e)||m(e)?{true:e}:{false:e}}))),d=(0,i.AO)((e=>"type"in e&&e.type?{true:e}:{false:e})),u=((0,i.AO)((e=>void 0===e.format?{true:e}:{false:e})),(0,i.AO)((e=>{var t;return null!==(t=e.format)&&void 0!==t&&t.is_placeholder?{true:e}:{false:e}})),(0,i.AO)((e=>{var t,n;return!e||d(e)?{false:e}:null!==(t=e.format)&&void 0!==t&&t.is_placeholder&&null!==(n=e.format)&&void 0!==n&&n.integration_id?{true:e}:{false:e}}))),p=(0,i.AO)((e=>d(e)?{false:e}:e.parent_table===r.v&&e.format&&e.format.uri&&void 0===e.format.external_object_id&&e.format.integration_id?{true:e}:{false:e})),m=(0,i.AO)((e=>d(e)?{false:e}:e.parent_table===r.v&&e.format&&e.format.uri&&void 0===e.format.external_object_id&&void 0===e.format.integration_id?{true:e}:{false:e}))},76218:(e,t,n)=>{n.d(t,{A6:()=>d,Ck:()=>m,H0:()=>f,OH:()=>y,S3:()=>h,UB:()=>v,YD:()=>c,Zw:()=>b,iC:()=>u,qW:()=>g});n(57658);var o=n(76725),r=n(72126),i=n(6287),a=n(23867),s=n(70203),l=n(97880);function c(e){if(void 0!==e)return[p(e)]}function d(e){const t=e||[],n=[];for(const o of t){const e=(0,s.hDy)(o),t=(0,s.hH9)(e)||(0,s.V8Y)(e)||(0,s.sP4)(e)||(0,s.K9C)(e);t&&n.push(t);const r=(0,s.WiV)(o).split(",");for(const o of r){const e=o.trim(),t=e.indexOf('"'),r=e.lastIndexOf('"');if(t>=0&&r>=0){const o=e.slice(t+1,r);o.length>0&&n.push(o)}else"true"===e?n.push(!0):"false"===e&&n.push(!1)}}return n}function u(e){const t=r.mN(e,(e=>JSON.stringify(e)));if(0!==t.length)return(0,s.Zxt)([["["],...(0,o.Z)(t.map(p),(()=>[", "])),["]"]])}function p(e){return"string"==typeof e?[`"${e}"`]:"boolean"==typeof e?[`${e}`]:(0,s.YCD)(e)}function m(e,t){return e.filter((e=>JSON.stringify(e)!==JSON.stringify(t)))}function f(e,t,n){const o=g(e,t,n);if(o)return function(e){if("text"===e.type)return e;if("number"===e.type)return e;if("checkbox"===e.type)return e;if("date"===e.type)return e;if("block_array"===e.type)return{type:"array",of:{type:"block",collection:e.collection}};if("person_array"===e.type)return{type:"array",of:{type:"person"}};if("select"===e.type)return{type:"select",collection:e.collection,property:e.property};if("select_array"===e.type)return{type:"array",of:{type:"select",collection:e.collection,property:e.property}};(0,l.t1)(e)}(o)}function g(e,t,n){if("text"===n.type||"url"===n.type||"email"===n.type||"phone_number"===n.type||"title"===n.type)return{type:"text"};if("checkbox"===n.type)return{type:"checkbox"};if("multi_select"===n.type)return{type:"select_array",collection:e,property:t};if("select"===n.type||"status"===n.type)return{type:"select",collection:e,property:t};if("person"===n.type)return{type:"person_array"};if("number"===n.type||"auto_increment_id"===n.type)return{type:"number"};if("date"===n.type)return{type:"date"};if("relation"===n.type){if(n.collection_pointer)return{type:"block_array",collection:{table:i.v,id:n.collection_pointer.id,spaceId:(0,a.C)(n.collection_pointer.spaceId)}};if(n.collection_id)return{type:"block_array",collection:{table:i.v,id:n.collection_id,spaceId:e.spaceId}}}else{if("formula"===n.type||"rollup"===n.type||"last_edited_by"===n.type||"last_edited_time"===n.type||"button"===n.type||"created_time"===n.type||"created_by"===n.type||"file"===n.type||"location"===n.type||"verification"===n.type||"last_visited_time"===n.type)return;(0,l.t1)(n)}}function h(e){return"string"!=typeof e&&"boolean"!=typeof e}function v(e){return(e.value??[]).map((e=>{if(!(0,s.km_)(e))return;const t=(0,s.sP4)(e[1]);if(!t)return;return(0,s.vmO)(t).id})).filter(l.$K)}function b(e,t){return{...e,value:e.value?e.value.map((e=>{if(!(0,s.km_)(e))return e;const n=r.Xh(e);for(const o of n[1])(0,s.wjk)(o)&&(o[1].id=t(o[1].id));return n})):void 0}}async function y(e){const{value:t,context:n,executeFormula:o}=e,{returnType:r}=n,i=t.value;if("simple"===t.type){if("number"===r.type){const e=(0,s.QaF)(i),t=parseFloat(e);return isNaN(t)?{value:{type:"undefined"}}:{value:{type:"number",value:t}}}if("text"===r.type)return{value:{type:"text",value:i||[]}};if("checkbox"===r.type){return{value:{type:"checkbox",value:"true"===(0,s.QaF)(i)}}}return o(n,i)}return"formula"===t.type?o(n,i):(0,l.t1)(t.type)}},5773:(e,t,n)=>{n.d(t,{ZP:()=>c,jy:()=>d,xN:()=>l});n(57658);var o=n(80951),r=n(43593),i=n(70203),a=n(97880);const s=["source"];function l(e,t,n){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;const c=[],p=[];if(e.properties){const r=Object.keys(e.properties);for(const m of r){const r=e.properties[m],f=r?o.g(r):void 0;if(l){const e=u(f,t,n,i,a);if(e&&e.length>0&&s.includes(m)){const t={pointer:l,path:["properties",m],command:"set",args:e};p.push(t)}}const g=d(f,[t,n],i,a);c.push(...g)}}if(e.format){const{page_cover:o,page_icon:s}=e.format;if(o){const e=(0,r.mV)(o,[t,n],i,a);e&&c.push(e)}if(s){const e=(0,r.mV)(s,[t,n],i,a);e&&c.push(e)}}return{files:c,operations:p}}function c(e,t,n){return l(e,t,n,arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",arguments.length>4&&void 0!==arguments[4]?arguments[4]:"",arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0).files}function d(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";return void 0===e?[]:e.map((e=>(0,r.mV)(e.url,t,n,o))).filter(a.$K)}function u(e,t,n){let o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",s=arguments.length>4?arguments[4]:void 0;if(void 0===e)return;const l=e.map((e=>(0,r.Wv)(e.url,t,n,o,s))).filter(a.$K);return l&&l.length>0?[i.V3y(l[0].link)]:void 0}},89789:(e,t,n)=>{n.d(t,{P_:()=>a});var o=n(66897),r=n(77420),i=n(19889);const a=(0,o.dp)(i.s$);(0,o.dp)(i.el),(0,o.dp)(i.T0),(0,o.dp)(i.fs),(0,o.D$)(r._H)},45681:(e,t,n)=>{n.d(t,{T1:()=>A,A6:()=>M,Wr:()=>T,rb:()=>P});var o=n(90559),r=n(80951),i=n(38297),a=n(6287);const s={derivePrimitiveOperations:function(e,t){const{collectionId:n,spaceId:s}=e.args,l=t(e.pointer);if(!l)return[];if(l.is_template)return[];const c=(0,i.ky)({block:l,getRecordValue:t});if((null==c?void 0:c.id)===n){const i=(0,o.Y7)({spaceId:s,parentTable:a.v,parentId:n}),l=t(i),c=t({table:a.v,id:n,spaceId:s});if(c&&l&&l.alive)return(0,o.FT)(c).flatMap((t=>[{pointer:e.pointer,command:"set",path:["properties",t],args:(0,r.e7)(l.next_value)},{pointer:i,command:"set",path:["next_value"],args:l.next_value+1}]))}return[]},getAdditionalRelatedPointers:function(e){const{collectionId:t,spaceId:n}=e.args;return[(0,o.Y7)({spaceId:n,parentTable:a.v,parentId:t})]},invert:function(e,t){return[]}};n(21703),n(57658);var l=n(72126),c=n(73360);const d={derivePrimitiveOperations:function(e,t){const n=[];n.push({...e,command:"insertChildrenBefore"===e.command?"listBeforeMulti":"listAfterMulti",args:{...e.args}});const o=T(e.pointer.table,e.path);if(!o)throw new Error(`Unsupported operation table and operation path ${JSON.stringify(e)} `);return e.args.ids.forEach((r=>{const i={id:r,table:o,spaceId:e.pointer.spaceId};n.push({command:"update",pointer:i,path:[],args:{parent_table:e.pointer.table,parent_id:e.pointer.id,alive:!0}});const s=t(i);if(s&&s.parent_id&&s.parent_table&&s.parent_id!==e.pointer.id){const e=M(s.parent_table,o);e?n.push({command:"listRemove",pointer:{id:s.parent_id,table:s.parent_table,spaceId:s.space_id},path:e,args:{id:s.id}}):function(e){if(!e)throw new Error("Assertion failed in insertChildrenOperationHelper")}(s.parent_table===a.v)}})),n},getAdditionalRelatedPointers:function(e){const t=T(e.pointer.table,e.path);if(!t)throw new Error(`Invalid operation ${JSON.stringify(e)}`);return e.args.ids.map((n=>({id:n,table:t,spaceId:e.pointer.spaceId})))},invert:function(e,t){const n=T(e.pointer.table,e.path);if(!n)throw new Error(`Invalid operation ${JSON.stringify(e)}`);return e.args.ids.flatMap((o=>{const r={id:o,table:n,spaceId:e.pointer.spaceId},i=t(r);if(i&&i.parent_table&&i.parent_id){if(M(i.parent_table,n)){const n=t({id:i.parent_id,table:i.parent_table,spaceId:i.space_id});if(n){const e=u(c.mk.create(i.parent_table,n),i.parent_table,r);return e?[e]:[]}return[{command:"removeChild",pointer:e.pointer,path:e.path,args:{id:o}}]}return[{command:"setParent",pointer:r,path:[],args:{parentId:i.parent_id,parentTable:i.parent_table}}]}return[{command:"removeChild",pointer:e.pointer,path:e.path,args:{id:o}}]}))}},u=function(e,t,n){const o=M(e.table,n.table);if(!o)return{command:"setParent",pointer:n,path:[],args:{parentId:e.value.id,parentTable:t}};const r=l.U2(e.value,o);if(!r)return;const i=r.indexOf(n.id);if(-1===i)return;const a={id:e.value.id,table:t,spaceId:n.spaceId};if(0===i){return{command:"insertChildrenBefore",pointer:a,path:o,args:{ids:[n.id]}}}return{command:"insertChildrenAfter",pointer:a,path:o,args:{ids:[n.id],after:r[i-1]}}};n(30541);var p=n(39693),m=n.n(p),f=n(29299),g=n(15047);const h={derivePrimitiveOperations:function(e){const{pointer:t}=e,{spaceViewPointer:n,user:o,removeFromParent:r}=e.args,i=[(0,f.Y5)({pointer:t,user:o}),(0,f.EY)({pointer:t,parent_table:g.bx,parent_id:n.spaceId}),{pointer:n,path:["private_pages"],command:"listAfter",args:{id:t.id}}];if(r){const e=M(r.table,t.table);e&&i.unshift({pointer:r,path:e,command:"listRemove",args:{id:t.id}})}return i},getAdditionalRelatedPointers:function(e){return m()([e.args.spaceViewPointer,e.args.removeFromParent])},invert:function(){return[]}},v={derivePrimitiveOperations:function(e){const t=[];t.push({...e,command:"listRemove"});const n=T(e.pointer.table,e.path);if(!n)throw new Error(`invalid operation ${JSON.stringify(e)}`);return t.push({command:"set",path:["alive"],args:!1,pointer:{table:n,spaceId:e.pointer.spaceId,id:e.args.id}}),t},getAdditionalRelatedPointers:function(e){const t=T(e.pointer.table,e.path);if(!t)throw new Error(`Invalid operation ${JSON.stringify(e)}`);return[{id:e.args.id,table:t,spaceId:e.pointer.spaceId}]},invert:function(e,t){const n=t(e.pointer);if(!n)return[];const o=T(e.pointer.table,e.path);if(!o)throw new Error(`Invalid operation ${JSON.stringify(e)}`);const r=u(c.mk.create(e.pointer.table,n),e.pointer.table,{id:e.args.id,table:o,spaceId:e.pointer.spaceId});return r?[r]:[]}};var b=n(98963),y=n(18844),_=n(21202),S=n(70279),w=n(33709),k=n(91644),I=n(29369);const C={insertChildrenAfter:d,insertChildrenBefore:d,setParent:{derivePrimitiveOperations:function(e,t){const n=[{command:"update",pointer:e.pointer,path:[],args:{parent_table:e.args.parentTable,parent_id:e.args.parentId,alive:!0}}],o=t(e.pointer);if(o&&o.parent_id&&o.parent_table){const t=M(o.parent_table,e.pointer.table);t&&n.push({command:"listRemove",pointer:{id:o.parent_id,table:o.parent_table,spaceId:o.space_id},path:t,args:{id:e.pointer.id}})}return n},getAdditionalRelatedPointers:function(e){return[]},invert:function(e,t){const n=t(e.pointer);if(!n||!n.parent_id||!n.parent_table)return[{command:"set",pointer:e.pointer,path:["alive"],args:!1}];if(n.parent_id===e.args.parentId&&n.parent_table===e.args.parentTable)return[];const o=n.parent_table;if(M(o,e.pointer.table)){const o=t({id:n.parent_id,table:n.parent_table,spaceId:n.space_id});if(o){const t=u(c.mk.create(n.parent_table,o),n.parent_table,e.pointer);if(t)return[t]}return[]}return[{command:"setParent",pointer:e.pointer,path:[],args:{parentId:n.parent_id,parentTable:n.parent_table}}]}},removeChild:v,assignAutoIncrementId:s,moveToPrivate:h},x={[_.iU]:[{childTable:_.iU,childPath:["content"]},{childTable:w.qF,childPath:["discussions"]}],[g.bx]:[{childTable:_.iU,childPath:["pages"]}],[w.qF]:[{childTable:S.x_,childPath:["comments"]}],[S.x_]:[{childTable:_.iU,childPath:["content"]}],[I.e0]:[{childTable:_.iU,childPath:["team_pages"]}],[b.cv]:[{childTable:y.Xj,childPath:["action_ids"]}],[y.Xj]:[{childTable:_.iU,childPath:["blocks"]}],[k.AT]:[]},T=function(e,t){var n;const o=x[e];if(o)return null===(n=o.find((e=>{let{childPath:n}=e;return l.Xy(n,t)})))||void 0===n?void 0:n.childTable},M=function(e,t){var n;const o=x[e];if(o)return null===(n=o.find((e=>t===e.childTable)))||void 0===n?void 0:n.childPath},P=(e,t)=>C[e.command].invert(e,t),A=(e,t)=>C[e.command].derivePrimitiveOperations(e,t)},19531:(e,t,n)=>{n.d(t,{$O:()=>st,KD:()=>de,xR:()=>lt,RE:()=>ct});n(57658),n(30541);var o=n(30120),r=n(41432),i=n(99036),a=n(80951),s=n(97531),l=n(9291),c=n(84795),d=n(68626),u=n(5773),p=n(59730),m=n(30845),f=n(72126),g=n(38737),h=n(482),v=n(21202),b=n(6287),y=n(13493),_=n(70203),S=n(63143);const w="PartialMatch",k="FullMatch",I="ColumnCategory",C=(0,l.defineMessages)({titleColumnName:{id:"database.titleColumn.name",defaultMessage:"Title"},genericColumnName:{id:"database.genericColumn.name",defaultMessage:"Column {columnNumber}"}});function x(e){const{table:t,intl:n,randomShortID:o,isPhoneNumber:r,useCsvAdaptiveSchema:s}=e,l=function(e,t,n,o){var r;let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=arguments.length>5?arguments[5]:void 0;e=e.filter((e=>e.some((e=>Boolean((e.text||"").trim())))));const l=e.length>0?e[0].length:0,c=e.map(((e,t)=>({row:e,rowIndex:t}))).filter((e=>{let{row:t}=e;return t.length!==l}));if(c.length>0){const e=c[0];throw new p.p8("CsvImportError",{data:{},clientData:{type:"csv_import_inconsistent_columns",messageValues:{numTitleColumns:l,numBadRows:c.length,firstBadRowIndex:e.rowIndex+1,firstBadRow:JSON.stringify(e.row.map((e=>e.text))),firstBadRowLength:e.row.length}}})}const d=null===(r=e[0])||void 0===r?void 0:r.length;null==s||s.set(I,H(d));let u=[];1===e.length?u=e[0].map(((e,n)=>t.formatMessage(C.genericColumnName,{columnNumber:n+1}))):e.length>1&&(u=e[0].map((e=>e.text)),e.shift());const m=e,g=function(e){return[{test:N.bind(null,e),sampledSchemaIsComplete:!0},{test:D,sampledSchemaIsComplete:!0},{test:O,sampledSchemaIsComplete:!0},{test:V,sampledSchemaIsComplete:!0},{test:B,sampledSchemaIsComplete:!0},{test:R,sampledSchemaIsComplete:!1},{test:L,sampledSchemaIsComplete:!1},{test:z,sampledSchemaIsComplete:!1},{test:q,sampledSchemaIsComplete:!0}]}(o),h=f.oA(f.Ri(m).map((e=>e.length&&e[0].columnType?e[0].columnType:W(t,e.map((e=>null==e?void 0:e.text)),n,g,i,s)))),v=u.map((()=>!1));for(let a=0;a<u.length;a++)if("text"===h[a].schema.type)for(let e=0;e<m.length;e++){const t=m[e][a].textValue;if(t)for(const n of t)if(_.AJd(n)){v[a]=!0,e=m.length;break}}let b=!0;const y={title:{type:"title",name:t.formatMessage(C.titleColumnName)}};u.forEach(((e,t)=>{const o=h[t];if(o)if("text"===o.schema.type&&b&&!v[t]){b=!1,o.id="title",o.schema={type:"title",name:e};const t=y.title;t&&(t.name=e)}else{const t=n();o.id=t,y[t]={name:e,...o.schema}}}));const S=m.map((e=>{const t={};return h.forEach(((n,o)=>{if(n){const{id:r,schema:i,coerce:s}=n,{type:l}=i;if(r){const n=e[o]||"";t[r]="url"===l?a.iD(n.text):"date"===l?a.d7(s(n.text)):"text"===l?n.textValue||_.TPx(s(n.text)):"file"===l?n.textValue||[]:_.TPx(s(n.text))}}})),t}));return{schema:y,types:h,pages:S}}(t,n,o,r,s,e.csvEvalContext);return function(e){const{actor:t,blockType:n,rootId:o,parentId:r,parentTable:a,spaceId:s,name:l,format:c,ignoreBlockCount:d,randomID:p,pages:m,schema:g,columnIds:h,secureFileS3Url:S,secureFileS3UrlV2:w}=e,k=p(),I=p(),C=Date.now(),x=[],T={id:k,version:0,parent_table:v.iU,parent_id:o,space_id:s,name:_.TPx(l),schema:g,alive:!0,format:{collection_page_properties:f.oA(h.map((e=>{if(e)return{visible:!0,property:e}})))}};x.push({pointer:{table:b.v,id:k,spaceId:s},command:"set",path:[],args:T});const M={id:o,version:0,type:n,collection_id:k,format:{collection_pointer:{table:b.v,id:k,spaceId:s}},view_ids:[I],alive:!0,created_by_table:t.table,created_by_id:t.id,created_time:C,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:C,parent_id:r,parent_table:a,space_id:s};x.push({pointer:{table:v.iU,id:o,spaceId:s},command:"update",path:[],args:M});const P=function(e){const{actor:t,collectionId:n,spaceId:o,pages:r,ignoreBlockCount:i,secureFileS3Url:a,secureFileS3UrlV2:s,randomID:l}=e,c=Date.now();return r.map((e=>{const r=l(),d={id:r,version:0,parent_id:n,parent_table:b.v,space_id:o,type:"page",created_by_table:t.table,created_by_id:t.id,created_time:c,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:c,properties:e,...i?{ignore_block_count:!0}:void 0,alive:!0};if(a&&s){const e=(0,u.ZP)(d,a,s);e.length>0&&(d.file_ids=e.map((e=>e.id)))}return{id:r,operation:{pointer:{table:v.iU,id:r,spaceId:o},command:"set",path:[],args:d}}}))}({actor:t,collectionId:k,secureFileS3Url:S,secureFileS3UrlV2:w,spaceId:s,pages:m,ignoreBlockCount:d,randomID:p});P.forEach((e=>{let{operation:t}=e;return x.push(t)}));const A={id:I,version:0,type:"table",name:"Show All",parent_id:o,parent_table:"block",space_id:s,format:{table_properties:f.oA(h.map((e=>{if(e)return{visible:!0,property:e}}))),...c},page_sort:P.map((e=>e.id)).slice(0,i.gq),alive:!0};return x.push({pointer:{table:y.n,id:I,spaceId:s},command:"set",path:[],args:A}),{operations:x}}({...l,columnIds:l.types.map((e=>e.id)),...e})}const T=["yes","Yes","true","True","checked"],M=["no","No","false","False","unchecked"];function P(e){return T.some((t=>e===t))||M.some((t=>e===t))}function A(e,t){return e.length===t.length}function R(e,t){if(t.every(P))return{schema:{type:"checkbox"},validate:P,coerce:e=>T.some((t=>e===t))?i.bx:i.HC}}const D=function(e,t){const n=t.map(g._g),o=n[0];if(o&&n.every((e=>Boolean(e&&e.format===o.format))))return{schema:{type:"number",number_format:o.format},validate(e){const t=g._g(e);return!S.z4(t)&&t.format===o.format},coerce(e){const t=g._g(e);return`${t?t.value:void 0}`}}},E=function(e,t){if(parseInt(t)&&t.length<=6)return!1;const n=c.parseFreeformDateString(t,e);return Boolean(n)};function B(e,t){const n=t.filter((t=>E(e,t)));if(n.length>=t.length/2)return{schema:{type:"date"},validate:t=>E(e,t),coerce:t=>c.parseFreeformDateString(t,e),isFullMatch:A(t,n)}}const F=function(e){return e.length<320&&e.includes("@")&&m.B(e,"email")},O=function(e,t){const n=t.filter(F);if(n.length>=t.length/2)return{schema:{type:"email"},validate:F,coerce:f.yR,isFullMatch:A(t,n)}},Z=function(e){return e.length<320&&m.B(e,"url")},V=function(e,t){const n=t.filter(Z);if(n.length>=t.length/2)return{schema:{type:"url"},validate:Z,coerce:f.yR,isFullMatch:A(t,n)}},U=function(e,t){return!String(t).match(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/)&&e(String(t))},N=function(e,t,n){const o=U.bind(null,e),r=n.filter(o);if(r.length>=n.length/2)return{schema:{type:"phone_number"},validate:o,coerce:f.yR,isFullMatch:A(n,r)}},L=function(e,t,n){const o=[];t.forEach((e=>e.split(",").forEach((e=>o.push(e.trim())))));const r=new Set(o);if(a=r.size,s=o.length,l=t.length,s>l&&j(a,s)){return{schema:{type:"multi_select",options:Array.from(r).map(((e,t)=>({id:n(),value:e,color:(0,i.TL)([])})))},validate:e=>r.has(e),coerce:f.yR}}var a,s,l},j=function(e,t){return e>0&&e**2<t},z=function(e,t,n){const o=new Set(t);if(j(o.size,t.length)){return{schema:{type:"select",options:Array.from(o).map(((e,t)=>({id:n(),value:e,color:(0,i.TL)([])})))},validate:e=>o.has(e),coerce:f.yR}}},q=function(e,t){return{schema:{type:"text"},validate:f._z,coerce:f.yR}};const H=function(e){return e<50?"lessthan50":e<100?"lessthan100":e<500?"lessthan500":e<1e3?"lessthan1000":e<5e3?"lessthan5000":"greaterthan5000"},W=function(e,t,n,o,r,i){const a=t.filter((e=>Boolean(e)));if(0===a.length)return q(e,a);if(r)for(const s of o){const o=s.test(e,a,n);if(o){let n=o;if(!1===o.isFullMatch){d.log({level:"info",from:"csvHelper",type:"csvColumnTypes",data:{message:"Partial column type match detected, setting data type as string",columnType:o.schema.type,matchType:"Partial"}}),n=q(e,t);const r=(null==i?void 0:i.get(w))||0;null==i||i.set(w,r+1)}else d.log({level:"info",from:"csvHelper",type:"csvColumnTypes",data:{message:"Complete column type match detected",columnType:o.schema.type,matchType:"Full"}});const r=(null==i?void 0:i.get(k))||0;return null==i||i.set(k,r+1),n}}else{const t=a.filter((e=>!f.xb(e))).slice(0,100);for(const r of o){const o=r.test(e,t,n);if(o){const s=r.sampledSchemaIsComplete||t.length===a.length?o:r.test(e,a,n);if(s){if(!1===s.isFullMatch){d.log({level:"info",from:"csvHelper",type:"csvColumnTypes",data:{message:"Partial column type match detected, Potential data loss due to parsing failures",columnType:s.schema.type,matchType:"Partial"}});const e=(null==i?void 0:i.get(w))||0;null==i||i.set(w,e+1)}else{const e=(null==i?void 0:i.get(k))||0;null==i||i.set(k,e+1)}return s}}}}return q(e,[])};var K=n(53877),G=n(95538),$=n(15095),Q=n(7406),Y=n(43593),X=n(19233),J=n(4615),ee=n(70279),te=n(33709),ne=n(19889);const oe=n(60809),re={CommentAuthor:"cma",CommentDiscussionId:"cmm"},ie={a:!0,strong:!0,em:!0,code:!0,del:!0,s:!0,span:!0,time:!0},ae={meta:!0,style:!0,script:!0,head:!0,title:!0},se="sourceCode",le=700;function ce(e){if(!e)return;const t=parseInt(e);return isNaN(t)?void 0:t}const de={[_.GKr.Page]:"data-notion-page-id",spaceId:"data-notion-space-id",[_.GKr.Highlight]:"data-notion-highlight",[_.GKr.User]:"data-notion-user-id",[_.GKr.Discussion]:"data-notion-block-discussion-id",[_.GKr.Equation]:"data-notion-inline-equation",[_.GKr.Comment]:"data-notion-block-comment-id",[re.CommentAuthor]:"data-notion-block-comment-author-id",[re.CommentDiscussionId]:"data-notion-block-comment-discussion-id",[r.Ti.code]:"data-notion-code-syntax",[r.Ti.callout]:"data-notion-callout",calloutIcon:"data-notion-callout-icon",calloutBackground:"data-notion-callout-background",[r.Ti.tableOfContents]:"data-notion-toc",[r.Ti.file]:"data-notion-file",fileAlias:"data-notion-file-alias",[r.Ti.columnList]:"data-notion-column-list",[r.Ti.column]:"data-notion-column-ratio",[r.Ti.video]:"data-notion-video",[r.Ti.audio]:"data-notion-audio",[r.Ti.pdf]:"data-notion-pdf",[r.Ti.equation]:"data-notion-equation",dateFormat:"data-notion-date-format"};function ue(e,t){return t&&t.nodeType===e.Node.ELEMENT_NODE}const pe=function(e,t){return e.nodeType===t.Node.TEXT_NODE||e instanceof t.Element&&ie[e.tagName.toLowerCase()]},me=e=>t=>!!(ue(e,t)&&t instanceof e.HTMLParagraphElement),fe=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(t&&1===e.nodeType&&e.hasAttribute(de[_.GKr.Comment]))return n;n.push(e);for(const o of $.p4(e.childNodes))fe(o,t,n);return n},ge=function(e){const t=[];if(!e.parentNode)return t;let n=e.parentNode;for(;n;)t.push(n),n=n.parentNode||void 0;return t};function he(e,t){const n=ge(e).filter((e=>e instanceof t.Element&&("ul"===e.tagName.toLowerCase()||"ol"===e.tagName.toLowerCase()))).length;return n}const ve=["•","◦","▪"],be=["h1","h2","h3","h4","h5","h6"].map((e=>`${e}:not(:first-child)`)).join(", "),ye=function(e){const{node:t,window:n,stripText:r,timeZone:i,ignoreComments:a}=e;if(!r){for(const e of Array.from(t.querySelectorAll("p:not(:first-child)")))e.prepend("\n");for(const e of Array.from(t.querySelectorAll(be)))e.prepend("\n");for(const e of Array.from(t.querySelectorAll("ul > li"))){const t=he(e,n)-1,o=ve[t%ve.length],r="    ".repeat(t);e.prepend(`\n${r}${o} `)}for(const e of Array.from(t.querySelectorAll("ol"))){const t=he(e,n),o="    ".repeat(t);for(let n=0;n<e.children.length;n+=1){e.children[n].prepend(`\n${o}${n+1}. `)}}for(const e of Array.from(t.querySelectorAll("pre")))e.parentNode&&e.parentNode.insertBefore(n.document.createTextNode("\n\n"),e)}const s=[],l=fe(t,a).filter((e=>e.nodeType===n.Node.TEXT_NODE&&(!r||!/^( |\t)*(\n)+( |\t)*$/.test(e.data))));let c=!0;l.forEach(((e,a)=>{let d=e.data;r&&(d=d.replace(/\[ \] /g,""),d=d.replace(/\[x\] /g,""),d=d.replace(/^[\-\*\•]\s?/g,""),d=d.replace(/(\s)+/g,"$1")),t.hasAttribute("confluenceTabSpaces")||0!==a||(d=d.trimStart()),a===l.length-1&&c&&(d=d.trimEnd());const u=[],p=ge(e);let m;!r&&p.some((e=>e instanceof n.Element&&("h1"===e.tagName.toLowerCase()||"h2"===e.tagName.toLowerCase()||"h3"===e.tagName.toLowerCase()||"h4"===e.tagName.toLowerCase()||"h5"===e.tagName.toLowerCase()||"h6"===e.tagName.toLowerCase())))&&u.push([_.GKr.Bold]),p.some((e=>e instanceof n.Element&&"strong"===e.tagName.toLowerCase()))&&u.push([_.GKr.Bold]),p.some((e=>e instanceof n.Element&&"em"===e.tagName.toLowerCase()))&&u.push([_.GKr.Italic]),p.some((e=>e instanceof n.Element&&"u"===e.tagName.toLowerCase()))&&u.push([_.GKr.Underline]),p.some((e=>e instanceof n.Element&&("code"===e.tagName.toLowerCase()||"pre"===e.tagName.toLowerCase())))&&u.push([_.GKr.Code]),p.some((e=>e instanceof n.Element&&("del"===e.tagName.toLowerCase()||"strike"===e.tagName.toLowerCase()||"s"===e.tagName.toLowerCase())))&&u.push([_.GKr.Strike]);const f=p.find((e=>{var t;return e instanceof n.Element&&(e.hasAttribute(de[_.GKr.Highlight])||(null===(t=e.parentElement)||void 0===t?void 0:t.hasAttribute(de[_.GKr.Highlight])))}));if(f&&f instanceof n.Element){var g;const e=f.getAttribute(de[_.GKr.Highlight]),t=null===(g=f.parentElement)||void 0===g?void 0:g.getAttribute(de[_.GKr.Highlight]),n=pt(e&&"undefined"!==e?e||"":t||"");n&&u.push([_.GKr.Highlight,n])}const h=p.find((e=>e instanceof n.Element&&"a"===e.tagName.toLowerCase()));if(h){const e=h.getAttribute(de[_.GKr.Page]),t=h.getAttribute("notionUserId")||h.getAttribute(de[_.GKr.User]),n=h.getAttribute(de.spaceId),o=h.getAttribute(de[_.GKr.Comment]);"string"==typeof e&&(0,J.e)(e)&&"string"==typeof n&&(0,J.e)(n)?m=_.$0A(e,n):h.href?u.push(_.edl(h.href)):"string"==typeof t&&(0,J.e)(t)?(m=_.tEo(t),h.getAttribute("notionUserId")&&a===l.length-2&&(c=!1)):o&&n&&(0,J.e)(o)&&(0,J.e)(n)&&(m=_.mfJ(o,n))}const v=p.find((e=>!!(e instanceof n.Element&&e.getAttribute(de[_.GKr.Discussion]))));if(v){const e=v.getAttribute(de[_.GKr.Discussion]);if(e){e.split(",").forEach((e=>u.push(_.jw(e))))}}const b=p.find((e=>e instanceof n.Element&&"sub"===e.tagName.toLowerCase()));let y;"true"===(null==b?void 0:b.getAttribute("confluenceProcessableEquation"))&&(y=`_{${b.textContent}}`);const S=p.find((e=>e instanceof n.Element&&"sup"===e.tagName.toLowerCase()));let w;"true"===(null==S?void 0:S.getAttribute("confluenceProcessableEquation"))&&(w=`^{${S.textContent}}`);const k=p.find((e=>e instanceof n.Element&&e.hasAttribute(de[_.GKr.Equation])));let I;null!=k&&k.textContent&&(I=k.textContent);const C=p.find((e=>e instanceof n.Element&&"time"===e.tagName.toLowerCase()));if(C){const e=C.getAttribute("datetime");if(e){const t=function(e,t){const n=o.ou.fromISO(e),r=n.toMillis();return r===n.startOf("day").toMillis()?K.OQ.toPersistedDate(r,t):K.OQ.toPersistedDateTime(r,t)}(e,i),n={...t};"relative"===C.getAttribute(de.dateFormat)&&(n.date_format="relative"),m=_.pZr(n)}}m?s.push(_.YCD(m,u)):y?s.push(_.qZ6(y,u)):w?s.push(_.qZ6(w,u)):I?s.push(_.qZ6(I,u)):s.push(_.V3y(d,u))}));return _.Zdj(s,1e5)};const _e=function(e){const t=["img[src]","a[download]",`a[${de[r.Ti.file]}]`,`audio[${de[r.Ti.audio]}]`,`video[${de[r.Ti.video]}]`],n=e.querySelectorAll(t.join(","));return $.p4(n)};function Se(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:i,allOperations:a,importFileMap:s,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:u,intl:p,randomID:m,randomShortID:f,isPhoneNumber:g}=e;return He({actor:t,parentId:n,parentTable:o,spaceId:r,nodes:_e(i),allOperations:a,importFileMap:s,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:u,intl:p,randomID:m,randomShortID:f,isPhoneNumber:g})}function we(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:i,type:a,allOperations:s,window:l,ignoreBlockCount:c,stripText:d,randomID:u}=e,p=u(),m={id:p,version:0,type:a,properties:{title:ye({node:i,window:l,stripText:d,ignoreComments:!0})},parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!c||void 0};return s.push({pointer:{table:v.iU,id:p,spaceId:r},command:"set",path:[],args:m}),qe({node:i,spaceId:r,window:l,blockId:p,actor:t,allOperations:s}),p}function ke(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,node:a,tableData:s,allOperations:l,ignoreBlockCount:c,intl:d,secureFileS3Url:u,secureFileS3UrlV2:p,randomID:m,randomShortID:f,isPhoneNumber:g,tableType:b,window:y}=e,_=m();if("table"===b){const{operations:e}=function(e){const{actor:t,parentId:n,tableId:o,parentTable:i,spaceId:a,ignoreBlockCount:s,randomID:l,randomShortID:c,table:d}=e,u=Date.now(),p=[],m=d.length?d[0].map((e=>c())):[],f=d.map((e=>l()));p.push(h.op.set({pointer:{id:o,table:v.iU,spaceId:a},path:[],args:{id:o,version:0,type:r.Ti.table,content:f,format:{table_block_column_order:m},properties:{},parent_id:n,space_id:a,parent_table:i,created_by_table:t.table,created_by_id:t.id,created_time:u,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:u,alive:!0,ignore_block_count:!!s||void 0}}));const g=f.map(((e,n)=>{const i=S.m8(m.flatMap(((e,t)=>{var o;const r=null===(o=d[n])||void 0===o||null===(o=o[t])||void 0===o?void 0:o.textValue;return r?[[e,r]]:[]})));return h.op.set({pointer:{id:e,table:v.iU,spaceId:a},path:[],args:{id:e,version:0,type:r.Ti.tableRow,parent_id:o,parent_table:v.iU,alive:!0,space_id:a,properties:i,created_by_table:t.table,created_by_id:t.id,created_time:u,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:u}})}));return p.push(...g),{operations:p}}({actor:t,tableId:_,parentId:n,parentTable:o,spaceId:i,table:s,ignoreBlockCount:c,randomID:m,randomShortID:f});l.push(...e),qe({node:a,spaceId:i,window:y,blockId:_,actor:t,allOperations:l})}else if("collection"===b){const{operations:e}=x({actor:t,blockType:"collection_view",rootId:_,parentId:n,parentTable:o,spaceId:i,name:"",format:{table_wrap:!0},table:s,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:c,intl:d,randomID:m,randomShortID:f,isPhoneNumber:g});l.push(...e)}return _}function Ie(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,allOperations:a,ignoreBlockCount:s,randomID:l}=e,c=l(),d={id:c,version:0,type:r.Ti.divider,parent_id:n,parent_table:o,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!s||void 0};return a.push({pointer:{table:v.iU,id:c,spaceId:i},command:"set",path:[],args:d}),c}function Ce(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,source:a,allOperations:s,secureFileS3Url:l,secureFileS3UrlV2:c,ignoreBlockCount:d,randomID:p,fallbackWidth:m}=e;let f;"image"===a.type&&a.width?f=Math.min(a.width,le):m&&(f=Math.min(m,le));const g=p(),h={id:g,version:0,type:r.Ti.image,properties:{source:_.TPx(a.url)},format:{block_width:f},parent_id:n,parent_table:o,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!d||void 0},b=(0,u.ZP)(h,l,c);return h.file_ids=b.map((e=>e.id)),s.push({pointer:{table:v.iU,id:g,spaceId:i},command:"set",path:[],args:h}),g}function xe(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,node:i,sourceUrl:a,allOperations:s,ignoreBlockCount:l,randomID:c}=e,d=ce(i.getAttribute("height")),u=ce(i.getAttribute("width")),p=c();let m;try{m=new URL(a)}catch(g){m=a}const f={id:p,version:0,type:G.Dz({url:a,baseUrl:m instanceof URL?m.origin:m,publicDomainName:""}),properties:{source:_.TPx(a)},format:{block_width:u,block_height:d,block_full_width:!1,block_page_width:!(u||d),block_preserve_scale:!0},parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!l||void 0};return s.push({pointer:{table:v.iU,id:p,spaceId:r},command:"set",path:[],args:f}),p}function Te(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,source:i,allOperations:s,secureFileS3Url:l,secureFileS3UrlV2:c,ignoreBlockCount:d,randomID:p}=e,m=p(),f=G.Dz({url:i.url,baseUrl:i.url,publicDomainName:""}),g={id:m,version:0,type:"embed"===f?"file":f,properties:{title:_.TPx((0,Y.w2)(i.url)),source:a.iD(i.url)},format:{block_width:"image"===i.type&&i.width?Math.min(i.width,le):void 0},parent_id:n,parent_table:o,space_id:r,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!d||void 0},h=(0,u.ZP)(g,l,c);return g.file_ids=h.map((e=>e.id)),s.push({pointer:{table:v.iU,id:m,spaceId:r},command:"set",path:[],args:g}),m}function Me(e){return"#text"===e.nodeName?e.textContent?e.textContent:"":Array.from(e.childNodes).map((e=>{const t=e.nodeName.toLowerCase();return"br"===t?"\n":"div"===t?`${Me(e)}\n`:Me(e)})).map((e=>e.split("\n").map((e=>e.trimRight())).join("\n"))).join("")}function Pe(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}=e,b=f(),y=a.getAttribute(de.calloutBackground),_=y?pt(y):void 0,S=a.getAttribute(de.calloutIcon),w=S&&S.match(oe())?S:void 0,{title:k,children:I}=function(e){const{node:t,window:n}=e,o=$.p4(t.childNodes),[r,...i]=o;if(!r)return{title:[]};return me(n)(r)?{title:ye({node:r,window:n,stripText:!1,ignoreComments:!0}),children:i}:pe(r,n)?{title:ye({node:t,window:n,stripText:!1,ignoreComments:!0}),children:void 0}:{title:[],children:o}}({node:a,window:c}),C=Array.isArray(I)?He({actor:t,parentId:b,parentTable:v.iU,spaceId:i,nodes:I,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}):[],x={id:b,version:0,type:r.Ti.callout,content:C,properties:{title:k},format:{block_color:_,page_icon:w},parent_id:n,parent_table:o,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0};return s.push({pointer:{table:v.iU,id:b,spaceId:i},command:"set",path:[],args:x}),qe({node:a,spaceId:i,window:c,blockId:b,actor:t,allOperations:s}),b}function Ae(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,importFileMap:a,node:s,allOperations:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:p,randomID:m}=e,f=s.getAttribute(de[r.Ti.file])||"",g=a[f]?a[f].url:f;let h=s.getAttribute(de.fileAlias)||"";!h&&g.lastIndexOf("/")>=0&&(h=g.substring(g.lastIndexOf("/")+1));const b=m(),y={alive:!0,created_by_id:t.id,created_by_table:t.table,created_time:Date.now(),id:b,last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),parent_id:n,parent_table:o,space_id:i,properties:{source:_.TPx(g),title:_.TPx(h)},type:r.Ti.file,version:0,ignore_block_count:!!p||void 0},S=(0,u.ZP)(y,c,d);return y.file_ids=S.map((e=>e.id)),l.push({pointer:{table:v.iU,id:b,spaceId:i},command:"set",path:[],args:y}),b}const Re=/language-(\w+)/;function De(e){let t=null;return null==e||e.forEach(((e,n,o)=>{if(t)return;if(X.Y.hasOwnProperty(e))return void(t=e);const r=e.match(Re);r&&r.length>1&&X.Y.hasOwnProperty(r[1])&&(t=r[1])})),t}function Ee(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,node:a,allOperations:s,ignoreBlockCount:l,randomID:c,window:d}=e,u=c();let p=a.getAttribute(de[r.Ti.code]);if(!p){var m;p=De(null===(m=a.querySelector("code"))||void 0===m||null===(m=m.parentElement)||void 0===m?void 0:m.classList)}if(!p){var f;p=De(null===(f=a.querySelector("code"))||void 0===f?void 0:f.classList)}const g=p&&X.Y[p]?X.Y[p]:"Plain Text",h={id:u,version:0,type:r.Ti.code,properties:{title:_.TPx(Me(a)),language:_.TPx(g)},format:{code_wrap:!0},parent_id:n,parent_table:o,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!l||void 0};return s.push({pointer:{table:v.iU,id:u,spaceId:i},command:"set",path:[],args:h}),qe({node:a,spaceId:i,window:d,blockId:u,actor:t,allOperations:s}),u}function Be(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,node:a,allOperations:s,ignoreBlockCount:l,randomID:c}=e,d=c(),u={id:d,version:0,type:r.Ti.equation,properties:{title:_.TPx(Me(a))},parent_id:n,parent_table:o,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!l||void 0};return s.push({pointer:{table:v.iU,id:d,spaceId:i},command:"set",path:[],args:u}),d}function Fe(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,allOperations:a,ignoreBlockCount:s,randomID:l}=e,c=l(),d={id:c,version:0,type:r.Ti.tableOfContents,format:{block_color:"gray"},parent_id:n,parent_table:o,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!s||void 0};return a.push({pointer:{table:v.iU,id:c,spaceId:i},command:"set",path:[],args:d}),c}function Oe(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}=e,b=f(),[y,...S]=$.p4(a.childNodes),w=He({actor:t,parentId:b,parentTable:v.iU,spaceId:i,nodes:S,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}),k={id:b,version:0,type:r.Ti.quote,properties:{title:_.TPx(null!=y&&y.textContent?y.textContent.trim():"")},content:w,parent_id:n,parent_table:o,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0};return s.push({pointer:{table:v.iU,id:b,spaceId:i},command:"set",path:[],args:k}),qe({node:a,spaceId:i,blockId:b,actor:t,allOperations:s,window:c}),b}function Ze(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}=e,b=f(),y=a.querySelector("summary"),S=$.p4(a.childNodes).filter((e=>e!==y)),w=y&&y.textContent&&ye({node:y,window:c,stripText:!1,ignoreComments:!0}),k=He({actor:t,parentId:b,parentTable:v.iU,spaceId:i,nodes:S,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}),I={id:b,version:0,type:r.Ti.toggle,content:k,properties:{title:w||_.TPx("")},parent_id:n,parent_table:o,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0};return s.push({pointer:{table:v.iU,id:b,spaceId:i},command:"set",path:[],args:I}),b}function Ve(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}=e,b=f(),y=$.p4(a.children).filter((e=>e.hasAttribute(de[r.Ti.column]))).slice(0,8).map((e=>function(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,node:a,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}=e,b=f(),y=a.getAttribute(de[r.Ti.column]);let _;if(null!==y){const e=parseFloat(y);!Number.isNaN(e)&&e>0&&e<=1&&(_=e)}const S=He({actor:t,parentId:b,parentTable:v.iU,spaceId:i,nodes:$.p4(a.children),allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}),w={id:b,version:0,type:r.Ti.column,format:{column_ratio:_},content:S,parent_id:n,parent_table:o,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0};return s.push({pointer:{table:v.iU,id:b,spaceId:i},command:"set",path:[],args:w}),b}({actor:t,parentId:b,parentTable:v.iU,spaceId:i,node:e,allOperations:s,importFileMap:l,window:c,secureFileS3Url:d,secureFileS3UrlV2:u,ignoreBlockCount:p,intl:m,randomID:f,randomShortID:g,isPhoneNumber:h}))),_={id:b,version:0,type:r.Ti.columnList,content:y,parent_id:n,parent_table:o,space_id:i,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!p||void 0};return s.push({pointer:{table:v.iU,id:b,spaceId:i},command:"set",path:[],args:_}),b}const Ue=/^\[x\].*/,Ne=/^\[ \].*/,Le=/^[-\*\•].*/;function je(e){const{actor:t,parentId:n,parentTable:o,spaceId:a,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:f,randomID:g,randomShortID:h,isPhoneNumber:b}=e,y=g(),S=d.document.createElement("span"),w=[];$.p4(s.childNodes).forEach(((e,t)=>{0===t&&Xe(e,d)?w.push(e):0===t&&!($e(e,d)||Qe(e,d)||Ye(e,d))||pe(e,d)?(S.appendChild(e),e instanceof d.Element&&_e(e).forEach((e=>w.push(e)))):w.push(e)}));const k=He({actor:t,parentId:y,parentTable:"block",spaceId:a,nodes:w,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:f,randomID:g,randomShortID:h,isPhoneNumber:b}),I=Ue.test(S.textContent||""),C=Ne.test(S.textContent||"");let x;x=I||C?r.Ti.toDo:s.parentNode instanceof d.Element&&"ol"===s.parentNode.tagName.toLowerCase()?r.Ti.numberedList:r.Ti.bulletedList;let T=!1;x===r.Ti.toDo&&I&&(T=!0);const M={id:y,version:0,type:x,content:k,properties:{title:ye({node:S,window:d,stripText:!0,ignoreComments:!0}),checked:T?_.TPx(i.bx):void 0},parent_id:n,parent_table:o,space_id:a,created_by_table:t.table,created_by_id:t.id,created_time:Date.now(),last_edited_by_table:t.table,last_edited_by_id:t.id,last_edited_time:Date.now(),alive:!0,ignore_block_count:!!m||void 0};return l.push({pointer:{table:v.iU,id:y,spaceId:a},command:"set",path:[],args:M}),qe({node:S,spaceId:a,blockId:y,actor:t,allOperations:l,window:d}),y}function ze(e){const{node:t,spaceId:n,window:o,actor:r,discussionId:i,allOperations:a}=e,s=Array.from(t.querySelectorAll(`span[${de[re.CommentDiscussionId]}="${i}"]`)),l=Date.now(),c=[];for(const d of s){if(null===d.textContent||0===d.textContent.trim().length)continue;const e=d.getAttribute(de[_.GKr.Comment]);if(!e)continue;const t=ye({node:d,window:o,stripText:!0,ignoreComments:!1}),s=d.getAttribute(de[re.CommentAuthor]);c.push(e);const u={id:e,parent_id:i,parent_table:te.qF,space_id:n,version:1,created_time:l,last_edited_time:l,text:t,created_by_table:ne.KJ,created_by_id:s||r.id,alive:!0};a.push({pointer:{table:ee.x_,id:e,spaceId:n},command:"set",path:[],args:u})}return c}function qe(e){const{node:t,spaceId:n,blockId:o,actor:r,allOperations:i,window:a}=e,s=Array.from(t.querySelectorAll(`span[${de[_.GKr.Discussion]}]`)),l=new Map;for(const c of s){const e=c.getAttribute(de[_.GKr.Discussion]);if(!e)continue;e.split(",").forEach((e=>{if(l.has(e)){var t;null===(t=l.get(e))||void 0===t||null===(t=t.context)||void 0===t||t.push([c.textContent??"",[[_.GKr.Discussion,e]]])}else{const t={id:e,type:"default",parent_id:o,parent_table:v.iU,resolved:!1,context:[[c.textContent??"",[[_.GKr.Discussion,e]]]],space_id:n,version:0};l.set(e,t)}}))}!function(e){const{node:t,spaceId:n,window:o,blockId:r,actor:i,discussionToTextMap:a,allOperations:s}=e;for(const[l,c]of a.entries()){const e=ze({node:t,spaceId:n,window:o,discussionId:l,actor:i,allOperations:s});0!==e.length&&(c.comments=e,s.push({pointer:{table:te.qF,id:l,spaceId:n},command:"set",path:[],args:c},{pointer:{table:v.iU,id:r,spaceId:n},command:"listAfter",path:["discussions"],args:{id:l}}))}}({node:t,spaceId:n,window:a,blockId:o,actor:r,discussionToTextMap:l,allOperations:i})}function He(e){const{actor:t,parentId:n,parentTable:o,spaceId:r,nodes:i,allOperations:a,importFileMap:s,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:u,intl:p,randomID:m,randomShortID:g,isPhoneNumber:h,htmlParserErrors:v}=e;return f.G0(...i.map((e=>We({actor:t,parentId:n,parentTable:o,spaceId:r,node:e,allOperations:a,importFileMap:s,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:u,intl:p,randomID:m,randomShortID:g,isPhoneNumber:h,htmlParserErrors:v}))))}function We(e){const{actor:t,parentId:n,parentTable:o,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b,htmlParserErrors:y}=e;if(s&&s instanceof d.Element){const e=s.tagName.toLowerCase();if("div"===e&&"page-comments"===s.getAttribute("class")){return[mt({node:s,spaceId:i,window:d,allOperations:l,parentId:n,parentTable:o})]}if("h1"===e)return[we({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,type:r.Ti.header,allOperations:l,window:d,ignoreBlockCount:m,stripText:!0,randomID:h}),...Se({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("h2"===e)return[we({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,type:r.Ti.subHeader,allOperations:l,window:d,ignoreBlockCount:m,stripText:!0,randomID:h}),...Se({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("hr"===e)return[Ie({actor:t,parentId:n,parentTable:o,spaceId:i,allOperations:l,ignoreBlockCount:m,randomID:h})];if("h"===e[0])return[we({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,type:r.Ti.subSubHeader,allOperations:l,window:d,ignoreBlockCount:m,stripText:!0,randomID:h}),...Se({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("pre"===e||"code"===e||"div"===e&&s.className===se)return[Ee({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,allOperations:l,ignoreBlockCount:m,randomID:h,window:d}),...Se({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if(s.hasAttribute(de[r.Ti.callout]))return[Pe({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("blockquote"===e)return[Oe({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("details"===e)return[Ze({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("table"===e){const{tableData:S,tableFiles:w}=function(e){const{node:t,window:n,importFileMap:o,intl:i}=e,s=[],l=[],c=Array.from(t.querySelectorAll("tr")).filter((e=>e.closest("table")===t));for(const d of c){const e=[],t=[],c=Array.from(d.querySelectorAll("td, th")).filter((e=>e.closest("tr")===d));for(const i of c){const a=(i.textContent||"").trim(),s=Ke(i.getAttribute("rowspan"),1);e.push({text:a,textValue:ye({node:i,window:n,stripText:!1,ignoreComments:!0}),rowSpan:s});const l=Ke(i.getAttribute("colspan"),1);for(let t=1;t<l;t++)e.push({text:"",rowSpan:s});const c=_e(i);if(c.length){const e=f.oA(c.flatMap((e=>{var t;const n=e.getAttribute("src")||e.getAttribute(de[r.Ti.file])||e.getAttribute(de[r.Ti.audio])||e.getAttribute(de[r.Ti.video]),i=e.getAttribute(de.fileAlias);return n?{name:i||n,url:(null===(t=o[n])||void 0===t?void 0:t.url)||n}:void 0})));t.push(...e)}}e.length&&l.push(e);const u=a.CC(t);s.push({text:i.formatMessage({id:"htmlHelpers.table.fileColumnName",defaultMessage:"Files"}),textValue:u})}for(let r=0;r<l.length;r++){const e=l[r];for(let t=0;t<e.length;t++){const n=e[t].rowSpan;if(n>1)for(let e=1;e<n&&!(r+e>=l.length);e++){l[r+e].splice(t,0,{text:"",rowSpan:1})}}}return{tableData:l,tableFiles:s}}({node:s,window:d,importFileMap:c,intl:g});if(w.some((e=>{var t;return null===(t=e.textValue)||void 0===t?void 0:t.length})))for(let e=0;e<S.length;e++)S[e].push({text:w[e].text,textValue:w[e].textValue,columnType:{schema:{type:"file"},validate:f._z,coerce:f.yR}});let k="table";if(w.some((e=>{var t;return null===(t=e.textValue)||void 0===t?void 0:t.length}))&&(k="collection"),0===f.Ar(S).length)return[];try{return[ke({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,tableData:S,allOperations:l,ignoreBlockCount:m,secureFileS3Url:u,secureFileS3UrlV2:p,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b,tableType:k,window:d})]}catch(_){const t=(0,Q.tg)(_);if(!y||"CsvImportError"!==t.message)throw _;const n=y.get(e)||0;return y.set(e,n+1),[]}}if("div"===e&&s.hasAttribute(de[r.Ti.columnList]))return[Ve({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("nav"===e&&s.hasAttribute(de[r.Ti.tableOfContents]))return[Fe({actor:t,parentId:n,parentTable:o,spaceId:i,allOperations:l,ignoreBlockCount:m,randomID:h}),...Se({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("ul"===e||"ol"===e)return f.G0(...f.UI(s.children,(e=>We({actor:t,parentId:n,parentTable:o,spaceId:i,node:e,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b}))));if("li"===e||Ue.test(s.textContent||"")||Ne.test(s.textContent||"")||Le.test(s.textContent||""))return[je({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})];if("img"===e){const e=s.getAttribute("src");if(e)return[Ce({actor:t,parentId:n,parentTable:o,spaceId:i,source:c[e]||{type:"unknown",url:e},allOperations:l,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,randomID:h,fallbackWidth:s instanceof d.HTMLImageElement?s.width:void 0})]}if("a"===e&&s.getAttribute(de[r.Ti.file]))return[Ae({actor:t,parentId:n,parentTable:o,spaceId:i,importFileMap:c,node:s,allOperations:l,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,randomID:h})];if("a"===e&&0===$.p4(s.childNodes).length){const e=s.getAttribute("href");if(s.hasAttribute("download")&&e)return[Te({actor:t,parentId:n,parentTable:o,spaceId:i,source:c[e]||{type:"unknown",url:e},allOperations:l,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,randomID:h})]}if("video"===e){const e=s.querySelector("source");if(e){const r=e.getAttribute("src");if(r&&G.xL({url:r}))return[Te({actor:t,parentId:n,parentTable:o,spaceId:i,source:{type:"unknown",url:r},allOperations:l,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,randomID:h})]}}if("audio"===e){const e=s.querySelector("source");if(e){const r=e.getAttribute("src");if(r&&G._c({url:r}))return[Te({actor:t,parentId:n,parentTable:o,spaceId:i,source:{type:"unknown",url:r},allOperations:l,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,randomID:h})]}}if("iframe"===e){const e=s.getAttribute("src");if(e)return[xe({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,sourceUrl:e,allOperations:l,ignoreBlockCount:m,randomID:h})]}return"p"===e&&s.getAttribute("confluenceNewLine")?[we({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,type:r.Ti.text,allOperations:l,window:d,ignoreBlockCount:m,stripText:!0,randomID:h})]:s.hasAttribute(de[r.Ti.equation])?[Be({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,allOperations:l,ignoreBlockCount:m,randomID:h})]:[.../^\s*$/g.test(s.textContent||"")?[]:[we({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,type:r.Ti.text,allOperations:l,window:d,ignoreBlockCount:m,stripText:!1,randomID:h})],...Se({actor:t,parentId:n,parentTable:o,spaceId:i,node:s,allOperations:l,importFileMap:c,window:d,secureFileS3Url:u,secureFileS3UrlV2:p,ignoreBlockCount:m,intl:g,randomID:h,randomShortID:v,isPhoneNumber:b})]}return[]}function Ke(e,t){const n=null!==e?parseInt(e,10):t;return isFinite(n)?n:t}const Ge=function(e){if(e&&-1!==e.indexOf("em"))return parseInt(e)},$e=function(e,t){return e instanceof t.Element&&"img"===e.tagName.toLowerCase()},Qe=function(e,t){return e instanceof t.Element&&"video"===e.tagName.toLowerCase()},Ye=function(e,t){return e instanceof t.Element&&"audio"===e.tagName.toLowerCase()},Xe=function(e,t){return e instanceof t.Element&&"a"===e.tagName.toLowerCase()&&e.hasAttribute(de[r.Ti.file])},Je=function(e,t,n){const o=n.document.createElement(t);for(;e.firstChild;)o.appendChild(e.firstChild);for(let r=e.attributes.length-1;r>=0;--r){const t=e.attributes[r];o.setAttribute(t.name,t.value)}return e.parentNode&&e.parentNode.replaceChild(o,e),o},et=function(e,t,n){const o=n.document.createElement(t);for(;e.firstChild;)o.appendChild(e.firstChild);e.appendChild(o)},tt=function(e){const t=[];let n=e;for(;e.firstChild;){const o=e.firstChild;t.push(o),e.parentNode&&e.parentNode.insertBefore(o,n.nextSibling),n=o}const o=e.parentNode;return o&&(o.removeChild(e),o.normalize()),t};const nt=1e4;function ot(e,t){!function(e,t){const n=Array.from(e.querySelectorAll("p"));for(const o of n){let e=o.firstChild,n=0;for(;e&&n<nt;){let r=!1;if(e instanceof t.Element&&null!==e.textContent&&!e.textContent.trim()){const t=Array.from(e.querySelectorAll("br"));if(t.length>0){for(const n of t)o.insertBefore(n,e);r=!0}}const i=e.nextSibling;r&&o.removeChild(e),e=i,n+=1}}}(e,t);const n=Array.from(e.querySelectorAll("p"));for(let o=0;o<nt;o++){const e=n.shift();if(!e||!e.parentNode)return;const o=e.querySelector("br");if(!o)continue;if(o.parentElement!==e)continue;const r=t.document.createElement("p");e.parentNode.insertBefore(r,e.nextSibling);let i=o.nextSibling;for(;i;){const e=i.nextSibling;r.appendChild(i),i=e}e.removeChild(o),n.unshift(r)}}function rt(e){const t=e.match(/^([0-9]+)px$/i);if(t)return parseInt(t[1])}const it=function(e){const{rootNode:t,window:n,isInlineContent:o,emojiData:r}=e;!function(e){const{rootNode:t,window:n,emojiData:{emojiByName:o}}=e,r=Array.from(t.querySelectorAll("img[data-stringify-emoji]"));for(const i of r){const e=i.getAttribute("data-stringify-emoji")||"",t=e.match(/^:(.+):$/);if(!t||!i.parentNode)continue;const r=o[t[1]]||e;i.parentNode.replaceChild(n.document.createTextNode(r),i)}}({rootNode:t,window:n,emojiData:r}),t.normalize(),ot(t,n);const i=$.p4(t.childNodes);for(;i.length>0;){let e=i.shift();if(e instanceof n.Element&&e.parentNode&&"google-sheets-html-origin"===e.tagName.toLowerCase()){const t=$.p4(e.childNodes);for(const n of t)e.parentNode.insertBefore(n,e);i.unshift(...t),e.remove()}else if(e&&e.parentNode&&3===e.nodeType&&/^( |\t)*(\n)+( |\t)*$/.test(e.data))e.parentNode.removeChild(e);else if(e&&e instanceof n.Element&&e.parentNode&&ae[e.tagName.toLowerCase()])e.parentNode.removeChild(e);else{if(e instanceof n.HTMLElement){const t=(a=e.style.fontSize||void 0)&&-1!==a.indexOf("px")||a&&-1!==a.indexOf("pt")?parseInt(a):void 0,o=Ge(e.style.fontSize||void 0);(t&&t>=24||o&&o>2)&&(e=Je(e,"h1",n))}if(e instanceof n.HTMLElement&&("line-through"===e.style.textDecoration&&et(e,"del",n),"italic"===e.style.fontStyle&&et(e,"em",n),("bold"===e.style.fontWeight||e.style.fontWeight&&parseInt(e.style.fontWeight)>=500)&&et(e,"strong",n)),e instanceof n.HTMLImageElement){const t=rt(e.style.width);!e.width&&t&&(e.width=t)}if(e instanceof n.HTMLElement&&("b"===e.tagName.toLowerCase()?e=Je(e,"strong",n):"i"===e.tagName.toLowerCase()&&(e=Je(e,"em",n))),e instanceof n.HTMLElement&&"strong"===e.tagName.toLowerCase()&&"normal"===e.style.fontWeight&&(e=Je(e,"span",n)),e instanceof n.HTMLElement&&("section"===e.tagName.toLowerCase()||"article"===e.tagName.toLowerCase())&&(e=Je(e,"div",n)),e instanceof n.HTMLElement&&"div"===e.tagName.toLowerCase()&&"inline"===e.style.display&&(e=Je(e,"span",n)),e instanceof n.HTMLElement&&"input"===e.tagName.toLowerCase()&&"checkbox"===e.type){const t=e.checked,o=e.parentNode,r=n.document.createElement("span");r.textContent=`[${t?"x":" "}] `,o&&(o.insertBefore(r,e),o.removeChild(e)),i.push(r)}else{if(e instanceof n.HTMLElement&&"table"===e.tagName.toLowerCase()){const t=Array.from(e.querySelectorAll("tr")).map((e=>e.querySelectorAll("td, th")));if(t.every((e=>1===e.length))){const o=n.document.createDocumentFragment();for(const e of t){const t=e[0],r=t.childNodes.length;for(let e=0;e<r;e+=1){const n=t.childNodes[e];n&&(o.appendChild(n.cloneNode(!0)),i.push(n))}o.appendChild(n.document.createElement("hr"))}e.parentNode&&e.parentNode.replaceChild(o,e)}}if(e instanceof n.HTMLElement&&("ul"===e.tagName.toLowerCase()||"ol"===e.tagName.toLowerCase())&&e.parentNode instanceof n.HTMLElement&&("ul"===e.parentNode.tagName.toLowerCase()||"ol"===e.parentNode.tagName.toLowerCase())&&e.previousSibling instanceof n.HTMLElement&&"li"===e.previousSibling.tagName.toLowerCase()&&e.previousSibling.appendChild(e),e instanceof n.Element&&(e.removeAttribute("style"),e.removeAttribute("dir")),e instanceof n.Element&&"span"===e.tagName.toLowerCase()){if("page-comment"===e.getAttribute("class"))continue;(e.hasAttribute(de[_.GKr.Highlight])||e.hasAttribute(de[_.GKr.Discussion])||e.hasAttribute(de[_.GKr.Comment])||e.hasAttribute(de[_.GKr.Equation])?Array.from(e.children):tt(e)).forEach((e=>i.push(e)))}else if(e){$.p4(e.childNodes).forEach((e=>i.push(e)))}}}}var a;for($.p4(t.childNodes).forEach((e=>i.push(e)));i.length>0;){const e=i.shift();if(e)if(at(e,n)&&f.yW(e.childNodes,(e=>e instanceof n.Element&&"h1"===e.tagName.toLowerCase()))){const t=n.document.createElement("h1");f.S6(e.childNodes,(e=>{f.S6(e.childNodes,(e=>{e&&t.appendChild(e)}))}));const o=e.parentNode;if(o){if("td"===e.tagName.toLowerCase()||"th"===e.tagName.toLowerCase()){const r=n.document.createElement(e.tagName.toLowerCase());r.appendChild(t),o.insertBefore(r,e)}else o.insertBefore(t,e);o.removeChild(e)}i.push(t)}else if(at(e,n)&&f.yW(e.childNodes,(e=>e instanceof n.Element&&"h2"===e.tagName.toLowerCase()))){const t=n.document.createElement("h2");f.S6(e.childNodes,(e=>{f.S6(e.childNodes,(e=>{e&&t.appendChild(e)}))}));const o=e.parentNode;if(o){if("td"===e.tagName.toLowerCase()||"th"===e.tagName.toLowerCase()){const r=n.document.createElement(e.tagName.toLowerCase());r.appendChild(t),o.insertBefore(r,e)}else o.insertBefore(t,e);o.removeChild(e)}i.push(t)}else if(e instanceof n.HTMLElement&&("div"===e.tagName.toLowerCase()||"span"===e.tagName.toLowerCase())&&e.parentNode&&0===e.childNodes.length)e.parentNode.removeChild(e);else if(!at(e,n)||"p"!==e.tagName.toLowerCase()&&"div"!==e.tagName.toLowerCase()&&"figure"!==e.tagName.toLowerCase()||!$.p4(e.childNodes).some((e=>e instanceof n.Element&&("p"===e.tagName.toLowerCase()||"div"===e.tagName.toLowerCase()||"img"===e.tagName.toLowerCase()||"ul"===e.tagName.toLowerCase()||"table"===e.tagName.toLowerCase()||"hr"===e.tagName.toLowerCase()||"video"===e.tagName.toLowerCase())))){if(e&&e.childNodes){$.p4(e.childNodes).forEach((e=>i.push(e)))}}else{tt(e).forEach((e=>i.push(e)))}}t.normalize(),o||$.p4(t.childNodes).forEach((e=>{if(3===e.nodeType){const o=n.document.createElement("p");t.insertBefore(o,e),o.appendChild(e)}}))};function at(e,t){return e instanceof t.Element&&(0!==e.childNodes.length&&!(e.hasAttribute(de[r.Ti.columnList])||e.hasAttribute(de[r.Ti.column])||e.hasAttribute(de[r.Ti.callout])))}function st(e){const{actor:t,parentId:n,spaceId:o,parentTable:r,rootNode:i,importFileMap:a,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:u,intl:p,randomID:m,randomShortID:f,isPhoneNumber:g,emojiData:h,htmlParserErrors:v,useCrdt:b}=e;it({rootNode:i,window:l,isInlineContent:!1,emojiData:h});const y=[],_=He({actor:t,parentId:n,parentTable:r,spaceId:o,nodes:$.p4(i.children),allOperations:y,importFileMap:a,window:l,secureFileS3Url:c,secureFileS3UrlV2:d,ignoreBlockCount:u,intl:p,randomID:m,randomShortID:f,isPhoneNumber:g,htmlParserErrors:v});return{allOperations:(0,s.Vt)(y,b),rootContentIds:_}}const lt=function(e){const{node:t,window:n,stripText:o,emojiData:r}=e;return it({rootNode:t,window:n,isInlineContent:!0,emojiData:r}),ye({node:t,window:n,stripText:o,ignoreComments:!0})};function ct(e){const{node:t,window:n,emojiData:o}=e;return it({rootNode:t,window:n,isInlineContent:!1,emojiData:o}),ut(t,n)}const dt=new Set(["span","div","p"]);function ut(e,t){const n=e.tagName.toLowerCase();if(!dt.has(n))return!0;if("div"===n&&(e.className===se||e.hasAttribute(de[r.Ti.columnList])))return!0;for(const o of Array.from(e.childNodes))if(ue(t,o)&&ut(o,t))return!0;return!1}function pt(e){if("default"===e||"gray"===e||"brown"===e||"orange"===e||"yellow"===e||"teal"===e||"blue"===e||"purple"===e||"pink"===e||"red"===e||"gray_background"===e||"brown_background"===e||"orange_background"===e||"yellow_background"===e||"teal_background"===e||"blue_background"===e||"purple_background"===e||"pink_background"===e||"red_background"===e)return e}function mt(e){const{node:t,spaceId:n,window:o,allOperations:r,parentId:i,parentTable:a}=e,s=(0,J.ZP)();return r.push({pointer:{table:te.qF,id:s,spaceId:n},path:[],command:"set",args:{id:s,parent_id:i,parent_table:a,resolved:!1,space_id:n,version:1}},{pointer:{table:a,id:i,spaceId:n},path:["discussions"],command:"listAfter",args:{id:s}}),t.querySelectorAll("span").forEach((e=>{const t=`${e.getAttribute("data-author-name")} commented: ${e.innerHTML.replace("\n"," ")}`;e.innerHTML=t;const i=ye({node:e,window:o,stripText:!0,ignoreComments:!0}),a=(0,J.ZP)(),l=Date.now();r.push({pointer:{table:ee.x_,id:a,spaceId:n},path:[],args:{id:a,parent_id:s,parent_table:te.qF,alive:!0,space_id:n,created_time:l,last_edited_time:l,version:1},command:"set"},{pointer:{table:te.qF,id:s,spaceId:n},path:["comments"],command:"listAfter",args:{id:a}},{pointer:{table:ee.x_,id:a,spaceId:n},path:["text"],command:"set",args:i},{pointer:{table:ee.x_,id:a,spaceId:n},path:[],command:"update",args:{created_by_id:ne.UO.id,created_by_table:ne.KJ}})})),s}},52897:(e,t,n)=>{n.d(t,{d:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("aiImproveWriting",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M8.84082 0.982422C8.84082 0.524414 8.45801 0.134766 8 0.134766C7.54199 0.134766 7.15234 0.524414 7.15234 0.982422V3.06738C7.15234 3.52539 7.54199 3.9082 8 3.9082C8.45801 3.9082 8.84082 3.52539 8.84082 3.06738V0.982422ZM10.9463 3.9082C10.6318 4.22949 10.6318 4.77637 10.96 5.10449C11.2744 5.41895 11.8281 5.41895 12.1494 5.09082L13.5781 3.66211C13.8994 3.34766 13.8926 2.79395 13.5645 2.46582C13.25 2.14453 12.6963 2.1582 12.375 2.47949L10.9463 3.9082ZM3.84375 5.09082C4.16504 5.41895 4.71875 5.41895 5.0332 5.10449C5.36133 4.77637 5.36133 4.22949 5.04688 3.9082L3.625 2.47949C3.30371 2.1582 2.75 2.14453 2.43555 2.46582C2.10742 2.78711 2.10742 3.34082 2.42188 3.65527L3.84375 5.09082ZM13.3047 14.9277C13.7148 15.3447 14.4121 15.3379 14.8154 14.9277C15.2188 14.5107 15.2188 13.834 14.8154 13.417L8.32812 6.88184C7.91797 6.47168 7.2207 6.47168 6.81738 6.88184C6.40723 7.29883 6.41406 7.97559 6.81738 8.38574L13.3047 14.9277ZM0.931641 7.19629C0.473633 7.19629 0.0908203 7.5791 0.0908203 8.03711C0.0908203 8.49512 0.473633 8.87793 0.931641 8.87793H3.0166C3.47461 8.87793 3.86426 8.49512 3.86426 8.03711C3.86426 7.5791 3.47461 7.19629 3.0166 7.19629H0.931641ZM15.0615 8.87793C15.5195 8.87793 15.9092 8.49512 15.9092 8.03711C15.9092 7.5791 15.5195 7.19629 15.0615 7.19629H12.9834C12.5254 7.19629 12.1357 7.5791 12.1357 8.03711C12.1357 8.49512 12.5254 8.87793 12.9834 8.87793H15.0615ZM9.62695 10.1357L7.49414 7.99609C7.32324 7.83203 7.26172 7.62012 7.43262 7.45605C7.58301 7.30566 7.80176 7.36035 7.97266 7.53125L10.0918 9.65723L9.62695 10.1357ZM2.42188 12.3984C2.10059 12.7197 2.09375 13.2734 2.4082 13.5879C2.72949 13.916 3.2832 13.9229 3.60449 13.6084L5.0332 12.1797C5.35449 11.8584 5.36133 11.3115 5.04688 10.9902C4.72559 10.6689 4.17188 10.6621 3.85059 10.9766L2.42188 12.3984ZM8.84082 13.0137C8.84082 12.5557 8.45801 12.166 8 12.166C7.54199 12.166 7.15234 12.5557 7.15234 13.0137V15.0918C7.15234 15.5498 7.54199 15.9395 8 15.9395C8.45801 15.9395 8.84082 15.5498 8.84082 15.0918V13.0137Z"})})},9999:(e,t,n)=>{n.d(t,{J:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("alias",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M13.1475 10.5869V3.72363C13.1475 3.25195 12.833 2.93066 12.3477 2.93066H5.48438C5.02637 2.93066 4.70508 3.27246 4.70508 3.67578C4.70508 4.07227 5.05371 4.40039 5.46387 4.40039H7.89746L10.8438 4.30469L9.59961 5.39844L3.08496 11.9199C2.92773 12.0771 2.8457 12.2686 2.8457 12.46C2.8457 12.8564 3.20801 13.2256 3.61816 13.2256C3.80957 13.2256 3.99414 13.1504 4.15137 12.9932L10.6729 6.47168L11.7803 5.22754L11.6641 8.05762V10.6074C11.6641 11.0176 11.9922 11.373 12.4023 11.373C12.8057 11.373 13.1475 11.0312 13.1475 10.5869Z"})})},82477:(e,t,n)=>{n.d(t,{L:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("alignCenter",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M14.44 15.325H1.554a.598.598 0 01-.602-.602c0-.335.267-.601.602-.601H14.44c.334 0 .608.266.608.601a.604.604 0 01-.608.602zm0-13.447H1.554a.598.598 0 01-.602-.601c0-.335.267-.602.602-.602H14.44c.334 0 .608.267.608.602a.604.604 0 01-.608.601zm-8.736 10.34h4.738c1.12 0 1.776-.65 1.776-1.905V5.687c0-1.254-.656-1.905-1.922-1.905H5.704c-1.266 0-1.922.65-1.922 1.905v4.626c0 1.254.656 1.905 1.922 1.905zm.07-1.149c-.545 0-.843-.28-.843-.85V5.78c0-.568.298-.85.843-.85h4.452c.539 0 .843.282.843.85v4.44c0 .568-.304.85-.697.85H5.774z"})})},70622:(e,t,n)=>{n.d(t,{$:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("alignLeft",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M14.44 15.325H1.554a.598.598 0 01-.602-.602c0-.335.267-.601.602-.601H14.44c.334 0 .608.266.608.601a.604.604 0 01-.608.602zm0-13.447H1.554a.598.598 0 01-.602-.601c0-.335.267-.602.602-.602H14.44c.334 0 .608.267.608.602a.604.604 0 01-.608.601zM3.372 12.218H8.11c1.12 0 1.776-.65 1.776-1.905V5.687c0-1.254-.657-1.905-1.922-1.905H3.372c-1.266 0-1.922.65-1.922 1.905v4.626c0 1.254.656 1.905 1.922 1.905zm.07-1.149c-.545 0-.844-.28-.844-.85V5.78c0-.568.3-.85.844-.85h4.451c.54 0 .844.282.844.85v4.44c0 .568-.305.85-.697.85H3.442z"})})},53376:(e,t,n)=>{n.d(t,{g:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("alignRight",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M14.44 15.325H1.554a.598.598 0 01-.602-.602c0-.335.267-.601.602-.601H14.44c.334 0 .608.266.608.601a.604.604 0 01-.608.602zm0-13.447H1.554a.598.598 0 01-.602-.601c0-.335.267-.602.602-.602H14.44c.334 0 .608.267.608.602a.604.604 0 01-.608.601zm-6.408 10.34h4.738c1.12 0 1.776-.65 1.776-1.905V5.687c0-1.254-.657-1.905-1.922-1.905H8.032c-1.266 0-1.922.65-1.922 1.905v4.626c0 1.254.656 1.905 1.922 1.905zm.07-1.149c-.545 0-.844-.28-.844-.85V5.78c0-.568.3-.85.844-.85h4.451c.54 0 .844.282.844.85v4.44c0 .568-.305.85-.697.85H8.102z"})})},33907:(e,t,n)=>{n.d(t,{n:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("arrowRight",{viewBox:"0 0 30 30",svg:(0,r.jsx)("polygon",{points:"1 14 25.188 14 16.594 5.406 18 4 29 15 18 26 16.594 24.594 25.188 16 1 16"})})},12970:(e,t,n)=>{n.d(t,{O:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("assistFindActionItems",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M3.15503 7.44971C4.80298 7.44971 6.16748 6.0918 6.16748 4.43726C6.16748 2.78271 4.80957 1.41821 3.15503 1.41821C1.4939 1.41821 0.135986 2.78271 0.135986 4.43726C0.135986 6.0918 1.4939 7.44971 3.15503 7.44971ZM2.79248 6.06543C2.63428 6.06543 2.50903 5.97974 2.40356 5.85449L1.66528 4.97778C1.58618 4.87891 1.55322 4.7998 1.55322 4.68774C1.55322 4.45044 1.7312 4.27246 1.95532 4.27246C2.10034 4.27246 2.18604 4.33179 2.28491 4.45044L2.78589 5.0437L3.95264 3.17822C4.05151 3.02002 4.17017 2.94751 4.32178 2.94751C4.55249 2.94751 4.74365 3.1189 4.74365 3.33643C4.74365 3.42871 4.71729 3.5144 4.64478 3.62646L3.18799 5.84131C3.0957 5.97974 2.95068 6.06543 2.79248 6.06543ZM8.47461 5.16235H15.1257C15.5278 5.16235 15.8574 4.84595 15.8574 4.43726C15.8574 4.03516 15.5278 3.71216 15.1257 3.71216H8.47461C8.07251 3.71216 7.74951 4.03516 7.74951 4.43726C7.74951 4.84595 8.07251 5.16235 8.47461 5.16235ZM3.15503 15.0566C4.80957 15.0566 6.16748 13.6921 6.16748 12.0376C6.16748 10.3831 4.80957 9.01855 3.15503 9.01855C1.4939 9.01855 0.135986 10.3831 0.135986 12.0376C0.135986 13.6921 1.4939 15.0566 3.15503 15.0566ZM3.15503 13.6592C2.27173 13.6592 1.53345 12.9209 1.53345 12.0376C1.53345 11.1543 2.27173 10.416 3.15503 10.416C4.03833 10.416 4.77661 11.1543 4.77661 12.0376C4.77661 12.9209 4.03833 13.6592 3.15503 13.6592ZM8.47461 12.7957H15.1257C15.5278 12.7957 15.8574 12.4727 15.8574 12.0706C15.8574 11.6685 15.5278 11.3455 15.1257 11.3455H8.47461C8.07251 11.3455 7.74951 11.6685 7.74951 12.0706C7.74951 12.4727 8.07251 12.7957 8.47461 12.7957Z"})})},83096:(e,t,n)=>{n.d(t,{Q:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("book",{viewBox:"0 0 30 30",svg:(0,r.jsx)("path",{d:"M27,23V1H7C4.791,1,3,2.791,3,5v20c0,2.209,1.791,4,4,4h20v-2h-1v-4H27z M21,3v6l-1-1.333L19,9V3H21z M20,11l3,4V3h2v18H9V3 h8v12L20,11z M5,5c0-1.103,0.896-2,2-2v18c-0.729,0-1.411,0.195-2,0.537V5z M24,27H7c-1.104,0-2-0.896-2-2s0.896-2,2-2h17V27z"})})},49089:(e,t,n)=>{n.d(t,{o:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("caption",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.87 8.975h6.74c1.119 0 1.775-.65 1.775-1.904V2.444c0-1.254-.656-1.904-1.922-1.904H2.871C1.605.54.949 1.19.949 2.444V7.07c0 1.254.656 1.904 1.922 1.904zm.07-1.148c-.544 0-.843-.282-.843-.85v-4.44c0-.568.299-.849.844-.849h6.451c.54 0 .844.281.844.85v4.44c0 .567-.305.849-.697.849H2.94zm-1.39 4.386h12.893a.604.604 0 00.608-.601.604.604 0 00-.608-.602H1.55a.598.598 0 00-.601.602c0 .335.266.601.601.601zm8.49 3.247H1.55a.598.598 0 01-.601-.601c0-.335.266-.602.601-.602h8.49c.336 0 .609.267.609.602a.604.604 0 01-.608.601z"})})},36591:(e,t,n)=>{n.d(t,{e:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("check",{viewBox:"0 0 14 14",svg:(0,r.jsx)("polygon",{points:"5.5 11.9993304 14 3.49933039 12.5 2 5.5 8.99933039 1.5 4.9968652 0 6.49933039"})})},22225:(e,t,n)=>{n.d(t,{g:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("checkPartial",{viewBox:"0 0 14 14",svg:(0,r.jsx)("rect",{x:"1.75",y:"6.125",width:"10.5",height:"1.75"})})},72261:(e,t,n)=>{n.d(t,{v:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("checkboxCircle",{viewBox:"0 0 22 23",svg:(0,r.jsx)("circle",{cx:"11",cy:"11.5",r:"10",stroke:"#E2E1DE",strokeWidth:"2"})})},65628:(e,t,n)=>{n.d(t,{z:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("checkboxSquare",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M1.5,1.5 L1.5,14.5 L14.5,14.5 L14.5,1.5 L1.5,1.5 Z M0,0 L16,0 L16,16 L0,16 L0,0 Z"})})},42853:(e,t,n)=>{n.d(t,{i:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("chevronDown",{viewBox:"0 0 30 30",svg:(0,r.jsx)("polygon",{points:"15,17.4 4.8,7 2,9.8 15,23 28,9.8 25.2,7 "})})},17693:(e,t,n)=>{n.d(t,{A:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("chevronDownRoundedThick",{viewBox:"0 0 12 12",svg:(0,r.jsx)("path",{d:"M6.02734 8.80274C6.27148 8.80274 6.47168 8.71484 6.66211 8.51465L10.2803 4.82324C10.4268 4.67676 10.5 4.49609 10.5 4.28125C10.5 3.85156 10.1484 3.5 9.72363 3.5C9.50879 3.5 9.30859 3.58789 9.15234 3.74902L6.03223 6.9668L2.90722 3.74902C2.74609 3.58789 2.55078 3.5 2.33105 3.5C1.90137 3.5 1.55469 3.85156 1.55469 4.28125C1.55469 4.49609 1.62793 4.67676 1.77441 4.82324L5.39258 8.51465C5.58789 8.71973 5.78808 8.80274 6.02734 8.80274Z"})})},5257:(e,t,n)=>{n.d(t,{o:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("chevronRight",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M12.375 8.06445C12.375 7.83203 12.2861 7.63379 12.1084 7.45605L6.77637 2.24023C6.62598 2.08984 6.44141 2.01465 6.22266 2.01465C5.77832 2.01465 5.42285 2.35645 5.42285 2.80078C5.42285 3.01953 5.51172 3.21777 5.66211 3.375L10.4746 8.06445L5.66211 12.7539C5.51855 12.9043 5.42285 13.1025 5.42285 13.3213C5.42285 13.7725 5.77832 14.1143 6.22266 14.1143C6.44141 14.1143 6.62598 14.0391 6.77637 13.8887L12.1084 8.67285C12.293 8.49512 12.375 8.29688 12.375 8.06445Z"})})},53465:(e,t,n)=>{n.d(t,{X:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("clearInput",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M7.993 15.528a7.273 7.273 0 01-2.923-.593A7.633 7.633 0 012.653 13.3a7.797 7.797 0 01-1.633-2.417 7.273 7.273 0 01-.593-2.922c0-1.035.198-2.01.593-2.922A7.758 7.758 0 015.063.99 7.273 7.273 0 017.985.395a7.29 7.29 0 012.93.593 7.733 7.733 0 012.417 1.64 7.647 7.647 0 011.64 2.41c.396.914.594 1.888.594 2.923 0 1.035-.198 2.01-.593 2.922a7.735 7.735 0 01-4.058 4.05 7.272 7.272 0 01-2.922.594zM5.59 11.06c.2 0 .371-.066.513-.198L8 8.951l1.904 1.911a.675.675 0 00.498.198.667.667 0 00.491-.198.67.67 0 00.205-.49.64.64 0 00-.205-.491L8.981 7.969l1.92-1.911a.686.686 0 00.204-.491.646.646 0 00-.205-.484.646.646 0 00-.483-.205.67.67 0 00-.49.205L8 6.995 6.081 5.083a.696.696 0 00-.49-.19.682.682 0 00-.491.198.651.651 0 00-.198.49c0 .181.068.342.205.484l1.912 1.904-1.912 1.92a.646.646 0 00-.205.483c0 .19.066.354.198.49.136.132.3.198.49.198z"})})},19525:(e,t,n)=>{n.d(t,{b:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("closeThick",{viewBox:"0 0 8 8",svg:(0,r.jsx)("polygon",{points:"8 1.01818182 6.98181818 0 4 2.98181818 1.01818182 0 0 1.01818182 2.98181818 4 0 6.98181818 1.01818182 8 4 5.01818182 6.98181818 8 8 6.98181818 5.01818182 4"})})},3124:(e,t,n)=>{n.d(t,{_:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("codeOnly",{viewBox:"0 0 24 20",svg:(0,r.jsx)("path",{d:"M8.093 13.62c.458.123.875-.123 1.011-.58l3.364-11.533c.13-.43-.082-.855-.54-.978-.451-.123-.848.075-.998.581L7.58 12.595c-.137.465.041.895.513 1.025zM.115 7.064c0 .233.103.472.301.643l4.423 3.992c.362.328.848.322 1.148-.02.308-.342.267-.834-.082-1.149L2.077 7.064l3.828-3.472c.349-.315.39-.8.082-1.142-.3-.342-.786-.348-1.148-.02L.416 6.415a.879.879 0 00-.3.65zm19.763 0a.878.878 0 00-.3-.649L15.153 2.43c-.362-.328-.847-.322-1.148.02-.308.342-.267.827.082 1.142l3.828 3.472-3.828 3.466c-.349.315-.39.807-.082 1.149.3.341.786.348 1.148.02l4.423-3.992c.198-.17.3-.41.3-.643z"})})},35013:(e,t,n)=>{n.d(t,{i:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("collectionBoard",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.39697 14.4634H13.5964C15.0532 14.4634 15.8311 13.6921 15.8311 12.2485V4.24609C15.8311 2.80249 15.0532 2.03125 13.5964 2.03125H2.39697C0.940186 2.03125 0.162354 2.7959 0.162354 4.24609V12.2485C0.162354 13.6987 0.940186 14.4634 2.39697 14.4634ZM2.52222 12.9934C1.94214 12.9934 1.63232 12.7034 1.63232 12.0969V4.39771C1.63232 3.79126 1.94214 3.50122 2.52222 3.50122H4.92822V12.9934H2.52222ZM6.34546 12.9934V3.50122H9.64795V12.9934H6.34546ZM13.4712 3.50122C14.0447 3.50122 14.3611 3.79126 14.3611 4.39771V12.0969C14.3611 12.7034 14.0447 12.9934 13.4712 12.9934H11.0652V3.50122H13.4712Z"})})},21321:(e,t,n)=>{n.d(t,{N:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("collectionCalendar",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M3.29688 14.4561H12.7031C14.1797 14.4561 14.9453 13.6904 14.9453 12.2344V3.91504C14.9453 2.45215 14.1797 1.69336 12.7031 1.69336H3.29688C1.82031 1.69336 1.05469 2.45215 1.05469 3.91504V12.2344C1.05469 13.6973 1.82031 14.4561 3.29688 14.4561ZM3.27637 13.1162C2.70898 13.1162 2.39453 12.8154 2.39453 12.2207V5.9043C2.39453 5.30273 2.70898 5.00879 3.27637 5.00879H12.71C13.2842 5.00879 13.6055 5.30273 13.6055 5.9043V12.2207C13.6055 12.8154 13.2842 13.1162 12.71 13.1162H3.27637ZM6.68066 7.38086H7.08398C7.33008 7.38086 7.41211 7.30566 7.41211 7.05957V6.66309C7.41211 6.41699 7.33008 6.3418 7.08398 6.3418H6.68066C6.44141 6.3418 6.35938 6.41699 6.35938 6.66309V7.05957C6.35938 7.30566 6.44141 7.38086 6.68066 7.38086ZM8.92285 7.38086H9.31934C9.56543 7.38086 9.64746 7.30566 9.64746 7.05957V6.66309C9.64746 6.41699 9.56543 6.3418 9.31934 6.3418H8.92285C8.67676 6.3418 8.59473 6.41699 8.59473 6.66309V7.05957C8.59473 7.30566 8.67676 7.38086 8.92285 7.38086ZM11.1582 7.38086H11.5547C11.8008 7.38086 11.8828 7.30566 11.8828 7.05957V6.66309C11.8828 6.41699 11.8008 6.3418 11.5547 6.3418H11.1582C10.9121 6.3418 10.8301 6.41699 10.8301 6.66309V7.05957C10.8301 7.30566 10.9121 7.38086 11.1582 7.38086ZM4.44531 9.58203H4.84863C5.09473 9.58203 5.17676 9.50684 5.17676 9.26074V8.86426C5.17676 8.61816 5.09473 8.54297 4.84863 8.54297H4.44531C4.20605 8.54297 4.12402 8.61816 4.12402 8.86426V9.26074C4.12402 9.50684 4.20605 9.58203 4.44531 9.58203ZM6.68066 9.58203H7.08398C7.33008 9.58203 7.41211 9.50684 7.41211 9.26074V8.86426C7.41211 8.61816 7.33008 8.54297 7.08398 8.54297H6.68066C6.44141 8.54297 6.35938 8.61816 6.35938 8.86426V9.26074C6.35938 9.50684 6.44141 9.58203 6.68066 9.58203ZM8.92285 9.58203H9.31934C9.56543 9.58203 9.64746 9.50684 9.64746 9.26074V8.86426C9.64746 8.61816 9.56543 8.54297 9.31934 8.54297H8.92285C8.67676 8.54297 8.59473 8.61816 8.59473 8.86426V9.26074C8.59473 9.50684 8.67676 9.58203 8.92285 9.58203ZM11.1582 9.58203H11.5547C11.8008 9.58203 11.8828 9.50684 11.8828 9.26074V8.86426C11.8828 8.61816 11.8008 8.54297 11.5547 8.54297H11.1582C10.9121 8.54297 10.8301 8.61816 10.8301 8.86426V9.26074C10.8301 9.50684 10.9121 9.58203 11.1582 9.58203ZM4.44531 11.7832H4.84863C5.09473 11.7832 5.17676 11.708 5.17676 11.4619V11.0654C5.17676 10.8193 5.09473 10.7441 4.84863 10.7441H4.44531C4.20605 10.7441 4.12402 10.8193 4.12402 11.0654V11.4619C4.12402 11.708 4.20605 11.7832 4.44531 11.7832ZM6.68066 11.7832H7.08398C7.33008 11.7832 7.41211 11.708 7.41211 11.4619V11.0654C7.41211 10.8193 7.33008 10.7441 7.08398 10.7441H6.68066C6.44141 10.7441 6.35938 10.8193 6.35938 11.0654V11.4619C6.35938 11.708 6.44141 11.7832 6.68066 11.7832ZM8.92285 11.7832H9.31934C9.56543 11.7832 9.64746 11.708 9.64746 11.4619V11.0654C9.64746 10.8193 9.56543 10.7441 9.31934 10.7441H8.92285C8.67676 10.7441 8.59473 10.8193 8.59473 11.0654V11.4619C8.59473 11.708 8.67676 11.7832 8.92285 11.7832Z"})})},69628:(e,t,n)=>{n.d(t,{n:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("collectionGallery",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.0542 7.75952H5.96973C7.00464 7.75952 7.50562 7.25854 7.50562 6.19727V3.58691C7.50562 2.53223 7.00464 2.03125 5.96973 2.03125H2.0542C1.01929 2.03125 0.518311 2.53223 0.518311 3.58691V6.19727C0.518311 7.25854 1.01929 7.75952 2.0542 7.75952ZM10.0303 7.75952H13.9392C14.9741 7.75952 15.4751 7.25854 15.4751 6.19727V3.58691C15.4751 2.53223 14.9741 2.03125 13.9392 2.03125H10.0303C8.98877 2.03125 8.48779 2.53223 8.48779 3.58691V6.19727C8.48779 7.25854 8.98877 7.75952 10.0303 7.75952ZM2.06079 6.55322C1.83008 6.55322 1.71802 6.44116 1.71802 6.20386V3.58032C1.71802 3.34961 1.83008 3.23755 2.06079 3.23755H5.96313C6.18726 3.23755 6.30591 3.34961 6.30591 3.58032V6.20386C6.30591 6.44116 6.18726 6.55322 5.96313 6.55322H2.06079ZM10.0369 6.55322C9.79956 6.55322 9.69409 6.44116 9.69409 6.20386V3.58032C9.69409 3.34961 9.79956 3.23755 10.0369 3.23755H13.9392C14.1633 3.23755 14.2754 3.34961 14.2754 3.58032V6.20386C14.2754 6.44116 14.1633 6.55322 13.9392 6.55322H10.0369ZM2.0542 14.4634H5.96973C7.00464 14.4634 7.50562 13.969 7.50562 12.9077V10.2974C7.50562 9.24268 7.00464 8.7417 5.96973 8.7417H2.0542C1.01929 8.7417 0.518311 9.24268 0.518311 10.2974V12.9077C0.518311 13.969 1.01929 14.4634 2.0542 14.4634ZM10.0303 14.4634H13.9392C14.9741 14.4634 15.4751 13.969 15.4751 12.9077V10.2974C15.4751 9.24268 14.9741 8.7417 13.9392 8.7417H10.0303C8.98877 8.7417 8.48779 9.24268 8.48779 10.2974V12.9077C8.48779 13.969 8.98877 14.4634 10.0303 14.4634ZM2.06079 13.2637C1.83008 13.2637 1.71802 13.1516 1.71802 12.9143V10.2974C1.71802 10.0601 1.83008 9.94141 2.06079 9.94141H5.96313C6.18726 9.94141 6.30591 10.0601 6.30591 10.2974V12.9143C6.30591 13.1516 6.18726 13.2637 5.96313 13.2637H2.06079ZM10.0369 13.2637C9.79956 13.2637 9.69409 13.1516 9.69409 12.9143V10.2974C9.69409 10.0601 9.79956 9.94141 10.0369 9.94141H13.9392C14.1633 9.94141 14.2754 10.0601 14.2754 10.2974V12.9143C14.2754 13.1516 14.1633 13.2637 13.9392 13.2637H10.0369Z"})})},17948:(e,t,n)=>{n.d(t,{O:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("collectionList",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.08716 5.15576C2.64087 5.15576 3.08911 4.70752 3.08911 4.15381C3.08911 3.6001 2.64087 3.15186 2.08716 3.15186C1.53345 3.15186 1.08521 3.6001 1.08521 4.15381C1.08521 4.70752 1.53345 5.15576 2.08716 5.15576ZM5.29736 4.85254H14.2161C14.605 4.85254 14.9148 4.54272 14.9148 4.15381C14.9148 3.76489 14.605 3.45508 14.2161 3.45508H5.29736C4.90845 3.45508 4.59863 3.7583 4.59863 4.15381C4.59863 4.54272 4.90186 4.85254 5.29736 4.85254ZM2.08716 9.24927C2.64087 9.24927 3.08911 8.80103 3.08911 8.24731C3.08911 7.6936 2.64087 7.24536 2.08716 7.24536C1.53345 7.24536 1.08521 7.6936 1.08521 8.24731C1.08521 8.80103 1.53345 9.24927 2.08716 9.24927ZM5.29736 8.94604H14.2161C14.605 8.94604 14.9148 8.64282 14.9148 8.24731C14.9148 7.8584 14.605 7.54858 14.2161 7.54858H5.29736C4.90845 7.54858 4.59863 7.8584 4.59863 8.24731C4.59863 8.63623 4.90186 8.94604 5.29736 8.94604ZM2.08716 13.3428C2.64087 13.3428 3.08911 12.8945 3.08911 12.3408C3.08911 11.7937 2.64087 11.3389 2.08716 11.3389C1.53345 11.3389 1.08521 11.7937 1.08521 12.3408C1.08521 12.8945 1.53345 13.3428 2.08716 13.3428ZM5.29736 13.0396H14.2161C14.605 13.0396 14.9148 12.7363 14.9148 12.3408C14.9148 11.9519 14.605 11.6487 14.2161 11.6487H5.29736C4.90845 11.6487 4.59863 11.9519 4.59863 12.3408C4.59863 12.7297 4.90186 13.0396 5.29736 13.0396Z"})})},49019:(e,t,n)=>{n.d(t,{e:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("collectionSearch",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M0 6.35938C0 9.86719 2.85156 12.7188 6.35938 12.7188C7.66406 12.7188 8.85938 12.3203 9.85938 11.6406L13.4531 15.2344C13.6719 15.4609 13.9766 15.5625 14.2812 15.5625C14.9453 15.5625 15.4219 15.0625 15.4219 14.4141C15.4219 14.1016 15.3125 13.8125 15.1016 13.5938L11.5312 10.0156C12.2734 8.99219 12.7188 7.72656 12.7188 6.35938C12.7188 2.85156 9.86719 0 6.35938 0C2.85156 0 0 2.85156 0 6.35938ZM1.65625 6.35938C1.65625 3.76562 3.75781 1.65625 6.35938 1.65625C8.95312 1.65625 11.0625 3.76562 11.0625 6.35938C11.0625 8.95312 8.95312 11.0625 6.35938 11.0625C3.75781 11.0625 1.65625 8.95312 1.65625 6.35938Z"})})},10405:(e,t,n)=>{n.d(t,{_:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("collectionTimeline",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M13.5964 14.4634H2.39697C0.940186 14.4634 0.162354 13.6987 0.162354 12.2485V4.24609C0.162354 2.7959 0.940186 2.03125 2.39697 2.03125H13.5964C15.0532 2.03125 15.8311 2.80249 15.8311 4.24609V12.2485C15.8311 13.6921 15.0532 14.4634 13.5964 14.4634ZM1.63232 12.0969C1.63232 12.7034 1.94214 12.9934 2.52222 12.9934H13.4712C14.0447 12.9934 14.3611 12.7034 14.3611 12.0969V4.39771C14.3611 3.79126 14.0447 3.50122 13.4712 3.50122H2.52222C1.94214 3.50122 1.63232 3.79126 1.63232 4.39771V12.0969ZM8.92711 6.13826H2.71776C2.44986 6.13826 2.23645 5.91123 2.23645 5.64787C2.23645 5.37997 2.44986 5.15747 2.71776 5.15747H8.92711C9.19955 5.15747 9.40842 5.37542 9.40842 5.64787C9.40842 5.91577 9.19955 6.13826 8.92711 6.13826ZM11.3757 8.49036H4.75992C4.49201 8.49036 4.2786 8.26332 4.2786 7.99996C4.2786 7.73206 4.49201 7.50957 4.75992 7.50957H11.3757C11.6482 7.50957 11.857 7.72752 11.857 7.99996C11.857 8.26332 11.6482 8.49036 11.3757 8.49036ZM13.2822 10.8424H8.24608C7.97818 10.8424 7.76477 10.6109 7.76477 10.352C7.76477 10.0841 7.97818 9.85711 8.24608 9.85711H13.2822C13.5547 9.85711 13.7636 10.0796 13.7636 10.352C13.7636 10.6154 13.5547 10.8424 13.2822 10.8424Z"})})},75553:(e,t,n)=>{n.d(t,{U:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("copy",{viewBox:"0 0 14 16",svg:(0,r.jsx)("path",{d:"M2.404 15.322h5.701c1.26 0 1.887-.662 1.887-1.927V12.38h1.154c1.254 0 1.91-.662 1.91-1.928V5.555c0-.774-.158-1.266-.626-1.74L9.512.837C9.066.387 8.545.21 7.865.21H5.463c-1.254 0-1.91.662-1.91 1.928v1.084H2.404c-1.254 0-1.91.668-1.91 1.933v8.239c0 1.265.656 1.927 1.91 1.927zm7.588-6.62c0-.792-.1-1.161-.592-1.665L6.225 3.814c-.452-.462-.844-.58-1.5-.591V2.215c0-.533.28-.832.843-.832h2.38v2.883c0 .726.386 1.113 1.107 1.113h2.83v4.998c0 .539-.276.832-.844.832H9.992V8.701zm-.79-4.29c-.206 0-.288-.088-.288-.287V1.594l2.771 2.818H9.201zM2.503 14.15c-.563 0-.844-.293-.844-.832V5.232c0-.539.281-.837.85-.837h1.91v3.187c0 .85.416 1.26 1.26 1.26h3.14v4.476c0 .54-.28.832-.843.832H2.504zM5.79 7.816c-.24 0-.346-.105-.346-.345V4.547l3.223 3.27H5.791z"})})},56666:(e,t,n)=>{n.d(t,{o:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("dots",{viewBox:"0 0 13 3",svg:(0,r.jsxs)("g",{children:[(0,r.jsx)("path",{d:"M3,1.5A1.5,1.5,0,1,1,1.5,0,1.5,1.5,0,0,1,3,1.5Z"}),(0,r.jsx)("path",{d:"M8,1.5A1.5,1.5,0,1,1,6.5,0,1.5,1.5,0,0,1,8,1.5Z"}),(0,r.jsx)("path",{d:"M13,1.5A1.5,1.5,0,1,1,11.5,0,1.5,1.5,0,0,1,13,1.5Z"})]})})},64330:(e,t,n)=>{n.d(t,{a:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("download",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M8.215 15.126c3.862 0 7.061-3.192 7.061-7.062 0-3.862-3.199-7.061-7.068-7.061-3.862 0-7.055 3.2-7.055 7.061 0 3.87 3.2 7.062 7.062 7.062zm0-1.388a5.654 5.654 0 01-5.667-5.674 5.642 5.642 0 015.66-5.667 5.66 5.66 0 015.68 5.667 5.66 5.66 0 01-5.673 5.674zm0-9.174c-.342 0-.602.247-.602.588v3.234l.062 1.401-.622-.766-.766-.8a.557.557 0 00-.41-.177.54.54 0 00-.56.547c0 .164.054.3.163.41l2.256 2.283c.15.157.294.226.479.226.191 0 .335-.075.485-.226l2.256-2.283a.557.557 0 00.164-.41.539.539 0 00-.56-.547.523.523 0 00-.41.178l-.766.793-.622.779.054-1.408V5.152c0-.341-.253-.588-.601-.588z"})})},12217:(e,t,n)=>{n.d(t,{D:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("dragHandle",{viewBox:"0 0 10 10",svg:(0,r.jsx)("path",{d:"M3,2 C2.44771525,2 2,1.55228475 2,1 C2,0.44771525 2.44771525,0 3,0 C3.55228475,0 4,0.44771525 4,1 C4,1.55228475 3.55228475,2 3,2 Z M3,6 C2.44771525,6 2,5.55228475 2,5 C2,4.44771525 2.44771525,4 3,4 C3.55228475,4 4,4.44771525 4,5 C4,5.55228475 3.55228475,6 3,6 Z M3,10 C2.44771525,10 2,9.55228475 2,9 C2,8.44771525 2.44771525,8 3,8 C3.55228475,8 4,8.44771525 4,9 C4,9.55228475 3.55228475,10 3,10 Z M7,2 C6.44771525,2 6,1.55228475 6,1 C6,0.44771525 6.44771525,0 7,0 C7.55228475,0 8,0.44771525 8,1 C8,1.55228475 7.55228475,2 7,2 Z M7,6 C6.44771525,6 6,5.55228475 6,5 C6,4.44771525 6.44771525,4 7,4 C7.55228475,4 8,4.44771525 8,5 C8,5.55228475 7.55228475,6 7,6 Z M7,10 C6.44771525,10 6,9.55228475 6,9 C6,8.44771525 6.44771525,8 7,8 C7.55228475,8 8,8.44771525 8,9 C8,9.55228475 7.55228475,10 7,10 Z"})})},88437:(e,t,n)=>{n.d(t,{a:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("duplicate",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.83887 12.1523H4.00098V13.1846C4.00098 14.6406 4.75977 15.3994 6.24316 15.3994H13.1611C14.6377 15.3994 15.4033 14.6406 15.4033 13.1846V6.21191C15.4033 4.75586 14.6377 3.99707 13.1611 3.99707H11.999V2.96484C11.999 1.50879 11.2334 0.75 9.75684 0.75H2.83887C1.3623 0.75 0.59668 1.50195 0.59668 2.96484V9.93066C0.59668 11.3936 1.3623 12.1523 2.83887 12.1523ZM2.9209 10.8125C2.28516 10.8125 1.93652 10.4844 1.93652 9.82129V3.08105C1.93652 2.41797 2.28516 2.08301 2.9209 2.08301H9.68164C10.3105 2.08301 10.666 2.41797 10.666 3.08105V3.99707H6.24316C4.75977 3.99707 4.00098 4.75586 4.00098 6.21191V10.8125H2.9209ZM6.31836 14.0596C5.68262 14.0596 5.34082 13.7314 5.34082 13.0684V6.32812C5.34082 5.66504 5.68262 5.33691 6.31836 5.33691H13.0791C13.708 5.33691 14.0635 5.66504 14.0635 6.32812V13.0684C14.0635 13.7314 13.708 14.0596 13.0791 14.0596H6.31836Z"})})},75e3:(e,t,n)=>{n.d(t,{U:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("enter",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M5.38965 14.1667C5.81812 14.1667 6.10156 13.8767 6.10156 13.468C6.10156 13.2571 6.01587 13.0989 5.89062 12.967L4.18994 11.3125L3.02979 10.3369L4.55908 10.4028H12.7922C14.4402 10.4028 15.1389 9.65796 15.1389 8.04297V4.13403C15.1389 2.48608 14.4402 1.78735 12.7922 1.78735H9.13379C8.70532 1.78735 8.4021 2.11035 8.4021 2.50586C8.4021 2.90137 8.69873 3.22437 9.13379 3.22437H12.7593C13.4316 3.22437 13.7151 3.50781 13.7151 4.17358V7.99683C13.7151 8.67578 13.425 8.95923 12.7593 8.95923H4.55908L3.02979 9.03174L4.18994 8.04956L5.89062 6.39502C6.01587 6.26978 6.10156 6.11157 6.10156 5.89404C6.10156 5.48535 5.81812 5.19531 5.38965 5.19531C5.21167 5.19531 5.01392 5.27441 4.8689 5.41943L1.08521 9.1438C0.933594 9.28882 0.854492 9.48657 0.854492 9.68433C0.854492 9.87549 0.933594 10.0732 1.08521 10.2183L4.8689 13.9492C5.01392 14.0876 5.21167 14.1667 5.38965 14.1667Z"})})},37240:(e,t,n)=>{n.d(t,{s:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("expand",{viewBox:"-1 -1 9 11",svg:(0,r.jsx)("path",{id:"path0_stroke",d:"M 3.5 0L 3.98809 -0.569442L 3.5 -0.987808L 3.01191 -0.569442L 3.5 0ZM 3.5 9L 3.01191 9.56944L 3.5 9.98781L 3.98809 9.56944L 3.5 9ZM 0.488094 3.56944L 3.98809 0.569442L 3.01191 -0.569442L -0.488094 2.43056L 0.488094 3.56944ZM 3.01191 0.569442L 6.51191 3.56944L 7.48809 2.43056L 3.98809 -0.569442L 3.01191 0.569442ZM -0.488094 6.56944L 3.01191 9.56944L 3.98809 8.43056L 0.488094 5.43056L -0.488094 6.56944ZM 3.98809 9.56944L 7.48809 6.56944L 6.51191 5.43056L 3.01191 8.43056L 3.98809 9.56944Z"})})},13797:(e,t,n)=>{n.d(t,{F:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("factoryBlockSettings",{viewBox:"0 0 24 24",svg:(0,r.jsx)("path",{d:"M12,8c-2.209,0-4,1.791-4,4s1.791,4,4,4s4-1.791,4-4S14.209,8,12,8z M12,14c-1.104,0-2-0.896-2-2s0.896-2,2-2s2,0.896,2,2 S13.104,14,12,14z M24,15V9h-3.523c-0.105-0.299-0.227-0.589-0.361-0.872l2.491-2.492l-4.243-4.243l-2.491,2.491 C15.59,3.75,15.299,3.629,15,3.523V0H9v3.523C8.701,3.629,8.411,3.75,8.128,3.885L5.636,1.394L1.394,5.636l2.491,2.492 C3.75,8.411,3.629,8.701,3.523,9H0v6h3.523c0.106,0.299,0.227,0.589,0.362,0.872l-2.492,2.491l4.243,4.243l2.492-2.491 C8.411,20.25,8.701,20.371,9,20.477V24h6v-3.523c0.299-0.105,0.59-0.227,0.872-0.361l2.491,2.491l4.243-4.243l-2.491-2.491 c0.135-0.283,0.256-0.573,0.361-0.872H24z M19.778,18.363l-1.415,1.415l-2.077-2.077c-0.896,0.502-2.271,1.049-3.286,1.363V22h-2 v-2.936c-1.016-0.314-2.391-0.861-3.286-1.363l-2.078,2.077l-1.415-1.415L6.3,16.285C5.781,15.359,5.234,13.953,4.936,13H2v-2h2.936 C5.234,10.047,5.781,8.641,6.3,7.714L4.222,5.636l1.415-1.415l2.078,2.077C8.609,5.797,9.984,5.25,11,4.936V2h2v2.936 c1.016,0.314,2.391,0.861,3.286,1.363l2.077-2.077l1.415,1.415L17.7,7.714c0.519,0.926,1.065,2.333,1.364,3.286H22v2h-2.936 c-0.299,0.953-0.846,2.359-1.364,3.285L19.778,18.363z"})})},50066:(e,t,n)=>{n.d(t,{R:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("file",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M4.35645 15.4678H11.6367C13.0996 15.4678 13.8584 14.6953 13.8584 13.2256V7.02539C13.8584 6.0752 13.7354 5.6377 13.1406 5.03613L9.55176 1.38574C8.97754 0.804688 8.50586 0.667969 7.65137 0.667969H4.35645C2.89355 0.667969 2.13477 1.44043 2.13477 2.91016V13.2256C2.13477 14.7021 2.89355 15.4678 4.35645 15.4678ZM4.46582 14.1279C3.80273 14.1279 3.47461 13.7793 3.47461 13.1436V2.99219C3.47461 2.36328 3.80273 2.00781 4.46582 2.00781H7.37793V5.75391C7.37793 6.73145 7.86328 7.20312 8.83398 7.20312H12.5186V13.1436C12.5186 13.7793 12.1836 14.1279 11.5205 14.1279H4.46582ZM8.95703 6.02734C8.67676 6.02734 8.56055 5.9043 8.56055 5.62402V2.19238L12.334 6.02734H8.95703ZM8.59473 12.7266V10.6279L8.54004 9.56152L9.06641 10.1152L9.59277 10.6484C9.68848 10.7646 9.8457 10.833 9.98926 10.833C10.2969 10.833 10.5293 10.6143 10.5293 10.3066C10.5293 10.1357 10.4678 10.0127 10.3379 9.90332L8.45117 8.16699C8.29395 8.02344 8.16406 7.96191 7.99316 7.96191C7.8291 7.96191 7.69922 8.02344 7.54199 8.16699L5.65527 9.90332C5.52539 10.0127 5.46387 10.1357 5.46387 10.3066C5.46387 10.6143 5.68945 10.833 6.00391 10.833C6.14746 10.833 6.29785 10.7646 6.40039 10.6484L6.92676 10.1152L7.45312 9.56152L7.39844 10.6279V12.7266C7.39844 13.0547 7.67188 13.3008 7.99316 13.3008C8.32129 13.3008 8.59473 13.0547 8.59473 12.7266Z"})})},80750:(e,t,n)=>{n.d(t,{l:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("genericError",{viewBox:"0 0 32 32",svg:(0,r.jsx)("path",{d:"M16.0242 29.0485c7.1251 0 13.0243-5.8992 13.0243-13.0243C29.0485 8.91198 23.1365 3 16.0115 3 8.89922 3 3 8.91198 3 16.0242c0 7.1251 5.91198 13.0243 13.0242 13.0243zm-.0127-11.1089c-.6768 0-1.0471-.3959-1.0726-1.0726l-.1788-6.3078c-.0255-.70232.5108-1.20031 1.2386-1.20031.7151 0 1.2769.51076 1.2514 1.21301l-.1916 6.2951c-.0255.6895-.3958 1.0726-1.047 1.0726zm0 4.6989c-.7406 0-1.4301-.5874-1.4301-1.379 0-.7917.6767-1.3791 1.4301-1.3791.7533 0 1.4301.5746 1.4301 1.3791 0 .8044-.6895 1.379-1.4301 1.379z"})})},84169:(e,t,n)=>{n.d(t,{m:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("help",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M8 15.126C11.8623 15.126 15.0615 11.9336 15.0615 8.06445C15.0615 4.20215 11.8623 1.00293 7.99316 1.00293C4.13086 1.00293 0.938477 4.20215 0.938477 8.06445C0.938477 11.9336 4.1377 15.126 8 15.126ZM8 13.7383C4.85547 13.7383 2.33301 11.209 2.33301 8.06445C2.33301 4.91992 4.84863 2.39746 7.99316 2.39746C11.1377 2.39746 13.667 4.91992 13.6738 8.06445C13.6738 11.209 11.1445 13.7383 8 13.7383ZM7.84277 9.4248C8.21875 9.4248 8.45801 9.21289 8.47852 8.93262C8.47852 8.90527 8.47852 8.87109 8.47852 8.85059C8.49902 8.49512 8.74512 8.25586 9.18945 7.96875C9.85938 7.52441 10.2969 7.13477 10.2969 6.3418C10.2969 5.2002 9.27148 4.55078 8.06152 4.55078C6.89258 4.55078 6.09277 5.08398 5.88086 5.72656C5.83984 5.84277 5.81934 5.95898 5.81934 6.08203C5.81934 6.41016 6.0791 6.61523 6.35254 6.61523C6.60547 6.61523 6.76953 6.5127 6.90625 6.32812L7.01562 6.19141C7.24121 5.81543 7.56934 5.61719 7.97949 5.61719C8.5332 5.61719 8.90918 5.94531 8.90918 6.41016C8.90918 6.84082 8.62207 7.05273 8.04102 7.45605C7.55566 7.79102 7.2002 8.14648 7.2002 8.76855V8.84375C7.2002 9.22656 7.43262 9.4248 7.84277 9.4248ZM7.83594 11.5234C8.27344 11.5234 8.63574 11.2021 8.63574 10.7715C8.63574 10.3408 8.27344 10.0264 7.83594 10.0264C7.3916 10.0264 7.03613 10.3477 7.03613 10.7715C7.03613 11.2021 7.39844 11.5234 7.83594 11.5234Z"})})},74155:(e,t,n)=>{n.d(t,{u:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("helpButtonGuide",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M8 2.77344C7.39844 2.0625 6.05859 1.42676 4.48633 1.42676C2.3877 1.42676 0.692383 2.51367 0.241211 3.5459V13.8066C0.241211 14.4766 0.678711 14.7363 1.16406 14.7363C1.52637 14.7363 1.73145 14.627 1.96387 14.4561C2.42871 14.0801 3.1875 13.6426 4.48633 13.6426C5.79199 13.6426 6.68066 14.0801 7.07715 14.415C7.2959 14.5791 7.54883 14.7363 8 14.7363C8.45117 14.7363 8.69727 14.5654 8.92285 14.415C9.34668 14.1006 10.208 13.6426 11.5137 13.6426C12.8125 13.6426 13.585 14.0869 14.0361 14.4561C14.2686 14.627 14.4736 14.7363 14.8359 14.7363C15.3213 14.7363 15.7588 14.4766 15.7588 13.8066V3.5459C15.3076 2.51367 13.6191 1.42676 11.5137 1.42676C9.94141 1.42676 8.6084 2.0625 8 2.77344ZM1.72461 4.01758C1.90918 3.56641 2.9209 2.80078 4.48633 2.80078C6.05176 2.80078 7.09766 3.57324 7.26172 4.01758V13.0342C6.55762 12.5283 5.55273 12.2549 4.48633 12.2549C3.41309 12.2549 2.41504 12.5283 1.72461 13.0547V4.01758ZM14.2754 4.01758V13.0547C13.585 12.5283 12.5869 12.2549 11.5137 12.2549C10.4473 12.2549 9.44238 12.5283 8.73828 13.0342V4.01758C8.90234 3.57324 9.94824 2.80078 11.5137 2.80078C13.0791 2.80078 14.0908 3.56641 14.2754 4.01758Z"})})},5377:(e,t,n)=>{n.d(t,{y:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("image",{viewBox:"0 0 30 30",svg:(0,r.jsx)("path",{d:"M2,2v26h26V2H2z M26,26H4v-4h22V26z M26,20H4V4h22V20z M8,10c1.104,0,2-0.896,2-2S9.104,6,8,6S6,6.896,6,8S6.896,10,8,10z M18,7l-5,5l-2-1l-5,7h18L18,7z M11.635,13.553l1.76,0.881l4.129-4.129L20.631,16H9.887L11.635,13.553z"})})},44495:(e,t,n)=>{n.d(t,{D:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("info",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M7.97266 14.9453C11.7871 14.9453 14.9453 11.7803 14.9453 7.97266C14.9453 4.1582 11.7803 1 7.96582 1C4.1582 1 1 4.1582 1 7.97266C1 11.7803 4.16504 14.9453 7.97266 14.9453ZM7.97266 13.7832C4.74609 13.7832 2.16895 11.1992 2.16895 7.97266C2.16895 4.74609 4.73926 2.16211 7.96582 2.16211C11.1924 2.16211 13.7764 4.74609 13.7832 7.97266C13.79 11.1992 11.1992 13.7832 7.97266 13.7832ZM7.91113 5.53906C8.41016 5.53906 8.7998 5.14258 8.7998 4.64355C8.7998 4.14453 8.41016 3.74805 7.91113 3.74805C7.41895 3.74805 7.02246 4.14453 7.02246 4.64355C7.02246 5.14258 7.41895 5.53906 7.91113 5.53906ZM6.77637 11.7324H9.55859C9.83887 11.7324 10.0576 11.5273 10.0576 11.2471C10.0576 10.9805 9.83887 10.7686 9.55859 10.7686H8.71094V7.28906C8.71094 6.91992 8.52637 6.67383 8.17773 6.67383H6.89258C6.6123 6.67383 6.39355 6.88574 6.39355 7.15234C6.39355 7.43262 6.6123 7.6377 6.89258 7.6377H7.62402V10.7686H6.77637C6.49609 10.7686 6.27734 10.9805 6.27734 11.2471C6.27734 11.5273 6.49609 11.7324 6.77637 11.7324Z"})})},90199:(e,t,n)=>{n.d(t,{b:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("locked",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M4.79395 14.7227H11.1992C12.252 14.7227 12.7783 14.1963 12.7783 13.0479V8.20801C12.7783 7.19629 12.3682 6.66992 11.541 6.56055V4.96094C11.541 2.36328 9.81152 1.1123 7.99316 1.1123C6.18164 1.1123 4.45215 2.36328 4.45215 4.96094V6.56055C3.625 6.66992 3.21484 7.19629 3.21484 8.20801V13.0479C3.21484 14.1963 3.73438 14.7227 4.79395 14.7227ZM5.75098 4.83105C5.75098 3.22461 6.76953 2.35645 7.99316 2.35645C9.2168 2.35645 10.2422 3.22461 10.2422 4.83105V6.54004H5.75098V4.83105ZM4.99219 13.5059C4.69141 13.5059 4.54102 13.3623 4.54102 13V8.25586C4.54102 7.89355 4.69141 7.76367 4.99219 7.76367H11.0078C11.3086 7.76367 11.4521 7.89355 11.4521 8.25586V13C11.4521 13.3623 11.3086 13.5059 11.0078 13.5059H4.99219Z"})})},87292:(e,t,n)=>{n.d(t,{B:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("pdf",{viewBox:"0 0 23.5 23.5",svg:(0,r.jsx)("path",{d:"M8.61 10.922a.44.44 0 01-.313-.11.422.422 0 01-.117-.312.9.9 0 01.054-.273l1.07-2.985c.12-.354.342-.531.665-.531.338 0 .568.177.687.531l1.07 2.985c.032.114.047.205.047.273a.44.44 0 01-.109.313c-.073.072-.18.109-.32.109-.219 0-.365-.133-.438-.399l-.242-.68H9.281l-.226.68c-.068.266-.216.399-.446.399zm.85-1.75h1.032L10 7.609h-.047l-.492 1.563zm3.657-1.11a.514.514 0 01-.367-.14.503.503 0 01-.14-.36c0-.14.046-.257.14-.351a.514.514 0 01.367-.14h2.195a.477.477 0 01.5.492c0 .14-.046.26-.14.359a.487.487 0 01-.36.14h-2.195zm0 2.618a.514.514 0 01-.367-.14.503.503 0 01-.14-.36c0-.14.046-.258.14-.352a.514.514 0 01.367-.14h2.195a.477.477 0 01.5.492c0 .14-.046.26-.14.36a.487.487 0 01-.36.14h-2.195zm-4.953 6.234V13.25c0-.333.089-.583.266-.75.182-.172.435-.258.758-.258h5.632c.677 0 1.016.336 1.016 1.008v3.586h-.547l-1.492-1.719a.58.58 0 00-.242-.172.84.84 0 00-.282-.047c-.177 0-.348.073-.515.22l-1.547 1.366-.617-.562a.68.68 0 00-.461-.188.617.617 0 00-.438.188l-.984.992h-.547zm2.492-1.797a.78.78 0 00.57-.242.78.78 0 00.243-.57c0-.23-.081-.42-.242-.57a.823.823 0 00-.57-.243.737.737 0 00-.579.227.812.812 0 00-.234.586c0 .218.078.409.234.57a.79.79 0 00.578.242zm-5.36 2.64V5.97c0-.839.214-1.474.641-1.907.428-.437 1.06-.656 1.899-.656h8.32c.839 0 1.472.219 1.899.656.427.433.64 1.068.64 1.907v11.789c0 .844-.213 1.482-.64 1.914-.427.432-1.06.648-1.899.648h-8.32c-.839 0-1.471-.216-1.899-.648-.427-.432-.64-1.07-.64-1.914zm1.54-.093c0 .36.094.635.281.828.188.193.472.29.852.29h8.062c.38 0 .664-.097.852-.29.187-.193.281-.469.281-.828V6.07c0-.364-.094-.643-.281-.836-.188-.198-.471-.296-.852-.296H7.97c-.38 0-.664.098-.852.296-.187.193-.281.472-.281.836v11.594z"})})},17683:(e,t,n)=>{n.d(t,{Q:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("peekModeCenter",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H13.7695C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H2.22363ZM4.33594 11.0654H11.6504C12.0742 11.0654 12.2588 10.8809 12.2588 10.4502V5.69238C12.2588 5.25488 12.0742 5.07715 11.6504 5.07715H4.33594C3.91211 5.07715 3.72754 5.25488 3.72754 5.69238V10.4502C3.72754 10.8809 3.91211 11.0654 4.33594 11.0654Z"})})},31490:(e,t,n)=>{n.d(t,{M:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("peekModeFull",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H13.7695C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H2.22363ZM2.77734 12.1113H13.2158C13.5645 12.1113 13.7559 11.9131 13.7559 11.5645V4.57812C13.7559 4.22949 13.5645 4.02441 13.2158 4.02441H2.77734C2.42871 4.02441 2.2373 4.22949 2.2373 4.57812V11.5645C2.2373 11.9131 2.42871 12.1113 2.77734 12.1113Z"})})},32240:(e,t,n)=>{n.d(t,{y:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("peekModeSide",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M2.1416 14.4492H13.8516C15.3281 14.4492 16.0938 13.6904 16.0938 12.2344V3.9082C16.0938 2.45215 15.3281 1.69336 13.8516 1.69336H2.1416C0.665039 1.69336 -0.100586 2.44531 -0.100586 3.9082V12.2344C-0.100586 13.6904 0.665039 14.4492 2.1416 14.4492ZM2.22363 13.1094C1.58789 13.1094 1.23926 12.7812 1.23926 12.1182V4.02441C1.23926 3.36133 1.58789 3.02637 2.22363 3.02637H13.7695C14.3984 3.02637 14.7539 3.36133 14.7539 4.02441V12.1182C14.7539 12.7812 14.3984 13.1094 13.7695 13.1094H2.22363ZM8.51953 12.1113H13.2158C13.5986 12.1113 13.7559 11.9541 13.7559 11.5645V4.57812C13.7559 4.18848 13.5986 4.02441 13.2158 4.02441H8.51953C8.13672 4.02441 7.98633 4.18848 7.98633 4.57812V11.5645C7.98633 11.9541 8.13672 12.1113 8.51953 12.1113Z"})})},25651:(e,t,n)=>{n.d(t,{R:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("pencil",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M3.926 13.307H14.11c.183 0 .34-.066.472-.199a.644.644 0 00.198-.471.652.652 0 00-.198-.479.644.644 0 00-.472-.198H5.272l-1.346 1.347zm-.704-.636l7.683-7.684-1.312-1.319-7.69 7.684-.67 1.606c-.037.1-.017.191.06.273.083.082.174.105.274.069l1.655-.63zm8.34-8.326l.738-.732c.182-.187.278-.376.287-.567.009-.192-.068-.374-.232-.547l-.267-.267c-.169-.168-.351-.246-.547-.232-.196.014-.385.11-.567.287l-.739.732 1.327 1.326z"})})},47453:(e,t,n)=>{n.d(t,{R:()=>i,s:()=>r});n(67294);var o=n(45238);const r=(0,n(85893).jsx)("path",{d:"M7.977 14.963c.407 0 .747-.324.747-.723V8.72h5.362c.399 0 .74-.34.74-.747a.746.746 0 00-.74-.738H8.724V1.706c0-.398-.34-.722-.747-.722a.732.732 0 00-.739.722v5.529h-5.37a.746.746 0 00-.74.738c0 .407.341.747.74.747h5.37v5.52c0 .399.332.723.739.723z"}),i=(0,o.I)("plus",{viewBox:"0 0 16 16",svg:r})},18442:(e,t,n)=>{n.d(t,{H:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("settings",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M7.30957 15.4814H8.69043C9.25781 15.4814 9.70215 15.1328 9.83203 14.5928L10.1123 13.3828L10.29 13.3145L11.3428 13.9639C11.8213 14.2646 12.3818 14.1895 12.7783 13.7861L13.7354 12.8291C14.1455 12.4258 14.2139 11.8652 13.9131 11.3936L13.2637 10.3477L13.3252 10.1768L14.5352 9.89648C15.0684 9.75977 15.4238 9.31543 15.4238 8.75488V7.4082C15.4238 6.84766 15.0752 6.40332 14.5352 6.2666L13.3389 5.97949L13.2705 5.80176L13.9199 4.75586C14.2207 4.28418 14.1455 3.73047 13.7422 3.31348L12.7852 2.35645C12.3887 1.95996 11.8281 1.88477 11.3564 2.17871L10.3037 2.82129L10.1123 2.74609L9.83203 1.53613C9.70215 0.996094 9.25781 0.647461 8.69043 0.647461H7.30957C6.73535 0.647461 6.29785 0.996094 6.16797 1.53613L5.8877 2.74609L5.69629 2.82129L4.64355 2.17871C4.16504 1.88477 3.60449 1.95996 3.20801 2.35645L2.25098 3.31348C1.84766 3.73047 1.77246 4.28418 2.07324 4.75586L2.72949 5.80176L2.6543 5.97949L1.46484 6.2666C0.917969 6.40332 0.576172 6.84766 0.576172 7.4082V8.75488C0.576172 9.31543 0.924805 9.75977 1.46484 9.89648L2.66797 10.1768L2.73633 10.3477L2.08008 11.3936C1.7793 11.8652 1.85449 12.4258 2.25781 12.8291L3.21484 13.7861C3.61816 14.1895 4.17871 14.2646 4.65039 13.9639L5.70312 13.3145L5.8877 13.3828L6.16797 14.5928C6.29785 15.1328 6.73535 15.4814 7.30957 15.4814ZM7.47363 14.2441C7.35742 14.2441 7.30273 14.1895 7.28223 14.0869L6.87891 12.4053C6.44141 12.3027 6.03125 12.1318 5.69629 11.9199L4.21973 12.8291C4.1377 12.8838 4.05566 12.877 3.9668 12.7949L3.24219 12.0703C3.16699 11.9951 3.16016 11.9131 3.22168 11.8242L4.13086 10.3477C3.93945 10.0264 3.75488 9.61621 3.65234 9.18555L1.96387 8.78223C1.86133 8.76172 1.81348 8.70703 1.81348 8.59082V7.56543C1.81348 7.44238 1.86133 7.39453 1.96387 7.36719L3.65234 6.9707C3.75488 6.5127 3.95312 6.08887 4.11719 5.79492L3.21484 4.3252C3.15332 4.22949 3.15332 4.14746 3.23535 4.06543L3.95996 3.34766C4.04883 3.27246 4.11719 3.25879 4.21973 3.31348L5.68945 4.20898C5.99707 4.02441 6.44824 3.83301 6.87891 3.72363L7.28223 2.04199C7.30273 1.93945 7.35742 1.88477 7.47363 1.88477H8.52637C8.64258 1.88477 8.69727 1.93262 8.71094 2.04199L9.12109 3.7373C9.56543 3.83984 9.96875 4.02441 10.3037 4.21582L11.7734 3.32031C11.876 3.26562 11.9443 3.27246 12.0264 3.35449L12.7578 4.07227C12.8398 4.14746 12.8398 4.22949 12.7783 4.3252L11.876 5.79492C12.04 6.08887 12.2451 6.5127 12.3477 6.9707L14.0293 7.36719C14.1387 7.39453 14.1865 7.44238 14.1865 7.56543V8.59082C14.1865 8.70703 14.1318 8.76172 14.0293 8.78223L12.3408 9.18555C12.2383 9.61621 12.0537 10.0264 11.8691 10.3477L12.7715 11.8242C12.8262 11.9131 12.8262 11.9951 12.751 12.0635L12.0264 12.7949C11.9375 12.877 11.8555 12.8838 11.7734 12.8291L10.2969 11.9199C9.96191 12.1318 9.57227 12.3027 9.12109 12.4053L8.71094 14.0869C8.69727 14.1963 8.64258 14.2441 8.52637 14.2441H7.47363ZM8 10.6621C9.42188 10.6621 10.5908 9.49316 10.5908 8.06445C10.5908 6.64941 9.42188 5.48047 8 5.48047C6.57812 5.48047 5.40234 6.64941 5.40234 8.06445C5.40234 9.49316 6.57129 10.6621 8 10.6621ZM8 9.49316C7.2207 9.49316 6.57812 8.85059 6.57812 8.06445C6.57812 7.29199 7.2207 6.65625 8 6.65625C8.76562 6.65625 9.40137 7.29199 9.40137 8.06445C9.40137 8.84375 8.76562 9.49316 8 9.49316Z"})})},1436:(e,t,n)=>{n.d(t,{g:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("settingsConnectedApps",{viewBox:"0 0 20 20",svg:(0,r.jsx)("path",{d:"M16.492 3.922C15.695 3.125 14.57 3 13.234 3H7.148c-1.312 0-2.437.125-3.234.922C3.117 4.719 3 5.836 3 7.14v6.03c0 1.337.117 2.446.914 3.243.797.797 1.922.922 3.25.922h6.07c1.336 0 2.461-.125 3.258-.922.797-.797.914-1.906.914-3.242V7.164c0-1.336-.117-2.453-.914-3.242zm-.344 3.023v6.438c0 .812-.101 1.64-.578 2.117-.468.469-1.312.578-2.117.578h-6.5c-.805 0-1.648-.11-2.125-.578-.469-.477-.57-1.305-.57-2.117V6.969c0-.82.101-1.664.57-2.133.477-.477 1.328-.578 2.149-.578h6.476c.805 0 1.649.11 2.117.578.477.476.578 1.305.578 2.11zm-3.492 5.149c.344 0 .57-.266.57-.625V7.78c0-.46-.25-.64-.648-.64h-3.71c-.368 0-.602.226-.602.57s.242.57.617.57h1.422l1.156-.125-1.219 1.133-2.875 2.883a.62.62 0 00-.187.422c0 .351.226.578.57.578.188 0 .336-.07.445-.18l2.875-2.875 1.125-1.203-.117 1.219v1.351c0 .368.227.61.578.61z"})})},24600:(e,t,n)=>{n.d(t,{P:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("slackLogo",{viewBox:"0 0 16 16",svg:(0,r.jsxs)("g",{children:[(0,r.jsx)("path",{d:"M1.68078 11.7915C2.60586 11.7915 3.36156 11.0358 3.36156 10.1107V8.42993H1.68078C0.755701 8.42993 0 9.18563 0 10.1107C0 11.0358 0.755701 11.7915 1.68078 11.7915Z",fill:"#E01E5A"}),(0,r.jsx)("path",{d:"M5.88928 8.42993C4.9642 8.42993 4.2085 9.18563 4.2085 10.1107V14.3192C4.2085 15.2443 4.9642 16 5.88928 16C6.81436 16 7.57006 15.2443 7.57006 14.3192V10.1107C7.57006 9.18563 6.81436 8.42993 5.88928 8.42993Z",fill:"#E01E5A"}),(0,r.jsx)("path",{d:"M4.2085 1.68078C4.2085 2.60586 4.9642 3.36156 5.88928 3.36156H7.57006V1.68078C7.57006 0.755701 6.81436 0 5.88928 0C4.9642 0 4.2085 0.755701 4.2085 1.68078Z",fill:"#36C5F0"}),(0,r.jsx)("path",{d:"M7.57003 5.88928C7.57003 4.9642 6.81433 4.2085 5.88925 4.2085H1.68078C0.755701 4.2085 0 4.9642 0 5.88928C0 6.81436 0.755701 7.57006 1.68078 7.57006H5.88925C6.81433 7.57006 7.57003 6.81436 7.57003 5.88928Z",fill:"#36C5F0"}),(0,r.jsx)("path",{d:"M10.1107 7.57003C11.0358 7.57003 11.7915 6.81433 11.7915 5.88925V1.68078C11.7915 0.755701 11.0358 0 10.1107 0C9.18563 0 8.42993 0.755701 8.42993 1.68078V5.88925C8.42993 6.81433 9.18563 7.57003 10.1107 7.57003Z",fill:"#2EB67D"}),(0,r.jsx)("path",{d:"M14.3192 4.2085C13.3941 4.2085 12.6384 4.9642 12.6384 5.88928V7.57006H14.3192C15.2443 7.57006 16 6.81436 16 5.88928C16 4.9642 15.2443 4.2085 14.3192 4.2085Z",fill:"#2EB67D"}),(0,r.jsx)("path",{d:"M8.42993 10.1107C8.42993 11.0358 9.18563 11.7915 10.1107 11.7915H14.3192C15.2443 11.7915 16 11.0358 16 10.1107C16 9.18563 15.2443 8.42993 14.3192 8.42993H10.1107C9.18563 8.42993 8.42993 9.18563 8.42993 10.1107Z",fill:"#ECB22E"}),(0,r.jsx)("path",{d:"M11.7915 14.3192C11.7915 13.3941 11.0358 12.6384 10.1107 12.6384H8.42993V14.3192C8.42993 15.2443 9.18563 16 10.1107 16C11.0358 16 11.7915 15.2443 11.7915 14.3192Z",fill:"#ECB22E"})]})})},11751:(e,t,n)=>{n.d(t,{t:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("sparkles",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M7.2757 4.82358C7.57934 4.71847 7.57934 4.53161 7.2757 4.41483L5.62905 3.78419C5.33709 3.67908 4.99842 3.3404 4.88164 3.03676L4.25101 1.39009C4.1459 1.08644 3.95905 1.08644 3.84226 1.39009L3.21163 3.03676C3.10653 3.32872 2.76786 3.6674 2.46422 3.78419L0.817572 4.41483C0.513934 4.51994 0.513934 4.70679 0.817572 4.82358L2.46422 5.45422C2.75618 5.55933 3.09485 5.898 3.21163 6.20165L3.84226 7.84832C3.94737 8.15196 4.13422 8.15196 4.25101 7.84832L4.88164 6.20165C4.98674 5.90968 5.32541 5.571 5.62905 5.45422L7.2757 4.82358ZM15.2991 10.5929C16.2334 10.3593 16.2334 9.9739 15.2991 9.74032L13.2321 9.22647C12.2978 8.9929 11.3402 8.03526 11.1066 7.10097L10.5928 5.03387C10.3592 4.09959 9.97382 4.09959 9.74025 5.03387L9.2264 7.10097C8.99283 8.03526 8.03521 8.9929 7.10094 9.22647L5.03387 9.74032C4.09961 9.9739 4.09961 10.3593 5.03387 10.5929L7.10094 11.1067C8.03521 11.3403 8.99283 12.2979 9.2264 13.2322L9.74025 15.2993C9.97382 16.2336 10.3592 16.2336 10.5928 15.2993L11.1066 13.2322C11.3402 12.2979 12.2978 11.3403 13.2321 11.1067L15.2991 10.5929Z"})})},95855:(e,t,n)=>{n.d(t,{z:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("speechBubble",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M4.32 15.424c.39 0 .677-.192 1.149-.609l2.344-2.064h4.116c2.057 0 3.213-1.19 3.213-3.22V4.22c0-2.03-1.156-3.22-3.213-3.22H3.213C1.163 1 0 2.19 0 4.22V9.53c0 2.037 1.196 3.22 3.165 3.22h.28v1.675c0 .608.322.998.875.998zm.342-1.531v-1.949c0-.403-.178-.56-.56-.56H3.26c-1.285 0-1.9-.65-1.9-1.894V4.26c0-1.243.615-1.893 1.9-1.893h8.627c1.278 0 1.893.65 1.893 1.894v5.23c0 1.243-.615 1.893-1.893 1.893h-4.15c-.417 0-.622.068-.909.369l-2.167 2.14z"})})},65153:(e,t,n)=>{n.d(t,{n:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("sub",{viewBox:"0 0 30 30",svg:(0,r.jsx)("path",{d:"M5 3V20H23.187L19.594 16.406L21 15L27 21L21 27L19.594 25.594L23.187 22H3V3H5Z"})})},60291:(e,t,n)=>{n.d(t,{b:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("sync",{viewBox:"0 0 30 30",svg:(0,r.jsx)("path",{d:"M27.93 13.81h-1.54c-.606-5.717-5.536-10.265-11.387-10.265-3.425 0-6.514 1.55-8.625 3.987-.427.483-.37 1.078.079 1.392.438.315.965.214 1.336-.202a9.57 9.57 0 017.21-3.268 9.503 9.503 0 019.456 8.356h-1.673c-.798 0-1 .539-.573 1.156l2.516 3.583c.359.516.898.528 1.269 0l2.504-3.572c.45-.628.236-1.167-.573-1.167zM2.064 16.202h1.55c.607 5.716 5.526 10.253 11.388 10.253 3.425 0 6.525-1.561 8.636-3.987.416-.483.36-1.09-.078-1.404-.438-.314-.977-.202-1.337.214-1.74 2.01-4.324 3.268-7.221 3.268a9.496 9.496 0 01-9.467-8.344H7.22c.798 0 1-.55.573-1.157l-2.516-3.583c-.359-.516-.898-.527-1.269 0l-2.515 3.572c-.438.617-.236 1.168.572 1.168z"})})},77734:(e,t,n)=>{n.d(t,{s:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("tableHeaderColumn",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M13.7847 14H2.21528C0.756437 14 0 13.2862 0 11.9164V4.0836C0 2.7074 0.756437 2 2.21528 2H13.7847C15.2436 2 16 2.71383 16 4.0836V11.9164C16 13.2862 15.2436 14 13.7847 14ZM14.6762 4.19293C14.6762 3.56913 14.325 3.25402 13.7037 3.25402H7V5.60772H14.6762V4.19293ZM7 6.81672V9.18328H14.6762V6.81672H7ZM13.7037 12.7395C14.325 12.7395 14.6762 12.4309 14.6762 11.8071V10.3923H7V12.7395H13.7037Z"})})},73599:(e,t,n)=>{n.d(t,{f:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("tableHeaderRow",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M13.7847 14H2.21528C0.756437 14 0 13.2862 0 11.9164V4.0836C0 2.7074 0.756437 2 2.21528 2H13.7847C15.2436 2 16 2.71383 16 4.0836V11.9164C16 13.2862 15.2436 14 13.7847 14ZM1.32377 6.81672V9.18328H7.34825V6.81672H1.32377ZM8.645 6.81672V9.18328H14.6762V6.81672H8.645ZM1.32377 11.8071C1.32377 12.4309 1.66821 12.7395 2.29633 12.7395H7.34825V10.3923H1.32377V11.8071ZM13.7037 12.7395C14.325 12.7395 14.6762 12.4309 14.6762 11.8071V10.3923H8.645V12.7395H13.7037Z"})})},98519:(e,t,n)=>{n.d(t,{k:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("thinCheck",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M6.385 14.162c.362 0 .642-.15.84-.444L13.652 3.71c.144-.226.205-.417.205-.602 0-.485-.341-.82-.833-.82-.335 0-.54.123-.746.444l-5.926 9.4-3.042-3.903c-.205-.267-.417-.376-.718-.376-.492 0-.848.348-.848.827 0 .212.075.417.253.629l3.541 4.416c.24.3.492.437.848.437z"})})},16695:(e,t,n)=>{n.d(t,{H:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("thinCheckboxCircle",{viewBox:"0 0 22 23",svg:(0,r.jsx)("circle",{cx:"11",cy:"11.5",r:"10",stroke:"#E2E1DE",strokeWidth:"1"})})},91:(e,t,n)=>{n.d(t,{L:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("triangle",{viewBox:"0 0 100 100",svg:(0,r.jsx)("polygon",{points:"5.9,88.2 50,11.8 94.1,88.2 "})})},77926:(e,t,n)=>{n.d(t,{l:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("twitter",{viewBox:"0 0 2400 2452",svg:(0,r.jsx)("path",{d:"M5.3 7.7c4.6 6.6 920.6 1339.9 928.8 1351.9l2.9 4.2-463.2 538.3C219.1 2198.2 8.2 2443.3 5.2 2446.7l-5.4 6.3h211.8l409.5-476c225.2-261.8 409.6-476 409.9-476 .3 0 147.7 214.2 327.5 476l327 476h714.6l-2.9-4.3c-1.6-2.3-220-320.1-485.2-706.2-265.3-386.1-482.4-702.7-482.4-703.6-.1-.8 200.4-234.6 445.4-519.4C2120 234.7 2320.7 1.3 2320.8.8c.2-.4-47.1-.8-105.1-.8h-105.5l-387.4 450.2c-213 247.6-387.7 450.3-388.3 450.4-.5.2-140.2-202.4-310.4-450.1L714.7 0H-.1l5.4 7.7zm669 239c283.8 405.9 1434.5 2052.1 1435.1 2053 .6 1-32 1.3-161.7 1.3h-162.5l-341-487.7C1256.7 1545 920 1063.4 696.1 743.1 472.2 422.8 289 160.4 289 159.9s68.3-.9 162-.9h161.9l61.4 87.7z"})})},55863:(e,t,n)=>{n.d(t,{s:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("undo",{viewBox:"0 0 16 16",svg:(0,r.jsx)("path",{d:"M14.542 10.6826C14.542 7.96875 12.71 6.10254 9.59961 6.10254H5.29297L3.70703 6.1709L4.91016 5.15234L6.67383 3.43652C6.80371 3.30664 6.89258 3.14258 6.89258 2.91699C6.89258 2.5 6.59863 2.19238 6.1543 2.19238C5.96973 2.19238 5.76465 2.28125 5.61426 2.4248L1.69043 6.29395C1.5332 6.4375 1.45117 6.64258 1.45117 6.84766C1.45117 7.05273 1.5332 7.25098 1.69043 7.40137L5.61426 11.2705C5.76465 11.4141 5.96973 11.5029 6.1543 11.5029C6.59863 11.5029 6.89258 11.1953 6.89258 10.7715C6.89258 10.5527 6.80371 10.3887 6.67383 10.252L4.91016 8.53613L3.70703 7.52441L5.29297 7.59277H9.64746C11.8486 7.59277 13.0586 8.84375 13.0586 10.6211C13.0586 12.4053 11.8486 13.7109 9.64746 13.7109H8.05469C7.60352 13.7109 7.2959 14.0459 7.2959 14.4629C7.2959 14.873 7.61035 15.208 8.05469 15.208H9.69531C12.751 15.208 14.542 13.4102 14.542 10.6826Z"})})},54497:(e,t,n)=>{n.d(t,{t:()=>i});n(67294);var o=n(45238),r=n(85893);const i=(0,o.I)("warning",{viewBox:"0 0 14 14",svg:(0,r.jsx)("path",{d:"M1.619 12.581h9.96c.983 0 1.618-.73 1.618-1.625 0-.266-.07-.54-.21-.793L7.998 1.25a1.593 1.593 0 00-2.8 0L.217 10.163c-.14.26-.216.527-.216.793 0 .895.635 1.625 1.619 1.625zm4.989-4.367c-.375 0-.59-.21-.603-.584l-.089-3.174c-.013-.394.267-.666.686-.666.406 0 .704.279.691.672l-.101 3.162c-.013.387-.222.59-.584.59zm0 2.196c-.432 0-.787-.31-.787-.73 0-.419.349-.73.787-.73.432 0 .78.311.78.73 0 .425-.355.73-.78.73z"})})},97213:(e,t,n)=>{n.d(t,{F:()=>o});let o=function(e){return e.NotSpecified="NotSpecified",e.CreatorProfile="CreatorProfile",e.SpaceSwitcher="SpaceSwitcher",e.DeleteAccount="DeleteAccount",e.NoAvailableSpaces="NoAvailableSpaces",e.MobileNativeListener="MobileNativeListener",e.LogoutRouteVisited="LogoutRouteVisisted",e.AdminActionSelfLogout="AdminActionSelfLogout",e.AdminLogoutFallThrough="AdminActionFallThrough",e.PublicPageAccessDenied="PublicPageAccessDenied",e.PageAccessDenied="PageAccessDenied",e.OnboardingError="OnboardingError",e.OnboardingExit="OnboardingExit",e}({})},25718:(e,t,n)=>{n.d(t,{Lk:()=>E,wB:()=>x,dx:()=>C,c8:()=>Q,lM:()=>Y,on:()=>X,CK:()=>K,WB:()=>D});n(57658);var o=n(67266),r=n.n(o),i=n(74994),a=n(41432),s=n(80951),l=n(7057),c=n(14215),d=n(95538),u=n(64962),p=n(61075),m=n(64572),f=n(22808),g=n(72126),h=n(59753),v=n(21202);var b=n(19233),y=n(606),_=n(70279),S=n(19889),w=n(70203);n(29477);var k=n(97880),I=n(7928);function C(e){const t=w.J7s(e);return"a"===t?"[":"b"===t?"**":"i"===t?"*":"c"===t?"`":"s"===t?"~~":"e"===t?"$":""}function x(e,t,n){const o=w.J7s(e);if(w.j0F(e)){const o=w.zW$(e),r=(0,m.A5)({...n,url:o});return`](${(r?t({toPageId:r}):o)||""})`}return"b"===o?"**":"i"===o?"*":"c"===o?"`":"s"===o?"~~":"e"===o?"$":""}function T(e){const{annotation:t,exportArgs:n}=e,{getRecordValue:o,userTimeZone:r,getExportedPathToPage:i,intl:a,transformAnnotation:s}=n;if(s){const e=s(t,n);if("string"==typeof e)return e}if(w.IWo(t)){const e=w.zEN(t),n=o({table:S.KJ,id:e});return`@${(0,I.Nz)(a,n)}`}if(w.STW(t)){const e=w.TOT(t),r=o({table:v.iU,id:e});if(r){return`[${D({block:r,exportArgs:n})}](${i({toPageId:e})})`}}else{if(w.K$_(t)){var c;const e=w.r3j(t),r=o({table:_.x_,id:e,spaceId:n.root.spaceId});return null==r||null===(c=r.text)||void 0===c?void 0:c.toString()}if(w.fpG(t)){const{date_format:e,time_format:o,...i}=w.zyO(t);return(0,l.ZV)({value:i,date_format:e,time_format:o,userTimeZone:r,allowRelativeDates:!1,intl:n.intl})}if(w.kuv(t))return w.xey(t);if(w._bk(t)){const e=(0,p.kF)({annotation:t,exportArgs:n});if(e)return e}else{if(w.nSN(t)){var d;const e=w.frW(t);return null===(d=o({table:v.iU,id:e,spaceId:n.root.spaceId}))||void 0===d||null===(d=d.format)||void 0===d?void 0:d.original_url}if(w.OU5(t))return"";if(w.inx(t)||w.j0F(t)||w.aC4(t)||w.xw5(t)||w.BIG(t)||w.pV3(t)||w.STW(t)||w.rIb(t)||w.LAI(t)||w.fTS(t)||w.aq(t)||w.QVC(t)||w.uge(t)||w.Lyt(t)||w.wjk(t))return;(0,k.t1)(t)}}}const M=e=>{const t=/^\s+/.exec(e);return t?t[0]:""},P=e=>{const t=/\s+$/.exec(e);return t?t[0]:""},A=e=>{const t=P(e);return t.length>0?e.slice(0,-1*t.length):e},R=e=>{const t=M(e);return e.slice(t.length)};function D(e){const{block:t,exportArgs:n}=e;return K({textValue:w.lzi(h.kk.fromBlock(t).getProperties().title),exportArgs:n})}function E(e){const{block:t,exportArgs:n}=e,{getRecordValue:o}=n,r=t&&t.content?t.content:[];return g.oA(g.UI(r,(t=>q({block:o({table:v.iU,id:t}),exportArgs:{...n,blockId:t},visitedBlock:e.visitedBlock}))))}function B(e){return e.split("\n")}function F(e){const{block:t,exportArgs:n}=e,o=w.lzi(h.kk.fromBlock(t).getProperties().caption);return o.length>0?[{text:K({textValue:o,exportArgs:n}),breakLines:!0,children:[]}]:[]}function O(e){const{block:t,exportArgs:n}=e;return K({textValue:w.lzi(h.kk.fromBlock(t).getProperties().caption),exportArgs:n})}function Z(e){return{text:"",breakLines:!0,children:E(e)}}function V(){}function U(e){const{block:t,exportArgs:n}=e;return{text:`# ${D({block:t,exportArgs:n}).trim()}`,breakLines:!0,children:E(e)}}function N(e){const{block:t,exportArgs:n}=e;return{text:`- ${D({block:t,exportArgs:n}).trim()}`,breakLines:!1,childrenPrefix:H,children:E(e)}}function L(e){const{block:t,exportArgs:n}=e,{getExportedRenderAsset:o}=n,{source:r}=h.kk.fromBlock(t).getProperties(),i=w.QaF(r),a=o({fromBlockId:n.blockId,toFileURI:i});return{text:`[${O(e)||D({block:t,exportArgs:n})||a}](${a})`,breakLines:!0,children:F(e)}}function j(e){const{block:t,exportArgs:n}=e,{getRecordValue:o,getExportedPathToPage:r,userTimeZone:i,intl:a}=n;if("collection_view"===t.type||"collection_view_page"===t.type){return{text:`[${(0,p.Ho)({blockId:t.id,getRecordValue:o,userTimeZone:i,intl:a})}](${r({toPageId:t.id,exportFileExt:".csv"})})`,breakLines:!0,children:[]}}}const z={text:function(e){const{block:t,exportArgs:n}=e;return{text:D({block:t,exportArgs:n}),breakLines:!0,children:E(e)}},header:U,sub_header:function(e){const{block:t,exportArgs:n}=e;return{text:`## ${D({block:t,exportArgs:n}).trim()}`,breakLines:!0,children:E(e)}},sub_sub_header:function(e){const{block:t,exportArgs:n}=e;return{text:`### ${D({block:t,exportArgs:n}).trim()}`,breakLines:!0,children:E(e)}},quote:function(e){const{block:t,exportArgs:n}=e;return{text:`> ${D({block:t,exportArgs:n}).trim()}`,breakLines:!0,childrenPrefix:"> ",children:E(e)}},bulleted_list:N,toggle:N,to_do:function(e){const{block:t,exportArgs:n}=e;let o;return o=s.Ml(h.kk.fromBlock(t).getProperties().checked)?"- [x] ":"- [ ] ",{text:`${o} ${D({block:t,exportArgs:n}).trim()}`,breakLines:!1,childrenPrefix:H,children:E(e)}},numbered_list:function(e){const{block:t,exportArgs:n}=e,{getRecordValue:o}=n;return{text:`${function(e){const{block:t,getRecordValue:n}=e,o=t.parent_id,r=n({table:v.iU,id:o});let i;i=r?g.oA(g.UI(r.content,(e=>n({table:v.iU,id:e})))):[];const s=g.cx(i,(e=>e.id===t.id)),l=g.tP(i,0,s),c=g.qr(l,(e=>e.type!==a.Ti.numberedList));return l.length-(c+1)}({block:t,getRecordValue:o})+1}. ${D({block:t,exportArgs:n})}`,breakLines:!1,childrenPrefix:H,children:E(e)}},code:function(e){const{block:t,exportArgs:n}=e,o=D({block:t,exportArgs:n});return{text:`${`\`\`\`${t.properties&&t.properties.language?function(e){const t=w.QaF(e);if(!t)return"";const n=b.W[t];return void 0===n||n===b.W["Plain Text"]?"":n}(t.properties.language):""}\n${B(o).join("\n")}\n\`\`\``}`,breakLines:!0,children:[]}},page:function(e){const{block:t,exportArgs:n}=e;if(t.id===n.navigableBlockId&&!n.renderParentBlockId)return U(e);const{getExportedPathToPage:o}=n;return{text:`[${D({block:t,exportArgs:n})}](${o({toPageId:t.id})})`,breakLines:!0,children:[]}},image:function(e){const{block:t,exportArgs:n}=e,{getExportedRenderAsset:o}=n,{source:r}=h.kk.fromBlock(t).getProperties(),i=w.QaF(r),a=o({fromBlockId:n.blockId,toFileURI:i}),s=O(e)||D({block:t,exportArgs:n})||a;return{text:(0,d.SR)({url:i})?`![${s}](${a})`:`[${s}](${a})`,breakLines:!0,children:F(e)}},video:L,embed:L,bookmark:function(e){const{block:t,exportArgs:n}=e,{link:o}=h.kk.fromBlock(t).getProperties(),r=s.zB(o);return{text:`[${D({block:t,exportArgs:n})}](${r})`,breakLines:!0,children:F(e)}},file:L,external_object_instance:function(e){var t;const{block:n}=e,o=null===(t=n.format)||void 0===t?void 0:t.original_url;if(o)return{text:`[${o}](${o})`,breakLines:!0,children:[]}},tweet:L,maps:L,gist:L,framer:L,invision:L,mixpanel:L,drive:function(e){const{block:t}=e;if(t.format&&t.format.drive_properties){const{url:e,title:n}=t.format.drive_properties;return{text:`[${n}](${e})`,breakLines:!0,children:[]}}return L(e)},figma:L,loom:L,pdf:L,typeform:L,codepen:L,audio:L,divider:function(){return{text:"---",breakLines:!0,children:[]}},equation:function(e){const{block:t}=e;let n="";return t&&t.properties&&t.properties.title&&(n=w.QaF(t.properties.title)),{text:`$$\n${n}\n$$`,breakLines:!0,children:[]}},collection_view:j,collection_view_page:j,column_list:Z,column:Z,factory:V,personal_home_page:V,copy_indicator:V,breadcrumb:V,link_to_collection:V,link_to_page:V,callout:function(e){var t;const{block:n,exportArgs:o}=e,r=D({block:n,exportArgs:o}),i=null===(t=n.format)||void 0===t?void 0:t.page_icon;return{text:`${(0,f.Z)(i)?i:"string"==typeof i?function(e){let{source:t,width:n=40,exportArgs:o}=e;const{getExportedRenderAsset:r}=o,i=r({fromBlockId:o.blockId,toFileURI:t});return`<img src="${i}" alt="${i}" width="${n}px" />`}({source:i,exportArgs:o}):""} ${r}`.trim(),breakLines:!0,children:E(e),htmlTag:"aside"}},table_of_contents:V,whimsical:L,miro:L,abstract:L,sketch:L,excalidraw:L,replit:L,hex:L,deepnote:L,alias:function(e){const{block:t,exportArgs:n}=e,{getRecordValue:o}=n;if(t.format&&t.format.alias_pointer&&(0,y.$O)(t.format.alias_pointer,v.iU)){const r=o(t.format.alias_pointer);if(r)return q({block:r,exportArgs:{...n,renderParentBlockId:t.id,blockId:t.format.alias_pointer.id},visitedBlock:e.visitedBlock})}},transclusion_container:Z,transclusion_reference:function(e){const{block:t,exportArgs:n}=e,{getRecordValue:o}=n;if(t.format&&t.format.transclusion_reference_pointer){const r=o(t.format.transclusion_reference_pointer);if(r)return q({block:r,exportArgs:{...n,renderParentBlockId:t.id,blockId:t.format.transclusion_reference_pointer.id},visitedBlock:e.visitedBlock})}},table:function(e){var t;const{block:n,exportArgs:o}=e,{getRecordValue:r}=o,i=(null===(t=n.format)||void 0===t||null===(t=t.table_block_column_order)||void 0===t?void 0:t.length)||0,a=n.content,s={text:"",breakLines:!0,children:[]};if(0===i||!a)return s;const l=a.map((t=>{const i=r({table:v.iU,id:t});return i&&q({block:i,exportArgs:{...o,blockId:t,renderParentBlockId:n.id},visitedBlock:e.visitedBlock})||s})),c={text:`| ${[...Array(i).keys()].map((()=>"---")).join(" | ")} |`,breakLines:!1,children:[]};return{text:"",breakLines:!0,children:[l[0],c,...l.slice(1)]}},table_row:function(e){var t;const{block:n,exportArgs:o}=e,{getRecordValue:r,renderParentBlockId:i}=o;if(!i)return;const a=r({table:v.iU,id:i}),l=null==a||null===(t=a.format)||void 0===t?void 0:t.table_block_column_order;if(!l)return;return{text:`| ${l.map((t=>{const o=s.wS(n,t);return o?(0,p.hJ)({textValue:o,fromString:e=>e,exportArgs:e.exportArgs,renderers:u.O}).join(""):void 0})).join(" | ")} |`,breakLines:!1,children:[]}},tab:function(e){var t;const{block:n,exportArgs:o}=e,{getRecordValue:r}=o;return{text:`${g.oA(null===(t=n.content)||void 0===t?void 0:t.flatMap((e=>{const t=r({table:v.iU,id:e});if(t)return[D({block:t,exportArgs:o}),W(E({block:t,exportArgs:o})).trim()]}))).join("\n\n")}\n\t\t`,breakLines:!0,children:[]}},external_object_instance_page:V,button:V,ai_block:Z,drawing:V};function q(e){const{block:t,forceRenderAsText:n,exportArgs:{transformBlockMapping:o}}=e;if(t&&t.type){if(e.visitedBlock){if(e.visitedBlock.has(t.id))return;e.visitedBlock.add(t.id)}const r=n&&a.wL[t.type]?(null==o?void 0:o.text)??z.text:(null==o?void 0:o[t.type])??z[t.type];if(r)return r(e)}}const H="    ";function W(e){let t="";for(const n of e){n.breakLines&&(t+="\n"),n.htmlTag&&(t+=`<${n.htmlTag}>\n`),n.text&&(t+=`${n.text}\n`),n.breakLines&&(t+=n.childrenPrefix?`${n.childrenPrefix}\n`:"\n");let e=W(n.children);if(e&&n.childrenPrefix){const t=B(e);e=[...t.slice(0,-1).map((e=>n.childrenPrefix+e)),...t.slice(-1)].join("\n")}t+=`${e}`,n.htmlTag&&(t+=`</${n.htmlTag}>\n\n`),n.suffix&&(t+=`${n.suffix}\n\n`)}return t=t.replace(/[\n]{3,}/g,"\n\n"),t}function K(e){const{textValue:t,exportArgs:n}=e;let o="";const a=w.lzi(t);let s=[];for(const d of a){const e=i.u.normalize(w.hDy(d)),t=(0,c.N)(s,e,(e=>r()(e))),a=w.WiV(d),l=e.map((e=>T({annotation:e,exportArgs:n}))).find((e=>(0,k.$K)(e))),u=l??a,p=P(o);o=A(o),t.deleted.reverse();for(const r of t.deleted)o+=x(r,n.getExportedPathToPage,n);o+=p,o+=M(u);for(const n of t.created)o+=C(n);o+=R(u);s=[...g.DY(s,e,((e,t)=>g.Xy(e,t))),...t.created]}const l=P(o);o=A(o),s.reverse();for(const r of s)o+=x(r,n.getExportedPathToPage,n);return o+=l,o}function G(e,t){const n=(new e).match(t)||[];if(0===n.length)return t;let o="",r=0;for(const i of n){const e=0===i.index||"<"!==t[i.index-1],n=i.lastIndex===t.length||">"!==t[i.lastIndex],a=Boolean(t.slice(i.index).match(/^[a-z][a-z]+:/i)),s=e&&n&&a;o+=t.slice(r,i.index),s&&(o+="<"),o+=i.raw,s&&(o+=">"),r=i.lastIndex}return o+=t.slice(r),o}function $(e){return e.replace(/\\/g,"\\\\")}const Q=e=>{const{MarkdownIt:t,LinkifyIt:n,markdown:o,plugin:r}=e,i=new t({linkify:!0});return r&&i.use(r),i.render($(G(n,o)))},Y=e=>{const{MarkdownIt:t,LinkifyIt:n,markdown:o,plugin:r}=e,i=new t({linkify:!0});return r&&i.use(r),i.renderInline($(G(n,o)))};function X(e,t){const n=new Set;return W(g.oA(e.map((e=>q({block:e,exportArgs:{...t,blockId:e.id},visitedBlock:n}))))).trim()}},44615:(e,t,n)=>{n.d(t,{Cy:()=>v,JK:()=>M,JY:()=>g,Lp:()=>b,Mv:()=>S,NP:()=>k,Ns:()=>_,T0:()=>C,ZS:()=>p,bS:()=>h,e7:()=>A,jY:()=>f,je:()=>y,pD:()=>x,pb:()=>w,pz:()=>m});var o=n(606),r=n(21202),i=n(6287),a=n(13493),s=n(80396),l=n(15047),c=n(77858),d=n(29369);const u={[l.bx]:!0,[r.iU]:!0,[a.n]:!0,[i.v]:!0,[c.zU]:!0,[d.e0]:!0,[s.yo]:!0};function p(e){return(0,o.UI)(e.table)&&!(e.table in u)?`versions/${e.id}:${e.table}:${e.spaceId}`:`versions/${e.id}:${e.table}`}function m(e){const t=e.indexOf("/");if(-1===t)return;const n=e.substring(t+1).split(":");return 2===n.length?o.dr.fromPointerLike({table:n[1],id:n[0]}):3===n.length?o.dr.fromPointerLike({table:n[1],id:n[0],spaceId:n[2]}):void 0}function f(e){return`collection/${e}`}function g(e){return`typedDatabasesListChanged/${e.spaceId}-${e.databaseType}`}function h(e){return`activity/${e}`}function v(e){return`activity/${e}`}function b(e){return`notification/${e}`}function y(e){return`teams_in_space/${e}`}function _(e){return`user_page_visit/${e}`}function S(e){return`backlinks/${e}`}function w(e){return`page_visit/${e}`}function k(e){return`user_shared_pages_in_space/${e.spaceId}-${e.userId}`}const I="presence";function C(e){return`${I}/${e}`}function x(e){return`user_joined_teams_in_space/${e.userId}:${e.spaceId}`}const T="diagnosticPing";function M(e){return`${T}/${e}`}const P="presence/drawing";function A(e){return`${P}/${e}`}},56589:(e,t,n)=>{function o(e,t){return t&&e.redirect_uris.includes(t)?t:t||1!==e.redirect_uris.length?void 0:e.redirect_uris[0]}n.d(t,{_:()=>o})},82036:(e,t,n)=>{n.d(t,{_:()=>o});const o={invalid_request:"invalid_request",unauthorized_client:"unauthorized_client",access_denied:"access_denied",unsupported_response_type:"unsupported_response_type",invalid_scope:"invalid_scope",server_error:"server_error",temporarily_unavailable:"temporarily_unavailable"}},77337:(e,t,n)=>{n.d(t,{FS:()=>D,bv:()=>T,lK:()=>x,Iw:()=>A});n(21703),n(57658);var o=n(40902),r=n(53504),i=n(45681),a=n(59730),s=(n(30541),n(72126));function l(e,t){let n=Array.isArray(t)?t:[];return n=n.filter((t=>t!==e.id)),n}function c(e,t){let n=Array.isArray(t)?t:[];return n=n.filter((t=>t&&t.id&&t.id!==e.remove.id)),n}var d=n(59753),u=n(482),p=n(87479),m=n(80951),f=n(606),g=n(21202);n(70203);function h(e,t){const n=(0,m.rq)(t).filter((t=>t.id!==e.id));return(0,m.ow)(n)}function v(e,t){const n=(0,m.rq)(t),o=n.findIndex((t=>t.id===e.args.id));return o<0?{pointer:e.pointer,path:e.path,command:"removeRelation",args:{id:e.args.id,spaceId:e.args.spaceId}}:o===n.length-1?{pointer:e.pointer,path:e.path,command:"addRelationAfter",args:{id:e.args.id,spaceId:e.args.spaceId}}:{pointer:e.pointer,path:e.path,command:"addRelationBefore",args:{id:e.args.id,before:n[o+1].id,spaceId:e.args.spaceId}}}var b=n(76462),y=n(64684),_=n(67175),S=n(97880),w=n(63143);const k={set:e=>e,update:(e,t)=>(t||(t={}),{...t,...e}),listBefore:function(e,t){let n=Array.isArray(t)?t:[];n=l({id:e.id},n);const o=s.cx(n,(t=>t===e.before));return o>=0?n.splice(o,0,e.id):n.unshift(e.id),n},listAfter:function(e,t){let n=Array.isArray(t)?t:[];n=l({id:e.id},n);const o=s.cx(n,(t=>t===e.after));return o>=0?n.splice(o+1,0,e.id):n.push(e.id),n},listRemove:l,listReplace:function(e,t){let n=Array.isArray(t)?t:[];return n=n.map((t=>t===e.id?e.newId:t)),n},listAfterMulti:function(e,t){const n=new Set(e.ids),o=(Array.isArray(t)?t:[]).filter((e=>!n.has(e))),r=s.cx(o,(t=>t===e.after));return r>=0?o.splice(r+1,0,...e.ids):o.push(...e.ids),o},listBeforeMulti:function(e,t){const n=new Set(e.ids),o=(Array.isArray(t)?t:[]).filter((e=>!n.has(e))),r=s.cx(o,(t=>t===e.before));return r>=0?o.splice(r,0,...e.ids):o.unshift(...e.ids),o},keyedObjectListBefore:function(e,t){let n=Array.isArray(t)?t:[];n=c({remove:{id:e.value.id}},n);const o=e.before?e.before.id:void 0,r=s.cx(n,(e=>e&&e.id&&e.id===o));return r>=0?n.splice(r,0,e.value):n.unshift(e.value),n},keyedObjectListAfter:function(e,t){let n=Array.isArray(t)?t:[];n=c({remove:{id:e.value.id}},n);const o=e.after?e.after.id:void 0,r=s.cx(n,(e=>e&&e.id&&e.id===o));return r>=0?n.splice(r+1,0,e.value):n.push(e.value),n},keyedObjectListRemove:c,keyedObjectListUpdate:function(e,t){const n=Array.isArray(t)?[...t]:[],o=s.cx(n,(t=>t&&t.id&&t.id===e.value.id));return o>=0?n[o]=e.value:n.push(e.value),n},appendActivity:o.tR,setPermissionItem:p.r2,setSingletonPermissionItem:p.co,addRelation:function(e,t){const n=(0,m.rq)(t),o={id:e.id,spaceId:e.spaceId,table:g.iU},r=f.dr.uniq([...n,o]);return(0,m.ow)(r)},addRelationAfter:function(e,t){const n=h({id:e.id,spaceId:e.spaceId},t),o=(0,m.rq)(n),r={id:e.id,spaceId:e.spaceId,table:g.iU};let i;if(e.after){const t=o.findIndex((t=>t.id===e.after));i=f.dr.uniq([...o.slice(0,t+1),r,...o.slice(t+1)])}else i=f.dr.uniq([...o,r]);return(0,m.ow)(i)},addRelationBefore:function(e,t){const n=h({id:e.id,spaceId:e.spaceId},t),o=(0,m.rq)(n),r={id:e.id,spaceId:e.spaceId,table:g.iU};let i;if(e.before){const t=o.findIndex((t=>t.id===e.before));i=f.dr.uniq([...o.slice(0,t),r,...o.slice(t)])}else i=f.dr.uniq([r,...o]);return(0,m.ow)(i)},addRelations:function(e,t){const n=s.Kn(t)?t:{},o={...n};for(const r in e){const t=e[r],i=(0,m.rq)(n[r]),a=f.dr.uniq([...i,...t.map((e=>({id:e.id,spaceId:e.spaceId,table:g.iU})))]);o[r]=(0,m.ow)(a)}return o},removeRelation:h,copyFile:(e,t)=>{const n=t.file_ids||[];return n.includes(e.fileId)?{...t}:{...t,file_ids:[...n,e.fileId]}},removeTeamMembershipItem:y.Uk,setTeamMembershipItem:y.I6};const I=(e,t)=>function(e,t){if(0!==e.path.length||!(0,S.Kn)(t)||0!==Object.keys(t).length||!(0,S.Kn)(e.args))return!1;const n=e.args.format;return!!(0,S.Kn)(n)&&!0===n.use_crdt}(e,t)?{pointer:e.pointer,path:[],command:"update",args:{alive:!1}}:{pointer:e.pointer,path:e.path,command:"set",args:w.z4(t)?null:t};function C(e){return void 0===e.size?1:e.size}const x=function(e,t){let n,o,i=t||{};if(n=e.path.length>0?s.U2(i,e.path):i,o=i.version?i.version+C(e):C(e),!k[e.command])throw new Error(`Unknown operation command ${e.command}.`);if(void 0!==e.expectedVersion&&i.version&&e.expectedVersion!==i.version)throw new a.vq("Mismatching expected and actual versions for the record",{clientData:{type:"operation_conflict",expectedVersion:e.expectedVersion,currentVersion:i.version,command:e.command,path:e.path,pointer:e.pointer}});n=(0,k[e.command])(e.args,n);i=e.path.length>0?function(e,t,n){if(0===t.length)throw new a.D3("Empty path to set");const o=s.d9(e);let r=o;for(let i=0;i<t.length;i++){const e=t[i];if(i===t.length-1)r[e]=n;else{let n=s.d9(r[e]);null==n&&(n="number"==typeof t[i+1]?[]:{}),r[e]=n,r=n}}return o}(i,e.path,n):n;const l=b.ZP[e.pointer.table],c=l.requiredColumns||{},d=l.defaultColumnValues||{};for(const r of Object.keys(c))!t||w.z4(t[r])||i&&!w.z4(i[r])||(d.hasOwnProperty(r)?i[r]=d[r]:i[r]=t[r]);if(i&&t){const e=t.file_ids||[];(i.file_ids||[]).length<e.length&&(i.file_ids=e)}return i=(0,r.Z)(i,"mangle-class-instances")||{},i.id=e.pointer.id,i.version=o,i},T=function(e,t){let n;switch(t=t||{},n=e.path.length>0?s.U2(t,e.path):t,e.command){case"set":return I(e,n);case"update":return((e,t)=>{t||(t={});const n={};return Object.keys(e.args).forEach((e=>{n[e]=t[e],void 0===n[e]&&(n[e]=null)})),{pointer:e.pointer,path:e.path,command:"update",args:n}})(e,n);case"listBefore":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t===e.args.id));if(o>=0){if(o+1===n.length)return{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:e.args.id}};const t=n[o+1];return{pointer:e.pointer,path:e.path,command:"listBefore",args:{id:e.args.id,before:t}}}return{pointer:e.pointer,path:e.path,command:"listRemove",args:{id:e.args.id}}}(e,n);case"listAfter":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t===e.args.id));if(o>0){const t=n[o-1];return{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:e.args.id,after:t}}}return 0===o?{pointer:e.pointer,path:e.path,command:"listBefore",args:{id:e.args.id}}:{pointer:e.pointer,path:e.path,command:"listRemove",args:{id:e.args.id}}}(e,n);case"listRemove":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t===e.args.id)),r=n[o-1];return r?{pointer:e.pointer,path:e.path,command:"listAfter",args:{id:e.args.id,after:r}}:{pointer:e.pointer,path:e.path,command:"listBefore",args:{id:e.args.id}}}(e,n);case"keyedObjectListBefore":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t.id===e.args.value.id));if(o>=0){if(o+1===n.length)return{pointer:e.pointer,path:e.path,command:"keyedObjectListAfter",args:e.args};const t=n[o+1];return{pointer:e.pointer,path:e.path,command:"keyedObjectListBefore",args:{value:e.args.value,before:{id:t.id}}}}return{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:e.args.value.id}}}}(e,n);case"keyedObjectListAfter":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t.id===e.args.value.id));if(o>0){const t=n[o-1];return{pointer:e.pointer,path:e.path,command:"keyedObjectListAfter",args:{value:e.args.value,after:{id:t.id}}}}return 0===o?{pointer:e.pointer,path:e.path,command:"keyedObjectListBefore",args:{value:e.args.value}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:e.args.value.id}}}}(e,n);case"keyedObjectListRemove":return function(e,t){const n=Array.isArray(t)?t:[],o=n.findIndex((t=>t.id===e.args.remove.id)),r=n[o],i=n[o-1];return r?i?{pointer:e.pointer,path:e.path,command:"keyedObjectListAfter",args:{value:r,after:{id:i.id}}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListBefore",args:{value:r}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:i.id}}}}(e,n);case"keyedObjectListUpdate":return function(e,t){t||(t={});const n=(Array.isArray(t)?t:[]).find((t=>t.id===e.args.value.id));return n?{pointer:e.pointer,path:e.path,command:"keyedObjectListUpdate",args:{value:n}}:{pointer:e.pointer,path:e.path,command:"keyedObjectListRemove",args:{remove:{id:e.args.value.id}}}}(e,n);case"addRelation":case"addRelationAfter":case"addRelationBefore":return v(e,n);case"removeRelation":return function(e,t){const n=(0,m.rq)(t),o=n.findIndex((t=>t.id===e.args.id));return o<0?{pointer:e.pointer,path:e.path,command:"addRelationAfter",args:{id:e.args.id,spaceId:e.args.spaceId}}:0===o?{pointer:e.pointer,path:e.path,command:"addRelationBefore",args:{id:e.args.id,before:n.length>1?n[1].id:void 0,spaceId:e.args.spaceId}}:{pointer:e.pointer,path:e.path,command:"addRelationAfter",args:{id:e.args.id,after:n[o-1].id,spaceId:e.args.spaceId}}}(e,n);default:return}};function M(e){let{operation:t,previousOperation:n}=e;return{...t,args:t.args,size:C(t)+C(n)}}function P(e){let{operation:t,previousOperation:n}=e;return{...t,args:{...n.args,...t.args},size:C(t)+C(n)}}function A(e){const[t,...n]=e,o=[t];for(const r of n){const e=o[o.length-1],t=s.Xy(r.pointer,e.pointer)&&s.Xy(r.path,e.path);"set"===r.command&&"set"===e.command&&t?o[o.length-1]=M({operation:r,previousOperation:e}):"update"===r.command&&"update"===e.command&&t?o[o.length-1]=P({operation:r,previousOperation:e}):o.push(r)}return o}function R(e){const{getRecordModel:t,setNewValue:n,primitiveOperation:o,updateOnly:r}=e,i=t.getRecordValue(o.pointer);if(!r||i){const e=x(o,i);n({pointer:o.pointer,newValue:e})}}function D(e){const{recordMap:t,operations:n,updateOnly:o}=e;n.forEach((e=>{if((0,_.Qf)(e))throw new Error("Text operations should be applied separately")})),function(e){const{getRecordModel:t,setNewValue:n,recordOperations:o,updateOnly:r}=e;for(const a of o)if((0,u.S)(a)){const e=(0,i.T1)(a,t.getRecordValue);for(const o of e)R({primitiveOperation:o,getRecordModel:t,setNewValue:n,updateOnly:r})}else R({primitiveOperation:a,getRecordModel:t,setNewValue:n,updateOnly:r})}({getRecordModel:d.om.fromRecordMap(t),setNewValue:e=>{const{pointer:n,newValue:o}=e;t.setValue(n,o)},recordOperations:n,updateOnly:o})}},69246:(e,t,n)=>{n.d(t,{PT:()=>a,cz:()=>i,fY:()=>l,g$:()=>s,kg:()=>o,mu:()=>r});const o="teamSidebar",r="teamBrowserSearch",i="teamBrowserUnjoinedTeams",a="teamBrowserJoinedTeams",s="publicPageTemplateIncludes";function l(e){const{block:t,query:n,getRecordModel:o,userTimeZone:r,intl:i}=e;if(!n)return!0;const a=null==t?void 0:t.getRenderTitle({getRecordModel:o,userTimeZone:r,intl:i});return!!a&&a.toLowerCase().indexOf(n.trim().toLowerCase())>=0}},87479:(e,t,n)=>{n.d(t,{wN:()=>ge,_G:()=>ne,D3:()=>me,uH:()=>ie,WM:()=>se,KJ:()=>P,Wo:()=>J,Gx:()=>de,kD:()=>ue,YO:()=>z,nl:()=>A,uq:()=>pe,L2:()=>ee,OC:()=>L,Xr:()=>re,qY:()=>K,Ub:()=>oe,Rh:()=>ae,FD:()=>le,GU:()=>Y,RT:()=>X,oF:()=>R,bk:()=>fe,zX:()=>q,r2:()=>x,co:()=>T,Kf:()=>M,mq:()=>ce,yY:()=>B,xO:()=>V,IF:()=>Z,gr:()=>O,SL:()=>F,ws:()=>C,IJ:()=>I,ZO:()=>k});n(57658),n(21703);var o=n(9291),r=n(41432),i=n(15070),a=n(59730),s=n(72126),l=n(59753),c=n(63306),d=n(21202),u=n(77420),p=n(33709),m=n(15047),f=n(29369),g=n(19889),h=(n(47425),n(64684)),v=n(97880),b=n(72141),y=n(45953),_=n(91627);function S(e){const{actorPointers:t,recordMap:n}=e,o=n||y.Ak.create();return{actorPointersSet:new _.X(t),actorMemberships:void 0,explicitTeamsRecordMap:void 0,temporarySpacesForSpaceUserValues:void 0,originalRecordMap:o,type:"empty_permissions_context"}}function w(e){const{actors:t}=e,n=[];return t&&t.forEach((e=>{e&&n.push(e.pointer)})),n}function k(e){const{actor:t,ancestors:n,updatedPermissionItem:o}=e;return K({actorPointer:t&&t.pointer,ancestors:n,permissionsContext:S({actorPointers:w({actors:[t]}),recordMap:void 0})}).some((e=>{const t=M(e.permissionItem,o)?o.role:e.permissionItem.role;return!!t&&(0,b.zz)(t)}))}function I(e){const{actor:t,ancestors:n}=e,o=K({actorPointer:t&&t.pointer,ancestors:n,permissionsContext:S({actorPointers:w({actors:[t]}),recordMap:void 0})});if(1===o.length){const e=o[0];if((0,b.$D)(e.permissionItem)&&(0,b.YX)(e.permissionItem.role))return e}}function C(e,t){return e.some((e=>"user_permission"===e.type&&e.user_id===t))}function x(e,t){let n=t||[];if("public_permission"===e.type){const t=n.filter((e=>(0,b.$D)(e))).map((e=>e.added_timestamp||0));t.length>0?e.added_timestamp=Math.min(...t):e.added_timestamp=(new Date).getTime()}return n=n.filter((t=>!M(t,e))),n.push(e),n=n.filter((e=>!(0,b.C2)(e)||"none"!==(0,b.cY)(e))),n}function T(e,t){const{singletonPermissionItem:n,set:o}=e;let r=t||[];return r=r.filter((e=>!M(e,n))),o&&r.push(n),r}function M(e,t){return!(!e||!t)&&((0,b.jg)(e)&&(0,b.jg)(t)||(0,b.e_)(e)&&(0,b.e_)(t)?e.user_id===t.user_id:(0,b.FB)(e)&&(0,b.FB)(t)?e.bot_id===t.bot_id:(0,b.hV)(e)&&(0,b.hV)(t)?e.group_id===t.group_id:(0,b.LW)(e)&&(0,b.LW)(t)||(0,b.zU)(e)&&(0,b.zU)(t)?e.team_id===t.team_id:e.type===t.type)}function P(e){return(0,c.gc)(e).map((e=>{if(e.table===d.iU){const t=l.kk.isAnyModel(e)?e.getPermissionItems():e.value.permissions,n=l.kk.isAnyModel(e)?e.id:e.value.id;if(t&&t.length>0)return{from:{table:d.iU,blockId:n},permissions:t}}else if(e.table===f.e0){const t=l.kk.isAnyModel(e)?e.getPermissionItems():e.value.permissions,n=l.kk.isAnyModel(e)?e.id:e.value.id;if(t&&t.length>0)return{from:{table:f.e0,teamId:n},permissions:t}}})).filter(v.$K)}function A(){let e=0,t="none";for(var n=arguments.length,o=new Array(n),r=0;r<n;r++)o[r]=arguments[r];for(const a of o)if("string"==typeof a)e=Math.max(e,b.Av.indexOf(a));else for(const e of(0,v.Yd)(a))a[e]&&(t=E(t,e));const i=b.Av[e];return"editor"===i||"read_and_write"===i||"membership_admin"===i?i:"none"!==t&&Object.keys(t).length?("reader"!==i&&"comment_only"!==i&&"content_only_editor"!==i||(t=E(t,"read_content")),t):i}const R=(0,v.AO)((e=>"object"==typeof e?{true:e}:{false:e})),D=(0,v.AO)((e=>(0,i.pH)(e)||(0,i.Ye)(e)||"none"===e?{true:e}:{false:e}));function E(e,t){let n;return"none"===e?"read_content"===t?n={read_content:!0}:"update_content"===t?n={update_content:!0}:"insert_content"===t?n={insert_content:!0}:"read_property"===t||"update_property"===t||"insert_property"===t?n={read_property:!0}:"read_comment"===t?n={read_comment:!0}:"insert_comment"===t?n={insert_comment:!0}:(0,v.t1)(t):(n={...e},"read_content"===t?(n.read_content=!0,delete n.read_property):"update_content"===t?(n.update_content=!0,delete n.update_property):"insert_content"===t?(n.insert_content=!0,delete n.insert_property):"read_property"===t?n.read_content||(n.read_property=!0):"update_property"===t?n.update_content||(n.update_property=!0):"insert_property"===t?n.insert_content||(n.insert_property=!0):"read_comment"===t?n.read_comment=!0:"insert_comment"===t?n.insert_comment=!0:(0,v.t1)(t)),n}function B(e,t){if("string"==typeof e&&"string"==typeof t)return Z(e,t);if("string"==typeof e){if("editor"===e||"membership_admin"===e)return!0;e=b.jD[e]}if("string"==typeof t){if("editor"===t||"membership_admin"===t)return!1;t=b.jD[t]}return function(e,t){if("none"===t)return!0;if("none"===e)return!1;let n=!0;for(const o of(0,v.Yd)(t))"read_property"===o?n&&=e.read_property||e.read_content:"update_property"===o?n&&=e.update_property||e.update_content:"insert_property"===o?n&&=e.insert_property||e.insert_content:"read_content"===o?n&&=e.read_content:"update_content"===o?n&&=e.update_content:"insert_content"===o?n&&=e.insert_content:"read_comment"===o?n&&=e.read_comment:"insert_comment"===o?n&&=e.insert_comment:"link_preview"===o||"synced_database"===o||(0,v.t1)(o);return Boolean(n)}(e,t)}function F(e,t){return b.Av.indexOf(e)<=b.Av.indexOf(t)}function O(e,t){return b.Av.indexOf(e)<b.Av.indexOf(t)}function Z(e,t){return b.Av.indexOf(e)>=b.Av.indexOf(t)}function V(e,t){return b.Av.indexOf(e)>b.Av.indexOf(t)}function U(e,t){return void 0!==e&&e||void 0!==t&&t}function N(e){const{inheritedPermissionToCompare:t,mostPermissivePermissionLoose:n}=e,o=n;if((0,b.KF)(o.permissionItem)&&!(0,b.KF)(t.permissionItem))return t;const r=o.permissionItem.role,i=A(r,t.permissionItem.role),a=i!==r?t:o;return{from:a.from,permissionItem:{...a.permissionItem,role:i}}}function L(e){return e?(0,b.jg)(e)||(0,b.e_)(e)?`${e.type}:${e.user_id}`:(0,b.FB)(e)?`${e.type}:${e.bot_id}`:(0,b.hV)(e)?`${e.type}:${e.group_id}`:(0,b.zU)(e)||(0,b.LW)(e)?`${e.type}:${e.team_id}`:e.type:""}function j(e){return 1===e.length?e[0]:e.reduce(((e,t)=>{if(!M(e.permissionItem,t.permissionItem))throw Error("Items should be grouped by target, but given items have different targets");return(0,b.jg)(t.permissionItem)||(0,b.e_)(t.permissionItem)||(0,b.ix)(t.permissionItem)||(0,b.bm)(t.permissionItem)||(0,b.RI)(t.permissionItem)||(0,b.ZQ)(t.permissionItem)||(0,b.hV)(t.permissionItem)||(0,b.FB)(t.permissionItem)?N({mostPermissivePermissionLoose:e,inheritedPermissionToCompare:t}):(0,b.$D)(t.permissionItem)?function(e){const{mostPermissivePermissionLoose:t,inheritedPermissionToCompare:n}=e,o=N({mostPermissivePermissionLoose:t,inheritedPermissionToCompare:n});var r,i,a,s;return o.permissionItem={...o.permissionItem,allow_duplicate:(a=o.permissionItem.allow_duplicate,s=n.permissionItem.allow_duplicate,void 0===a||a||void 0===s||s),allow_search_engine_indexing:U(o.permissionItem.allow_search_engine_indexing,n.permissionItem.allow_search_engine_indexing),expiration_timestamp:(r=o.permissionItem.expiration_timestamp,i=n.permissionItem.expiration_timestamp,r&&i?Math.max(r,i):r||i)},o}({mostPermissivePermissionLoose:e,inheritedPermissionToCompare:t}):(0,b.gG)(t.permissionItem)?{...e,from:t.from}:(0,b.Le)(t.permissionItem)?e:void(0,v.t1)(t.permissionItem)}),e[0])}function z(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=s.xH(e.map((e=>{const{permissions:t,from:n}=e;return t.map((e=>({from:n,permissionItem:e})))})));n.reverse();const o=s.vM(n,(e=>L(e.permissionItem))),r=s.Q8(o,j),i=new Set,a=[];for(const s of n){const e=L(s.permissionItem);i.has(e)||(i.add(e),a.push(r[e]))}if(!t){const e=a.find((e=>(0,b.gG)(e.permissionItem)));if(e)return[e]}return a}function q(e){return e.table===m.bx}function H(e){return e.table===m.bx}function W(e){return e.table===f.e0}function K(e){const{actorPointer:t,ancestors:n,permissionsContext:o}=e;if((0,c.GR)(n))return[];let r=e.ignorePublicPermissions;r||(0,c.Zg)(n)||(r=!0);const i=n.find(H),[a,s,l]=i?[i.__IM_SORRY__getValue(),i.getPermissionItems(),i.getPermissionGroups()]:[null,[],[]],m=(null==t?void 0:t.table)===g.KJ&&t,f=(null==t?void 0:t.table)===u.cZ&&t,v=f&&f.id,y=n.find(W),_=y?y.__IM_SORRY__getValue():null;if(f&&f.spaceId&&a&&a.id!==f.spaceId)return[];f&&!r&&(r=!0);const S=m&&m.id,w=S?l.filter((e=>e.user_ids&&e.user_ids.includes(S))).reduce(((e,t)=>(e.add(t.id),e)),new Set):new Set,k=z(P(n).map((e=>{const{permissions:t,from:n}=e;return{from:n,permissions:t.filter((e=>{if((0,b.jg)(e)||(0,b.e_)(e))return e.user_id===S;if((0,b.FB)(e))return e.bot_id===v;if((0,b.hV)(e))return w.has(e.group_id);if((0,b.Ix)(e))return Boolean(S&&_&&a&&(0,h.AL)({userId:S,team:_,spaceValue:a,groupIdsThatIncludeUser:w}));if((0,b.KK)(e))return Boolean(_&&m&&(0,h.pd)(_,m.id));if((0,b.zU)(e)){const t=Q({team:_,permissionItem:e,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(S&&t&&a&&(0,h.AL)({userId:S,team:t,spaceValue:a,groupIdsThatIncludeUser:w}))}if((0,b.LW)(e)){const t=Q({team:_,permissionItem:e,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(t&&m&&(0,h.pd)(t,m.id))}if((0,b.bm)(e)){const t=Q({team:_,permissionItem:e,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(S&&t&&a&&(0,h.s8)({userId:S,team:t}))}return!0}))}}))),I=X({spacePermissions:s,userId:S||void 0,botId:v||void 0}),C=(0,c.Zg)(n),x=n.some((e=>Boolean(e.table===p.qF&&e.resolved)));return k.filter((e=>{const{permissionItem:t}=e;if(!(0,b.C2)(t))return!1;if((!C||x)&&(0,b.rz)(t.role)&&!(0,b.FB)(t))return!1;if(((0,b.jg)(t)||(0,b.e_)(t))&&t.user_id===S)return!0;if((0,b.FB)(t)&&t.bot_id===v)return!0;if((0,b.Ix)(t))return Boolean(S&&_&&a&&(0,h.AL)({userId:S,team:_,spaceValue:a,groupIdsThatIncludeUser:w}));if((0,b.KK)(t))return Boolean(_&&m&&(0,h.pd)(_,m.id));if((0,b.zU)(t)){const e=Q({team:_,permissionItem:t,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(S&&e&&a&&(0,h.AL)({userId:S,team:e,spaceValue:a,groupIdsThatIncludeUser:w}))}if((0,b.bm)(t)){const e=Q({team:_,permissionItem:t,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(S&&e&&a&&(0,h.s8)({userId:S,team:e}))}if((0,b.LW)(t)){const e=Q({team:_,permissionItem:t,spaceId:null==a?void 0:a.id,permissionsContext:o});return Boolean(e&&m&&(0,h.pd)(e,m.id))}return!(!(0,b.ix)(t)||!I)||(!(r||!(0,b.$D)(t)||(0,b.o7)(t))||!!((0,b.hV)(t)&&I&&w.has(t.group_id)))})).map((e=>{const{from:t,permissionItem:o}=e,[r,i]=n;if("content_only_editor"===o.role){if(t.table!==d.iU)return $(n,t,e,o);if(!G(t,r)&&!G(t,i))return $(n,t,e,o);if(i&&i.table===t.table&&"collection"!==r.table&&"collection_view"!==r.table&&i.hasWikiBlockUri())return $(n,t,e,o)}return e}))}function G(e,t){return!!t&&(t.table===e.table&&t.id===e.blockId)}function $(e,t,n,o){return function(e,t){if(t.table!==d.iU)return!1;const n=e.findIndex((e=>e.table===d.iU&&e.type===r.Ti.page&&e.is_template));if(n<0)return!1;const o=e[n+2];if(!o)return!1;if(o.table!==d.iU)return!1;return o.isType(r.pg)&&o.id===t.blockId}(e,t)?{...n,permissionItem:{...o,role:"comment_only"}}:{...n,permissionItem:{...o,role:"read_and_write"}}}function Q(e){var t;let{team:n,permissionItem:o,spaceId:r,permissionsContext:i}=e;if(n&&n.id===o.team_id)return n;const a={table:f.e0,id:o.team_id,spaceId:r};let s=null===(t=i.explicitTeamsRecordMap)||void 0===t?void 0:t.getValue(a);return s||(s=i.originalRecordMap.getValue(a)),s}function Y(e){const{spacePermissions:t,userId:n}=e;return t.some((e=>(0,b.jg)(e)&&e.user_id===n&&(0,b.J5)(e.role)))}function X(e){const{spacePermissions:t,userId:n,botId:o}=e;return t.some((e=>{const t=(0,b.jg)(e)&&e.user_id===n&&(0,b.J5)(e.role),r=(0,b.FB)(e)&&e.bot_id===o&&(0,b.J5)(e.role),i=(0,b.jg)(e)&&e.user_id===n&&(0,b.Bc)(e.role);return t||r||i}))}function J(e){return z(P(e)).map((e=>{let{permissionItem:t}=e;return t}))}function ee(e,t){const n=[],o=[],r=[],i=[],a={};for(const s of e){a[L(s)]=s}for(const l of t){const e=L(l);if(a[e]){const t=a[e];(0,b.C2)(t)&&(0,b.C2)(l)&&!s.Xy(t.role,l.role)?r.push([t,l]):i.push(l),delete a[e]}else n.push(l)}for(const s of Object.values(a))o.push(s);return{created:n.sort(ne),deleted:o.sort(ne),changed:r.sort(ne),unchanged:i.sort(ne)}}function te(e){return Array.isArray(e)?e[0].type:e.type}function ne(e,t){return b.UF.indexOf(te(e))-b.UF.indexOf(te(t))}function oe(e,t,n){const o=ee(t,n),r=o.unchanged.filter((e=>(0,b.C2)(e)));for(const[s,l]of o.changed){const t=A(s.role,l.role);e.isCollectionView()||"read_and_write"!==s.role||"content_only_editor"!==l.role?s.role!==l.role&&s.role!==t&&r.push(s):r.push(s)}const i=[];for(const s of r){const t={pointer:e.pointer,command:"setPermissionItem",path:["permissions"],args:{...s,role:"none"}};i.push(t)}const a={pointer:e.pointer,command:"setSingletonPermissionItem",path:["permissions"],args:{singletonPermissionItem:{type:"restricted_permission"},set:!1}};return i.push(a),i}function re(e,t){const n=[],o=ee(e,t);for(const r of o.created)if((0,b.C2)(r)){const e={...r,role:"none"};n.push([e,r])}for(const[r,i]of o.changed){const e=A(r.role,i.role);("content_only_editor"===i.role&&"read_and_write"===r.role||r.role!==e)&&n.push([r,i])}return n}function ie(e){if(e){const{read_user_without_email:t,read_user_with_email:n,inherit_creator_permissions:o,link_preview:r,synced_database:i,webhooks:a,workspace_search:s,workspace_page_export:l,read_teamspace:c,...d}=e;if(D(d))return d}return"none"}function ae(e){if(!e)return{};const{read_user_with_email:t,read_user_without_email:n}=e;return n&&t?{read_user_without_email:n,read_user_with_email:t}:n?{read_user_without_email:n}:{}}function se(e){if(!e)return{};const{link_preview:t,synced_database:n}=e;return t&&n?{link_preview:t,synced_database:n}:t?{link_preview:t}:{}}function le(e){return Boolean(e&&e.inherit_creator_permissions)}const ce=(0,o.defineMessages)({adminLabel:{id:"userPermissionsMenu.adminItem.label",defaultMessage:"Admin"},adminCaption:{id:"userPermissionsMenu.adminItem.caption",defaultMessage:"Can change workspace settings and invite new members to the workspace."},workspaceOwnerLabel:{id:"userPermissionsMenu.workspaceOwnerItem.label",defaultMessage:"Workspace owner"},workspaceOwnerCaption:{id:"userPermissionsMenu.workspaceOwnerItem.caption",defaultMessage:"Can change workspace settings and invite new members to the workspace."},membershipAdminLabel:{id:"userPermissionsMenu.membershipAdminItem.label",defaultMessage:"Membership admin"},membershipAdminCaption:{id:"userPermissionsMenu.membershipAdminItem.caption",defaultMessage:"Can manage workspace and group membership."},fullAccessLabel:{id:"userPermissionsMenu.fullAccessItem.label",defaultMessage:"Full access"},fullAccessCaption:{id:"userPermissionsMenu.fullAccessItem.caption",defaultMessage:"Can edit and share with others."},memberLabel:{id:"userPermissionsMenu.memberItem.label",defaultMessage:"Member"},memberCaption:{id:"userPermissionsMenu.memberItem.caption",defaultMessage:"Cannot change workspace settings or invite new members to the workspace."},canEditLabel:{id:"userPermissionsMenu.canEditItem.label",defaultMessage:"Can edit"},canEditCaption:{id:"userPermissionsMenu.canEditItem.caption",defaultMessage:"Can edit, but not share with others."},canEditContentLabel:{id:"userPermissionsMenu.canEditContentItem.label",defaultMessage:"Can edit content"},canEditContentCaption:{id:"userPermissionsMenu.canEditContentItem.caption",defaultMessage:"Can edit content, but can't edit the database's views or structure."},canReadLabel:{id:"userPermissionsMenu.canReadItem.label",defaultMessage:"Can view"},canReadCaption:{id:"userPermissionsMenu.canReadItem.caption",defaultMessage:"Cannot edit or share with others."},canWriteLabel:{id:"userPermissionsMenu.canWriteItem.label",defaultMessage:"Can write."},canWriteCaption:{id:"userPermissionsMenu.canWriteItem.caption",defaultMessage:"Cannot read or share with others."},canCommentLabel:{id:"userPermissionsMenu.canCommentItem.label",defaultMessage:"Can comment"},canCommentCaption:{id:"userPermissionsMenu.canCommentItem.caption",defaultMessage:"Can view and comment, but not edit."},mixedAccessLabel:{id:"userPermissionsMenu.mixedAccessItem.label",defaultMessage:"Mixed access"},mixedAccessCaption:{id:"userPermissionsMenu.mixedAccessItem.caption",defaultMessage:"Has mixed access."},leaveWorkspaceLabel:{id:"userPermissionsMenu.leaveWorkspaceItem.label",defaultMessage:"Leave workspace"},removeFromWorkspaceLabel:{id:"userPermissionsMenu.removeFromWorkspaceItem.label",defaultMessage:"Remove from workspace"},removeWorkspaceLabel:{id:"userPermissionsMenu.removeWorkspaceItem.label",defaultMessage:"Remove"},disabledLabel:{id:"userPermissionsMenu.disabledItem.label",defaultMessage:"Disabled"},noAccessLabel:{id:"userPermissionsMenu.noAccessItem.label",defaultMessage:"No access"},guestLabel:{id:"userPermissionsMenu.guestItem.label",defaultMessage:"Guest"},pageGuestLabel:{id:"userPermissionsMenu.pageGuestItem.label",defaultMessage:"Page guest"},teamGuestLabel:{id:"userPermissionsMenu.teamGuestItem.label",defaultMessage:"Teamspace guest"},canAccessLabel:{id:"userPermissionsMenu.canAccessItem.label",defaultMessage:"Can access"},limitedAccessLabel:{id:"userPermissionsMenu.limitedAccessItem.label",defaultMessage:"Limited access"}});function de(e,t){if(!e)throw new Error("Expected to have a role");if("none"===e)return{label:ce.noAccessLabel};if(t===m.bx)return{label:ce.memberLabel,caption:ce.memberCaption};if(e.read_content&&e.update_content&&e.insert_content)return{label:ce.canEditLabel,caption:ce.canEditCaption};if(e.insert_content||e.update_content||e.read_content||e.read_comment)return{label:ce.mixedAccessLabel,caption:ce.mixedAccessCaption};if(e.insert_comment)return{label:ce.canCommentLabel,caption:ce.canCommentCaption};if(e.insert_property||e.update_property||e.read_property)throw new Error("Unsupported permission role");(0,v.t1)(e)}function ue(e,t){if(R(e)){const{label:n}=de(e,t);return n}return"reader"===e?ce.canReadLabel:"editor"===e?ce.fullAccessLabel:"read_and_write"===e?ce.canEditLabel:"content_only_editor"===e?ce.canEditContentLabel:"comment_only"===e?ce.canCommentLabel:"none"===e?ce.noAccessLabel:"membership_admin"===e?ce.membershipAdminLabel:void(0,v.t1)(e)}async function pe(e){const t=await async function(e){const{permissionItems:t,spaceUserPermissions:n,hasTeamLevelGuests:o,teamHasTeamLevelGuestsCache:r}=e,i={shared_internally:!1,shared_externally:!1,shared_to_web:!1,private:!1},a=t.filter((e=>!(0,b.Le)(e)));if(1===a.length&&(0,b.jg)(a[0]))return i.private=!0,i;const s=new Set((n??[]).map((e=>{let{user_id:t}=e;return t})));for(const l of a)switch(l.type){case"user_permission":case"exclusive_user_permission":s.has(l.user_id)?i.shared_internally=!0:i.shared_externally=!0;continue;case"explicit_team_owner_permission":case"explicit_team_permission":case"explicit_team_guest_permission":const e=l.team_id;(void 0!==(null==r?void 0:r[e])?r[e]:await o(e))?i.shared_externally=!0:i.shared_internally=!0;continue;case"bot_permission":i.shared_externally=!0;continue;case"group_permission":case"space_permission":i.shared_internally=!0;continue;case"public_permission":i.shared_to_web=!0;break;case"deleted_permission":case"restricted_permission":case"team_owner_permission":case"team_permission":continue;default:(0,v.t1)(l)}return i}(e);return function(e){if(e.shared_to_web)return"shared_to_web";if(e.shared_externally)return"shared_externally";if(e.shared_internally)return"shared_internally";return"private"}(t)}function me(e){switch(e.type){case"explicit_team_owner_permission":case"explicit_team_guest_permission":case"explicit_team_permission":return e.team_id;case"bot_permission":return e.bot_id;case"exclusive_user_permission":case"user_permission":return e.user_id;case"group_permission":return e.group_id;case"public_permission":case"team_permission":case"team_owner_permission":case"deleted_permission":case"restricted_permission":case"space_permission":return;default:(0,v.t1)(e)}}function fe(e){let{teamValue:t,permissionRole:n}=e;const o=(0,h.xC)(t);if(!o)throw new a.p8("Couldn't find team's default permission");return A(n,o)===o&&n!==o}function ge(e){let{spaceValue:t,spaceMembers:n,teamsInSpace:o,currentUserId:r}=e;const i=o.filter((e=>!(0,h.m4)({archived_by:e.archived_by}))).filter((e=>(0,h.AL)({team:e,spaceValue:t,userId:r})));return Boolean(1===n.length&&n[0].userId===r&&1===i.length&&(0,h.pd)({membership:i[0].membership},r))}},19233:(e,t,n)=>{n.d(t,{W:()=>r,Y:()=>i});var o=n(20852);const r={ABAP:o.PrismLanguages.abap,Agda:o.PrismLanguages.agda,Arduino:o.PrismLanguages.arduino,Assembly:o.PrismLanguages.nasm,Bash:o.PrismLanguages.bash,BASIC:o.PrismLanguages.basic,BNF:o.PrismLanguages.bnf,C:o.PrismLanguages.c,"C#":o.PrismLanguages.csharp,"C++":o.PrismLanguages.cpp,Clojure:o.PrismLanguages.clojure,CoffeeScript:o.PrismLanguages.coffeescript,Coq:o.PrismLanguages.coq,CSS:o.PrismLanguages.css,Dart:o.PrismLanguages.dart,Dhall:o.PrismLanguages.dhall,Diff:o.PrismLanguages.diff,Docker:o.PrismLanguages.docker,EBNF:o.PrismLanguages.ebnf,Elixir:o.PrismLanguages.elixir,Elm:o.PrismLanguages.elm,Erlang:o.PrismLanguages.erlang,"F#":o.PrismLanguages.fsharp,Flow:o.PrismLanguages.flow,Fortran:o.PrismLanguages.fortran,Gherkin:o.PrismLanguages.gherkin,GLSL:o.PrismLanguages.glsl,Go:o.PrismLanguages.go,GraphQL:o.PrismLanguages.graphql,Groovy:o.PrismLanguages.groovy,Haskell:o.PrismLanguages.haskell,HTML:o.PrismLanguages.html,Idris:o.PrismLanguages.idris,Java:o.PrismLanguages.java,JavaScript:o.PrismLanguages.jsx,JSON:o.PrismLanguages.json,Julia:o.PrismLanguages.julia,Kotlin:o.PrismLanguages.kotlin,LaTeX:o.PrismLanguages.latex,Less:o.PrismLanguages.less,Lisp:o.PrismLanguages.lisp,LiveScript:o.PrismLanguages.livescript,"LLVM IR":o.PrismLanguages.llvm,Lua:o.PrismLanguages.lua,Makefile:o.PrismLanguages.makefile,Markdown:o.PrismLanguages.markdown,Markup:o.PrismLanguages.markup,MATLAB:o.PrismLanguages.matlab,Mathematica:o.PrismLanguages.mathematica,Mermaid:o.PrismLanguages.mermaid,Nix:o.PrismLanguages.nix,"Notion Formula":o.PrismLanguages.notion,"Objective-C":o.PrismLanguages.objectivec,OCaml:o.PrismLanguages.ocaml,Pascal:o.PrismLanguages.pascal,Perl:o.PrismLanguages.perl,PHP:o.PrismLanguages.php,"Plain Text":"null",PowerShell:o.PrismLanguages.powershell,Prolog:o.PrismLanguages.prolog,Protobuf:o.PrismLanguages.protobuf,PureScript:o.PrismLanguages.purescript,Python:o.PrismLanguages.python,R:o.PrismLanguages.r,Racket:o.PrismLanguages.racket,Reason:o.PrismLanguages.reason,Ruby:o.PrismLanguages.ruby,Rust:o.PrismLanguages.rust,Sass:o.PrismLanguages.sass,Scala:o.PrismLanguages.scala,Scheme:o.PrismLanguages.scheme,Scss:o.PrismLanguages.scss,Shell:o.PrismLanguages.bash,Solidity:o.PrismLanguages.solidity,SQL:o.PrismLanguages.sql,Swift:o.PrismLanguages.swift,TOML:o.PrismLanguages.toml,TypeScript:o.PrismLanguages.tsx,"VB.Net":o.PrismLanguages.vbnet,Verilog:o.PrismLanguages.verilog,VHDL:o.PrismLanguages.vhdl,"Visual Basic":o.PrismLanguages.visualBasic,WebAssembly:o.PrismLanguages.wasm,XML:o.PrismLanguages.xml,YAML:o.PrismLanguages.yaml,"Java/C/C++/C#":o.PrismLanguages.clike},i={[o.PrismLanguages.abap]:"ABAP",[o.PrismLanguages.agda]:"Agda",[o.PrismLanguages.arduino]:"Arduino",[o.PrismLanguages.bash]:"Shell",[o.PrismLanguages.basic]:"BASIC",[o.PrismLanguages.bnf]:"BNF",[o.PrismLanguages.c]:"C",[o.PrismLanguages.clojure]:"Clojure",[o.PrismLanguages.coffeescript]:"CoffeeScript",[o.PrismLanguages.coq]:"Coq",[o.PrismLanguages.cpp]:"C++",[o.PrismLanguages.csharp]:"C#",[o.PrismLanguages.css]:"CSS",[o.PrismLanguages.dart]:"Dart",[o.PrismLanguages.dhall]:"Dhall",[o.PrismLanguages.diff]:"Diff",[o.PrismLanguages.docker]:"Docker",[o.PrismLanguages.ebnf]:"EBNF",[o.PrismLanguages.elixir]:"Elixir",[o.PrismLanguages.elm]:"Elm",[o.PrismLanguages.erlang]:"Erlang",[o.PrismLanguages.flow]:"Flow",[o.PrismLanguages.fortran]:"Fortran",[o.PrismLanguages.fsharp]:"F#",[o.PrismLanguages.gherkin]:"Gherkin",[o.PrismLanguages.glsl]:"GLSL",[o.PrismLanguages.go]:"Go",[o.PrismLanguages.graphql]:"GraphQL",[o.PrismLanguages.groovy]:"Groovy",[o.PrismLanguages.haskell]:"Haskell",[o.PrismLanguages.html]:"HTML",[o.PrismLanguages.idris]:"Idris",[o.PrismLanguages.java]:"Java",[o.PrismLanguages.javascript]:"JavaScript",[o.PrismLanguages.json]:"JSON",[o.PrismLanguages.jsx]:"JavaScript",[o.PrismLanguages.julia]:"Julia",[o.PrismLanguages.kotlin]:"Kotlin",[o.PrismLanguages.latex]:"LaTeX",[o.PrismLanguages.less]:"Less",[o.PrismLanguages.lisp]:"Lisp",[o.PrismLanguages.livescript]:"LiveScript",[o.PrismLanguages.llvm]:"LLVM IR",[o.PrismLanguages.lua]:"Lua",[o.PrismLanguages.makefile]:"Makefile",[o.PrismLanguages.markdown]:"Markdown",[o.PrismLanguages.markup]:"Markup",[o.PrismLanguages.matlab]:"MATLAB",[o.PrismLanguages.mathematica]:"Mathematica",[o.PrismLanguages.mermaid]:"Mermaid",[o.PrismLanguages.nasm]:"Assembly",[o.PrismLanguages.notion]:"Notion Formula",[o.PrismLanguages.nix]:"Nix",[o.PrismLanguages.objectivec]:"Objective-C",[o.PrismLanguages.ocaml]:"OCaml",[o.PrismLanguages.pascal]:"Pascal",[o.PrismLanguages.perl]:"Perl",[o.PrismLanguages.php]:"PHP",[o.PrismLanguages.powershell]:"PowerShell",[o.PrismLanguages.prolog]:"Prolog",[o.PrismLanguages.protobuf]:"Protobuf",[o.PrismLanguages.purescript]:"PureScript",[o.PrismLanguages.python]:"Python",[o.PrismLanguages.r]:"R",[o.PrismLanguages.racket]:"Racket",[o.PrismLanguages.reason]:"Reason",[o.PrismLanguages.ruby]:"Ruby",[o.PrismLanguages.rust]:"Rust",[o.PrismLanguages.sass]:"Sass",[o.PrismLanguages.scala]:"Scala",[o.PrismLanguages.scheme]:"Scheme",[o.PrismLanguages.scss]:"Scss",[o.PrismLanguages.solidity]:"Solidity",[o.PrismLanguages.sql]:"SQL",[o.PrismLanguages.swift]:"Swift",[o.PrismLanguages.toml]:"TOML",[o.PrismLanguages.tsx]:"TypeScript",[o.PrismLanguages.typescript]:"TypeScript",[o.PrismLanguages.vbnet]:"VB.Net",[o.PrismLanguages.verilog]:"Verilog",[o.PrismLanguages.vhdl]:"VHDL",[o.PrismLanguages.visualBasic]:"Visual Basic",[o.PrismLanguages.wasm]:"WebAssembly",[o.PrismLanguages.xml]:"XML",[o.PrismLanguages.yaml]:"YAML",[o.PrismLanguages.clike]:"Java/C/C++/C#"}},90850:(e,t,n)=>{n.d(t,{$r:()=>a,Zj:()=>i});var o=n(15157);const r="promoCode";function i(e){let{currentUserId:t,promoCode:n}=e;n?o.Z.set({userId:t,key:r,value:n}):o.Z.remove({userId:t,key:r})}function a(e){o.Z.remove({userId:e,key:r})}},96367:(e,t,n)=>{n.d(t,{P8:()=>h,Zv:()=>g,oN:()=>f,qB:()=>d,un:()=>p,zy:()=>u});n(57658);var o=n(9291),r=n(61514),i=n(94714),a=n(76205),s=n(99036);class l{constructor(e,t){this.variable=void 0,this.property=void 0,this.variable=e,this.property=t}getProperty(){return this.property}get(e){const t=this.getCombinatorFilter(e);if(t)return{type:"results",limit:1,filter:t}}getCombinatorFilter(e){const t=this.getPropertyFilter(e,this.variable);if(t)return{operator:"and",filters:[{property:this.property,filter:t}]}}getPropertyFilter(e,t){var n;const o=e[this.property];if(!o)return;return{operator:"status_is",value:{type:"is_option",value:null===(n=o.options)||void 0===n||null===(n=n.find((e=>e.id===t)))||void 0===n?void 0:n.value}}}}const c=(0,o.defineMessages)({current:{id:"database.filterValue.relationType.relativeSprintVariable.current",defaultMessage:"Current"},next:{id:"database.filterValue.relationType.relativeSprintVariable.next",defaultMessage:"Next"},last:{id:"database.filterValue.relationType.relativeSprintVariable.last",defaultMessage:"Last"}}),d={[i.p$]:{current:{messageDescriptor:c.current,reducer:new l(r.SF,r.b0.StatusV2)},next:{messageDescriptor:c.next,reducer:new l(r.YE,r.b0.StatusV2)},last:{messageDescriptor:c.last,reducer:new l(r.Rw,r.b0.StatusV2)}}};function u(e,t){const{filter:n,property:o}=e;if(!(0,a.e)(n)||!(0,a.vR)(n))return!1;const r=t[o];if(!r||!(0,s.p_)(r))return!1;return(0,a.YO)(n).some((e=>"relative"===e.type))}function p(e,t,n){if(!e)return!1;const o=t[n];return!!o&&m(e,n,o)}function m(e,t,n){return e===i.p$&&t===r.b0.StatusV2&&(0,s.gB)(n)}function f(e,t){return!!e&&p(t,e,r.b0.StatusV2)}function g(e,t){const n=e[r.b0.StatusV2];if(!n||!m(t,r.b0.StatusV2,n))return[];return Object.keys(d[t]).filter((e=>{var t;return null===(t=n.options)||void 0===t?void 0:t.find((t=>t.id===e))}))}function h(e,t){const n=Object.entries(t).find((t=>{let[n,o]=t;return e===o}));return n?n[0]:void 0}},76462:(e,t,n)=>{n.d(t,{OC:()=>ut,ZP:()=>gt,wb:()=>mt});n(59730);var o=n(72126),r=n(97880),i=n(63143),a=n(74487),s=n(58129),l=n(70921),c=n(30842),d=n(39050),u=n(54368),p=n(51650),m=n(88179),f=n(80926),g=n(8542),h=n(10188),v=n(98963),b=n(18844),y=n(21202),_=n(7470),S=n(77420),w=n(60014),k=n(6287),I=n(13493),C=n(70279),x=n(75908),T=n(6359),M=n(7678),P=n(60897),A=n(69549),R=n(33709),D=n(44312),E=n(4986),B=n(52719),F=n(58912),O=n(19639),Z=n(36077),V=n(97715),U=n(32161),N=n(82447),L=n(9713),j=n(57398),z=n(49953),q=n(14710),H=n(9508),W=n(62643),K=n(57883),G=n(66726),$=n(30754),Q=n(6946),Y=n(9844),X=n(25753),J=n(84683),ee=n(11318),te=n(38429),ne=n(89488),oe=n(65311),re=n(16427),ie=n(61220),ae=n(96683),se=n(70017),le=n(89470),ce=n(49126),de=n(94578),ue=n(4137),pe=n(80396),me=n(24836),fe=n(86135),ge=n(78929),he=n(84323),ve=n(1311),be=n(83200),ye=n(67627),_e=n(65963),Se=n(14130),we=n(34406),ke=n(42314),Ie=n(16663),Ce=n(19221),xe=n(93646),Te=n(91644),Me=n(63787),Pe=n(38952),Ae=n(40837),Re=n(15047),De=n(65635),Ee=n(96740),Be=n(63921),Fe=n(75990),Oe=n(57829),Ze=n(63188),Ve=n(56877),Ue=n(76413),Ne=n(47969),Le=n(47238),je=n(35623),ze=n(77858),qe=n(37202),He=n(29369),We=n(26195),Ke=n(14718),Ge=n(14327),$e=n(71495),Qe=n(53412),Ye=n(65836),Xe=n(5505),Je=n(24494),et=n(66295),tt=n(10354),nt=n(19889),ot=n(19716),rt=n(76244),it=n(98897),at=n(46769),st=n(66079),lt=n(58161),ct=n(28182),dt=n(35794);const ut={block:y.ZP,customer:P.ZP,notion_user:nt.ZP,space:Re.ZP,space_bot:De.ZP,space_user:Ne.ZP,space_view:ze.ZP,token:Xe.Z,user_root:st.ZP,temporary_password:Ye.ZP,password:ce.Z,collection:k.Z,collection_view:I.Z,apple_token:m.Z,google_token:Q.Z,follow:K.ZP,activity:l.ZP,notification:oe.ZP,firebase_token:W.ZP,trello_token:et.Z,asana_token:f.Z,confluence_token:x.Z,monday_token:ne.Z,external_entity:L.Z,external_token:H.Z,external_integration_app:j.Z,slack_integration:Me.Z,slack_notification:Pe.Z,discussion:R.ZP,comment:C.ZP,snapshot:Ae.Z,credit:M.ZP,used_credit:tt.Z,user_settings:ct.ZP,evernote_token:Z.Z,space_recover_pages:Ue.ZP,drive_token:E.ZP,block_token:_.Z,user_metadata:at.Z,bot:S.ZP,bot_token:w.Z,saml_config:ge.ZP,experiment:V.ZP,education_domain:B.Z,education_email:F.Z,space_invite_link:Ze.Z,public_email_domain:ue.Z,user_data_consent_permissions:ot.Z,access_request:s.ZP,template_tag:Qe.ZP,page_visit:le.ZP,page_exit:se.ZP,subscription:qe.ZP,space_domain:Be.ZP,admin_api_log:c.Z,admin_api_op_log:d.Z,integration:Y.ZP,integration_token:X.Z,oauth_authorization_code:re.Z,mfa_settings:te.ZP,device:A.ZP,user_device:rt.Z,[U.P]:U.Z,[N.r]:N.Z,[dt.b]:dt.Z,[q.Dw]:q.ZP,[lt.t]:lt.Z,team:He.ZP,[xe.O]:xe.Z,[T.H]:T.Z,[$.G]:$.Z,[G.l]:G.Z,[pe.yo]:pe.ZP,[z.r9]:z.ZP,[D.Jd]:D.ZP,[O.mz]:O.ZP,[Fe.F]:Fe.Z,[J.Tu]:J.ZP,[v.cv]:v.ZP,[ve.M]:ve.Z,[he.b]:he.Z,[_e.a]:_e.Z,[Ie.h]:Ie.Z,[we.f1]:we.ZP,[ke.P]:ke.Z,[be.w]:be.Z,[Se.O]:Se.Z,[ye.m]:ye.Z,[Ce.a]:Ce.Z,[me.qV]:me.ZP,[fe.FM]:fe.ZP,[b.Xj]:b.ZP,[Oe.fF]:Oe.ZP,[Le.x]:Le.ZP,[it.pm]:it.ZP,[Ee.L]:Ee.Z,[Ve.L9]:Ve.ZP,[We.nE]:We.ZP,[Ge.z]:Ge.Z,[Ke.u]:Ke.Z,[$e.Az]:$e.ZP,[ie.V7]:ie.ZP,[ae.K]:ae.Z,[u.y]:u.Z,[je.M]:je.Z,[Te.AT]:Te.ZP,[p.b]:p.Z,[Je.w]:Je.Z,[de.P9]:de.ZP,[g.t_]:g.ZP,[h.J4]:h.ZP,[ee.B]:ee.Z},pt=(0,r.Yd)(ut);function mt(e){return pt.includes(e)}a.literals(...(0,i.XP)(ut));const ft={};o.M6(ut,(e=>{e.columnTypes&&o.M6(e.columnTypes,((e,t)=>{t&&(ft[t]=!0)}))}));const gt=ut},53772:(e,t,n)=>{function o(e){return"development"===e.env||"local"===e.env||e.isAdminMode}n.d(t,{x:()=>o})},94804:(e,t,n)=>{n.d(t,{A7:()=>i,LO:()=>p,Y6:()=>l,fe:()=>s,nZ:()=>u,rE:()=>a,w8:()=>c});var o=n(15157),r=n(97880);function i(e){let{searchSessionId:t,searchSessionFlowNumber:n}=e;if((0,r.$K)(t)&&(0,r.$K)(n))return`1:${t}:${n}`}const a="SearchShowFilterBar";function s(e){return d({key:a,userId:e,defaultValue:!1})}const l="SearchSidePeekDefaultOpen";function c(e){return!e||d({key:l,userId:e,defaultValue:true})}function d(e){const{key:t,userId:n,defaultValue:r}=e,i=o.Z.get({userId:n,key:t});return void 0===i?r:"boolean"==typeof i&&i}const u=/(?:\s|^)-("[^"]+"|[\w]+)(?=\s|$)/g,p=/(?:\s|^)"([^"]*)"(?=\s|$)/g},92338:(e,t,n)=>{n.d(t,{GA:()=>v,Ix:()=>y,Um:()=>S,dK:()=>w,iY:()=>c,jl:()=>p,n8:()=>d,u4:()=>u,vp:()=>b});var o=n(94714),r=n(41432),i=n(74487);const a=i.object({required:{type:i.literal("date"),start_date:i.string()},optional:{}}),s=i.union([i.object({required:{starting:a,ending:i.isUndefined()},optional:{}}),i.object({required:{starting:i.isUndefined(),ending:a},optional:{}}),i.object({required:{starting:a,ending:a},optional:{}}),i.object({required:{starting:i.isUndefined(),ending:i.isUndefined()},optional:{}})]),l=i.union([i.array(i.string()),i.object({required:{teamIds:i.array(i.string()),includeSpaceRecords:i.boolean()},optional:{}})]);function c(e){if(e)return Array.isArray(e)?e:e.teamIds?e.teamIds:void 0}i.object({required:{id:i.string(),type:i.union([i.literal("user"),i.literal("permission_group")])},optional:{}});let d=function(e){return e.CollectionsInSpace="CollectionsInSpace",e.BlocksInSpace="BlocksInSpace",e.BlocksInAncestor="BlocksInAncestor",e.BlocksInParent="BlocksInParent",e.BlocksInCollection="BlocksInCollection",e}({});i.object({required:{ancestors:i.array(i.string()),createdBy:i.array(i.string()),editedBy:i.array(i.string()),lastEditedTime:s,createdTime:s},optional:{requireEditPermissions:i.boolean(),isDeletedOnly:i.boolean(),excludeTemplates:i.boolean(),isAdminModeDeletedPageSearch:i.boolean(),blockTypes:i.minLength(i.array(i.literals(...Object.keys(r.Ti))),1),inTeams:l,navigableBlockContentOnly:i.boolean(),includePublicPagesWithoutExplicitAccess:i.boolean(),audience:i.array(i.literals("private","shared_internally","shared_externally","shared_to_web")),dev_excludedPages:i.array(i.string()),dev_excludedTeams:i.array(i.string()),parentId:i.string(),databaseType:i.array(i.literals(...o.fW))}});function u(e){return{isDeletedOnly:!1,excludeTemplates:!1,navigableBlockContentOnly:!1,requireEditPermissions:!1,includePublicPagesWithoutExplicitAccess:!1,ancestors:[],parentId:void 0,createdBy:[],editedBy:[],lastEditedTime:{starting:void 0,ending:void 0},createdTime:{starting:void 0,ending:void 0},inTeams:[],...e}}function p(e,t){return{...e,...t,createdTime:{...e.createdTime,...t.createdTime},lastEditedTime:{...e.lastEditedTime,...t.lastEditedTime}}}const m=["cron_attachment_search_input_change","cron_attachment_parent_search_input_change","cron_time_collection_views_query"],f=(i.union([...["quick_find","quick_find_public","quick_find_input_change","quick_find_scroll","quick_find_filters","quick_find_ancestor_filter","quick_find_navigational_mode"].map(i.literal),...m.map(i.literal),i.literal("ancestor_filter_page_search"),i.literal("debugging"),i.literal("report_bad_search"),i.literal("trash"),i.literal("link_to_page_block"),i.literal("link_to_collection_block"),i.literal("mention_menu"),i.literal("move_to_menu"),i.literal("public_home_page_menu"),i.literal("relation_menu"),i.literal("relation_setup_menu"),i.literal("web_clipper"),i.literal("oauth"),i.literal("collection_group_value"),i.literal("collection_settings_source"),i.literal("collection_settings_select_relation_source"),i.literal("admin_search_permanently_deleted_pages"),i.literal("bot_iterate_blocks_in_space"),i.literal("api_unknown"),i.literal("simple_formula_value_page_search"),i.literal("automation_page_picker"),i.literal("automation_collection_picker"),i.literal("admin_content_search"),i.literal("ediscovery_search_api"),i.literal("admin_content_search_export"),i.literal("question_answer_context_search"),i.literal("export_content_analytics"),i.literal("send_to_notion_database_options"),i.literal("send_to_notion_project_options"),i.literal("search_content_analytics"),i.literal("search_unique_id"),i.literal("update_sidebar_tab_assistant"),i.literal("collection_page_tree_query"),i.literal("assistant_scoped_search_menu"),i.literal("legacy_searchPagesWithParent"),i.literal("benchmark_tests")]),["lastEdited","created","scroll","id",...Object.keys({pageViewsLast7Days:"pageViews.pageViewsLast7Days",pageViewsLast28Days:"pageViews.pageViewsLast28Days",pageViewsLast90Days:"pageViews.pageViewsLast90Days",pageViewsAllTime:"pageViews.pageViewsAllTime",uniquePageViewsLast7Days:"uniquePageViews.uniquePageViewsLast7Days",uniquePageViewsLast28Days:"uniquePageViews.uniquePageViewsLast28Days",uniquePageViewsLast90Days:"uniquePageViews.uniquePageViewsLast90Days",uniquePageViewsAllTime:"uniquePageViews.uniquePageViewsAllTime"})]),g=i.object({required:{field:i.literals("relevance")},optional:{}}),h=i.object({required:{field:i.literals(...f),direction:i.literals("asc","desc")},optional:{missing:i.union([i.literal("_first"),i.literal("_last"),i.number(),i.boolean(),i.string()]),searchAfter:i.undefinable(i.union([i.number(),i.string()]))}}),v=i.union([g,h]);let b=function(e){return e.Local="local",e.ElasticSearch="es",e.Postgres="pg",e.VectorDBBlock="vector_block",e.VectorDBCollection="vector_collection",e.ElasticsearchRandom="es_random",e.ElasticsearchUniqueID="es_uniqueId",e.ElasticsearchForcedRecentRecall="es_forced_recent_recall",e}({});const y={RequestFailed:{type:"RequestFailed",message:"Something went wrong."},NoResults:{type:"NoResultsFound",message:"No results found."},Offline:{type:"Offline",message:"Go online for more results."}},_="gzkNfoUU",S=`<${_}>`,w=`</${_}>`},98275:(e,t,n)=>{n.d(t,{S3:()=>o,St:()=>s,r8:()=>c,vl:()=>u});const o={local:"http://localhost:3008",development:"https://integrations-api-dev.notion.com",staging:"https://integrations-api-stg.notion.com",production:"https://integrations-api.notion.com"},r={local:"http://localhost:3000/sip",development:"https://dev.notion.so/sip",staging:"https://stg.notion.so/sip",production:"https://notion.so/sip"},i="/install",a="/slack";function s(e,t){return t?`${r[e]}${a}${i}`:`${o[e]}${a}${i}`}const l="/github";function c(e,t){return t?`${r[e]}${l}${i}`:`${o[e]}${l}${i}`}const d="/zendesk";function u(e,t){return t?`${r[e]}${d}${i}`:`${o[e]}${d}${i}`}},25666:(e,t,n)=>{n.d(t,{D:()=>a,T:()=>i});var o=n(24211),r=n(72126);const i="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7";function a(e,t){if(r.HD(e))return e;{const n=e[t];return void 0!==n?n:e[o.al]}}},94044:(e,t,n)=>{n.d(t,{$e:()=>m,TQ:()=>p,UF:()=>s,VX:()=>c,jm:()=>d,my:()=>u,p_:()=>a,vr:()=>l});var o=n(9291),r=n(30845),i=n(59753);n(4615);const a=8,s=70,l=1e3,c=(0,o.defineMessages)({member:{id:"sharedContextualInviteHelpers.member.inviteMessage2",defaultMessage:"{userName} shared a page {pageName} with you."},guest:{id:"sharedContextualInviteHelpers.guest.inviteMessage2",defaultMessage:"{userName} shared {pageName}. Join {spaceName} to view this page."},default:{id:"sharedContextualInviteHelpers.default.inviteMessage",defaultMessage:"Your invitation message"},optional:{id:"sharedContextualInviteHelpers.default.inviteMessagePrefix",defaultMessage:"Optional message..."}});function d(e){const{includeOptional:t,isGuest:n,emailProps:o,intl:r}=e,i=n?c.guest:c.member;if(t){return`${r.formatMessage(c.optional)}\n"${r.formatMessage(i,o)}"`}return r.formatMessage(i,o)}function u(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:l;if(!e)return"";const n=r.s(e,"url");let o=e.slice();return n.forEach(((e,t)=>{o=o.replace(e.value,"[link]")})),o.length>t&&(o=`${o.substring(0,t)}...`),o}function p(e){if(!e)return!1;return r.s(e,"url").length>0}function m(e,t){var n;const o=null===(n=i.kk.fromValue("block",e).getPermissionItems())||void 0===n?void 0:n.find((e=>"user_permission"===e.type&&e.user_id===t.invited_user_id));if(o&&"invite_id"in o)return o.invite_id}},90965:(e,t,n)=>{n.d(t,{BD:()=>b,CF:()=>k,CJ:()=>p,DI:()=>f,Mi:()=>S,TZ:()=>h,UD:()=>_,XO:()=>c,XR:()=>g,du:()=>w,hU:()=>m,kC:()=>d,nV:()=>v,t5:()=>y,wv:()=>u});var o=n(77657),r=n(59753),i=n(72141),a=n(99405),s=n(97880),l=n(64002);function c(e,t,n){return!t||!n||!(0,i.zz)(n)||function(e){if(!e)return[];const t=r.kk.fromSpace(e);return t.getUserPermissionItems()}(t).filter((t=>t.role&&(0,i.zz)(t.role)&&t.user_id!==e)).length>0}function d(){let e=arguments.length>1?arguments[1]:void 0;return Boolean((arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).find((t=>"user_permission"===t.type&&t.user_id===e&&(0,i.Jy)(t.role))))}function u(e,t){const n=r.kk.isAnyModel(e)?e.getPermissionItems():e.permissions;return Boolean(null==n?void 0:n.find((e=>"user_permission"===e.type&&e.user_id===t&&(0,i.zz)(e.role))))}function p(e){const t=null==e?void 0:e.integration_restrictions;return"approved_only"===t||"approved_or_built_by_notion"===t}function m(e){const{spaceBotSettings:t,integrationId:n,env:r}=e;return!t||(!p(t)||(!(!t.integration_approval_statuses||!t.integration_approval_statuses[n])||!("approved_or_built_by_notion"!==t.integration_restrictions||!(0,o.BP)({integrationId:n,env:r}))))}const f=(0,s.AO)((e=>e&&"personal_external_transfer"===e.type&&"completed"!==e.status?{true:e}:{false:e})),g=(0,s.AO)((e=>e&&"team_claim_upgrade"===e.type&&"requested"===e.status?{true:e}:{false:e})),h=(0,s.AO)((e=>{if(!e||"domain_claim_space_deletion"!==e.type)return{false:e};switch(e.status){case"started":return{true:e};case"canceled":return{false:e}}})),v=((0,s.AO)((e=>{if(!e||"space_content_duplication"!==e.type)return{false:e};switch(e.status){case"started":return{true:e};case"failed_with_closed_source":case"failed":case"completed":case"dry_run_completed":case"pending_deletion":return{false:e}}})),(0,s.AO)((e=>{if(!e||"space_content_duplication"!==e.type)return{false:e};switch(e.status){case"completed":return{true:e};case"dry_run_completed":case"failed":case"started":case"failed_with_closed_source":case"pending_deletion":return{false:e}}})),(0,s.AO)((e=>{if(!e||"space_content_duplication"!==e.type)return{false:e};switch(e.status){case"pending_deletion":return{true:e};case"dry_run_completed":case"failed":case"started":case"failed_with_closed_source":case"completed":return{false:e}}})),(0,s.AO)((e=>{if(!e||"space_content_duplication"!==e.type)return{false:e};switch(e.status){case"failed_with_closed_source":return{true:e};case"dry_run_completed":case"failed":case"started":case"completed":case"pending_deletion":return{false:e}}})),(0,s.AO)((e=>{if(!e||"space_content_duplication"!==e.type)return{false:e};switch(e.status){case"failed_with_closed_source":case"started":case"completed":case"pending_deletion":return{true:e};case"dry_run_completed":case"failed":return{false:e}}})));function b(e){const{spaceId:t,baseUrl:n}=e,o=(0,a.Xs)({route:{name:"space",spaceId:t,spaceDomain:void 0,requestedOnPublicDomain:void 0,searchQuery:void 0,searchRequest:void 0}});return(0,l.O_)({relativeUrl:o,baseUrl:n})}function y(e){return e?_({permissions:e}).length:0}function _(e){const t=null==e?void 0:e.permissions;return t?t.filter(i.jg).filter((e=>(0,i.Jy)(e.role))):[]}function S(e){return _(e).map((e=>e.user_id))}function w(e){return"none"===e.role}function k(e){return"none"!==e.role}},39927:(e,t,n)=>{n.d(t,{$:()=>r,i:()=>o});const o={autoCompleteSprints:!1,actionConfig:{complete_sprint_action:"complete_sprint_and_move_incomplete_tasks_to_next_sprint"},recurrenceConfig:{interval:2,weekdays:["MO"]}};function r(e){const{eventTracker:t,properties:n}=e;t.trackEvent({eventName:"complete_sprint_action",properties:n})}},94438:(e,t,n)=>{n.d(t,{DW:()=>s,IX:()=>a,Su:()=>r,rP:()=>i});var o=n(30120);function r(e){if("week"===e.frequency&&e.weekdays&&1===e.weekdays.length)return{weekday:e.weekdays[0],duration:e.interval}}function i(e){const{currentSprintEndDate:t,sprintSchedule:n}=e;return l({startDate:d({dateToAdjust:o.ou.fromISO(t),weekday:n.weekday,wrapForEqualDays:!0}),duration:n.duration})}function a(e){const{userTimeZone:t,sprintSchedule:n}=e;return l({startDate:o.ou.local({zone:t}),duration:n.duration})}function s(e){const{currentSprintStartDate:t,sprintSchedule:n}=e,r=d({dateToAdjust:o.ou.fromISO(t),weekday:n.weekday,wrapForEqualDays:!1}),{end_date:i}=l({startDate:r,duration:n.duration});let a=o.ou.fromISO(i);const s=o.ou.now().startOf("day");for(;a.diff(s,"days").days<0;)a=a.plus({weeks:1});return{type:"daterange",start_date:a.plus({days:1}).minus({weeks:n.duration}).toISODate(),end_date:a.toISODate()}}function l(e){const{startDate:t,duration:n}=e,o=t.plus({weeks:n}).minus({days:1});return{type:"daterange",start_date:t.toISODate(),end_date:o.toISODate()}}const c={SU:0,MO:1,TU:2,WE:3,TH:4,FR:5,SA:6};function d(e){const{dateToAdjust:t,weekday:n,wrapForEqualDays:o}=e,r=u({currentWeekday:t.weekday%7,nextWeekday:c[n],wrapForEqualDays:o});return t.plus({days:r})}function u(e){const{currentWeekday:t,nextWeekday:n,wrapForEqualDays:o}=e,r="number"==typeof t?t:c[t],i="number"==typeof n?n:c[n];if(r===i)return o?7:0;let a=r,s=0;for(;a!==i;)a===c.SA?a=0:a+=1,s+=1;return s}},99108:(e,t,n)=>{n.d(t,{VR:()=>P,hI:()=>R});n(57658);var o=n(40902),r=n(41432),i=n(80951),a=n(53504),s=n(72126),l=n(87479),c=n(72141),d=n(97880);function u(e,t){return e.space_id===t.space_id&&e.collection_id===t.collection_id&&e.navigable_block_id===t.navigable_block_id}function p(e){return e.table+e.id}function m(e,t){return s.Xy(s.MR(e.authors||[],p),s.MR(t.authors||[],p))}function f(e,t){return s.MR(s.mN([...e.authors||[],...t.authors||[]],p),p)}function g(e,t){return e.block_id===t.block_id&&u(e,t)}function h(e,t){return e.block_id===t.block_id&&u(e,t)}function v(e,t){return u(e,t)&&e.comment_id===t.comment_id}function b(e,t){return u(e,t)}function y(e,t){return e.collection_property_id===t.collection_property_id&&u(e,t)}function _(e,t){return e.collection_view_id===t.collection_view_id&&u(e,t)}function S(e,t){return e.mentioned_block_id===t.mentioned_block_id&&e.mentioned_user_id===t.mentioned_user_id&&e.mentioned_property===t.mentioned_property&&m(e,t)&&u(e,t)}function w(e,t){return e.mentioned_block_id===t.mentioned_block_id&&e.mentioned_group_id===t.mentioned_group_id&&e.mentioned_property===t.mentioned_property&&m(e,t)&&u(e,t)}function k(e){const t=[];e:for(;e.list.length>0;){const n=e.list.shift();let o,r=0,i=!1;for(;r<e.list.length;){const t=e.list[r];if(i=e.cancel(n,t),i){e.list.splice(r,1);continue e}if(o=e.replace(n,t),o){e.list[r]=o;continue e}r++}t.push(n)}return t}function I(e,t){return 0===s.e5(e,t).length&&0===s.e5(t,e).length}function C(e,t){return u(e,t)&&e.permission_group_id===t.permission_group_id}function x(e){return"permission-created"===e.type||"permission-deleted"===e.type?(0,l.OC)(e.permission_data):"permission-changed"===e.type?(0,l.OC)(e.permission_data.before):void(0,d.t1)(e)}function T(e,t){return!!u(e,t)&&(!!m(e,t)&&("permission-restriction-created"===e.type||"permission-restriction-deleted"===e.type?"permission-restriction-created"===t.type||"permission-restriction-deleted"===t.type||(null===(n=e.permission_data)||void 0===n||null===(n=n.actual_changes)||void 0===n?void 0:n.some((e=>(0,l.OC)(e)===x(t)))):"permission-restriction-created"===t.type||"permission-restriction-deleted"===t.type?t.permission_data.actual_changes.some((t=>(0,l.OC)(t)===x(e))):x(e)===x(t)));var n}function M(e,t){if("permission-deleted"===e.type&&"permission-created"===t.type&&T(e,t)&&!function(e,t){return c.cY(e)===c.cY(t)}(e.permission_data,t.permission_data))return{...t,type:"permission-changed",timestamp:t.timestamp,permission_data:{before:e.permission_data,after:t.permission_data}}}function P(e){const t=k({list:k({list:s.MR((0,a.Z)(e,"mangle-class-instances")||[],(e=>e.timestamp)),cancel:(e,t)=>!1,replace:(e,t)=>M(e,t)}),cancel:(e,t)=>function(e,t){return"block-created"===e.type&&"block-deleted"===t.type&&g(e,t)}(e,t)||function(e,t){return"block-deleted"===e.type&&"block-created"===t.type&&g(e,t)}(e,t)||function(e,t){if("block-changed"===e.type&&"block-changed"===t.type&&g(e,t)){if(e.block_data.after.block_value.type===r.Ti.tableRow){const n=o.Yr({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),r=o.Yr({before:t.block_data.before.block_value,after:t.block_data.after.block_value});return I(n,r)&&s.Xy(s.ei(e.block_data.before.block_value.properties||{},n),s.ei(t.block_data.after.block_value.properties||{},r))}const n=o.OS({before:e.block_data.before.block_value,after:e.block_data.after.block_value,schema:e.block_schema}),i=o.B9({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),a=o.OS({before:t.block_data.before.block_value,after:t.block_data.after.block_value,schema:t.block_schema}),l=o.B9({before:t.block_data.before.block_value,after:t.block_data.after.block_value});return!o.lv({before:t.block_data.before.block_value,after:t.block_data.after.block_value})&&I(n,a)&&s.Xy(s.ei(e.block_data.before.block_value.properties||{},n),s.ei(t.block_data.after.block_value.properties||{},a))&&I(i,l)&&s.Xy(s.ei(e.block_data.before.block_value.format||{},i),s.ei(t.block_data.after.block_value.format||{},l))}return!1}(e,t)||function(e,t){return!("block-property-changed"!==e.type||"block-property-changed"!==t.type||!h(e,t))&&I(Object.keys(e.property_updates),Object.keys(t.property_updates))&&s.Xy(Object.values(e.property_updates).map((e=>e.before)),Object.values(t.property_updates).map((e=>e.after)))}(e,t)||function(e,t){return"permission-created"===e.type&&"permission-deleted"===t.type&&T(e,t)}(e,t)||function(e,t){return"permission-deleted"===e.type&&"permission-created"===t.type&&T(e,t)}(e,t)||function(e,t){return"permission-changed"===e.type&&"permission-changed"===t.type&&T(e,t)&&s.Xy(e.permission_data.before,t.permission_data.after)}(e,t)||function(e,t){return"mention-created"===e.type&&"mention-deleted"===t.type&&S(e,t)}(e,t)||function(e,t){return"mention-deleted"===e.type&&"mention-created"===t.type&&S(e,t)}(e,t)||function(e,t){return"permission-group-mention-created"===e.type&&"permission-group-mention-deleted"===t.type&&w(e,t)}(e,t)||function(e,t){return"permission-group-mention-deleted"===e.type&&"permission-group-mention-created"===t.type&&w(e,t)}(e,t)||function(e,t){return"comment-created"===e.type&&"comment-deleted"===t.type&&v(e,t)}(e,t)||function(e,t){return"comment-deleted"===e.type&&"comment-created"===t.type&&v(e,t)}(e,t)||function(e,t){return"comment-changed"===e.type&&"comment-changed"===t.type&&v(e,t)&&s.Xy(e.comment_data.before,t.comment_data.after)}(e,t)||function(e,t){return!!("collection-changed"===e.type&&"collection-changed"===t.type&&b(e,t)&&e.collection_data&&t.collection_data)&&s.Xy(e.collection_data.before,t.collection_data.after)}(e,t)||function(e,t){return"collection-property-created"===e.type&&"collection-property-deleted"===t.type&&y(e,t)}(e,t)||function(e,t){return"collection-property-deleted"===e.type&&"collection-property-created"===t.type&&y(e,t)}(e,t)||function(e,t){return"collection-property-changed"===e.type&&"collection-property-changed"===t.type&&y(e,t)&&s.Xy(e.collection_property_data.before,t.collection_property_data.after)}(e,t)||function(e,t){return"collection-view-created"===e.type&&"collection-view-deleted"===t.type&&_(e,t)}(e,t)||function(e,t){return"collection-view-deleted"===e.type&&"collection-view-created"===t.type&&_(e,t)}(e,t)||function(e,t){return"collection-view-changed"===e.type&&"collection-view-changed"===t.type&&_(e,t)&&s.Xy(e.collection_view_data.before,t.collection_view_data.after)}(e,t)||function(e,t){return"permission-group-created"===e.type&&"permission-group-deleted"===t.type&&C(e,t)}(e,t)||function(e,t){return"permission-group-deleted"===e.type&&"permission-group-created"===t.type&&C(e,t)}(e,t),replace:(e,t)=>function(e,t){if("block-created"===e.type&&"block-changed"===t.type&&g(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),block_schema:t.block_schema,block_data:t.block_data.after}}(e,t)||function(e,t){if("block-changed"===e.type&&"block-changed"===t.type&&g(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),block_schema:t.block_schema,block_data:{before:e.block_data.before,after:t.block_data.after}}}(e,t)||function(e,t){if("block-property-changed"===e.type&&"block-property-changed"===t.type&&h(e,t)){const n=e.property_updates;return t.property_updates&&Object.entries(t.property_updates).forEach((o=>{let[r,i]=o;r in n?s.Xy(n[r].before,i.after)?(delete n[r],e.filtered_block_schema&&delete e.filtered_block_schema[r],t.filtered_block_schema&&delete t.filtered_block_schema[r]):n[r].after=i.after:n[r]=i})),{...e,timestamp:t.timestamp,authors:f(e,t),filtered_block_schema:{...e.filtered_block_schema,...t.filtered_block_schema},property_updates:n}}}(e,t)||function(e,t){if("comment-created"===e.type&&"comment-changed"===t.type&&v(e,t))return{...e,comment_data:t.comment_data.after}}(e,t)||function(e,t){if("comment-changed"===e.type&&"comment-changed"===t.type&&v(e,t))return{...e,comment_data:{before:e.comment_data.before,after:t.comment_data.after}}}(e,t)||function(e,t){if("permission-created"===e.type&&"permission-changed"===t.type&&T(e,t))return{...e,timestamp:t.timestamp,permission_data:t.permission_data.after}}(e,t)||function(e,t){if("permission-changed"===e.type&&"permission-changed"===t.type&&T(e,t))return{...e,permission_data:{before:e.permission_data.before,after:t.permission_data.after},timestamp:t.timestamp}}(e,t)||function(e,t){if("permission-created"===t.type&&"permission-restriction-created"===e.type&&T(e,t))return{...e,timestamp:t.timestamp}}(e,t)||function(e,t){if("permission-deleted"===t.type&&"permission-restriction-deleted"===e.type&&T(e,t))return{...e,timestamp:t.timestamp}}(e,t)||function(e,t){if("collection-created"===e.type&&"collection-changed"===t.type&&b(e,t))return{...e,authors:f(e,t),collection_data:t.collection_data?t.collection_data.after:void 0}}(e,t)||function(e,t){if("collection-changed"===e.type&&"collection-changed"===t.type&&b(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_data:{before:e.collection_data?e.collection_data.before:void 0,after:t.collection_data?t.collection_data.after:void 0}}}(e,t)||function(e,t){if("collection-property-created"===e.type&&"collection-property-changed"===t.type&&y(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_property_data:t.collection_property_data.after}}(e,t)||function(e,t){if("collection-property-changed"===e.type&&"collection-property-changed"===t.type&&y(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_property_data:{before:e.collection_property_data.before,after:t.collection_property_data.after}}}(e,t)||function(e,t){if("collection-view-created"===e.type&&"collection-view-changed"===t.type&&_(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_view_data:t.collection_view_data.after}}(e,t)||function(e,t){if("collection-view-changed"===e.type&&"collection-view-changed"===t.type&&_(e,t))return{...e,timestamp:t.timestamp,authors:f(e,t),collection_view_data:{before:e.collection_view_data.before,after:t.collection_view_data.after}}}(e,t)||function(e,t){if("permission-group-created"===e.type&&"permission-group-changed"===t.type&&C(e,t))return{...e,timestamp:t.timestamp,permission_group_data:t.permission_group_data.after,authors:f(e,t)}}(e,t)||function(e,t){if("permission-group-changed"===e.type&&"permission-group-changed"===t.type&&C(e,t))return{...e,permission_group_data:{before:e.permission_group_data.before,after:t.permission_group_data.after},timestamp:t.timestamp,authors:f(e,t)}}(e,t)}).filter((e=>!function(e){if("block-changed"===e.type){const t=o.gg({before:e.block_data.before.block_value,after:e.block_data.after.block_value,schema:e.block_schema}),n=o.lv({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),r=o.fc({before:e.block_data.before.block_value,after:e.block_data.after.block_value}),i=o.Z3({before:e.block_data.before.block_value,after:e.block_data.after.block_value});return!(t||n||r||i)}return!1}(e)));return s.MR(t,(e=>e.timestamp))}function A(e){const t=k({list:s.MR((0,a.Z)(e,"ignore-class-instances")||[],(e=>e.timestamp)),cancel:(e,t)=>!1,replace:(e,t)=>function(e,t){if("block-changed"===e.type&&"block-deleted"===t.type&&g(e,t))return{...t,authors:f(e,t)}}(e,t)||function(e,t){if("permission-group-changed"===e.type&&"permission-group-deleted"===t.type&&C(e,t))return{...t,timestamp:t.timestamp,permission_group_data:e.permission_group_data.before,authors:f(e,t)}}(e,t)||function(e,t){if("permission-changed"===e.type&&"permission-deleted"===t.type&&T(e,t))return{...t,timestamp:t.timestamp,permission_data:e.permission_data.before}}(e,t)||function(e,t){if("collection-property-changed"===e.type&&"collection-property-deleted"===t.type&&y(e,t))return{...t,authors:f(e,t)}}(e,t)||function(e,t){if("collection-view-changed"===e.type&&"collection-view-deleted"===t.type&&_(e,t))return{...t,authors:f(e,t)}}(e,t)});return s.MR(t,(e=>e.timestamp))}function R(e){return function(e){const t=[];return e.forEach((e=>{if("block-changed"===e.type)if(o.lv({before:e.block_data.before.block_value,after:e.block_data.after.block_value})){const n={...e,type:"block-created",block_data:e.block_data.after},o={...e,type:"block-deleted",block_data:e.block_data.before};t.push(o),t.push(n)}else t.push(e);else t.push(e)})),t}(A(e)).filter((e=>!function(e){return("block-created"===e.type||"block-deleted"===e.type)&&r.wL[e.block_data.block_value.type]&&"page"!==e.block_data.block_value.type&&!(0,i.wS)(e.block_data.block_value,"title")}(e)&&!function(e){return("block-created"===e.type||"block-deleted"===e.type)&&r.XX[e.block_data.block_value.type]}(e)))}},34886:(e,t,n)=>{n.d(t,{F:()=>a,R:()=>i});var o=n(72126),r=n(97880);function i(e){const t={};return e?((0,r.qP)(e).forEach((e=>{let[n,r]=e;n&&r&&(t[String(n)]=o.HD(r)?r:JSON.stringify(r))})),t):t}function a(e){return e>=1e3?"1000+":e>=500?"500-999":e>=100?"100-499":e>=50?"50-99":e>=10?"10-49":e>=2?"2-9":e>=1?"1":"0"}},46637:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(30548);const r=["adClick","fbp"];const i=new class{constructor(e,t){this.localStorageStore=void 0,this.localStorageStore=new o.ZP(e,t,"targeting")}get(e){return this.localStorageStore.get(e)}set(e,t){return this.localStorageStore.set(e,t)}remove(e){return this.localStorageStore.remove(e)}removeAllIfNoPermission(){this.localStorageStore.hasPermissionForTrackingType||r.forEach((e=>this.remove(e)))}}(o.$p,!1)},72128:(e,t,n)=>{n.d(t,{Z:()=>i});var o=n(30548);const r=["sourceInitialPage"];const i=new class{constructor(e,t){this.localStorageStore=void 0,this.localStorageStore=new o.ZP(e,t,"performance")}get(e){let{userId:t,key:n}=e;return this.localStorageStore.get((0,o.dq)(t,n))}set(e){let{userId:t,key:n,value:r}=e;return this.localStorageStore.set((0,o.dq)(t,n),r)}remove(e){let{userId:t,key:n}=e;return this.localStorageStore.remove((0,o.dq)(t,n))}removeAllIfNoPermission(){const{namespace:e,hasPermissionForTrackingType:t}=this.localStorageStore;if(t)return;const n=`${o.eg}${e}:`;Object.keys(localStorage).filter((e=>e.startsWith(n))).filter((e=>{const[t,n,o,i]=e.split(":");return i&&r.includes(i)})).forEach((e=>localStorage.removeItem(e)))}}(o.TA,!1)},64793:(e,t,n)=>{n.d(t,{tA:()=>a});var o=n(97880),r=n(31919),i=n(896);class a{constructor(e){this.lastVersion=void 0,this.externalId=void 0,this.product=void 0,this.billingInterval=void 0,this.unitAmount=void 0,this.state=void 0,this.regions=void 0,this.externalId=e.external_id,this.product=e.product,this.billingInterval=e.billing_interval,this.unitAmount=r.n.fromValue({amount:e.unit_amount,currencyCode:e.currency}),this.state=e.state,this.regions=e.regions}get currencyCode(){return this.unitAmount.currencyCode}isAddOn(){return"ai"===this.product}getMonthlyUnitCost(e){const t=this.getAdjustedUnitAmount(e);return"year"===this.billingInterval?t.withDividedAmount(12):t}getMonthlyCost(e){const{quantity:t,coupon:n}=e;return this.getMonthlyUnitCost(n).withMultipliedAmount(t)}getCostPerBillingInterval(e){const{quantity:t,coupon:n}=e;return this.getAdjustedUnitAmount(n).withMultipliedAmount(t)}getDiscountPerBillingInterval(e){var t;const{quantity:n,coupon:o,promo:r}=e,a=this.unitAmount.withMultipliedAmount(n);if(o&&this.doesCouponApply(o))return a.withMultipliedAmount((0,i.ZN)(o));let s=0;return null!=r&&r.percent_off&&null!==(t=r.applies_to)&&void 0!==t&&t.includes(this.externalId)&&(s=r.percent_off/100),a.withMultipliedAmount(s)}getAdjustedUnitAmount(e){let t=1;return e&&this.doesCouponApply(e)&&(t=1-(0,i.ZN)(e)),this.unitAmount.withMultipliedAmount(t)}doesCouponApply(e){switch(this.product){case"ai":return"ai_fifty_percent"===e;case"free":case"student":case"personal":return!1;case"plus":return["team_three_months","team_annual"].includes(e);case"business":case"enterprise":return["business_three_months","business_annual"].includes(e);default:(0,o.t1)(this.product)}}}},9182:(e,t,n)=>{n.d(t,{F6:()=>m,H6:()=>g,Hw:()=>d,Lg:()=>i,Pc:()=>c,YK:()=>l,a7:()=>u,bs:()=>s,dK:()=>b,h_:()=>v,iv:()=>a,tw:()=>h,xi:()=>f,zt:()=>p});n(21703);var o=n(72126),r=n(63143);function i(e){return e.subscription?e.subscription.pending?{...e.subscription.pending,trialEnd:void 0}:e.subscription:{items:[],trialEnd:void 0}}function a(e){return e.subscription??{trialEnd:void 0,items:[]}}function s(e){if(e)return y(e.items.map((e=>e.price.unitAmount.currencyCode)),"All subscription items should have the same currency code.")}function l(e){return!!e&&e.items.length>0}function c(e){if(e)return y(e.items.map((e=>e.quantity)),"All subscription items should have the same quantity.")}function d(e){if(e)return y(e.items.map((e=>e.price.billingInterval)),"All subscription items should have the same billing interval.")}function u(e,t){return((null==e?void 0:e.items)??[]).find((e=>h(e)===t))}function p(e){const t=u(e,"plan");return(null==t?void 0:t.price.product)??"free"}function m(e){var t;return null===(t=u(e,"plan"))||void 0===t?void 0:t.price.externalId}function f(e){return((null==e?void 0:e.items)??[]).filter((e=>"plan"!==h(e))).map((e=>e.price.product))}function g(e){return"ai"!==e.price.product?e.price.product:void 0}function h(e){return v(e.price.product)}function v(e){return"ai"!==e?"plan":"ai"}function b(e,t){return(0,r.UV)(e,(e=>h(e)),t,(e=>h(e)))}function y(e,t){const n=(0,o.jj)(e);if(n.length>1)throw new Error(t);return n[0]}},31919:(e,t,n)=>{n.d(t,{n:()=>r});n(21703);const o={BRL:{currencyCode:"BRL",minorUnitDigits:2},EUR:{currencyCode:"EUR",minorUnitDigits:2},USD:{currencyCode:"USD",minorUnitDigits:2}};class r{static fromValue(e){const{amount:t,currencyCode:n}=e,i=o[n];if(!i)throw new Error(`Unsupported currency code: ${n}`);return new r(i,t)}static sum(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const o=t.filter((e=>void 0!==e));if(0===o.length)return;const{currencyCode:i}=o[0];if(o.some((e=>e.currencyCode!==i)))throw new Error("Cannot add money with different currencies");const a=o.reduce(((e,t)=>e+t.amount),0);return r.fromValue({amount:a,currencyCode:i})}static zero(e){return r.fromValue({amount:0,currencyCode:e})}constructor(e,t){this.currencyValue=void 0,this.amount=void 0,this.currencyValue=e,this.amount=t}get currencyCode(){return this.currencyValue.currencyCode}toMoneyValue(){return{amount:this.amount,currencyCode:this.currencyValue.currencyCode}}withAmount(e){return new r(this.currencyValue,e)}withAddedAmount(e){return new r(this.currencyValue,this.amount+e)}plus(e){if(this.currencyCode!==e.currencyCode)throw new Error(`Cannot add money with currency code ${this.currencyCode} to money with currency code ${e.currencyCode}`);return new r(this.currencyValue,this.amount+e.amount)}minus(e){return this.plus(e.withMultipliedAmount(-1))}withMultipliedAmount(e){return new r(this.currencyValue,this.amount*e)}withDividedAmount(e){return new r(this.currencyValue,this.amount/e)}zeroIfNegative(){return new r(this.currencyValue,Math.max(0,this.amount))}zeroIfPositive(){return new r(this.currencyValue,Math.min(0,this.amount))}isPositive(){return this.amount>0}isNegative(){return this.amount<0}}},896:(e,t,n)=>{n.d(t,{$v:()=>i,ZN:()=>a,pp:()=>r});var o=n(97880);function r(e){if(!e)return!1;switch(e){case"ai_fifty_percent":return!0;case"team_three_months":case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return!1;default:(0,o.t1)(e)}}function i(e){if(!e)return!1;switch(e){case"ai_fifty_percent":return!1;case"team_three_months":case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return!0;default:(0,o.t1)(e)}}function a(e){switch(e){case"team_three_months":case"ai_fifty_percent":return.5;case"team_annual":case"business_three_months":case"business_annual":case"enterprise_three_months":case"enterprise_annual":return.1;default:(0,o.t1)(e)}}},26929:(e,t,n)=>{n.d(t,{Ym:()=>l,cS:()=>s});n(21703);var o=n(30120),r=n(97880);const i={payment_failed:30,confirmation_required:15};function a(e){const{now:t,subscriptionId:n,invoiceId:o,overdueReason:a,subscriptionStatus:s,invoiceDueDate:l}=e,c=function(e){const{subscriptionId:t,subscriptionStatus:n}=e;if(t&&n)switch(n){case"past_due":case"unpaid":return{paymentStatus:n,reason:`Subscription [${t}] status is '${n}'. This triggered the '${n}' payment status`};case"incomplete":return{paymentStatus:"past_due",reason:`Subscription [${t}] status is '${n}'. This triggered the 'past_due' payment status`};case"active":case"canceled":case"incomplete_expired":case"paused":case"trialing":return;default:(0,r.t1)(n)}}({subscriptionId:n,subscriptionStatus:s}),d=function(e){const{invoiceId:t,invoiceDueDate:n,overdueReason:o,now:r}=e;if(!t||!n||!o)return;if(r<n)return;const a=n.toFormat("LLLL dd, yyyy"),s=i[o];if(!s)throw new Error(`Unsupported overdue reason '${o}'`);const l=n.plus({days:s});if(r>=l)return{paymentStatus:"unpaid",reason:`Invoice [${t}] is overdue since ${a} due to '${o}'. This triggered the 'unpaid' payment status after a ${s} day warning period ending on ${l.toFormat("LLLL dd, yyyy")}`};return{paymentStatus:"past_due",reason:`Invoice [${t}] is overdue since ${a} due to '${o}'. This triggered the 'past_due' payment status on the due date.`}}({now:t,invoiceId:o,invoiceDueDate:l,overdueReason:a});return"unpaid"===(null==c?void 0:c.paymentStatus)?c:"unpaid"===(null==d?void 0:d.paymentStatus)?d:"past_due"===(null==c?void 0:c.paymentStatus)?c:"past_due"===(null==d?void 0:d.paymentStatus)?d:{paymentStatus:"paid"}}function s(e){const{now:t,overdueSubscription:n}=e;if(!n)return{paymentStatus:"paid",reason:"No overdue subscription was provided"};const{subscriptionId:r,invoiceId:i,subscriptionStatus:s,dueDate:l,overdueReason:c}=n;return a({now:t,subscriptionId:r,invoiceId:i,overdueReason:c,subscriptionStatus:s,invoiceDueDate:l?o.ou.fromMillis(l):void 0})}function l(e){let{status:t}=e;return["requires_payment_method","requires_source"].includes(t)}},2438:(e,t,n)=>{n.d(t,{Rb:()=>s,nR:()=>i,qH:()=>a,uN:()=>r});n(21703),n(57658);var o=n(60897);function r(e,t){return t?t.percent_off?{amount:e*t.percent_off/100,monthsRemaining:t.duration_in_months}:t.amount_off?{amount:t.amount_off}:{amount:0}:{amount:0}}function i(e){return"personal"!==e&&o.tt.find((t=>t===e))}function a(e,t){const n=e.find((e=>e.externalId===t));if(!n)throw new Error(`Unable to find price data for ${t}`);return n.billingInterval}function s(e){const{currency:t,isSepaEnabled:n}=e,o=["card","link"];return"EUR"===t&&n&&o.push("sepa_debit"),o}},64684:(e,t,n)=>{n.d(t,{AL:()=>h,AW:()=>R,B5:()=>A,Ei:()=>D,Hf:()=>u,I6:()=>Z,J2:()=>S,Rk:()=>f,Uk:()=>O,V3:()=>w,W9:()=>B,XO:()=>d,ah:()=>P,hY:()=>l,jI:()=>E,jc:()=>k,lF:()=>F,lR:()=>b,m4:()=>p,pd:()=>m,s8:()=>y,t0:()=>T,tO:()=>C,uG:()=>g,x4:()=>c,xC:()=>_,xf:()=>I,zz:()=>v});n(57658),n(21703);var o=n(72126),r=(n(59753),n(63306),n(72141)),i=n(29369),a=n(90965),s=n(97880);function l(e){return void 0===e.membership?[]:e.membership}function c(e){let{members:t,groups:n}=e;if(!t||!n)return[];const r=o.KX(n,(e=>e.id)),i=t.map((e=>"group"===e.entity_type?r[e.group_id]:void 0));return o.oA(i)}function d(e){const t=l(e);return o.oA(t.map((e=>{if("owner"===e.type)return e.user_id})))}function u(e){const t=l(e);return o.oA(t.map((e=>{if("team_level_guest"===e.type)return e.user_id})))}function p(e){return Boolean(e.archived_by)}function m(e,t){return d(e).includes(t)}function f(e){var t;let{team:n,space:o,userId:r}=e;const i=null===(t=x({team:n,space:o}).find((e=>{let{userId:t}=e;return t===r})))||void 0===t?void 0:t.teamMemberInfos;if(!i||0===i.length)return"none";return g(...i.map((e=>e.type)))}function g(){let e=0;for(var t=arguments.length,n=new Array(t),o=0;o<t;o++)n[o]=arguments[o];for(const r of n)e=Math.max(e,i.d2.indexOf(r));return i.d2[e]}function h(e){let{team:t,spaceValue:n,userId:o,groupIdsThatIncludeUser:r}=e;window.__c={n:"isNonGuestTeamMember"};const i=(0,a.kC)(n.permissions,o);if(!i)return!1;if(t.is_default&&i)return!0;r||(r=(n.permission_groups??[]).filter((e=>e.user_ids&&e.user_ids.includes(o))).reduce(((e,t)=>(e.add(t.id),e)),new Set));const c=l(t);for(const a of c){if("member"!==a.type&&"owner"!==a.type)continue;const{entity_type:e}=a;switch(e){case"user":if(a.user_id===o)return!0;break;case"group":if(r.has(a.group_id))return!0;break;default:(0,s.t1)(e)}}return!1}function v(e){let{team:t,space:n,userId:o}=e;const r=f({team:t,space:n,userId:o});switch(r){case"owner":case"member":case"team_level_guest":return!0;case"none":return!1;default:(0,s.t1)(r)}}function b(e){const t=function(e){const t=function(e){const{team:t,space:n,spaceUser:o}=e,r=t.getRawMembership(),i=[],a=r.find((e=>"user"===e.entity_type&&e.user_id===o.user_id));if(!o.isMember()&&"team_level_guest"!==(null==a?void 0:a.type))return[];a&&i.push(a);const s={};r.filter((e=>"group"===e.entity_type)).forEach((e=>{const t=e;s[t.group_id]=t}));const l=n.getPermissionGroups().filter((e=>{var t;return s[e.id]&&(null===(t=e.user_ids)||void 0===t?void 0:t.includes(o.user_id))})).map((e=>s[e.id]));return i.push(...l),t.is_default&&0===i.length&&i.push({type:"member",entity_type:"user",user_id:o.user_id}),i}(e);return 0===t.length?"none":g(...t.map((e=>e.type)))}(e);switch(t){case"owner":case"member":case"team_level_guest":return!0;case"none":return!1;default:(0,s.t1)(t)}}function y(e){let{team:t,userId:n}=e;return l(t).some((e=>"team_level_guest"===e.type&&e.user_id===n))}function _(e){if(!e.permissions)return"none";const t=e.permissions.find((t=>S(t,e.id)));return t?t.role:"none"}function S(e,t){return(0,r.zU)(e)?e.team_id===t:(0,r.Ix)(e)}function w(e,t){return!!(0,r.bm)(e)&&e.team_id===t}function k(e,t){return!(!(0,r.LW)(e)||e.team_id!==t)||(0,r.KK)(e)}function I(e){let{team:t,space:n}=e;const o=x({team:t,space:n.__IM_SORRY__getValue()}),r=[];for(const i of o){const{teamMemberInfos:e,userId:t}=i;e.some((e=>"owner"===e.type||"member"===e.type))&&r.push(t)}return r}function C(e){let{team:t,space:n}=e;return x({team:t,space:n}).map((e=>e.userId))}function x(e){let{team:t,space:n}=e;const o={},r={},i=new Set((0,a.Mi)(n));return(t.is_default?T({team:t,space:n}):l(t)).forEach((e=>{if("user"===e.entity_type){("team_level_guest"===e.type||i.has(e.user_id))&&(o[e.user_id]=[e])}else"group"===e.entity_type?r[e.group_id]=e:(0,s.t1)(e)})),n.permission_groups&&n.permission_groups.forEach((e=>{if(e.id in r&&e.user_ids){const t=r[e.id];e.user_ids.forEach((e=>{e in o||(o[e]=[]),i.has(e)&&o[e].push(t)}))}})),(0,s.qP)(o).map((e=>{let[t,n]=e;return{userId:t,teamMemberInfos:n}}))}function T(e){let{team:t,space:n}=e;const o=[],r=new Set;for(const a of l(t))o.push(a),"user"!==a.entity_type||"member"!==a.type&&"owner"!==a.type||r.add(a.user_id);const i=(0,a.UD)(n);for(const a of i)r.has(a.user_id)||o.push({type:"member",entity_type:"user",user_id:a.user_id});return o}function M(e){return"user"===e.entity_type?`${e.entity_type}|${e.user_id}`:"group"===e.entity_type?`${e.entity_type}|${e.group_id}`:void(0,s.t1)(e)}function P(e,t){return M(e)===M(t)}function A(e){return"self_join"===e.space_member_join_access?"open":"team_members"===e.visibility?"private":"closed"}function R(e){const{accessLevel:t,isDefault:n}=e,{id:o,permissions:i,settings:a}=e.teamValue,l={type:"explicit_team_owner_permission",role:"editor",team_id:o},c=(null==i?void 0:i.find(r.zU))||{type:"explicit_team_permission",role:"editor",team_id:o},d=null==i?void 0:i.find(r.ix),u={visibility:"space_members",space_member_join_access:"self_join",invite_access:"team_members"};if(n)return{settings:u,permissions:[l,c,{type:"space_permission",role:c.role},{type:"explicit_team_guest_permission",role:"none",team_id:o}]};if("open"===t){const e=(null==d?void 0:d.role)??"none";return{settings:u,permissions:[l,c,{type:"space_permission",role:(0,r.YX)(e)?e:c.role}]}}return"closed"===t?{settings:{visibility:"space_members",space_member_join_access:"invite_only",invite_access:a.invite_access},permissions:[l,c,{type:"space_permission",role:"none"}]}:"private"===t?{settings:{visibility:"team_members",space_member_join_access:"invite_only",invite_access:null==a?void 0:a.invite_access},permissions:[l,c,{type:"space_permission",role:"none"}]}:void(0,s.t1)(t)}function D(e){let{userId:t,teamModel:n,spaceModel:o}=e;if(void 0===t||void 0===n||void 0===o)return!1;if("private"!==A(n.getSettings()))return!1;return"none"===f({userId:t,team:{is_default:n.isDefault(),membership:n.getRawMembership()},space:{permissions:o.getPermissionItems()}})}function E(e){return d(e).length<1}function B(e,t,n){return!!E(e)&&(!!(0,a.wv)(n,t)&&("private"!==A(e.settings)||(n.subscription_tier,h({team:e,spaceValue:n,userId:t}))))}function F(e){let{groupId:t,teamMember:n}=e;return"group"===n.entity_type&&n.group_id===t}function O(e,t){return t?t.filter((t=>!P(t,e))):[]}function Z(e,t){return(t=(t=t??[]).filter((t=>!P(t,e)))).push(e),t}},62992:(e,t,n)=>{n.d(t,{J:()=>r});const o=new Set(["7754cf02-251f-4bc9-ab2f-9cc897765336","ba43b46e-4ad3-47f7-95f0-58a3ba01476f","86fd2f05-b95a-48d9-a2fd-9fd8aab2f74f","aa94ac95-f6b0-47f1-8211-37087c9dcba6","10e7ee2a-3beb-4b49-96f2-8b8f662aabd4","6ce5f94a-8f64-42bd-9df9-2718a97bf539","c3eec6d5-b872-4ed6-ba75-306ec8006d88","7777cfa6-76ad-4976-8ef6-8f49c217ab52","6f521ac5-cfca-4580-860b-65df285f9660","fbe283d2-7e33-41ce-ac39-4b29f194ee26","c1de9900-4b7d-431b-a470-84c5c26eefde","dfb87d56-70af-4ac6-917d-1291d8ec7354","73feb0ab-635a-4c7c-8925-0bf551c61700","f0391877-6552-4b6c-969f-4effd300e264","75aacb5d-c105-4c73-8aad-bba3df0181f8","6f040c35-60bf-432c-b30a-096d494c5960","b8cf3a52-269f-430e-8dcf-e4cc860e0884","ad3d8b0b-22d8-48d1-9146-812b7ad4faec","0bc5a2e1-f401-4179-ba2a-c99bcae55190","179b5241-bada-44e4-8928-1efd1656c38d","c9443c7b-c803-49fb-bce3-44d4e9021454","27fdba35-578f-482d-b496-a98821942c35","b72f783a-5dce-41e3-9735-2cae3fcef6e6","3d811429-6bdf-489a-8f10-832380aa873d","de1cdbdd-9c77-4f08-8211-007a2b3401c3","307087b5-e940-46bf-ae69-fe3eebe91031","566b2711-4a9c-4d1b-a9d7-a2439f358674","bb957a92-76ec-4283-aaab-7fa77deba3f1","bef399e1-8841-4a69-aa8b-1471664c582c","ee6c3e86-3fd1-4164-9351-b31ccbc695f8","35eee73a-0536-420a-a6a5-125e0aad2d54","ddc2981c-e7fd-4880-81b5-86e0c4bc2ea1","14d1a2a5-dc71-4275-9b0c-cfc5a1b13b00","fcc6e15e-257d-4260-bced-da7d6aeb7257","10a07eab-3d8f-42d2-86fe-e58aba32c6a4","a929b937-0b73-427a-afd5-1896715abc49","1f87c3fd-3c99-484d-af03-7a6296dd09af","9b8c7303-4148-4754-ae47-da98ad15ebd3","06917ea1-367b-44d4-9e74-8d0a507d0a1f","44b19dbc-c008-4dc3-a203-77d28f5c1859","c87c2638-8564-444c-88c6-8d6231da145e","f3627a1c-aa76-40d0-956d-4b305813f3b2","0bf1bac9-af83-47e9-8bd0-987732d57348","3b9a8796-0d8e-455e-af31-f5b4631ae438","4728ffef-226b-423b-a730-c71d38e71d85","835f8d33-9268-42e6-9e04-a9c9db7acfac","0f844dc5-4142-4061-9e84-e0dd1ef71d00","44ed096e-f287-46a7-9222-f8f1e519b0bb","866ce03b-d6a6-4ce3-a527-b95118b56bd7","82c3118e-5e8b-4917-a921-9e695a1853bb","72630fc1-3d80-4b39-b7de-269b1ce5d455","039fba32-3bea-4377-8b42-04ff8e5dd3f4","9f115bdc-8fa6-4272-896d-2678970d3ef8","98772d76-b111-49e4-a9db-f000e9d61b03","960c9f76-30d6-4861-bc01-ce82ba1a8591","b830a9d4-06bd-4639-ba9e-2832ee81a689","912d82c7-cd39-455d-8ff6-9742118186db","ca827af1-3833-4a3a-8e82-c02552d820f5","bb439161-a466-4571-b5da-63f84b193474","a80ed33e-3840-408e-a445-b1099ce2b9d0","f24f8158-ecde-49ef-a51a-95b6ccc0703e","bdcdf14b-1f7d-471b-b4d6-e3cd244d12a6","e15410a0-4766-499d-a513-f536544bd2f3","ef512485-d49b-448f-a038-c6c71cfddbca","5f6d17ed-543a-4395-a5a7-04b3d2a35a55","48374a18-b873-461c-9d08-0127c6553204","d3cc5d9f-1aee-4ebe-90ec-77968c058905","b3558f2a-8ee3-472b-ab47-3d05b83e47a4","caca4605-2888-4869-8dfd-ef8f1dedab70","61c5eaf1-c511-4e80-9ad9-a4aab4edd106","1a49c41e-4107-4161-ad19-7161197defa5","bf154056-b048-4a3e-bb40-f41ec111791b","0c805a36-50be-4442-9a35-ed2907d70239","72955d7d-a8c1-4e84-a5e1-db637f53781e","e5c98f03-928b-4d20-ba01-e36382468187","0fa21220-95d0-400f-9fa4-5a95a046e9e8","ff889770-d18d-4b18-9f01-905a57cd9b28","2273a46b-12b5-483b-8f67-f4842f282967","47f7d067-7741-4113-ab72-6d12b8cd5786","e609dd4f-39d7-4424-b273-6eead26c7fe9","4ba726cb-4898-4702-9e05-4e23d85fd015","d6ec9638-6bb3-4b9d-ae4f-47122405e3eb","282a4fdf-1457-4d32-88cd-51d599481d71","eb12d79d-5dff-4d0a-ba49-02c7fd72e7ac","04576141-9d17-4d7c-a499-79590630e9fa","e0513925-3754-4cdc-8213-398c81f89d1b","25154d3e-5937-43f2-a47e-11509f34ce5a","59fd9e00-4b34-4e8d-bf9e-26b86323fd81","07b1a6c5-3526-4272-a35a-127684cfbcfe","e9642cc5-1342-4e34-b0c4-585321151347","a2bbdea8-2e03-4df8-9b89-0569c0ffd127","6905c1f8-6e8b-4e92-b3e5-5bf3059ce472","7cb6e153-76d8-4f11-9c3c-2f0c3b816ddc","8c37f1d6-19ee-4de0-a851-65ddbef0d642","1b65b28b-db02-4a9a-b596-26bd59ec9ce0","1d32c0de-c904-4e01-b56f-759c643c20ca","14fc89bf-4a6a-44ab-b9f4-79c5f997a73a","c352dfd4-67b1-413c-88ea-f7bf2ec8a3e0","bdb36fd4-ac83-4c8d-b83b-2884fa63f0fd","f7bdcac5-3454-4ffe-904e-ad4fe91b4b53","ea04b311-11bd-4872-9ab7-c15faadc3e3c","b03f9c77-daaf-432a-8573-71a931204d98","89238317-2b73-4ca7-922d-7c6df95f6bdb","33f2c6ca-7a7e-44d0-ba49-8e8e2897c91f","70b3c08c-cd4a-40db-9c2c-0029a23ba970","8de1c223-226e-46f6-9f16-36847f42b99f","4175a9b5-ea6e-489b-a2b1-70db5518f9db","f582c072-525e-4412-8f5a-68e8f9aaba9b","1b53b923-a77d-4bca-adc6-764ff78769f7","16a18cca-cacb-48ed-b1a6-72560e0ad728","cb5551ab-a47f-41a0-8a9c-ad134d77c693","75fd09a5-821f-4faa-a8f4-9f862d3892d9","75a93415-c9a4-4270-86fd-42664893cc7c","754b3d46-509e-4a4b-82d0-ec340114d5b5","42a45521-808f-4f85-9922-dc8bc583e287","a5b24576-80f8-415c-9877-45ba9d6e6033","58444e8f-94eb-4708-9f3b-6582245e6a9e","e29a8fd7-faf4-4614-9341-c55cce539b3d","f41adbea-5c0a-4b74-b222-d898d8ece92c","aa2398a2-6261-4995-bcf5-2423e8560336","cf48a687-67bd-4117-ad07-c20c0682662c","edbfd965-92a1-4291-b11e-f52d21184507","e7b453b7-98b4-4166-a97a-e99fc7bd6a35","d7768c90-8491-42af-b960-3575f5b218a7","9368e169-ec01-4953-b7dc-817398ab6e53","3477b696-40b1-4548-8ff0-a93e0d41fc25","e0ccdb5a-bacd-4d8c-875c-4f29c8786048","8fb16dba-6f02-4d4f-b69c-210a900f9e57","9a47645f-8880-4d04-8b1e-d49f9f24a524","ded667af-370f-469a-ae2b-16737d423cfe","cd19749e-355c-493a-a1a9-64be68ba9399","aa94fec7-7dba-4aa3-a444-d321c2e6e11c","68e75880-ea6b-43f6-9a62-f813972d8f40","8c6f9188-eaff-426b-9d81-a14c4148a34b","b17d77ae-2af7-48e3-be6b-0c70b1dadd61","3e2349d2-0ca4-47ed-b4b9-817e5daafb19","5fd0af8d-72f1-4b7e-8246-4c46b651c531","e558a94c-6104-4bfd-b97b-ac7a2cecce35","cb137291-1ad2-4c35-b496-6f87a469c1b2","a7d3d253-0bfd-4c9d-a9c3-3459ec3ee8d8","3a966f53-355f-4a2e-a25a-4afce1ea4a0f","eea1c2a4-4992-459e-bf8c-735bf96abbe9","57c9d2f6-7086-4d8e-9d5d-1eca18ec8891","06334913-07b1-4622-9b2a-370cf56f0007","74dfb5af-738b-4a0e-916b-ce1970ec85cf","ba72173e-c456-46e9-92dc-73185c654d77","1887f846-11e7-4ab2-b816-c2e8c724718e","9ac64262-cad7-44f3-bfae-96dabec9e770","5b51de44-604b-4a96-b421-9f3e3cf470d2","b9626438-4451-441c-9608-35ab50e3b182","eb402bfa-b46f-4f51-878c-37aef629d3fa","89c371f3-766b-4dab-bde6-d23a97952cd5","ff21bacf-9b2b-4dc2-a715-02cf94e08015","87c07fd3-dcb2-4ba2-8855-927206bfba62","ea69e9ee-ee67-4f2d-83f6-7f862a8495ff","958b2624-6de2-44c8-bf07-ce363d450a28","67a391bb-2b1e-4fb6-b032-dc006e236e6e","e1218662-df9e-477c-bf3d-805e9b420911","697d17c4-4597-4949-9c24-c220aefc31f7","3d6561ad-7ea5-4c0e-9b9d-3280be3ffcc7","0f12132a-db77-4cdb-8b24-449d623a9010","05017ffd-160e-48c5-a6cf-67d04a45f53f","92cc7ea8-55a1-486c-a2ba-71c5093628aa","0821d4cd-353f-431c-bc63-5b51a7971bf0","4c801bb7-cb1b-45e3-a5eb-5aa31bbe1098","5c94c383-f6b2-4cf3-aff8-d629519c5fcd","b989c735-bc3a-4695-a7c2-9496aa28b8a6","a9019468-ed82-456b-854c-c08adf545757","4a898da1-68ac-4794-a30c-1fb7135776eb","aaddc9ad-2a6b-49cd-85a3-e80f4a04c5b8","6dd32bf2-72f8-4e62-bd77-870d9cc9cc99","949b3963-dbea-4abe-9590-97c7cd361209","897a2735-0e80-46da-b6f6-58fc3df53086","cdbbe77b-4b6c-49f0-a006-c1cb7c053d15","61a5c696-b407-4e63-85a8-b57f3f935cbb","42e9c365-194e-49b2-a7ac-d651f12c8cf7","fd81a9e6-b912-4f81-904c-a52526f6dbda","c46efa5f-a694-475c-8663-040a95fb807b","4adffda2-b85f-4660-b450-cfe09c9b0738","bd5cc0b9-d2e8-421b-9c88-de91dda82774","e9bc2136-0167-4fec-a72d-737571f7b027","0f93fc48-ec04-445d-94e5-ce4ed8b70c87","db3c3399-ddb8-4bae-9e89-1b0478931527","f3dfe652-b303-4177-ac57-10dff07f906f","56f414f6-20c9-40e8-8ff2-29784f768d1c","644c1c6a-8d94-4041-8dd4-5fb6a2aada91","7da30be9-2725-4226-9247-2a8fbf5d3d71","dd5540c5-fb12-49f9-b94f-5ffca3054ba5","b4f7298d-08b2-407a-9bee-50dbac0a7f00","7a950eae-90da-4885-8157-68009c201af0","8da6e187-ca72-4c85-8640-517601e1271f","046c0e5f-7098-42d1-b754-64fcc6276660","0b1a2c1b-3b18-4a55-8fa8-08fd5985aa4f","1abf52e0-b652-4629-8353-e2fc1ed8f046","bd871031-b4ad-417f-8082-5fd7bf3c805d","e8d82ad2-a010-4448-a29e-bd19ddf655e7","13d638ec-4f82-4318-bfa6-1f636643dc46","eeb6fd30-006e-4f99-b4c2-40931da53359","4c86679b-7ab7-407e-b863-2a8a46b82a8b","0a0b7aa2-bec5-46e7-949e-fd54ef7bffdc","d355b3d8-545a-4720-82f9-2a0243d72407","dc7a8827-25ac-4443-b8e1-c7de2304eb25","79ddf4d1-9031-4700-b30b-8db26a7b02af","68b8c5b5-7836-476b-8a02-af5b500aa180","e118777a-a087-4a6a-ba10-699cb73b06c4","b4d83009-a10d-4eb4-a04b-ff3dbc8e1304","1c3735df-eb4a-4a7a-ac45-a12b8c6ddbf7","412cb881-aecd-4cfd-8187-cbef4f6d70bb","3d875026-6da6-4cdf-ac18-084706a3eb24","f992976c-ecb4-41b5-ae2c-b25d48707701","90b462a0-5cbe-43d3-8de1-04926b96d492","a28036b8-5a0d-4867-9d8f-dfe034d6ac77","34e78ee8-d46b-4bd1-accb-8efffd17e7f2","1aacaa6e-3718-4b6b-9436-e5cf747a85f5","b147ba74-1764-41ec-93f2-47694e1b8ae3","f8243ce8-45a0-468f-a949-42595e728618","42496cf1-408c-45b5-9492-90985b5d933d","ee70e79d-2c8e-4307-81e3-5e8d1e6cdc4f","833ac885-ef61-4748-bd02-85e3e927a7da","da2975ce-c5eb-4f36-9ae5-541d74b0b370","edc45a1f-e2b4-4a8d-8868-c5d33027ff65","0907e06e-8884-4cdd-bc9a-766dc771049a","22f3e6fb-90b9-4cc6-bd8c-7d97998ffb9c","020a62e4-c5b4-4280-9872-3bf56fa34803","be58e424-c2ac-4835-a482-1083af3f75db","f3a92c2d-1fe4-48e6-b07e-52bf0a73735b","5b51f361-b0a8-4442-a095-4e781cdd2a38","476b5d8c-6d64-49fb-b664-d5c3b19e0dc6","bccc09eb-c3c0-43e1-a377-73ede6bfdc93","b31728b7-f4c4-4870-85dd-e4e543354fa9","4d2f560e-ef38-414b-b78c-c6b400f6d521","634abe84-7bfd-41c4-8ca8-8f2d8d548ec5","06c04e85-a23f-411c-8134-7d75ae627ebb","4c007793-6634-4891-b899-f709d3f8be13","90f9e4a2-b696-4f0c-ba98-d2856619b921","011db133-fd04-47f7-8fc1-255d2bb63e0b","652d83ae-50de-45da-8086-33749e5a8484","dc42afef-e4eb-4f39-9414-30cf73df3ec6","dd47099e-f772-48fd-97da-0396514afd22","9a0a5a76-bca8-44f9-87dc-65384c3a217c","99dcd6b6-61a3-4a17-945c-3e7be66ea38d","30b77330-aeed-45ff-84cc-fe68ff1f8f3a","f5157133-84a3-4904-97d4-07ee533ad17d","5ff9e66d-d71c-4449-825f-2f40aea916a7","05d2906c-0d7e-464a-86a7-e201ef984fdf","46500981-90b0-466c-ba96-7c8cc3abe6bb","66e403e8-7381-4576-a3a1-55b3e5562142","b8f6fce4-32fe-44d3-aa93-1f2b98735a46","9a87eddb-b5c5-4d26-9c05-2ebb3bc25c38","d7608a6b-48f4-4155-abcc-e3f816d76540","5b1ea383-85a8-49e0-92db-c5314fc2bf60","09c9fad5-8783-4bc5-823b-ee96006c988a","c6754733-1cae-447c-87f1-7dcc97ec3c91","e75096b4-c1b9-457c-a0b1-08bb16a9ccb7","184316f7-5174-4e40-ab49-9d0acc795626","1d1f0bf1-ed8d-4b28-b95d-2d45951f6bb7","e4bcde5b-a9af-4ca3-8048-84ed66114db6","fe748adb-5348-4b99-9550-eb578d1267fe","77af2dcb-2afc-4346-afed-eb4a056e6aea","4e041ef3-1f42-4185-a27c-89f919eab933","87546bbc-daa7-45f8-a9a4-1d3fb0dbccc8","c45fab4c-5aae-47ec-a2e8-3eff476212ca","83b9fbc2-90db-4d77-805e-3e5439c3cf94","81bb64e8-81e8-491d-8f87-d08a1a563293","7c02ebd1-16b2-45a2-93c0-276a9b2b802f","5ba31d6f-cb0d-404d-ba7e-470460959007","52308efd-956f-40f1-86c7-121262bfacc1","f76d2214-119e-4338-a84c-976c0f816f8d","d80b366f-38f8-4f43-b773-5fd57180ea04","7b2a23ff-8a2d-437d-927a-d3ebe2bfad75","0397fc82-ee33-457d-b0f5-ee1d6cdb96c8","c11cb495-f207-4780-b893-c049f88cb828","29927ba5-b792-45d2-a9eb-92009c88f23e","4c3cd83e-e143-4a16-9c5a-fafada32b0d1","65767cff-5517-4446-bc54-ab2783fd245e","2a5c0225-dc76-4cdf-9505-bef61cca3074","e687822e-f385-4a3a-b52f-e07dcf1eb946","85dbea68-b96e-4807-a076-fd2e76050c56","f3bccfd2-1ead-4101-8fb8-fd91e9264c47","93aaac98-cf8b-4647-bec1-75cadd34b277","5b6740a2-5ecb-4333-9971-ce9122536803","d138d7b0-547f-4a7a-aa7e-f5905d6f93d1","57ba4b5b-cda7-4fbf-a84b-d390fa8cb998","67e3ad55-b09b-45db-9e1c-d19f6cf42f75","c79374e2-375f-483d-b911-fcf31f5ab260","7cdb9ea8-6ba6-4e96-bd55-4a088f564c1a","2b8820f7-aa83-4844-aa7c-49f65e76ca13","5d695d09-8b83-4974-bbfa-e23db25c9777","965b2b54-ddd1-4aa4-ae8b-e9063f176508","cd7e1241-257f-4fb6-8a47-b58c44fa7fd8","144276a5-081a-491d-a7fe-1d2c302c3c77","48a232b8-2bc3-4e9c-8a19-3a6ea3b0a4f2","eb9db865-87c3-4c9f-8fc2-b616f33a191c","5a05fe82-51e7-4dec-be56-9ee88e1dfb09","1819b87e-93f4-437f-a576-a81829aea8a9","ad85e229-b68e-4609-b15d-7fb83cc57440","ac64ba9a-7be1-49a1-b3c7-ab03eeabb887","a04035db-bb1c-4a4f-a401-46b2852b69d5","31118d8a-d030-4990-ab6c-c1903e25f52d","b55a8da7-da4c-4f95-b24d-df30c2f45c71","d004e080-0446-4f6d-b7c1-e23a4112e42e","2229861a-a659-49b6-83f7-04532904bcaf","c627a829-9cce-40ba-9f5f-658730381474","cd180496-ae10-45de-b90d-ed645113e574","9f85c044-5eb6-43c3-8067-f3a7c605e90f","0428cf5d-33df-46de-bde7-15cdf830836e","2343e042-1a90-4156-bb85-1b4796cef497","f1559f2d-b7fa-438f-8203-314660014496","1137fddf-9bc0-4096-a8f7-60299e1045fa","933b8d80-00ac-441a-b7f1-ff89747a96ef","04530f0c-0761-4c13-8d09-9de1f762f1fb","47345698-eaa6-4dff-a289-a6166b7ed7de","73d74b26-c367-41d2-9631-8b0870281364","f871a524-8782-4e18-82bd-b37c9a02d20e","1cb94ea7-851b-47c4-9779-ca6e36ff729e","d825ee6e-087e-4529-b9c6-cc872035a99b","a0813507-dd48-4247-9e11-5591505be841","22e4f4a0-11e2-48e4-971f-45b042ab5ffe","f2cf7d5a-be29-4778-8716-2ba8052782b5","f7dcc389-593f-440f-9d0f-f2fcb13969b4","f1337a6d-af6e-4577-b393-b1b951b29caf","b0221a97-158b-40c8-9fdb-96de7f828d6f","ebeec459-313c-4cc1-b10e-1d1fd89379d2","67fd654f-5f30-4da9-a9ac-c3a00e62298d","ee5fc60a-9b57-470e-965b-016a9c78965d","1a69020b-4480-48c5-863e-0d362dadc4c5","07cedd59-44b0-4cf0-bb2f-71c15d4d959a","d9deb1c2-2e23-48c2-9df9-d45053a3d7c9","749d0431-47c8-491b-b325-2632a3450efa","3e688f6f-dd89-44a2-990b-1fbebfe4c545","49b38afa-be03-45c9-9709-e99f0fa29896","c0f9dd57-cb4c-4275-8c2c-923bf844fdcb","1224bf88-115f-4ccb-9990-9193ff2c38a5","0e60c769-183d-4657-9a98-b4348b446275","3a47f793-6767-4fab-bddd-acfd43149d5b","345b4e0a-1cd4-4bf6-9647-2830ff18d5ec","8f3857a7-54c3-4a78-8b47-5826f8886fee","dfe91161-0409-42bb-adf7-a97310d6a5e7","49a239b3-6587-4943-8518-ab1f6aa0c200","42f690d6-1db4-410d-85b7-5c89d567ecda","5632a03f-c43a-4560-86f8-9c85313f4164","5ecf0ee6-6e50-4b3e-a08e-62c57333a30c","073ca394-eaed-4b85-a191-6f44fc33ee41","538b78d9-928e-4ad4-b15a-34b37c96ab37","424d82df-9b44-41b5-b611-a1c29ee8ba3e","7a913969-1603-411f-9d1f-cea873782252","b67ce306-a79d-42b0-b2ea-030fc537611e","73aa919d-2805-4438-848b-8349c3f65fe0","c11dafa1-9f92-4f55-8fb7-4e1661bd8fa6","8d9c8281-961f-4c0f-94d3-c50222841c73","98846fb8-3d54-4f77-9d36-414234d86ef6","33b07269-76b3-44d8-9b67-8e101b1df37e","09556661-5d31-4e2b-a916-40772339c29d","a0a3bb82-6ff0-41b3-8b56-65bfad9bddfe","0de62cce-27ed-4c27-a27c-ad4ff7df3cb3","cfaa64e2-78ef-4426-a6a5-9c97b9416a9c","fac15e0e-1c6d-4f78-8b8b-0f64c67559e8","628a2e25-26d3-4ad2-af01-47435cb033aa","7d775bff-9e67-4e9c-bdf6-657139b0c7e3","c69ae828-ce06-417b-8d30-193e8f051c03","4d3d6a95-ba15-4d1a-ab3f-c62584729c22","40b390b6-94d7-4328-879a-4c44fc289ad4","fdebe0c2-395c-425b-ab3b-b460431c9f62","8885799b-3107-4637-8d53-e1a9c3699875","b6f9434d-abba-4b06-b4c5-802dd940be7c","f563cfb6-381f-49ba-85b1-7a59d873d828","5964fc7d-d005-414d-8ddd-f600e78816fc","26655761-99f0-4668-abd0-e86f18515d7d","a9fdbb7a-f803-49ba-b75d-cfa1a3742687","a17cce9b-db68-45da-8f95-44470ab22288","92fe12c4-d11f-4721-830f-acc1dc7ae238","fe508199-026a-4d25-8f86-4863e133ec55","a3d9e508-d6aa-43f0-81cd-bc04671db8e3","8131a139-1b1c-4eda-a538-5f3ffd99a260","eb1a4b9f-2727-4e6e-868e-5120a6f2a48a","f8a4db90-da62-41d3-a74f-fd50fc4f5458","b5c44d60-6655-4f28-a7a0-edd81828f572","6338cbe2-021e-406d-9bb8-88f1ddf0cbbe","51e3a828-8857-4d4c-907f-289e425fff1a","5ca2c593-796b-4ec9-a6af-0f9b56419b9b","41ecdb08-d684-418c-ae6a-6e459f7b7e39","b0df2874-6a4a-41f0-ab0a-74ffd9a58638","814f566f-c8da-4034-8ea5-dc73d1041280","7d3ffe57-f411-4116-97b1-5da284fb32f5","2731005d-3f2c-4d59-af95-857605008540","5c186c47-5c84-44c6-9019-fb1eda5ab042","4ae28606-869e-475e-aa55-6497ecb88ffc","1e9e7223-cf3f-4483-a682-c4da7477279f","e1473692-e4ad-40e2-a560-349cf8f67dbb","ed8ae3e6-b566-4e62-987c-f5d529774521","4e4db2c2-8ccb-4bfe-ae24-3562d9bbc9b1","7293bd3a-0389-4060-862d-33fc45dde040","c969b419-b18f-42cb-99cd-d361018bd4be","456f3b5a-9909-4d60-9810-7a8604038228","32b5f3ee-c089-4dbf-9f4d-afc4753d3ca6","35489a7a-2c8a-46f0-9ac7-b057f8310ddc","2278e74f-c3a5-46de-bc28-c6f4248b1f00","37dd0d04-d5bd-40a7-b057-3aa0ce27c438","f30afd5d-3d43-476e-96ba-30f31569e913","93c85785-8b2a-4305-b81d-f42431891bc0","b14624c2-72fa-44e9-a8ec-c9d82657e130","6dc57f42-9f7b-40e4-ab76-053508dd1cfb","17047d04-360c-41a4-b396-798269d987c5","15978e45-60a6-486a-bdfe-71c6359eae43","cd0038d3-3aff-4bce-aedf-d2caabc0ff24","38ccea82-6607-4013-a099-9e1d2dba1c29","bf90ab92-062f-4db9-bad7-bbf3d2de6203","c5a2d542-031b-465e-8227-e25357b6824c","e267772f-7f8f-4ff2-8420-8a74e70cbac6","f9131d21-248c-48ee-a7d2-0a955bc18143","e82516e0-a77e-481c-87f3-0c6111a60dee","78d7784c-3e69-4e7e-951e-b141fc903c01","5a86d993-6611-4359-b89c-090341d3cad6","60f6e613-1c1f-4e0c-ade6-c1d1df66c942","4f47a4f1-f305-4c53-a102-4c87a1140962","899c1257-4bd8-413e-8c22-15217d3bf246","dc37be6e-7432-43db-a5c4-85c3a61a41bf","b9a001df-14be-44a2-bd41-a91ecd393375","45efbfa5-1720-47fe-ae18-37f7997f2a9a","0da47389-92f1-435f-acb6-b6b88feb8cc3","18819350-9c15-44ef-9d3e-bea11c4f2a31","bad9dc3b-5768-4d3b-b929-cc30b44c6780","2c27388a-7069-4004-b793-7a46d671b9cc","8f94bda0-a5c9-4d38-9367-f76ba52212e5","c6717003-5b76-4978-bd64-e45a9815d9ad","2d189307-1cf8-4374-9357-32f7f719fdaa","4d6f6eed-8b98-4db2-82af-3c4459822a67","05932da9-e597-4c69-97bb-3178abe38ba7","76736415-9cd4-405e-92cc-36ef7fd42af7","35c2b473-7820-47de-b4e4-04001621ad86","c59c055e-e32d-4a75-9637-672fc770456a","927d26d8-a163-40cc-b8c0-95aae0d4c11e","9d09f6b8-402d-4023-8277-d73ef25bfadb","439e0c29-cea7-411a-8c43-f45fa2151183","d6ec245c-cddd-440e-b0b1-81330cb4a693","830701d2-8642-447e-9b42-41bc8cf0df9a","9a6bd000-39e6-4336-9bce-bfc1e0e4f59f","85770327-8f9d-464e-b0c1-5b8e9959e881","4867da7c-1548-4c15-afe2-105d99fca78c","34df3977-43be-4bcb-a7d8-89ef602f253d","7396298f-9fa6-48de-bc19-f7a13bd5ba35","44ee4609-b70a-4577-9728-a9d62330a30e","2c3e349c-e1ea-4089-b4af-20ba6836c694","250c35ee-2fa5-4eb9-b0eb-c7e46c240f3f","e4091305-7e34-41c2-b2e0-7eb6543f4710","02beaf98-46f4-4de2-a54b-9c6369d5409e","d6a2cc8c-7689-4cd5-802d-64373cf7ce8e","36e2df71-8508-4161-b4e2-cefb95aa211e","dafcf971-afd9-4346-a02a-198a71c4fd1f","813ff5ba-c59d-4597-98a9-a349a4b4008a","09c278d6-282b-4553-b1a3-0ecc88adb1ae","e578ce9a-42cf-4124-bc61-c6eb083de860","c25d1c6a-0ff7-4fce-9a3b-6f0d8669f75b","deb12fde-ed41-4923-970c-b8f29dbaea2e","8d3de27b-fb2f-40a8-9527-7c20df05cc8d","00ea135f-a479-45e1-a548-1f22f49ff99b","2bdd0d05-3d1f-4d51-a699-9e69435aab0c","8c371dbd-1a3c-402e-aa75-331025962d7b","83d0a451-567a-4e25-895a-62ead41abb09","310a39f7-be67-47aa-a92e-178da5267ee4","27e68f03-e28a-465e-a81f-336307432807","9f020f1c-ed8e-43fe-a4a0-1ba5c1b005e4","3348bfc5-29f4-4a7d-bbab-72c173fc43f2","24c2d68c-ea31-430c-a60c-718c61628680","bfc49a80-d536-48df-a7bb-b6e6b76a865f","6f5ce424-89c3-4459-ae53-a4945b232dae","c5906279-6c27-40e9-81e0-b440b781dddd","cadf74c9-8649-4b86-9eee-c1484a480745","460843c7-1b6a-4089-8f59-3413e3a5b6f4","6fae06c8-6ad4-47ba-82dc-8af74c6f6834","0e67e333-1728-4aa8-ac78-78a80bfaf00c","f04f5325-8bef-4a11-8dd1-7aee77bd888b","e3fa9fd5-10c3-4e52-88ae-9cb554776ba5","c9d27ef3-e2d0-4f15-9b26-76c6a0ef5c76","01f003ec-b90a-426b-b4f3-963bdb77a0db","4af52f7e-86d4-439f-9ff4-e11717f1c78f","8e76bce7-7c70-4854-aabc-ba8772740776","01fefbbd-9750-4fdd-a775-ccc4b2f43ea8","d77b6817-b98c-4827-a163-f4bfc77b5785","cf30353f-7429-4e89-b992-67b7dbe6ecca","a9056d36-db54-4e74-855c-6749a363dd21","6e424ac3-047a-4b53-b527-0d3689f94f3d","6eaa925a-29af-4359-9560-b8347e47f6fe","92b29e7d-c8ba-4cf2-a42c-f7e885704f63","32fbf9b8-4d95-4c94-9c0d-4ade7df6f586","f579b995-1c59-47d0-aca2-0d5c7b7802d9","4fad536a-fbdb-4acd-8e98-c71f64a8c88d","52d017d6-c4f9-4250-b478-b587d0ab6130","328ceba1-e265-457a-882a-41bbbb0e13e7","f281bde8-1b22-455f-ad21-843533f32437","bc5feb55-c4d3-4f3c-b07f-d160e1d4fb69","53368c52-10b3-4fa8-81d9-d6dca66bdd8b","d7d8b44d-0d19-421e-b3b4-4cb27442e225","75748896-5a01-4af3-8ff1-e63a8448acf6","7f1895e0-ba4e-48ac-85fc-8f8491b8d136","a504ed15-cddc-408f-8521-f302c6013c59","4aeb7590-be76-4ed6-bf30-339680701d77","4b9f4739-40d3-42c2-9868-605478b8dfb7","90bedd71-d96a-4b6a-a8eb-b783151461e6","4b9b3c6f-43c0-4652-9e0c-c308dc5bd091","89194e22-7505-4e71-9089-b2b21473ae2c","6efa3aeb-a5e6-4deb-9995-12bdee1bc77c","813736a0-b2f8-4998-b526-a0702f07f3f7","d99ec63a-e805-40a6-bb2f-c15a589241e0","269bb4b1-693f-4e47-844b-f181b6c92137","3bb69b37-9033-4507-8777-1a290c2074cb","5b31bc69-877b-41d5-a9c5-94460219ca5b","55258282-a6c6-4a33-afbf-70a927aa4c7a","1b74ea0a-9cd0-4f35-8070-cbed478058b1","91f94047-dcef-4d55-a243-9222d57dea3c","626a046b-e7ad-4795-af3a-9676745688b1","cd8e1b6b-7c3a-4e27-8473-c927becc83e8","2c76610c-703f-4246-9937-d21590f8dfff","ec844790-40e3-4651-8ac8-0263bf457b50","229e1236-0e31-4ca9-87a9-14566d3eb47e","805ed1ef-3805-4d0a-a165-9113872dd4d9","3f8bd200-0916-427d-9faa-fc20e4e17491","3dc84eb4-3ca6-44e8-80b8-85a74f989a5f","ab72f8f7-2e66-4adc-8056-5034b9417e87","ffd13238-71af-4015-8cb7-a633ead39d75","cc0f64ab-f56d-4dae-87e9-b77931ce4b7c","2007f60f-317f-4c63-9d0a-a9fec1968026","0af9b723-7a50-4db6-88d3-ca9eac2521d1","b1e3b467-7928-44ee-b131-d4689d2c9fbb","64de2a69-5822-47e2-affb-0138152703a2","003222f5-d07f-4347-a61b-bcabb3b852c1","66ed0ce7-e2b1-4c7a-bd7a-6e1901de2400","397ab7e2-065b-47c4-87d1-1b3119d20e7d","e96547f7-1f3d-42b8-a4ca-9bfbf2c0728e","36cd4db0-a61a-4b36-bbb0-0f87d0a7b7e0","00e361f1-9021-450e-bf35-fe48f1fb6844","ce6bbda4-1b44-44fa-983e-e5f37b89895b","4cd0eced-e273-46c2-84f5-a7efd7fbdd2f","82be252e-5184-44cd-a91b-a7d6ffdefac6","bea8efd0-61d7-495b-a255-5c1f40753cf7","12a6eaa5-30f7-419b-aee7-1be2dbc7278c","75db54d0-46ad-43b1-8ef0-7556ce0e9069","89ba9061-3275-4d76-966f-11691fdfd72f","0eb824c6-f768-47bc-9204-d94dbb912c6e","09f3541c-8edb-4603-9bc3-02bd22cd7836","b13cc3bd-a0a3-4b61-b482-63051d7804b5","b2b10be2-1b2f-4a48-a453-532657bd8e92","a00ebb82-58f2-4b40-89ee-a65be3befabf","6d1f21ba-36cf-4c90-9ecb-d5e377942f3a","50a76940-a26e-443a-b752-1412855e6ad7","4c0f8e8c-3967-43ab-a0a8-a3a8ae837714","555c9896-0c2d-4af7-a951-1d81f051de2e","751d20c2-e2be-4e61-921a-adb553651c8c","8e0ffb71-86cb-46bf-abf2-720dcb4378f9","53da1632-5152-4b4f-b440-19b82802360b","30fa18a6-609e-4f5b-af3d-31906c46fe23","3afd60d5-3ce7-431a-b812-2c836b7596a3","dd2f1d05-d4ef-48a0-899c-10fe0346a447","ac411712-ee48-4589-828d-b4e5827efc17","0c5be7d7-cfcf-417b-824a-1a280254a58e","35c18cd6-99a8-47f3-91ee-40dbfec922fa","017372b2-9d34-4118-ad13-9b8e15c30ebd","035cfcde-4292-4905-82b2-6517e58a28b9","42a8570d-5be6-4be4-9ca3-0569f54863bf","5f103e1f-2659-4c6a-bb30-705d2dae0774","811aca42-41c0-4f83-9e08-e795d7a5f803","7643a79b-68c8-46af-ae10-f089cb1ae62b","6e5d9018-2dc0-4dc7-802c-be95d99f1660","bd0b93b9-a0e9-4582-a164-98acdc7a5b45","ecdfe65a-28ee-46d2-a82b-99573e3dd63d","56dd4a06-5073-46d2-8aca-8e37d90e5610","1f8febec-2e84-4be2-a67d-7b5165845a4b","ee67a0e4-8343-4dd6-9636-9504cae6c573","eabf4d1f-9a77-441f-88fb-de9e9e0dc26e","56ba9c1f-2a28-4d05-910c-e89fb051327d","07ffa801-adfb-41f3-809b-87f69ae9e9cd","62f63581-5683-49a3-8812-32e2de74a6a6","f01bdcc5-d573-4790-b605-988df0f3a5ea","e404919f-5dda-4fc3-a28f-6550e70cee12","cee1de64-79f4-45b4-85d5-1ffae9624a8e","86ecfb21-c0ed-42cb-864c-83890d49cb51","27fa9add-6ec7-433a-88c9-58279f5055c3","24c31e38-d546-423f-b3cb-a0533e711d02","6e87073b-2877-44d1-9df7-2dd266bb35e3","d6367cec-2e43-4558-882d-fb9a00545fef","172fd543-704b-489a-8d2e-7d1255f51bef","8f27f9ff-57f2-4c07-ad65-55c7f7f7501f","24f220ca-372b-4003-8e74-13291220c778","e16c2241-0f08-4946-908e-c5e6612b0a8c","2021f38b-f367-4f6c-8232-73387a4dcfb6","b40e41dc-6c0f-4d74-b3ad-3df012f49b01","5759d5ff-246c-4daf-85f3-7fc9884a4bf7","b89fffe8-2e2d-4574-84e1-f81b26df5c1e","2bfc9604-0e06-4ff2-90cf-c382d6bf341b","2e568628-70b1-4f35-934e-81ea4263d0e8","3d8c8d33-f904-41f7-a3ff-b6272c633079","9aefc3b4-f172-4917-b1c7-495c26ec37f9","4453c56e-831c-4203-83fc-9736e276b7dc","6239e7bb-e6a6-4cb4-b4fa-236035bad7f7","95dafcd5-6243-4838-bea1-8e19b0596f6f","34d8ae09-8161-49ec-ae2d-c188c477bb90","cb2a5d30-074f-4c07-97b5-61147e0ea504","e950a58c-0d6f-42c3-8225-9e7adc5d4182","bfe1c963-57ad-4ed2-a9f9-65a3e65f61fd","4ba67e59-362e-4fee-9a67-da423ceefa54","6e41b1fc-a49b-491c-a312-13578c137ab4","037b290e-c8e2-4985-9859-83c40b32b47a","ed447931-f637-4b99-ad61-a2d9d6292ed9","46bcda2b-ec7a-47cc-bcd4-255bb39d310d","61430569-a0c3-4804-a0a3-088135cbbf3e","8e9658b3-1879-43ee-8dd0-aa453db5102d","d8d61f33-8960-4603-849b-b4d1f13a6d36","ece03bf4-b8b2-477a-abe6-125ed58de706","e7bd67f9-1c39-4ac0-b9fe-3441fa74bc14","1ac86639-060b-4e5d-8801-5dd0a40743ff","3ebbe91c-2198-4cd8-8558-ca0b7b47464f","c3762916-2f17-40e0-bd88-12b9442756fd","fe341c1f-ce4e-4845-a24a-802d106b1c80","b5bc1d11-c24d-4523-b371-22c3ee0c4253","0c017ea5-219e-4212-bfdf-89f2ea88187f","39365f4f-a881-461b-97e5-d9aa4ff49498","37f70389-a5e2-4fb8-840f-8cfe940662ef","5ab11760-87f6-4b8a-ae84-206e92aa9009","2486c8b2-de46-4f07-8df9-00ac5080303e","453e1a27-0815-46a0-a5ad-b55267008588","a91e6b04-d782-4974-b523-6c4519a54f50","2c2559b7-77fa-4a0b-877b-2b9769a0caab","ff21f4c6-5ca3-4bb6-b795-aeb1c5b2fe06","845cb0c6-34d2-46fe-9d44-adc3dc124c80","64917ef4-eb94-4a23-a8dc-cb07d7756103","6c5d4d64-558f-4925-8168-b1a96613b0ad","ffb3e282-814e-4b16-a707-5efb54961ba7","7ea58f0d-22f4-4c96-8188-42319c1509ae","1e371f92-dae2-43d6-b029-3d4d1ac8acd9","47a3e557-3e63-45f6-beeb-f7f767589a83","d6070391-2f76-412f-b5a5-bccbfcafc4e5","a96635d9-4dfb-4970-9671-b8f64a5c080c","2238e3ac-7da8-4c47-a13f-854c0576fbd4"]);function r(e){return o.has(e.id)}},95807:(e,t,n)=>{n.d(t,{Hl:()=>i,Sl:()=>r});var o=n(97880);function r(e,t){if(!(0,o.$K)(t)||"production"===e)return t;const n=`notion-${e}-`;return t.startsWith(n)?t:`${n}${t}`}function i(e){return e&&e.startsWith("//")?`https:${e}`:e}},94826:(e,t,n)=>{n.d(t,{EY:()=>M,I$:()=>A,M2:()=>B,RW:()=>R,Uw:()=>P,ZB:()=>x,iV:()=>d,uw:()=>E,z6:()=>D});var o=n(9291),r=n(15070),i=n(72126),a=n(4615),s=n(97880),l=n(64002),c=n(63143);const d={headers:{authorization:{prefix:"Bearer"},hmac:!1},body:{path:["event"]},urlValidator:function(e){return Boolean((0,l.yn)(e))}},u=(0,o.defineMessages)({nightfall:{id:"temporaryWebhookIntegrationConfig.taglines.nightfall",defaultMessage:"Simplify security and compliance with Nightfall AI"},panther:{id:"temporaryWebhookIntegrationConfig.taglines.panther",defaultMessage:"A SIEM built for speed, scale, and flexibility"},sumologic:{id:"temporaryWebhookIntegrationConfig.taglines.sumologic",defaultMessage:"Secure and protect against modern threats with cloud-native log analytics"},splunk:{id:"temporaryWebhookIntegrationConfig.taglines.splunk",defaultMessage:"The unified security and observability platform"},datadog:{id:"temporaryWebhookIntegrationConfig.taglines.datadog",defaultMessage:"Detect, investigate, and automate response to threats at any scale"},polymer:{id:"temporaryWebhookIntegrationConfig.taglines.polymer",defaultMessage:"Protect sensitive data across cloud apps and reduce the risk of exposure"},onna:{id:"temporaryAdminIntegrationConfig.taglines.onna",defaultMessage:"Connect. Find. Act."},hanzo:{id:"temporaryAdminIntegrationConfig.taglines.hanzo",defaultMessage:"Manage Risk Everywhere Work Is Done"},aware:{id:"temporaryAdminIntegrationConfig.taglines.aware",defaultMessage:"Secure Your Digital Workplace. Drive Growth. Scale AI."},metomic:{id:"temporaryAdminIntegrationConfig.taglines.metomic",defaultMessage:"Metomic integration tagline"},custom:{id:"temporaryAdminIntegrationConfig.taglines.custom",defaultMessage:"Custom webhook integration that only requires a destination URL."}}),p={id:"a2768733-a1f9-4174-84fa-40a9ff2053d7",name:"nightfall",icon:"/images/external_integrations/nightfall-logo.svg",website_url:"https://www.nightfall.ai/",signupUrl:"https://www.nightfall.ai/integrations/notion",privacy_policy_url:"https://www.nightfall.ai/privacy",terms_of_use_url:"https://www.nightfall.ai/terms",developer_name:"Nightfall AI",installation_info_url:void 0,type:"dlp",tagline:u.nightfall,webhookUrl:"https://notion.nightfall.ai/notion/v1/event",customization:{headers:{hmac:!0}},allowedBotCapabilities:{webhooks:!0,read_content:!0,update_content:!0,read_comment:!0,insert_comment:!0,read_user_without_email:!0,read_user_with_email:!0},allowedEndpoints:["public_getPage","public_getPageProperty","public_getBlock","public_listBlockChildren","public_getDatabase","public_getSelf","public_updatePage","public_updateBlock","public_deleteBlock","public_updateDatabase","public_listComments","public_createComment","public_deleteComment","public_updateComment","public_getComment","public_unsharePageFromWeb","public_removeGuestsFromPage","public_getUser","public_external_deleteExternalBot"],acceptsSecretToken:!1,integrationGalleryUrl:"https://www.notion.so/integrations/nightfall-ai",redirectUri:"https://app.nightfall.ai/dashboard"},m={id:"fb50a39e-955a-4b9c-9ffb-49587de2a79c",name:"panther",icon:"/images/external_integrations/panther-logo.png",website_url:"https://panther.com/",signupUrl:"https://panther.com/product/request-a-demo/",privacy_policy_url:"https://panther.com/privacy-policy/",terms_of_use_url:"https://panther.com/terms-of-service/",developer_name:"Panther",installation_info_url:void 0,type:"siem",customization:{headers:{hmac:!0},urlValidator:function(e){if(!e||!(0,l.yn)(e))return!1;const t=new URL(e);if("https:"!==t.protocol)return!1;if(!t.pathname.startsWith("/http/"))return!1;const n=t.pathname.replace("/http/","");return!!(0,a.t)(n)}},tagline:u.panther,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!0,integrationGalleryUrl:"https://www.notion.so/integrations/panther"},f={id:"3ecda536-3b09-4218-a756-bda416c512d7",name:"sumologic",icon:"/images/external_integrations/sumo-logic-logo.jpeg",website_url:"https://www.sumologic.com/",signupUrl:"https://www.sumologic.com/sign-up/",privacy_policy_url:"https://www.sumologic.com/privacy-statement/",terms_of_use_url:"https://www.sumologic.com/terms-conditions/",developer_name:"Sumo Logic",installation_info_url:void 0,type:"siem",tagline:u.sumologic,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!1,integrationGalleryUrl:"https://www.notion.so/integrations/sumo-logic",customization:{urlValidator:function(e){if(!e||!(0,l.yn)(e))return!1;const t=new URL(e);return"https:"===t.protocol&&(!!t.hostname.endsWith("sumologic.com")&&!!t.pathname.startsWith("/receiver/v1/http/"))}}},g={id:"ff522b0f-e688-4986-9b7d-255627316f73",name:"splunk",icon:"/images/external_integrations/splunk-logo.jpeg",website_url:"https://www.splunk.com/",signupUrl:"https://www.splunk.com/en_us/talk-to-sales.html",privacy_policy_url:"https://www.splunk.com/en_us/legal/privacy/privacy-policy.html",terms_of_use_url:"https://www.splunk.com/en_us/legal/terms/terms-of-use.html",developer_name:"Splunk",installation_info_url:void 0,integrationGalleryUrl:"https://www.notion.so/integrations/splunk",customization:{headers:{authorization:{prefix:"Splunk"}},body:{path:["event"]},urlValidator:function(e){if(!e||!(0,l.yn)(e))return!1;const t=new URL(e);if(!["http:","https:"].includes(t.protocol))return!1;let n=t.hostname;return!(!n.startsWith("http-inputs")||!n.endsWith(".splunkcloud.com"))&&(n=n.replace("http-inputs","").replace(".splunkcloud.com",""),!(n.length<2||!n.startsWith("-")&&!n.startsWith("."))&&!!["/services/collector/raw","/services/collector/event"].includes(t.pathname))}},type:"siem",tagline:u.splunk,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!0},h={id:"97d68716-a483-4472-8fa9-da26215d721a",name:"datadog",icon:"/images/external_integrations/datadog-logo.png",website_url:"https://www.datadoghq.com/",signupUrl:"https://www.datadoghq.com/free-datadog-trial/",privacy_policy_url:"https://www.datadoghq.com/legal/privacy/",terms_of_use_url:"https://www.datadoghq.com/legal/terms/",developer_name:"Datadog",installation_info_url:void 0,type:"siem",integrationGalleryUrl:"https://www.notion.so/integrations/datadog",customization:{headers:{hmac:!0}},oauth:{accountInfoPropertyNames:{accountId:"dd_oid",accountName:"dd_org_name"},usePKCE:!0,apiDomainsByRegion:{"https://app.datadoghq.com":"api.datadoghq.com","https://us3.datadoghq.com":"api.us3.datadoghq.com","https://us5.datadoghq.com":"api.us5.datadoghq.com","https://app.datadoghq.eu":"datadoghq.eu","https://app.ddog-gov.com":"ddog-gov.com","https://ap1.datadoghq.com":"ap1.datadoghq.com"},tokenPath:"/oauth2/v1/token",apiKeyPath:"/api/v2/api_keys/marketplace"},tagline:u.datadog,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!1},v={icon:"/images/external_integrations/polymer-logo.jpeg",website_url:"https://www.polymerhq.io/",signupUrl:"https://www.polymerhq.io/request-demo/",privacy_policy_url:"https://www.polymerhq.io/privacy/",terms_of_use_url:"https://www.polymerhq.io/terms-of-service/",installation_info_url:void 0,type:"dlp",tagline:u.polymer,integrationGalleryUrl:"https://www.notion.so/integrations/polymer",allowedBotCapabilities:{webhooks:!0,read_content:!0,update_content:!0,read_comment:!0,insert_comment:!0,read_user_without_email:!0,read_user_with_email:!0},allowedEndpoints:["public_getPage","public_getPageProperty","public_getBlock","public_listBlockChildren","public_getDatabase","public_getSelf","public_updatePage","public_updateBlock","public_deleteBlock","public_updateDatabase","public_listComments","public_createComment","public_deleteComment","public_updateComment","public_getComment","public_unsharePageFromWeb","public_removeGuestsFromPage","public_listUsers","public_getUser","public_external_deleteExternalBot"],acceptsSecretToken:!1,redirectUri:"https://www.polymerhq.io/"},b={...v,id:"9fb229bb-d287-45de-82f1-7331e99d9c6b",name:"polymer",developer_name:"Polymer",webhookUrl:"https://notion.polymerhq.io/notion/events"},y={...v,id:"1b725b3c-5eda-454d-9b41-0f903de3ba00",name:"polymerDev",developer_name:"PolymerDev",webhookUrl:"https://pilot.qa.polymerhq.io/notion/events"},_={icon:"https://s3-us-west-2.amazonaws.com/public.notion-static.com/3944326d-8881-4093-90f8-63637b1ef75f/metomic.png",website_url:"https://metomic.io/",privacy_policy_url:"https://metomic.io/privacy-policy",terms_of_use_url:"https://metomic.io/terms-and-conditions",signupUrl:"https://metomic.io/",allowedBotCapabilities:{webhooks:!0,read_comment:!0,read_content:!0,insert_content:!0,update_content:!0,read_user_with_email:!0,read_user_without_email:!0},type:"dlp",tagline:u.metomic,allowedEndpoints:["public_getPage","public_getPageProperty","public_getBlock","public_listBlockChildren","public_getDatabase","public_getSelf","public_updatePage","public_updateBlock","public_deleteBlock","public_updateDatabase","public_listComments","public_createComment","public_deleteComment","public_updateComment","public_getComment","public_unsharePageFromWeb","public_removeGuestsFromPage","public_getUser","public_external_deleteExternalBot"],acceptsSecretToken:!1,integrationGalleryUrl:"https://www.notion.so/integrations/metomic",redirectUri:"https://metomic.io/",customization:{headers:{hmac:!0}}},S={..._,id:"05d23763-7da5-4fcc-aad4-a147d5034cc3",name:"metomic",developer_name:"Metomic",webhookUrl:"https://integrations-api.metomic.io/notion/webhooks/generic/0188965b-c4f7-589c-45c0-7766857bad32"},w={..._,id:"75b66e0c-be9f-4fc5-bed6-1bc156f91e1c",name:"metomicStaging",developer_name:"Metomic (Staging)",webhookUrl:"https://integrations-api.metomic-staging.io/notion/webhooks/generic/01889547-4e22-1e0b-f363-571468d1b042"},k={id:"7487d286-3fa5-4984-8a62-3aa4c51f50ed",name:"custom",developer_name:"Custom SIEM integration",type:"siem",tagline:u.custom,allowedBotCapabilities:{webhooks:!0},acceptsSecretToken:!1,integrationGalleryUrl:"https://www.notion.so/integrations"},I=["public_exportPage","public_workspaceSearch","public_getUser","public_listUsers","public_listTeamspaces","public_getPage","public_getDatabase","public_getSelf"],C={workspace_search:!0,workspace_page_export:!0,read_content:!0,read_user_without_email:!0,read_user_with_email:!0,read_teamspace:!0},x={datadog:h,nightfall:p,panther:m,polymer:b,polymerDev:y,metomic:S,metomicStaging:w,splunk:g,sumologic:f,onna:{id:"bb67e6bb-09f3-48fe-a7b2-428665ff20ac",name:"onna",icon:"/images/external_integrations/onna-icon.jpeg",website_url:"https://onna.com/",privacy_policy_url:"https://onna.com/privacy-policy",terms_of_use_url:"https://onna.com/master-subscription-agreement",developer_name:"Onna",type:"ediscovery",tagline:u.onna,integrationGalleryUrl:"https://www.notion.so/integrations/onna",allowedBotCapabilities:C,allowedEndpoints:I,redirectUri:"https://localhost:3005"},aware:{id:"99b8b727-7eee-40f8-af16-de045fb78e15",name:"aware",icon:"/images/external_integrations/aware-icon.png",website_url:"https://www.awarehq.com/",privacy_policy_url:"https://www.awarehq.com/privacy",terms_of_use_url:"https://www.awarehq.com/terms-conditions",developer_name:"Aware",type:"ediscovery",tagline:u.aware,integrationGalleryUrl:"https://www.notion.so/integrations/aware",allowedBotCapabilities:C,allowedEndpoints:I,redirectUri:"https://localhost:3005"},hanzo:{id:"2ebac254-9d38-4c94-b579-0eac7fe0f43c",name:"hanzo",icon:"/images/external_integrations/hanzo-icon.png",website_url:"https://www.hanzo.co/",privacy_policy_url:"https://www.hanzo.co/privacy",terms_of_use_url:"https://www.hanzo.co/privacy",developer_name:"Hanzo",type:"ediscovery",tagline:u.hanzo,integrationGalleryUrl:"https://www.notion.so/integrations/hanzo",allowedBotCapabilities:C,allowedEndpoints:I,redirectUri:"https://localhost:3005"},custom:k},T=(0,c.m8)((0,s.qP)(x).map((e=>{let[t,n]=e;return[n.id,n]})));function M(e){var t;return null===(t=A(e))||void 0===t?void 0:t.name}function P(e){const t=A(e);return Boolean(t&&"ediscovery"===t.type)}function A(e){if(e)return T[e]}function R(e){const t=A(e);if(t&&("siem"===t.type||"dlp"===t.type))return t}function D(e){return Boolean(A(e))}function E(e){if(!e)return!1;const t=A(e);return!!t&&(0,r.ms)(t.allowedBotCapabilities)}function B(e){const{env:t,integrationConfig:n,webhookUrlToValidate:o}=e;return!!(0,i.TS)({},d,n.customization).urlValidator(o)||"local"===t&&o.startsWith("http://localhost:3005/")}},67175:(e,t,n)=>{n.d(t,{Qf:()=>i,W5:()=>a});var o=n(97880);const r={insertText:!0,deleteText:!0,splitTextIntoBlock:!0,splitText:!0,moveTextSliceIntoBlock:!0,moveTextSlice:!0,addAnnotation:!0,removeAnnotation:!0,replaceTextInBlock:!0};function i(e){return Boolean(r[e.command])}function a(e){const{pointer:t,crdtOperation:n}=e,r=n.type;switch(r){case"insertText":return{command:"insertText",pointer:t,path:[],args:n};case"deleteText":return{command:"deleteText",pointer:t,path:[],args:n};case"addAnnotation":return{command:"addAnnotation",pointer:t,path:[],args:n};case"removeAnnotation":return{command:"removeAnnotation",pointer:t,path:[],args:n};case"splitText":return{command:"splitText",pointer:t,path:[],args:n};default:(0,o.t1)(r)}}},7250:(e,t,n)=>{n.d(t,{$A:()=>u,Jq:()=>p,Nv:()=>h,OP:()=>y,j:()=>m,oG:()=>d});n(57658);var o=n(67294),r=n(74686),i=n(65454),a=n(4615);const s={download_desktop_app:!0,download_mobile_app:!0,sign_up:!0,onboarding_show:!0,onboarding_complete:!0,gdpr_consent:!0,create_subscription:!0,subscription_update_plan:!0,subscription_update_billing:!0,subscription_update_billing_email:!0,cancel_subscription:!0,click_upgrade_button:!0,create_space:!0,join_space:!0,leave_space:!0,delete_space:!0,open_support_chat:!0},l=[],c="intercomSettings";function d(e){let{getLocale:t,analyticsSettings:n,deviceId:s,onVisibilityChange:d,cookieService:u}=e;(0,o.useEffect)((()=>{!async function(e){const{getLocale:t,analyticsSettings:n,deviceId:o,onVisibilityChange:s,cookieService:d}=e;if(void 0===n||!n.isIntercomEnabled)return;if(!(await r.ec({service:"intercom",cookieService:d})))return;const u=t().split("-")[0];window[c]={app_id:n.intercomAppId,user_hash:n.intercomUserHash?n.intercomUserHash:void 0,language_override:u},!n.noIntercomUserId&&n.user_id?window[c].user_id=(0,a.cj)(n.user_id):n.user_email&&(window[c].email=n.user_email);o&&(window[c].device_id=(0,a.cj)(o));let p=Promise.resolve();const m=window.Intercom;if("function"==typeof m)m("reattach_activator"),m("update",window[c]);else{const e=function(){e.c(arguments)};e.q=l,e.c=function(t){e.q.push(t)},window.Intercom=e,p=(0,i.ZP)(`https://widget.intercom.io/widget/${n.intercomAppId}`)}s&&(g("onShow",(()=>{s(!0)})),g("onHide",(()=>{s(!1)})))}({getLocale:t,analyticsSettings:n,deviceId:s,onVisibilityChange:d,cookieService:u})}),[t,n,s,d,u])}function u(e){if(b()){const{userId:n,userName:o,traits:r,settings:i}=e;if(!i)return;var t={};o&&(t.name=o);const a={email:i.user_email,user_hash:i.intercomUserHash,...r,...t};!i.noIntercomUserId&&n?a.user_id=n:delete a.user_id,Intercom("update",a)}}function p(e){if(b()){const{companiesData:t}=e;Intercom("update",{companies:t})}}function m(e){const{eventName:t,eventData:n}=e;b()&&s[t]&&Intercom("trackEvent",t,n)}let f=!1;function g(e,t){if(b())Intercom(e,t);else{l.push([e,t])}}function h(e){const{prepopulatedContent:t,waitForCssInsets:n}=e;g("showNewMessage",t),!f&&n&&(f=!0,v((()=>n())))}const v=function(e){g("onHide",e)},b=function(){return"undefined"!=typeof Intercom};function y(){if(b())return Intercom("getVisitorId")}},49902:(e,t,n)=>{n.d(t,{j:()=>s,kI:()=>a});n(57658);var o=n(67294),r=n(66673),i=n(65454);function a(e){let{isEnabled:t,isLoggedIn:n,userId:a,userEmail:l,spaceId:c,sprigConfig:d,userDaysSinceSignup:u,userDomainType:p,isSpaceAdmin:m,spaceMemberCount:f}=e;(0,o.useEffect)((()=>{if(!t||!n||void 0===a||void 0===l||void 0===c||void 0===d||void 0===p)return;if(window.Sprig)return;const e=function(){e._queue.push(arguments)};e._queue=[],e.appId=d.environmentId,window.Sprig=e,window.UserLeap=e,window.Sprig("setUserId",a),window.Sprig("setEmail",l),window.Sprig("setAttribute","SPACE_ID",c),f&&window.Sprig("setAttribute","SPACE_MEMBER_COUNT",f),u>=3&&u<=14&&"professional"===p&&s(m?{name:"trigger-phase-1"}:{name:"trigger-phase-1-1"}),(0,i.ZP)("https://cdn.sprig.com/shim.js")}),[t,n,a,d,l,c,m,p,u,f]);const g=(0,r.D9)(n);(0,o.useEffect)((()=>{g&&!n&&window.Sprig&&window.Sprig("logoutUser")}),[g,n])}function s(e){const t=e.name;if(!window.Sprig)return void console.error("Sprig not loaded, not tracking: ",t);const n="args"in e?e.args:{};window.Sprig("track",t,n)}},80503:(e,t,n)=>{n.d(t,{Aj:()=>i,Pv:()=>d,R6:()=>l,TT:()=>r,br:()=>a,u3:()=>c});var o=n(40654);const r=52,i=45,a=37,s=30;function l(e){return e?a:i}function c(e){return 2*l(e)}function d(e,t,n){return(e&&!t?(0,o.XW)(n):12)+s}},9163:(e,t,n)=>{n.d(t,{FW:()=>r,eU:()=>o,lR:()=>i});const o={"sprints-onboarding":{steps:[{id:"current-sprint-view-tooltip"},{id:"sprint-task-tooltip"},{id:"complete-sprint-button-tooltip"}]}},r="completed",i="dismissed"},41641:(e,t,n)=>{function o(e){return![".","#","$","[","]"].map((t=>-1!==e.indexOf(t))).reduce(((e,t)=>e||t),!1)}n.d(t,{Z:()=>o})},68120:(e,t,n)=>{n.d(t,{kB:()=>d});n(21703);var o=n(97880),r=n(63143),i=n(74487);const a=Symbol("JSON Schema"),s=Symbol("JSON Schema Components"),l=Symbol("No JSON Schema"),c={isNull:()=>({type:"null",[s]:{}}),boolean:()=>({type:"boolean",[s]:{}}),number:()=>({type:"number",[s]:{}}),integer:()=>({type:"integer",[s]:{}}),string:()=>({type:"string",[s]:{}}),dateString:()=>({type:"string",format:"date",[s]:{}}),literal:e=>({enum:[e],[s]:{}}),literals:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return{enum:t,[s]:{}}},uuid:()=>({type:"string",format:"uuid",[s]:{}}),uuidWithoutDashes:()=>({type:"string",format:"uuid",[s]:{}}),any:()=>u,array:e=>({type:"array",items:e[a],[s]:e[a][s]}),tuple:e=>({type:"tuple",items:!1,prefixItems:e.map((e=>e[a])).filter((e=>e!==l)),[s]:Object.assign({},...e.map((e=>e[a][s])))}),record:(e,t)=>({type:"object",additionalProperties:t[a],[s]:t[a][s]}),object:e=>{let{required:t,optional:n,exact:o}=e;return{type:"object",properties:(0,r.m8)(Object.entries({...t,...n}).filter((e=>{let[t,n]=e;return n[a]!==l})).map((e=>{let[t,n]=e;return[t,n[a]]}))),...o&&{additionalProperties:!1},...Object.keys(t).length>0&&{required:Object.keys(t)},[s]:Object.assign({},...Object.values({...t,...n}).map((e=>e[a][s])))}},union:e=>({anyOf:e.map((e=>e[a])).filter((e=>e!==l)),[s]:Object.assign({},...e.map((e=>e[a][s])))}),gte:(e,t)=>{const n=e[a];return n!==l?{...n,minimum:t}:n},lte:(e,t)=>{const n=e[a];return n!==l?{...n,maximum:t}:n},maxLength:(e,t)=>{const n=e[a];if(n===l)return n;if("type"in n){if("string"===n.type)return{...n,maxLength:t};if("array"===n.type)return{...n,maxItems:t}}throw new Error("Unknown type for max length.")},minLength:(e,t)=>{const n=e[a];if(n===l)return n;if("type"in n){if("string"===n.type)return{...n,minLength:t};if("array"===n.type)return{...n,minItems:t}}throw new Error("Unknown type for min length.")},nonEmpty:e=>{const t=e[a];if(t===l)return t;if("type"in t){if("string"===t.type)return{...t,minLength:1};if("object"===t.type)return{...t,minProperties:1};if("array"===t.type)return{...t,minItems:1}}throw new Error("Unknown non-emptyable type.")},nullable:e=>{const t=e[a];if(t===l)return t;if("type"in t)if(Array.isArray(t.type)){if("null"===t.type[1])return t;(0,o.t1)(t.type[1])}else{if("string"===t.type)return{...t,type:[t.type,"null"]};if("object"===t.type)return{...t,type:[t.type,"null"]};if("array"===t.type)return{...t,type:[t.type,"null"]};if("tuple"===t.type)return{...t,type:[t.type,"null"]};if("boolean"===t.type)return{...t,type:[t.type,"null"]};if("integer"===t.type)return{...t,type:[t.type,"null"]};if("number"===t.type)return{...t,type:[t.type,"null"]};if("null"===t.type)return t;(0,o.t1)(t.type)}else{if("const"in t)return{...t,enum:[t.const,null]};if("enum"in t)return{...t,enum:[...t.enum,null]};if("anyOf"in t)return{...t,anyOf:t.anyOf.map((e=>c.nullable({[a]:e})))};if("$ref"in t)return{anyOf:[t,{type:"null"}],[s]:t[s]};if(n=t,(0,o.Kn)(n)&&0===Object.keys(n).length)return t;(0,o.t1)(t)}var n}},d=(0,r.m8)(Object.entries(c).map((e=>{let[t,n]=e;return[t,function(){for(var e=arguments.length,r=new Array(e),l=0;l<e;l++)r[l]=arguments[l];return 1===r.length&&(0,o.Kn)(r[0])&&("id"in r[0]||"description"in r[0])?function(){const{description:e,examples:o,id:l}=r[0];let c={description:e,...o&&{examples:o},...n(...arguments)};return l&&(c={$ref:`#/components/schemas/${l}`,[s]:{...c[s],[l]:c}}),{[a]:c,...i[t](...arguments)}}:{[a]:n(...r),...i[t](...r)}}]}))),u=(Symbol("Exact empty object ({})"),d.object({id:"emptyObject"})({required:{},optional:{},exact:!0}),{})},73123:(e,t,n)=>{n.d(t,{Fi:()=>p,Hz:()=>i,Rh:()=>s,Zj:()=>c,aT:()=>f,ez:()=>a,hx:()=>m,xX:()=>l,y3:()=>u,yM:()=>d});var o=n(9291),r=n(97880);const i=["last_7_days","last_28_days","last_90_days","all_time"],a={last_7_days:7,last_28_days:28,last_90_days:90},s=((0,r.AO)((e=>7===e||28===e||90===e?{true:e}:{false:e})),(0,o.defineMessages)({last_7_days:{id:"spaceAnalyticsUserTab.dateFilter.last7days",defaultMessage:"Last 7 Days"},last_28_days:{id:"spaceAnalyticsUserTab.dateFilter.last28days",defaultMessage:"Last 28 Days"},last_90_days:{id:"spaceAnalyticsUserTab.dateFilter.last90days",defaultMessage:"Last 90 Days"},all_time:{id:"spaceAnalyticsUserTab.dateFilter.allTime",defaultMessage:"All Time"}})),l=(0,o.defineMessages)({last_7_days:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.last7days",defaultMessage:"last 7 days"},last_28_days:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.last28days",defaultMessage:"last 28 days"},last_90_days:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.last90days",defaultMessage:"last 90 days"},all_time:{id:"spaceAnalyticsUserTab.dateFilter.lowercase.allTime",defaultMessage:"all time"}});function c(e,t,n){const o=e||0,r=t||0;return n?o-r:r-o}function d(e,t,n){const o=e||-1,r=t||-1;return n?o-r:r-o}const u=(0,o.defineMessages)({page:{id:"contentAnalyticsHeaderMessages.columnHeader.page",defaultMessage:"Page"},pageId:{id:"contentAnalyticsHeaderMessages.columnHeader.pageId",defaultMessage:"Page ID"},teams:{id:"contentAnalyticsHeaderMessages.columnHeader.teamspace",defaultMessage:"Teamspace"},audience:{id:"contentAnalyticsHeaderMessages.columnHeader.audience",defaultMessage:"Audience"},allViews:{id:"contentAnalyticsHeaderMessages.columnHeader.allViews",defaultMessage:"All views"},uniqueViews:{id:"contentAnalyticsHeaderMessages.columnHeader.uniqueViews",defaultMessage:"Unique views"},createdBy:{id:"contentAnalyticsHeaderMessages.columnHeader.createdBy",defaultMessage:"Created by"},createdAt:{id:"contentAnalyticsHeaderMessages.columnHeader.createdAt",defaultMessage:"Created at"},lastEditedBy:{id:"contentAnalyticsHeaderMessages.columnHeader.lastEditedBy",defaultMessage:"Last edited by"},lastEditedAt:{id:"contentAnalyticsHeaderMessages.columnHeader.lastEditedAt",defaultMessage:"Last edited at"}});const p={num_searches:"numSearches",num_unique_users:"numUniqueUsers",ctr:"ctr"},m={numSearches:"num_searches",numUniqueUsers:"num_unique_users",ctr:"ctr"};function f(e){return e<=1?"1":e<=50?"2-50":e<=100?"51-100":e<=500?"101-500":e<=1e3?"501-1000":e<=5e3?"1001-5000":"5001-plus"}},51454:(e,t,n)=>{n.d(t,{A_:()=>V,Bh:()=>j,D_:()=>l,E:()=>Y,Eo:()=>B,Gt:()=>k,I5:()=>p,IK:()=>b,LI:()=>Z,LN:()=>y,MC:()=>g,Mo:()=>E,Nm:()=>P,Nn:()=>D,Qm:()=>a,RJ:()=>v,S1:()=>A,VT:()=>h,Wd:()=>Q,Wi:()=>o,XB:()=>U,XP:()=>r,Y6:()=>F,YO:()=>L,_:()=>$,_Y:()=>C,ag:()=>J,bF:()=>T,bz:()=>N,d1:()=>W,eU:()=>s,eu:()=>R,fQ:()=>I,hT:()=>q,hc:()=>M,ke:()=>ee,l6:()=>i,lB:()=>H,lI:()=>O,mJ:()=>G,mK:()=>w,nD:()=>c,ov:()=>_,p8:()=>X,py:()=>u,sL:()=>f,t8:()=>S,vi:()=>K,vt:()=>z,wx:()=>m,xP:()=>d,y:()=>x});const o=1,r=2,i=2,a=2,s=3,l=9,c=9,d=30,u=81,p=83,m=83,f=84,g=84,h=85,v=85,b=85,y=85,_=85,S=85,w=86,k=86,I=86,C=86,x=86,T=h+2,M=h+2,P=87,A=88,R=89,D=99,E=99,B=99,F=99,O=100,Z=100,V=101,U=102,N=102,L=109,j=110,z=111,q=111,H=113,W=120,K=121,G=999,$=9999,Q=9999999,Y=1e6,X=1,J=2,ee=4},88642:(e,t,n)=>{n.d(t,{j:()=>l,g:()=>c});var o=n(74686),r=n(29477);let i,a;async function s(e,t,n){if(i)return i;e.planType=t,e.isSalesAssistedPlan=n;const a=(0,r.UZ)();i=a.promise,await async function(e){if(!(await o.ec({service:"zendesk",cookieService:e.cookieService})))return;const t=document.createElement("script");if(t.type="text/javascript",t.async=!0,t.src="https://solve-widget.forethought.ai/embed.js",t.id="forethought-widget-embed-script",t.setAttribute("data-api-key","c895ee24-2c6c-4ed6-a100-3037e65cadda"),t.setAttribute("data-ft-full-name",e.fullName||"Forethought Deflected"),t.setAttribute("data-ft-email",e.email||"forethought@makenotion.com"),e.locale){var n;const o=null===(n=e.locale.split("-")[0])||void 0===n?void 0:n.toLowerCase();o&&t.setAttribute("data-ft-embed-script-language",o)}const r=e.planType||"undefined";"enterprise"===r&&e.isSalesAssistedPlan?(t.setAttribute("data-ft-plan-type","enterprise_free"),t.setAttribute("data-ft-workflow-tag","enterprise_free"),t.setAttribute("initial-intent-id","d5cb32d0-3637-4e8e-87fa-c4ea8d79d45f")):(t.setAttribute("data-ft-plan-type",r),t.setAttribute("data-ft-workflow-tag",r));const i=document.getElementsByTagName("script")[0];return null==i||i.parentNode.insertBefore(t,i),window.addEventListener("message",(e=>{var t,n;"forethoughtWidgetClosed"===(null==e||null===(t=e.data)||void 0===t?void 0:t.event)&&(null===(n=Forethought)||void 0===n||n("widget","hide"))})),new Promise((e=>{t.addEventListener("load",(()=>{var t;null===(t=Forethought)||void 0===t||t("widget","hide"),e()}))}))}(e),a.resolve()}async function l(e){if(a)return a;const t=(0,r.UZ)();a=t.promise,e.isForethoughtEnabled&&await s(e.forethoughtInitializeArgs,e.userHighestPlanType,e.isSalesAssistedPlan),await async function(e){const{locale:t,cookieService:n}=e;if(!(await o.ec({service:"zendesk",cookieService:n})))return;const r=document.createElement("script");r.type="text/javascript",r.async=!0,r.src="https://static.zdassets.com/ekr/snippet.js?key=b9ad856d-6b98-4cf5-a2f6-d96e50557722",r.id="ze-snippet";const i=document.getElementsByTagName("script")[0];return null==i||i.parentNode.insertBefore(r,i),new Promise((e=>{r.addEventListener("load",(()=>{var n=window.zE;n&&(n("webWidget","setLocale",t),n("webWidget","hide"),e())}))}))}(e),t.resolve()}async function c(e){if(await l(e),"undefined"!=typeof Forethought)Forethought("widget","show"),Forethought("widget","open");else{var t=window.zE;if(!t)return;t("webWidget","show"),t("webWidget","open"),t("webWidget:on","close",(function(e){(t=window.zE)&&t("webWidget","hide")}))}}}}]);